!function(e){function t(t){for(var a,i,s=t[0],l=t[1],c=t[2],d=0,f=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&f.push(r[i][0]),r[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(u&&u(t);f.length;)f.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,s=1;s<n.length;s++){var l=n[s];0!==r[l]&&(a=!1)}a&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},r={1:0},o=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/react";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;o.push([1268,0]),n()}([,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={IAudienceSegmentService:Symbol.for("audienceSegmentService"),IAudienceFeedFormService:Symbol.for("audienceFeedFormService"),IAudienceSegmentFormService:Symbol.for("audienceSegmentFormService"),IAudiencePartitionsService:Symbol.for("audiencePartitionsService"),IAttributionModelService:Symbol.for("attributionModelService"),IOverlapInterval:Symbol.for("overlapInterval"),IDisplayCampaignFormService:Symbol.for("displayCampaignFormService"),IAudienceTagFeedService:Symbol.for("audienceTagFeedService"),IAudienceExternalFeedService:Symbol.for("audienceExternalFeedService"),IAudienceSegmentFeedService:Symbol.for("audienceSegmentFeedService"),IImportService:Symbol.for("importService"),IDatamartService:Symbol.for("datamartService"),IDisplayNetworkService:Symbol.for("displayNetworkService"),IDealListService:Symbol.for("dealListService"),IDealListFormService:Symbol.for("dealListFormService"),ICompartmentService:Symbol.for("compartmentService"),IScenarioService:Symbol.for("scenarioService"),IScenarioExitConditionService:Symbol.for("scenarioExitConditionService"),IAutomationFormService:Symbol.for("automationFormService"),IQueryService:Symbol.for("queryService"),IGoalService:Symbol.for("goalService"),IGoalFormService:Symbol.for("goalFormService"),IExportService:Symbol.for("exportService"),IUserDataService:Symbol.for("userDataService"),IUsersService:Symbol.for("usersService"),IMonitoringService:Symbol.for("monitoringService"),IMlAlgorithmService:Symbol.for("mlAlgorithmService"),IMlAlgorithmModelService:Symbol.for("mlAlgorithmModelService"),IMlAlgorithmVariableService:Symbol.for("mlAlgorithmVariableService"),IMlFunctionService:Symbol.for("mlFunctionService"),INavigatorService:Symbol.for("navigatorService"),IApiTokenService:Symbol.for("apiTokenService"),IChannelService:Symbol.for("channelService"),ICommunityService:Symbol.for("communityService"),IConsentService:Symbol.for("consentService"),IGeonameService:Symbol.for("geonameService"),ISettingsService:Symbol.for("settingsService"),IDashboardService:Symbol.for("dashboardService"),ICatalogService:Symbol.for("catalogService"),ILibraryCatalogService:Symbol.for("libraryCatalogService"),IServiceOfferPageService:Symbol.for("serviceOfferPageService"),IFeedsStatsService:Symbol.for("feedsStatsService"),IAssetFileService:Symbol.for("assetFileService"),IPluginService:Symbol.for("pluginService"),ICreativeService:Symbol.for("creativeService"),IDisplayCreativeFormService:Symbol.for("displayCreativeFormService"),IAdGroupFormService:Symbol.for("adGroupFormService"),IDisplayCampaignService:Symbol.for("displayCampaignService"),IEmailRouterService:Symbol.for("emailRouterService"),IVisitAnalyzerService:Symbol.for("visitAnalyzerService"),IRecommenderService:Symbol.for("recommenderService"),IAudienceExternalFeedServiceFactory:Symbol.for("audienceExternalFeedServiceFactory"),IAudienceTagFeedServiceFactory:Symbol.for("audienceTagFeedServiceFactory"),IAudienceSegmentFeedServiceFactory:Symbol.for("audienceSegmentFeedServiceFactory"),IAuthService:Symbol.for("authService"),ITagService:Symbol.for("tagService"),ILabelService:Symbol.for("labelService"),IOrganisationService:Symbol.for("organisationService"),IDatamartReplicationService:Symbol.for("datamartReplicationService"),IDataFileService:Symbol.for("dataFileService"),IServiceUsageReportService:Symbol.for("serviceUsageReportService"),IRuntimeSchemaService:Symbol.for("runtimeSchemaService"),IResourceHistoryService:Symbol.for("resourceHistoryService"),IReferenceTableService:Symbol.for("referenceTableService"),IDatamartUsersAnalyticsService:Symbol.for("datamartUsersAnalyticsService"),IEmailCampaignService:Symbol.for("emailCampaignService"),IEmailCampaignFormService:Symbol.for("emailCampaignFormService"),IAudienceBuilderService:Symbol.for("audienceBuilderService"),IAudienceFeatureService:Symbol.for("audienceFeatureService"),IUserActivitiesFunnelService:Symbol.for("userActivitiesFunnelService"),IUsersAnalyticsService:Symbol.for("usersAnalyticsService"),IUserRolesService:Symbol.for("userRolesService"),ICustomActionService:Symbol.for("customActionService")};t.TYPES=a},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lazyInject=t.container=void 0;var a=n(1331),r=n(1332),o=Se(n(1333)),i=n(1334),s=n(1335),l=Se(n(1336)),c=n(1337),u=n(38),d=n(1338),f=n(1339),p=n(1352),m=n(1353),g=n(1354),y=n(1355),h=Se(n(1356)),v=n(1357),b=n(1358),_=n(1359),S=n(1360),E=n(1361),O=Se(n(1362)),w=n(1363),M=n(1364),P=n(1365),T=n(1366),I=n(1367),A=n(1368),C=Se(n(1369)),j=n(1370),R=n(1372),N=n(12),k=n(1373),D=n(1374),F=n(1375),L=n(1376),x=n(1377),G=Se(n(1378)),U=n(740),B=n(1380),q=n(1381),V=n(1382),H=n(1383),Y=n(1384),z=n(1385),W=n(1386),Q=n(1387),K=n(1388),X=n(1389),J=n(1390),$=n(1391),Z=n(1392),ee=Se(n(1393)),te=n(889),ne=n(1394),ae=n(1395),re=n(1396),oe=n(1397),ie=Se(n(1398)),se=Se(n(907)),le=n(1400),ce=n(1401),ue=n(1402),de=n(1403),fe=n(1404),pe=n(1405),me=n(1406),ge=Se(n(1408)),ye=n(1409),he=n(1410),ve=n(1411),be=n(1413),_e=n(1414);function Se(e){return e&&e.__esModule?e:{default:e}}var Ee=t.container=new u.Container;Ee.bind(N.TYPES.IAudienceBuilderService).to(o.default),Ee.bind(N.TYPES.IEmailCampaignService).to(ge.default),Ee.bind(N.TYPES.IEmailCampaignFormService).to(ye.EmailCampaignFormService),Ee.bind(N.TYPES.IAudienceSegmentService).to(C.default),Ee.bind(N.TYPES.IAudienceFeedFormService).to(P.AudienceFeedFormService),Ee.bind(N.TYPES.IAudienceSegmentFormService).to(I.AudienceSegmentFormService),Ee.bind(N.TYPES.IAudiencePartitionsService).to(A.AudiencePartitionsService),Ee.bind(N.TYPES.IAttributionModelService).to(le.AttributionModelService),Ee.bind(N.TYPES.IOverlapInterval).to(T.OverlapInterval),Ee.bind(N.TYPES.IDisplayCampaignFormService).to(j.DisplayCampaignFormService),Ee.bind(N.TYPES.IAudienceExternalFeedService).to(k.AudienceExternalFeedService).whenTargetNamed("EXTERNAL_FEED"),Ee.bind(N.TYPES.IAudienceTagFeedService).to(D.AudienceTagFeedService).whenTargetNamed("TAG_FEED"),Ee.bind(N.TYPES.IImportService).to(R.ImportService),Ee.bind(N.TYPES.IExportService).to(q.ExportService),Ee.bind(N.TYPES.IScenarioService).to(U.ScenarioService),Ee.bind(N.TYPES.IScenarioExitConditionService).to(he.ScenarioExitConditionService),Ee.bind(N.TYPES.IDatamartService).to(ne.DatamartService),Ee.bind(N.TYPES.IDisplayNetworkService).to(F.DisplayNetworkService),Ee.bind(N.TYPES.IDealListService).to(L.DealListService),Ee.bind(N.TYPES.IDealListFormService).to(x.DealListFormService),Ee.bind(N.TYPES.ICompartmentService).to(G.default),Ee.bind(N.TYPES.IAutomationFormService).to(M.AutomationFormService),Ee.bind(N.TYPES.IQueryService).to(w.QueryService),Ee.bind(N.TYPES.IGoalFormService).to(B.GoalFormService),Ee.bind(N.TYPES.IGoalService).to(pe.GoalService),Ee.bind(N.TYPES.IUserDataService).to(O.default),Ee.bind(N.TYPES.IUsersService).to(V.UsersService),Ee.bind(N.TYPES.IMonitoringService).to(H.MonitoringService),Ee.bind(N.TYPES.IMlFunctionService).to(Q.MlFunctionService),Ee.bind(N.TYPES.IMlAlgorithmService).to(Y.MlAlgorithmService),Ee.bind(N.TYPES.IMlAlgorithmModelService).to(z.MlAlgorithmModelService),Ee.bind(N.TYPES.IMlAlgorithmVariableService).to(W.MlAlgorithmVariableService),Ee.bind(N.TYPES.INavigatorService).to(b.NavigatorService),Ee.bind(N.TYPES.IApiTokenService).to(K.ApiTokenService),Ee.bind(N.TYPES.IChannelService).to(X.ChannelService),Ee.bind(N.TYPES.ICommunityService).to(E.CommunityService),Ee.bind(N.TYPES.IConsentService).to(S.ConsentService),Ee.bind(N.TYPES.IGeonameService).to(_.GeonameService),Ee.bind(N.TYPES.ISettingsService).to(J.SettingsService),Ee.bind(N.TYPES.IDashboardService).to($.DashboardService),Ee.bind(N.TYPES.ICatalogService).to(p.CatalogService),Ee.bind(N.TYPES.ILibraryCatalogService).to(ce.LibraryCatalogService),Ee.bind(N.TYPES.IServiceOfferPageService).to(f.ServiceOfferPageService),Ee.bind(N.TYPES.IFeedsStatsService).to(ae.FeedsStatsService),Ee.bind(N.TYPES.ITagService).to(d.TagService),Ee.bind(N.TYPES.IAuthService).to(te.AuthService),Ee.bind(N.TYPES.ILabelService).to(Z.LabelService),Ee.bind(N.TYPES.IOrganisationService).to(ee.default).inSingletonScope(),Ee.bind(N.TYPES.IAssetFileService).to(re.AssetFileService),Ee.bind(N.TYPES.IPluginService).to(ie.default),Ee.bind(N.TYPES.ICreativeService).to(oe.CreativeService),Ee.bind(N.TYPES.IDisplayCreativeFormService).to(v.DisplayCreativeFormService),Ee.bind(N.TYPES.IAdGroupFormService).to(h.default),Ee.bind(N.TYPES.IDisplayCampaignService).to(y.DisplayCampaignService),Ee.bind(N.TYPES.IVisitAnalyzerService).to(g.VisitAnalyzerService),Ee.bind(N.TYPES.IRecommenderService).to(i.RecommenderService),Ee.bind(N.TYPES.IEmailRouterService).to(m.EmailRouterService),Ee.bind(N.TYPES.IServiceUsageReportService).to(ue.ServiceUsageReportService),Ee.bind(N.TYPES.IRuntimeSchemaService).to(de.RuntimeSchemaService),Ee.bind(N.TYPES.IDatamartReplicationService).to(c.DatamartReplicationService),Ee.bind(N.TYPES.IResourceHistoryService).to(fe.ResourceHistoryService),Ee.bind(N.TYPES.IReferenceTableService).to(s.ReferenceTableService),Ee.bind(N.TYPES.IDataFileService).to(l.default),Ee.bind(N.TYPES.IAudienceExternalFeedServiceFactory).toFactory((function(e){return function(t){var n=e.container.get(N.TYPES.IAudienceExternalFeedService);return n.segmentId=t,n}})),Ee.bind(N.TYPES.IAudienceTagFeedServiceFactory).toFactory((function(e){return function(t){var n=e.container.get(N.TYPES.IAudienceTagFeedService);return n.segmentId=t,n}})),Ee.bind(N.TYPES.IAudienceSegmentFeedServiceFactory).toFactory((function(e){return function(t){return function(n){var a=e.container.getNamed("EXTERNAL_FEED"===t?N.TYPES.IAudienceExternalFeedService:N.TYPES.IAudienceTagFeedService,t);return a.segmentId=n,a.feedType=t,a}}})),Ee.bind(N.TYPES.IDatamartUsersAnalyticsService).to(me.DatamartUsersAnalyticsService),Ee.bind(N.TYPES.IAudienceFeatureService).to(r.AudienceFeatureService),Ee.bind(N.TYPES.IUserActivitiesFunnelService).to(ve.UserActivitiesFunnelService),Ee.bind(N.TYPES.IUsersAnalyticsService).to(be.UsersAnalyticsService),Ee.bind(N.TYPES.IUserRolesService).to(_e.UserRolesService),Ee.bind(N.TYPES.ICustomActionService).to(a.CustomActionService);var Oe=(0,se.default)(Ee,!1).lazyInject;t.lazyInject=Oe,t.default={container:Ee}},,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(25),r=n(124),o={notifyError:r.notifyError,notifySuccess:r.notifySuccess,notifyWarning:r.notifyWarning,notifyInfo:r.notifyInfo,removeNotification:r.removeNotification,resetNotifications:r.resetNotifications};t.default=(0,a.connect)(void 0,o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormTimePickerField=t.FormAlertInputField=t.FormRateField=t.FormCheckboxGroupField=t.FormRadioGroupField=t.FormRadioField=t.TagSelectField=t.DefaultSelectField=t.FormTextAreaField=t.FormCodeEditField=t.FormUploadField=t.FormSliderField=t.FormBooleanField=t.FormCheckboxField=t.FormDateRangePickerField=t.FormSwitchField=t.FormAddonSelectField=t.FormMultiTagField=t.FormSelectField=t.FormDatePickerField=t.FormInputNumberField=t.FormInputField=t.FormTimePicker=t.FormAlertInput=t.FormRate=t.FormSlider=t.FormDragAndDrop=t.TagSelect=t.DefaultSelect=t.AddonSelect=t.FormCodeSnippet=t.withValidators=t.withNormalizer=t.FormCodeEdit=t.FormTextArea=t.FormUpload=t.FormSwitch=t.SwitchInput=t.FormTitle=t.FormSection=t.FormDateRangePicker=t.FormRadioGroup=t.FormBoolean=t.FormInputNumber=t.FormInput=t.FormFieldWrapper=t.FormDatePicker=t.FormCheckboxGroup=t.FormCheckbox=void 0;var a=n(35),r=R(n(1491)),o=R(n(1662)),i=R(n(1663)),s=R(n(1664)),l=R(n(84)),c=R(n(975)),u=R(n(1665)),d=R(n(410)),f=R(n(976)),p=R(n(1666)),m=R(n(977)),g=R(n(63)),y=R(n(49)),h=R(n(1719)),v=R(n(1720)),b=R(n(308)),_=R(n(1721)),S=R(n(1722)),E=R(n(333)),O=R(n(993)),w=R(n(784)),M=R(n(1723)),P=R(n(787)),T=R(n(789)),I=R(n(1990)),A=R(n(1991)),C=R(n(997)),j=R(n(1992));function R(e){return e&&e.__esModule?e:{default:e}}t.default={FormBoolean:r.default,FormCheckbox:o.default,FormCheckboxGroup:i.default,FormDatePicker:s.default,FormFieldWrapper:l.default,FormRadio:c.default,FormRadioGroup:u.default,FormDateRangePicker:w.default,FormSection:d.default,FormTextArea:v.default,FormTitle:f.default,FormUpload:h.default,SwitchInput:p.default,FormSwitch:m.default,FormInput:b.default,FormInputNumber:_.default,FormCodeEdit:M.default,withNormalizer:g.default,withValidators:y.default,FormCodeSnippet:P.default,FormDragAndDrop:I.default,AddonSelect:O.default,DefaultSelect:E.default,TagSelect:T.default,FormSlider:S.default,FormRate:A.default,FormAlertInput:C.default,FormTimePicker:j.default},t.FormCheckbox=o.default,t.FormCheckboxGroup=i.default,t.FormDatePicker=s.default,t.FormFieldWrapper=l.default,t.FormInput=b.default,t.FormInputNumber=_.default,t.FormBoolean=r.default,t.FormRadioGroup=u.default,t.FormDateRangePicker=w.default,t.FormSection=d.default,t.FormTitle=f.default,t.SwitchInput=p.default,t.FormSwitch=m.default,t.FormUpload=h.default,t.FormTextArea=v.default,t.FormCodeEdit=M.default,t.withNormalizer=g.default,t.withValidators=y.default,t.FormCodeSnippet=P.default,t.AddonSelect=O.default,t.DefaultSelect=E.default,t.TagSelect=T.default,t.FormDragAndDrop=I.default,t.FormSlider=S.default,t.FormRate=A.default,t.FormAlertInput=C.default,t.FormTimePicker=j.default;t.FormInputField=a.Field,t.FormInputNumberField=a.Field,t.FormDatePickerField=a.Field,t.FormSelectField=a.Field,t.FormMultiTagField=a.Field,t.FormAddonSelectField=a.Field,t.FormSwitchField=a.Field,t.FormDateRangePickerField=a.Field,t.FormCheckboxField=a.Field,t.FormBooleanField=a.Field,t.FormSliderField=a.Field,t.FormUploadField=a.Field,t.FormCodeEditField=a.Field,t.FormTextAreaField=a.Field,t.DefaultSelectField=a.Field,t.TagSelectField=a.Field,t.FormRadioField=a.Field,t.FormRadioGroupField=a.Field,t.FormCheckboxGroupField=a.Field,t.FormRateField=a.Field,t.FormAlertInputField=a.Field,t.FormTimePickerField=a.Field},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compareSearches=t.updateSearch=t.buildDefaultSearch=t.isSearchValid=t.SORT_SEARCH_SETTINGS=t.DATAMART_SEARCH_SETTINGS=t.ALL_USERS=t.ARCHIVED_SEARCH_SETTINGS=t.getComparisonDateSearchSettings=t.convertTimestampToDayNumber=t.DATE_SEARCH_SETTINGS_WITHOUT_CURRENT_DAY=t.DATE_SEARCH_SETTINGS=t.SEGMENTS_FILTERS_SEARCH_SETTINGS=t.FILTERS_SEARCH_SETTINGS=t.SET_PASSWORD_SEARCH_SETTINGS=t.KEYWORD_SEARCH_SETTINGS=t.PAGINATION_SEARCH_SETTINGS=t.TAB_SEARCH_SETTINGS=t.LABELS_SEARCH_SETTINGS=void 0,t.parseSearch=function(e,t){var n=a.default.parse(e);return t?t.reduce((function(e,t){return Object.assign(Object.assign({},e),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}({},t.paramName,t.deserialize(n)))}),{}):n};var a=i(n(139)),r=i(n(54)),o=i(n(81));function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){return window.sessionStorage&&window.sessionStorage.getItem(t)?new o.default(window.sessionStorage.getItem(t)):(window.sessionStorage&&window.sessionStorage.setItem(t,e.raw()),e)}function l(e,t){window.sessionStorage&&window.sessionStorage.setItem(t,e.raw())}var c=s(new o.default("now-7d"),"from"),u=s(new o.default("now"),"to"),d=(t.LABELS_SEARCH_SETTINGS=[{paramName:"label_id",defaultValue:[],deserialize:function(e){return e.label_id?e.label_id.split(","):[]},serialize:function(e){return e.join(",")},isValid:function(e){return!e.label_id||e.label_id.split(",").length>0}}],t.TAB_SEARCH_SETTINGS=[{paramName:"tab",defaultValue:"site",deserialize:function(e){return e.tab},serialize:function(e){return e},isValid:function(e){return!!e}}],t.PAGINATION_SEARCH_SETTINGS=[{paramName:"currentPage",defaultValue:1,deserialize:function(e){return parseInt(e.currentPage,0)},serialize:function(e){return e.toString()},isValid:function(e){return!(!e.currentPage||isNaN(parseInt(e.currentPage,0)))}},{paramName:"pageSize",defaultValue:10,deserialize:function(e){return parseInt(e.pageSize,0)},serialize:function(e){return e.toString()},isValid:function(e){return!(!e.pageSize||isNaN(parseInt(e.pageSize,0)))}}],t.KEYWORD_SEARCH_SETTINGS=[{paramName:"keywords",defaultValue:"",deserialize:function(e){return e.keywords},serialize:function(e){return e},isValid:function(){return!0}}],t.SET_PASSWORD_SEARCH_SETTINGS=[{paramName:"email",defaultValue:"",deserialize:function(e){return e.email},serialize:function(e){return e},isValid:function(){return!0}},{paramName:"token",defaultValue:"",deserialize:function(e){return e.token},serialize:function(e){return e},isValid:function(){return!0}}],t.FILTERS_SEARCH_SETTINGS=[{paramName:"statuses",defaultValue:[],deserialize:function(e){return e.statuses?e.statuses.split(","):[]},serialize:function(e){return e.join(",")},isValid:function(e){return!e.statuses||e.statuses.split(",").length>0}}],t.SEGMENTS_FILTERS_SEARCH_SETTINGS=[{paramName:"segments",defaultValue:[""],deserialize:function(e){return e.segments?e.segments.split(","):[]},serialize:function(e){return e.join(",")},isValid:function(e){return!(!e.segments||!(0===e.segments.length||e.segments.split(",").length>0))}}],t.DATE_SEARCH_SETTINGS=[{paramName:"from",defaultValue:c,deserialize:function(e){return new o.default(e.from)},serialize:function(e){return l(e,"from"),e.raw()},isValid:function(e){return!!(e.from&&e.from.length&&new o.default(e.from).isValid())}},{paramName:"to",defaultValue:u,deserialize:function(e){return new o.default(e.to)},serialize:function(e){return l(e,"to"),e.raw()},isValid:function(e){return!!(e.to&&e.to.length&&new o.default(e.to).isValid())}}],t.DATE_SEARCH_SETTINGS_WITHOUT_CURRENT_DAY=[{paramName:"from",defaultValue:new o.default("now-8d"),deserialize:function(e){return new o.default(e.from)},serialize:function(e){return l(e,"from"),e.raw()},isValid:function(e){return!!(e.from&&e.from.length&&new o.default(e.from).isValid())}},{paramName:"to",defaultValue:new o.default("now-1d"),deserialize:function(e){return new o.default(e.to)},serialize:function(e){return l(e,"to"),e.raw()},isValid:function(e){return!!(e.to&&e.to.length&&new o.default(e.to).isValid())}}],t.convertTimestampToDayNumber=function(e){var t=(Date.now()-e)/1e3;return Math.floor(t/86400)});t.getComparisonDateSearchSettings=function(e){return[{paramName:"from",defaultValue:new o.default("now-"+d(e)+"d"),deserialize:function(e){return new o.default(e.from)},serialize:function(e){return l(e,"from"),e.raw()},isValid:function(t){return!!(t.from&&t.from.length&&new o.default(t.from).isValid()&&new o.default(t.from).toMoment()>new o.default("now-"+d(e)+"d").toMoment())}},{paramName:"to",defaultValue:new o.default("now-1d"),deserialize:function(e){return new o.default(e.to)},serialize:function(e){return l(e,"to"),e.raw()},isValid:function(e){return!!(e.to&&e.to.length&&new o.default(e.to).isValid())&&new o.default(e.to).toMoment()>new o.default(e.from).toMoment()}}]},t.ARCHIVED_SEARCH_SETTINGS=[{paramName:"archived",defaultValue:!1,deserialize:function(e){return"true"===e.archived},serialize:function(e){return e.toString()},isValid:function(e){return"true"===e.archived||"false"===e.archived}}],t.ALL_USERS=[{paramName:"allusers",defaultValue:!0,deserialize:function(e){return"true"===e.allusers},serialize:function(e){return e.toString()},isValid:function(e){return"true"===e.allusers||"false"===e.allusers}}],t.DATAMART_SEARCH_SETTINGS=[{paramName:"datamartId",defaultValue:"",deserialize:function(e){return e.datamartId},serialize:function(e){return e},isValid:function(){return!0}}],t.SORT_SEARCH_SETTINGS=[{paramName:"orderBy",defaultValue:"",deserialize:function(e){return e.orderBy},serialize:function(e){return e},isValid:function(){return!0}}],t.isSearchValid=function(e,t){var n=a.default.parse(e);return Object.keys(n).length>0&&t.reduce((function(e,t){return e&&t.isValid(n)}),!0)},t.buildDefaultSearch=function(e,t){var n=a.default.parse(e),r=t.reduce((function(e,t){var a=e;return t.isValid(n)?a[t.paramName]=n[t.paramName]:"function"==typeof t.defaultValue?a[t.paramName]=t.serialize(t.defaultValue()):a[t.paramName]=t.serialize(t.defaultValue),a}),{});return a.default.stringify(r)},t.updateSearch=function(e,t,n){var r=a.default.parse(e);if(!n)return a.default.stringify(Object.assign(Object.assign({},r),t));var o=Object.keys(t).reduce((function(e,a){var r=e,o=n.find((function(e){return e.paramName===a}));return o&&(r[a]=o.serialize(t[a])),r}),{});return a.default.stringify(Object.assign(Object.assign({},r),o))};t.compareSearches=function(e,t){return r.default.isEqual(a.default.parse(e),a.default.parse(t))}},,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPaginatedApiParam=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return{first_result:(e-1)*t,max_results:t}},t.takeLatest=function(e){var t=void 0,n=void 0,a=void 0,r=void 0,o=function(e,r){e===t&&(n=null,a(r))},i=function(e,a){e===t&&(n=null,r(a))};return function(){return t=e.apply(void 0,arguments),n||(n=new Promise((function(e,t){a=e,r=t}))),t.then(o.bind(null,t),i.bind(null,t)),n}},t.makeCancelable=function(e){var t=!1;return{promise:new Promise((function(n,a){e.then((function(e){return t?a({isCanceled:!0}):n(e)}),(function(e){return a(t?{isCanceled:!0}:e)}))})),cancel:function(){t=!0}}}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MicsApiService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t.extractData=function(e){return e.data},t.extractDataList=function(e){return e.data},n(887);var r,o=n(54),i=n(261),s=(r=i)&&r.__esModule?r:{default:r},l=n(889);var c=window.MCS_CONSTANTS||{},u=c.API_URL+"/v1/",d=c.ADMIN_API_URL+"/v1/";function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e)return"";var t=Object.keys(e),n=t.filter((function(t){return void 0!==e[t]})).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&");return n.length?"?"+n:""}function p(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.adminApi?d:n.localUrl?"/":u,r=""+a+t+f(n.params),i=new Headers(n.headers||{});if(i.append("X-Requested-By","mediarithmics-navigator"),!n.localUrl&&n.authenticated){var c=s.default.getItem(l.ACCESS_TOKEN);c?i.append("Authorization",c):Promise.reject("Error. Authenticated without token, endpoint:"+t)}var p={method:e,headers:i};n.body instanceof FormData||n.body instanceof Blob?p.body=n.body:n.body&&((0,o.isEmpty)(n.headers)?(i.append("Accept","application/json"),i.append("Content-Type","application/json"),p.body=JSON.stringify(n.body)):p.body=n.body),n.withCredentials&&(p.credentials="include");var m=function(e){var t=e.headers.get("Content-Type");if(401===e.status&&e.url!==u+"authentication/refresh_tokens"){var n=new Event("unauthorizedEvent");document.dispatchEvent(n)}return!t||-1===t.indexOf("image/png")&&-1===t.indexOf("application/octet-stream")?t&&-1!==t.indexOf("text/html")?e.status<400?Promise.resolve():Promise.reject(e):t&&-1!==t.indexOf("text/plain")?e.status<400?e.text():Promise.reject(e):e.json().then((function(t){return e.ok?t:Promise.reject(t)})):e.blob().then((function(t){return e.ok||Promise.reject(t),t}))};return fetch(r,p).then(m)}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return p("delete",e,Object.assign(Object.assign({params:t,headers:n},a),{authenticated:void 0===a.authenticated||a.authenticated}))}t.default={request:p,getRequest:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return p("get",e,Object.assign(Object.assign({params:t,headers:n},a),{authenticated:void 0===a.authenticated||a.authenticated}))},postRequest:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return p("post",e,Object.assign(Object.assign({params:n,headers:a,body:t},r),{authenticated:void 0===r.authenticated||r.authenticated}))},putRequest:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return p("put",e,Object.assign(Object.assign({params:n,headers:a,body:t},r),{authenticated:void 0===r.authenticated||r.authenticated}))},deleteRequest:m};t.MicsApiService=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"deleteRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return m(e,t,n,a)}}]),e}()},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultErrorMessages=void 0;var a=n(8),r=n(6),o=t.defaultErrorMessages=(0,r.defineMessages)({required:{id:"common.form.field.error.required",defaultMessage:"required"},formatNotZero:{id:"common.form.field.error.format_not_zero",defaultMessage:"Width and/or height cannot be 0"},invalidEmail:{id:"common.form.field.error.invalid_email",defaultMessage:"invalid email address"},invalidFloat:{id:"common.form.field.error.invalid_float",defaultMessage:"invalid Number, please make sure you use a dot instead of a comma and that your number doesn't exceed 2 decimals"},invalidNumber:{id:"common.form.field.error.invalid_number",defaultMessage:"invalid number"},invalidUrl:{id:"common.form.field.error.invalid_url",defaultMessage:"invalid url"},invalidDomain:{id:"common.form.field.error.invalid_domain",defaultMessage:"Invalid domain. A domain should be in the `example.com` or `sub.example.com` format. Please remove any `http://` part or `/` from the entered value."},positiveNumber:{id:"common.form.field.error.positive_number",defaultMessage:"Number must be above 0"},exceedMaxCharacters:{id:"common.form.field.error.exceed_max_char",defaultMessage:"Max {length} characters"},integerOutOfRange:{id:"common.form.field.error.integer_out_of_range",defaultMessage:"Integer between {min} and {max}"}}),i=function(e){return function(t){return!t||void 0!==t.length&&!t.length?e(o.required):void 0}},s=function(e){return function(t){return t&&"0"===t?e(o.positiveNumber):void 0}},l=function(e){return function(t){var n=t?t.split("x"):"";return t&&n&&(0===Number(n[0])||0===Number(n[1]))?e(o.formatNotZero):""}},c=function(e){return function(t){return t&&!/^(?!:\/\/)([a-zA-Z0-9-_]+\.)*[a-zA-Z0-9][a-zA-Z0-9-_]+\.[a-zA-Z]{2,11}?$/gim.test(t)?e(o.invalidDomain):void 0}},u=function(e){return function(t){return t&&!/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(t)?e(o.invalidEmail):void 0}},d=function(e){return function(t){return t&&!/^[0-9]+(\.[0-9]{1,2})?$/i.test(t)?e(o.invalidFloat):void 0}},f=function(e){return function(t){return t&&(isNaN(Number(t))||t.length>18)?e(o.invalidNumber):void 0}},p=function(e){return function(t){return t&&!/^\d+$/.test(t)?e(o.invalidNumber):void 0}},m=function(e){return function(t){return t&&Array.isArray(t)&&t.every((function(e){return function(e){return!/^\s*$/.test(e)&&!isNaN(e)}(e)}))?void 0:e(o.invalidNumber)}},g=function(e){return function(t){return function(n){return n&&n.length>=t?e(o.exceedMaxCharacters,{length:t}):void 0}}},y=function(e){return function(t,n){return function(a){return a&&parseInt(a,10)>=t&&parseInt(a,10)<=n?e(o.integerOutOfRange,{min:t,max:n}):void 0}}};t.default=(0,a.compose)(r.injectIntl,(0,a.withProps)((function(e){var t=e.intl.formatMessage;return{fieldValidators:{formatIsNotZero:l(t),isNotZero:s(t),isRequired:i(t),isValidDomain:c(t),isValidEmail:u(t),isValidFloat:d(t),isValidInteger:p(t),isValidDouble:f(t),isValidArrayOfNumber:m(t),isCharLengthLessThan:g(t),isIntegerBetween:y(t)}}})))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WindowBodyPortal=t.OtqlConsole=t.TableSelector=t.LabelsSelector=t.Loading=t.Form=t.EmptyRecords=t.Button=void 0;var a=n(11),r=u(n(618)),o=u(n(24)),i=u(n(272)),s=u(n(798)),l=u(n(2028)),c=u(n(1015));function u(e){return e&&e.__esModule?e:{default:e}}t.Button=a.Button,t.EmptyRecords=r.default,t.Form=o.default,t.Loading=a.Loading,t.LabelsSelector=s.default,t.TableSelector=i.default,t.OtqlConsole=l.default,t.WindowBodyPortal=c.default},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatMetric=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(null!=e&&!isNaN(e))return""+n+(0,o.default)(e).format(t)+a;return"-"},t.unformatMetric=function(e){return void 0!==e?parseInt(e.toString().replace(/[.,]/g,""),10):0},t.normalizeReportView=function(e){var t=e.columns_headers;return e.rows.map((function(e){return t.reduce((function(t,n,a){return Object.assign(Object.assign({},t),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}({},n,e[a]))}),{})}))},t.formatNormalizeReportView=function(e){var t={};if(e.length>0)return Object.keys(e[0]).forEach((function(n){t[n]=e.reduce((function(e,t){return e+t[n]}),0)})),t;return t};var a,r=n(323),o=(a=r)&&a.__esModule?a:{default:a}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(897));t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(25),l=n(35),c=n(6),u=n(10),d=n(8),f=n(1e3),p=(a=f)&&a.__esModule?a:{default:a},m=n(11);var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={conversionModalVisible:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.formId,o=t.message,s=t.onClose,d=t.submitting,f=t.disabled,g=t.convert2Otql,y={disabled:d,htmlType:"submit",onClick:function(){return n&&a&&n((0,l.submit)(a))},type:"primary",className:"mcs-form_saveButton_"+a},h=function(){return e.setState({conversionModalVisible:!1})};return i.createElement(m.Actionbar,r({edition:!0},this.props),o&&!f?i.createElement(u.Button,r({},y,{className:"mcs-primary "+(a?"mcs-form_saveButton_"+a:"")}),i.createElement(m.McsIcon,{type:"plus"}),i.createElement(c.FormattedMessage,o)):null,g&&i.createElement(u.Button,{onClick:function(){return e.setState({conversionModalVisible:!0})}},i.createElement(c.FormattedMessage,{id:"queryTool.query-builder.actionbar.convert",defaultMessage:"Convert to OTQL"})),g&&this.state.conversionModalVisible&&i.createElement(p.default,{onOk:h,onCancel:h,footer:null,visible:this.state.conversionModalVisible,convertQuery:g}),i.createElement(m.McsIcon,{type:"close",className:"close-icon",style:{cursor:"pointer"},onClick:s}))}}]),t}(i.Component);t.default=(0,d.compose)((0,s.connect)((function(e,t){return{submitting:(0,l.isSubmitting)(t.formId)(e)}})))(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.injectDrawer=t.closeNextDrawer=t.openNextDrawer=void 0;var a,r=n(736),o=n(162),i=(a=o)&&a.__esModule?a:{default:a};t.openNextDrawer=r.openNextDrawer,t.closeNextDrawer=r.closeNextDrawer,t.injectDrawer=i.default},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8);function r(e,t){return!e||e&&e.length<16&&/^[0-9]+(\.([0-9]{1,2})?)?$/i.test(e)?e:t}function o(e,t){return!e||e&&e.length<16&&/^\d+$/.test(e)?e:t}t.default=(0,a.compose)((0,a.withProps)((function(){return{fieldNormalizer:{normalizeFloat:r,normalizeInteger:o}}})))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DatamartSelector=t.WhenDatamart=t.injectWorkspace=t.injectDatamart=void 0;var a=s(n(998)),r=s(n(1994)),o=s(n(999)),i=s(n(200));function s(e){return e&&e.__esModule?e:{default:e}}t.injectDatamart=a.default,t.injectWorkspace=r.default,t.WhenDatamart=o.default,t.DatamartSelector=i.default},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStoredConnectedUser=t.getDefaultDatamart=t.getWorkspaces=t.getWorkspace=t.hasWorkspace=t.hasAccessToOrganisation=t.hasDatamarts=t.getDefaultWorkspaceOrganisationName=t.getDefaultWorkspaceOrganisationId=void 0;var a=n(899),r=n(83),o=(0,a.createSelector)((function(e){return e.session.connectedUser.workspaces}),(function(e){return e.session&&e.session.connectedUser&&e.session.connectedUser.default_workspace&&-1!==e.session.connectedUser.default_workspace?e.session.connectedUser.default_workspace:0}),(function(e,t){return e&&e.length&&e[t]})),i=(0,a.createSelector)((function(e){return e.session.connectedUser.workspaces}),(function(e){return e&&e.length&&(0,r.normalizeArrayOfObject)(e,"organisation_id")})),s=(0,a.createSelector)(o,(function(e){return e?e.organisation_id:"none"})),l=(0,a.createSelector)(o,(function(e){return e?e.organisation_id:"none"}));t.getDefaultWorkspaceOrganisationId=s,t.getDefaultWorkspaceOrganisationName=l,t.hasDatamarts=function(e){return function(t){var n=i(e);return n&&n[t]&&n[t].datamarts.length>0}},t.hasAccessToOrganisation=function(e){return function(t){return!!i(e)[t]}},t.hasWorkspace=function(e){return function(t){return!!i(e)[t]}},t.getWorkspace=function(e){return function(t){return i(e)[t]}},t.getWorkspaces=i,t.getDefaultDatamart=function(e){return function(t){var n=i(e);return n&&n[t]&&n[t].datamarts&&n[t].datamarts[0]}},t.getStoredConnectedUser=function(e){return e&&e.session&&e.session.connectedUser}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableView=t.TableViewFilters=void 0;var a=o(n(2022)),r=o(n(335));function o(e){return e&&e.__esModule?e:{default:e}}t.TableViewFilters=a.default,t.TableView=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(25);t.default=(0,a.connect)((function(e){return{colors:e.theme.colors}}),void 0)},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.injectFeatures=void 0;var a,r=n(1074),o=(a=r)&&a.__esModule?a:{default:a};t.injectFeatures=o.default},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFilter=s;var a=i(n(17)),r=i(n(46)),o=n(81);function i(e){return e&&e.__esModule?e:{default:e}}function s(e){if(void 0!==e&&0!==e.length){var t=e.filter((function(e){return void 0!==e&&""!==e.name&&""!==e.value})).map((function(e){return encodeURIComponent(e.name)+"=="+encodeURIComponent(String(e.value))}));return 0!==t.length?t:void 0}}var l={getDisplayCampaignPerformanceReport:function(e,t,n,a,i,l){var c={from:t,to:n},u=(0,o.formatMcsDate)(c,!0),d=s(l),f={organisation_id:e,start_date:u.from,end_date:u.to,dimension:a,metrics:i||["impressions","clicks","cpm","ctr","cpc","impressions_cost"]};return void 0!==d&&(f=Object.assign(Object.assign({},f),{filters:d})),r.default.getRequest("reports/display_campaign_performance_report",f)},getEmailDeliveryReport:function(e,t,n,a,i,l){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},u="reports/delivery_report",d=["email_sent","email_hard_bounced","email_soft_bounced","clicks","impressions"],f={from:t,to:n},p=(0,o.formatMcsDate)(f,!0),m=s(l),g=Object.assign(Object.assign({},c),{organisation_id:e,start_date:p.from,end_date:p.to,dimension:a,metrics:i||d});return void 0!==m&&(g=Object.assign(Object.assign({},g),{filters:m})),r.default.getRequest(u,g)},getSingleDisplayDeliveryReport:function(e,t,n,a,i,s){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},c="reports/display_campaign_performance_report",u=["impressions","clicks","cpm","ctr","cpc","impressions_cost"],d=[""],f={from:n,to:a},p=(0,o.formatMcsDate)(f,!0),m=Object.assign(Object.assign({},l),{organisation_id:e,filters:"campaign_id=="+t,start_date:p.from,end_date:p.to,dimension:i||d,metrics:s||u});return r.default.getRequest(c,m)},getAdGroupDeliveryReport:function(e,t,n,a,i,s,l){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u="reports/ad_group_performance_report",d=[""],f=["impressions","clicks","cpm","ctr","cpc","impressions_cost"],p={from:a,to:i},m=(0,o.formatMcsDate)(p,!0),g=Object.assign(Object.assign({},c),{organisation_id:e,filters:t+"=="+n,start_date:m.from,end_date:m.to,dimension:s||d,metrics:l||f});return r.default.getRequest(u,g)},getAdDeliveryReport:function(e,t,n,a,i,s,l){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u="reports/ad_performance_report",d=[""],f=["impressions","clicks","cpm","ctr","cpc","impressions_cost"],p={from:a,to:i},m=(0,o.formatMcsDate)(p,!0),g=Object.assign(Object.assign({},c),{organisation_id:e,filters:t+"=="+n,start_date:m.from,end_date:m.to,dimension:s||d,metrics:l||f});return r.default.getRequest(u,g)},getMediaDeliveryReport:function(e,t,n,a,i,s,l){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u="reports/media_performance_report",d=["impressions","clicks","cpm","ctr","cpc","impressions_cost"],f={from:a,to:i},p=(0,o.formatMcsDate)(f,!0),m=["display_network_id","display_network_name","format"],g=Object.assign(Object.assign({},c),{organisation_id:e,filters:t+"=="+n,start_date:p.from,end_date:p.to,dimension:s||m,metrics:l||d});return r.default.getRequest(u,g)},getSingleEmailDeliveryReport:function(e,t,n,i,s,l){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},u="reports/delivery_report",d=["email_sent","email_hard_bounced","email_soft_bounced","clicks","impressions","email_unsubscribed","email_complaints","uniq_impressions","uniq_clicks","uniq_email_sent","uniq_email_unsubscribed","uniq_email_hard_bounced","uniq_email_soft_bounced","uniq_email_complaints"],f={from:n,to:i},p=(0,o.formatMcsDate)(f,!0),m=Object.assign(Object.assign({},c),{organisation_id:e,filters:"campaign_id=="+t,start_date:p.from,end_date:p.to,dimension:s,metrics:l||d});return r.default.getRequest(u,m).then((function(e){for(var t=e.data.report_view.rows,n=[],r=function(e){var a=t.find((function(t){return"string"==typeof t[0]?t[0]===e.format("YYYY-MM-DD"):t[0]===e.valueOf()}));if(a)n.push(a);else{var r=[];r.push(e.format("YYYY-MM-DD")),m.metrics.forEach((function(){r.push(0)})),n.push(r)}},o=(0,a.default)(m.start_date);o.diff((0,a.default)(m.end_date))<0;o.add("days",1))r(o);return e.data.report_view.rows=n,e}))},getConversionPerformanceReport:function(e,t,n,a,i,l){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},u="reports/conversion_performance_report",d=["conversions","value"],f={from:t,to:n},p=(0,o.formatMcsDate)(f,!0),m=s(l),g=Object.assign(Object.assign({},c),{organisation_id:e,start_date:p.from,end_date:p.to,dimension:a,metrics:i||d});return void 0!==m&&(g=Object.assign(Object.assign({},g),{filters:m})),r.default.getRequest(u,g)},getSingleConversionPerformanceReport:function(e,t,n,a,i,s){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},c="reports/conversion_performance_report",u=["conversions","value"],d={from:n,to:a},f=(0,o.formatMcsDate)(d,!0),p=Object.assign(Object.assign({},l),{organisation_id:e,start_date:f.from,end_date:f.to,filters:"goal_id=="+t,dimension:i,metrics:s||u});return r.default.getRequest(c,p)},getAudienceSegmentReport:function(e,t,n,a,i,l){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},u="reports/audience_segment_report",d=["user_points","user_accounts","emails","desktop_cookie_ids","user_point_additions","user_point_deletions"],f={from:t,to:n},p=(0,o.formatMcsDate)(f,!0),m=s(l),g=Object.assign(Object.assign({},c),{organisation_id:e,start_date:p.from,end_date:p.to,dimension:a,metrics:i||d});return void 0!==m&&(g=Object.assign(Object.assign({},g),{filters:m})),r.default.getRequest(u,g)},getAllEmailBlastPerformance:function(e,t,n,a,i,s){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},c="reports/delivery_report",u=["email_sent","email_hard_bounced","email_soft_bounced","clicks","impressions","email_unsubscribed","email_complaints","uniq_impressions","uniq_clicks","uniq_email_sent","uniq_email_unsubscribed","uniq_email_hard_bounced","uniq_email_soft_bounced","uniq_email_complaints"],d={from:n,to:a},f=(0,o.formatMcsDate)(d,!0),p=Object.assign(Object.assign({},l),{organisation_id:e,start_date:f.from,end_date:f.to,dimension:i,metrics:s||u});return r.default.getRequest(c,p)},getConversionAttributionPerformance:function(e,t,n,a,i,l,c){var u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},d="reports/conversion_attribution_performance_report",f=["day","interaction_type"],p=["weighted_conversions","interaction_to_conversion_duration"],m={from:t,to:n},g=(0,o.formatMcsDate)(m,!0),y=s(c),h=Object.assign(Object.assign({},u),{organisation_id:e,start_date:g.from,end_date:g.to,dimension:i||f,metrics:l||p,filters:a});return void 0!==y&&(h=Object.assign(Object.assign({},h),{filters:y})),r.default.getRequest(d,h)},getVisitReport:function(e,t,n,a,i,s){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},c="reports/visit_report",u=["day"],d=["max_duration","min_duration","avg_duration","unique_user","count","unique_visitor"],f={from:t,to:n},p=(0,o.formatMcsDate)(f,!0),m=Object.assign(Object.assign({},l),{organisation_id:e,start_date:p.from,end_date:p.to,dimension:i||u,metrics:s||d,filters:a});return r.default.getRequest(c,m)}};t.default=l},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t.isNowFormat=function(e){return!("string"!=typeof e||!/^now-(\d+)d$/g.test(e)&&"now"!==e)},t.isValidMcsDate=s,t.convertMcsDateToMoment=l,t.formatMcsDate=function(e,t){var n=e.from.toMoment().format("YYYY-MM-DD"),a=t?e.to.toMoment().add(1,"day").format("YYYY-MM-DD"):e.to.toMoment().format("YYYY-MM-DD");return{from:n,to:a}};var r,o=n(17),i=(r=o)&&r.__esModule?r:{default:r};function s(e){return!("string"!=typeof e||!/^now-(\d+)d$/g.test(e))||(!("string"!=typeof e||!/^now$/g.test(e))||!!(0,i.default)(e).isValid())}function l(e){if("string"==typeof e&&/^now-(\d+)d$/g.test(e)){var t=e.replace("now-","").replace("d","");return(0,i.default)().subtract(t,"days")}return"now"===e?(0,i.default)():(0,i.default)(e)}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.value=t}return a(e,[{key:"toMoment",value:function(){return l(this.value)}},{key:"raw",value:function(){return this.value}},{key:"isValid",value:function(){return s(this.value)}},{key:"toString",value:function(){return this.value}}]),e}();t.default=c},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeArrayOfObject=function(e,t){if(!Array.isArray(e))throw new Error(e+" is not an array");return e.reduce((function(e,n){var a=n[t];if(a){var r=a.toString();return Object.assign(Object.assign({},e),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}({},r,n))}return""}),{})},t.formateList=function(e){return Object.keys(e).map((function(t){return e[t]}))},t.formatListView=function(e,t){return Object.keys(e.items).map((function(n){return Object.assign(Object.assign({},e.items[n]),t.items[n])}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(77),s=n(11);var l=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},c={labelCol:{span:3},wrapperCol:{span:15,offset:1}},u={align:"middle"},d=function(e){var t=e.children,n=e.hasMarginBottom,d=e.helpToolTipProps,f=e.hoverToolTipProps,p=e.rowProps,m=e.label,g=e.renderFieldAction,y=e.small,h=l(e,["children","hasMarginBottom","helpToolTipProps","hoverToolTipProps","rowProps","label","renderFieldAction","small"]),v=y?r.createElement("span",null,r.createElement("span",{className:"field-label"},m),r.createElement("div",{className:"field-helper"},d&&d.title)):r.createElement("span",{className:"field-label"},m);return r.createElement("div",{className:n?"":"form-field-wrapper"},r.createElement(i.Form.Item,a({label:m&&v},!y&&c,h),r.createElement(o.Row,a({},u,p),f&&f.title&&!y?r.createElement(o.Tooltip,a({placement:"top"},f),r.createElement(o.Col,{span:20},t)):r.createElement(o.Col,{span:y?24:20},t),d&&d.title&&!y?r.createElement(o.Col,{span:2,className:"field-tooltip"},r.createElement(o.Tooltip,{title:null==d?void 0:d.title,placement:"right"},r.createElement(s.McsIcon,{type:"info"}))):void 0,void 0!==g?r.createElement(o.Col,{span:2,className:"renderFieldAction"},g()):r.createElement(o.Col,{span:2,className:"no-renderFieldAction"}))))};d.defaultProps={hasMarginBottom:!1,small:!1},t.default=d},,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({cancel:{id:"message.cancel",defaultMessage:"Cancel"},ok:{id:"message.ok",defaultMessage:"Ok"},saveAdGroup:{id:"message.submit.adGroup",defaultMessage:"Save"},saveCampaigns:{id:"message.submit.campaigns",defaultMessage:"Save"},editCampaigns:{id:"editCampaigns.breadCrumb",defaultMessage:"Edit Campaigns"},editAdGroups:{id:"editAdGroups.breadCrumb",defaultMessage:"Edit Ad Groups"},multiEditTitle:{id:"editCampaigns.title",defaultMessage:"Multi Campaign Edit"},multiEditSubtitle:{id:"editCampaigns.subtitle",defaultMessage:"In this section you will be able to edit campaigns you just selected :"},multiEditAdGroupsTitle:{id:"editAdGroups.title",defaultMessage:"Multi Ad Group Edit"},warningOnTokenEdition:{id:"campaign.form.edition.technicalName.warning",defaultMessage:"Danger Zone: Editing this technical name may cause any integrations to fail if not updated properly. Please make sure you have reviewed all your integration before saving."},breadcrumbTitle1:{id:"adGroupEditor.breadcrumb.title1",defaultMessage:"Display"},breadcrumbTitle2:{id:"adGroupEditor.breadcrumb.title2",defaultMessage:"New Ad Group"},breadcrumbTitle3:{id:"adGroupEditor.breadcrumb.title3",defaultMessage:"Edit {name}"},toggleOn:{id:"adGroupEditor.section2.toggleOn",defaultMessage:"Target"},toggleOff:{id:"adGroupEditor.section2.toggleOff",defaultMessage:"Exclude"},noResults:{id:"adGroupEditor.noResults",defaultMessage:"[X]"},dropdownNew:{id:"adGroupEditor.dropdown.new",defaultMessage:"New"},dropdownAdd:{id:"adGroupEditor.dropdown.add",defaultMessage:"Add"},dropdownAddExisting:{id:"adGroupEditor.dropdown.addExisting",defaultMessage:"Add Existing"},dropdownAddOwn:{id:"adGroupEditor.dropdown.addOwn",defaultMessage:"Add Own Segment"},dropdownAddShared:{id:"adGroupEditor.dropdown.addShared",defaultMessage:"Add Shared Segment"},notificationWarning:{id:"notification.warning",defaultMessage:"Click on this button and you will lose your custom targeting."},sectionTitleGeneral:{id:"adGroupEditor.section.title.general",defaultMessage:"General settings"},sectionTitleAudience:{id:"adGroupEditor.section.title.audience",defaultMessage:"Audience"},sectionTitleLocationTargeting:{id:"adGroupEditor.section.title3bis",defaultMessage:"Location Targeting"},sectionTitleDeviceTargeting:{id:"adGroupEditor.section.title.device",defaultMessage:"Device Targeting"},sectionTitleDevice:{id:"adGroupEditor.section.title.device",defaultMessage:"Device Targeting"},sectionTitlePublisher:{id:"adGroupEditor.section.title.publisher",defaultMessage:"Publisher"},sectionTitleMedia:{id:"adGroupEditor.section.title.media",defaultMessage:"Media Content"},sectionTitleAds:{id:"adGroupEditor.section.title.ads",defaultMessage:"Ads"},sectionTitleSummary:{id:"adGroupEditor.section.title.summary",defaultMessage:"Summary"},sectionSubtitleGeneral:{id:"adGroupEditor.section.subtitle.general",defaultMessage:"Give your ad group a name and a duration"},sectionSubtitleAudience:{id:"adGroupEditor.section.subtitle.audience",defaultMessage:"Choose to whom your ad group will be displayed to"},sectionSubtitleDevice:{id:"adGroupEditor.section.subtitle.device",defaultMessage:"Be more specific on which device you want to advertise"},sectionSubtitleLocation:{id:"adGroupEditor.section.subtitle.location",defaultMessage:"Be more specific on which location you want to advertise (country, region or department)"},sectionSubtitlePublisher:{id:"adGroupEditor.section.subtitle.publisher",defaultMessage:"Select your network to reach you audience"},sectionSubtitleMedia:{id:"adGroupEditor.section.subtitle.media",defaultMessage:"Define on which websites you want your content to appear or which section of the website"},sectionSubtitleAds:{id:"adGroupEditor.section.subtitle.ads",defaultMessage:"This section helps you add new ads to your ad group"},sectionSubtitleSummary:{id:"adGroupEditor.section.subtitle.summary",defaultMessage:"Please find below the configuration of your ad group"},contentSectionGeneralRow1Label:{id:"campaign.section.general.row1.label",defaultMessage:"Campaign Name"},labelAdGroupName:{id:"adGroupEditor.label.adgroup.name",defaultMessage:"Ad Group Name"},contentSectionGeneralRow1Placeholder:{id:"adGroupEditor.section.general.row1.placeholder",defaultMessage:"This is an ad group"},campaignFormPlaceholderCampaignName:{id:"campaign.form.section.general.placeholder.name",defaultMessage:"Your campaign name"},contentSectionGeneralRow1Tooltip:{id:"adGroupEditor.section.general.row1.tooltip",defaultMessage:"The campaign name will help you identify it on the different screens. Make it as memorable as you want your results to be!"},contentSectionGeneralRow2Label:{id:"adGroupEditor.section.general.row2.label",defaultMessage:"Budget Split"},contentSectionGeneralRow2Placeholder:{id:"adGroupEditor.section.general.row2.placeholder",defaultMessage:"500"},contentSectionGeneralRow2Tooltip:{id:"adGroupEditor.section.general.row2.tooltip",defaultMessage:"Lorem ipsum"},contentSectionGeneralRow2OptionDAY:{id:"adGroupEditor.section.general.row2.optionDAY",defaultMessage:"Per Day"},contentSectionGeneralRow2OptionWEEK:{id:"adGroupEditor.section.general.row2.optionWEEK",defaultMessage:"Per Week"},contentSectionGeneralRow2OptionMONTH:{id:"adGroupEditor.section.general.row2.option1MONTH",defaultMessage:"Per Month"},contentSectionGeneralRow3Label:{id:"adGroupEditor.section.general.row3.label",defaultMessage:"Total Budget"},contentSectionGeneralRow3Placeholder:{id:"adGroupEditor.section.general.row3.placeholder",defaultMessage:"1 500"},contentSectionGeneralRow3Tooltip:{id:"adGroupEditor.section.general.row3.tooltip",defaultMessage:"Lorem ipsum"},contentSectionGeneralRow4Label:{id:"adGroupEditor.section.general.row4.label",defaultMessage:"Duration"},contentSectionGeneralRow4Placeholder1:{id:"adGroupEditor.section.general.row4.placeholder1",defaultMessage:"Start date"},contentSectionGeneralRow4Placeholder2:{id:"adGroupEditor.section.general.row4.placeholder2",defaultMessage:"End date"},contentSectionGeneralRow4Tooltip:{id:"adGroupEditor.section.general.row4.tooltip",defaultMessage:"Lorem ipsum"},contentSectionGeneralRow5Label:{id:"adGroupEditor.section.general.row5.label",defaultMessage:"Max Bid Price"},contentSectionGeneralRow5Placeholder:{id:"adGroupEditor.section.general.row5.placeholder",defaultMessage:"1.3"},contentSectionGeneralRow5Tooltip:{id:"adGroupEditor.section.general.row5.tooltip",defaultMessage:"The max bid price is the max CPM you will pay during the auction"},contentSectionGeneralRow6Label:{id:"adGroupEditor.section.general.row6.label",defaultMessage:"Total Impression Capping"},contentSectionGeneralRow6Placeholder:{id:"adGroupEditor.section.general.row6.placeholder",defaultMessage:"10"},contentSectionGeneralRow6Tooltip:{id:"adGroupEditor.section.general.row6.tooltip",defaultMessage:"The capping is at the device level, if you don't want any capping at the ad group level set it to 0 and the capping used will be the one defined at the campaign"},contentSectionGeneralRow7Label:{id:"adGroupEditor.section.general.row7.label",defaultMessage:"Daily Impression Capping"},contentSectionGeneralRow7Placeholder:{id:"adGroupEditor.section.general.row7.placeholder",defaultMessage:"1"},contentSectionGeneralRow7Tooltip:{id:"adGroupEditor.section.general.row7.tooltip",defaultMessage:"The capping is at the device level, if you don't want any capping at the ad group level set it to 0 and the capping used will be the one defined at the campaign"},contentSectionGeneralAdvancedPartTitle:{id:"adGroupEditor.section.general.advancedPart.title",defaultMessage:"Advanced"},contentSectionGeneralRow8Label:{id:"adGroupEditor.section.general.row8.label",defaultMessage:"Technical Name"},contentSectionGeneralRow8Placeholder:{id:"adGroupEditor.section.general.row8.placeholder",defaultMessage:"This is an ad group"},contentSectionGeneralRow8Tooltip:{id:"adGroupEditor.section.general.row8.tooltip",defaultMessage:"Lorem ipsum"},contentSectionAudienceMedium1:{id:"adGroupEditor.section.audience.medium1",defaultMessage:"User Points"},contentSectionAudienceMedium2:{id:"adGroupEditor.section.audience.medium2",defaultMessage:"Desktop"},contentSectionAudienceEmptyTitle:{id:"adGroupEditor.section.audience.emptyTitle",defaultMessage:"Click on the pen to add an audience to your ad group"},contentSectionDevicePart1Message:{id:"adGroupEditor.section.device.part1.message",defaultMessage:"I want to target a specific device/os/carrier"},contentSectionDevicePart1Row1Label:{id:"adGroupEditor.section.device.part1.row1.label",defaultMessage:"Device Type"},contentSectionDevicePart1Row1Placeholder:{id:"adGroupEditor.section.device.part1.row1.placeholder",defaultMessage:"Please select"},contentSectionDevicePart1Row1Tooltip:{id:"adGroupEditor.section.device.part1.row1.tooltip",defaultMessage:"Lorem ipsum"},contentSectionDevicePart1Row2Label:{id:"adGroupEditor.section.device.part1.row2.label",defaultMessage:"OS"},contentSectionDevicePart1Row2Placeholder:{id:"adGroupEditor.section.device.part1.row2.placeholder",defaultMessage:"Please select"},contentSectionDevicePart1Row2Tooltip:{id:"adGroupEditor.section.device.part1.row2.tooltip",defaultMessage:"Lorem ipsum"},contentSectionDevicePart1Row3Label:{id:"adGroupEditor.section.device.part1.row3.label",defaultMessage:"Browser"},contentSectionDevicePart1Row3Tooltip:{id:"adGroupEditor.section.device.part1.row3.tooltip",defaultMessage:"Lorem ipsum"},contentSectionDevicePart1Row3Placeholder:{id:"adGroupEditor.section.device.part1.row3.placeholder",defaultMessage:"http://www..."},contentSectionDevicePart1Row4Label:{id:"adGroupEditor.section.device.part1.row4.label",defaultMessage:"Carrier"},contentSectionDevicePart1Row4Tooltip:{id:"adGroupEditor.section.device.part1.row4.tooltip",defaultMessage:"Lorem ipsum"},contentSectionDeviceOSTooltip:{id:"adGroup.section.device.operating_system.tooltip",defaultMessage:"Operating system filter"},contentSectionDeviceOSLabel:{id:"adGroup.section.device.operating_system.label",defaultMessage:"Operating System"},contentSectionDeviceOSAll:{id:"adGroup.section.device.operating_system.all",defaultMessage:"All"},contentSectionDeviceOSiOS:{id:"adGroup.section.device.operating_system.ios",defaultMessage:"iOS"},contentSectionDeviceOSAndroid:{id:"adGroup.section.device.operating_system.and",defaultMessage:"Android"},contentSectionDeviceOSWindowsPhone:{id:"adGroup.section.device.operating_system.wip",defaultMessage:"Windows Phone"},contentSectionDeviceTypeTooltip:{id:"adGroup.section.device.type.tooltip",defaultMessage:"Device type filter"},contentSectionDeviceTypeLabel:{id:"adGroup.section.device.type.label",defaultMessage:"Device Type"},contentSectionDeviceTypeAll:{id:"adGroup.section.device.type.all",defaultMessage:"All"},contentSectionDeviceTypeDesktop:{id:"adGroup.section.device.type.desktop",defaultMessage:"Desktop"},contentSectionDeviceTypeMobile:{id:"adGroup.section.device.type.mobile",defaultMessage:"Mobile"},contentSectionDeviceTypeTablet:{id:"adGroup.section.device.type.tablet",defaultMessage:"Tablet"},contentSectionDeviceTypeMobileAndTablet:{id:"adGroup.section.device.type.mobile_and_tablet",defaultMessage:"Mobile and Tablet"},contentSectionDeviceMediaTypeTooltip:{id:"adGroup.section.device.media_type.tooltip",defaultMessage:"Media type filter"},contentSectionDeviceMediaTypeLabel:{id:"adGroup.section.device.media_type.label",defaultMessage:"Media Type"},contentSectionDeviceMediaTypeWebsite:{id:"adGroup.section.device.media_type.website",defaultMessage:"Website"},contentSectionDeviceMediaTypeMobileApp:{id:"adGroup.section.device.media_type.mobile_app",defaultMessage:"Mobile App"},contentSectionDeviceConnectionTypeTooltip:{id:"adGroup.section.device.connection_type.tooltip",defaultMessage:"Connection type filter"},contentSectionDeviceConnectionTypeLabel:{id:"adGroup.section.device.connection_type.label",defaultMessage:"Connection Type"},contentSectionDeviceConnectionTypeAll:{id:"adGroup.section.device.connection_type.all",defaultMessage:"All"},contentSectionDeviceConnectionTypeEthernet:{id:"adGroup.section.device.connection_type.ethernet",defaultMessage:"Ethernet"},contentSectionDeviceConnectionTypeWifi:{id:"adGroup.section.device.connection_type.wifi",defaultMessage:"Wifi"},contentSectionDeviceConnectionType2G:{id:"adGroup.section.device.connection_type.2g",defaultMessage:"2G"},contentSectionDeviceConnectionType3G:{id:"adGroup.section.device.connection_type.3g",defaultMessage:"3G"},contentSectionDeviceConnectionType4G:{id:"adGroup.section.device.connection_type.4g",defaultMessage:"4G"},contentSectionDeviceBrowserTooltip:{id:"adGroup.section.device.browser_family.tooltip",defaultMessage:"Browser filter"},contentSectionDeviceBrowserLabel:{id:"adGroup.section.device.browser_family.label",defaultMessage:"Browser"},contentSectionDeviceBrowserAll:{id:"adGroup.section.device.browser_family.all",defaultMessage:"All"},contentSectionDeviceBrowserChrome:{id:"adGroup.section.device.browser_family.chrome",defaultMessage:"Chrome"},contentSectionDeviceBrowserFirefox:{id:"adGroup.section.device.browser_family.firefox",defaultMessage:"Firefox"},contentSectionDeviceBrowserSafari:{id:"adGroup.section.device.browser_family.safari",defaultMessage:"Safari"},contentSectionDeviceBrowserIE:{id:"adGroup.section.device.browser_family.ie",defaultMessage:"Internet Explorer"},contentSectionDeviceBrowserOpera:{id:"adGroup.section.device.browser_family.opera",defaultMessage:"Opera"},contentSectionDeviceModal1:{id:"adGroupEditor.section.device.modal1",defaultMessage:"You can't add a device that is inside an already included or excluded device."},contentSectionDeviceModal1Title:{id:"adGroupEditor.section.device.modal1Title",defaultMessage:"Warning"},contentSectionDeviceModal2:{id:"adGroupEditor.section.device.modal2",defaultMessage:"By adding this device the following device will be removed, do you want to proceed?"},contentSectionDeviceModal2Title:{id:"adGroupEditor.section.device.modal2Title",defaultMessage:"Warning"},contentSectionLocationPart2Message:{id:"adGroupEditor.section.location.part2.message",defaultMessage:"I want to target a specific location"},contentSectionLocationPart2Row1Label:{id:"adGroupEditor.section.location.part2.row1.label",defaultMessage:"Location :"},contentSectionLocationInputPlaceholder:{id:"adGroupEditor.section.location.inputPlaceholder",defaultMessage:"Enter a location (country, region or department)"},contentSectionLocationTooltipMessage:{id:"adGroupEditor.section.location.tooltipMessage",defaultMessage:"Location is based on the IP address we receive during a bid request. Being too restrictive can alter your reach."},contentSectionLocationOption1:{id:"adGroupEditor.section.location.option1",defaultMessage:"Include"},contentSectionLocationOption2:{id:"adGroupEditor.section.location.option2",defaultMessage:"Exclude"},contentSectionLocationModal1:{id:"adGroupEditor.section.location.modal1",defaultMessage:"You can't add a area that is inside an already included or excluded area."},contentSectionLocationModal1Title:{id:"adGroupEditor.section.location.modal1Title",defaultMessage:"Warning"},contentSectionLocationModal2:{id:"adGroupEditor.section.location.modal2",defaultMessage:"By adding this location the following location will be removed, do you want to proceed?"},contentSectionLocationModal2Title:{id:"adGroupEditor.section.location.modal2Title",defaultMessage:"Warning"},contentSectionMediaEmptyTitle:{id:"adGroupEditor.section.media.emptyTitle",defaultMessage:"Click on the pen to add a media to your ad group"},contentSectionPublisherEmptyTitle:{id:"adGroupEditor.section.publisher.emptyTitle",defaultMessage:"Click on the pen to add a publisher to your ad group"},contentSectionAdEmptyTitle:{id:"adGroupEditor.section.ad.emptyTitle",defaultMessage:"Click on the button to add an ad to your ad group"},updateDisplayCreative:{id:"adGroupEditor.section.ad.updateAd",defaultMessage:"Update"},editDisplayCreative:{id:"adGroupEditor.section.ad.editDisplayCreative",defaultMessage:"Edit Display Creative"},addNewCreative:{id:"adGroupEditor.section.ad.addNewCreative",defaultMessage:"Add"},contentSectionSummaryPart1Group1:{id:"adGroupEditor.section.summary.part1.group1",defaultMessage:"Your ad group will run from"},contentSectionSummaryPart1Group2:{id:"adGroupEditor.section.summary.part1.group2",defaultMessage:"the"},contentSectionSummaryPart1Group3:{id:"adGroupEditor.section.summary.part1.group3",defaultMessage:"today"},contentSectionSummaryPart1Group4:{id:"adGroupEditor.section.summary.part1.group4",defaultMessage:"to the"},contentSectionSummaryPart1Group5:{id:"adGroupEditor.section.summary.part1.group5",defaultMessage:"with a"},contentSectionSummaryPart1Group7:{id:"adGroupEditor.section.summary.part1.group7",defaultMessage:"budget of"},contentSectionSummaryPart1Group8:{id:"adGroupEditor.section.summary.part1.group8",defaultMessage:"€"},contentSectionSummaryPart4:{id:"adGroupEditor.section.summary.part4",defaultMessage:"Your ad will target the following devices:"},contentSectionSummaryPart5:{id:"adGroupEditor.section.summary.part5",defaultMessage:"Your ad will target the following areas:"},contentSectionIncludedLocations:{id:"adGroupEditor.PartIncludedLocations",defaultMessage:"Your ad will target the following locations:"},contentSectionExcludedLocations:{id:"adGroupEditor.PartExcludedLocations",defaultMessage:"Your ad will exclude the following locations:"},contentSectionSummaryPart7:{id:"adGroupEditor.section.summary.part7",defaultMessage:"Your ad will target the following keywords:"},contentSectionSummaryPart9Group1:{id:"adGroupEditor.section.summary.part9.group1",defaultMessage:"You have"},contentSectionSummaryPart9Negation:{id:"adGroupEditor.section.summary.part9.negation",defaultMessage:"no"},contentSectionSummaryPart9Group2:{id:"adGroupEditor.section.summary.part9.group2",defaultMessage:"attached to your ad"},contentSectionSummaryPart9Singular:{id:"adGroupEditor.section.summary.part9.Singular",defaultMessage:"creative"},contentSectionSummaryPart9Plural:{id:"adGroupEditor.section.summary.part9.Plural",defaultMessage:"creatives"},sectionSelectorTitleUserPoints:{id:"section.selector.title.userPoints",defaultMessage:"User Points"},sectionSelectorTitleCookieIds:{id:"section.selector.title.cookieIds",defaultMessage:"Desktop Cookie Ids"},goalPixelModalTitle:{id:"goal.pixel.modal.title",defaultMessage:"Your Goal Pixel"},getCodeSnippet:{id:"goal.pixel.get.code.snippet",defaultMessage:"Get code snippet"},goalPixelModalContent:{id:"goal.pixel.modal.content",defaultMessage:"Please find your goal pixel below. Give this code to your web administrator or your web developer so that it can be placed on the page that will trigger the goal. For instance, place it on your receipt page to get all the users that have bought something from your store."},goalPixelModalSaveGoal:{id:"goal.pixel.modal.saveGoal",defaultMessage:"Before getting your pixel, we need to save your Goal. After saving you will still be able to modify your goal. Do you want to continue?"},errorFormMessage:{id:"display.campaigns.edit.generic.errorMessage",defaultMessage:"There is an error with some fields in your form. Please review the data you entered."},createCampaingTitle:{id:"campaignEditor.breadcrumb.create.campaign",defaultMessage:"New Campaign"},sectionTitle1:{id:"campaignEditor.section.title1",defaultMessage:"General Information"},sectionTitle2:{id:"campaignEditor.section.title2",defaultMessage:"Goals"},sectionTitle3:{id:"campaignEditor.section.title3",defaultMessage:"Ad Groups"},sectionSubtitle1:{id:"campaignEditor.section.subtitle1",defaultMessage:"Give your Campaign a name."},sectionSubtitle2:{id:"campaignEditor.section.subtitle2",defaultMessage:"Create a Goal that reflects your campaign objectives. You will get a pixel code afterwards to track who has converted to your goal."},sectionSubtitle3:{id:"campaignEditor.section.subtitle3",defaultMessage:"Create one or severals Ad Groups. An Ad Group is basically a Campaign Strategy that has its own Budget, and targeting."},contentSectionGeneralAdvancedPartRow1Label:{id:"campaignEditor.section1.advancedPart.row1.label",defaultMessage:"Technical Name"},contentSectionGeneralAdvancedPartRow1Placeholder:{id:"campaignEditor.section1.advancedPart.row1.placeholder",defaultMessage:"Technical Name"},contentSectionGeneralAdvancedPartRow1Tooltip:{id:"campaignEditor.section1.advancedPart.row1.tooltip",defaultMessage:"Use the Technical Name for custom integration with other DSPs"},contentSectionGeneralAdvancedPartRow2Label:{id:"campaignEditor.section1.advancedPart.row2.label",defaultMessage:"Total Impression Capping"},contentSectionGeneralAdvancedPartRow2Placeholder:{id:"campaignEditor.section1.advancedPart.row2.placeholder",defaultMessage:"10"},contentSectionGeneralAdvancedPartRow2Tooltip:{id:"campaignEditor.section1.advancedPart.row2.tooltip",defaultMessage:"The capping is at the device level, if you don't want any capping set it to 0"},contentSectionGeneralAdvancedPartRow3Label:{id:"campaignEditor.section1.advancedPart.row3.label",defaultMessage:"Daily Impression Capping"},contentSectionGeneralAdvancedPartRow3Placeholder:{id:"campaignEditor.section1.advancedPart.row3.placeholder",defaultMessage:"1"},contentSectionGeneralAdvancedPartRow3Tooltip:{id:"campaignEditor.section1.advancedPart.row3.tooltip",defaultMessage:"The capping is at the device level, if you don't want any capping set it to 0"},contentSectionGeneralAdvancedPartRow4Label:{id:"campaignEditor.section1.advancedPart.row4.label",defaultMessage:"Total Budget"},contentSectionGeneralAdvancedPartRow4Placeholder:{id:"campaignEditor.section1.advancedPart.row4.placeholder",defaultMessage:"500"},contentSectionGeneralAdvancedPartRow4Tooltip:{id:"campaignEditor.section1.advancedPart.row4.tooltip",defaultMessage:"Define the total budget of your campaign."},contentSectionGeneralAdvancedPartRow5Label:{id:"campaignEditor.section1.advancedPart.row5.label",defaultMessage:"Budget Split"},contentSectionGeneralAdvancedPartRow5Placeholder:{id:"campaignEditor.section1.advancedPart.row5.placeholder",defaultMessage:"500"},contentSectionGeneralAdvancedPartRow5Tooltip:{id:"campaignEditor.section1.advancedPart.row5.tooltip",defaultMessage:"Define the budget split of your campaign."},contentSectionGeneralRow5OptionDAY:{id:"adGroupEditor.section.general.row5.optionDAY",defaultMessage:"Per Day"},contentSectionGeneralRow5OptionWEEK:{id:"adGroupEditor.section.general.row5.optionWEEK",defaultMessage:"Per Week"},contentSectionGeneralRow5OptionMONTH:{id:"adGroupEditor.section.general.row5.option1MONTH",defaultMessage:"Per Month"},contentSection2Medium1:{id:"campaignEditor.section2.medium1",defaultMessage:"Post View"},contentSection2Medium2:{id:"campaignEditor.section2.medium2",defaultMessage:"Post Click"},campaignGoalSelectionEmpty:{id:"campaignEditor.section2.emptyTitle",defaultMessage:"Click on the pen to add a Goal to your Campaign"},contentSection3EmptyTitle:{id:"campaignEditor.section3.emptyTitle",defaultMessage:"Click on the pen to add an Ad Group to your Campaign"},newGoal:{id:"campaignEditor.goal-form.new",defaultMessage:"New Goal"},editGoal:{id:"campaignEditor.goal-form.edit",defaultMessage:"Edit {goalName}"},editAdGroup:{id:"campaignEditor.adGroup-form.edit",defaultMessage:"Edit {adGroupName}"},savingInProgress:{id:"display.campaigns.edit.savingInProgress",defaultMessage:"Saving in progress"},sectionInventoryTitle:{id:"campaignEditor.sectionInventory.title",defaultMessage:"Inventory Selection"},sectionInventorySubTitle:{id:"campaignEditor.sectionInventory.subtitle",defaultMessage:"Add Display Networks, Ad Exchanges and Deal Lists to your Adgroup."}})},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(33),s=n(13),l=n(10),c=n(8),u=n(6),d=n(2025),f=(a=d)&&a.__esModule?a:{default:a},p=n(11);function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=l.Layout.Sider,h=function(e){function t(){return m(this,t),g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.items,n=e.scrollId,a=e.intl,r=e.match.url,s=t.map((function(e){return e.sectionId})),l=t.map((function(e){var t=o.createElement("div",null,o.createElement(p.McsIcon,{type:"check-rounded-inverted"}),o.createElement("span",{className:"step-title"},"string"!=typeof e.title?a.formatMessage(e.title):e.title));if(e.onClick){return o.createElement("li",{key:e.sectionId},o.createElement(p.Button,{className:e.type,onClick:function(){return e.onClick(e.sectionId)}},t))}return o.createElement("li",{key:e.sectionId},o.createElement(i.Link,{to:r+"#"+e.sectionId},t))}));return o.createElement(y,{className:"stepper"},o.createElement(f.default,{currentClassName:"currentStep",items:s,rootEl:"#"+n},l))}}]),t}(o.Component);t.default=(0,c.compose)(u.injectIntl,s.withRouter)(h)},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STORE_SELECTED_DATAMART=t.STORE_FEATURE_FLAG_CLIENT=t.STORE_ORG_FEATURES=t.STORE_THEME_COLOR=t.PUT_LOGO=t.GET_LOGO=t.LABELS_RESET=t.LABELS_FETCH=t.SIDEBAR_SWITCH_VISIBILITY=t.WORKSPACE=t.CONNECTED_USER=t.LOG_OUT=t.LOG_IN=t.SESSION_SWITCH_WORKSPACE=t.SESSION_LOGOUT=t.SESSION_IS_REACT_URL=t.SESSION_INIT_WORKSPACE=t.SESSION_GET_WORKSPACES_REQUEST_SUCCESS=t.SESSION_GET_WORKSPACES_REQUEST_FAILURE=t.SESSION_GET_WORKSPACES_REQUEST=t.SESSION_GET_CONNECTED_USER_REQUEST_SUCCESS=t.SESSION_GET_CONNECTED_USER_REQUEST_FAILURE=t.SESSION_GET_CONNECTED_USER_REQUEST=t.SESSION_GET_ACCESS_TOKEN_REQUEST_SUCCESS=t.SESSION_GET_ACCESS_TOKEN_REQUEST_FAILURE=t.SESSION_GET_ACCESS_TOKEN_REQUEST=t.NAVIGATOR_GET_VERSION=t.NOTIFICATIONS_RESET=t.NOTIFICATIONS_REMOVE=t.NOTIFICATIONS_ADD=t.PASSWORD_FORGOT_RESET=t.PASSWORD_FORGOT=t.LOGIN_RESET=t.LOGIN_REFRESH_TOKEN_REQUEST_SUCCESS=t.LOGIN_REFRESH_TOKEN_REQUEST_FAILURE=t.LOGIN_REFRESH_TOKEN_REQUEST=t.HEADER_SWITCH_VISIBILITY=t.FETCH_COOKIES=t.MENU_OPEN_CLOSE=t.APP_STARTUP=t.ACTION_BAR_BREADCRUMB_SET=t.ACTION_BAR_BREADCRUMB_PUSH=t.ACTION_BAR_BREADCRUMB_POP=void 0;var a=n(1312);t.ACTION_BAR_BREADCRUMB_POP="ACTION_BAR_BREADCRUMB_POP",t.ACTION_BAR_BREADCRUMB_PUSH="ACTION_BAR_BREADCRUMB_PUSH",t.ACTION_BAR_BREADCRUMB_SET="ACTION_BAR_BREADCRUMB_SET",t.APP_STARTUP=(0,a.createRequestTypes)("APP_STARTUP"),t.MENU_OPEN_CLOSE="MENU_OPEN_CLOSE",t.FETCH_COOKIES=(0,a.createRequestTypes)("FETCH_COOKIES"),t.HEADER_SWITCH_VISIBILITY="HEADER_SWITCH_VISIBILITY",t.LOGIN_REFRESH_TOKEN_REQUEST="LOGIN_REFRESH_TOKEN_REQUEST",t.LOGIN_REFRESH_TOKEN_REQUEST_FAILURE="LOGIN_REFRESH_TOKEN_REQUEST_FAILURE",t.LOGIN_REFRESH_TOKEN_REQUEST_SUCCESS="LOGIN_REFRESH_TOKEN_REQUEST_SUCCESS",t.LOGIN_RESET="LOGIN_RESET",t.PASSWORD_FORGOT=(0,a.createRequestTypes)("PASSWORD_FORGOT"),t.PASSWORD_FORGOT_RESET="PASSWORD_FORGOT_RESET",t.NOTIFICATIONS_ADD="NOTIFICATIONS_ADD",t.NOTIFICATIONS_REMOVE="NOTIFICATIONS_REMOVE",t.NOTIFICATIONS_RESET="NOTIFICATIONS_RESET",t.NAVIGATOR_GET_VERSION=(0,a.createRequestTypes)("NAVIGATOR_GET_VERSION"),t.SESSION_GET_ACCESS_TOKEN_REQUEST="SESSION_GET_ACCESS_TOKEN_REQUEST",t.SESSION_GET_ACCESS_TOKEN_REQUEST_FAILURE="SESSION_GET_ACCESS_TOKEN_REQUEST_FAILURE",t.SESSION_GET_ACCESS_TOKEN_REQUEST_SUCCESS="SESSION_GET_ACCESS_TOKEN_REQUEST_SUCCESS",t.SESSION_GET_CONNECTED_USER_REQUEST="SESSION_GET_CONNECTED_USER_REQUEST",t.SESSION_GET_CONNECTED_USER_REQUEST_FAILURE="SESSION_GET_CONNECTED_USER_REQUEST_FAILURE",t.SESSION_GET_CONNECTED_USER_REQUEST_SUCCESS="SESSION_GET_CONNECTED_USER_REQUEST_SUCCESS",t.SESSION_GET_WORKSPACES_REQUEST="SESSION_GET_WORKSPACES_REQUEST",t.SESSION_GET_WORKSPACES_REQUEST_FAILURE="SESSION_GET_WORKSPACES_REQUEST_FAILURE",t.SESSION_GET_WORKSPACES_REQUEST_SUCCESS="SESSION_GET_WORKSPACES_REQUEST_SUCCESS",t.SESSION_INIT_WORKSPACE="SESSION_INIT_WORKSPACE",t.SESSION_IS_REACT_URL="SESSION_IS_REACT_URL",t.SESSION_LOGOUT="SESSION_LOGOUT",t.SESSION_SWITCH_WORKSPACE="SESSION_SWITCH_WORKSPACE",t.LOG_IN=(0,a.createRequestTypes)("LOG_IN"),t.LOG_OUT="LOG_OUT",t.CONNECTED_USER=(0,a.createRequestTypes)("CONNECTED_USER"),t.WORKSPACE=(0,a.createRequestTypes)("WORKSPACE"),t.SIDEBAR_SWITCH_VISIBILITY="SIDEBAR_SWITCH_VISIBILITY",t.LABELS_FETCH=(0,a.createRequestTypes)("LABELS_FETCH"),t.LABELS_RESET="LABELS_FETCH",t.GET_LOGO=(0,a.createRequestTypes)("GET_LOGO"),t.PUT_LOGO=(0,a.createRequestTypes)("PUT_LOGO"),t.STORE_THEME_COLOR="STORE_THEME_COLOR",t.STORE_ORG_FEATURES="STORE_ORG_FEATURES",t.STORE_FEATURE_FLAG_CLIENT="STORE_FEATURE_FLAG_CLIENT",t.STORE_SELECTED_DATAMART="STORE_SELECTED_DATAMART"},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DatePicker=t.Select=t.Dropdown=t.FormSelectField=t.Popover=void 0;var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=d(n(0)),s=n(47),l=(a=s)&&a.__esModule?a:{default:a},c=d(n(10)),u=d(n(24));function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function g(e){return function(t){function n(){f(this,n);var e=p(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments));return e.randomId=(0,l.default)(),e.attachToDOM=function(t){return document.getElementById(e.randomId)},e}return m(n,t),o(n,[{key:"render",value:function(){return i.createElement("span",{id:this.randomId},i.createElement(e,r({getPopupContainer:this.attachToDOM},this.props)))}}]),n}(i.Component)}var y;t.Popover=g(c.Popover),t.FormSelectField=g(u.FormSelectField),t.Dropdown=g(c.Dropdown),t.Select=g(c.Select),t.DatePicker=(y=c.DatePicker,function(e){function t(){f(this,t);var e=p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.randomId=(0,l.default)(),e.attachToDOM=function(t){return document.getElementById(e.randomId)},e}return m(t,e),o(t,[{key:"render",value:function(){return i.createElement("span",{id:this.randomId},i.createElement(y,r({getCalendarContainer:this.attachToDOM},this.props)))}}]),t}(i.Component))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScrollspySider=t.EditContentLayout=t.FormLayoutActionbar=void 0;var a=i(n(60)),r=i(n(2024)),o=i(n(101));function i(e){return e&&e.__esModule?e:{default:e}}t.FormLayoutActionbar=a.default,t.EditContentLayout=r.default,t.ScrollspySider=o.default},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducePromises=function(e){return e.reduce((function(e,t){return e.then((function(e){return t.then((function(t){return e.concat(t)}))}))}),Promise.resolve([]))},t.executeTasksInSequence=function(e){return e.reduce((function(e,t){return e.then((function(){return t()}))}),Promise.resolve())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=t.INITIAL_EMAIL_CAMPAIGN_NODE_FORM_DATA=t.INITIAL_DISPLAY_CAMPAIGN_NODE_FORM_DATA=t.INITIAL_DELETE_FROM_SEGMENT_NODE_FORM_DATA=t.INITIAL_ADD_TO_SEGMENT_NODE_FORM_DATA=void 0,t.isScenarioNodeShape=function(e){return"DROP_NODE"!==e.type},t.isAbnNode=function(e){return"ABN_NODE"===e.type},t.isDisplayCampaignNode=function(e){return"DISPLAY_CAMPAIGN"===e.type},t.isEmailCampaignNode=function(e){return"EMAIL_CAMPAIGN"===e.type},t.isAddToSegmentNode=function(e){return"ADD_TO_SEGMENT_NODE"===e.type},t.isDeleteFromSegmentNode=function(e){return"DELETE_FROM_SEGMENT_NODE"===e.type},t.isQueryInputNode=function(e){return"QUERY_INPUT"===e.type},t.isOnSegmentEntryInputNode=function(e){return"ON_SEGMENT_ENTRY_INPUT_NODE"===e.type},t.isOnSegmentExitInputNode=function(e){return"ON_SEGMENT_EXIT_INPUT_NODE"===e.type},t.isCustomActionNode=function(e){return"CUSTOM_ACTION_NODE"===e.type},t.isFeedNode=function(e){return"SCENARIO_AUDIENCE_SEGMENT_FEED_NODE"===e.type},t.isWaitNode=function(e){return"WAIT_NODE"===e.type},t.isIfNode=function(e){return"IF_NODE"===e.type},t.isEndNode=function(e){return"END_NODE"===e.type};var a=n(160);t.INITIAL_ADD_TO_SEGMENT_NODE_FORM_DATA={processingActivities:[],ttl:{value:void 0,unit:"days"}},t.INITIAL_DELETE_FROM_SEGMENT_NODE_FORM_DATA={segmentId:void 0},t.INITIAL_DISPLAY_CAMPAIGN_NODE_FORM_DATA={campaign:{organisation_id:"",name:"Display Advertising",editor_version_id:"11",currency_code:"EUR",technical_name:"",subtype:"PROGRAMMATIC",max_bid_price:0,total_budget:0,max_budget_per_period:0,max_budget_period:"WEEK",total_impression_capping:0,per_day_impression_capping:0,time_zone:"Europe/Paris",model_version:"V2017_09",type:"DISPLAY",automated:!0},adGroupFields:[{key:(0,a.generateFakeId)(),model:{adGroup:{total_impression_capping:10,max_budget_period:"DAY",targeted_operating_systems:"ALL",targeted_medias:"WEB",targeted_devices:"ALL",targeted_connection_types:"ALL",targeted_browser_families:"ALL"},adFields:[],inventoryCatalFields:[],locationFields:[],segmentFields:[]}}],goalFields:[]},t.INITIAL_EMAIL_CAMPAIGN_NODE_FORM_DATA={blastFields:[{key:(0,a.generateFakeId)(),model:{blast:{blast_name:"",subject_line:"",from_email:"",from_name:"",reply_to:"",send_date:0,batch_size:0},templateFields:[],consentFields:[],segmentFields:[]}}],routerFields:[],campaign:{organisation_id:"",automated:!0,name:"",editor_version_id:"17",editor_version_value:"",editor_group_id:"",editor_artifact_id:"",currency_code:"EUR",technical_name:"",type:"EMAIL"}},t.FORM_ID="automationNodeForm"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(0,n(6).defineMessages)({dashboardOverview:{id:"display.dashboard.overview",defaultMessage:"Overview"},dashboardTopSites:{id:"display.dashboard.topSites",defaultMessage:"Top Sites"},dashboardLive:{id:"display.dashboard.Live",defaultMessage:"Delivery Analysis"},adGroups:{id:"display.card.adGroup",defaultMessage:"Ad Groups"},newAdGroups:{id:"display.card.newAdGroup",defaultMessage:"New Ad Group"},editAdGroups:{id:"display.card.editAdGroup",defaultMessage:"Edit Ad Groups"},activateAdGroups:{id:"display.card.activateAdGroups",defaultMessage:"Activate"},pauseAdGroups:{id:"display.card.pauseAdGroups",defaultMessage:"Pause"},creatives:{id:"display.card.creatives",defaultMessage:"Creatives"},newCreatives:{id:"display.card.newCreatives",defaultMessage:"New Creative"},pauseAdGroup:{id:"display.adGroup.actionBar.pauseAdGroup",defaultMessage:"Pause Ad Group"},activateAdGroup:{id:"display.adGroup.actionBar.activateAdGroup",defaultMessage:"Activate Ad Group"},pauseCampaign:{id:"display.campaign.actionBar.pauseCampaign",defaultMessage:"Pause Campaign"},activateCampaign:{id:"display.campaign.actionBar.activateCampaign",defaultMessage:"Activate Campaign"},campaignActive:{id:"display.campaign.header.campaignActive",defaultMessage:"Campaign Active"},adGroupActive:{id:"display.campaign.header.adGroupActive",defaultMessage:"Ad Group Active"},campaignPause:{id:"display.campaign.header.campaignPaused",defaultMessage:"Campaign Paused"},adGroupPause:{id:"display.campaign.header.adGroupPaused",defaultMessage:"Ad Group Paused"},campaignPending:{id:"display.campaign.header.campaignPending",defaultMessage:"Campaign Pending"},adGroupPending:{id:"display.campaign.header.adGroupPending",defaultMessage:"Ad Group Pending"},editCampaign:{id:"display.campaign.actionBar.editCampaign",defaultMessage:"Edit"},editAdGroup:{id:"display.adGroup.actionBar.editAdGroup",defaultMessage:"Edit"},archiveCampaign:{id:"display.campaign.actionBar.archiveCampaign",defaultMessage:"Archive"},archiveAdGroup:{id:"display.adGroup.actionBar.archiveAdGroup",defaultMessage:"Archive"},archiveAdGroupModalTitle:{id:"display.adGroup.archiveAdGroupTitle",defaultMessage:"Are you sure you want to archive this Ad Group ?"},archiveAdGroupModalMessage:{id:"display.adGroup.archiveAdGroupMessage",defaultMessage:"By archiving this Ad Group all its activities will be suspended. You'll be able to recover it from the archived ad Group filter."},archiveAdGroupsModalTitle:{id:"display.adGroup.archiveAdGroupsTitle",defaultMessage:"Archive Ad Groups"},archiveAdGroupsModalMessage:{id:"display.adGroup.archiveAdGroupsMessage",defaultMessage:"Are you sure to archive all the selected Ad Groups ?"},archiveAdsModalTitle:{id:"display.adGroup.archiveAdsTitle",defaultMessage:"Archive Creatives"},archiveAdsModalMessage:{id:"display.adGroup.archiveAdsMessage",defaultMessage:"Are you sure to archive all the selected Creatives ?"},display:{id:"display.campaign.actionBar.display",defaultMessage:"Display"},notificationAdGroupActivationSuccess:{id:"display.notifications.adgroup.activation.success",defaultMessage:"Ad Group {name} Successfully Activated"},notificationAdGroupActivationError:{id:"display.notifications.adgroup.activation.error",defaultMessage:"There was an error activating your Ad Group {name}... Please try again..."},notificationAdGroupPauseSuccess:{id:"display.notifications.adgroup.pause.success",defaultMessage:"Ad Group {name} Successfully Paused"},notificationAdGroupPauseError:{id:"display.notifications.adgroup.pause.error",defaultMessage:"There was an error pausing your Ad Group {name}... Please try again..."},notificationAdActivationSuccess:{id:"display.notifications.ad.activation.success",defaultMessage:"Ad {name} Successfully Activated"},notificationAdActivationError:{id:"display.notifications.ad.activation.error",defaultMessage:"There was an error activating your Ad {name}... Please try again..."},notificationAdPauseSuccess:{id:"display.notifications.ad.pause.success",defaultMessage:"Ad {name} Successfully Paused"},notificationAdPauseError:{id:"display.notifications.ad.pause.error",defaultMessage:"There was an error pausing your Ad {name}... Please try again..."},adAuditSuccess:{id:"display.ad.audit.success",defaultMessage:"Audit Successful"},adAuditError:{id:"display.ad.audit.error",defaultMessage:"You need to pass the Audit first"},notificationSuccess:{id:"notification.success.title",defaultMessage:"Success"},notificationError:{id:"notification.success.error",defaultMessage:"Error"},notificationErrorGeneric:{id:"notification.success.error.generic",defaultMessage:"There was an error, please contact the administrator with the following error id: {errorId}"},undo:{id:"notification.button.undo",defaultMessage:"Undo"},totalBudgetConsumption:{id:"progress.budget.total",defaultMessage:"Total Budget Consumption"},dailyBudgetConsumption:{id:"progress.budget.daily",defaultMessage:"Daily Budget Consumption"},weeklyBudgetConsumption:{id:"progress.budget.weekly",defaultMessage:"Weekly Budget Consumption"},monthlyBudgetConsumption:{id:"progress.budget.monthly",defaultMessage:"Monthly Budget Consumption"},weightedConversion:{id:"campaign.goal.chart.weightedConversion",defaultMessage:"Weighted Conversion"},impressions:{id:"campaign.chart.impressions",defaultMessage:"Imp."},displayNetworkName:{id:"campaign.chart.displayNetworkName",defaultMessage:"Display Network"},displayNetworkNameUncategorized:{id:"display.metrics.displayNetworkNameUncategorized",defaultMessage:"Uncategorized"},format:{id:"campaign.chart.format",defaultMessage:"Format"},status:{id:"campaign.chart.status",defaultMessage:"Status"},name:{id:"campaign.chart.name",defaultMessage:"Name"},ctr:{id:"campaign.chart.ctr",defaultMessage:"CTR"},clicks:{id:"campaign.chart.clicks",defaultMessage:"Clicks"},impressions_cost:{id:"campaign.chart.impressions_cost",defaultMessage:"Spent."},cpm:{id:"campaign.chart.cpm",defaultMessage:"CPM."},cpc:{id:"campaign.chart.cpc",defaultMessage:"CPC."},cpa:{id:"campaign.chart.cpa",defaultMessage:"CPA."},noGoalStatAvailable:{id:"campaign.goal.chart.noStats",defaultMessage:"There is no conversion associated to this attribution model and campaign on the given period."},noStatAvailable:{id:"campaign.stat.chart.noStats",defaultMessage:"There is no stats available for this period of time."},duplicate:{id:"campaign.display.dashboard.duplicate",defaultMessage:"Duplicate"},creativeModalConfirmArchivedTitle:{id:"creative.modal.confirm.archived.title",defaultMessage:"Are you sure to archive this creative ?"},creativeModalConfirmArchivedContent:{id:"creative.modal.confirm.archived.content",defaultMessage:"You will still be able to get back your creative in the 'Archive' category."},creativeModalConfirmArchivedOk:{id:"creative.modal.confirm.ok",defaultMessage:"Archive Now"},cancelText:{id:"creative.modal.confirm.cancel",defaultMessage:"Cancel"},editionNotAllowed:{id:"display.campaign.actionbar.edition.not.allowed",defaultMessage:"Edition on this campaign is deprecated, you must use navigator legacy to edit this campaign."},adServingDownload:{id:"display.campaign.actionbar.adserving.download",defaultMessage:"Get Your Snippets"},googleDfp:{id:"display.campaign.actionbar.adserving.google_dfp",defaultMessage:"Google DoubleClick For Publisher (DFP)"},googleDbm:{id:"display.campaign.actionbar.adserving.google_dbm",defaultMessage:"Google DoubleClick Bid Manager (DBM)"},apx:{id:"display.campaign.actionbar.adserving.apx",defaultMessage:"App Nexus"},none:{id:"display.campaign.actionbar.adserving.none",defaultMessage:"Other"},emptyAds:{id:"display.campaign.actionbar.adserving.emptyAds",defaultMessage:"There is no ads attached to your campaign."},history:{id:"display.campaign.actionbar.history",defaultMessage:"History"},smartAdServer:{id:"display.campaign.actionbar.adserving.smart_ad_server",defaultMessage:"Smart Ad Server"},exportInProgress:{id:"display.campaign.dashboard.exportInProgress",defaultMessage:"Export in progress"}});t.default=a},,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notifyInfo=t.notifyWarning=t.notifySuccess=t.notifyError=t.resetNotifications=t.removeNotification=t.addNotification=void 0;var a,r=n(247),o=n(59),i=(a=o)&&a.__esModule?a:{default:a},s=n(104);var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";return(0,r.createAction)(s.NOTIFICATIONS_ADD)(Object.assign(Object.assign({},e),{uid:e.uid||Date.now(),level:t}))},c=(0,r.createAction)(s.NOTIFICATIONS_RESET);t.addNotification=l,t.removeNotification=function(e){return(0,r.createAction)(s.NOTIFICATIONS_REMOVE)(e)},t.resetNotifications=c,t.notifyError=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.default.error(e),l(Object.assign(Object.assign({duration:0},t),{error:e}),"error")},t.notifySuccess=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(Object.assign({duration:4.5},e),"success")},t.notifyWarning=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(Object.assign({duration:0},e),"warning")},t.notifyInfo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(Object.assign({duration:0},e),"info")}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(8),l=n(68),c=n(30),u=n(11);function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},m=function(e){function t(){d(this,t);var e=f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.updateLocationSearch=function(t){var n=e.props,a=n.history,r=n.location,o=r.search,i=r.pathname,s=n.pageSettings,l={pathname:i,search:(0,c.updateSearch)(o,t,s)};a.push(l)},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.fetchList,n=e.history,a=e.location,r=a.search,o=a.pathname,i=e.match.params.organisationId,s=e.pageSettings;(0,c.isSearchValid)(r,s)?t(i,(0,c.parseSearch)(r,s),!0):n.replace({pathname:o,search:(0,c.buildDefaultSearch)(r,s),state:{reloadDataSource:!0}})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.fetchList,a=t.history,r=t.location,o=r.pathname,i=r.search,s=t.match.params.organisationId,l=t.pageSettings,u=e.location.search,d=e.match.params.organisationId;(0,c.compareSearches)(i,u)&&s===d||((0,c.isSearchValid)(i,l)?n(s,(0,c.parseSearch)(i,l),!1):a.replace({pathname:o,search:(0,c.buildDefaultSearch)(i,l),state:{reloadDataSource:s!==d}}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.total,r=t.location.search,i=t.pageSettings,s=t.emptyTable,d=s.iconType,f=s.message,m=t.additionnalComponent,g=p(t,["total","location","pageSettings","emptyTable","additionnalComponent"]);if(!g.dataSource.length&&!g.loading&&!m)return o.createElement(u.EmptyTableView,{iconType:d,message:f});var y=(0,c.parseSearch)(r,i),h={current:y.currentPage,pageSize:y.pageSize,onChange:function(t,n){return e.updateLocationSearch({currentPage:t,pageSize:n})},onShowSizeChange:function(t,n){return e.updateLocationSearch({currentPage:1,pageSize:n})},total:n};return o.createElement("div",{className:"mcs-table-container"},m,g.dataSource.length||g.loading?o.createElement(l.TableViewFilters,a({pagination:h},g)):o.createElement(u.EmptyTableView,{iconType:d,message:f,className:"mcs-table-view-empty mcs-empty-card"}))}}]),t}(o.Component);t.default=(0,s.compose)(i.withRouter)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCoreReferenceTypeAndModel=t.extractFieldType=t.UpdateOperation=t.DeleteOperation=t.AddOperation=t.MicsDiagramEngine=t.ROOT_NODE_POSITION=t.MIN_Y=t.MIN_X=t.typesTrigger=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t.createLink=_,t.isLeafNode=S,t.setUniqueModelId=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["root"];t.node.id=a.join("-"),t.right&&e(t.right,n+1,a.concat("r"+n));t.down&&e(t.down,n+1,a.concat("d"+n))},t.buildNodeModelBTree=function e(t,n,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];switch(t.type){case"GROUP":return 0===t.expressions.length?{node:new c.BooleanOperatorNodeModel(t,r),right:{node:new d.PlusNodeModel(t,r,n)}}:t.expressions.slice().reverse().reduce((function(o,i,s){return{node:new c.BooleanOperatorNodeModel(t,r),down:t.expressions.length>0?o:void 0,right:e(i,n,a,[].concat(p(r),[t.expressions.length-1-s]))}}),{node:new d.PlusNodeModel(t,r,n)});case"OBJECT":var o=new f.ObjectNodeModel(t,r);o.objectTypeInfo=n;var i=n.fields.find((function(e){return e.name===t.field})),s=i.field_type.match(/\w+/)[0],l=a.find((function(e){return s===e.name})),m=!E(l,a);return{node:o,down:t.expressions.slice().reverse().reduce((function(n,o,i){return{node:new c.BooleanOperatorNodeModel(t,r),down:n,right:e(o,l,a,[].concat(p(r),[t.expressions.length-1-i]))}}),m?void 0:{node:new d.PlusNodeModel(t,r,l)})};case"FIELD":var g=new u.FieldNodeModel(t,r);return g.objectTypeInfo=n,{node:g};default:return{node:new d.PlusNodeModel}}},t.layout=function e(t,n,a){var r=t.node instanceof f.ObjectNodeModel&&t.node.collapsed||t.node.extras.collapsed;t.node.setPosition(n.x,n.y);var o=n;t.right&&(o=e(t.right,r?n:O(n,v,(t.node.getSize().height+2*(t.node.getSize().borderWidth||0))/2-(t.right.node.getSize().height+2*(t.right.node.getSize().borderWidth||0))/2),t));var i=o;t.down&&(i=e(t.down,r?n:O({x:n.x,y:o.y},(t.node.getSize().width+2*(t.node.getSize().borderWidth||0))/2-(t.down.node.getSize().width+2*(t.down.node.getSize().borderWidth||0))/2,b),t));return i},t.computeNodeExtras=function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=a,i=r;o||(t.node instanceof c.BooleanOperatorNodeModel?o=!!t.node.objectOrGroupNode.negation:t.node instanceof f.ObjectNodeModel&&(o=!!t.node.objectNode.negation));t.node.extras.collapsed=!1,!i&&t.node instanceof f.ObjectNodeModel?i=t.node.collapsed:t.node.extras.collapsed=i;t.node.extras.negation=o,t.right&&e(t.right,t,o,i);t.down&&e(t.down,t,o,i)},t.buildLinkList=function e(t){return[].concat(p(t.right?[_(t.node.ports.right,t.right.node.ports.left)]:[]),p(t.down?[_(t.node.ports.bottom,t.down.node.ports.top)]:[]),p(t.right?e(t.right):[]),p(t.down?e(t.down):[]))},t.toNodeList=function e(t){return[t.node].concat(p(t.down?e(t.down):[]),p(t.right?e(t.right):[]))},t.applyTranslation=O,t.isSchemaItem=w,t.isFieldInfoEnfancedResource=M,t.filterAvailableFields=T,t.computeFinalSchemaItem=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments[3],r=arguments[4],o=I(e,Object.assign(Object.assign({},e.find((function(e){return e.name===t}))),{closestParentType:""})),i=C(o,e,n,a,r);return j(i,e,"")},t.computeSchemaPathFromQueryPath=function(e,t,n,a){var r=function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!t)return a;var r="GROUP"!==t.type?[].concat(p(a),[t.field]):a;if(0===n.length||S(t))return r;var o=m(n),i=o[0],s=o.slice(1);return e(t.expressions[i],s,r)}(e,t);a&&(r.splice(-1,1),r.push(a));return function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!t)return a;if(!n.length)return a;if(!t.fields.length)return a;var r=m(n),o=r[0],i=r.slice(1),s=t.fields.findIndex((function(e){return e.name===o})),l=[].concat(p(a),[s]);return e(t.fields[s],i,l)}(n,r)},t.computeAdditionalNode=function(e,t,n){var a=function e(t,n,a,r){if(!a)return r;if(0===t.length)return r;var o=m(t),i=o[0],s=o.slice(1),l=n;if(l>0)return e(s,l-=1,a.fields[i]);var c=a.fields[i].fields&&a.fields[i].fields.length?{type:"OBJECT",field:a.fields[i].name,expressions:[],boolean_operator:"OR"}:{type:"FIELD",field:a.fields[i].name},u=r?[].concat(p(r),[c]):[c];return e(s,l,a.fields[i],u)}(e,t,n);if(a){for(var r=[],o=0;o<a.length;o++)r.push(a[a.length-1-o]);return r.reduce((function(e,t){return e?Object.assign(Object.assign({},t),{expressions:[e]}):t}),void 0)}return a};var r,o=n(89),i=n(54),s=(r=i)&&r.__esModule?r:{default:r},l=n(1055),c=n(1031),u=n(1053),d=n(1057),f=n(1065);function p(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function m(e){return Array.isArray(e)?e:Array.from(e)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=t.typesTrigger=void 0;!function(e){e[e.UserActivity=0]="UserActivity",e[e.UserEvent=1]="UserEvent"}(h||(t.typesTrigger=h={}));var v=t.MIN_X=100,b=t.MIN_Y=100;t.ROOT_NODE_POSITION={x:100,y:150};function _(e,t){var n=new l.SimpleLinkModel;return n.setSourcePort(e),n.setTargetPort(t),n}t.MicsDiagramEngine=function(e){function t(){g(this,t);var e=y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.setCopying=function(t,n,a){e.objectType=n,e.copiedObjectTree=t,e.treeNodePath=a},e.getCopiedValue=function(){return{copiedObjectType:e.copiedObjectTree,objectType:e.objectType,treeNodePath:e.treeNodePath}},e.isCopying=function(){return!(!e.objectType||!e.copiedObjectTree)},e.emptyClipboard=function(){e.objectType=void 0,e.copiedObjectTree=void 0,e.treeNodePath=void 0},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(o.DiagramEngine),t.AddOperation=function(){function e(t,n){g(this,e),this.path=t,this.node=n}return a(e,[{key:"execute",value:function(t){if(!t)return this.node;if(S(t))return t;if(0===this.path.length)return Object.assign(Object.assign({},t),{expressions:t.expressions.concat(this.node)});var n=m(this.path),a=n[0],r=n.slice(1);return Object.assign(Object.assign({},t),{expressions:[].concat(p(t.expressions.slice(0,a)),[new e(r,this.node).execute(t.expressions[a])],p(t.expressions.slice(a+1)))})}}]),e}(),t.DeleteOperation=function(){function e(t){g(this,e),this.path=t}return a(e,[{key:"execute",value:function(e){var t=this.deleteNode(e,this.path);return void 0!==t?this.removeNestedEmptyGroupNode(t):t}},{key:"deleteNode",value:function(e,t){if(S(e))return e;if(0!==t.length){if(1===t.length)return Object.assign(Object.assign({},e),{expressions:[].concat(p(e.expressions.slice(0,t[0])),p(e.expressions.slice(t[0]+1)))});var n=m(t),a=n[0],r=n.slice(1);return Object.assign(Object.assign({},e),{expressions:[].concat(p(e.expressions.slice(0,a)),[this.deleteNode(e.expressions[a],r)],p(e.expressions.slice(a+1)))})}}},{key:"removeNestedEmptyGroupNode",value:function(e){function t(e){return S(e)?e:"GROUP"!==e.type||0!==e.expressions.length?Object.assign(Object.assign({},e),{expressions:e.expressions.reduce((function(e,n){var a=t(n);return a?[].concat(p(e),[a]):e}),[])}):void 0}function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=t+1;return S(e)||0===e.expressions.length?a:e.expressions.reduce((function(e,t){return e+n(t,e)}),a)}return function e(a){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!r)return a;var o=t(a);if(o){var i=n(o)!==n(a);return e(o,i)}}(e)}}]),e}(),t.UpdateOperation=function(){function e(t,n){g(this,e),this.path=t,this.node=n}return a(e,[{key:"execute",value:function(t){if(0===this.path.length)return this.node;if(S(t))return t;var n=m(this.path),a=n[0],r=n.slice(1);return Object.assign(Object.assign({},t),{expressions:[].concat(p(t.expressions.slice(0,a)),[new e(r,this.node).execute(t.expressions[a])],p(t.expressions.slice(a+1)))})}}]),e}();function S(e){return"FIELD"===e.type}function E(e,t){var n=t.map((function(e){return e.name}));return e.fields.map((function(e){return e.field_type})).filter((function(e){var t=e.match(/\w+/);return!!n.find((function(e){return!(!t||t[0]!==e)}))})).length>0}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return{x:e.x+t,y:e.y+n}}function w(e){return e.fields&&e.fields.length>0}function M(e){return!w(e)&&void 0!==e.closestParentType}var P=t.extractFieldType=function(e){return e.field_type.match(/\w+/)[0]};function T(e){return s.default.flatMap(e.directives,(function(e){return e.arguments.map((function(e){return Object.values(h).includes(e.value.replace(/[^a-zA-Z]+/g,""))}))})).reduce((function(e,t){return e||t}),!1)}function I(e,t){return Object.assign(Object.assign({},t),{fields:t.fields.map((function(n){var a=P(n);if(a&&e.map((function(e){return e.name})).includes(a)){var r=Object.assign(Object.assign({},e.find((function(e){return e.name===a}))),{schemaType:a,name:n.name,closestParentType:t.name,decorator:n.decorator});return I(e,r)}return Object.assign(Object.assign({},n),{closestParentType:t.name})})).sort((function(e,t){var n=w(e),a=w(t),r=e.decorator&&!e.decorator.hidden?e.decorator.label:e.name,o=t.decorator&&!t.decorator.hidden?t.decorator.label:t.name;return n&&!a?1:n&&a||!n&&!a?r.localeCompare(o):-1}))})}function A(e){return!e.decorator||!e.decorator.hidden}function C(e,t,n,a,r){return Object.assign(Object.assign({},e),{fields:e.fields.filter((function(e){if(a)return w(e)&&"UserPoint"===e.closestParentType?T(e)&&A(e):(!M(e)||"UserPoint"!==e.closestParentType)&&A(e);if(M(e)&&n){var o=P(e);return(t.map((function(e){return e.name})).includes(o)||e.directives&&e.directives.length&&e.directives.find((function(e){return"TreeIndex"===e.name}))&&(!r||e.directives.find((function(e){return"EdgeAvailability"===e.name}))))&&A(e)}return A(e)})).map((function(o){return w(o)?C(o,t,n,a,r):Object.assign(Object.assign({},o),{closestParentType:e.name})})).filter((function(e){return!("fields"in e)||e.fields.length>0}))})}function j(e,t,n){return Object.assign(Object.assign({},e),{path:n,fields:e.fields.map((function(a,r){var o=n+(n?".":"")+r;return w(a)?j(a,t,o):Object.assign(Object.assign({},a),{closestParentType:e.name,path:o})}))})}t.getCoreReferenceTypeAndModel=function(e){var t=e.find((function(e){return"ReferenceTable"===e.name}));if(t&&t.arguments){var n=t.arguments.find((function(e){return"type"===e.name})),a=t.arguments.find((function(e){return"model_type"===e.name}));if(n){var r=n.value.match(/\w+/);if(r&&r[0]&&"CORE_OBJECT"===r[0]&&a)return{type:"CORE_OBJECT",modelType:a.value.replace(/\"/g,"")}}}}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(0,n(6).defineMessages)({lookUpUser:{id:"audience.monitoring.timeline.actionbar.lookup",defaultMessage:"User Lookup"},viewMore:{id:"audience.monitoring.timeline.content.viewMore",defaultMessage:"View More"},viewLess:{id:"audience.monitoring.timeline.content.viewLess",defaultMessage:"View Less"},visitor:{id:"audience.monitoring.timeline.content.header.visitor",defaultMessage:"Visitor"},activities:{id:"audience.monitoring.timeline.content.header.activities",defaultMessage:"Activities"},identifiers:{id:"audience.monitoring.timeline.content.header.identifiers",defaultMessage:"Identifiers"},profileTitle:{id:"audience.monitoring.timeline.card.profile.title",defaultMessage:"Profile"},emptyProfile:{id:"audience.monitoring.audience.monitoring.timeline.card.profile.empty",defaultMessage:"This user has no Profile Information"},segmentTitle:{id:"audience.monitoring.timeline.card.segment.title",defaultMessage:"Segments"},emptySegment:{id:"audience.monitoring.timeline.card.segment.empty",defaultMessage:"This user has no Segment Information"},accountTitle:{id:"audience.monitoring.timeline.card.account.title",defaultMessage:"User Account Id"},unknownCompartmentName:{id:"audience.monitoring.timeline.card.user.account.unknown.compartment.name",defaultMessage:"Unknown compartment name"},emptyAccount:{id:"audience.monitoring.timeline.card.account.empty",defaultMessage:"This user has no Account Information"},deviceTitle:{id:"audience.monitoring.timeline.card.device.title",defaultMessage:"User Device"},emptyDevice:{id:"audience.monitoring.timeline.card.device.empty",defaultMessage:"This user has no Devices"},emailTitle:{id:"audience.monitoring.timeline.card.email.title",defaultMessage:"User Email"},emptyEmail:{id:"audience.monitoring.timeline.card.email.empty",defaultMessage:"This user has no Emails"},nullEmail:{id:"audience.monitoring.timeline.card.email.modal.null",defaultMessage:"null"},okModalEmail:{id:"audience.monitoring.timeline.card.email.modal.ok",defaultMessage:"Ok"},titleModalEmail:{id:"audience.monitoring.timeline.card.email.modal.title",defaultMessage:"Email Information"},emailAddress:{id:"audience.monitoring.timeline.card.email.modal.emailAddress",defaultMessage:"Email Address"},emailCreation:{id:"audience.monitoring.timeline.card.email.modal.creationdate",defaultMessage:"Creation Date"},emailActivity:{id:"audience.monitoring.timeline.card.email.modal.lastActivity",defaultMessage:"Last Activity Date"},emailInfo:{id:"audience.monitoring.timeline.card.email.modal.information",defaultMessage:"Information"},emailConsent:{id:"audience.monitoring.timeline.card.email.modal.consent",defaultMessage:"Consent"},CREATION_TS:{id:"audience.monitoring.timeline.card.email.modal.CREATION_TS",defaultMessage:"Creation Date"},LAST_ACTIVITY_TS:{id:"audience.monitoring.timeline.card.email.modal.LAST_ACTIVITY_TS",defaultMessage:"Last Activity Date"},LAST_MODIFIED_TS:{id:"audience.monitoring.timeline.card.email.modal.LAST_MODIFIED_TS",defaultMessage:"Last Modified Date"},EXPIRATION_TS:{id:"audience.monitoring.timeline.card.email.modal.EXPIRATION_TS",defaultMessage:"Expiration Date"},TECHNICAL_NAME:{id:"audience.monitoring.timeline.card.email.modal.TECHNICAL_NAME",defaultMessage:"Technical Name"},ACTIVE:{id:"audience.monitoring.timeline.card.email.modal.ACTIVE",defaultMessage:"Active"},STATUS:{id:"audience.monitoring.timeline.card.email.modal.STATUS",defaultMessage:"Status"},origin:{id:"audience.monitoring.timeline.card.activity.origin.title",defaultMessage:"Origin"},direct:{id:"audience.monitoring.timeline.card.activity.origin.direct",defaultMessage:"Direct"},topics:{id:"audience.monitoring.timeline.card.activity.topics.title",defaultMessage:"Topics"},seeMore:{id:"audience.monitoring.timeline.activities.button.viewMore",defaultMessage:"See More"},noActivitiesLeft:{id:"audience.monitoring.timeline.activities.button.noActivitiesLeft",defaultMessage:"No Activities Left"},noActivities:{id:"audience.monitoring.timeline.activities.button.noActivities",defaultMessage:"No Activities for this user"},today:{id:"audience.monitoring.timeline.activities.title.today",defaultMessage:"Today"},yesterday:{id:"audience.monitoring.timeline.activities.title.yesterday",defaultMessage:"Yesterday"},lastSeen:{id:"audience.monitoring.timeline.title.lastSeen",defaultMessage:"Last Seen At"},monitoring:{id:"audience.monitoring.timeline.title",defaultMessage:"Monitoring"},detail:{id:"audience.monitoring.timeline.activity.events.detail",defaultMessage:"Details"},eventJson:{id:"audience.monitoring.timeline.activity.events.json",defaultMessage:"Event JSON"},activityJson:{id:"audience.monitoring.timeline.activity.json",defaultMessage:"Activity JSON"},eventJsonModalOkText:{id:"audience.monitoring.timeline.activity.event.json.modal.ok.text",defaultMessage:"Close"},activityJsonModalOkText:{id:"audience.monitoring.timeline.activity.json.modal.ok.text",defaultMessage:"Close"},less:{id:"audience.monitoring.timeline.activity.events.less",defaultMessage:"Less"},empty:{id:"audience.monitoring.timeline.activity.events.empty",defaultMessage:"empty"},submit:{id:"audience.monitoring.timeline.actionbar.modal.submit",defaultMessage:"Submit"},return:{id:"audience.monitoring.timeline.actionbar.modal.return",defaultMessage:"Return"},userPoint:{id:"audience.monitoring.timeline.actionbar.modal.userpoint",defaultMessage:"User Point Id"},vectorId:{id:"audience.monitoring.timeline.actionbar.modal.vector",defaultMessage:"Vector Id"},emailHash:{id:"audience.monitoring.timeline.actionbar.modal.email",defaultMessage:"Email Hash"},day:{id:"audience.monitoring.timeline.activity.visit.duration.day",defaultMessage:"days"},hours:{id:"audience.monitoring.timeline.activity.visit.duration.hours",defaultMessage:"hours"},minutes:{id:"audience.monitoring.timeline.activity.visit.duration.minutes",defaultMessage:"minutes"},seconds:{id:"audience.monitoring.timeline.activity.visit.duration.seconds",defaultMessage:"seconds"},viewEventJson:{id:"audience.monitoring.timeline.event.activity.view.json.button",defaultMessage:"View JSON source"},viewActivityJson:{id:"audience.monitoring.timeline.activity.view.json.button",defaultMessage:"View JSON source"},pleaseFillInformations:{id:"audience.monitoring.timeline.no.cookie.please.fill.infos",defaultMessage:"There is no user linked to your browser, please select a user to continue"},userScenarioStartTitle:{id:"audience.monitoring.timeline.activity.scenario.start.title",defaultMessage:"Scenario Start"},userScenarioStopTitle:{id:"audience.monitoring.timeline.activity.scenario.stop.title",defaultMessage:"Scenario Stop"},userScenarioStopOnExitConditionTitle:{id:"audience.monitoring.timeline.activity.scenario.stop.on.exit.condition.title",defaultMessage:"Scenario Stop on Exit Condition"},userScenarioNodeEnterTitle:{id:"audience.monitoring.timeline.activity.scenario.node.enter.title",defaultMessage:"Scenario Node Enter"},userScenarioNodeExitTitle:{id:"audience.monitoring.timeline.activity.scenario.node.exit.title",defaultMessage:"Scenario Node Exit"},userScenarioNodeMovementTitle:{id:"audience.monitoring.timeline.activity.scenario.node.movement.title",defaultMessage:"Scenario Node Movement"},userScenarioStartContent:{id:"audience.monitoring.timeline.activity.scenario.start.content",defaultMessage:"Entered {scenarioName}"},userScenarioStopContent:{id:"audience.monitoring.timeline.activity.scenario.stop.content",defaultMessage:"Exited {scenarioName}"},userScenarioNodeEnterContent:{id:"audience.monitoring.timeline.activity.scenario.node.enter.content",defaultMessage:"Entered {scenarioNodeName} node within {scenarioName}"},userScenarioNodeExitContent:{id:"audience.monitoring.timeline.activity.scenario.node.exit.content",defaultMessage:"Exited {scenarioNodeName} node within {scenarioName}"},userScenarioNodeMovementContent:{id:"audience.monitoring.timeline.activity.scenario.node.movement.content",defaultMessage:"Moved from {scenarioOldNodeName} to {scenarioNodeName} within {scenarioName}"},userChoicesTitle:{id:"audience.monitoring.timeline.card.userChoices.title",defaultMessage:"User Choices"},userChoicesviewJsonButton:{id:"audience.monitoring.timeline.card.userChoices.viewJsonButton",defaultMessage:"View JSON source"},userChoicesJson:{id:"audience.monitoring.timeline.card.userChoices.json",defaultMessage:"User Choices JSON"},userChoicesJsonModalOkText:{id:"audience.monitoring.timeline.card.userChoices.json.modal.ok.text",defaultMessage:"Close"},emptyUserChoices:{id:"audience.monitoring.timeline.card.userChoices.empty",defaultMessage:"This user has no User Choices"}});t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=n(6);t.messages=(0,a.defineMessages)({audienceBuilderNew:{id:"settings.datamart.audienceBuilder.newAudienceBuilder",defaultMessage:"New Audience Builder"},audienceBuilders:{id:"settings.datamart.audienceBuilders",defaultMessage:"Audience Builders"},audienceBuilderName:{id:"settings.datamart.audienceBuilders.name",defaultMessage:"Name"},audienceBuilderEdit:{id:"settings.datamart.audienceBuilders.edit",defaultMessage:"Edit"},audienceBuilderSave:{id:"settings.datamart.audienceBuilders.save",defaultMessage:"Save"},audienceBuilderDelete:{id:"settings.datamart.audienceBuilders.delete",defaultMessage:"Delete"},audienceBuilderEmptyList:{id:"settings.datamart.audienceBuilders.emptyList",defaultMessage:"There are no audience builders"},audienceBuilderSectionGeneralSubtitle:{id:"settings.datamart.audienceBuilders.edit.subtitle",defaultMessage:"Enter your parameters for the following inputs"},audienceBuilderSectionGeneralTitle:{id:"settings.datamart.audienceBuilders.edit.general.title",defaultMessage:"General Information"},audienceBuilderSectionDemographicsTitle:{id:"settings.datamart.audienceBuilders.edit.demographics.title",defaultMessage:"Demographics"},audienceBuilderSectionDemographicsSubtitle:{id:"settings.datamart.audienceBuilders.edit.demographics.subtitle",defaultMessage:"Audience Features that will always be used when building an audience"},audienceBuilderSectionDemographicsAddButton:{id:"settings.datamart.audienceBuilders.edit.demographics.add",defaultMessage:"Add from library"},audienceBuilderNameLabel:{id:"settings.datamart.audienceBuilders.edit.name.label",defaultMessage:"Name"},audienceBuilderNamePlaceholder:{id:"settings.datamart.audienceBuilders.edit.name.placeholder",defaultMessage:"Name"},audienceBuilderNameTooltip:{id:"settings.datamart.audienceBuilders.edit.name.tooltip",defaultMessage:"Enter a name for your audience builder"},audienceBuilderPreview:{id:"settings.datamart.audienceBuilders.edit.preview",defaultMessage:"Preview"},audienceBuilderSavingInProgress:{id:"settings.datamart.audienceBuilders.edit.savingInProgress",defaultMessage:"Saving in progress..."},audienceBuilderDeleteListModalTitle:{id:"settings.datamart.audienceBuilders.list.deleteModal.title",defaultMessage:"You are about to delete an Audience Builder from your datamart. This action cannot be undone. Do you want to proceed anyway ?"},audienceBuilderDeleteListModalOk:{id:"settings.datamart.audienceBuilders.list.deleteModal.ok",defaultMessage:"Delete"},audienceBuilderDeleteListModalCancel:{id:"settings.datamart.audienceBuilders.list.deleteModal.cancel",defaultMessage:"Cancel"},audienceFeatureNew:{id:"settings.datamart.audienceFeature.newAudienceFeature",defaultMessage:"New Audience Feature"},audienceFeatureAddFolder:{id:"settings.datamart.audienceFeature.addFolder",defaultMessage:"Add Folder"},audienceFeaturePlaceholderFolderInput:{id:"settings.datamart.audienceFeature.placeholderFolderInput",defaultMessage:"Enter folder name"},audienceFeatureAddButton:{id:"settings.datamart.audienceFeature.add",defaultMessage:"Add"},audienceFeatureCancelButton:{id:"settings.datamart.audienceFeature.cancel",defaultMessage:"Cancel"},audienceFeatureRename:{id:"settings.datamart.audienceFeature.renameFolder",defaultMessage:"Rename"},audienceFeatures:{id:"settings.datamart.audienceFeatures",defaultMessage:"Audience Features"},audienceFeatureName:{id:"settings.datamart.audienceFeatures.name",defaultMessage:"Name"},audienceFeatureDescription:{id:"settings.datamart.audienceFeatures.description",defaultMessage:"Description"},audienceFeatureObjectTreeExpression:{id:"settings.datamart.audienceFeatures.objectTreeExpression",defaultMessage:"Object Tree Expression"},audienceFeatureEdit:{id:"settings.datamart.audienceFeatures.edit",defaultMessage:"Edit"},audienceFeatureSave:{id:"settings.datamart.audienceFeatures.save",defaultMessage:"Save"},audienceFeatureDelete:{id:"settings.datamart.audienceFeatures.delete",defaultMessage:"Delete"},audienceFeatureSearchPlaceholder:{id:"settings.datamart.audienceFeatures.searchPlaceholder",defaultMessage:"Search audience features"},audienceFeatureEmptyList:{id:"settings.datamart.audienceFeatures.emptyList",defaultMessage:"There are no audience features"},audienceFeatureSectionGeneralSubTitle:{id:"settings.datamart.audienceFeatures.edit.subtitle",defaultMessage:"Enter your parameters for the following inputs"},audienceFeatureSectionGeneralTitle:{id:"settings.datamart.audienceFeatures.edit.title",defaultMessage:"General Information"},audienceFeatureNameLabel:{id:"settings.datamart.audienceFeatures.edit.name.label",defaultMessage:"Name"},audienceFeatureNamePlaceholder:{id:"settings.datamart.audienceFeatures.edit.name.placeholder",defaultMessage:"Name"},audienceFeatureNameTooltip:{id:"settings.datamart.audienceFeatures.edit.name.tooltip",defaultMessage:"Enter a name for your audience feature"},audienceFeatureDescriptionLabel:{id:"settings.datamart.audienceFeatures.edit.description.label",defaultMessage:"Description"},audienceFeatureDescriptionPlaceholder:{id:"settings.datamart.audienceFeatures.edit.description.placeholder",defaultMessage:"Description"},audienceFeatureDescriptionTooltip:{id:"settings.datamart.audienceFeatures.edit.description.tooltip",defaultMessage:"Enter a description for your audience feature"},audienceFeatureAssociatedQuery:{id:"settings.datamart.audienceFeatures.edit.query.title",defaultMessage:"Associated Query"},audienceFeatureAssociatedQuerySubtitle:{id:"settings.datamart.audienceFeatures.edit.query.subtitle",defaultMessage:"Click on the button to edit your associated query"},audienceFeaturePreview:{id:"settings.datamart.audienceFeatures.edit.preview",defaultMessage:"Preview"},audienceFeatureSavingInProgress:{id:"settings.datamart.audienceFeatures.edit.savingInProgress",defaultMessage:"Saving in progress..."},audienceFeatureDeleteListModalTitle:{id:"settings.datamart.audienceFeatures.list.deleteModal.title",defaultMessage:"You are about to delete an Audience Feature from your datamart. This action cannot be undone. Do you want to proceed anyway ?"},audienceFeatureDeleteListModalOk:{id:"settings.datamart.audienceFeatures.list.deleteModal.ok",defaultMessage:"Delete"},audienceFeatureDeleteListModalCancel:{id:"settings.datamart.audienceFeatures.list.deleteModal.cancel",defaultMessage:"Cancel"}})},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDisplayAdResource=a,t.creativeIsDisplayAdResource=function(e){return void 0!==e.id};t.DISPLAY_CREATIVE_FORM="displayCreativeForm";function a(e){return void 0!==e.id}var r={equals:function(e,t){return e}};t.IMAGE_AD_RENDERER="1065",t.HTML_AD_RENDRER="1078",t.EXTERNAL_AD_RENDERER="1061",t.IMAGE_SKINS_AD_RENDERER="1057",t.NATIVE_QUANTUM_AD_RENDERER="1047",t.NATIVE_IVIDENCE_AD_RENDERER="1032",t.isExistingCreative=function(e){if(e&&e.creative&&a(e.creative))return e.creative};t.default=function(e,t,n){return r[e](t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAggregateResult=function(e){return!(!e.length||void 0===e[0].aggregations)},t.isCountResult=function(e){return!(!e.length||void 0===e[0].count)}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=S(n(792)),o=n(6),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(795)),s=n(152),l=n(615),c=S(n(202)),u=S(n(796)),d=S(n(2021)),f=S(n(797)),p=S(n(59)),m=n(1012),g=S(n(81)),y=S(n(616)),h=S(n(336)),v=n(412),b=n(617),_=n(337);function S(e){return e&&e.__esModule?e:{default:e}}var E=(0,o.defineMessages)({from:{id:"service.exportService.from",defaultMessage:"From"},to:{id:"service.exportService.to",defaultMessage:"to"}}),O=function(e,t){var n=e;return t&&(n+=1462),(Date.parse(n)-new Date(Date.UTC(1899,11,30)))/864e5},w=function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),a=0;a!==e.length;a+=1)n[a]=255&e.charCodeAt(a);return t};function M(e,t,n,a,r,o,i){var s=void 0;s="string"==typeof e?e.substring(0,30):r(e).substring(0,30);var l=o||e;if(t&&t.length)return{name:s,data:function(e,t,n,a,r,o){var i="string"==typeof e?[e]:[r(e)],s=[];return s.push(i),a&&a.from&&a.to&&s.push([r(d.default.from)+" "+a.from+" "+r(d.default.to)+" "+a.to]),o&&(s.push([o.name]),s.push([o.id]),s.push([o.technical_name])),s.push([]),s.push(n.map((function(e){return e.translation}))),t.forEach((function(e){var t=n.map((function(t){return"segment_intersect_with"===t.name?e.segment_intersect_with.id:e[t.name]}));s.push(t)})),s}(l,t,n,a,r,i)}}var P=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.SheetNames=[],this.Sheets={}},T=function(e){for(var t={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}},a=0;a!==e.length;a+=1)for(var o=0;o!==e[a].length;o+=1){n.s.r>a&&(n.s.r=a),n.s.c>o&&(n.s.c=o),n.e.r<a&&(n.e.r=a),n.e.c<o&&(n.e.c=o);var i={v:e[a][o]};if(null!==i.v){var s=r.default.utils.encode_cell({c:o,r:a});"number"==typeof i.v?i.t="n":"boolean"==typeof i.v?i.t="b":i.v instanceof Date?(i.t="n",i.z=r.default.SSF._table[14],i.v=O(i.v)):i.t="s",t[s]=i}}return n.s.c<1e7&&(t["!ref"]=r.default.utils.encode_range(n)),t},I=function(e,t,n){try{for(var a=n.replace(".",""),o=new P,s=0;s<e.length;s+=1){var l;l=T(e[s].data),o.SheetNames.push(e[s].name),o.Sheets[e[s].name]=l}var c=r.default.write(o,{bookType:"xlsx",bookSST:!1,type:"binary"});i.saveAs(new Blob([w(c)],{type:"application/octet-stream"}),t+"."+a)}catch(e){p.default.error(e)}};t.default={exportData:I,exportGoals:function(e,t,n,a){var r=a(h.default.goalsExportTitle),o=[],i=[];i.push(r),i.push([a(E.from)+" "+n.from.toMoment().format("YYYY-MM-DD")+" "+a(E.to)+" "+n.to.toMoment().format("YYYY-MM-DD")]),i.push(o),n.keywords&&i.push(["Search keywords",n.keywords]),n.statuses.length>0&&i.push(["Displayed statuses",n.statuses.join(", ")]),i.push(o);var s=[{name:"name",translation:a(h.default.goalsExportColumnName)},{name:"conversions",translation:a(h.default.goalsExportColumnConversions)},{name:"value",translation:a(h.default.goalsExportColumnConversionValue)}],l=s.map((function(e){return e.translation}));i.push(l),t.forEach((function(e){var t=s.map((function(t){return e[t.name]}));i.push(t)})),I([{name:r,data:i}],e+"_goals","xlsx")},exportGoal:function(e,t,n,r,o){var i=a({},r,{from:r.from.toMoment().format("YYYY-MM-DD"),to:r.to.toMoment().format("YYYY-MM-DD")}),s=[{name:"day",translation:o(h.default.day)},{name:"value",translation:o(h.default.value)},{name:"price",translation:o(h.default.price)},{name:"conversions",translation:o(h.default.conversions)}],l={SOURCE:[{name:"marketing_channel",translation:o(h.default.marketingChannel)},{name:"source",translation:o(h.default.source)},{name:"interaction_type",translation:o(h.default.interactionType)},{name:"weighted_conversions",translation:o(h.default.weightedConversions)},{name:"weighted_value",translation:o(h.default.weightedValue)},{name:"interaction_to_conversion_duration",translation:o(h.default.interactionToConversionDuration)}],CAMPAIGN:[{name:"campaign_id",translation:o(h.default.campaignId)},{name:"campaign_name",translation:o(h.default.campaignName)},{name:"interaction_type",translation:o(h.default.interactionType)},{name:"weighted_conversions",translation:o(h.default.weightedConversions)},{name:"weighted_value",translation:o(h.default.weightedValue)},{name:"interaction_to_conversion_duration",translation:o(h.default.interactionToConversionDuration)}],CREATIVE:[{name:"creative_id",translation:o(h.default.creativeId)},{name:"creative_name",translation:o(h.default.creativeName)},{name:"interaction_type",translation:o(h.default.interactionType)},{name:"weighted_conversions",translation:o(h.default.weightedConversions)},{name:"weighted_value",translation:o(h.default.weightedValue)},{name:"interaction_to_conversion_duration",translation:o(h.default.interactionToConversionDuration)}]},c=n.filter((function(e){return e.normalized_report_view.length>0})).map((function(e){return M(e.attribution_model_id.concat("_",function(e){if(!e)throw new Error("An Excel spreadsheet can't have no name.");return e.replace(/\\/gm,"").replace(/\//gm,"").replace(/\?/gm,"").replace(/\*/gm,"").replace(/\[/gm,"").replace(/\]/gm,"")}(e.attribution_model_name)).concat("_",e.report_type),e.normalized_report_view,l[e.report_type],i,o)})),u=[M(o(h.default.goalsExportTitle),t,s,i,o)].concat(c);I(u,e+"_goal","xlsx")},exportEmailCampaigns:function(e,t,n,a){var r=a(y.default.emailCampaignsExportTitle),o=[],i=[];i.push(r),i.push([a(E.from)+" "+n.from.toMoment().format("YYYY-MM-DD")+" "+a(E.to)+" "+n.to.toMoment().format("YYYY-MM-DD")]),i.push(o),n.keywords&&i.push(["Search keywords",n.keywords]),n.statuses.length>0&&i.push(["Displayed statuses",n.statuses.join(", ")]),i.push(o);var s=[{name:"id",translation:a(y.default.emaiId)},{name:"status",translation:a(y.default.emailHeaderStatus)},{name:"name",translation:a(y.default.emailHeaderName)},{name:"technical_name",translation:a(y.default.emailTechnicalName)},{name:"email_sent",translation:a(y.default.emailHeaderSent)},{name:"email_hard_bounced",translation:a(y.default.emailHeaderHardBounced)},{name:"email_soft_bounced",translation:a(y.default.emailHeaderSoftBounced)},{name:"clicks",translation:a(y.default.emailHeaderClicks)},{name:"impressions",translation:a(y.default.emailHeaderImpressions)}],l=s.map((function(e){return e.translation}));i.push(l),t.forEach((function(e){var t=s.map((function(t){return e[t.name]}));i.push(t)})),I([{name:r,data:i}],e+"_email-campaigns","xlsx")},exportEmailCampaignDashboard:function(e,t,n,a,r,o){var i=t.name+" - "+t.id,s=[{name:"day",translation:o(d.default.day)},{name:"email_sent",translation:o(l.messages.emailSent)},{name:"email_hard_bounced",translation:o(l.messages.emailHardBounced)},{name:"email_soft_bounced",translation:o(l.messages.emailSoftBounced)},{name:"clicks",translation:o(l.messages.clicks)},{name:"impressions",translation:o(l.messages.impressions)},{name:"email_unsubscribed",translation:o(l.messages.emailUnsubscribed)},{name:"email_complaints",translation:o(l.messages.emailComplaints)},{name:"uniq_impressions",translation:o(l.messages.uniqImpressions)},{name:"uniq_clicks",translation:o(l.messages.uniqClicks)},{name:"uniq_email_sent",translation:o(l.messages.uniqEmailSent)},{name:"uniq_email_unsubscribed",translation:o(l.messages.uniqEmailUnsubscribed)},{name:"uniq_email_hard_bounced",translation:o(l.messages.uniqEmailHardBounced)},{name:"uniq_email_soft_bounced",translation:o(l.messages.uniqEmailSoftBounced)},{name:"uniq_email_complaints",translation:o(l.messages.uniqEmailComplaints)}],c=[{name:"id",translation:o(l.messages.id)},{name:"batch_size",translation:o(l.messages.batchSize)},{name:"blast_name",translation:o(l.messages.blastName)},{name:"from_email",translation:o(l.messages.fromEmail)},{name:"from_name",translation:o(l.messages.fromName)},{name:"number_mail_not_send",translation:o(l.messages.numberEmailNotSent)},{name:"reply_to",translation:o(l.messages.replyTo)},{name:"send_date",translation:o(l.messages.sendDate)},{name:"status",translation:o(l.messages.status)},{name:"subject_line",translation:o(l.messages.subjectLine)}],u=[M(f.default.emailCampaignExportTitle,n,s,r,o,i),M(f.default.emailCampaignBlastExportTitle,a,c,r,o)].filter((function(e){return e}));u.length&&I(u,e+"_email-campaign","xlsx")},exportAudienceSegments:function(e,t,n,a,r){var o=r(c.default.audienceSegmentsExportTitle),i=[],s=[];s.push(o),s.push([r(E.from)+" "+new g.default("now").toMoment().format("YYYY-MM-DD")+" "+r(E.to)+" "+new g.default("now").toMoment().format("YYYY-MM-DD")]),s.push(i),a.keywords&&s.push(["Search keywords",a.keywords]),a.type.length>0&&s.push(["Displayed types",a.type.join(", ")]),s.push(i);var l=[{name:"id",translation:"ID"},{name:"type",translation:r(c.default.type)},{name:"name",translation:r(c.default.name)},{name:"technical_name",translation:r(c.default.technicalName)},{name:"user_points_count",translation:r(c.default.userPoints)},{name:"user_accounts_count",translation:r(c.default.userAccounts)},{name:"desktop_cookie_ids_count",translation:r(c.default.desktopCookieId)},{name:"emails_count",translation:r(c.default.emails)},{name:"user_point_additions",translation:r(c.default.addition)},{name:"user_point_deletions",translation:r(c.default.deletion)}],u=l.map((function(e){return e.translation}));s.push(u),n.forEach((function(e){var t=l.map((function(t){return e[t.name]}));s.push(t)})),I([{name:o,data:s}],e+"_audience-segments","xlsx")},exportAudienceFeeds:function(e,t,n,a){var r=a(u.default.audienceFeedsExportTitle),o=[];o.push([r]),o.push([]),o.push([a(u.default.date),(0,v.formatUnixTimestamp)(Date.now())]),o.push([a(u.default.communityId),n.community_id]),o.push([a(u.default.communityName),n.organisation_name]),o.push([a(u.default.organisationId),n.organisation_id]),o.push([a(u.default.organisationName),n.organisation_name]),o.push([]),o.push([a(u.default.filterName),a(u.default.filterValues)]),o.push([a(u.default.connectorType),a(u.default[t.feedType])]),o.push([a(u.default.connectorName),0!==t.artifactIds.length?t.artifactIds.join(", "):a(u.default.filterAll)]);var i=t.status.map((function(e){return a(u.default[e])})).join(", ");o.push([a(u.default.status),0!==i.length?i:a(u.default.filterAll)]),o.push([]);var s=[{name:"segment_id",translation:a(u.default.segmentId)},{name:"segment_name",translation:a(u.default.segmentName)},{name:"feed_id",translation:a(u.default.feedId)},{name:"feed_name",translation:a(u.default.feedName)},{name:"connector_type",translation:a(u.default.connectorType)},{name:"connector_name",translation:a(u.default.connectorName)},{name:"status",translation:a(u.default.status)}].map((function(e){return e.translation}));o.push(s),e.forEach((function(e){var n=e.feed,r=e.audienceSegment,i=[],s=r?r.name?r.name:a(u.default.segmentNameNotFound):a(u.default.segmentDeleted);i.push(r.id,s,n.id,n.name||"-",a(u.default[t.feedType]),n.artifact_id,a(u.default[n.status])),o.push(i)})),I([{name:r,data:o}],n.organisation_id+"_audience-feeds","xlsx")},exportDisplayCampaigns:function(e,t,n,a){var r=a(s.messages.displayCampaignsExportTitle),o=[],i=[];i.push(r),i.push([a(E.from)+" "+n.from.toMoment().format("YYYY-MM-DD")+" "+a(E.to)+" "+n.to.toMoment().format("YYYY-MM-DD")]),i.push(o),n.keywords&&i.push(["Search keywords",n.keywords]),n.statuses.length>0&&i.push(["Displayed statuses",n.statuses.join(", ")]),i.push(o);var l=[{name:"id",translation:a(s.messages.id)},{name:"status",translation:a(s.messages.status)},{name:"name",translation:a(s.messages.name)},{name:"technical_name",translation:a(s.messages.technicalName)},{name:"impressions",translation:a(s.messages.impressions)},{name:"clicks",translation:a(s.messages.clicks)},{name:"cpm",translation:a(s.messages.cpm)},{name:"ctr",translation:a(s.messages.ctr)},{name:"cpc",translation:a(s.messages.cpc)},{name:"impressions_cost",translation:a(s.messages.impressionCost)},{name:"cpa",translation:a(s.messages.cpa)}],c=l.map((function(e){return e.translation}));i.push(c),t.forEach((function(e){var t=l.map((function(t){return e[t.name]}));i.push(t)})),I([{name:r,data:i}],e+"_display-campaigns","xlsx")},exportDisplayCampaignDashboard:function(e,t,n,r,o,i,l,c,u){var p,m=t.name+" - "+t.id,g=O(c.to.raw())-O(c.from.raw())<=1?{name:"hour_of_day",translation:u(d.default.hour)}:{name:"day",translation:u(d.default.day)},y=[g,{name:"impressions",translation:u(s.messages.impressions)},{name:"clicks",translation:u(s.messages.clicks)},{name:"cpm",translation:u(s.messages.cpm)},{name:"ctr",translation:u(s.messages.ctr)},{name:"cpc",translation:u(s.messages.cpc)},{name:"impressions_cost",translation:u(s.messages.impressionCost)},{name:"cpa",translation:u(s.messages.cpa)}],h=[{name:"display_network_name",translation:u(s.messages.display_network_name)},{name:"media_id",translation:u(s.messages.name)},{name:"format",translation:u(s.messages.formats)},{name:"impressions",translation:u(s.messages.impressions)},{name:"clicks",translation:u(s.messages.clicks)},{name:"cpm",translation:u(s.messages.cpm)},{name:"ctr",translation:u(s.messages.ctr)},{name:"cpc",translation:u(s.messages.cpc)},{name:"impressions_cost",translation:u(s.messages.impressionCost)},{name:"cpa",translation:u(s.messages.cpa)}],v=[{name:"id",translation:u(s.messages.id)},{name:"status",translation:u(s.messages.status)},{name:"name",translation:u(s.messages.name)},{name:"impressions",translation:u(s.messages.impressions)},{name:"clicks",translation:u(s.messages.clicks)},{name:"cpm",translation:u(s.messages.cpm)},{name:"ctr",translation:u(s.messages.ctr)},{name:"cpc",translation:u(s.messages.cpc)},{name:"impressions_cost",translation:u(s.messages.impressionCost)},{name:"cpa",translation:u(s.messages.cpa)}],b=[g,{name:"weighted_conversions",translation:u(s.messages.weightedConversion)},{name:"interaction_to_conversion_duration",translation:u(s.messages.interactionToConversionDuration)}],_=t||null,S=a({},c,{from:c.from.toMoment().format("YYYY-MM-DD"),to:c.to.toMoment().format("YYYY-MM-DD")}),E=[M(f.default.displayCampaignExportTitle,n,y,S,u,m,_),M(f.default.mediasExportTitle,r,h,S,u,"",_),M(f.default.adGroupsExportTitle,o,v,S,u,"",_),M(f.default.adsExportTitle,i,v,S,u,"",_)].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}((p=[],l.forEach((function(e){e.attribution.forEach((function(t){p.push(M(function(e){if(!e)throw new Error("An Excel spreadsheet can't have no name.");return e.replace(/\\/gm,"").replace(/\//gm,"").replace(/\?/gm,"").replace(/\*/gm,"").replace(/\[/gm,"").replace(/\]/gm,"")}(function(e){return e?e.length>20?e.substring(0,15)+"...":e:"undefined"}(t.attribution_model_name)+" -- "+e.id+" - "+e.goal_name),t.perf,b,S,u,e.goal_name+" - "+t.attribution_model_name,_))}))})),p))).filter((function(e){return e}));E.length&&I(E,e+"_display-campaign","xlsx")},exportAudienceSegmentDashboard:function(e,t,n,r,o,i,s,l){var u=(l||[]).reduce((function(e,t){return a({},e,(n={},r=t.technical_name,o=t.display_name||t.technical_name,r in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,n));var n,r,o}),{user_points:i(c.default.userPoints)}),p=Object.keys(u).map((function(e){return{name:e,translation:u[e]}})),m=[{name:"day",translation:d.default.day.defaultMessage},{name:"user_point_additions",translation:i(c.default.userPointAddition)},{name:"user_point_deletions",translation:i(c.default.userPointDeletion)}],g=[{name:"xKey",translation:i(c.default.overlap)},{name:"yKey",translation:i(c.default.overlapNumber)},{name:"segment_intersect_with",translation:"id"}],y=s||null,h=[M(f.default.audienceSegmentOverviewExportTitle,n,p,o,i,"",y),M(f.default.audienceSegmentAdditionsDeletionsExportTitle,n,m,o,i,"",y),M(f.default.overlapExportTitle,r,g,o,i,"",y)].filter((function(e){return e}));h.length&&I(h,e+"_"+t+"_audience-segments","xlsx")},exportServiceUsageReportList:function(e,t,n,a){var r="Service Usage Report List - "+e,o=[{name:"provider_organisation_id",translation:a(f.default.providerOrganisationId)},{name:"provider_name",translation:a(m.messages.providerName)},{name:"campaign_id",translation:a(f.default.campaignId)},{name:"campaign_name",translation:a(m.messages.campaignName)},{name:"sub_campaign_id",translation:a(m.messages.subCampaignId)},{name:"sub_campaign_name",translation:a(m.messages.subCampaignName)},{name:"service_id",translation:a(f.default.serviceId)},{name:"service_name",translation:a(m.messages.serviceName)},{name:"service_element_id",translation:a(f.default.serviceElementId)},{name:"segment_name",translation:a(f.default.segmentName)},{name:"unit_count",translation:a(m.messages.usage)}],i={from:n.from.toMoment().format("YYYY-MM-DD"),to:n.to.toMoment().format("YYYY-MM-DD")},s=[M(f.default.serviceUsageReportList,t,o,i,a,r)].filter((function(e){return e}));s.length&&I(s,e+"_service-usage-report-list","xlsx")},exportCreativeAdServingSnippet:function(e,t,n,a){var r="Creative Snippets - "+t,o=[{name:"creative_name",translation:a(s.messages.creativeName)},{name:"snippet_code",translation:a(s.messages.snippet)}],i=[M(f.default.creativeName,n,o,void 0,a,r)].filter((function(e){return e}));i.length&&I(i,e+"_"+t+"-snippets","xlsx")},exportABComparison:function(e,t,n){var a=n(b.messagesMap.abTestingDetailsTitle),r=[];r.push(a),r.push([]);var o=[{name:"metricName",translation:""},{name:"experimentationMetric",translation:n(b.messagesMap.experimentationSegmentName)},{name:"controlGroupMetric",translation:n(b.messagesMap.controlGroupSegmentName)},{name:"comparison",translation:n(b.messagesMap.uplift)}],i=o.map((function(e){return e.translation}));r.push(i),t.forEach((function(e){var t=o.map((function(t){return e[t.name]}));r.push(t)})),I([{name:a,data:r}],e.name+"_ab-details","xlsx")},exportFunnel:function(e,t,n,a){var r=[],o=[];o.push("Funnel report");var i=[{name:"total user points",translation:a(_.funnelMessages.stepName)}];o.push(r),o.push(r);var s=i.map((function(e){return e.name}));o.push(s),o.push([e.total]),o.push(r),o.push(r);var l=[{name:"Step name",translation:a(_.funnelMessages.stepName)},{name:"Channel ID",translation:a(_.funnelMessages.channelId)},{name:"User points",translation:a(_.funnelMessages.userPoints)},{name:"# units",translation:a(_.funnelMessages.conversion)},{name:"Amount",translation:a(_.funnelMessages.amount)},{name:"Interaction duration",translation:a(_.funnelMessages.duration)}].map((function(e){return e.name}));o.push(l),e.global.steps.forEach((function(t,n){var a=[],r=t.name,i=t.count,s=t.conversion,l=t.amount,c=t.interaction_duration;a.push(r,"",i,s,l,c+"s"),o.push(a),e.grouped_by.filter((function(e){return e.dimension_value})).forEach((function(e){var t=[];t.push("",e.dimension_value,e.funnel.steps[n].count,e.funnel.steps[n].conversion,e.funnel.steps[n].amount,e.funnel.steps[n].interaction_duration+"s"),o.push(t)}))})),I([{name:"Funnel report",data:o}],n+"_"+t+"_funnel","xlsx")}}},,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatDisplayCampaignProperty=t.formatAdGroupProperty=t.messages=void 0;var a=n(6),r=n(414),o=(t.messages=(0,a.defineMessages)({id:{id:"display.metrics.id",defaultMessage:"Id"},status:{id:"display.metrics.status",defaultMessage:"Status"},name:{id:"display.metrics.name",defaultMessage:"Name"},technicalName:{id:"display.metrics.technicalName",defaultMessage:"Technical Name"},impressions:{id:"display.metrics.impressions",defaultMessage:"Imp."},cpm:{id:"display.metrics.cpm",defaultMessage:"CPM"},cpa:{id:"display.metrics.cpa",defaultMessage:"CPA"},ctr:{id:"display.metrics.ctr",defaultMessage:"CTR"},cpc:{id:"display.metrics.cpc",defaultMessage:"CPC"},weightedConversion:{id:"display.metrics.weightedConversion",defaultMessage:"Weighted Conversions"},interactionToConversionDuration:{id:"display.metrics.interaction_to_conversion_duration",defaultMessage:"Interaction To Conversion Duration"},impressionCost:{id:"display.metrics.impressions_cost",defaultMessage:"Spent"},clicks:{id:"display.metrics.clicks",defaultMessage:"Clicks"},display_network_name:{id:"display.metrics.display_network_name",defaultMessage:"Display Network Name"},formats:{id:"display.metrics.formats",defaultMessage:"Formats"},duplication:{id:"display.duplication",defaultMessage:"Duplicate"},filterByLabel:{id:"display.filterByLabel",defaultMessage:"Filter by Label"},savingInProgress:{id:"edit.campaigns.loading.message",defaultMessage:"Saving in progress"},campaignsArchived:{id:"archive.campaigns.success.msg",defaultMessage:"Campaigns successfully archived"},campaignsSaved:{id:"save.campaigns.success.msg",defaultMessage:"Campaigns successfully saved"},editionNotAllowed:{id:"display.campaigns.table.edition.not.allowed",defaultMessage:"Edition on this campaign is deprecated, you must use navigator legacy to edit this campaign"},creativeName:{id:"campaignEditor.export.adserver.creativeName",defaultMessage:"Creative Name"},snippet:{id:"campaignEditor.export.adserver.snippet",defaultMessage:"Snippet"},confirmArchiveModalTitle:{id:"campaign.display.archive.confirmModal.title",defaultMessage:"Are you sure you want to archive this Campaign ?"},confirmArchiveModalContent:{id:"campaign.display.archive.confirmModal.content",defaultMessage:"By archiving this Campaign all its activities will be suspended. You'll be able to recover it from the archived campaign filter."},confirmArchiveModalOk:{id:"campaign.display.archive.confirmModal.ok",defaultMessage:"Archive now"},confirmArchiveModalCancel:{id:"campaign.display.archive.confirm_modal.cancel",defaultMessage:"Cancel"},searchDisplayCampaign:{id:"campaign.display.list.search.placeholder",defaultMessage:"Search Display Campaigns"},editDisplayCampaign:{id:"campaign.display.list.action.edit",defaultMessage:"Edit"},archiveDisplayCampaign:{id:"campaign.display.list.action.archive",defaultMessage:"Archive"},displayCampaignsExportTitle:{id:"campaign.display.list.actionbar.exportTitle",defaultMessage:"Display Campaigns Export"},fetchReportError:{id:"campaign.display.error.fetch-report",defaultMessage:"Cannot load campaign statistics"}}),(0,a.defineMessages)({ABOVE_THE_FOLD:{id:"adgroup.fields.visibility.aboveTheFold",defaultMessage:"Above the fold"},BELOW_THE_FOLD:{id:"adgroup.fields.visibility.belowTheFold",defaultMessage:"Below the fold"},ANY_POSITION:{id:"adgroup.fields.visibility.anyPosition",defaultMessage:"Any Position"}})),i=(0,a.defineMessages)({DAY:{id:"adgroup.fields.maxBudgetPeriod.day",defaultMessage:"Per Day"},WEEK:{id:"adgroup.fields.maxBudgetPeriod.week",defaultMessage:"Per Week"},MONTH:{id:"adgroup.fields.maxBudgetPeriod.month",defaultMessage:"Per Month"}}),s=(0,a.defineMessages)({ACTIVE:{id:"adgroup.fields.status.active",defaultMessage:"Active"},PENDING:{id:"adgroup.fields.status.pending",defaultMessage:"Pending"},PAUSED:{id:"adgroup.fields.status.paused",defaultMessage:"Paused"}}),l=(0,a.defineMessages)({ALL:{id:"adgroup.fields.targetedOperatingSystems.all",defaultMessage:"All"},IOS:{id:"adgroup.fields.targetedOperatingSystems.ios",defaultMessage:"iOS"},ANDROID:{id:"adgroup.fields.targetedOperatingSystems.android",defaultMessage:"Android"},WINDOWS_PHONE:{id:"adgroup.fields.targetedOperatingSystems.windowsPhone",defaultMessage:"Windows Phone"}}),c=(0,a.defineMessages)({WEB:{id:"adgroup.fields.targetedMedias.web",defaultMessage:"Website"},MOBILE_APP:{id:"adgroup.fields.targetedMedias.mobileApp",defaultMessage:"Mobile App"}}),u=(0,a.defineMessages)({ALL:{id:"adgroup.fields.targetedDevices.all",defaultMessage:"All"},ONLY_DESKTOP:{id:"adgroup.fields.targetedDevices.onlyDesktop",defaultMessage:"Desktop"},ONLY_MOBILE:{id:"adgroup.fields.targetedDevices.onlyMobile",defaultMessage:"Mobile"},ONLY_TABLET:{id:"adgroup.fields.targetedDevices.onlyTablet",defaultMessage:"Tablet"},MOBILE_AND_TABLET:{id:"adgroup.fields.targetedDevices.mobileAndTablet",defaultMessage:"Mobile and Tablet"}}),d=(0,a.defineMessages)({ALL:{id:"adgroup.fields.targetedBrowserFamilies.all",defaultMessage:"All"},CHROME:{id:"adgroup.fields.targetedBrowserFamilies.chrome",defaultMessage:"Chrome"},INTERNET_EXPLORER:{id:"adgroup.fields.targetedBrowserFamilies.internetExplorer",defaultMessage:"Internet Explorer"},MICROSOFT_EDGE:{id:"adgroup.fields.targetedBrowserFamilies.microsoftEdge",defaultMessage:"Microsoft Edge"},FIREFOX:{id:"adgroup.fields.targetedBrowserFamilies.firefox",defaultMessage:"Firefox"},SAFARI:{id:"adgroup.fields.targetedBrowserFamilies.safari",defaultMessage:"Safari"},OPERA:{id:"adgroup.fields.targetedBrowserFamilies.opera",defaultMessage:"Opera"}}),f=(0,a.defineMessages)({ALL:{id:"adgroup.fields.targetedConnectionTypes.all",defaultMessage:"All"},ETHERNET:{id:"adgroup.fields.targetedConnectionTypes.ethernet",defaultMessage:"Ethernet"},WIFI:{id:"adgroup.fields.targetedConnectionTypes.wifi",defaultMessage:"Wifi"},CELLULAR_NETWORK_2G:{id:"adgroup.fields.targetedConnectionTypes.cellularNetwork2G",defaultMessage:"2G"},CELLULAR_NETWORK_3G:{id:"adgroup.fields.targetedConnectionTypes.cellularNetwork3G",defaultMessage:"3G"},CELLULAR_NETWORK_4G:{id:"adgroup.fields.targetedConnectionTypes.cellularNetwork4G",defaultMessage:"4G"}}),p=(0,a.defineMessages)({id:{id:"adgroup.fields.id",defaultMessage:"ID"},name:{id:"adgroup.fields.name",defaultMessage:"Ad Group Name"},technical_name:{id:"adgroup.fields.technicalName",defaultMessage:"Technical Name"},visibility:{id:"adgroup.fields.visibility",defaultMessage:"Visibility"},bid_optimization_objective_type:{id:"adgroup.fields.bidOptimizationObjectiveType",defaultMessage:"Bid Optimization Objective Type"},bid_optimization_use_user_data:{id:"adgroup.fields.bidOptimizationUseUserData",defaultMessage:"Bid Optimization Use User Data"},bid_optimization_objective_value:{id:"adgroup.fields.bidOptimizationObjectiveValue",defaultMessage:"Bid Optimization Objective Value"},viewability_min_score:{id:"adgroup.fields.viewabilityMinScore",defaultMessage:"Viewability Min Score"},viewability_use_third_party_data:{id:"adgroup.fields.viewabilityUseThirdPartyData",defaultMessage:"Viewability Use Third Party Data"},ab_selection:{id:"adgroup.fields.abSelection",defaultMessage:"Ab Selection"},ab_selection_min:{id:"adgroup.fields.abSelectionMin",defaultMessage:"Ab Selection Min"},ab_selection_max:{id:"adgroup.fields.abSelectionMax",defaultMessage:"Ab Selection Max"},start_date:{id:"adgroup.fields.startDate",defaultMessage:"Start date"},end_date:{id:"adgroup.fields.endDate",defaultMessage:"End date"},max_bid_price:{id:"adgroup.fields.maxBidPrice",defaultMessage:"Max Bid Price"},per_day_impression_capping:{id:"adgroup.fields.perDayImpressionCapping",defaultMessage:"Daily Impression Capping"},total_impression_capping:{id:"adgroup.fields.totalImpressionCapping",defaultMessage:"Total Impression Capping"},budget_relative_to_campaign:{id:"adgroup.fields.budgetRelativeToCampaign",defaultMessage:"Budget Relative To Campaign"},total_budget:{id:"adgroup.fields.totalBudget",defaultMessage:"Total Budget"},max_budget_per_period:{id:"adgroup.fields.maxBudgetPerPeriod",defaultMessage:"Budget Split"},max_budget_period:{id:"adgroup.fields.maxBudgetPeriod",defaultMessage:"Budget Split Period"},status:{id:"adgroup.fields.status",defaultMessage:"Status"},targeted_operating_systems:{id:"adgroup.fields.targetedOperatingSystems",defaultMessage:"Operating System"},targeted_medias:{id:"adgroup.fields.targetedMedias",defaultMessage:"Media Type"},targeted_devices:{id:"adgroup.fields.targetedDevices",defaultMessage:"Device Type"},targeted_browser_families:{id:"adgroup.fields.targetedBrowserFamilies",defaultMessage:"Browser"},targeted_connection_types:{id:"adgroup.fields.targetedConnectionTypes",defaultMessage:"Connection Type"},duration:{id:"adgroup.fields.duration",defaultMessage:"Duration"},history_title:{id:"adgroup.resourceHistory.title",defaultMessage:"Ad Group History"},history_resource_type:{id:"adgroup.resourceHistory.type",defaultMessage:"Ad Group"}}),m={id:{format:"STRING"},name:{format:"STRING"},technical_name:{format:"STRING"},visibility:{format:"MESSAGE",messageMap:o},viewability_min_score:{format:"INTEGER"},viewability_use_third_party_data:{format:"STRING"},ab_selection:{format:"STRING"},ab_selection_min:{format:"INTEGER"},ab_selection_max:{format:"INTEGER"},start_date:{format:"TIMESTAMP"},end_date:{format:"TIMESTAMP"},max_bid_price:{format:"FLOAT"},per_day_impression_capping:{format:"INTEGER"},total_impression_capping:{format:"INTEGER"},budget_relative_to_campaign:{format:"STRING"},total_budget:{format:"FLOAT"},max_budget_per_period:{format:"FLOAT"},max_budget_period:{format:"MESSAGE",messageMap:i},status:{format:"MESSAGE",messageMap:s},targeted_operating_systems:{format:"MESSAGE",messageMap:l},targeted_medias:{format:"MESSAGE",messageMap:c},targeted_devices:{format:"MESSAGE",messageMap:u},targeted_browser_families:{format:"MESSAGE",messageMap:d},targeted_connection_types:{format:"MESSAGE",messageMap:f},duration:{format:"STRING"},history_title:{format:"STRING"},history_resource_type:{format:"STRING"}},g=(t.formatAdGroupProperty=function(e,t){return{message:p[e],formattedValue:t&&m[e]?(0,r.formatToFormattingFunction)(t,m[e].format,m[e].messageMap):void 0}},(0,a.defineMessages)({PROGRAMMATIC:{id:"campaign.display.fields.subtype.programmatic",defaultMessage:"Programmatic"},AD_SERVING:{id:"campaign.display.fields.subtype.adServing",defaultMessage:"Ad Serving"},TRACKING:{id:"campaign.display.fields.subtype.tracking",defaultMessage:"Tracking"}})),y=(0,a.defineMessages)({ACTIVE:{id:"campaign.display.fields.status.active",defaultMessage:"Active"},PENDING:{id:"campaign.display.fields.status.pending",defaultMessage:"Pending"},PAUSED:{id:"campaign.display.fields.status.paused",defaultMessage:"Paused"},ARCHIVED:{id:"campaign.display.fields.status.archived",defaultMessage:"Archived"}}),h=(0,a.defineMessages)({id:{id:"campaign.display.fields.id",defaultMessage:"ID"},organisation_id:{id:"campaign.display.fields.organisationId",defaultMessage:"Organisation ID"},name:{id:"campaign.display.fields.name",defaultMessage:"Campaign Name"},creation_ts:{id:"campaign.display.fields.creationTs",defaultMessage:"Creation Timestamp"},editor_version_id:{id:"campaign.display.fields.editorVersionId",defaultMessage:"Editor Version ID"},editor_version_value:{id:"campaign.display.fields.editorVersionValue",defaultMessage:"Editor Version Value"},editor_group_id:{id:"campaign.display.fields.editorGroupId",defaultMessage:"Editor Group ID"},editor_artifact_id:{id:"campaign.display.fields.editorArtifactId",defaultMessage:"Editor Artifact ID"},status:{id:"campaign.display.fields.status",defaultMessage:"Status"},currency_code:{id:"campaign.display.fields.currencyCode",defaultMessage:"Currency Code"},technical_name:{id:"campaign.display.fields.technicalName",defaultMessage:"Technical Name"},archived:{id:"campaign.display.fields.archived",defaultMessage:"Archived"},subtype:{id:"campaign.display.fields.subtype",defaultMessage:"Subtype"},max_bid_price:{id:"campaign.display.fields.maxBidPrice",defaultMessage:"Max Bid Price"},total_budget:{id:"campaign.display.fields.totalBudget",defaultMessage:"Total Budget"},max_budget_per_period:{id:"campaign.display.fields.maxBudgetPerPeriod",defaultMessage:"Budget Split"},max_budget_period:{id:"campaign.display.fields.maxBudgetPeriod",defaultMessage:"Budget Split Period"},total_impression_capping:{id:"campaign.display.fields.totalImpressionCapping",defaultMessage:"Total Impression Capping"},per_day_impression_capping:{id:"campaign.display.fields.perDayImpressionCapping",defaultMessage:"Daily Impression Capping"},start_date:{id:"campaign.display.fields.startDate",defaultMessage:"Start Date"},end_date:{id:"campaign.display.fields.endDate",defaultMessage:"End Date"},time_zone:{id:"campaign.display.fields.timeZone",defaultMessage:"Time Zone"},model_version:{id:"campaign.display.fields.modelVersion",defaultMessage:"Model Version"},type:{id:"campaign.display.fields.type",defaultMessage:"Type"},automated:{id:"campaign.display.fields.automated",defaultMessage:"Automated"},history_title:{id:"campaign.display.resourceHistory.title",defaultMessage:"Display Campaign History"},history_resource_type:{id:"campaign.display.resourceHistory.type",defaultMessage:"Display Campaign"}}),v={id:{format:"STRING"},organisation_id:{format:"STRING"},name:{format:"STRING"},creation_ts:{format:"TIMESTAMP"},editor_version_id:{format:"STRING"},editor_version_value:{format:"STRING"},editor_group_id:{format:"STRING"},editor_artifact_id:{format:"STRING"},status:{format:"MESSAGE",messageMap:y},currency_code:{format:"STRING"},technical_name:{format:"STRING"},archived:{format:"STRING"},subtype:{format:"MESSAGE",messageMap:g},max_bid_price:{format:"FLOAT"},total_budget:{format:"FLOAT"},max_budget_per_period:{format:"FLOAT"},max_budget_period:{format:"MESSAGE",messageMap:i},total_impression_capping:{format:"INTEGER"},per_day_impression_capping:{format:"INTEGER"},start_date:{format:"TIMESTAMP"},end_date:{format:"TIMESTAMP"},time_zone:{format:"STRING"},model_version:{format:"STRING"},type:{format:"STRING"},automated:{format:"STRING"},history_title:{format:"STRING"},history_resource_type:{format:"STRING"}};t.formatDisplayCampaignProperty=function(e,t){return{message:h[e],formattedValue:t&&v[e]?(0,r.formatToFormattingFunction)(t,v[e].format,v[e].messageMap):void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},c=function(e){function t(){return i(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,r=e.title,i=l(e,["children","className","title"]);return o.createElement("div",a({className:"card-flex mcs-card compact "+(n||"")},i),r?o.createElement("div",{className:"title"},r):void 0,t)}}]),t}(o.Component);t.default=c},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.submitOnEnter=void 0,t.createFieldArrayModel=i,t.createFieldArrayModelWithMeta=function(e,t){return Object.assign(Object.assign({},i(e)),{meta:t})};var a,r=n(47),o=(a=r)&&a.__esModule?a:{default:a};function i(e){return{model:e,key:e.id||(0,o.default)()}}t.submitOnEnter=function(e,t){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),t())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.generateFakeId=function(){return Math.random()+"_fakeid"},t.isFakeId=function(e){return(""+e).endsWith("_fakeid")}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(25),r=n(736),o={closeNextDrawer:r.closeNextDrawer,openNextDrawer:r.openNextDrawer};t.default=(0,a.connect)(void 0,o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentNameDisplay=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=n(6),c=n(15),u=n(12),d=n(23),f=(a=d)&&a.__esModule?a:{default:a};var p=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},m=(0,l.defineMessages)({CLICKERS:{id:"components.segmentNameDisplay.CLICKERS",defaultMessage:"Clickers"},EXPOSED:{id:"components.segmentNameDisplay.EXPOSED",defaultMessage:"Exposed"}}),g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchAudienceSegmentResource=function(e){return n._audienceSegmentService.getSegment(e).then((function(e){return n.props.onLoad&&n.props.onLoad(e.data),e.data}))},n.ellipsizeSegmentName=function(e){return n.props.tableViewMode&&e.length>100?e.substring(0,100)+"...":e},n.displayId=function(){var e=n.state.audienceSegmentResource;return e?e.name===e.id?i.createElement("span",null):i.createElement("span",null," ",e.id," - "):i.createElement("span",null)},e.audienceSegmentResource?n.state={audienceSegmentResource:e.audienceSegmentResource}:n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.audienceSegmentId;t&&this.fetchAudienceSegmentResource(t).then((function(t){e.setState({audienceSegmentResource:t})})).catch((function(t){e.props.notifyError(t)}))}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,a=n.audienceSegmentId,r=n.audienceSegmentResource;r&&(!e.audienceSegmentResource||e.audienceSegmentResource&&r.id!==e.audienceSegmentResource.id)?this.setState({audienceSegmentResource:r}):a&&(!e.audienceSegmentId||e.audienceSegmentId&&a!==e.audienceSegmentId)&&this.fetchAudienceSegmentResource(a).then((function(e){t.setState({audienceSegmentResource:e})})).catch((function(e){t.props.notifyError(e)}))}},{key:"render",value:function(){var e=this.props,t=e.intl,n=e.showId,a=this.state.audienceSegmentResource;if(!a)return i.createElement("span",null);var r=a.name;return"USER_ACTIVATION"===a.type&&(a.clickers?r=this.ellipsizeSegmentName(a.name)+" - "+t.formatMessage(m.CLICKERS):a.exposed&&(r=this.ellipsizeSegmentName(a.name)+" - "+t.formatMessage(m.EXPOSED))),i.createElement("span",{title:a.name},n&&this.displayId()," ",this.ellipsizeSegmentName(r))}}]),t}(i.Component);p([(0,c.lazyInject)(u.TYPES.IAudienceSegmentService)],g.prototype,"_audienceSegmentService",void 0);var y=(0,s.compose)(l.injectIntl,f.default)(g);t.SegmentNameDisplay=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({saveCreative:{id:"message.submit.saveCreative",defaultMessage:"Save"},editCreatives:{id:"message.edit.creatives",defaultMessage:"Edit Creatives"},multiEditCreativesSubtitle:{id:"message.edit.creatives.form.subtitle",defaultMessage:"In this section you will be able to edit the creatives you just selected :"},multiEditCreativesTitle:{id:"message.edit.creatives.form.title",defaultMessage:"Multi Creative Edit"},addCreative:{id:"message.add.saveCreative",defaultMessage:"Add"},updateCreative:{id:"message.update.saveCreative",defaultMessage:"Update"},creativesTypePickerTitle:{id:"creatives.create.typePicker.title",defaultMessage:"Creative Type"},creativesTypePickerSubTitle:{id:"creatives.display.edit.typePicker.subtitle",defaultMessage:"Choose your creative type"},creativeSectionGeneralTitle:{id:"creatives.create.section.general.title",defaultMessage:"General Information"},creativeSectionGeneralSubTitle:{id:"creatives.create.section.general.subtitle",defaultMessage:"Give your Creative a name, a format and a destination domain to make it usable."},creativeSectionGeneralMultipleSubTitle:{id:"creatives.create.section.general.multiple.subtitle",defaultMessage:"Give your Creative a destination domain. You can change your creative name in the left panel."},creativeSectionPropertyTitle:{id:"creatives.create.section.properties.title",defaultMessage:"Creative Properties"},creativeSectionPropertySubTitle:{id:"creatives.create.section.properties.subtitle",defaultMessage:"Fill the property of your creative to turn it real!"},creativeSectionAuditTitle:{id:"creatives.create.section.audit.title",defaultMessage:"Audit Information"},creativeSectionAuditSubTitle:{id:"creatives.create.section.audit.subtitle",defaultMessage:"If you want to advertise through adechanges you need to pass an audit first. Click on the start audit button to get started."},creativeSectionPreviewTitle:{id:"creatives.create.section.preview.title",defaultMessage:"Preview"},creativeSectionPreviewSubTitle:{id:"creatives.create.section.preview.subtitle",defaultMessage:"This is how you creative will render on a publisher website. Please note that the tracker won't be visible here"},creativeCreationSaveButton:{id:"creatives.create.actionbar.button.saveRefresh",defaultMessage:"Save & Refresh"},creativeCreationBreadCrumb:{id:"creatives.create.actionbar.breadcrumb.label",defaultMessage:"New Display Creative"},nativeCreationBreadCrumb:{id:"natives.create.actionbar.breadcrumb.label",defaultMessage:"New Native Creative"},creativeEditionBreadCrumb:{id:"creatives.edition.actionbar.breadcrumb.label",defaultMessage:"Edit {name}"},displayListBreadCrumb:{id:"display.creatives.list.actionbar.breadcrumb.label",defaultMessage:"Display Ads"},nativeListBreadCrumb:{id:"native.creatives.list.actionbar.breadcrumb.label",defaultMessage:"Natives"},creativeCreationGeneralNameFieldTitle:{id:"creatives.create.section.general.field.name.title",defaultMessage:"Creative Name"},creativeCreationGeneralNameFieldPlaceHolder:{id:"creatives.create.section.general.field.name.placeholder",defaultMessage:"Creative Name"},creativeCreationGeneralNameFieldHelper:{id:"creatives.create.section.general.field.name.helper",defaultMessage:"Give your Creative a name and make it as memorable as your Creative!"},creativeCreationGeneralFormatFieldTitle:{id:"creatives.create.section.general.field.format.title",defaultMessage:"Format"},creativeCreationGeneralFormatFieldPlaceHolder:{id:"creatives.create.section.general.field.format.placeholder",defaultMessage:"Creative Format"},creativeCreationGeneralFormatFieldButtonCustom:{id:"creatives.create.section.general.field.format.button.custom",defaultMessage:"Custom"},creativeCreationGeneralFormatFieldButtonStandard:{id:"creatives.create.section.general.field.format.button.standard",defaultMessage:"Standard"},creativeCreationGeneralFormatFieldHelper:{id:"creatives.create.section.general.field.format.helper",defaultMessage:"The format of the creative will be used in campaign by the platform. The format is as follow: width x height"},creativeCreationGeneralDomainFieldTitle:{id:"creatives.create.section.general.field.domain.title",defaultMessage:"Destination Domain"},creativeCreationGeneralDomainFieldPlaceHolder:{id:"creatives.create.section.general.field.domain.placeholder",defaultMessage:"Destination Domain"},creativeCreationGeneralDomainFieldHelper:{id:"creatives.create.section.general.field.domain.helper",defaultMessage:"This is the domain of the Advertiser (without http or params) eg: mybrand.com.\n It'll be checked during Creative Audit and for the creative whitelisting/blacklisting by Publishers on SSPs."},creativeSiderMenuCreativeType:{id:"creatives.sider.menu.creativeType",defaultMessage:"Creative Type"},creativeSiderMenuGeneralInformation:{id:"creatives.sider.menu.generalInformation",defaultMessage:"General Information"},creativeSiderMenuProperties:{id:"creatives.sider.menu.properties",defaultMessage:"Properties"},creativeSiderMenuPreview:{id:"creatives.sider.menu.preview",defaultMessage:"Preview"},creativeSiderMenuAudit:{id:"creatives.sider.menu.audit",defaultMessage:"Audit Information"},creativeTypeQuantum:{id:"creatives.type.quantum",defaultMessage:"Quantum"},creativeTypeIvidence:{id:"creatives.type.ividence",defaultMessage:"Ividence"},creativeTypeAgency:{id:"creatives.type.agency",defaultMessage:"Agency Script"},creativeTypeImage:{id:"creatives.type.image",defaultMessage:"Banner"},creativeTypeHtml:{id:"creatives.type.html",defaultMessage:"Html"},creativeTypeSkin:{id:"creatives.type.skin",defaultMessage:"Skins"},creativeTypeNative:{id:"creatives.type.native",defaultMessage:"Native"},allRendererList:{id:"creatives.type.all.renderer.list",defaultMessage:"All Ad Renderer"},allRendererListSubtitle:{id:"creatives.type.all.renderer.list.subtitle",defaultMessage:"List of all available ad renderer."},creativeTypeOr:{id:"creatives.type.or",defaultMessage:"Or"},creativeTypeAdvanced:{id:"creatives.type.advanced",defaultMessage:"Advanced"},errorFormMessage:{id:"creatives.display.edit.generic.errorMessage",defaultMessage:"There is an error with some fields in your form. Please review the data you entered."},savingInProgress:{id:"creatives.display.edit.savingInProgress",defaultMessage:"Saving in progress"},advanced:{id:"creatives.form.advanced",defaultMessage:"Advanced"},creativeCreationAdvancedTechnicalFieldTitle:{id:"creatives.create.section.advanced.field.technical.title",defaultMessage:"Technical Name"},warningOnTokenEdition:{id:"creative.form.edition.technicalName.warning",defaultMessage:"Danger Zone: Editing this technical name may cause any integrations to fail if not updated properly. Please make sure you have reviewed all your integration before saving."},creativeCreationAdvancedTechnicalFieldPlaceholder:{id:"creatives.create.section.advanced.field.technical.placeholder",defaultMessage:"Technical Name"},creativeCreationAdvancedTechnicalFieldTooltip:{id:"creatives.create.section.advanced.field.technical.tooltip",defaultMessage:"Give your creative a technical name to leverage integrations such as external click tracking."},invalidFormat:{id:"creatives.create.section.general.invalidFormat",defaultMessage:"Invalid format."},modalConfirmTitle:{id:"creatives.create.modal.confirm.title",defaultMessage:"Warning"},modalConfirmContent:{id:"creatives.create.modal.confirm.content",defaultMessage:"You have changes that are not saved. Do you want to proceed ?"},modalConfirmOk:{id:"creatives.create.modal.confirm.Ok",defaultMessage:"Close Without Saving"},modalConfirmCancel:{id:"creatives.create.modal.confirm.cancel",defaultMessage:"Cancel"},successfulSaving:{id:"creatives.create.modal.save.successful",defaultMessage:"Your Creative has been successfully saved!"}})},,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDisplayCreativeFormData=function(e){return void 0!==e.creative&&void 0!==e.properties},t.isAdResource=function(e){return void 0!==e.id&&void 0!==e.creative_id},t.isAudienceSegmentSelectionResource=function(e){return void 0!==e.id},t.isLocationSelectionResource=function(e){return void 0!==e.id},t.isDealListSelectionResource=function(e){return void 0!==e.id},t.isAdExchangeSelectionResource=function(e){return void 0!==e.id},t.isDisplayNetworkSelectionResource=function(e){return void 0!==e.id};t.AD_GROUP_FORM_NAME="adGroupForm",t.INITIAL_AD_GROUP_FORM_DATA={adGroup:{max_budget_period:"DAY",targeted_operating_systems:"ALL",targeted_medias:"WEB",targeted_devices:"ALL",targeted_connection_types:"ALL",targeted_browser_families:"ALL"},segmentFields:[],adFields:[],locationFields:[],inventoryCatalFields:[]};var a={equals:function(e,t){return t},increase:function(e,t){return e+e*t*.01},decrease:function(e,t){return e-e*t*.01}};t.default=function(e,t,n){return a[e](t,n)}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DISPLAY_DASHBOARD_SEARCH_SETTINGS=void 0;var a=n(30);t.DISPLAY_DASHBOARD_SEARCH_SETTINGS=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(a.DATE_SEARCH_SETTINGS))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(0,n(6).defineMessages)({defaultTitle:{id:"timeline.title",defaultMessage:"History"},defaultResourceType:{id:"timeline.defaultResourceType",defaultMessage:"Resource"},adGroupResourceType:{id:"timeline.resourceType.adGroup",defaultMessage:"Ad Group"},displayCampaignResourceType:{id:"timeline.resourceType.displayCampaign",defaultMessage:"Display Campaign"},goalResourceType:{id:"timeline.resourceType.goal",defaultMessage:"Goal"},emailBlastResourceType:{id:"timeline.resourceType.emailBlast",defaultMessage:"Email Blast"},emailTemplateResourceType:{id:"timeline.resourceType.emailTemplate",defaultMessage:"Email Template"},emailCampaignResourceType:{id:"timeline.resourceType.emailCampaign",defaultMessage:"Email Campaign"},creativeResourceType:{id:"timeline.resourceType.creative",defaultMessage:"Creative"},segmentResourceType:{id:"timeline.resourceType.segment",defaultMessage:"Segment"},displayNetworkResourceType:{id:"timeline.resourceType.displayNetwork",defaultMessage:"Display Network"},keywordsListResourceType:{id:"timeline.resourceType.keywordsList",defaultMessage:"Keywords List"},dealListResourceType:{id:"timeline.resourceType.dealList",defaultMessage:"Deal List"},adExchangeResourceType:{id:"timeline.resourceType.adxExchange",defaultMessage:"Ad Exchange"},emailRouterResourceType:{id:"timeline.resourceType.emailRouter",defaultMessage:"Email Router"},exportResourceType:{id:"timeline.resourceType.export",defaultMessage:"Export"},today:{id:"timeline.events.title.today",defaultMessage:"Today"},yesterday:{id:"timeline.events.title.yesterday",defaultMessage:"Yesterday"},seeMore:{id:"timeline.events.button.viewMore",defaultMessage:"See More"},noEventsLeft:{id:"timeline.events.noEventsLeft",defaultMessage:"No Events Left"},noHistory:{id:"timeline.events.noHistory",defaultMessage:"No historical data in the last 6 months"},expandEvents:{id:"timeline.events.card.expandEvents",defaultMessage:"see more"},reduceEvents:{id:"timeline.events.card.reduceEvents",defaultMessage:"see less"},resourceCreated:{id:"timeline.events.card.resourceCreated",defaultMessage:"{userName} created the {resourceType} {parentLink}."},parentLink:{id:"timeline.events.card.resourceCreated.parentLink",defaultMessage:"in the {parentType}: {parentName}"},initialFieldValue:{id:"timeline.events.card.initialFieldValue",defaultMessage:"{field} set to {newValue}"},singleFieldEdited:{id:"timeline.events.card.singleEdit",defaultMessage:"{userName} changed {field} from {oldValue} to {newValue}."},severalFieldsEdited:{id:"timeline.events.card.multiEdit.summary",defaultMessage:"{userName} has edited several fields."},fieldInMultiEditList:{id:"timeline.events.card.multiEdit.item",defaultMessage:"{field} from {oldValue} to {newValue}"},childAddedMultiEditList:{id:"timeline.events.card.multiEdit.child.added",defaultMessage:"{linkedResource} added : {value}"},childRemovedMultiEditList:{id:"timeline.events.card.multiEdit.child.removed",defaultMessage:"{linkedResource} removed : {value}"},parentAddedMultiEditList:{id:"timeline.events.card.multiEdit.parent.added",defaultMessage:"added in the {linkedResource}: {value}"},parentRemovedMultiEditList:{id:"timeline.events.card.multiEdit.parent.removed",defaultMessage:"removed from the {linkedResource}: {value}"},resourceDeleted:{id:"timeline.events.card.resourceDeleted",defaultMessage:"{userName} deleted the {resourceType}."},noValue:{id:"timeline.events.card.field.noValue",defaultMessage:"nothing"},unknownField:{id:"timeline.events.card.edit.field",defaultMessage:"Unknown Field"},date:{id:"timeline.events.card.date",defaultMessage:"{month} {day} at {time}"},resourceCreateLinkChild:{id:"timeline.events.card.selection.resourceCreateLinkChild",defaultMessage:"{userName} added the {resourceType} : {resourceName}."},resourceDeleteLinkChild:{id:"timeline.events.card.selection.resourceDeleteLinkChild",defaultMessage:"{userName} removed the {resourceType} : {resourceName}."},resourceCreateLinkParent:{id:"timeline.events.card.selection.resourceCreateLinkParent",defaultMessage:"{userName} added this {childResourceType} in the {parentResourceType} : {parentResourceName}."},resourceDeleteLinkParent:{id:"timeline.events.card.selection.resourceDeleteLinkParent",defaultMessage:"{userName} removed this {childResourceType} from the {parentResourceType} : {parentResourceName}."},deleted:{id:"timeline.events.card.selection.deleted",defaultMessage:"(deleted)"},fetchingData:{id:"timeline.events.card.selection.fetching",defaultMessage:"(fetching...)"}});t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyRecords=t.RelatedRecords=t.RecordElement=void 0;var a=i(n(805)),r=i(n(806)),o=i(n(618));function i(e){return e&&e.__esModule?e:{default:e}}t.RecordElement=a.default,t.RelatedRecords=r.default,t.EmptyRecords=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({savingInProgress:{id:"message.loading.content.saving-in-progress",defaultMessage:"Saving in progress"},emailEditorBreadcrumbTitle1:{id:"emailEditor.breadcrumb.title1",defaultMessage:"Email Campaigns"},emailEditorBreadcrumbNewCampaignTitle:{id:"emailEditor.breadcrumb.new-campaign",defaultMessage:"New Campaign"},emailEditorBreadcrumbEditCampaignTitle:{id:"emailEditor.breadcrumb.edit-campaign",defaultMessage:"Edit {campaignName}"},emailEditorGeneralInformationTitle:{id:"emailEditor.step.title.general_information",defaultMessage:"General Information"},emailEditorGeneralInformationSubTitle:{id:"emailEditor.step.subtitle.general_information",defaultMessage:"Give your campaign a name and a technical name"},emailEditorNameInputLabel:{id:"emailEditor.step.input.label.campaign_name",defaultMessage:"Name"},emailEditorNameInputPlaceholder:{id:"emailEditor.step.input.placeholder.campaign_name",defaultMessage:"Give your Campaign a name"},emailEditorNameInputHelper:{id:"emailEditor.step.input.helper.campaign_name",defaultMessage:"Give your Campaign a name and make it as memorable as you can. It will be displayed accorss all the screens."},emailEditorSave:{id:"emailEditor.button.save",defaultMessage:"Save"},emailEditorSaveCampaign:{id:"emailEditor.button.save_campaign",defaultMessage:"Save Campaign"},emailEditorSectionTitle1:{id:"emailEditor.section.title1",defaultMessage:"General Information"},emailEditorSectionTitle2:{id:"emailEditor.breadcrumb.title2",defaultMessage:"Router Config"},emailEditorSectionTitle3:{id:"emailEditor.breadcrumb.title3",defaultMessage:"Email Blasts"},emailEditorTechnicalNameInputLabel:{id:"emailEditor.step.input.label.campaign_technical_name",defaultMessage:"Technical name"},emailEditorTechnicalNameInputPlaceholder:{id:"emailEditor.steps.general.name_placeholder",defaultMessage:"Give your Campaign a Technical Name"},emailEditorTechnicalNameInputHelper:{id:"emailEditor.steps.general.name_helper",defaultMessage:"Give your Campaign a Technical Name if you need (can be useful when using integrations)"},warningOnTokenEdition:{id:"emailEditor.steps.general.technical_name.warning",defaultMessage:"Danger Zone: Editing this technical name may cause any integrations to fail if not updated properly. Please make sure you have reviewed all your integration before saving."},emailEditorRouterTitle:{id:"emailEditor.step.title.router",defaultMessage:"Router"},emailEditorRouterSubTitle:{id:"emailEditor.step.subtitle.router",defaultMessage:"The router you select will be the same for all blast. You can use only one router per campaign."},emailEditorRouterSelectLabel:{id:"emailEditor.step.select.label.router",defaultMessage:"Router"},emailEditorRouterSelectHelper:{id:"emailEditor.step.select.helper.router",defaultMessage:"Choose your Router. A Router is basically a channel through which you will send your email."},emailEditorProviderSelectLabel:{id:"emailEditor.step.select.label.provider",defaultMessage:"Provider"},emailEditorProviderSelectHelper:{id:"emailEditor.step.select.helper.provider",defaultMessage:"A Provider helps you target the user that have given you an explicit consent on being targeted by email"},emailEditorEmailBlastTitle:{id:"emailEditor.step.title.email_blast",defaultMessage:"Email Blasts"},emailEditorEmailBlastSubTitle:{id:"emailEditor.step.subtitle.email_blast",defaultMessage:"Add a Blast to your Campaign. A Blast has a send date and a template and is sent to a particular Audience."},emailEditorEmailBlastEmpty:{id:"emailEditor.email_blast.no-blast",defaultMessage:"No blast yet, please add a blast"},segmentSelectionTitle:{id:"emailBlastEditor.title.segment",defaultMessage:"Audience Segments"},segmentSelectionSubTitle:{id:"emailBlastEditor.subtitle.segment",defaultMessage:"Configure segments for your campaign"},segmentSelectionChooseExisting:{id:"emailBlastEditor.segment.choose_existing",defaultMessage:"Choose existing"},emailBlastEditorBreadcrumbTitleNewBlast:{id:"emailBlastEditor.breadcrumb.title.new_blast",defaultMessage:"New blast"},emailBlastEditorBreadcrumbTitleEditBlast:{id:"emailBlastEditor.breadcrumb.title.edit_blast",defaultMessage:"Edit {blastName}"},emailBlastEditorStepperGeneralInformation:{id:"emailBlastEditor.stepper.general_information",defaultMessage:"General Information"},emailBlastEditorStepperBlastInformation:{id:"emailBlastEditor.stepper.blast_information",defaultMessage:"Header section"},emailBlastEditorStepperTemplateSelection:{id:"emailBlastEditor.stepper.template_selection",defaultMessage:"Template Selection"},emailBlastEditorStepperSegmentSelection:{id:"emailBlastEditor.stepper.segment_selection",defaultMessage:"Segment Selection"},emailBlastEditorStepTitleGeneralInformation:{id:"emailBlastEditor.step.title.general_information",defaultMessage:"General Information"},emailBlastEditorStepSubTitleGeneralInformation:{id:"emailBlastEditor.step.subtitle.general_information",defaultMessage:"Provide blast name and a scheduled date of execution"},emailBlastEditorInputLabelBlastName:{id:"emailBlastEditor.input.label.blast_name",defaultMessage:"Blast name"},emailBlastEditorInputPlaceholderBlastName:{id:"emailBlastEditor.input.placeholder.blast_name",defaultMessage:"Enter blast name"},emailBlastEditorInputHelperBlastName:{id:"emailBlastEditor.input.helper.blast_name",defaultMessage:"The blast name will reflect accross all the screen so make it memorable!"},emailBlastEditorDatePickerLabelSentDate:{id:"emailBlastEditor.datepicker.label.send_date",defaultMessage:"Send date"},emailBlastEditorDatePickerPlaceholderSentDate:{id:"emailBlastEditor.datepicker.placeholder.send_date",defaultMessage:"Select date"},emailBlastEditorDatePickerHelperSentDate:{id:"emailBlastEditor.datepicker.helper.send_date",defaultMessage:"This is the date at which your Blast will be sent"},emailBlastEditorStepTitleBlastInformation:{id:"emailBlastEditor.step.title.blast_information",defaultMessage:"Header section"},emailBlastEditorStepTitleTemplateSelection:{id:"emailBlastEditor.step.title.template_selection",defaultMessage:"Template Selection"},emailBlastEditorStepSubTitleTemplateSelection:{id:"emailBlastEditor.step.subtitle.template_selection",defaultMessage:"Select an email template for the body of your email."},emailBlastEditorInputLabelSubjectLine:{id:"emailBlastEditor.input.label.subject_line",defaultMessage:"Subject"},emailBlastEditorInputHelperSubjectLine:{id:"emailBlastEditor.input.helper.subject_line",defaultMessage:"The email subject is what users will see first when they open their mailbox. Make it catchy!"},emailBlastEditorInputPlaceholderSubjectLine:{id:"emailBlastEditor.input.placeholder.subject_line",defaultMessage:"Enter email subject"},emailBlastEditorInputLabelFromEmail:{id:"emailBlastEditor.input.label.from_email",defaultMessage:"From email"},emailBlastEditorInputHelperFromEmail:{id:"emailBlastEditor.input.helper.from_email",defaultMessage:"The From email is the email address your audience will receive the mail from."},emailBlastEditorInputPlaceholderFromEmail:{id:"emailBlastEditor.input.placeholder.from_email",defaultMessage:"Enter from email"},emailBlastEditorInputLabelFromName:{id:"emailBlastEditor.input.label.from_name",defaultMessage:"From name"},emailBlastEditorInputHelperFromName:{id:"emailBlastEditor.input.helper.from_name",defaultMessage:"The From name is the sender name users will see."},emailBlastEditorInputPlaceholderFromName:{id:"emailBlastEditor.input.placeholder.from_name",defaultMessage:"Enter from name"},emailBlastEditorInputLabelReplyTo:{id:"emailBlastEditor.input.label.reply_to",defaultMessage:"Reply to"},emailBlastEditorInputHelperReplyTo:{id:"emailBlastEditor.input.helper.reply_to",defaultMessage:"The Reply to is the email address users will be able to reply to."},emailBlastEditorInputPlaceholderReplyTo:{id:"emailBlastEditor.input.placeholder.reply_to",defaultMessage:"Enter reply to"},blastTemplateSelectionSelectButton:{id:"blastTemplateSelection.button.select_template",defaultMessage:"Select Template"},blastTemplateSelectionEmpty:{id:"blastTemplateSelection.empty",defaultMessage:"No template selected yet"},blastTemplateSelectionRequired:{id:"blastTemplateSelection.required",defaultMessage:"A template is required"},blastTemplateAddButton:{id:"blastTemplate.addButton",defaultMessage:"Add"},blastSegmentSelectionEmpty:{id:"blastSegmentSelection.empty",defaultMessage:"No Segment selected yet"},blastSegmentSelectionRequired:{id:"blastSegmentSelection.required",defaultMessage:"At least one segment is required"},segmentTitleColumn1:{id:"segment.title.column1",defaultMessage:"Name"},segmentTitleColumn2:{id:"segment.title.column2",defaultMessage:"User Points"},segmentTitleColumn3:{id:"segment.title.column3",defaultMessage:"Desktop Cookie Ids"},errorFormMessage:{id:"email.campaigns.edit.generic.errorMessage",defaultMessage:"There is an error with some fields in your form. Please review the data you entered."}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateRoutesFromDefinition=function(e){return Object.keys(e).map((function(t){return e[t]}))},t.generateMissingdefinitionItemFromRoute=function(e){return{path:e.path,requiredFeature:e.requiredFeature,requireDatamart:e.requireDatamart}}},,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(25),s=n(8),l=n(10),c=n(6),u=n(13),d=n(24),f=n(11),p=n(60),m=(a=p)&&a.__esModule?a:{default:a};function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=function(e){function t(){return g(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.onSelect,n=e.connectedUser,a=e.match.params.organisationId,r=e.actionbarProps,i=e.isMainlayout,s=[],c=n.workspaces.find((function(e){return e.organisation_id===a}));return c&&(s=c.datamarts),o.createElement(l.Layout,null,i?o.createElement(f.Actionbar,r):o.createElement(m.default,r),o.createElement(l.Layout.Content,{className:"mcs-content-container mcs-form-container text-center"},o.createElement(d.FormTitle,{title:v.title,subtitle:v.subTitle}),o.createElement(l.Row,{className:"mcs-selector_container"},o.createElement(l.Row,{className:"menu"},s.map((function(e){return o.createElement(f.MenuList,{key:e.id,title:e.name||e.token,select:function(){return t(e)}})}))))))}}]),t}(o.Component);t.default=(0,s.compose)(u.withRouter,(0,i.connect)((function(e){return{connectedUser:e.session.connectedUser}})))(h);var v=(0,c.defineMessages)({title:{id:"datamart.selector.title",defaultMessage:"Datamarts"},subTitle:{id:"datamart.selector.subtitle",defaultMessage:"Choose your datamart"}})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatAudienceSegmentProperty=t.userQuerySegmentSubtypeMessages=t.userListFeedTypeMessages=t.audienceSegmentTypeMessages=void 0;var a=n(6),r=n(414);t.default=(0,a.defineMessages)({audienceSegment:{id:"audience.segments",defaultMessage:"Segments"},userPoints:{id:"audience.segments.user_points",defaultMessage:"User Points"},userAccounts:{id:"audience.segments.user_accounts",defaultMessage:"User Accounts"},emails:{id:"audience.segments.emails",defaultMessage:"Emails"},desktopCookieId:{id:"audience.segments.desktop_cookie_ids",defaultMessage:"Display Cookies"},userPointAddition:{id:"audience.segments.user_point_additions",defaultMessage:"User Point Additions"},userPointDeletion:{id:"audience.segments.user_point_deletions",defaultMessage:"User Point Deletions"},overlap:{id:"audience.segments.overlap",defaultMessage:"Audience Segment Overlap"},overlapNumber:{id:"audience.segments.overlap_number",defaultMessage:"Overlap Number"},modalOverlapContentMessage:{id:"audience.segments.overlap.modal.content",defaultMessage:"By clicking on OK you will create an overlap of the selected segment. Be carefull, this operation can take a significant amount of time."},modalOverlapContentTitle:{id:"audience.segments.overlap.modal.title",defaultMessage:"Create an Overlap Analysis"},generated:{id:"audience.segments.overlap.time.generated",defaultMessage:"Generated"},refresh:{id:"audience.segments.overlap.button.refresh",defaultMessage:"Refresh"},createOverlap:{id:"audience.segments.overlap.button.create",defaultMessage:"Create Overlap Analysis"},overlapFetchingError:{id:"audience.segments.overlap.error",defaultMessage:"An unexpected error happened running your overlap. Please retry."},experimentationCreation:{id:"audience.segments.experimentation.creation",defaultMessage:"Create Experimentation"},lookAlikeCreation:{id:"audience.segments.lookalike.button.create",defaultMessage:"Create Lookalike"},lookAlikeModalTitle:{id:"audience.segments.lookalike.modal.title",defaultMessage:"Create Lookalike"},lookAlikeModalHelper:{id:"audience.segments.lookalike.modal.helper",defaultMessage:"To create a Lookalike, please select a partition and your extension ratio. Your segment will then be overlapped against the partition selected and the most overlapping partitions will be added to your base segment."},lookAlikeModalNameLabel:{id:"audience.segments.lookalike.modal.name.label",defaultMessage:"Segment Name"},lookAlikeModalPartitionLabel:{id:"audience.segments.lookalike.modal.partition.label",defaultMessage:"Partition"},lookAlikeModalExtentionFactorLabel:{id:"audience.segments.lookalike.modal.extensionFactor.label",defaultMessage:"Extension Factor"},lookAlikeCalibrationExecution:{id:"audience.segments.lookalike.button.calibration.execution",defaultMessage:"Calibrate"},lookAlikeCalibrationRunning:{id:"audience.segments.lookalike.button.calibration.executing",defaultMessage:"Calibration Ongoing"},lookAlikeCalibrationErrorSuccess:{id:"audience.segments.lookalike.button.calibration.done",defaultMessage:"Recalibrate"},USER_POINT_ADDITIONS:{id:"audience.segments.additiondeletions.userpointaddition.label",defaultMessage:"Userpoint Additions"},USER_POINT_DELETIONS:{id:"audience.segments.additiondeletions.userpointdeletion.label",defaultMessage:"Userpoint Deletions"},noAdditionDeletion:{id:"audience.segments.additiondeletions.nodata",defaultMessage:"There is no data on the selected period!"},audienceSegmentsExportTitle:{id:"audience.segments.actionbar.export.title",defaultMessage:"Audience Segments Export"},type:{id:"audience.segments.export.column.type",defaultMessage:"Type"},name:{id:"audience.segments.export.column.name",defaultMessage:"Name"},technicalName:{id:"audience.segments.export.column.technicalName",defaultMessage:"Technical Name"},addition:{id:"audience.segments.export.column.addition",defaultMessage:"Addition"},deletion:{id:"audience.segments.export.column.deletion",defaultMessage:"Deletion"},lookalikeTypeSelectorTitle:{id:"audience.segments.lookaliketypeSelector.title",defaultMessage:"Select your lookalike type"},lookalikeTypeSelectorsubTitle:{id:"audience.segments.lookaliketypeSelector.subtitle",defaultMessage:"Choose between the two following lookalike types"},extensionFactor:{id:"audience.segments.lookalikeCreation.extension",defaultMessage:"Extension Factor"},similarity:{id:"audience.segments.lookalikeCreation.similarity",defaultMessage:"Similarity"},lookalikeTooBroad:{id:"audience.segments.lookalikeCreation.lookalikeTooBroad",defaultMessage:"Lookalike is too broad."},tooltipExtensionFactor:{id:"audience.segments.lookalikeCreation.extension.tooltip",defaultMessage:"An extension factor of N means that the N most overlapping partitions will be added to your base segment."},extensionFactorError:{id:"audience.segments.lookalikeCreation.extension.error",defaultMessage:"Select a partition before choosing an extension factor."},seeToControlGroupDashboard:{id:"audience.segments.ABComparisonDashboard.controlGroupDashboardButton",defaultMessage:"See Control Group Dashboard"},history:{id:"audience.segments.actionbar.history",defaultMessage:"History"}});var o=t.audienceSegmentTypeMessages=(0,a.defineMessages)({USER_LIST:{id:"audience.segments.type.userList",defaultMessage:"User List"},USER_QUERY:{id:"audience.segments.type.userQuery",defaultMessage:"User Query"},USER_ACTIVATION:{id:"audience.segments.type.userActivation",defaultMessage:"User Activation"},USER_PARTITION:{id:"audience.segments.type.userPartition",defaultMessage:"User Partition"},USER_PIXEL:{id:"audience.segments.type.userPixel",defaultMessage:"User Pixel"},USER_LOOKALIKE:{id:"audience.segments.type.userLookalike",defaultMessage:"User Lookalike"},USER_CLIENT:{id:"audience.segments.type.userClient",defaultMessage:"EDGE"},EDGE:{id:"audience.segments.type.edge",defaultMessage:"EDGE"}}),i=(t.userListFeedTypeMessages=(0,a.defineMessages)({FILE_IMPORT:{id:"audience.segments.type.userList.feedType.fileImport",defaultMessage:"File Import"},SCENARIO:{id:"audience.segments.type.userList.feedType.scenario",defaultMessage:"Scenario"},SCENARIO_FEED:{id:"audience.segments.type.userList.feedType.scenarioFeed",defaultMessage:"Scenario Feed"},TAG:{id:"audience.segments.type.userList.feedType.tag",defaultMessage:"Tag"}}),t.userQuerySegmentSubtypeMessages=(0,a.defineMessages)({STANDARD:{id:"audience.segments.subtype.STANDARD",defaultMessage:"(Standard)"},AB_TESTING_CONTROL_GROUP:{id:"audience.segments.subtype.AB_TESTING_CONTROL_GROUP",defaultMessage:"(AB Testing Control Group)"},AB_TESTING_EXPERIMENT:{id:"audience.segments.subtype.AB_TESTING_EXPERIMENT",defaultMessage:"(AB Testing Experiment)"}}),(0,a.defineMessages)({id:{id:"audience.segments.fields.id",defaultMessage:"ID"},organisation_id:{id:"audience.segments.fields.organisationId",defaultMessage:"Organisation ID"},name:{id:"audience.segments.fields.name",defaultMessage:"Audience Segment Name"},short_description:{id:"audience.segments.fields.shortDescription",defaultMessage:"Short Description"},technical_name:{id:"audience.segments.fields.technicalName",defaultMessage:"Technical Name"},default_ttl:{id:"audience.segments.fields.defaultTtl",defaultMessage:"Default Ttl"},datamart_id:{id:"audience.segments.fields.datamartId",defaultMessage:"Datamart Id"},provider_name:{id:"audience.segments.fields.providerName",defaultMessage:"Provider Name"},persisted:{id:"audience.segments.fields.persisted",defaultMessage:"Persisted"},type:{id:"audience.segments.fields.type",defaultMessage:"Type"},user_points_count:{id:"audience.segments.fields.userPointsCount",defaultMessage:"User Points Count"},user_accounts_count:{id:"audience.segments.fields.userAccountsCount",defaultMessage:"User Accounts Count"},emails_count:{id:"audience.segments.fields.emailsCount",defaultMessage:"Emails Count"},desktop_cookie_ids_count:{id:"audience.segments.fields.desktopCookieIdsCount",defaultMessage:"Desktop Cookie Ids Count"},mobile_cookie_ids_count:{id:"audience.segments.fields.mobileCookieIdsCount",defaultMessage:"Mobile Cookie Ids Count"},mobile_ad_ids_count:{id:"audience.segments.fields.mobileAdIdsCount",defaultMessage:"Mobile Ad Ids Count"},creation_ts:{id:"audience.segments.fields.creationTs",defaultMessage:"Creation Timestamp"},last_modified_ts:{id:"audience.segments.fields.lastModifiedTs",defaultMessage:"Last Modified Timestamp"},history_title:{id:"audience.segments.resourceHistory.title",defaultMessage:"Audience Segment History"},history_resource_type:{id:"audience.segments.resourceHistory.type",defaultMessage:"Audience Segment"},paused:{id:"audience.segments.fields.paused",defaultMessage:"Paused"}})),s={id:{format:"STRING"},organisation_id:{format:"STRING"},name:{format:"STRING"},short_description:{format:"STRING"},technical_name:{format:"STRING"},default_ttl:{format:"TIMESTAMP"},datamart_id:{format:"STRING"},provider_name:{format:"STRING"},persisted:{format:"STRING"},type:{format:"MESSAGE",messageMap:o},user_points_count:{format:"INTEGER"},user_accounts_count:{format:"INTEGER"},emails_count:{format:"INTEGER"},desktop_cookie_ids_count:{format:"INTEGER"},mobile_cookie_ids_count:{format:"INTEGER"},mobile_ad_ids_count:{format:"INTEGER"},creation_ts:{format:"TIMESTAMP"},last_modified_ts:{format:"TIMESTAMP"},history_title:{format:"STRING"},history_resource_type:{format:"STRING"},paused:{format:"STRING"}};t.formatAudienceSegmentProperty=function(e,t){return{message:i[e],formattedValue:t&&s[e]?(0,r.formatToFormattingFunction)(t,s[e].format,s[e].messageMap):void 0}}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return e.features.organisation};t.getOrgFeatures=a,t.hasFeature=function(e){return function(t){return a(e).includes(t)}},t.getFeatureFlagClient=function(e){return e.features.client}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasWhereClause=t.extractOtqlWhereClause=t.formatQuery=t.getFormattedQuery=t.getFormattedExperimentationQuery=void 0;var a=n(228),r=(t.getFormattedExperimentationQuery=function(e,t,n,a,o){var i=a.reduce((function(e,t,n){var r=n!==a.length-1?"OR ":"";return e.concat('segments { id = "'+t.id+'"} '+r)}),""),s=function(e){return(o?"":"NOT ")+"("+e+")"};return n.getQuery(e,t).then((function(t){var a=t.data;switch(a.query_language){case"OTQL":return Promise.resolve(r(a,s(i)));case"JSON_OTQL":return n.convertJsonOtql2Otql(e,a).then((function(e){return e.data})).then((function(e){return Promise.resolve(r(e,s(i)))}));default:return a}}))},t.getFormattedQuery=function(e,t,n,i){if((0,a.isAudienceSegmentShape)(i))return(0,a.isUserQuerySegment)(i)&&i.query_id?t.getQuery(e,i.query_id).then((function(e){return e.data})).then((function(a){switch(a.query_language){case"OTQL":return Promise.resolve(r(n,o(a.query_text)));case"JSON_OTQL":return t.convertJsonOtql2Otql(e,a).then((function(e){return e.data})).then((function(e){return Promise.resolve(r(n,o(e.query_text)))}));default:return n}})):Promise.resolve(r(n,'segments { id = "'+i.id+'"}'));if(function(e){return void 0!==e&&void 0!==e.language_version}(i)&&"JSON_OTQL"===i.language_version){var s={datamart_id:e,query_language:"JSON_OTQL",query_text:JSON.stringify(i)};return t.convertJsonOtql2Otql(e,s).then((function(e){return e.data})).then((function(e){return Promise.resolve(r(n,o(e.query_text)))}))}return Promise.resolve(n)},t.formatQuery=function(e,t){return Object.assign(Object.assign({},e),{query_language:"OTQL",query_text:" "!==t?i(e.query_text)?e.query_text+" AND "+t:e.query_text+" WHERE "+t:e.query_text})}),o=t.extractOtqlWhereClause=function(e){var t=e.toLowerCase(),n=t.indexOf("where");return e.substr(n+5,t.length)},i=t.hasWhereClause=function(e){return e.toLowerCase().indexOf("where")>-1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=n(6),r=t.messages=(0,a.defineMessages)({datamartReplication:{id:"settings.datamart.datamartReplication.title",defaultMessage:"Replication"},datamartReplications:{id:"settings.datamart.datamartReplication.list.title",defaultMessage:"Replications"},searchPlaceholder:{id:"settings.datamart.datamartReplication.search.placeholder",defaultMessage:"Search Replications"},datamartReplicationName:{id:"settings.datamart.datamartReplication.list.column.name",defaultMessage:"Name"},datamartReplicationType:{id:"settings.datamart.datamartReplication.list.column.type",defaultMessage:"Type"},datamartReplicationProperties:{id:"settings.datamart.datamartReplication.list.column.properties",defaultMessage:"Properties"},newDatamartReplication:{id:"settings.datamart.datamartReplication.newDatamartButton",defaultMessage:"New Replication"},editDatamartReplication:{id:"settings.datamart.datamartReplication.list.editButton",defaultMessage:"Edit"},deleteDatamartReplication:{id:"settings.datamart.datamartReplication.list.deleteButton",defaultMessage:"Delete"},datamartReplicationStatus:{id:"settings.datamart.datamartReplication.list.column.status",defaultMessage:"Status"},deleteDatamartReplicationModalTitle:{id:"settings.datamart.datamartReplication.list.deleteModalTitle",defaultMessage:"Are you sure you want to delete this Replication ?"},deleteDatamartReplicationModalContent:{id:"settings.datamart.datamartReplication.list.deleteModalContent",defaultMessage:"By deleting this Replication, you will not be able to retrieve it. Are you sure ?"},deleteDatamartReplicationModalCancel:{id:"settings.datamart.datamartReplication.list.cancelModalButton",defaultMessage:"Cancel"},emptyDatamartReplicationList:{id:"settings.datamart.datamartReplication.emptyList",defaultMessage:"There is no Replication set up. Click on 'New Datamart Replication' to create one."},emptyInitialSynchronizationList:{id:"settings.datamart.datamartReplication.dashboard.emptyExecutionList",defaultMessage:"There is no Initial Synchronization set up. Click on 'New Execution' to launch one."},emptyJobExecution:{id:"settings.datamart.datamartReplicationJob.emptyList",defaultMessage:"There are no Replication Jobs. Click on 'New Execution' to run one."},sectionGeneralSubTitle:{id:"settings.datamart.datamartReplication.edit.generalSection.subTitle",defaultMessage:"Give your Replication a name"},sectionGeneralTitle:{id:"settings.datamart.datamartReplication.edit.generalSection.title",defaultMessage:"General Information"},sectionActivationSubTitle:{id:"settings.datamart.datamartReplication.edit.activationSection.subTitle",defaultMessage:"Choose to activate your Replication after creation"},sectionActivationTitle:{id:"settings.datamart.datamartReplication.edit.activationSection.title",defaultMessage:"Activation"},saveDatamartReplication:{id:"settings.datamart.datamartReplication.edit.saveReplication",defaultMessage:"Save Replication"},datamartReplicationTypeSelectionTitle:{id:"settings.datamart.datamartReplication.edit.typeSelection.title",defaultMessage:"Replication Type"},datamartReplicationTypeSelectionSubtitle:{id:"settings.datamart.datamartReplication.edit.typeSelection.subtitle",defaultMessage:"Choose your Replication type."},datamartReplicationNamePlaceHolder:{id:"settings.datamart.datamartReplication.edit.name.placeholder",defaultMessage:"Replication Name"},datamartReplicationNameTooltip:{id:"settings.datamart.datamartReplication.edit.name.tootltip",defaultMessage:"Give your Replication a name"},datamartReplicationNameLabel:{id:"settings.datamart.datamartReplication.edit.name.label",defaultMessage:"Name"},datamartReplicationPubSubCredentialsUriPlaceHolder:{id:"settings.datamart.datamartReplication.pubsub.edit.credentialsUri.placeholder",defaultMessage:"Replication Credentials URI"},datamartReplicationPubSubCredentialsUriTooltip:{id:"settings.datamart.datamartReplication.pubsub.edit.credentialsUri.tootltip",defaultMessage:"Give your Replication your Credentials"},datamartReplicationPubSubCredentialsUriLabel:{id:"settings.datamart.datamartReplication.pubsub.edit.credentialsUri.label",defaultMessage:"Credentials URI"},datamartReplicationPubSubCredentialsUriError:{id:"settings.datamart.datamartReplication.pubsub.edit.credentialsUri.error",defaultMessage:"Credentials must be defined"},datamartReplicationPubSubProjectIdPlaceholder:{id:"settings.datamart.datamartReplication.pubsub.edit.projectId.placeholder",defaultMessage:"Replication Project ID"},datamartReplicationPubSubProjectIdTooltip:{id:"settings.datamart.datamartReplication.pubsub.edit.projectId.tootltip",defaultMessage:"Give your Replication a project ID"},datamartReplicationPubSubProjectIdLabel:{id:"settings.datamart.datamartReplication.pubsub.edit.projectId.label",defaultMessage:"Project ID"},datamartReplicationPubSubTopicIdPlaceHolder:{id:"settings.datamart.datamartReplication.pubsub.edit.topicId.placeholder",defaultMessage:"Replication Topic ID"},datamartReplicationPubSubTopicIdTooltip:{id:"settings.datamart.datamartReplication.pubsub.edit.topicId.tootltip",defaultMessage:"Give your Replication a topic ID"},datamartReplicationPubSubTopicIdLabel:{id:"settings.datamart.datamartReplication.pubsub.edit.topic.label",defaultMessage:"Topic ID"},datamartReplicationEventHubsConnectionStringUriPlaceHolder:{id:"settings.datamart.datamartReplication.eventHubs.edit.connectionStringUri.placeholder",defaultMessage:"Replication Connection String URI"},datamartReplicationEventHubsConnectionStringUriTooltip:{id:"settings.datamart.datamartReplication.eventHubs.edit.connectionStringUri.tootltip",defaultMessage:"Give your Replication a Connection String"},datamartReplicationEventHubsConnectionStringUriLabel:{id:"settings.datamart.datamartReplication.eventHubs.edit.connectionStringUri.label",defaultMessage:"Connection String URI"},datamartReplicationEventHubsConnectionStringUriError:{id:"settings.datamart.datamartReplication.eventHubs.edit.connectionStringUri.error",defaultMessage:"Connection String URI must be defined"},datamartReplicationEventHubNamePlaceholder:{id:"settings.datamart.datamartReplication.eventHubs.edit.eventHubName.placeholder",defaultMessage:"Replication Event Hub Name"},datamartReplicationEventHubNameTooltip:{id:"settings.datamart.datamartReplication.eventHubs.edit.eventHubName.tootltip",defaultMessage:"Give your Replication an Event Hub Name"},datamartReplicationEventHubNameLabel:{id:"settings.datamart.datamartReplication.eventHubs.edit.eventHubName.label",defaultMessage:"Event Hub Name"},savingInProgress:{id:"settings.datamart.datamartReplication.edit.savingInProgess",defaultMessage:"Saving in progress"},sectionCustomSubtitle:{id:"settings.datamart.datamartReplication.edit.customSection.subTitle",defaultMessage:"Give your Replication specific properties"},sectionCustomTitle:{id:"settings.datamart.datamartReplication.edit.customSection.title",defaultMessage:"Specific Information"},seeReplicationProperties:{id:"settings.datamart.datamartReplication.list.column.seeProperties",defaultMessage:"See replication properties"},replicationProperties:{id:"settings.datamart.datamartReplication.list.modalPropertiesTitle",defaultMessage:"All replication properties"},archiveReplicationModalTitle:{id:"settings.datamart.datamartReplication.dashboard.archiveModalTitle",defaultMessage:"Are you sure you want to delete this Replication ?"},archiveReplicationModalContent:{id:"settings.datamart.datamartReplication.dashboard.archiveModalContent",defaultMessage:"By deleting this Replication you won't be able to retrieve it. Are you sure ?"},archiveReplicationModalOk:{id:"settings.datamart.datamartReplication.dashboard.archiveModalOk",defaultMessage:"Delete"},cancelAction:{id:"settings.datamart.datamartReplication.dashboard.archiveModalCancel",defaultMessage:"Cancel"},newExecution:{id:"settings.datamart.datamartReplication.dashboard.newExecutionButton",defaultMessage:"New Execution"},initialSynchronization:{id:"settings.datamart.datamartReplication.dashboard.jobExecutionsTitle",defaultMessage:"Initial Synchronization"},jobIsRunning:{id:"settings.datamart.datamartReplication.dashboard.jobIsRunning",defaultMessage:"Job is running"},executionId:{id:"settings.datamart.datamartReplication.dashboard.executionId",defaultMessage:"Id"},executionStatus:{id:"settings.datamart.datamartReplication.dashboard.executionStatus",defaultMessage:"Status"},executionProgress:{id:"settings.datamart.datamartReplication.dashboard.executionProgress",defaultMessage:"Progress"},executionStartDate:{id:"settings.datamart.datamartReplication.dashboard.executionStartDate",defaultMessage:"Start Date"},executionCreationDate:{id:"settings.datamart.datamartReplication.dashboard.executionCreationDate",defaultMessage:"Creation Date"},executionEndDate:{id:"settings.datamart.datamartReplication.dashboard.executionEndDate",defaultMessage:"End Date"},executionNotStarted:{id:"settings.datamart.datamartReplication.dashboard.executionNotStarted",defaultMessage:"Not started"},executionNotCreated:{id:"settings.datamart.datamartReplication.dashboard.executionNotCreated",defaultMessage:"Not created"},executionNotEnded:{id:"settings.datamart.datamartReplication.dashboard.executionNotEnded",defaultMessage:"Not ended"},noExecutionModalTitle:{id:"settings.datamart.datamartReplication.dashboard.executionModal.title.no",defaultMessage:"You don't have any ACTIVE Replication (Replication with status 'ACTIVE')"},noExecutionModalContent:{id:"settings.datamart.datamartReplication.dashboard.executionModal.content.no",defaultMessage:"You can't execute an Initial Synchronization."},executionModalTitle:{id:"settings.datamart.datamartReplication.dashboard.executionModal.title",defaultMessage:"You are about to execute an Initial Synchronization. This operation will replicate every current data from your datamart to your external solution for the following Replication(s):"},executionModalContent:{id:"settings.datamart.datamartReplication.dashboard.executionModal.content",defaultMessage:"When Initial Synchronization is running, you can’t change status of any of your replications until synchronization is completed. You can execute an Initial Synchronization once a week. Would you like to execute an Initial Synchronization now ?"},noExecutionPossible:{id:"settings.datamart.datamartReplication.dashboard.noExecutionPossible",defaultMessage:"You can't execute Initial Synchronization more than once a week."}});t.default=r},,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(0,n(6).defineMessages)({sites:{id:"settings.tab.title.sites",defaultMessage:"Sites"},mobileApplications:{id:"settings.tab.title.mobile_applications",defaultMessage:"Mobile Applications"},compartments:{id:"settings.tab.title.compartments",defaultMessage:"Compartments"},datamarts:{id:"settings.tab.title.datamarts",defaultMessage:"Datamarts"},labels:{id:"settings.tab.title.labels",defaultMessage:"Labels"},myServiceOffersTitle:{id:"settings.serviceOffers.title",defaultMessage:"My Service Offers"},myServiceOffersAddNew:{id:"settings.serviceOffers.add.new",defaultMessage:"Add new offer"},myServiceCatalogTitle:{id:"settings.serviceCatalog.title",defaultMessage:"My Service Catalog"},name:{id:"settings.serviceCatalog.offers.list.column.name",defaultMessage:"Name"},creditedAccount:{id:"settings.serviceCatalog.offers.list.column.credited.account",defaultMessage:"Credited Account"},providerName:{id:"settings.serviceCatalog.offers.list.column.provider.name",defaultMessage:"Provider Name"},empty:{id:"settings.serviceCatalog.offers.empty.list",defaultMessage:"You have not subscribed to service offers."},offerCreationBreadCrumb:{id:"settings.serviceOffers.create.offer.breadcumb.label",defaultMessage:"New offer"},offerTypePickerTitle:{id:"settings.serviceOffers.create.offer.typePicker.title",defaultMessage:"Offer Type"},offerTypePickerSubTitle:{id:"settings.my.service.create.offer.typePicker.subtitle",defaultMessage:"Choose your offer type"},automaticOfferType:{id:"offer.type.automatic",defaultMessage:"Automatic"},manualOfferType:{id:"offer.type.manual",defaultMessage:"Manual"},offerTypeOr:{id:"offer.type.or",defaultMessage:"Or"},saveOffer:{id:"offer.save",defaultMessage:"Save"},generalInformation:{id:"offer.generalInformation",defaultMessage:"General Information"},automaticOn:{id:"offer.automaticOn",defaultMessage:"Automatic on"},sectionNewOfferSubtitle:{id:"offer.new.section.general.subtitle",defaultMessage:"Give your offer a name"},sectionNewOfferTitle:{id:"offer.new.section.general.title",defaultMessage:"General Information"},sectionNewOfferNameLabel:{id:"offer.new.section.general.name.label",defaultMessage:"Name"},sectionNewOfferNamePlaceholder:{id:"offer.new.section.general.name.placeholder",defaultMessage:"Name"},sectionServiceTypeTitle:{id:"offer.new.section.service_type.title",defaultMessage:"Service type"},sectionServiceTypeSubtitle:{id:"offer.new.section.service_type.subtitle",defaultMessage:"Select the type of service you want to include in your offer."},sectionNewOfferAutomaticOnLabel:{id:"offer.new.section.service_type.automatic_on.label",defaultMessage:"Automatic on"},breadcrumbTitle:{id:"offer.new.breadcrumbTitle",defaultMessage:"My Offers"},newOffer:{id:"offer.new",defaultMessage:"New Offer"},serviceItemsSection:{id:"offer.serviceItems",defaultMessage:"Service items"},audience_segmentType:{id:"audience_segmentType",defaultMessage:"Audience Segment"},inventory_access_deal_listType:{id:"inventory_access_deal_listType",defaultMessage:"Deal List"},user_account_compartmentType:{id:"user_account_compartmentType",defaultMessage:"User Account Compartment"},offerFormTypeSelection:{id:"offerForm.siderMenu.TypeSelection",defaultMessage:"Offer Type"},processingActivities:{id:"settings.tab.title.processingsActivities",defaultMessage:"Processing Activities"}});t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getValidObjectType=t.getDatamartPredefinedEventNames=t.predefinedEventNames=t.getEventsNames=t.getValidFieldsForWizardReactToEvent=t.getValidObjectTypesForWizardReactToEvent=t.wizardValidObjectTypes=t.buildAutomationTreeData=t.storylineEdgeData=t.edge12=t.storylineNodeData=t.node4=t.beginNode=t.storylineResourceData=t.UpdateNodeOperation=t.DeleteNodeOperation=t.AddNodeOperation=t.cleanLastAdded=t.findLastAddedNode=t.DropNode=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t.generateNodeProperties=function(e,t){var n,a,o;switch(e.type){case"DISPLAY_CAMPAIGN":return{title:e.formData.campaign.name?e.formData.campaign.name:t(M.displayCampaignNodeTitle),subtitle:t(M.displayCampaignNodeSubtitle),iconType:"display",color:"#0ba6e1"};case"EMAIL_CAMPAIGN":return{title:e.formData.campaign.name?e.formData.campaign.name:t(M.emailCampaignNodeTitle),subtitle:"",iconType:"email",color:"#0ba6e1"};case"ADD_TO_SEGMENT_NODE":return{title:e.formData.audienceSegmentName?e.formData.audienceSegmentName:t(M.addToSegmentNodeTitle),subtitle:"",iconType:"user-list",color:"#0ba6e1"};case"DELETE_FROM_SEGMENT_NODE":return{title:e.formData.audienceSegmentName?e.formData.audienceSegmentName:t(M.deleteFromSegmentNodeTitle),subtitle:"",iconType:"user-list",color:"#fc3f48"};case"QUERY_INPUT":var i="";return i="PERIODIC"===e.evaluation_mode?t(M.periodicQueryInputNodeSubtitle,{frequency:e.evaluation_period?e.evaluation_period:"",timeUnit:e.evaluation_period_unit?e.evaluation_period_unit:""}):t(M.livequeryInputNodeSubtitle),{title:t(M.queryInputNodeTitle),subtitle:i,iconAnt:r.createElement(u.FlagOutlined,{className:"available-node-icon-gyph"}),color:"#fbc02d"};case"ON_SEGMENT_ENTRY_INPUT_NODE":return{title:t(M.onAudienceSegmentEntryNodeTitle),subtitle:t(M.onAudienceSegmentEntryNodeSubtitle),iconAnt:r.createElement(u.FlagOutlined,{className:"available-node-icon-gyph"}),color:"#fbc02d"};case"ON_SEGMENT_EXIT_INPUT_NODE":return{title:t(M.onAudienceSegmentExitNodeTitle),subtitle:t(M.onAudienceSegmentExitNodeSubtitle),iconAnt:r.createElement(u.FlagOutlined,{className:"available-node-icon-gyph"}),color:"#fbc02d"};case"ABN_NODE":return{title:t(M.abnNodeTitle),subtitle:"",iconAnt:r.createElement(u.ForkOutlined,{className:"available-node-icon-gyph"}),color:"#fbc02d",branchNumber:e.branch_number};case"IF_NODE":return{title:t(M.ifNodeTitle),subtitle:"",iconAnt:r.createElement(u.BranchesOutlined,{className:"available-node-icon-gyph"}),color:"#fbc02d"};case"END_NODE":return{title:t(M.endNodeTitle),subtitle:"",iconType:"check",color:"#18b577"};case"WAIT_NODE":return{title:t(M.waitNodeTitle),subtitle:"",iconAnt:r.createElement(u.ClockCircleOutlined,{className:"available-node-icon-gyph"}),color:"#fbc02d"};case"CUSTOM_ACTION_NODE":return{title:t(M.customActionNodeTitle),subtitle:"",iconType:"bolt",color:"#0ba6e1"};case"SCENARIO_AUDIENCE_SEGMENT_FEED_NODE":return{title:(null===(n=e.strictlyLayoutablePlugin)||void 0===n?void 0:n.name)||(null===(a=e.strictlyLayoutablePlugin)||void 0===a?void 0:a.plugin_layout.metadata.display_name)||"",subtitle:"",color:"#ffffff",iconAssetUrl:null===(o=e.strictlyLayoutablePlugin)||void 0===o?void 0:o.plugin_layout.metadata.small_icon_asset_url};default:return{title:"Node",subtitle:"",iconType:"info",color:"#fbc02d"}}},t.buildStorylineNodeModel=_;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(113),i=n(160),s=n(138),l=n(112),c=n(6),u=n(41);function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.DropNode=function e(t,n,a){d(this,e),this.id=t,this.parentNode=a,this.outNode=n},t.findLastAddedNode=function(e){if(e.out_edges.length>0){return function e(t){return 0===t.out_edges.length?void 0:(0,o.isScenarioNodeShape)(t.node)&&t.node.last_added_node?t:t.out_edges.reduce((function(t,n){return t&&(0,o.isScenarioNodeShape)(t.node)&&t.node.last_added_node?t:e(n)}),void 0)}(e)}return(0,o.isScenarioNodeShape)(e.node)&&e.node.last_added_node?e:void 0};var f=t.cleanLastAdded=function e(t){var n=t.out_edges.map((function(t){return 0===t.out_edges.length?t:(0,o.isScenarioNodeShape)(t.node)?e(Object.assign(Object.assign({},t),{node:Object.assign(Object.assign({},t.node),{last_added_node:!1})})):e(t)}));return{node:(0,o.isScenarioNodeShape)(t.node)?Object.assign(Object.assign({},t.node),{last_added_node:!1}):t.node,in_edge:t.in_edge,out_edges:n}},p=(t.AddNodeOperation=function(){function e(t,n,a){var r=this;d(this,e),this.generateNewEmptyOutEdges=function(e,t){for(var n=(0,i.generateFakeId)(),a=[],o=2;o<=t;o++){var s={node:{id:n,scenario_id:"",type:"END_NODE"},in_edge:{id:(0,i.generateFakeId)(),source_id:r.node.id,target_id:n,handler:"OUT",scenario_id:e.in_edge.scenario_id},out_edges:[]};a.push(s)}return a},this.childNodeId=n,this.parentNodeId=t,this.node=a}return a(e,[{key:"execute",value:function(e){return this.iterateData(f(e),this.parentNodeId,this.childNodeId)}},{key:"iterateData",value:function(e,t,n){var a=this,r=e.out_edges.map((function(e,r){if(e.node.id===n){var s=(0,i.generateFakeId)(),l={node:e.node,in_edge:{id:s,source_id:a.node.id,target_id:e.node.id,handler:"OUT",scenario_id:e.in_edge.scenario_id},out_edges:e.out_edges},c=[];if((0,o.isAbnNode)(a.node)){var u=a.generateNewEmptyOutEdges(e,a.node.formData?a.node.formData.branch_number:2);c=[l].concat(u)}else if((0,o.isIfNode)(a.node)){var d=a.generateNewEmptyOutEdges(e,2),f=(c=[l].concat(d))[0],p=c[1];void 0!==f.in_edge&&(f.in_edge.handler="IF_CONDITION_TRUE"),void 0!==p.in_edge&&(p.in_edge.handler="IF_CONDITION_FALSE")}else c=[l];return{node:Object.assign(Object.assign({},a.node),{last_added_node:!0}),in_edge:{id:(0,i.generateFakeId)(),source_id:t,target_id:a.node.id,handler:a.getInEdgeHandler(e),scenario_id:""},out_edges:c}}return a.iterateData(e,t,n)}));return{node:e.node,in_edge:e.in_edge,out_edges:r}}},{key:"getInEdgeHandler",value:function(e){return void 0===e.in_edge||"IF_CONDITION_TRUE"!==e.in_edge.handler&&"IF_CONDITION_FALSE"!==e.in_edge.handler?"DISPLAY_CAMPAIGN"===this.node.type?"ON_VISIT":"OUT":e.in_edge.handler}}]),e}(),t.DeleteNodeOperation=function(){function e(t){d(this,e),this.idNodeToBeDeleted=t}return a(e,[{key:"execute",value:function(e){return f(this.iterateData(this.removeSegmentFromDeletedAddToSegmentNode(this.idNodeToBeDeleted,e),this.idNodeToBeDeleted))}},{key:"iterateData",value:function(e,t,n){var a=this,r=e.out_edges.map((function(n,r){if(n.node.id===t&&((0,o.isAbnNode)(n.node)||(0,o.isIfNode)(n.node)))return{node:{id:n.node.id,scenario_id:"",type:"END_NODE"},in_edge:n.in_edge,out_edges:[]};if(n.node.id!==t||(0,o.isAbnNode)(n.node)||(0,o.isIfNode)(n.node))return a.iterateData(n,t,e);var i=n.in_edge;return{node:n.out_edges[0].node,in_edge:i?Object.assign(Object.assign({},i),{source_id:e.node.id,target_id:i.target_id}):void 0,out_edges:n.out_edges[0].out_edges}}));return{node:e.node,in_edge:e.in_edge,out_edges:r}}},{key:"removeSegmentFromDeletedAddToSegmentNode",value:function(e,t){return Object.assign(Object.assign({},t),{out_edges:function e(t,n,a){return n.map((function(n){var r=n.node;return r.id===t&&(0,o.isAddToSegmentNode)(r)?Object.assign(Object.assign({},n),{out_edges:e(t,n.out_edges,r.formData.audienceSegmentId)}):a&&(0,o.isDeleteFromSegmentNode)(r)&&r.formData.segmentId===a?Object.assign(Object.assign({},n),{node:Object.assign(Object.assign({},r),{formData:Object.assign(Object.assign({},r.formData),{segmentId:void 0})}),out_edges:e(t,n.out_edges,a)}):Object.assign(Object.assign({},n),{out_edges:e(t,n.out_edges,a)})}))}(e,t.out_edges)})}}]),e}(),t.UpdateNodeOperation=function(){function e(t,n,a){var r=this;d(this,e),this.generateOutEdges=function(e){var t=[];if((0,o.isAbnNode)(r.node)){var n=r.formData.branch_number,a=n-(r.node.formData?r.node.formData.branch_number:2);if(a>0){var i=r.generateNewEmptyOutEdges(a,e);t=e.out_edges.concat(i)}else if(0===a)t=e.out_edges;else{t=e.out_edges.slice(0,n)}}else t=e.out_edges;return t},this.generateNewEmptyOutEdges=function(e,t){for(var n=[],a=1;a<=e;a++){var o=(0,i.generateFakeId)(),s={node:{id:o,scenario_id:"",type:"END_NODE"},in_edge:{id:(0,i.generateFakeId)(),source_id:r.node.id,target_id:o,handler:"OUT",scenario_id:t.in_edge.scenario_id},out_edges:[]};n.push(s)}return n},this.node=t,this.formData=n,this.initialFormData=a}return a(e,[{key:"execute",value:function(e){return f(this.iterateData(e,this.node.id,!0))}},{key:"buildUpdatedNode",value:function(e){var t=void 0;switch(e.node.type){case"DISPLAY_CAMPAIGN":case"EMAIL_CAMPAIGN":t=Object.assign(Object.assign(Object.assign({},e.node),this.node),{formData:this.formData,initialFormData:this.initialFormData});break;case"ADD_TO_SEGMENT_NODE":var n=this.formData,a=n.audienceSegmentId?n.audienceSegmentId:(0,i.generateFakeId)(),r=Object.assign(Object.assign({},n),{audienceSegmentId:a});t=Object.assign(Object.assign(Object.assign({},e.node),this.node),{formData:r,initialFormData:this.initialFormData});break;case"DELETE_FROM_SEGMENT_NODE":var o=this.formData;t=Object.assign(Object.assign(Object.assign({},e.node),this.node),{formData:o,initialFormData:this.initialFormData});break;case"ABN_NODE":t=Object.assign(Object.assign(Object.assign({},e.node),this.node),{branch_number:this.formData.branch_number,edges_selection:this.formData.edges_selection,formData:this.formData});break;case"ON_SEGMENT_EXIT_INPUT_NODE":case"ON_SEGMENT_ENTRY_INPUT_NODE":t=Object.assign(Object.assign(Object.assign({},e.node),this.node),{formData:this.formData,initialFormData:this.initialFormData});break;case"QUERY_INPUT":case"IF_NODE":case"WAIT_NODE":case"CUSTOM_ACTION_NODE":case"SCENARIO_AUDIENCE_SEGMENT_FEED_NODE":t=Object.assign(Object.assign(Object.assign({},e.node),this.node),{formData:this.formData});break;default:t=Object.assign({},e.node)}return{node:t,in_edge:e.in_edge,out_edges:this.generateOutEdges(e)}}},{key:"iterateData",value:function(e,t,n){var a=this,r=e;n&&e.node.id===t&&(r=this.buildUpdatedNode(e));var o=e.out_edges.map((function(e,n){if(e.node.id===t){var r=a.buildUpdatedNode(e);return Object.assign(Object.assign({},r),{out_edges:a.generateOutEdges(e)})}return a.iterateData(e,t)}));return Object.assign(Object.assign({},r),{out_edges:o})}}]),e}(),(0,i.generateFakeId)()),m=(0,i.generateFakeId)(),g=(0,i.generateFakeId)(),y=(0,i.generateFakeId)(),h=(t.storylineResourceData={begin_node_id:p},t.beginNode=function(e){return"ON_SEGMENT_ENTRY"===e||"ON_SEGMENT_EXIT"===e?"ON_SEGMENT_ENTRY"===e?{id:p,type:"ON_SEGMENT_ENTRY_INPUT_NODE",scenario_id:"string",last_added_node:!0,audience_segment_id:"",formData:{},initialFormData:{}}:{id:p,type:"ON_SEGMENT_EXIT_INPUT_NODE",scenario_id:"string",last_added_node:!0,audience_segment_id:"",formData:{},initialFormData:{}}:{id:p,scenario_id:"",type:"QUERY_INPUT",query_id:y,evaluation_mode:"LIVE",ui_creation_mode:"REACT_TO_EVENT"===e?"REACT_TO_EVENT_STANDARD":"QUERY",last_added_node:!0,formData:{uiCreationMode:"REACT_TO_EVENT"===e?"REACT_TO_EVENT_STANDARD":"QUERY"}}}),v=t.node4={id:m,scenario_id:"",type:"END_NODE"},b=(t.storylineNodeData=[h(),v],t.edge12={id:g,source_id:p,target_id:m,handler:"OUT",scenario_id:""});t.storylineEdgeData=[b];t.buildAutomationTreeData=function(e,t,n,a,r){var o=t.filter((function(t){return t.id===e.begin_node_id}))[0],i=n.filter((function(e){return o&&e.source_id===o.id})).map((function(e){return e.target_id})),s=t.filter((function(e){return i.includes(e.id)}));return o&&"QUERY_INPUT"===o.type&&o.query_id&&r&&a?a.getQuery(r,o.query_id).then((function(e){return{node:Object.assign(Object.assign({},o),{formData:Object.assign(Object.assign({},e.data),{uiCreationMode:"REACT_TO_EVENT_STANDARD"===o.ui_creation_mode||"REACT_TO_EVENT_ADVANCED"===o.ui_creation_mode?o.ui_creation_mode:"REACT_TO_EVENT_STANDARD"})}),out_edges:s.map((function(e){return _(e,t,n,o)}))}})):Promise.resolve({node:o,out_edges:s.map((function(e){return _(e,t,n,o)}))})};function _(e,t,n,a){var r=n.filter((function(t){return t.source_id===e.id})).map((function(e){return e.target_id})),o=t.filter((function(e){return r.includes(e.id)})),i=n.filter((function(t){return t.source_id===a.id&&t.target_id===e.id}))[0];return{node:e,in_edge:i,out_edges:o.map((function(a){return _(a,t,n,e)}))}}var S=t.wizardValidObjectTypes=[{objectTypeName:"ActivityEvent",fieldName:"nature"},{objectTypeName:"ActivityEvent",fieldName:"name"},{objectTypeName:"UserEvent",fieldName:"nature"},{objectTypeName:"UserEvent",fieldName:"name"}],E=t.getValidObjectTypesForWizardReactToEvent=function(e){return e.filter((function(e){return!!S.find((function(t){return t.objectTypeName===e.name}))}))},O=t.getValidFieldsForWizardReactToEvent=function(e,t){return t.filter((function(t){return!!S.find((function(n){return n.objectTypeName===e.name&&t.name===n.fieldName}))}))},w=(t.getEventsNames=function(e,t,n){if(!t||!t.objectTypeQueryName)return Promise.resolve([]);var a={from:"UserPoint",operations:[{selections:[{name:t.objectTypeQueryName,selections:[{name:t.fieldName,directives:[{name:"map"}]}]}]}]};return n.runJSONOTQLQuery(e,a,{use_cache:!0}).then((function(e){if((0,s.isAggregateResult)(e.data.rows))return e.data.rows[0];throw new Error("err")})).then((function(e){return e.aggregations.buckets[0]})).then((function(e){return e.buckets.map((function(e){var t=e.key;return{key:t,label:t,value:t}}))})).catch((function(){return[]}))},t.predefinedEventNames=["$home_view","$item_list_view","$item_view","$basket_view","$transaction_confirmed","$conversion","$ad_click","$ad_view","$email_click","$email_view"]),M=(t.getDatamartPredefinedEventNames=function(e,t,n){if(!t||!t.objectTypeQueryName)return Promise.resolve([]);var a="select {"+t.objectTypeQueryName+"{"+t.fieldName+"@map(limit:500)}} from UserPoint ";return n.runOTQLQuery(e,a,{use_cache:!0}).then((function(e){if((0,s.isAggregateResult)(e.data.rows))return e.data.rows[0];throw new Error("err")})).then((function(e){return e.aggregations.buckets[0]})).then((function(e){return e.buckets.map((function(e){return e.key})).filter((function(e){return w.includes(e)}))})).catch((function(){return[]}))},t.getValidObjectType=function(e,t){return t.getRuntimeSchemas(e).then((function(n){var a=n.data.find((function(e){return"LIVE"===e.status}));if(a)return t.getObjectTypes(e,a.id).then((function(n){var r=n.data;return(0,l.reducePromises)(E(r).map((function(n){return t.getFields(e,a.id,n.id).then((function(e){var t=e.data;return{objectType:n,validFields:O(n,t)}}))}))).then((function(n){var o=S.find((function(e){return!!n.find((function(t){return t.objectType.name===e.objectTypeName&&!!t.validFields.find((function(t){return t.name===e.fieldName}))}))}));if(o){var i=r.find((function(e){return"UserPoint"===e.name}));return i?t.getFields(e,a.id,i.id).then((function(e){var t=e.data.find((function(e){return e.field_type.match(/\w+/)[0]===o.objectTypeName}));if(t)return Object.assign(Object.assign({},o),{objectTypeQueryName:t?t.name:void 0})})):void 0}}))}))}))},(0,c.defineMessages)({queryInputNodeTitle:{id:"automation.builder.node.queryInput.title",defaultMessage:"Start Automation"},livequeryInputNodeSubtitle:{id:"automation.builder.node.queryInput.live.subtitle",defaultMessage:"React to an event"},periodicQueryInputNodeSubtitle:{id:"automation.builder.node.queryInput.periodic.title",defaultMessage:"Evaluated every {frequency} {timeUnit}"},onAudienceSegmentEntryNodeTitle:{id:"automation.builder.node.onAudienceSegmentEntry.title",defaultMessage:"Start Automation"},onAudienceSegmentEntryNodeSubtitle:{id:"automation.builder.node.onAudienceSegmentEntry.subtitle",defaultMessage:"On audience segment entry"},onAudienceSegmentExitNodeTitle:{id:"automation.builder.node.onAudienceSegmentExit.title",defaultMessage:"Start Automation"},onAudienceSegmentExitNodeSubtitle:{id:"automation.builder.node.onAudienceSegmentExit.subtitle",defaultMessage:"On audience segment exit"},displayCampaignNodeTitle:{id:"automation.builder.node.displayCampaign.title",defaultMessage:"Display Advertising"},displayCampaignNodeSubtitle:{id:"automation.builder.node.displayCampaign.subtitle",defaultMessage:"Exit on visit"},emailCampaignNodeTitle:{id:"automation.builder.node.emailCampaign.title",defaultMessage:"Send Email"},addToSegmentNodeTitle:{id:"automation.builder.node.addToSegment.title",defaultMessage:"Add to Segment"},deleteFromSegmentNodeTitle:{id:"automation.builder.node.deleteFromSegment.title",defaultMessage:"Delete from Segment"},abnNodeTitle:{id:"automation.builder.node.abn.title",defaultMessage:"Split"},ifNodeTitle:{id:"automation.builder.node.if.title",defaultMessage:"If"},waitNodeTitle:{id:"automation.builder.node.wait.title",defaultMessage:"Wait"},endNodeTitle:{id:"automation.builder.node.end.title",defaultMessage:"End Automation"},customActionNodeTitle:{id:"automation.builder.node.customAction.title",defaultMessage:"Custom Action"}}))},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildQueryDocument=t.formatQuery=t.INITIAL_AUDIENCE_BUILDER_FORM_DATA=t.FORM_ID=t.fieldGridConfig=t.messages=void 0;var a=n(6),r=(t.messages=(0,a.defineMessages)({title:{id:"audienceBuilder.title",defaultMessage:"Audience Builders"},demographics:{id:"audienceBuilder.category.demographics",defaultMessage:"Demographics"},selectedAudience:{id:"audienceBuilder.selectedAudience",defaultMessage:"Selected Audience"},tooltipGender:{id:"audienceBuilder.category.demographics.tooltiptGender",defaultMessage:"Select the gender of your audience."},tooltipAge:{id:"audienceBuilder.category.demographics.tooltiptAge",defaultMessage:"Select the age of your audience."},tooltipLanguage:{id:"audienceBuilder.category.demographics.tooltiptLanguage",defaultMessage:"Select the language of your audience."},narrowingWith:{id:"audienceBuilder.category.narrowingWith",defaultMessage:"narrowing with"},excludingWith:{id:"audienceBuilder.category.excludingWith",defaultMessage:"excluding"},refreshMessage:{id:"audienceBuilder.liveDashboard.refreshMessage",defaultMessage:"Your query has been modified, please click here to refresh"},audienceFeatures:{id:"audienceBuilder.audienceFeature.card.title",defaultMessage:"Audience Features"},addAudienceFeature:{id:"audienceBuilder.audienceFeatureSelector.actionBarTitle",defaultMessage:"Add more audience features"},addAudienceFeatureButton:{id:"audienceBuilder.audienceFeatureSelector.addButton",defaultMessage:"Add"},noDemographicExpressions:{id:"audienceBuilder.category.demographics.noDemographicExpressions",defaultMessage:"No Demographic Expressions"},generalSectionTitle:{id:"audienceBuilder.parametricPredicateForm.generalSectionTitle",defaultMessage:"Audience Feature"},generalSectionSubtitle:{id:"audienceBuilder.parametricPredicateForm.generalSectionSubtitle",defaultMessage:"Select your audience features"},audienceFeatureId:{id:"audienceBuilder.audienceFeatureSelector.id",defaultMessage:"ID"},audienceFeatureName:{id:"audienceBuilder.audienceFeatureSelector.name",defaultMessage:"Name"},audienceFeatureDescription:{id:"audienceBuilder.audienceFeatureSelector.description",defaultMessage:"Description"},searchAudienceFeature:{id:"audienceBuilder.audienceFeatureSelector.searchPlaceholder",defaultMessage:"Search an audience feature"},audienceFeatureAdressableObject:{id:"audienceBuilder.audienceFeatureSelector.adressableObject",defaultMessage:"Adressable Object"},audienceFeatureObjectTreeExpression:{id:"audienceBuilder.audienceFeatureSelector.objectTreeExpression",defaultMessage:"Object Tree Expression"},newAudienceSegment:{id:"audienceBuilder.newSegmentName",defaultMessage:"New Audience Segment"},availableFilters:{id:"audienceBuilder.audienceFeatureSelector.availableFilters",defaultMessage:"Available Filters"}}),t.fieldGridConfig={labelCol:{span:3},wrapperCol:{span:15,offset:1}},t.FORM_ID="segmentBuilderFormData",t.INITIAL_AUDIENCE_BUILDER_FORM_DATA={where:{type:"GROUP",boolean_operator:"AND",expressions:[{type:"GROUP",boolean_operator:"OR",expressions:[]}]}},t.formatQuery=function(e){return(null==e?void 0:e.where)?Object.assign(Object.assign({},e),{where:Object.assign(Object.assign({},e.where),{expressions:e.where.expressions.map((function(e){return Object.assign(Object.assign({},e),{expressions:e.expressions.map((function(e){var t={};return Object.keys(e.parameters).forEach((function(n){var a=e.parameters[n];a&&(t[""+n]=a)})),Object.assign(Object.assign({},e),{parameters:t})}))})}))})}):e});t.buildQueryDocument=function(e){var t={language_version:"JSON_OTQL",operations:[{directives:[{name:"count"}],selections:[]}],from:"UserPoint"},n=null==e?void 0:e.where;return n&&(t=Object.assign(Object.assign({},t),{where:n})),r(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INITIAL_AUDIENCE_SEGMENT_FORM_DATA=void 0,t.isAudienceSegmentShape=function(e){return void 0!==e&&void 0!==e.type},t.isUserQuerySegment=function(e){return void 0!==e.query_id},t.isUserListSegment=function(e){return"USER_LIST"===e.type&&"STANDARD"===e.subtype},t.isUserActivationSegment=function(e){return"USER_ACTIVATION"===e.type},t.isUserPixelSegment=function(e){return"USER_LIST"===e.type&&"USER_PIXEL"!==e.subtype},t.isEdgeSegment=function(e){return"USER_LIST"===e.type&&"USER_CLIENT"!==e.subtype},t.calculateDefaultTtl=function(e){if(e.defaultLifetime&&e.defaultLifetimeUnit)return a.duration(Number(e.defaultLifetime),e.defaultLifetimeUnit).asMilliseconds();return};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(17));t.INITIAL_AUDIENCE_SEGMENT_FORM_DATA={audienceSegment:{persisted:!0},initialProcessingSelectionResources:[],processingActivities:[],defaultLifetimeUnit:"days",userListFiles:[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getComparisonDatamartUsersAnalyticsSetting=t.DATAMART_USERS_ANALYTICS_SETTING=t.SEGMENT_QUERY_SETTINGS=void 0;var a=n(30);function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.SEGMENT_QUERY_SETTINGS=[].concat(r(a.PAGINATION_SEARCH_SETTINGS),r(a.DATE_SEARCH_SETTINGS),r(a.KEYWORD_SEARCH_SETTINGS),[{paramName:"types",defaultValue:[],deserialize:function(e){return e.types?e.types.split(","):[]},serialize:function(e){return e.join(",")},isValid:function(e){return!e.types||e.types.split(",").length>0}}]),t.DATAMART_USERS_ANALYTICS_SETTING=[].concat(r(a.SEGMENTS_FILTERS_SEARCH_SETTINGS),r(a.DATE_SEARCH_SETTINGS_WITHOUT_CURRENT_DAY),r(a.ALL_USERS)),t.getComparisonDatamartUsersAnalyticsSetting=function(e){return[].concat(r(a.SEGMENTS_FILTERS_SEARCH_SETTINGS),r((0,a.getComparisonDateSearchSettings)(e)),r(a.ALL_USERS))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(888),o=(a=r)&&a.__esModule?a:{default:a};function i(){try{return localStorage.setItem("localStorageSupported","true"),localStorage.removeItem("localStorageSupported"),!0}catch(e){return!1}}function s(e){return o.default.get(e)}function l(e){return o.default.remove(e)}t.default={LANGUAGE_KEY:"language",getItem:function(e){return i()?function(e){return localStorage.getItem(e)||s(e)}(e):s(e)},setItem:function(e){return i()?function(e){Object.keys(e).forEach((function(t){localStorage.setItem(t,e[t])}))}(e):function(e){Object.keys(e).forEach((function(t){o.default.set(t,e[t])}))}(e)},removeItem:function(e){return i()?function(e){return l(e),localStorage.removeItem(e)}(e):l(e)}}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGoalResource=function(e){return void 0!==e.id},t.isAttributionSelectionResource=function(e){return void 0!==e.id},t.isAttributionModelCreateRequest=function(e){return void 0!==e.attribution_model_id&&void 0===e.id},t.isExistingGoal=function(e){return void 0!==e.id};t.INITIAL_GOAL_FORM_DATA={goal:{goal_value_currency:"EUR",status:"PAUSED",name:"",datamart_id:"",archived:!1},attributionModels:[],triggerType:"QUERY",queryLanguage:"JSON_OTQL",query:{datamart_id:"",query_language:"JSON_OTQL",query_text:""}}},,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(41),l=n(10),c=n(54),u=n(25),d=n(8),f=n(68),p=n(83),m=n(67),g=n(13),y=n(11);function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=(0,i.defineMessages)({audienceSegment:{id:"components.elementSelector.tableSelector.audienceSegment",defaultMessage:"Audience Segment"},dealList:{id:"components.elementSelector.tableSelector.dealList",defaultMessage:"Deal List"},userAccountCompartment:{id:"components.elementSelector.tableSelector.userAccountCompartment",defaultMessage:"User Account Compartment"},serviceType:{id:"components.elementSelector.tableSelector.serviceType",defaultMessage:"Service type"},addElementText:{id:"components.elementSelector.tableSelector.add",defaultMessage:"Add"}}),b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.loadSelectedElementsById=function(){var e=n.props,t=e.selectedIds,a=e.defaultSelectedKey;if(t){var r=[];t.forEach((function(e){r.push(n.props.fetchData(e).then((function(e){return e.data})))})),Promise.all(r).then((function(e){n.setState({selectedElementsById:(0,p.normalizeArrayOfObject)(e,a)})}))}},n.getColumnsDefinitions=function(){var e=n.props,t=e.columnsDefinitions,a=e.defaultSelectedKey,r=n.state.selectedElementsById;return[{key:"selected",render:function(e,t){var i=n.props.singleSelection?l.Radio:l.Checkbox,s=r[t[a].toString()];return o.createElement(i,{checked:!!s},e)}}].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t))},n.getSearchOptions=function(){var e=n.props.searchPlaceholder;return{placeholder:e||"Search a template",onSearch:function(e){return n.setState({keywords:e,currentPage:1})}}},n.getFiltersOptions=function(){var e=n.props,t=e.displayDatamartSelector,a=e.displayTypeFilter,r=e.workspace,l=e.match.params.organisationId,c=e.intl,u=[];if(r(l).datamarts.length>1&&t){var d=r(l).datamarts.map((function(e){return{key:e.id,value:e.name||e.token}})).concat([{key:"",value:"All"}]);u.push({displayElement:o.createElement("div",null,o.createElement(i.FormattedMessage,{id:"components.elementSelector.tableSelector.filterDatamart.button",defaultMessage:"Datamart"})," ",o.createElement(s.DownOutlined,null)),selectedItems:n.state.datamartId?[d.find((function(e){return e.key===n.state.datamartId}))]:[d],items:d,singleSelectOnly:!0,getKey:function(e){return e&&e.key?e.key:""},display:function(e){return e.value},handleItemClick:function(e){n.setState({datamartId:e&&e.key?e.key:""},(function(){n.populateTable(Object.keys(n.state.selectedElementsById))}))}})}return a&&u.push({displayElement:o.createElement("div",null,o.createElement(i.FormattedMessage,v.serviceType),o.createElement(s.DownOutlined,null)),selectedItems:void 0!==n.state.type?n.state.type.map((function(e){return{key:e,value:e}})):[],items:[{key:"AUDIENCE_SEGMENT",value:c.formatMessage(v.audienceSegment)},{key:"INVENTORY_ACCESS_DEAL_LIST",value:c.formatMessage(v.dealList)},{key:"USER_ACCOUNT_COMPARTMENT",value:c.formatMessage(v.userAccountCompartment)}],getKey:function(e){return e.key},display:function(e){return e.value},handleMenuClick:function(e){return n.setState({type:e.map((function(e){return e.key})),currentPage:1})}}),u},n.handleAdd=function(){var e=n.props.save,t=n.state.selectedElementsById,a=Object.keys(t),r=a.map((function(e){return t[e]}));e(a,r)},n.populateTable=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=n.props,a=t.displayFiltering,r=t.defaultSelectedKey,o=n.state,i=o.currentPage,s=o.keywords,l=o.pageSize,c=o.datamartId,u=o.type,d=a?{currentPage:i,keywords:s,pageSize:l,datamartId:c,type:u}:void 0;return n.setState({isLoading:!0}),n.props.fetchDataList(d).then((function(t){var a=t.data,o=t.total,i=a.map((function(e){return e[r].toString()})),s=(0,p.normalizeArrayOfObject)(a,r),l=Object.assign(Object.assign({},n.state.selectedElementsById),e.reduce((function(e,t){return n.state.selectedElementsById[t]?e:Object.assign(Object.assign({},e),h({},t,s[t]))}),{}));return n.setState({allElementIds:i,elementsById:s,selectedElementsById:l,isLoading:!1,total:o||a.length}),a}))},n.toggleElementSelection=function(e){var t=e[n.props.defaultSelectedKey].toString();n.setState((function(e){var a=e.selectedElementsById[t];return n.props.singleSelection?{selectedElementsById:a?{}:h({},t,e.elementsById[t])}:a?{selectedElementsById:(0,c.omit)(e.selectedElementsById,t)}:{selectedElementsById:Object.assign(Object.assign({},e.selectedElementsById),h({},t,e.elementsById[t]))}}))},n.state={selectedElementsById:{},elementsById:{},allElementIds:[],noElement:!1,isLoading:!0,total:0,pageSize:10,currentPage:1,keywords:"",datamartId:"",type:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({isLoading:!0}),Promise.all([this.populateTable(this.props.selectedIds).then((function(t){0===t.length&&e.setState({noElement:!0})})),this.loadSelectedElementsById()]).then((function(){e.setState({isLoading:!1})}))}},{key:"componentDidUpdate",value:function(e,t){var n=this.state,a=n.currentPage,r=n.pageSize,o=n.keywords,i=n.selectedElementsById,s=n.datamartId,l=n.type,c=t.currentPage,u=t.pageSize,d=t.keywords,f=t.datamartId,p=t.type;a===c&&r===u&&o===d&&s===f&&l===p||this.populateTable(Object.keys(i))}},{key:"render",value:function(){var e=this,t=this.props,n=t.actionBarTitle,r=t.close,i=t.displayFiltering,s=t.filtersOptions,l=t.intl.formatMessage,c=this.state,u=c.elementsById,d=c.allElementIds,p=c.isLoading,m=c.currentPage,g=c.total,h=c.pageSize,b=c.noElement,_={current:m,pageSize:h,total:g,onChange:function(t){return e.setState({currentPage:t})},onShowSizeChange:function(t,n){return e.setState({currentPage:1,pageSize:n})}},S={columns:this.getColumnsDefinitions(),dataSource:d.map((function(e){return u[e]})),loading:p,onRow:function(t){return{onClick:function(){return e.toggleElementSelection(t)}}},pagination:_},E=i||void 0!==s?o.createElement(f.TableViewFilters,a({},S,{searchOptions:this.getSearchOptions(),filtersOptions:void 0!==s?s:this.getFiltersOptions()})):o.createElement(f.TableView,S);return o.createElement(y.SelectorLayout,{className:"mcs-table-edit-container",actionBarTitle:n,handleAdd:this.handleAdd,handleClose:r,disabled:b,addButtonText:l(v.addElementText),noElementText:""},E)}}]),t}(o.Component);b.defaultProps={displayFiltering:!1,selectedIds:[],singleSelection:!1,defaultSelectedKey:"id"};t.default=(0,d.compose)((0,u.connect)((function(e){return{workspace:(0,m.getWorkspace)(e)}}),void 0),g.withRouter,i.injectIntl)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=l(n(2049)),i=n(10),s=l(n(2051));function l(e){return e&&e.__esModule?e:{default:e}}var c=i.Layout.Content,u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.resourceType,n=e.resourceId,a=e.handleClose,l=e.formatProperty,u=e.resourceLinkHelper;return r.createElement("div",{className:"ant-layout edit-layout"},r.createElement(s.default,{handleClose:a,formatProperty:l}),r.createElement("div",{className:"ant-layout"},r.createElement(c,{className:"mcs-content-container p-t-40"},r.createElement(i.Row,{className:"mcs-history"},r.createElement(o.default,{resourceType:t,resourceId:n,formatProperty:l,resourceLinkHelper:u})))))}}]),t}(r.Component);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(89),i=n(819),s=(a=i)&&a.__esModule?a:{default:a};var l=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"simple"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"createLinkModel",value:function(){var e=new s.default;return e.setSourcePort(this),e}}]),t}(o.PortModel);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({count:{id:"chart.date.aggregation.otql.count",defaultMessage:"Count"},noData:{id:"chart.otql.dashboard.common.noData",defaultMessage:"There is no data for your query. Please retry later!"},error:{id:"chart.otql.dashboard.common.error",defaultMessage:"there was an error generating your chart, please retry"}})},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(46),i=(a=o)&&a.__esModule?a:{default:a},s=n(38),l=n(12);var c=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.entityPath=t,this.getInstanceById=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.entityPath+"/"+e,r=Object.assign({},t);return i.default.getRequest(a,r)},this.getInstanceProperties=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.entityPath+"/"+e+"/properties";return i.default.getRequest(a,t)},this.updatePluginInstance=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.entityPath+"/"+e,r=Object.assign({},t);return i.default.putRequest(a,r)},this.updatePluginInstanceProperty=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n.entityPath+"/"+t+"/properties/technical_name="+a;return n._pluginService.handleSaveOfProperties(r,e,n.entityPath,t,o)},this.createPluginInstance=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.entityPath+"?organisation_id="+e,r=Object.assign({},t);return i.default.postRequest(a,r)}};c([(0,s.inject)(l.TYPES.IPluginService)],u.prototype,"_pluginService",void 0),u=c([(0,s.injectable)()],u),t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateInitialAutomationData=t.INITIAL_AUTOMATION_DATA=void 0;var a=n(221),r=n(160);t.INITIAL_AUTOMATION_DATA={automation:{},exitCondition:{id:(0,r.generateFakeId)(),query_id:(0,r.generateFakeId)(),type:"EVENT",scenario_id:(0,r.generateFakeId)(),formData:{},initialFormData:{}},automationTreeData:{node:(0,a.beginNode)(),out_edges:[{in_edge:a.edge12,node:a.node4,out_edges:[]}]}},t.generateInitialAutomationData=function(e){return{automation:{},exitCondition:{id:(0,r.generateFakeId)(),query_id:(0,r.generateFakeId)(),type:"EVENT",scenario_id:(0,r.generateFakeId)(),formData:{},initialFormData:{}},automationTreeData:{node:(0,a.beginNode)(e),out_edges:[{in_edge:a.edge12,node:a.node4,out_edges:[]}]}}}},,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(84),l=(a=s)&&a.__esModule?a:{default:a};var c=function(e){var t="success";e.meta.touched&&e.meta.invalid&&(t="error"),e.meta.touched&&e.meta.warning&&(t="warning");var n=e.textArea?i.Input.TextArea:i.Input;return o.createElement(l.default,r({help:e.meta.touched&&(e.meta.warning||e.meta.error),helpToolTipProps:e.helpToolTipProps,validateStatus:t,small:e.small},e.formItemProps),o.createElement(n,r({id:e.input.name},e.input,e.inputProps)))};c.defaultProps={formItemProps:{},inputProps:{},helpToolTipProps:{title:""}},t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({confirm:{id:"modal.confirm",defaultMessage:"Ok"},cancel:{id:"modal.cancel",defaultMessage:"Cancel"},archiveCampaignConfirm:{id:"campaign.archive.modal.confirm",defaultMessage:"Are you sure you want to archive this Campaign?"},archiveCampaignMessage:{id:"campaign.archive.modal.message",defaultMessage:"By archiving this Campaign all its activities will be suspended. You'll be able to recover it from the archived campaign filter."},deleteImportConfirm:{id:"import.delete.modal.confirm",defaultMessage:"Are you sure you want to delete this Import?"},deleteImportMessage:{id:"import.delete.modal.message",defaultMessage:"By deleting this Import, all its executions and associated files will be unavailable."},archiveExportConfirm:{id:"export.list.archive.modal.title",defaultMessage:"Are you sure you want to archive this Export?"},archiveExportMessage:{id:"export.list.archive.modal.message",defaultMessage:"By archiving this Export all its executions and associated files will be unavailable."},noActionTitle:{id:"modal.noupolad.title",defaultMessage:"Unable to perform this action."},noUploadMessage:{id:"modal.noupolad.message",defaultMessage:"Your creative has been successfully audited. If you want to modify it, please reset the audit, modify it and submit to audit again."},noUpdateMessage:{id:"modal.update.message",defaultMessage:"Your creative audit is pending. If you want to modify it, please wait until the audit is done, reset it, modify your creative and submit to audit again."},exportIsRunningTitle:{id:"export.running.modal.title",defaultMessage:"Export is running"},exportIsRunningMessage:{id:"export.running.modal.message",defaultMessage:"Please wait until the export is fully completed."}})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormInfiniteSearchObjectField=t.FormSearchObjectField=t.FormRelativeAbsoluteDateField=t.FormTagSelectField=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(25),l=n(13),c=n(8),u=n(35),d=n(24),f=M(n(1061)),p=M(n(343)),m=M(n(789)),g=n(342),y=M(n(418)),h=M(n(1062)),v=n(1063),b=M(v),_=n(12),S=n(15),E=n(163),O=n(127),w=n(65);function M(e){return e&&e.__esModule?e:{default:e}}var P=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},T=t.FormTagSelectField=u.Field,I=t.FormRelativeAbsoluteDateField=u.Field,A=t.FormSearchObjectField=u.Field,C=(t.FormInfiniteSearchObjectField=u.Field,function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchPredicates=function(e,t){var a=n.props.runFieldProposal;return a?a(e,t):Promise.resolve([])},n.getField=function(e,t){var n=e.fieldNodeForm;return Array.isArray(n)?void 0!==t&&n[t]?n[t]:void 0:n},n.getAvailableFields=function(){return n.props.availableFields.filter((function(e){return g.SUPPORTED_FIELD_TYPES.find((function(t){return e.field_type.indexOf(t)>-1}))})).map((function(e){return{value:e.name,title:e.decorator&&!1===e.decorator.hidden?e.decorator.label:e.name}}))},n.getSelectedFieldType=function(e){var t=n.props.availableFields.find((function(t){return t.name===e}));if(t){var a=t.field_type.match(/\w+/);return a&&a[0]}return null},n.getSelectedIndex=function(e){var t=n.props.availableFields.findIndex((function(t){return t.name===e}));return t>-1?t:null},n.getSelectedFieldIndexDataType=function(e){var t=n.props.availableFields.find((function(t){return t.name===e}));if(t){var a=t.directives.find((function(e){return"TreeIndex"===e.name}));if(a){var r=a.arguments.find((function(e){return"data_type"===e.name}));if(r){var o=r.value.match(/\w+/);return o&&o[0]}return null}return null}return null},n.generateAvailableConditionOptions=function(e,t,a,r){var o=n.props.intl,i=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(a){var r=(0,O.getCoreReferenceTypeAndModel)(a);if(r)return n.generateReferenceTableComparisonField(r.type,r.modelType)}return t?n.generateReferenceTableComparisonField("COMPUTED"):e};switch(e){case"Timestamp":case"Date":return Object.assign(Object.assign({},b.default.generateTimeComparisonOperator(o)),{component:i(n.generateTimestampComparisonField())});case"String":return Object.assign(Object.assign({},b.default.generateStringComparisonOperator(o,t||void 0,r)),{component:i(n.generateStringComparisonField(),!0),fetchPredicate:void 0});case"Bool":case"Boolean":return Object.assign(Object.assign({},b.default.generateBooleanComparisonOperator(o)),{component:i(n.generateBooleanComparisonField())});case"Enum":return Object.assign(Object.assign({},b.default.generateEnumComparisonOperator(o)),{component:i(n.generateEnumComparisonField())});case"Number":case"Float":case"Int":case"Double":case"BigDecimal":return Object.assign(Object.assign({},b.default.generateNumericComparisonOperator(o)),{component:i(n.generateNumericComparisonField())});case"ID":return Object.assign(Object.assign({},b.default.generateStringComparisonOperator(o)),{component:i(n.generateIdComparisonField())});case"OperatingSystemFamily":case"FormFactor":case"HashFunction":case"BrowserFamily":case"UserAgentType":case"ActivitySource":case"UserActivityType":return Object.assign(Object.assign({},b.default.generateEnumComparisonOperator(o)),{component:i(n.generateTagSelectComparisonField(v.builtinEnumTypeOptions[e].map((function(e){return{label:e,value:e}}))))});default:return{values:[],defaultValue:void 0,component:void 0}}},n.getFieldDirective=function(e){var t=n.props.objectType.fields.find((function(t){return t.name===e}));return t?t.directives:void 0},n.state={},e.treeNodePath&&(n._computedTreeNodePath=e.treeNodePath),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.formValues,n=e.expressionIndex,a=e.formChange,r=e.name,o=e.treeNodePath,i=e.isEdge;o&&(this._computedTreeNodePath=o);var s=this.getField(t,n),l=s?this.getFieldDirective(s.field):void 0;if(s&&!s.comparison){var c=s.field,u=this.getSelectedFieldType(c),d=this.getSelectedFieldIndexDataType(c);a(r?r+".comparison":"comparison",this.generateAvailableConditionOptions(u,d,l,i).defaultValue)}}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.formValues,a=t.expressionIndex,r=t.formChange,o=t.name,i=t.isEdge,s=e.formValues,l=e.expressionIndex,c=this.getField(n,a),u=c?c.field:void 0,d=c?this.getFieldDirective(c.field):void 0,f=this.getField(s,l);if(u!==(f?f.field:void 0)&&void 0!==u){var p=this.getSelectedFieldType(u),m=this.getSelectedFieldIndexDataType(u);r(o?o+".comparison":"comparison",this.generateAvailableConditionOptions(p,m,d,i).defaultValue)}}},{key:"generateTimestampComparisonField",value:function(){var e,t=this.props,n=t.intl,a=t.name,r=t.idToAttachDropDowns,i=t.disabled,s=t.formValues,l=t.expressionIndex,c={};r&&(c={getCalendarContainer:function(e){return document.getElementById(r)}});var u=this.getField(s,l),d=null===(e=null==u?void 0:u.comparison)||void 0===e?void 0:e.operator;return o.createElement(I,{name:a?a+".comparison.values":"comparison.values",component:h.default,formItemProps:{label:n.formatMessage(y.default.fieldConditionValuesLabel),required:!0},datePickerProps:Object.assign({},c),small:!0,unixTimstamp:!0,disabled:i,dateComparisonOperator:d})}},{key:"generateDateComparisonField",value:function(){var e=this.props,t=e.intl,n=e.name,a=e.idToAttachDropDowns,r={};return a&&(r={getCalendarContainer:function(e){return document.getElementById(a)}}),o.createElement(I,{name:n?n+".comparison.values":"comparison.values",component:h.default,formItemProps:{label:t.formatMessage(y.default.fieldConditionValuesLabel),required:!0},datePickerProps:Object.assign({},r),small:!0})}},{key:"generateStringComparisonField",value:function(){var e=this.props,t=e.intl,n=e.name,a=e.fieldValidators;return o.createElement(d.FormMultiTagField,{name:n?n+".comparison.values":"comparison.values",component:f.default,formItemProps:{label:t.formatMessage(y.default.fieldConditionValuesStringLabel),required:!0},validate:[a.isRequired],helpToolTipProps:{title:t.formatMessage(y.default.fieldConditionMultiValuesTooltip)},small:!0})}},{key:"generateTagSelectComparisonField",value:function(e){var t=this.props,n=t.intl,a=t.name,r=t.idToAttachDropDowns,i=t.fieldValidators,s={};return r&&(s={getPopupContainer:function(e){return document.getElementById(r)}}),o.createElement(T,{name:a?a+".comparison.values":"comparison.values",component:m.default,formItemProps:{label:n.formatMessage(y.default.fieldConditionValuesLabel),required:!0},selectProps:Object.assign({options:e},s),validate:[i.isRequired],helpToolTipProps:{title:n.formatMessage(y.default.fieldConditionMultiValuesTooltip)},small:!0})}},{key:"generateBooleanComparisonField",value:function(){return this.generateTagSelectComparisonField([{value:"true",label:"true"},{value:"false",label:"false"}])}},{key:"generateEnumComparisonField",value:function(e){var t=this.props.intl;return o.createElement("div",null,t.formatMessage(y.default.fieldTypeNotSupported))}},{key:"generateNumericComparisonField",value:function(){var e=this.props,t=e.intl,n=e.name,a=e.fieldValidators,r=e.idToAttachDropDowns,i=e.disabled,s={};return r&&(s={getPopupContainer:function(e){return document.getElementById(r)}}),o.createElement(d.FormMultiTagField,{name:n?n+".comparison.values":"comparison.values",component:f.default,validate:[a.isRequired,a.isValidArrayOfNumber],formItemProps:{label:t.formatMessage(y.default.fieldConditionValuesNumberLabel),required:!0},selectProps:Object.assign({options:[],dropdownStyle:{display:"none"},disabled:i},s),helpToolTipProps:{title:t.formatMessage(y.default.fieldConditionMultiValuesTooltip)},small:!0})}},{key:"generateIdComparisonField",value:function(){var e=this,t=this.props,n=t.intl,a=t.name,r=t.match.params.organisationId,i=t.objectType,s=t.datamartId,l=t.idToAttachDropDowns,c=t.fieldValidators,u={};return l&&(u={getPopupContainer:function(e){return document.getElementById(l)}}),"UserSegment"===i.name?o.createElement(A,{name:a?a+".comparison.values":"comparison.values",component:p.default,formItemProps:{label:n.formatMessage(y.default.fieldConditionValuesStringLabel),required:!0},validate:[c.isRequired],fetchListMethod:function(t){return e._audienceSegmentService.getSegments(r,{keywords:t,datamart_id:s}).then((function(e){return e.data.map((function(e){return{key:e.id,label:o.createElement(E.SegmentNameDisplay,{audienceSegmentResource:e}),value:e.id}}))}))},fetchSingleMethod:function(t){return e._audienceSegmentService.getSegment(t).then((function(e){return{key:e.data.id,label:o.createElement(E.SegmentNameDisplay,{audienceSegmentResource:e.data}),value:e.data.id}}))},helpToolTipProps:{title:n.formatMessage(y.default.fieldConditionMultiValuesTooltip)},selectProps:Object.assign({},u),small:!0}):this.generateStringComparisonField()}},{key:"generateReferenceTableComparisonField",value:function(e,t){var n=this,a=this.props,r=a.intl,i=a.name,s=a.objectType,l=a.idToAttachDropDowns,c=a.datamartId,u=a.runtimeSchemaId,d=a.formValues,f=a.expressionIndex,m=a.fieldValidators,g=a.disabled,h=a.match.params.organisationId,v=a.workspace.community_id,b=this.getField(d,f),_=function(e){return b?n._referenceTableService.getReferenceTable(c,u,s.name,b.field).then((function(e){return e.data.map((function(e){return{key:e.value,label:e.display_value,value:e.value}}))})):Promise.resolve([])},S=function(e){return Promise.resolve({key:e,label:e,value:e})},O={},w=!1,M=!1;if(e&&"CORE_OBJECT"===e){if(t)switch(t){case"COMPARTMENTS":_=function(e){return n._datamartService.getUserAccountCompartmentDatamartSelectionResources(c).then((function(e){return e.data.map((function(e){return{key:e.compartment_id,label:e.name?e.name:e.token,value:e.compartment_id}}))}))},S=function(e){return n._compartmentService.getCompartment(e).then((function(e){return{key:e.data.id,label:e.data.name,value:e.data.id}}))};break;case"CHANNELS":_=function(e){return n._channelService.getChannelsByOrganisation(h,{community_id:h===v?v:void 0,keywords:e,with_source_datamarts:!0}).then((function(e){return e.data.map((function(e){return{key:e.id,label:e.name,value:e.id}}))}))},S=function(e){return n._channelService.getChannel(c,e).then((function(e){return{key:e.data.id,label:e.data.name,value:e.data.id}}))};break;case"SEGMENTS":_=function(e){return n._audienceSegmentService.getSegments(h,{keywords:e,datamart_id:c}).then((function(e){return e.data.map((function(e){return{key:e.id,label:o.createElement(E.SegmentNameDisplay,{audienceSegmentResource:e}),value:e.id}}))}))},S=function(e){return n._audienceSegmentService.getSegment(e).then((function(e){return{key:e.data.id,label:e.data.name,value:e.data.id}}))}}}else e&&"COMPUTED"===e&&(_=function(e){return n.fetchPredicates(n._computedTreeNodePath,b?b.field:"").then((function(e){return e.map((function(e){return{key:e,label:e,value:e}}))}))},O=Object.assign(Object.assign({},O),{mode:"tags"}),M=!0,w=!0);return l&&(O=Object.assign(Object.assign({},O),{getPopupContainer:function(e){return document.getElementById(l)}})),o.createElement(A,{name:i?i+".comparison.values":"comparison.values",component:p.default,formItemProps:{label:r.formatMessage(y.default.fieldConditionValuesStringLabel),required:!0},fetchListMethod:_,fetchSingleMethod:S,helpToolTipProps:{title:r.formatMessage(y.default.fieldConditionMultiValuesTooltip)},validate:[m.isRequired],selectProps:Object.assign(Object.assign({},O),{disabled:g}),type:b&&b.field,small:!0,loadOnlyOnce:w,shouldFilterData:M})}},{key:"render",value:function(){var e=this.props,t=e.expressionIndex,n=e.fieldValidators.isRequired,a=e.intl,r=e.formValues,i=e.name,s=e.idToAttachDropDowns,l=e.disabled,c=e.isEdge,u=this.getField(r,t),f=u?this.getFieldDirective(u.field):void 0,p=u&&""!==u.field,m=u?u.field:"",g=u&&u.comparison&&u.comparison.operator?u.comparison.operator:void 0,h=this.getSelectedFieldType(m),v=this.getSelectedFieldIndexDataType(m),b={};s&&(b={getPopupContainer:function(e){return document.getElementById(s)}});var _=this.generateAvailableConditionOptions(h,v,f,c);return o.createElement("div",null,o.createElement(d.FormSelectField,{name:i?i+".field":"field",component:d.DefaultSelect,validate:[n],options:this.getAvailableFields(),formItemProps:{label:a.formatMessage(y.default.fieldConditionFieldLabel),required:!0},selectProps:Object.assign(Object.assign({},b),{disabled:l}),disabled:l,small:!0}),o.createElement(d.FormSelectField,{name:i?i+".comparison.operator":"comparison.operator",component:d.DefaultSelect,validate:[],options:_.values,formItemProps:{label:a.formatMessage(y.default.fieldConditionConditionLabel)},selectProps:Object.assign(Object.assign({notFoundContent:a.formatMessage(y.default.fieldTypeNotSupported)},b),{disabled:l}),small:!0,disabled:!p||l}),m&&g&&_.component)}}]),t}(o.Component));P([(0,S.lazyInject)(_.TYPES.IAudienceSegmentService)],C.prototype,"_audienceSegmentService",void 0),P([(0,S.lazyInject)(_.TYPES.ICompartmentService)],C.prototype,"_compartmentService",void 0),P([(0,S.lazyInject)(_.TYPES.IChannelService)],C.prototype,"_channelService",void 0),P([(0,S.lazyInject)(_.TYPES.IDatamartService)],C.prototype,"_datamartService",void 0),P([(0,S.lazyInject)(_.TYPES.IReferenceTableService)],C.prototype,"_referenceTableService",void 0);t.default=(0,c.compose)(l.withRouter,i.injectIntl,w.injectWorkspace,d.withValidators,d.withNormalizer,(0,s.connect)((function(e,t){return{formValues:(0,u.getFormValues)(t.formName||g.FORM_ID)(e)}})))(C)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceByKeywordSelector=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=f(n(1124)),s=f(n(250)),l=n(11),c=n(10),u=f(n(23)),d=n(8);function f(e){return e&&e.__esModule?e:{default:e}}t.ResourceByKeywordSelector=function(e,t,n){var f=function(u){function d(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,e));t._debounce=s.default,t.handleSearch=function(e){if(e.length>0){var n=t.state,a=n.fetchedKeyword,r=n.fetchedResourcesList;e.length>2&&r&&a&&e.toLowerCase().includes(a.toLowerCase())?t.searchInPreviousFetch(e,r):t.fetchListMethod(e)}},t.handleChange=function(e){var n=t.props.onchange,a=t.state.resourcesList;Array.isArray(e)&&0===e.length&&t.fetchListMethod("");var r=void 0;Array.isArray(e)&&((r=Array.isArray(e)&&e.find((function(e){return"Select all"===e.key})))&&(e=a),e.find((function(e){return"Deselect all"===e.key}))&&(e=[]));t.setState({value:e,allOptionsSelected:!!r}),n(e)};var n=e.value.map((function(e){return{key:e,value:e}}));return t.state={value:n,resourcesList:[],fetching:!1,allOptionsSelected:!1},t.fetchListMethod=t._debounce(t.fetchListMethod.bind(t),800,{trailing:!0}),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,u),r(d,[{key:"componentDidMount",value:function(){this.fetchListMethod("")}},{key:"searchInPreviousFetch",value:function(e,t){this.setState({resourcesList:t.filter((function(t){return t.key&&t.key.toLowerCase().includes(e.toLowerCase())}))})}},{key:"fetchListMethod",value:function(n){var r=this,i=this.props,s=i.datamartId,l=i.organisationId,c=i.filter,u=i.notifyError,d=i.showId;this.setState({resourcesList:[],fetching:!0});var f=Object.assign({keywords:n,datamart_id:s,organisation_id:l},c);return t.getForKeyword(f).then((function(t){var i=t.filter((function(e){return e.id})).map((function(t){return{key:t.id,label:o.createElement(e,a({},t,{showId:d}))}}));r.setState({resourcesList:i,fetching:!1,fetchedResourcesList:i,fetchedKeyword:n})})).catch((function(e){u(e),r.setState({fetching:!1})}))}},{key:"render",value:function(){var e=this.state,t=e.resourcesList,a=e.fetching,r=e.value,s=e.allOptionsSelected?"Deselect all":"Select all",u=this.props,d=u.anchorId,f=u.className,p=u.multiselect,m=u.displaySelectAll;return o.createElement(i.default,{mode:p?"tags":void 0,tokenSeparators:[",","\t"],showSearch:!0,labelInValue:!0,autoFocus:!0,value:r,className:f||"mcs-resourceByNameSelector",placeholder:n,onSearch:this.handleSearch,onChange:this.handleChange,notFoundContent:a?o.createElement(c.Spin,{size:"small",className:"text-center"}):null,suffixIcon:o.createElement(l.McsIcon,{type:"magnifier"}),getPopupContainer:function(){return document.getElementById(d)},filterOption:function(){return!0}},t.length>1&&m&&o.createElement(i.default.Option,{value:s,key:s},s),t.map((function(e,t){return o.createElement(i.default.Option,{value:e.key,key:t.toString()},e.label)})))}}]),d}(o.Component);return(0,d.compose)(u.default)(f)}},,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.putLogo=t.getCookies=t.getLogo=t.getWorkspace=t.getConnectedUser=void 0;var a=n(247),r=n(104),o={request:(0,a.createAction)(r.CONNECTED_USER.REQUEST),success:(0,a.createAction)(r.CONNECTED_USER.SUCCESS),failure:(0,a.createAction)(r.CONNECTED_USER.FAILURE)},i={request:(0,a.createAction)(r.PUT_LOGO.REQUEST),success:(0,a.createAction)(r.PUT_LOGO.SUCCESS),failure:(0,a.createAction)(r.PUT_LOGO.FAILURE)},s={request:(0,a.createAction)(r.WORKSPACE.REQUEST),success:(0,a.createAction)(r.WORKSPACE.SUCCESS),failure:(0,a.createAction)(r.WORKSPACE.FAILURE)},l={request:(0,a.createAction)(r.FETCH_COOKIES.REQUEST),success:(0,a.createAction)(r.FETCH_COOKIES.SUCCESS),failure:(0,a.createAction)(r.FETCH_COOKIES.FAILURE)},c={request:(0,a.createAction)(r.GET_LOGO.REQUEST),success:(0,a.createAction)(r.GET_LOGO.SUCCESS),failure:(0,a.createAction)(r.GET_LOGO.FAILURE)};t.getConnectedUser=o,t.getWorkspace=s,t.getLogo=c,t.getCookies=l,t.putLogo=i},,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=u(n(47)),l=u(n(84)),c=n(6);function u(e){return e&&e.__esModule?e:{default:e}}var d=i.Select.Option,f=(0,c.defineMessages)({defaultValue:{id:"components.form.formSelect.defaultSelect.defaultValue",defaultMessage:"- Select One -"}}),p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.id=(0,s.default)(),n.setDefaultValue=function(){var e=n.props,t=e.options,a=e.input,r=a.value,o=a.onChange;!t||1!==t.length||r&&""!==r||o(t[0].value)},n.state={didMount:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.setState({didMount:!0}),this.props.autoSetDefaultValue&&this.setDefaultValue()}},{key:"componentDidUpdate",value:function(){this.props.autoSetDefaultValue&&this.setDefaultValue()}},{key:"render",value:function(){var e=this,t=this.props,n=t.formItemProps,r=t.helpToolTipProps,u=t.disabled,p=t.input,m=t.meta,g=t.options,y=t.selectProps,h=t.small,v=t.defaultValueTitle,b=this.state.didMount,_="success";m.touched&&m.invalid&&(_="error"),m&&m.touched&&m.warning&&(_="warning");var S=g.map((function(e){return o.createElement(d,{key:(0,s.default)(),value:e.value},e.title||e.value)})),E=o.createElement(d,{value:""},v||o.createElement(c.FormattedMessage,f.defaultValue));return o.createElement(l.default,a({help:m.touched&&(m.warning||m.error),helpToolTipProps:r,validateStatus:_,small:h},n),o.createElement("div",{id:this.id,style:{width:"100%"}},b&&o.createElement(i.Select,a({},y,{onBlur:function(){return function(){return p.onBlur(p.value)}},onChange:p.onChange,onFocus:p.onFocus,value:p.value,disabled:u,getPopupContainer:y&&y.getPopupContainer?y.getPopupContainer:function(){return document.getElementById(e.id)}}),E,S)))}}]),t}(o.Component);p.defaultProps={formItemProps:{},selectProps:{},options:[],disabled:!1,autoSetDefaultValue:!0},t.default=p},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=f(n(47)),i=n(8),s=n(6),l=n(10),c=n(107),u=f(n(2023)),d=n(11);function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},y={size:"small",showSizeChanger:!0},h=function(e){function t(){p(this,t);var e=m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildActionsColumns=function(t){return t.map((function(t){return{key:t.key,width:30,render:function(n,a){return r.createElement(c.Dropdown,{overlay:e.renderActionsMenu(t.actions,a),trigger:["click"],className:"mcs-tableActions_dropdown"},r.createElement("a",{className:"ant-dropdown-link"},r.createElement(d.McsIcon,{type:"chevron"})))},sorter:!1}}))},e.buildDataColumns=function(){var t=e.props,n=t.columns,a=t.visibilitySelectedColumns,o=a.map((function(e){return e.key}));if(void 0===n)throw new Error("Undefined columns in TableView");return n.filter((function(e){return o.length>=1?!e.isHideable||o.includes(e.key):e})).map((function(e){return{title:(t=e.intlMessage,t&&void 0!==t.id?r.createElement(s.FormattedMessage,e.intlMessage):e.title),dataIndex:e.key,key:e.key,render:e.render?e.render:function(e){return e},sorter:!!e.sorter&&e.sorter};var t}))},e.renderActionsMenu=function(e,t){return r.createElement(l.Menu,{onClick:function(n){e(t)[parseInt(n.key,0)].callback(t)},className:"mcs-dropdown-actions"},e(t).map((function(e,t){var n;return r.createElement(l.Menu.Item,{key:t.toString(),disabled:e.disabled,className:e.intlMessage?"mcs-tableActions_"+(null===(n=e.intlMessage)||void 0===n?void 0:n.id):""},e.intlMessage?r.createElement(s.FormattedMessage,e.intlMessage):t)})))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.dataSource,n=e.loading,a=e.onChange,i=e.pagination,s=e.actionsColumnsDefinition,c=(e.visibilitySelectedColumns,e.children,e.intl,g(e,["dataSource","loading","onChange","pagination","actionsColumnsDefinition","visibilitySelectedColumns","children","intl"])),d=this.buildDataColumns().concat(this.buildActionsColumns(s));if(void 0===t)throw new Error("Undefined dataSource in TableView");var f=t.map((function(e){return Object.assign({key:e.id?e.id:(0,o.default)()},e)})),p=i;p=i?Object.assign(Object.assign({},y),i):Object.assign({},y);var m=Object.assign(Object.assign({},c),{columns:d,dataSource:f,loading:n,onChange:a,pagination:p});return r.createElement("div",{style:{width:"100%"}},r.createElement(u.default,{rowSelection:c.rowSelection,pagination:i}),r.createElement(l.Table,m))}}]),t}(r.Component);h.defaultProps={visibilitySelectedColumns:[],actionsColumnsDefinition:[]},t.default=(0,i.compose)(s.injectIntl)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({goals:{id:"goals.title",defaultMessage:"Goals"},edit:{id:"goals.stats.edit",defaultMessage:"Edit"},archive:{id:"goals.stats.archive",defaultMessage:"Archive"},history:{id:"goals.stats.history",defaultMessage:"History"},delete:{id:"goals.stats.delete",defaultMessage:"Delete"},pause:{id:"goals.status.pause",defaultMessage:"Pause Goal"},activate:{id:"goals.status.activate",defaultMessage:"Activate Goal"},archiveGoalModalTitle:{id:"goals.stats.archive.modal.title",defaultMessage:"Are you sure you want to archive this Goal?"},archiveGoalModalBody:{id:"goals.stats.archive.modal.body",defaultMessage:"By archiving this Goal all its activities will be suspended. Are you sure to perform this action ?"},value:{id:"goals.stats.value",defaultMessage:"Conversion Value"},conversions:{id:"goals.stats.conversion",defaultMessage:"Conversions"},price:{id:"goals.stats.price",defaultMessage:"Conversion Price"},noStatAvailable:{id:"goals.stats.noStatAvailable",defaultMessage:"There is no stats available"},day:{id:"goals.stats.day",defaultMessage:"Day"},marketingChannel:{id:"goals.stats.marketingChannel",defaultMessage:"Marketing Channel"},source:{id:"goals.stats.source",defaultMessage:"Source"},campaignName:{id:"goals.stats.campaignName",defaultMessage:"Campaign Name"},creativeName:{id:"goals.stats.creativeName",defaultMessage:"Creative Name"},weightedConversions:{id:"goals.stats.weightedConversions",defaultMessage:"Weighted Conversions"},weightedValue:{id:"goals.stats.weightedValue",defaultMessage:"Weighted Value"},postViewWeightedConversions:{id:"goals.stats.postViewWeightedConversions",defaultMessage:"Post View Weighted Conversions"},postClickWeightedConversions:{id:"goals.stats.postClickWeightedConversions",defaultMessage:"Post Click Weighted Conversions"},postView:{id:"goals.stats.postView",defaultMessage:"Post View"},postClick:{id:"goals.stats.postClick",defaultMessage:"Post Click"},interactionToConversionDuration:{id:"goals.stats.interactionToConversionDuration",defaultMessage:"Interaction to Conversion Duration"},interactionType:{id:"goals.stats.interactionType",defaultMessage:"Interaction type"},SOURCE:{id:"goals.stats.source",defaultMessage:"Source"},CAMPAIGN:{id:"goals.stats.campaign",defaultMessage:"Campaign"},CREATIVES:{id:"goals.stats.creative",defaultMessage:"Creative"},pCpVFormatDuration:{id:"goals.stats.pcpvduration",defaultMessage:"{value} in {duration}"},exportInProgress:{id:"goal.dashboard.actionbar.button.export",defaultMessage:"Export in progress"},goalsExportTitle:{id:"goal.dashboard.actionbar.export.title",defaultMessage:"Goals Export"},goalsExportColumnName:{id:"goal.dashboard.actionbar.export.column.name",defaultMessage:"Name"},goalsExportColumnConversions:{id:"goal.dashboard.actionbar.export.column.conversions",defaultMessage:"Conversions"},goalsExportColumnConversionValue:{id:"goal.dashboard.actionbar.export.column.conversionValue",defaultMessage:"Conversion value"},campaignId:{id:"goal.dashboard.actionbar.export.column.campaignId",defaultMessage:"Campaign ID"},creativeId:{id:"goal.dashboard.actionbar.export.column.creativeId",defaultMessage:"Creative ID"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.funnelMessages=t.FUNNEL_SEARCH_SETTING=t.booleanOperator=t.enumValuesByName=t.deviceBrowserFamilyDimensions=t.deviceOsFamilyDimensions=t.deviceFormFactorDimensions=t.eventTypesDimension=t.showFilterOperator=t.dimensionFilterOperator=void 0;var a=n(30),r=n(6);t.dimensionFilterOperator=["EXACT","NUMERIC_EQUAL","NUMERIC_GREATER_THAN","NUMERIC_LESS_THAN","IN_LIST","IS_NULL"],t.showFilterOperator=["equals","in"];var o=t.eventTypesDimension=["$transaction_confirmed","$item_list_view","$item_view","$basket_view"],i=t.deviceFormFactorDimensions=["OTHER","PERSONAL_COMPUTER","SMART_TV","GAME_CONSOLE","SMARTPHONE","TABLET","WEARABLE_COMPUTER"],s=t.deviceOsFamilyDimensions=["OTHER","WINDOWS","MAC_OS","LINUX","ANDROID","IOS"],l=t.deviceBrowserFamilyDimensions=["OTHER","CHROME","IE","FIREFOX","SAFARI","OPERA","STOCK_ANDROID","BOT","EMAIL_CLIENT","MICROSOFT_EDGE"],c=(t.enumValuesByName={EVENT_TYPE:o,DEVICE_OS_FAMILY:s,DEVICE_FORM_FACTOR:i,DEVICE_BROWSER_FAMILY:l},t.booleanOperator=["AND","OR"],{paramName:"filter",defaultValue:void 0,deserialize:function(e){return e.filter?e.filter.split(","):[]},serialize:function(e){return e.join(",")},isValid:function(e){return!e.filter||e.filter.split(",").length>0}});t.FUNNEL_SEARCH_SETTING=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(a.DATE_SEARCH_SETTINGS),[c]),t.funnelMessages=(0,r.defineMessages)({noData:{id:"funnel.common.noData",defaultMessage:"There is no data for your query. Please retry later!"},exportTitle:{id:"funnel.export.title",defaultMessage:"Funnel Report"},total:{id:"funnel.common.totla",defaultMessage:"Total"},stepName:{id:"funnel.common.stepName",defaultMessage:"step name"},userPoints:{id:"funnel.common.userPoints",defaultMessage:"user points"},duration:{id:"funnel.common.interationDuration",defaultMessage:"interaction duration"},channelId:{id:"funnel.common.channelId",defaultMessage:"channel id"},conversion:{id:"funnel.common.conversion",defaultMessage:"# units"},amount:{id:"funnel.common.amount",defaultMessage:"amount"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(11),s=n(2040),l=(a=s)&&a.__esModule?a:{default:a};function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=function(e){function t(){return c(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.campaign,n=e.showStatus,a=t&&o.createElement(l.default,{status:t.status});return o.createElement(i.ContentHeader,{title:t?t.name||t.id:"",subTitle:n?a:null,loading:!t})}}]),t}(o.Component);d.defaultProps={showStatus:!0},t.default=d},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Labels=void 0;var a,r=n(2057),o=(a=r)&&a.__esModule?a:{default:a};t.Labels=o.default},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QUERY_DOCUMENT_INITIAL_VALUE=t.FORM_ID=t.generateObjectNodeFromFormData=t.generateFormDataFromObjectNode=t.FrequencyConverter=t.SUPPORTED_FIELD_TYPES=void 0;var a,r=n(47),o=(a=r)&&a.__esModule?a:{default:a};function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var s=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},l=(t.SUPPORTED_FIELD_TYPES=["Timestamp","Date","String","Bool","Enum","Number","Float","Int","Double","BigDecimal","ID","FormFactor","HashFunction","BrowserFamily","OperatingSystemFamily","UserAgentType","ActivitySource","UserActivityType"],t.FrequencyConverter={toFrequency:function(e){return e.min_score?{enabled:!0,mode:"AT_LEAST",value:""+e.min_score}:{enabled:!1,mode:"AT_LEAST"}},fromFrequency:function(e){return e.enabled?{min_score:Number(e.value),score_function:"SUM"}:{min_score:void 0,score_function:void 0}}}),c=t.generateFormDataFromObjectNode=function(e){var t=e.expressions;return{objectNodeForm:s(e,["expressions"]),fieldNodeForm:t.filter((function(e){return"FIELD"===e.type})).map((function(e){return Object.assign(Object.assign({},e),{key:(0,o.default)()})})),untouchedExpressions:t.filter((function(e){return"OBJECT"===e.type})),frequency:l.toFrequency(e)}};t.generateObjectNodeFromFormData=function(e){var t=e.objectNodeForm,n=e.fieldNodeForm,a=e.frequency;return Object.assign(Object.assign(Object.assign({},t),{type:"OBJECT",boolean_operator:t.boolean_operator||"OR",expressions:[].concat(i((n||[]).map((function(e){e.key;return s(e,["key"])}))),i(e.untouchedExpressions||[]))}),l.fromFrequency(a))},t.FORM_ID="queryDocumentForm",t.QUERY_DOCUMENT_INITIAL_VALUE=c({boolean_operator:"OR",field:"",type:"OBJECT",expressions:[]})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(54),c=n(84),u=(a=c)&&a.__esModule?a:{default:a};var d=s.Select.Option,f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.debounce=l.debounce,n.fetchInitialData=function(e){var t=n.props,a=t.fetchSingleMethod,r=t.selectProps;if(n.setState({initialFetch:!0}),r&&"multiple"===r.mode||"string"==typeof e){var o=e;if(!o)return void n.setState({initialFetch:!1});a(o).then((function(e){n.setState({value:[e],initialFetch:!1})}))}else{var i=e;Promise.all(i.map((function(e){return a(e)}))).then((function(e){n.setState({value:e,initialFetch:!1})}))}},n.fetchData=function(e){var t=n.props.fetchListMethod;n.setState({fetching:!0}),t(e).then((function(e){n.setState({data:e,fetching:!1},(function(){n.filterData()}))})).catch((function(){n.setState({fetching:!1})}))},n.handleChange=function(e){var t=n.props,a=t.input,r=t.selectProps;if(r&&"multiple"===r.mode){var o=e;n.setState({value:[o],currentValue:void 0},(function(){n.filterData()})),a.onChange(o.key)}else{var i=e;n.setState({value:i,currentValue:void 0},(function(){n.filterData()})),a.onChange(i.map((function(e){return e.key})))}},n.onSearch=function(e){n.setState({currentValue:e}),n.debounce(n.filterData,300,{leading:!1,trailing:!0})()},n.filterData=function(){var e=n.state.currentValue;if(n.props.shouldFilterData){var t=e||"",a=n.state.data.filter((function(e){var n;return null===(n=e.key)||void 0===n?void 0:n.toLocaleLowerCase().startsWith(t)})).slice(0,100);n.setState({filteredData:a})}else n.setState({filteredData:n.state.data})},n.onInputKeyDown=function(){var e=n.props.input,t=n.state,a=t.value,r=t.currentValue,o=[];a&&(o=o.concat(a));var i=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(o.map((function(e){return e.key}))));r&&i.push(r),e.onChange(i)},n.state={data:[],filteredData:[],fetching:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentDidMount",value:function(){var e=this.props.input;this.fetchInitialData(e.value),this.fetchData("")}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,a=n.type,r=n.input;a!==e.type&&(this.fetchInitialData(r.value),this.fetchData(""))}},{key:"render",value:function(){var e=this.props,t=e.meta,n=e.formItemProps,a=e.helpToolTipProps,o=e.small,l=e.selectProps,c=e.loadOnlyOnce,f=this.state.filteredData,p="success";t.touched&&t.invalid&&(p="error"),t.touched&&t.warning&&(p="warning");var m=f.map((function(e){return i.createElement(d,{key:e.key,value:e.value},e.label)}));return i.createElement(u.default,r({help:t.touched&&(t.warning||t.error),helpToolTipProps:a,validateStatus:p,small:o},n),i.createElement(s.Spin,{spinning:this.state.initialFetch},i.createElement(s.Select,r({mode:"multiple",labelInValue:!0,value:this.state.value,placeholder:"Search",defaultActiveFirstOption:!0,filterOption:!1,onSearch:c?this.onSearch:this.fetchData,onInputKeyDown:c?this.onInputKeyDown:void 0,onChange:this.handleChange,notFoundContent:this.state.fetching?i.createElement(s.Spin,{size:"small"}):null,style:{width:"100%"}},l),m)))}}]),t}(i.Component);f.defaultprops={formItemProps:{},inputProps:{},helpToolTipProps:{}},t.default=f},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({audienceFeedWarningMessage:{id:"audience.warning",defaultMessage:"You cannot edit an active plugin. Pause it in order to edit it."},audienceSegmentBreadCrumb:{id:"audience.segment.actionbar.breadcrumb.label",defaultMessage:"New Audience Segment"},audienceSegmentSaveButton:{id:"audience.segment.create.actionbar.button.save",defaultMessage:"Save"},audienceSegmentSiderMenuSemgnetType:{id:"segment.sider.menu.SegmentType",defaultMessage:"Segment Type"},audienceSegmentSiderMenuGeneralInformation:{id:"segment.sider.menu.generalInformation",defaultMessage:"General Information"},audienceSegmentSiderMenuImport:{id:"segment.sider.menu.import",defaultMessage:"Import"},audienceSegmentSiderMenuType:{id:"segment.sider.menu.type",defaultMessage:"Segment Type"},audienceSegmentSiderMenuProperties:{id:"segment.sider.menu.properties",defaultMessage:"Properties"},audienceSegmentSiderMenuUserQuery:{id:"segment.sider.menu.user.query",defaultMessage:"User Query"},audienceSegmentSectionGeneralTitle:{id:"audience.segment.create.section.general.title",defaultMessage:"General Information"},audienceSegmentSectionGeneralSubTitle:{id:"audience.segment.create.section.general.subtitle",defaultMessage:"Give your Audience Segment a name."},audienceSegmentSectionImportTitle:{id:"segment.sider.menu.section.import.title",defaultMessage:"Import"},audienceSegmentSectionImportSubTitle:{id:"segment.sider.menu.section.import.subtitle",defaultMessage:"Upload new user points to your segment, if your segment has already some data, it will add the new data on the top of it."},audienceSegmentSectionQueryTitle:{id:"audience.segment.create.section.query.title",defaultMessage:"User Query"},audienceSegmentSectionQuerySubTitle:{id:"audience.segment.create.section.query.subtitle",defaultMessage:"Select the user you want to add to your segment."},audienceSegmentCreationGeneralNameFieldTitle:{id:"audience.segment.create.section.general.field.name.title",defaultMessage:"Name"},audienceSegmentCreationGeneralDescriptionFieldTitle:{id:"audience.segment.create.section.general.field.description.title",defaultMessage:"Description"},audienceSegmentCreationGeneralPersistedFieldTitle:{id:"audience.segment.create.section.general.field.persisted.title",defaultMessage:"Persisted"},audienceSegmentCreationGeneralPersistedFieldHelper:{id:"audience.segment.create.section.general.field.persisted.helper",defaultMessage:"A persisted segment can be used in a campaign whereas a non persisted serves as analytics"},audienceSegmentCreationGeneralPausedFieldTitle:{id:"audience.segment.create.section.general.field.paused.title",defaultMessage:"Paused"},audienceSegmentCreationGeneralPausedFieldHelper:{id:"audience.segment.create.section.general.field.paused.helper",defaultMessage:"When a segment is paused, all related processings (statistics, user insertions and deletions) are stopped."},audienceSegmentCreationGeneralNameFieldPlaceHolder:{id:"audience.segment.create.section.general.field.name.placeholder",defaultMessage:"Audience Segment Name"},audienceSegmentCreationGeneralDescriptionFieldPlaceHolder:{id:"audience.segment.create.section.general.field.description.placeholder",defaultMessage:"Audience Segment Description"},audienceSegmentCreationGeneralNameFieldHelper:{id:"audience.segment.create.section.general.field.name.helper",defaultMessage:"Give your Audience Segment a name!"},audienceSegmentCreationGeneralDescriptionFieldHelper:{id:"audience.segment.create.section.general.field.description.helper",defaultMessage:"This is the description of your audience segment. You can for instance describe how this segment is built or what its usage is for."},audienceSegmentCreationUserQueryFieldHelper:{id:"audience.segment.create.section.general.field.query.helper",defaultMessage:'Start your query with "SELECT \\{ id \\} FROM UserPoint WHERE" and add your conditions after the WHERE clause.'},contentSectionGeneralAdvancedPartRow1Label:{id:"audience.segment.section1.advancedPart.row1.label",defaultMessage:"Technical Name"},contentSectionGeneralAdvancedPartRow1Placeholder:{id:"audience.segment.section1.advancedPart.row1.placeholder",defaultMessage:"Technical Name"},warningOnTokenEdition:{id:"audience.segment.form.edition.technicalName.warning",defaultMessage:"Danger Zone: Editing this technical name may cause any integrations to fail if not updated properly. Please make sure you have reviewed all your integration before saving."},contentSectionGeneralAdvancedPartRow1Tooltip:{id:"audience.segment.section1.advancedPart.row1.tooltip",defaultMessage:"Use the Technical Name for custom integration"},contentSectionPropertiesPartRow1Label:{id:"audience.segment.section2.row1.label",defaultMessage:"Code Snippet"},contentSectionPropertiesPartRow1Placeholder:{id:"audience.segment.section2.row1.placeholder",defaultMessage:"Code Snippet"},contentSectionPropertiesPartRow1Tooltip:{id:"audience.segment.section2advancedPart.row1.tooltip",defaultMessage:"The code snippet to copy on your web page for custom intergration"},contentSectionPropertiesPartRow1TooltipHover:{id:"audience.segment.section2advancedPart.row1.tooltiphover",defaultMessage:"Click to copy"},contentSectionPropertiesPartRow1TooltipSnippetCopied:{id:"audience.segment.section2advancedPart.row1.codesnippetcopied",defaultMessage:"Code snippet copied"},configureAudienceSegmentTechnicalName:{id:"audience.segment.form.codesnippet.noTechnicalNameConfigured",defaultMessage:"The Audience Segment technical name needs to be configured."},contentSectionGeneralAdvancedPartRow2Label:{id:"audience.segment.section1.advancedPart.row2.label",defaultMessage:"Default lifetime"},contentSectionGeneralAdvancedPartRow2Placeholder:{id:"audience.segment.section1.advancedPart.row2.placeholder",defaultMessage:"Default lifetime"},contentSectionGeneralAdvancedPartRow2Tooltip:{id:"audience.segment.section1.advancedPart.row2.tooltip",defaultMessage:"Use the Default lifetime expiration"},contentSectionGeneralRow4OptionExpiresIn:{id:"audience.segment.section1.advancedPart.row4.ExpiresIn",defaultMessage:"Expires In"},contentSectionGeneralRow5OptionDAY:{id:"audience.segment.section1.advancedPart.row5.optionDAY",defaultMessage:"Days"},contentSectionGeneralRow5OptionWEEK:{id:"audience.segment.section1.advancedPart.row5.optionWEEK",defaultMessage:"Weeks"},contentSectionGeneralRow5OptionMONTH:{id:"audience.segment.section1.advancedPart.row5.optionMONTH",defaultMessage:"Months"},contentSectionGeneralAdvancedPartTitle:{id:"campaignEditor.section.general.advancedPart.title",defaultMessage:"Advanced"},errorFormMessage:{id:"audience.segment.error",defaultMessage:"There is an error with some fields in your form. Please review the data you entered."},savingInProgress:{id:"audience.segments.edit.savingInProgress",defaultMessage:"Saving in progress"},addAFeed:{id:"audience.segment.addAFeed",defaultMessage:"Add a Feed"},downloadTemplate:{id:"audience.segment.downloadTemplate",defaultMessage:"Download template"},sectionAudienceExternalFeedTitle:{id:"audience.segment.audienceexternalfeed.title",defaultMessage:"Audience External Feeds"},sectionAudienceExternalFeedSubtitle:{id:"audience.segment.audienceexternalfeed.subtitle",defaultMessage:"Add an Audience External Feed to push your segment to third party. An Audience External Feed is a Server to Server mean to push a segment to a third party receiver."},sectionEmptyAudienceExternalFeedRules:{id:"audience.segment.audienceexternalfeed.empty",defaultMessage:"No Audience External Feed selected yet!"},sectionAudienceTagFeedTitle:{id:"audience.segment.audiencetagfeed.title",defaultMessage:"Audience Tag Feeds"},sectionAudienceTagFeedSubtitle:{id:"audience.segment.audiencetagfeed.subtitle",defaultMessage:"Add an Audience Tag Feed to push your segment to third party. An Audience Tag Feed will trigger a pixel on your properties to push a segment to a third party receiver."},sectionEmptyAudienceTagFeedRules:{id:"audience.segment.audiencetagfeed.empty",defaultMessage:"No Audience Tag Feed selected yet!"},listExternalTitle:{id:"audience.segment.audienceexternalfeed.list.title",defaultMessage:"Choose your Audience External Feed Type"},listExternalSubTitle:{id:"audience.segment.audienceexternalfeed.list.subtitle",defaultMessage:"Add an Audience External Feed. An Audience External feed will push cookies (Server to Server) to third parties receivers."},audienceFeedDisableExplanation:{id:"audience.segment.audiencefeed.disable.explanation",defaultMessage:"You need to save your Feed before setting it to 'Started.'"},addExisting:{id:"audience.segment.addExisting",defaultMessage:"Add Existing"},uploadMessage:{id:"audience.segment.upload.message",defaultMessage:"Click here or drag and drop your files to upload"},uploadTitle:{id:"audience.segment.upload.title",defaultMessage:"Click or drag file to this area to upload"},uploadError:{id:"audience.segment.upload.error",defaultMessage:"is above 100MB!"},uploadButton:{id:"audience.segment.upload.button",defaultMessage:"Upload"},actionBarSegmentTitle:{id:"audience.segment.actionbar.segment",defaultMessage:"Segments"},actionBarSegmentFeedsCreate:{id:"audience.segment.actionbar.feeds.create",defaultMessage:"Add a new Feed"},actionBarSegmentFeedsEdit:{id:"audience.segment.actionbar.feeds.edit",defaultMessage:"Edit your Feed"},actionBarSegmentPresetCreate:{id:"audience.segment.actionbar.preset.create",defaultMessage:"Create a new Preset"},processingsWarningModalContent:{id:"audience.segment.processings.warning.content",defaultMessage:"You are about to change the Processing Activities on behalf of which you are capturing personal data on this audience segment. mediarithmics platform will now automatically drop new User Events if the User Choices do not allow their capture. Do you want to continue?"},processingsWarningModalOk:{id:"audience.segment.processings.warning.ok",defaultMessage:"OK"},processingsWarningModalCancel:{id:"audience.segment.processings.warning.cancel",defaultMessage:"Cancel"},sectionProcessingActivitiesTitle:{id:"audience.segment.form.processingActivities.title",defaultMessage:"Processing Activities"},noMoreSupported:{id:"audience.segment.edit.legacyComponent.noMoreSupported",defaultMessage:"The query language related to this datamart is no more supported. Please select another datamart or create a new resource based on another datamart."}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=P(n(0)),l=n(8),c=n(25),u=n(6),d=n(13),f=M(n(2415)),p=M(n(1126)),m=P(n(124)),g=n(109),y=M(n(836)),h=M(n(2416)),v=M(n(630)),b=n(24),_=n(10),S=n(15),E=n(12),O=n(11),w=n(41);function M(e){return e&&e.__esModule?e:{default:e}}function P(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function T(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var I=function(e,t,n,a){var r,o=arguments.length,s=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};var A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchInitialValues=function(e){var t=n.props,a=t.pluginInstanceService,o=t.notifyError,i=a.getInstanceById(e).then((function(e){return e.data})),s=a.getInstanceProperties(e).then((function(e){return e.data})),l=a.getLocalizedPluginLayout(e);n.setState({isLoadingPlugin:!0,isLoadingList:!1},(function(){Promise.all([i,s,l]).then((function(e){var t=r(e,3),a=t[0],o=t[1],i=t[2],s={pluginInstance:a,properties:o};null!==i?n.setState({isLoadingPlugin:!1,initialValues:s,pluginProperties:o,pluginLayout:i}):n.setState({isLoadingPlugin:!1,initialValues:s,pluginProperties:o})})).catch((function(e){o(e),n.setState({isLoadingPlugin:!1})}))}))},n.saveOrCreatePluginInstance=function(e,t,a){var r=n.props,o=r.match.params.organisationId,i=r.pluginInstanceService,s=r.notifyError,l=r.createPluginInstance,c=r.onSaveOrCreatePluginInstance,u=n.state.plugin;if(e.id)return n.setState({isLoadingPlugin:!0},(function(){var a=i.updatePluginInstance(e.id,e),r=a.then((function(){return n.updatePropertiesValue(t,o,e.id)}));Promise.all([a,r]).then((function(e){c(e[0].data,t)})).catch((function(e){s(e),n.setState({isLoadingPlugin:!1})}))}));var d=l(o,u,e);return n.setState({isLoadingPlugin:!0},(function(){var e=i.createPluginInstance(o,Object.assign({name:a},d)).then((function(e){return e.data})),r=e.then((function(e){return n.updatePropertiesValue(t,o,e.id)}));Promise.all([e,r]).then((function(e){c(e[0],t)})).catch((function(e){s(e),n.setState({isLoadingPlugin:!1})}))}))},n.updatePropertiesValue=function(e,t,a){var r=n.props.pluginInstanceService,o=[];return e.forEach((function(e){o.push(r.updatePluginInstanceProperty(t,a,e.technical_name,e))})),Promise.all(o)},n.onSelectPlugin=function(e){n.setState({isLoadingPlugin:!0,plugin:e,pluginLayout:e.plugin_layout},(function(){n._pluginService.getPluginVersions(e.id).then((function(t){var a=t.data[t.data.length-1];return n._pluginService.getPluginVersionProperties(e.id,e.current_version_id?e.current_version_id:a.id)})).then((function(t){n.setState({pluginProperties:t.data,initializedPresetValues:e.plugin_preset?n.formatInitialPresetValues(t.data,e.plugin_preset):void 0,isLoadingPlugin:!1})})).catch((function(e){m.notifyError(e),n.setState((function(){return{isLoadingPlugin:!1}}))}))}))},n.onPresetDelete=function(e){var t=n.props,a=t.notifyError,r=t.intl.formatMessage;e&&e.plugin_preset&&_.Modal.confirm({icon:s.createElement(w.ExclamationCircleOutlined,null),title:r(y.default.presetDeletionModalDescription),okText:r(y.default.presetDeletionModalConfirm),cancelText:r(y.default.presetDeletionModalCancel),onOk:function(){e&&e.plugin_preset&&n._pluginService.deletePluginPreset(e.plugin_preset.plugin_id,e.plugin_preset.plugin_version_id,e.plugin_preset.id,{archived:!0}).then((function(){n.getPluginPresetsList(n.state.availablePlugins).then((function(e){n.setState({availablePluginPresets:e})}))})).catch((function(e){a(e)}))},onCancel:function(){}})},n.formatInitialPresetValues=function(e,t){var n={};return e.forEach((function(e){var a=t.properties.find((function(t){return t.technical_name===e.technical_name}));a&&(n[e.technical_name]={value:a.value})})),{properties:n}},n.onReset=function(){n.setState((function(e){var t=Object.assign({},e);return t.plugin={id:"",organisation_id:"",group_id:"",artifact_id:"",current_version_id:""},t}))},n.formatInitialValues=function(e){var t={};return e&&e.properties&&e.properties.forEach((function(e){t[e.technical_name]={value:e.value}})),{plugin:e?e.pluginInstance:void 0,properties:t}},n.state={plugin:{id:"",organisation_id:"",group_id:"",artifact_id:"",current_version_id:""},isLoadingList:!0,isLoadingPlugin:!1,pluginProperties:[],availablePluginPresets:[],availablePlugins:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentDidMount",value:function(){var e=this.props.pluginInstanceId;e?this.fetchInitialValues(e):this.getPluginsAndPresetList()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.match.params.organisationId,a=t.pluginInstanceId,r=e.match.params.organisationId,o=e.pluginInstanceId;n===r&&a===o||!a||this.fetchInitialValues(a)}},{key:"getPluginsAndPresetList",value:function(){var e=this,t=this.props.notifyError;this.setState({isLoadingList:!0},(function(){e.getPluginsList().then((function(t){e.getPluginPresetsList(t).then((function(n){e.setState({availablePlugins:t,availablePluginPresets:n,isLoadingList:!1})}))})).catch((function(n){t(n),e.setState({isLoadingList:!1})}))}))}},{key:"getPluginsList",value:function(){var e=this;return this._pluginService.getPlugins({plugin_type:this.props.pluginType,max_results:1e3}).then((function(e){return e.data})).then((function(t){return Promise.all(t.reduce((function(t,n){return n.current_version_id?[].concat(T(t),[e._pluginService.getLocalizedPluginLayout(n.id,n.current_version_id).then((function(e){return Promise.resolve(Object.assign(Object.assign({},n),{plugin_layout:null!==e?e:void 0}))}))]):t}),[]))}))}},{key:"getPluginPresetsList",value:function(e){var t=this.props.match.params.organisationId;return this._pluginService.getPluginPresets({organisation_id:+t,plugin_type:this.props.pluginType}).then((function(e){return e.data})).then((function(t){return t.reduce((function(t,n){var a=e.find((function(e){return e.id===n.plugin_id}));return a&&a.plugin_layout?[].concat(T(t),[Object.assign(Object.assign({},a),{plugin_preset:n})]):t}),[])}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,r=t.breadcrumbPaths,o=t.onClose,i=t.pluginInstanceId,l=t.showGeneralInformation,c=t.disableFields,u=t.isCardLayout,d=t.renderSpecificFields,m=t.intl.formatMessage,b=t.fieldValidators.isRequired,_=this.state,S=_.pluginProperties,E=_.isLoadingList,w=_.isLoadingPlugin,M=_.plugin,P=_.initialValues,T=_.initializedPresetValues,I=[];i||I.push({sectionId:"type",title:y.default.menuType,onClick:function(){return e.setState({pluginProperties:[]})},type:"validated"}),l&&I.push({sectionId:"general",title:y.default.menuGeneralInformation}),void 0===this.state.pluginLayout?I.push({sectionId:"properties",title:y.default.menuProperties}):this.state.pluginLayout.sections.forEach((function(e){I.push({sectionId:e.title,title:{id:e.title,defaultMessage:e.title}})}));var A={formId:"pluginForm",message:!S.length&&!i||c?void 0:y.default.save,onClose:o};return E||w&&!u?s.createElement("div",{style:{display:"flex",flex:1}},s.createElement(O.Loading,{isFullScreen:!0})):u?s.createElement(g.EditContentLayout,a({paths:r(P&&P.pluginInstance)},A),s.createElement(h.default,{onSelect:this.onSelectPlugin,onPresetDelete:this.onPresetDelete,availablePresetLayouts:this.state.availablePluginPresets,pluginPresetListTitle:this.props.pluginPresetListTitle,pluginPresetListSubTitle:this.props.pluginPresetListSubTitle,availablePluginLayouts:this.state.availablePlugins,pluginListTitle:this.props.listTitle,pluginListSubTitle:this.props.listSubTitle}),s.createElement(v.default,{onClose:this.onReset,organisationId:n,opened:!!M.id,plugin:M,save:this.saveOrCreatePluginInstance,initialValues:T||this.formatInitialValues(P),pluginProperties:S,disableFields:!(!w&&!c),pluginLayout:this.state.pluginLayout,isLoading:w||E||!this.state.pluginLayout,pluginVersionId:M.id,editionMode:!1,nameField:{label:m(y.default.feedModalNameFieldLabel),title:M.plugin_preset?s.createElement("div",null,m(y.default.feedPresetModalNameFieldTitle),s.createElement("br",null),s.createElement("b",null,m(y.default.feedModalNameFieldTitleWarning))):s.createElement("div",null,m(y.default.feedModalNameFieldTitle),s.createElement("br",null),s.createElement("b",null,m(y.default.feedModalNameFieldTitleWarning))),placeholder:m(y.default.feedModalNameFieldPlaceholder),display:!0,disabled:!!M.plugin_preset,value:M.plugin_preset?M.plugin_preset.name:M.name,validator:[b]},descriptionField:M.plugin_preset&&{label:m(y.default.feedModalDescriptionFieldLabel),title:m(y.default.feedModalDescriptionFieldTitle),placeholder:m(y.default.feedModalDescriptionFieldPlaceholder),display:!0,disabled:!0,value:M.plugin_preset.description,validator:[b]},selectedTab:"configuration"})):S.length||i?s.createElement(g.EditContentLayout,a({paths:r(P&&P.pluginInstance),items:I,scrollId:"pluginForm"},A),s.createElement(p.default,{editionMode:!!i,organisationId:n,save:this.saveOrCreatePluginInstance,pluginProperties:S,disableFields:!(!w&&!c),pluginLayout:this.state.pluginLayout,isLoading:w||E,pluginVersionId:M.id,formId:"pluginForm",initialValues:this.formatInitialValues(P),showGeneralInformation:void 0===l||l,renderSpecificFields:d})):s.createElement(g.EditContentLayout,a({paths:r(P&&P.pluginInstance)},A),s.createElement(f.default,{onSelect:this.onSelectPlugin,availablePlugins:this.state.availablePlugins,listTitle:this.props.listTitle,listSubTitle:this.props.listSubTitle}))}}]),t}(s.Component);I([(0,S.lazyInject)(E.TYPES.IPluginService)],A.prototype,"_pluginService",void 0),t.default=(0,l.compose)(d.withRouter,u.injectIntl,b.withValidators,(0,c.connect)(void 0,{notifyError:m.notifyError}))(A)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({creativeModalConfirmArchivedTitle:{id:"creatives.display.list.modal.confirm.archived.title",defaultMessage:"Are you sure to archive this creative ?"},creativeModalConfirmArchivedContent:{id:"creatives.display.list.modal.confirm.archived.content",defaultMessage:"You can only archive creatives that haven't passed or failed the audit. If you have selected creatives wtih passed or failed audit status, please reset their audit status first before archiving."},creativeModalConfirmArchivedOk:{id:"creatives.display.list.modal.confirm.ok",defaultMessage:"Archive Now"},cancelText:{id:"creatives.display.list.modal.confirm.cancel",defaultMessage:"Cancel"},creativeModalNoArchiveTitle:{id:"creatives.display.list.modal.no.archive.title",defaultMessage:"Forbidden action"},creativeModalNoArchiveMessage:{id:"creatives.display.list.modal.no.archive.msg",defaultMessage:"You can't archive a creative in the audit status AUDIT_FAILED, AUDIT_PENDING or AUDIT_PASSED"},creativeModalSearchPlaceholder:{id:"creatives.display.list.modal.search.placeholder",defaultMessage:"Search Display Creative"},preview:{id:"creatives.display.list.column.preview",defaultMessage:"Preview"},name:{id:"creatives.display.list.column.name",defaultMessage:"Name"},auditStatus:{id:"creatives.display.list.column.auditStatus",defaultMessage:"Audit status"},publishedVersion:{id:"creatives.display.list.column.publishedVersion",defaultMessage:"Published version"},edit:{id:"creatives.display.list.actionColumn.edit",defaultMessage:"Edit"},archive:{id:"creatives.display.list.actionColumn.archive",defaultMessage:"Archive"},archiveSuccess:{id:"archive.creatives.success.msg",defaultMessage:"Creatives successfully archived"},archiveNativeSuccess:{id:"archive.native.success.msg",defaultMessage:"Native creative successfully archived"},searchPlaceholder:{id:"creative.native.list.searchPlaceholder",defaultMessage:"Search Native Creatives"},archiveEmailSuccess:{id:"archive.email.success.msg",defaultMessage:"Email templates successfully archived"},searchPlaceholderEmail:{id:"creative.email.list.searchPlaceholder",defaultMessage:"Search Email Templates"},sendTest:{id:"creative.email.list.sendTest",defaultMessage:"Send a test Email"},noDisplayCreative:{id:"creative.display.list.noCreative",defaultMessage:"No Display Creatives"},noNativeCreative:{id:"creative.native.list.noCreative",defaultMessage:"No Native Creatives"},noEmailTemplate:{id:"creative.email.list.noTemplate",defaultMessage:"No Email Templates"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.displayNameAdapted=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=c(n(23)),l=c(n(1123));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e){function t(){u(this,t);var e=d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.ellipsizeResourceName=function(e){return e.length>100?e.substring(0,100)+"...":e},e.displayId=function(){var t=e.props.resource;return t.name===t.id?r.createElement("span",null):r.createElement("span",null," ",t.id," - ")},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.resource,n=e.showId;return r.createElement("span",{title:t.name},n&&this.displayId()," ",this.ellipsizeResourceName(t.name))}}]),t}(r.Component),p=(0,o.compose)(i.injectIntl,s.default)(f);t.displayNameAdapted=function(){return(0,l.default)(p,(function(e){return{resource:e}}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(0,n(6).defineMessages)({processingActivities:{id:"settings.organisation.processings.processingActivities",defaultMessage:"Processing Activities"},id:{id:"settings.organisation.processings.list.id",defaultMessage:"ID"},name:{id:"settings.organisation.processings.list.name",defaultMessage:"Name"},purpose:{id:"settings.organisation.processings.list.purpose",defaultMessage:"Purpose"},legalBasis:{id:"settings.organisation.processings.list.legalBasis",defaultMessage:"Legal basis"},technicalName:{id:"settings.organisation.processings.list.technicalName",defaultMessage:"Technical name"},token:{id:"settings.organisation.processings.list.token",defaultMessage:"Token"},emptyProcessings:{id:"settings.organisation.processings.list.emptyProcessings",defaultMessage:"There are no processings."},editProcessing:{id:"settings.organisation.processings.list.editProcessing",defaultMessage:"Edit"},archiveProcessing:{id:"settings.organisation.processings.list.archiveProcessing",defaultMessage:"Archive"},deleteProcessing:{id:"settings.organisation.processings.list.deleteProcessing",defaultMessage:"Delete"},newProcessing:{id:"settings.organisation.processings.list.newProcessing",defaultMessage:"New Data Processing"},breadcrumbTitle:{id:"settings.organisation.processings.form.settings",defaultMessage:"Data Processings"},saveProcessing:{id:"settings.organisation.processings.form.save",defaultMessage:"Save"},legalBasisSectionTitle:{id:"settings.organisation.processings.form.sections.legalBasis.title",defaultMessage:"Legal Basis"},legalBasisSectionSubTitle:{id:"settings.organisation.processings.form.sections.legalBasis.subtitle",defaultMessage:"The legal basis of your processing activity"},legalBasisSectionLegalBasisLabel:{id:"settings.organisation.processings.form.sections.legalBasis.label",defaultMessage:"Legal basis"},legalBasisSectionLegalBasisTooltip:{id:"settings.organisation.processings.form.sections.legalBasis.tooltip",defaultMessage:"The lawful basis of the data processing (GDPR - Art. 6.1). Cannot be changed after the creation of the processing."},generalSectionTitle:{id:"settings.organisation.processings.form.sections.general.title",defaultMessage:"General Information"},generalSectionSubTitle:{id:"settings.organisation.processings.form.sections.general.subtitle",defaultMessage:"Give your processing a name and a purpose."},generalSectionNameLabel:{id:"settings.organisation.processings.form.sections.general.name.label",defaultMessage:"Name"},generalSectionNamePlaceholder:{id:"settings.organisation.processings.form.sections.general.name.placeholder",defaultMessage:"Data Processing Name"},generalSectionNameTooltip:{id:"settings.organisation.processings.form.sections.general.name.tooltip",defaultMessage:"Choose a short name to describe your processing. It will appear in dropdown lists to select a processing (audience segment creation, display campaign creation etc.), or when you read the user consents of a user."},generalSectionPurposeLabel:{id:"settings.organisation.processings.form.sections.general.purpose.label",defaultMessage:"Purpose"},generalSectionPurposePlaceholder:{id:"settings.organisation.processings.form.sections.general.purpose.placeholder",defaultMessage:"Data Processing Purpose"},generalSectionPurposeTooltip:{id:"settings.organisation.processings.form.sections.general.purpose.tooltip",defaultMessage:"The purpose of the current personal data processing (GDPR - Article 5.1.b)."},generalSectionAdvancedPartTitle:{id:"settings.organisation.processings.form.sections.general.advanced.title",defaultMessage:"Advanced"},generalSectionTechnicalNameLabel:{id:"settings.organisation.processings.form.sections.general.technicalName.label",defaultMessage:"Technical Name"},generalSectionTechnicalNamePlaceholder:{id:"settings.organisation.processings.form.sections.general.technicalName.placeholder",defaultMessage:"Technical Name"},generalSectionTechnicalNameTooltip:{id:"settings.organisation.processings.form.sections.general.technicalName.tooltip",defaultMessage:"The 'technical name' is an external key you can provide for a processing in order to retrieve it through API integrations."},generalSectionTokenLabel:{id:"settings.organisation.processings.form.sections.general.token.label",defaultMessage:"Token"},generalSectionTokenPlaceholder:{id:"settings.organisation.processings.form.sections.general.token.placeholder",defaultMessage:"Token"},generalSectionTokenTooltip:{id:"settings.organisation.processings.form.sections.general.token.tooltip",defaultMessage:"The 'token' is a random key you can use in non-authenticated integrations (such as javascript-based website tracking) to create user consents on a given user."},warningOnTokenEdition:{id:"settings.organisation.processings.form.sections.general.token.warning",defaultMessage:"Danger Zone: Editing this token may cause any web site data collection tag to fail if not updated properly. Please make sure you have updated all your tags before saving."},legalBasisTitle:{id:"settings.organisation.processings.form.legalBasis.title",defaultMessage:"Legal Basis"},legalBasisSubTitle:{id:"settings.organisation.processings.form.legalBasis.subtitle",defaultMessage:"Select the legal basis of your new Processing Activity. You will not be able to change it afterwards."},consentSubTitle:{id:"settings.organisation.processings.form.legalBasis.consent.subtitle",defaultMessage:"The data subject has given consent to the processing of his or her personal data for one or more specific purposes"},contractualPerformanceSubTitle:{id:"settings.organisation.processings.form.legalBasis.contractualPerformance.subtitle",defaultMessage:"Processing is necessary for the performance of a contract to which the data subject is party or in order to take steps at the request of the data subject prior to entering into a contract"},legalObligationSubTitle:{id:"settings.organisation.processings.form.legalBasis.legalObligation.subtitle",defaultMessage:"Processing is necessary for compliance with a legal obligation to which the controller is subject"},publicInterestSubTitle:{id:"settings.organisation.processings.form.legalBasis.publicInterest.subtitle",defaultMessage:"Processing is necessary for the performance of a task carried out in the public interest or in the exercise of official authority vested in the controller"},legitimateInterestSubTitle:{id:"settings.organisation.processings.form.legalBasis.legitimateInterest.subtitle",defaultMessage:"Processing is necessary for the purposes of the legitimate interests pursued by the controller or by a third party, except where such interests are overriden by the interests or fundamental rights and freedoms of the data subject which require protection of personal data, in particular where the data subject is a child. Shall not apply to processing carried out by public authorities in the performance of their tasks."},communityModalMessage:{id:"settings.organisation.processings.list.modal.community",defaultMessage:"Modification on Processings can only be done at community level. Please confirm to change the organisation you are browsing."},deleteModalMessage:{id:"settings.organisation.processings.list.modal.delete",defaultMessage:"Please confirm the deletion of processing with id"}});t.default=a},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(6),l=n(976),c=(a=l)&&a.__esModule?a:{default:a},u=n(107),d=n(11);function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){f(this,t);var e=p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.renderDropdownButton=function(){var t=e.props.dropdownItems,n=t&&t.map((function(e){return o.createElement(i.Menu.Item,{key:e.id,disabled:e.disabled},o.createElement(s.FormattedMessage,e.message))})),a=o.createElement(i.Menu,{className:"mcs-dropdown-actions",onClick:function(e){(t&&t.find((function(t){return t.id===e.key}))).onClick()}},n);return o.createElement(u.Dropdown,{overlay:a,trigger:["click"]},o.createElement(i.Button,null,o.createElement(d.McsIcon,{type:"pen"}),o.createElement(d.McsIcon,{type:"chevron"})))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.subtitle,a=e.button,r=e.dropdownItems,s=24-3*((a?1:0)+(r?1:0)),l=(!!a||!!r)&&o.createElement(i.Col,{span:24-s,className:"section-header-buttons"},a&&o.createElement(i.Button,{onClick:a.onClick,disabled:a.disabled},a.message),r&&this.renderDropdownButton());return o.createElement(i.Row,{align:"middle",justify:"space-between",className:"section-header"},o.createElement(i.Col,{span:s},o.createElement(c.default,{title:t,subtitle:n})),l)}}]),t}(o.Component);t.default=m},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_DATE_FORMAT=void 0,t.areDatesSameDay=function(e,t){return e.format("YYYY-MM-DD")===t.format("YYYY-MM-DD")},t.formatUnixTimestamp=function(e,t){return e?(0,o.default)(e).format(t||i):"--/--/----"},t.truncateUpToHour=function(e,t){t?(e.setHours(t),e.setMinutes(0),e.setSeconds(0)):(e.setHours(0),e.setMinutes(0),e.setSeconds(0))};var a,r=n(17),o=(a=r)&&a.__esModule?a:{default:a};var i=t.DEFAULT_DATE_FORMAT="DD/MM/YYYY"},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatToFormattingFunction=function(e,t,n){switch(t){case"STRING":return e;case"FLOAT":return(0,s.formatMetric)(e,"0.00");case"INTEGER":return(0,s.formatMetric)(e,"0");case"DATE":return(0,i.default)(e,"x").format("DD-MM-YYYY");case"TIMESTAMP":return(0,i.default)(e,"x").format("DD-MM-YYYY HH:mm:ss");case"MESSAGE":return n?r.createElement(l.FormattedMessage,n[e]):e}};var a,r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(17),i=(a=o)&&a.__esModule?a:{default:a},s=n(56),l=n(6)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegendChartWithModal=t.LegendChart=void 0;var a=o(n(2042)),r=o(n(2043));function o(e){return e&&e.__esModule?e:{default:e}}t.LegendChart=a.default,t.LegendChartWithModal=r.default},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({save:{id:"queryDocument.actionBar.save",defaultMessage:"Update"},objectNodeTitle:{id:"queryDocument.objectNode.title",defaultMessage:"Object Node"},objectNodeSubTitle:{id:"queryDocument.objectNode.subtitle",defaultMessage:"Configure your object's properties"},objectNodeFieldLabel:{id:"queryDocument.objectNode.field.label",defaultMessage:"Type"},objectNodeFieldPlaceholder:{id:"queryDocument.objectNode.field.placeholder",defaultMessage:"Type"},objectNodeFieldTooltip:{id:"queryDocument.objectNode.field.tooltip",defaultMessage:"Enter the type of the object you want to base your query upon"},objectNodeMinScoreLabel:{id:"queryDocument.objectNode.minScore.label",defaultMessage:"Frequency"},objectNodeMinScorePlaceholder:{id:"queryDocument.objectNode.minScore.placeholder",defaultMessage:"Frequency"},objectNodeMinScoreTooltip:{id:"queryDocument.objectNode.minScore.tooltip",defaultMessage:"Select the Frequency you want to cap."},fieldConditionAdditionButton:{id:"queryDocument.fieldCondition.addition.button",defaultMessage:"Add a Field Condition"},fieldConditionTitle:{id:"queryDocument.fieldCondition.title",defaultMessage:"Field Conditions"},fieldConditionSubTitle:{id:"queryDocument.fieldCondition.subtitle",defaultMessage:"Add Field Conditions to the selected object"},fieldConditionFieldLabel:{id:"queryDocument.fieldCondition.field.label",defaultMessage:"Field Name"},fieldConditionConditionLabel:{id:"queryDocument.fieldCondition.condition.label",defaultMessage:"Condition"},fieldConditionValuesLabel:{id:"queryDocument.fieldCondition.values.label",defaultMessage:"Field Values"},fieldConditionValuesNumberLabel:{id:"queryDocument.fieldCondition.valuesNumbers.label",defaultMessage:"Field Values (Numbers Only)"},fieldConditionValuesStringLabel:{id:"queryDocument.fieldCondition.valuesString.label",defaultMessage:"Field Values (Strings)"},fieldConditionMultiValuesTooltip:{id:"queryDocument.fieldCondition.multivalues.tooltip",defaultMessage:"The query will be evaluated to match at least one of the values."},fieldConditionValuesTooltip:{id:"queryDocument.fieldCondition.values.tooltip",defaultMessage:"The query will be evaluated to match your value."},fieldConditionBooleanOperatorTitle:{id:"queryDocument.fieldCondition.booleanOperator.title",defaultMessage:"Operator"},fieldTypeNotSupported:{id:"queryDocument.fieldCondition.fieldTypeNotSupported.title",defaultMessage:"Field Type Not Supported"},EQ:{id:"queryDocument.fieldCondition.condition.EQ",defaultMessage:"Equals"},NOT_EQ:{id:"queryDocument.fieldCondition.condition.NOT_EQ",defaultMessage:"Does Not Equal"},MATCHES:{id:"queryDocument.fieldCondition.condition.MATCHES",defaultMessage:"Matches"},DOES_NOT_MATCH:{id:"queryDocument.fieldCondition.condition.DOES_NOT_MATCH",defaultMessage:"Does Not Match"},STARTS_WITH:{id:"queryDocument.fieldCondition.condition.STARTS_WITH",defaultMessage:"Starts With"},DOES_NOT_START_WITH:{id:"queryDocument.fieldCondition.condition.DOES_NOT_START_WITH",defaultMessage:"Does Not Start With"},CONTAINS:{id:"queryDocument.fieldCondition.condition.CONTAINS",defaultMessage:"Contains"},DOES_NOT_CONTAIN:{id:"queryDocument.fieldCondition.condition.DOES_NOT_CONTAIN",defaultMessage:"Does Not Contain"},BEFORE:{id:"queryDocument.fieldCondition.condition.BEFORE",defaultMessage:"Before"},BEFORE_OR_EQUAL:{id:"queryDocument.fieldCondition.condition.BEFORE_OR_EQUAL",defaultMessage:"Before Or Equal"},AFTER:{id:"queryDocument.fieldCondition.condition.AFTER",defaultMessage:"After"},AFTER_OR_EQUAL:{id:"queryDocument.fieldCondition.condition.AFTER_OR_EQUAL",defaultMessage:"After Or Equal"},EQUAL:{id:"queryDocument.fieldCondition.condition.EQUAL",defaultMessage:"Equals"},NOT_EQUAL:{id:"queryDocument.fieldCondition.condition.NOT_EQUAL",defaultMessage:"Does Not Equal"},LT:{id:"queryDocument.fieldCondition.condition.LT",defaultMessage:"Is Less Than"},LTE:{id:"queryDocument.fieldCondition.condition.LTE",defaultMessage:"Is Less Than Or Equals To"},GT:{id:"queryDocument.fieldCondition.condition.GT",defaultMessage:"Is Greater Than"},GTE:{id:"queryDocument.fieldCondition.condition.GTE",defaultMessage:"Is Greater Than Or Equals"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSONQLBuilderContext=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));var r={query:void 0,schema:void 0,isTrigger:!1,isEdge:!1,runFieldProposal:function(e){return Promise.resolve([])}};t.JSONQLBuilderContext=a.createContext(r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=h(n(162)),s=n(13),l=n(8),c=n(24),u=h(n(1101)),d=n(183),f=h(n(47)),p=h(n(2284)),m=n(10),g=n(11),y=n(33);function h(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var _=function(e){function t(){v(this,t);var e=b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.updateProcessingActivities=function(t){var n=e.props,a=n.fields,r=n.formChange,o=t.map((function(e){return{key:(0,f.default)(),model:e}}));r(a.name,o),e.props.closeNextDrawer()},e.openProcessingActivitySelector=function(){var t=e.props,n=t.fields,a=t.openNextDrawer,r={selectedProcessingActivityIds:n.getAll().map((function(e){return e.model.id})),close:e.props.closeNextDrawer,save:e.updateProcessingActivities};a(p.default,{additionalProps:r})},e.getProcessingActivityRecords=function(){var t=e.props,n=t.fields,a=t.disabled,o=function(e){return e.model.name},i=function(e){var t=e.model.legal_basis;return t?r.createElement("span",null,t):null};return n.getAll().map((function(e,t){return r.createElement(d.RecordElement,{key:e.key,recordIconType:"users",record:e,title:o,additionalData:i,onRemove:function(){return n.remove(t)},editable:void 0===a||!1===a})}))},e.isWarningNeeded=function(){var t=e.props,n=t.fields,a=t.initialProcessingSelectionsForWarning,r=t.processingsAssociatedType;if("SEGMENT"===r||"SEGMENT-EDGE"===r||"COMPARTMENT"===r||"ADD-TO-SEGMENT-AUTOMATION"===r)return!1;if(a){var o=a.map((function(e){return e.processing_id})),i=n.getAll().map((function(e,t){return e.model.id}));return!(o.length===i.length&&o.every((function(e){return i.includes(e)})))}return!1},e.getSectionSubTitle=function(){var t=e.props,n=t.processingsAssociatedType,a=t.match.params.organisationId;return"SEGMENT"===n||"SEGMENT-EDGE"===n?u.default.processingActivitiesForSegmentsSectionSubtitle:"COMPARTMENT"===n?u.default.processingActivitiesForCompartmentsSectionSubtitle:"ADD-TO-SEGMENT-AUTOMATION"===n?Object.assign(Object.assign({},u.default.addToSegmentAutomationSectionSubtitle),{values:{organisationSettings:r.createElement(y.Link,{to:"/v2/o/"+a+"/settings/organisation/processings",target:"_blank"},r.createElement(o.FormattedMessage,u.default.organisationSettings))}}):u.default.processingActivitiesForChannelsSectionSubtitle},e.getSectionTitle=function(){var t=e.props.processingsAssociatedType;return"SEGMENT"===t||"SEGMENT-EDGE"===t||"ADD-TO-SEGMENT-AUTOMATION"===t?u.default.processingActivitiesForSegmentsSectionTitle:u.default.processingActivitiesForChannelsOrCompartmentsSectionTitle},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.processingsAssociatedType,a=e.disabled,o=this.getSectionSubTitle(),i=this.getSectionTitle(),s=this.isWarningNeeded()?r.createElement("div",{className:"optional-section-content"},r.createElement(m.Alert,{message:r.createElement("div",null,r.createElement(g.McsIcon,{type:"warning"}),t(u.default.warningProcessingActivitiesForChannels)),type:"warning"})):null,l="SEGMENT-EDGE"===n||a?void 0:[{id:u.default.dropdownAddProcessingActivity.id,message:u.default.dropdownAddProcessingActivity,onClick:this.openProcessingActivitySelector}],f=r.createElement(d.RelatedRecords,{emptyOption:{iconType:"users",message:t("SEGMENT-EDGE"===n?u.default.processingActivitiesForEdge:u.default.processingActivitiesEmptySection)}},"SEGMENT-EDGE"===n?[]:this.getProcessingActivityRecords());return r.createElement("div",null,r.createElement(c.FormSection,{dropdownItems:l,subtitle:o,title:i}),f,s)}}]),t}(r.Component);t.default=(0,l.compose)(o.injectIntl,s.withRouter,i.default)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(24),l=y(n(49)),c=n(6),u=y(n(162)),d=n(13),f=n(628),p=n(8),m=y(n(836)),g=n(11);function y(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.generateFormField=function(e){var t=n.props,r=t.organisationId,i=t.pluginVersionId,s=t.pluginProperties,l=t.pluginPresetProperties,c=t.noUploadModal,u=t.disableFields,d=t.small,p=s.find((function(t){return t.technical_name===e.property_technical_name})),m=l?l.find((function(t){return t.technical_name===e.property_technical_name})):void 0;return void 0!==p?o.createElement("div",{key:e.property_technical_name},o.createElement(f.PluginFieldGenerator,a({definition:p,pluginLayoutFieldDefinition:e,pluginPresetProperty:m,organisationId:r,pluginVersionId:i,disabled:u,small:d},c))):null},n.toggleAdvancedFields=function(){var e=n.state.displayAdvancedFields;n.setState({displayAdvancedFields:!e})},n.state={displayAdvancedFields:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"generateNameAndDescriptionFields",value:function(){var e=this,t=this.props,n=t.nameField,a=t.descriptionField,r=this.state.descriptionFieldValue,l=[];return n&&n.display&&l.push(o.createElement("div",{key:"nameField"},o.createElement(i.Row,null,o.createElement(s.FormInputField,{key:"name",name:"plugin.name",component:s.FormInput,formItemProps:{label:n.label,required:!0},inputProps:n.disabled?{placeholder:n.placeholder,disabled:n.disabled,value:n.value}:{placeholder:n.placeholder,disabled:n.disabled},small:!0,helpToolTipProps:{title:n.title},validate:n.disabled?[]:n.validator})))),a&&a.display&&l.push(o.createElement("div",{key:"descriptionField"},o.createElement(i.Row,null,o.createElement(s.FormTextAreaField,{key:"description",name:"description",component:s.FormTextArea,formItemProps:{label:a.label,required:!0},inputProps:a.disabled?{placeholder:a.placeholder,disabled:a.disabled,value:a.value}:{placeholder:a.placeholder,disabled:a.disabled,value:r,onChange:function(t){return e.setState({descriptionFieldValue:t.target.value})}},small:!0,helpToolTipProps:{title:a.title},validate:a.disabled?[]:a.validator})))),l}},{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.pluginLayoutSection,a=e.nameField,r=e.descriptionField,l=this.generateNameAndDescriptionFields(),c=n.fields.map(this.generateFormField),u=null!==n.advanced_fields&&0!==n.advanced_fields.length?o.createElement("div",null,o.createElement(g.Button,{className:"optional-section-title",onClick:this.toggleAdvancedFields},o.createElement(g.McsIcon,{type:"settings"}),o.createElement("span",{className:"step-title"},t(m.default.advanced)),o.createElement(g.McsIcon,{type:"chevron"})),o.createElement("div",{className:this.state.displayAdvancedFields?"optional-section-content":"hide-section"},n.advanced_fields.map(this.generateFormField))):null;return c.length>0||u||a||r?o.createElement("div",{id:n.title},o.createElement(i.Row,{align:"middle",justify:"space-between",className:"section-header"},o.createElement(s.FormTitle,{title:{id:"section."+n.title+".title",defaultMessage:n.title},subtitle:{id:"section."+n.sub_title+".subTitle",defaultMessage:n.sub_title}})),l,c,u):null}}]),t}(o.Component);t.default=(0,p.compose)(c.injectIntl,d.withRouter,u.default,l.default)(h)},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({contentAutoMatchType:{id:"settings.form.eventRules.catalog.automatch.label",defaultMessage:"Auto Match Type"},contentAutoMatchTooltip:{id:"settings.form.eventRules.catalog.automatch.tooltip",defaultMessage:"Match URL with Product and/or Categories URL"},contentUserIdentifierLabel:{id:"settings.form.eventRules.userIdentifier.label",defaultMessage:"Property"},contentUserIdentifierPlaceholder:{id:"settings.form.eventRules.userIdentifier.placeholder",defaultMessage:"Property"},contentUserIdentifierTooltip:{id:"settings.form.eventRules.userIdentifier.tooltip",defaultMessage:"The name of the property containing the data used to compute the user identifier"},contentProperty2OriginPropertyNameLabel:{id:"settings.form.eventRules.property2Origin.propertyName.label",defaultMessage:"Property Name"},contentProperty2OriginPropertyNamePlaceholder:{id:"settings.form.eventRules.userIdentifier.propertyName.placeholder",defaultMessage:"Property Name"},contentProperty2OriginPropertyNameTooltip:{id:"settings.form.eventRules.userIdentifier.propertyName.tooltip",defaultMessage:"The name of the property containing the data"},contentProperty2OriginPropertySourceLabel:{id:"settings.form.eventRules.property2Origin.propertySource.label",defaultMessage:"Property Source"},contentProperty2OriginPropertySourcePlaceholder:{id:"settings.form.eventRules.userIdentifier.propertySource.placeholder",defaultMessage:"Property Source"},contentProperty2OriginPropertySourceTooltip:{id:"settings.form.eventRules.userIdentifier.propertySource.tooltip",defaultMessage:"The source of the property to copy"},contentProperty2OriginDestinationLabel:{id:"settings.form.eventRules.property2Origin.destination.label",defaultMessage:"Destination"},contentProperty2OriginDestinationPlaceholder:{id:"settings.form.eventRules.userIdentifier.destination.placeholder",defaultMessage:"Destination"},contentProperty2OriginDestinationTooltip:{id:"settings.form.eventRules.userIdentifier.destination.tooltip",defaultMessage:"The destination where to copy the property"},userIdInsertRuleHashFunctionSelectLabel:{id:"settings.form.eventRules.userIdentifier.hashfunction.select.label",defaultMessage:"Hash function"},userIdInsertRuleHashFunctionSelectTooltop:{id:"settings.form.eventRules.userIdentifier.hashfunction.select.tooltip",defaultMessage:"The hash function to use on the property value"},userIdInsertRuleCompartmentSelectLabel:{id:"settings.form.eventRules.userIdentifier.compartment.select.label",defaultMessage:"Compartment"},userIdInsertRuleCompartmentSelectTooltip:{id:"settings.form.eventRules.userIdentifier.compartment.select.tooltip",defaultMessage:"The user account compartment to use"},userIdInsertRuleCompartmentSelectDefault:{id:"settings.form.eventRules.userIdentifier.compartment.select.default",defaultMessage:"Default compartment"},contentUriMatchPatternLabel:{id:"settings.form.eventRules.uriMatch.destination.label",defaultMessage:"URL Pattern"},contentUriMatchPatternPlaceholder:{id:"settings.form.eventRules.uriMatch.destination.placeholder",defaultMessage:"URL Pattern"},contentUriMatchPatternTooltip:{id:"settings.form.eventRules.uriMatch.destination.tooltip",defaultMessage:"The matching url pattern"},contentUriMatchEventNameLabel:{id:"settings.form.eventRules.uriMatch.eventName.label",defaultMessage:"Event Name"},contentUriMatchEventNamePlaceholder:{id:"settings.form.eventRules.uriMatch.eventName.placeholder",defaultMessage:"Event Name"},contentUriMatchEventNameTooltip:{id:"settings.form.eventRules.uriMatch.eventName.tooltip",defaultMessage:"The name of the event"},AddFilterButtonText:{id:"settings.form.eventRules.uriMatch.eventName.addProperty",defaultMessage:"Add Property"},contentUriMatchPropertyNamePlaceholder:{id:"settings.form.eventRules.uriMatch.eventName.propertyname",defaultMessage:"Property Name"},contentUriMatchPropertyValuePlaceholder:{id:"settings.form.eventRules.uriMatch.eventName.propertyvalue",defaultMessage:"Property Value"},contentUriMatchPropertyLabel:{id:"settings.form.eventRules.uriMatch.eventName.property",defaultMessage:"Property"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({userEventBreadcrumbTitle:{id:"settings.cleaningRules.userEvent.form.settings",defaultMessage:"User Event Cleaning Rule"},userProfileBreadcrumbTitle:{id:"settings.cleaningRules.userProfile.form.settings",defaultMessage:"User Profile Cleaning Rule"},errorFormMessage:{id:"settings.cleaningRules.userEvent.form.errorMessage",defaultMessage:"There is an error with the data you have inputed. Please check."},sectionActionTitle:{id:"settings.cleaningRules.form.action.title",defaultMessage:"Action"},sectionActionUserEventSubTitle:{id:"settings.cleaningRules.userEvent.form.action.subtitle",defaultMessage:"Define if your Cleaning Rule will keep or delete the user events in scope after the configured Duration."},sectionActionUserProfileSubTitle:{id:"settings.cleaningRules.userProfile.form.action.subtitle",defaultMessage:"Define if your Cleaning Rule will keep or delete the User Activities & User Events in scope."},sectionActionLabel:{id:"settings.cleaningRules.form.action.label",defaultMessage:"Action"},sectionActionUserEventHelper:{id:"settings.cleaningRules.userEvent.form.action.helper",defaultMessage:"DELETE: the events in scope will expire and be deleted after the configured duration. KEEP: the cleaning rule will preserve the events  in scope from deletion for the configured duration."},sectionActionUserProfileHelper:{id:"settings.cleaningRules.userProfile.form.action.helper",defaultMessage:"DELETE: the profiles in scope will expire and be deleted after the configured duration. KEEP: Not available for User Profile Cleaning Rules."},sectionScopeTitle:{id:"settings.cleaningRules.form.scope.title",defaultMessage:"Scope"},sectionScopeUserEventSubTitle:{id:"settings.cleaningRules.userEvent.form.scope.subtitle",defaultMessage:"Define the scope of the Cleaning Rule using three optional filters : Activity Type, Channel and Event name."},sectionScopeUserProfileSubTitle:{id:"settings.cleaningRules.userProfile.form.scope.subtitle",defaultMessage:"Define the scope of the Cleaning Rule using an optional Compartment filter."},sectionScopeActivityTypeLabel:{id:"settings.cleaningRules.userEvent.form.scope.activityType.label",defaultMessage:"Activity Type Filter"},sectionScopeActivityTypeAllTypes:{id:"settings.cleaningRules.userEvent.form.scope.activityType.all",defaultMessage:"All"},sectionScopeActivityTypeHelper:{id:"settings.cleaningRules.userEvent.form.scope.activityType.helper",defaultMessage:"This filter can be used to target User Events embedded in a particular type of User Activity (field $type of the User Activity)."},sectionScopeChannelLabel:{id:"settings.cleaningRules.userEvent.form.scope.channel.label",defaultMessage:"Channel Filter"},sectionScopeChannelHelper:{id:"settings.cleaningRules.userEvent.form.scope.channel.helper",defaultMessage:"This filter can be used to target User Events related to a given channel (field $site_id or $app_id of the User Activity)."},sectionScopeEventNameLabel:{id:"settings.cleaningRules.userEvent.form.scope.eventName.label",defaultMessage:"Event Name Filter"},sectionScopeEventNameHelper:{id:"settings.cleaningRules.userEvent.form.scope.eventName.helper",defaultMessage:"This filter can be used to target User Events with a specific name (field $event_name of the User Event)."},sectionScopeCompartmentLabel:{id:"settings.cleaningRules.userProfile.form.scope.channel.label",defaultMessage:"Compartment Filter"},sectionScopeCompartmentHelper:{id:"settings.cleaningRules.userProfile.form.scope.channel.helper",defaultMessage:"This filter can be used to target User Profiles related to a given user account compartment."},sectionDatamartTitle:{id:"settings.cleaningRules.form.datamart.title",defaultMessage:"Datamart"},saveUserEventCleaningRule:{id:"settings.cleaningRules.userEvent.form.saveCleaningRule",defaultMessage:"Save User Event Cleaning Rule"},saveUserProfileCleaningRule:{id:"settings.cleaningRules.userProfile.form.saveCleaningRule",defaultMessage:"Save User Profile Cleaning Rule"},invalidLifeDuration:{id:"settings.cleaningRules.form.invalidLifeDuration",defaultMessage:"Invalid life duration"},cleaningRuleLifeDurationDays:{id:"settings.cleaningRules.form.cleaningRuleLifeDurationDays",defaultMessage:"Days"},noFilter:{id:"settings.cleaningRules.form.noFilter",defaultMessage:"No filter"}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetLabels=t.fetchAllLabels=void 0;var a=n(247),r=n(104),o={request:function(e){return(0,a.createAction)(r.LABELS_FETCH.REQUEST)({organisationId:e})},success:(0,a.createAction)(r.LABELS_FETCH.SUCCESS),failure:(0,a.createAction)(r.LABELS_FETCH.FAILURE)},i=(0,a.createAction)(r.LABELS_RESET);t.fetchAllLabels=o,t.resetLabels=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isUserPointIdentifier=function(e){return"USER_POINT"===e.type},t.isUserAccountIdentifier=function(e){return"USER_ACCOUNT"===e.type},t.isUserAgentIdentifier=function(e){return"USER_AGENT"===e.type},t.isUserEmailIdentifier=function(e){return"USER_EMAIL"===e.type}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildFeedCardStatsRequestBody=function(e){var t={operator:"OR",filters:[{dimension_name:"AUDIENCE_SEGMENT_ID",operator:"EXACT",expressions:[e]}]},n=(0,r.formatMcsDate)({from:new o.default("now-7d"),to:new o.default("now")},!0);return i({start_date:n.from,end_date:n.to},["FEED_ID"],t,["UNIQ_USER_POINTS_COUNT","UNIQ_USER_IDENTIFIERS_COUNT"])},t.buildFeedStatsByFeedRequestBody=function(e,t,n){return i(t,["FEED_ID","DAY","SYNC_TYPE"],{operator:"OR",filters:[{dimension_name:"FEED_ID",operator:"EXACT",expressions:[e]}]},n||["UNIQ_USER_POINTS_COUNT"])},t.getFeedStatsUnit=function(e){return"com.mediarithmics.audience.externalfeed"!==e.group_id||"google-ddp-connector"!==e.artifact_id&&"appnexus-audience-segment-feed-direct"!==e.artifact_id&&"appnexus-audience-segment-feed"!==e.artifact_id?"TAG_FEED"===e.type?"USER_IDENTIFIERS":"USER_POINTS":"USER_IDENTIFIERS"};var a,r=n(81),o=(a=r)&&a.__esModule?a:{default:a};function i(e,t,n,a){return{date_ranges:[e],dimensions:t.map((function(e){return{name:e}})),dimension_filter_clauses:n,metrics:a.map((function(e){return{expression:e}}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INITIAL_EMAIL_BLAST_FORM_DATA={blast:{},templateFields:[],consentFields:[],segmentFields:[]},t.INITIAL_EMAIL_CAMPAIGN_FORM_DATA={campaign:{},blastFields:[],routerFields:[]}},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatCampaignProperty=t.formatEmailBlastProperty=void 0;var a=n(6),r=n(414);t.default=(0,a.defineMessages)({id:{id:"email.campaign.actionBar.id",defaultMessage:"Id"},email:{id:"email.campaign.actionBar.email",defaultMessage:"Email"},history:{id:"email.campaign.actionBar.history",defaultMessage:"History"},emailSent:{id:"email.metrics.email_sent",defaultMessage:"Sent"},emailHardBounced:{id:"email.metrics.email_hard_bounced",defaultMessage:"Hard Bounced"},emailSoftBounced:{id:"email.metrics.email_soft_bounced",defaultMessage:"Soft Bounced"},clicks:{id:"email.metrics.clicks",defaultMessage:"Clicks"},impressions:{id:"email.metrics.impressions",defaultMessage:"Impressions"},emailUnsubscribed:{id:"email.metrics.email_unsubscribed",defaultMessage:"Unsubscribed"},emailComplaints:{id:"email.metrics.email_complaints",defaultMessage:"Complaints"},uniqImpressions:{id:"email.metrics.unique_impressions",defaultMessage:"Unique Impressions"},uniqClicks:{id:"email.metrics.unique_clicks",defaultMessage:"Unique Clicks"},uniqEmailSent:{id:"email.metrics.unique_email_sent",defaultMessage:"Unique Sent"},uniqEmailUnsubscribed:{id:"email.metrics.unique_email_unsubscribed",defaultMessage:"Unique Unsubscribed"},uniqEmailHardBounced:{id:"email.metrics.unique_email_hard_bounced",defaultMessage:"Unique Hard Bounced"},uniqEmailSoftBounced:{id:"email.metrics.unique_email_soft_bounced",defaultMessage:"Unique Soft Bounced"},uniqEmailComplaints:{id:"email.metrics.unique_email_complaints",defaultMessage:"Unique Complaints"},batchSize:{id:"email.blast.metrics.id",defaultMessage:"Id"},blastName:{id:"email.blast.metrics.batch_size",defaultMessage:"Blast Name"},fromEmail:{id:"email.blast.metrics.blast_name",defaultMessage:"From Email"},fromName:{id:"email.blast.metrics.from_email",defaultMessage:"From Name"},numberEmailNotSent:{id:"email.blast.metrics.number_email_not_sent",defaultMessage:"Number Of Email Not Sent"},replyTo:{id:"email.blast.metrics.reply_to",defaultMessage:"Reply To"},sendDate:{id:"email.blast.metrics.send_date",defaultMessage:"Send Date"},status:{id:"email.blast.metrics.status",defaultMessage:"Status"},subjectLine:{id:"email.blast.metrics.subject_line",defaultMessage:"Subject Line"}});var o=(0,a.defineMessages)({SCENARIO_ACTIVATED:{id:"emailBlast.fields.status.scenarioActivated",defaultMessage:"Scenario Activation"},PENDING:{id:"emailBlast.fields.status.pending",defaultMessage:"Pending"},SCHEDULED:{id:"emailBlast.fields.status.scheduled",defaultMessage:"Scheduled"},FINISHED:{id:"emailBlast.fields.status.finished",defaultMessage:"Finished"},ERROR:{id:"emailBlast.fields.status.error",defaultMessage:"Error"}}),i=(0,a.defineMessages)({id:{id:"emailBlast.fields.id",defaultMessage:"ID"},blast_name:{id:"emailBlast.fields.blastName",defaultMessage:"Blast name"},send_date:{id:"emailBlast.fields.sendDate",defaultMessage:"Send date"},subject_line:{id:"emailBlast.fields.subjectLine",defaultMessage:"Subject"},from_email:{id:"emailBlast.fields.fromEmail",defaultMessage:"From email"},from_name:{id:"emailBlast.fields.fromName",defaultMessage:"From name"},reply_to:{id:"emailBlast.fields.replyTo",defaultMessage:"Reply to"},status:{id:"emailBlast.fields.status",defaultMessage:"Status"},number_mail_not_send:{id:"emailBlast.fields.numberMailNotSend",defaultMessage:"Number Of Mail Not Send"},batch_size:{id:"emailBlast.fields.batchSize",defaultMessage:"Batch Size"},history_title:{id:"emailBlast.resourceHistory.title",defaultMessage:"Email Blast History"},history_resource_type:{id:"emailBlast.resourceHistory.type",defaultMessage:"Email Blast"}}),s={id:{format:"STRING"},blast_name:{format:"STRING"},send_date:{format:"TIMESTAMP"},subject_line:{format:"STRING"},from_email:{format:"STRING"},from_name:{format:"STRING"},reply_to:{format:"STRING"},status:{format:"MESSAGE",messageMap:o},number_mail_not_send:{format:"INTEGER"},batch_size:{format:"INTEGER"},history_title:{format:"STRING"},history_resource_type:{format:"STRING"}},l=(t.formatEmailBlastProperty=function(e,t){return{message:i[e],formattedValue:t&&s[e]?(0,r.formatToFormattingFunction)(t,s[e].format,s[e].messageMap):void 0}},(0,a.defineMessages)({ACTIVE:{id:"campaign.email.fields.status.active",defaultMessage:"Active"},PENDING:{id:"campaign.email.fields.status.pending",defaultMessage:"Pending"},PAUSED:{id:"campaign.email.fields.status.paused",defaultMessage:"Paused"},ARCHIVED:{id:"campaign.email.fields.status.archived",defaultMessage:"Archived"}})),c=(0,a.defineMessages)({id:{id:"campaign.email.fields.id",defaultMessage:"ID"},status:{id:"campaign.email.fields.status",defaultMessage:"Status"},archived:{id:"campaign.email.fields.archived",defaultMessage:"Archived"},organisation_id:{id:"campaign.email.fields.organisationId",defaultMessage:"Organisation ID"},name:{id:"campaign.email.fields.name",defaultMessage:"Name"},creation_ts:{id:"campaign.email.fields.creationTs",defaultMessage:"Creation Timestamp"},editor_version_id:{id:"campaign.email.fields.editorVersionId",defaultMessage:"Editor Version ID"},editor_version_value:{id:"campaign.email.fields.editorVersionValue",defaultMessage:"Editor Version Value"},editor_group_id:{id:"campaign.email.fields.editorGroupId",defaultMessage:"Editor Group ID"},editor_artifact_id:{id:"campaign.email.fields.editorArtifactId",defaultMessage:"Editor Artifact ID"},currency_code:{id:"campaign.email.fields.currencyCode",defaultMessage:"Currency Code"},technical_name:{id:"campaign.email.fields.technicalName",defaultMessage:"Technical Name"},type:{id:"campaign.email.fields.type",defaultMessage:"Type"},automated:{id:"campaign.email.fields.automated",defaultMessage:"Automated"},history_title:{id:"campaign.email.resourceHistory.title",defaultMessage:"Email Campaign History"},history_resource_type:{id:"campaign.email.resourceHistory.type",defaultMessage:"Email Campaign"}}),u={id:{format:"STRING"},status:{format:"MESSAGE",messageMap:l},archived:{format:"STRING"},organisation_id:{format:"STRING"},name:{format:"STRING"},creation_ts:{format:"TIMESTAMP"},editor_version_id:{format:"STRING"},editor_version_value:{format:"STRING"},editor_group_id:{format:"STRING"},editor_artifact_id:{format:"STRING"},currency_code:{format:"STRING"},technical_name:{format:"STRING"},type:{format:"STRING"},automated:{format:"STRING"},history_title:{format:"STRING"},history_resource_type:{format:"STRING"}};t.formatCampaignProperty=function(e,t){return{message:c[e],formattedValue:t&&u[e]?(0,r.formatToFormattingFunction)(t,u[e].format,u[e].messageMap):void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=n(6),r=t.messages=(0,a.defineMessages)({searchPlaceholder:{id:"campaign.email.search.placeholder",defaultMessage:"Search Email Campaigns"},emailId:{id:"campaign.email.id",defaultMessage:"Id"},emailHeaderStatus:{id:"campaign.email.status",defaultMessage:"Status"},emailHeaderName:{id:"campaign.email.name",defaultMessage:"Name"},emailTechnicalName:{id:"campaign.email.technicalName",defaultMessage:"Technical Name"},emailHeaderSent:{id:"campaign.email.email_sent",defaultMessage:"Emails sent"},emailHeaderHardBounced:{id:"campaign.email.email_hard_bounced",defaultMessage:"Emails hard bounced"},emailHeaderSoftBounced:{id:"campaign.email.email_soft_bounced",defaultMessage:"Emails soft bounced"},emailHeaderClicks:{id:"campaign.email.clicks",defaultMessage:"Clicks"},emailHeaderImpressions:{id:"campaign.email.impressions",defaultMessage:"Imp"},PAUSED:{id:"campaign.email.status.paused",defaultMessage:"Paused"},ACTIVE:{id:"campaign.email.status.active",defaultMessage:"Active"},PENDING:{id:"campaign.email.status.pending",defaultMessage:"Pending"},ARCHIVED:{id:"campaign.email.status.archived",defaultMessage:"Archived"},editCampaign:{id:"campaign.email.edit",defaultMessage:"Edit"},archiveCampaign:{id:"campaign.email.archive",defaultMessage:"Archive"},emails:{id:"campaign.email.list.actionbar.breadCrumbPath.emails",defaultMessage:"Emails"},exportInProgress:{id:"campaign.email.list.actionbar.exportInProgress",defaultMessage:"Export in progress..."},emailCampaignsExportTitle:{id:"campaign.email.list.export.title",defaultMessage:"Email Campaigns Export"},confirmArchiveModalTitle:{id:"campaign.email.archive.confirm_modal.title",defaultMessage:"Are you sure you want to archive this Campaign ?"},confirmArchiveModalContent:{id:"campaign.email.archive.confirm_modal.content",defaultMessage:"By archiving this Campaign all its activities will be suspended. You'll be able to recover it from the archived campaign filter."},confirmArchiveModalOk:{id:"campaign.email.archive.confirm_modal.ok",defaultMessage:"Archive now"},confirmArchiveModalCancel:{id:"campaign.email.archive.confirm_modal.cancel",defaultMessage:"Cancel"},fetchReportError:{id:"campaign.email.error.fetch-report",defaultMessage:"Cannot load campaign statistics"},fetchCampaignError:{id:"campaign.email.error.fetch-campaign",defaultMessage:"Cannot load campaign data"},filterByLabel:{id:"campaign.email.filterBy.label",defaultMessage:"Filter By Label"},noCampaign:{id:"campaign.email.list.noCampaign",defaultMessage:"No Email Campaigns"}});t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messagesMap=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(13),l=n(25),c=n(35),u=n(8),d=n(24),f=n(6),p=b(n(60)),m=b(n(202)),g=b(n(23)),y=n(109),h=n(61),v=b(n(2027));function b(e){return e&&e.__esModule?e:{default:e}}var _=t.messagesMap=(0,f.defineMessages)({partitionSelectorTitle:{id:"audience.segments.partitionSelector.AddButton",defaultMessage:"Add a partition"},partitionSelectorColumnName:{id:"audience.segments.partitionSelector.name",defaultMessage:"Name"},partitionSelectorColumnType:{id:"audience.segments.partitionSelector.type",defaultMessage:"Type"},partitionSelectorColumnPartCount:{id:"audience.segments.partitionSelector.partCount",defaultMessage:"Part Count"},weight:{id:"audience.segments.experimentation.weight",defaultMessage:"Experimentation %"},controlGroupSegmentName:{id:"audience.segments.experimentation.controlGroupSegmentName",defaultMessage:"Control Group"},experimentationSegmentName:{id:"audience.segments.experimentation.experimentationSegmentName",defaultMessage:"Experimentation"},uplift:{id:"audience.segments.experimentation.uplift",defaultMessage:"Uplift"},engagementMetric:{id:"audience.segments.experimentation.engagementMetric",defaultMessage:"Engagement metric"},E_COMMERCE_ENGAGEMENT:{id:"audience.segments.experimentation.eCommerceEngagement",defaultMessage:"E-commerce Engagement"},CHANNEL_ENGAGEMENT:{id:"audience.segments.experimentation.channelEngagement",defaultMessage:"Channel Engagement"},tooltipWeight:{id:"audience.segments.experimentation.control.tooltip",defaultMessage:"Select the datamart percentage on which you want to do your experimentation."},tooltipEngagement:{id:"audience.segments.experimentation.engagement.tooltip",defaultMessage:"Select an engagement value"},selectPartition:{id:"audience.segments.experimentation.form.selectPartition",defaultMessage:"Select Partition"},experimentation:{id:"audience.segments.experimentation.form.experimentation",defaultMessage:"Experimentation"},savingInProgress:{id:"audience.segments.experimentation.form.saveInProgress",defaultMessage:"Saving in progress..."},successfullyCreated:{id:"audience.segments.experimentation.form.successfullyCreated",defaultMessage:"Experimentation Successfully created!"},abTestingDetailsTitle:{id:"audience.segment.dashboard.ABDetailsTable.exportTitle",defaultMessage:"AB Testing Details"},abDashboardSegmentFilterPlaceholder:{id:"audience.segment.dashboard.abDashboard.segmentFilterPlaceholder",defaultMessage:"Select an activation you want to refine your experimentation with"}}),S="experimentationForm",E=i.Layout.Content,O={labelCol:{span:3},wrapperCol:{span:19,offset:1}},w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onSelectPartition=function(e){n.props.change("selectedPartition",e)},n.getSliderStep=function(e){return e?100/e:0},n.state={loadingPartitions:!0,partitions:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.intl,r=t.handleSubmit,s=t.breadCrumbPaths,l=t.close,u=t.formValues,g=t.partitions,h=t.loadingPartitions,b={formId:S,paths:s,message:m.default.experimentationCreation,onClose:l},w={items:[{sectionId:"section-partition",title:n.formatMessage(_.selectPartition),onClick:function(){e.props.change("selectedPartition",{})}},{sectionId:"section-experimentation",title:n.formatMessage(_.experimentation)}],scrollId:S};return u&&u.selectedPartition&&u.selectedPartition.id?o.createElement(i.Layout,{className:"edit-layout"},o.createElement(p.default,b),o.createElement(i.Layout,null,o.createElement(y.ScrollspySider,w),o.createElement(c.Form,{onSubmit:r,className:"edit-layout ant-layout"},o.createElement(E,{id:S,className:"mcs-content-container mcs-form-container"},o.createElement(f.FormattedMessage,{id:"audience.segments.experimentation.form.title",defaultMessage:"You have selected the following partition: {partitionName}.\n                    Continue your experimentation creation by selecting an engagement type and a percentage of experimentation.",values:{partitionName:o.createElement(i.Tag,null,u.selectedPartition.name)}}),o.createElement("div",{className:"mcs-audienceExperimentationForm_experimentationSection",id:"section-experimentation"},o.createElement(d.FormFieldWrapper,a({label:n.formatMessage(_.engagementMetric),helpToolTipProps:{title:n.formatMessage(_.tooltipEngagement)}},O),o.createElement(d.FormRadioGroupField,{name:"engagement",component:d.FormRadioGroup,elements:[{id:"E_COMMERCE_ENGAGEMENT",value:"E_COMMERCE_ENGAGEMENT",title:n.formatMessage(_.E_COMMERCE_ENGAGEMENT)},{id:"CHANNEL_ENGAGEMENT",value:"CHANNEL_ENGAGEMENT",title:n.formatMessage(_.CHANNEL_ENGAGEMENT)}]})),o.createElement(d.FormSliderField,{name:"weight",component:d.FormSlider,formItemProps:Object.assign({label:n.formatMessage(_.weight),required:!0},O),inputProps:{min:0,max:100,tipFormatter:function(e){return o.createElement("span",null,Math.round(100*e)/100,"%")},step:this.getSliderStep(u.selectedPartition.part_count),disabled:!u.selectedPartition.part_count},helpToolTipProps:{title:n.formatMessage(_.tooltipWeight)}})))))):o.createElement(v.default,{partitions:g,isLoading:h,onSelect:this.onSelectPartition,actionbarProps:{paths:[{name:n.formatMessage(_.partitionSelectorTitle)}],onClose:l}})}}]),t}(o.Component);t.default=(0,u.compose)(s.withRouter,d.withValidators,f.injectIntl,h.injectDrawer,g.default,(0,l.connect)((function(e){return{formValues:(0,c.getFormValues)(S)(e)}})),(0,c.reduxForm)({form:S,enableReinitialize:!0}))(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(11),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));var o=function(e){var t=e.iconType,n=e.genericIconProps;return r.createElement("div",{className:"empty-related-records "+(e.className?e.className:"")},t&&r.createElement(a.McsIcon,{type:t}),!!n&&n,!t&&!n&&r.createElement(a.McsIcon,{type:"warning"}),e.message)};o.defaultProps={className:""},t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateTooltip=t.generateLegend=t.generateDraggable=t.generateDragEvents=t.generateYAxisGridLine=t.generateXAxisGridLine=t.BASE_CHART_HEIGHT=t.AREA_OPACITY=t.CROSSHAIR_COLOR=t.LINE_COLOR=t.GRAY_COLOR=void 0;var a,r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(203)),o=n(17),i=(a=o)&&a.__esModule?a:{default:a};var s=t.GRAY_COLOR="#8ca0b3",l=t.LINE_COLOR=r.Color(s).setOpacity(.4).get("rgba"),c=t.CROSSHAIR_COLOR=r.Color(s).setOpacity(.6).get("rgba"),u=(t.AREA_OPACITY=.15,t.BASE_CHART_HEIGHT=400,t.generateXAxisGridLine=function(){return{gridLineWidth:1,gridLineColor:l,gridLineDashStyle:"ShortDash",crosshair:{color:c,width:1,dashStyle:"ShortDash"}}},t.generateYAxisGridLine=function(){return{gridLineWidth:1,gridLineColor:l,gridLineDashStyle:"ShortDash"}},t.generateDragEvents=function(e){return function(t){var n=(0,i.default)(t.xAxis[0].min),a=(0,i.default)(t.xAxis[0].max),r=n,o=a.diff(r,"milliseconds")>864e5?a:a.add(1,"days");return e&&e([r,o]),!1}});t.generateDraggable=function(e){return{zoomType:"x",events:{selection:u(e)}}},t.generateLegend=function(){return{}},t.generateTooltip=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments[2];return e?{useHTML:!1,borderRadius:2,borderWidth:1,borderColor:"#e8e8e8",padding:15,outside:!1,shadow:!1,hideDelay:0,headerFormat:'<span style="font-size: 12px; font-weight: bold; margin-bottom: 13px;">{point.key}</span><br/><br/>',pointFormat:'<span style="color:{point.color}; font-size: 20px; margin-right: 20px;">●</span> {series.name}: <b>'+(n?n.formatter:"{point.y}")+"</b><br/>",pointFormatter:t?function(){return'<span style="color:'+this.color+'; font-size: 20px; margin-right: 20px;">●</span> '+this.series.name+": <b>"+i.default.duration(this.y,"second").format("h[hr] m[min] s[s]")+"</b><br/>"}:void 0}:{enabled:!1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(44);var i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchObject=function(e){return n.cancelablePromise=(0,o.makeCancelable)(n.props.fetchingMethod(e).then((function(e){return e.data}))),n.cancelablePromise.promise.then((function(e){n.setState({object:e})}))},n.state={object:void 0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){this.fetchObject(this.props.id)}},{key:"componentDidUpdate",value:function(e){var t=this.props.id;t!==e.id&&this.fetchObject(t)}},{key:"componentWillUnmount",value:function(){this.cancelablePromise&&this.cancelablePromise.cancel()}},{key:"render",value:function(){var e=this.props.renderMethod,t=this.state.object;return t?e(t):null}}]),t}(r.Component);t.default=i},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(89);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){function t(){return i(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.node;return r.createElement("div",null,r.createElement("div",{style:{position:"absolute",top:(e.getSize().height+e.getSize().borderWidth/2)/2,left:0}},r.createElement(o.PortWidget,{name:"left",node:this.props.node})),r.createElement("div",{style:{position:"absolute",top:0,left:(e.getSize().width+e.getSize().borderWidth/2)/2}},r.createElement(o.PortWidget,{name:"top",node:this.props.node})),r.createElement("div",{style:{position:"absolute",top:(e.getSize().height+e.getSize().borderWidth/2)/2,left:e.getSize().width-e.getSize().borderWidth/2}},r.createElement(o.PortWidget,{name:"right",node:this.props.node})),r.createElement("div",{style:{position:"absolute",top:e.getSize().height-e.getSize().borderWidth/2,left:(e.getSize().width+e.getSize().borderWidth/2)/2}},r.createElement(o.PortWidget,{name:"bottom",node:this.props.node})))}}]),t}(r.Component);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({remove:{id:"querytool.field.remove",defaultMessage:"Remove"},edit:{id:"querytool.field.edit",defaultMessage:"Edit"},copy:{id:"querytool.field.copy",defaultMessage:"Copy"},cut:{id:"querytool.field.cut",defaultMessage:"Cut"},paste:{id:"querytool.field.paste",defaultMessage:"Paste Here"},object:{id:"querytool.plus.object",defaultMessage:"Object"},group:{id:"querytool.plus.group",defaultMessage:"Group"},AND:{id:"querytool.boolean.and",defaultMessage:"And"},AND_NOT:{id:"querytool.boolean.and_not",defaultMessage:"And Not"},OR:{id:"querytool.boolean.or",defaultMessage:"Or"},OR_NOT:{id:"querytool.boolean.or_not",defaultMessage:"Or Not"}})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluginFieldGenerator=void 0;var a,r=n(2297),o=(a=r)&&a.__esModule?a:{default:a};t.PluginFieldGenerator=o.default},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(11),l=n(2390),c=(a=l)&&a.__esModule?a:{default:a};function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},p=function(e){function t(){return u(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=(e.opened,e.onClose,e.organisationId,f(e,["opened","onClose","organisationId"]));return i.createElement(s.StandardModal,{opened:this.props.opened,onClose:this.props.onClose},i.createElement(c.default,r({organisationId:this.props.organisationId,onClose:this.props.onClose},t)))}}]),t}(i.Component);t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=m(n(1120)),i=n(10),s=n(8),l=n(13),c=n(30),u=m(n(1121)),d=n(229),f=n(11),p=m(n(81));function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.setInitialParams=function(){var e=n.props,t=e.location,a=t.search,r=t.pathname,o=e.history,i=e.defaultSegment,s=e.disableAllUserFilter,l=e.comparisonStartDate,u={allusers:!s,segments:i?[i.key]:[]},f=l?Object.assign(Object.assign({},u),{from:new p.default("now-"+(0,c.convertTimestampToDayNumber)(l)+"d"),to:new p.default("now-1d")}):void 0,m={pathname:r,search:(0,c.updateSearch)(a,f||u)};(0,c.isSearchValid)(a,d.DATAMART_USERS_ANALYTICS_SETTING)||o.replace(m)},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,c.updateSearch)(o,e,d.DATAMART_USERS_ANALYTICS_SETTING)};a.push(i)},n.onSegmentFilterChange=function(e){n.updateLocationSearch({segments:e})},n.onAllUserFilterChange=function(e){n.updateLocationSearch({allusers:e})},n.getLoadingState=function(e){return n.setState({isLoading:e})},n.state={layout:[],refresh:!1,isLoading:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){this.setInitialParams()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.location,a=n.search,r=n.pathname,o=t.history;e.location.search!==a&&((0,c.isSearchValid)(a,d.DATAMART_USERS_ANALYTICS_SETTING)||o.replace({pathname:r,search:(0,c.buildDefaultSearch)(a,d.DATAMART_USERS_ANALYTICS_SETTING)}))}},{key:"renderDatePicker",value:function(){var e=this,t=this.props,n=t.location.search,a=t.comparisonStartDate,o=this.state.isLoading,i=(0,c.parseSearch)(n,d.DATAMART_USERS_ANALYTICS_SETTING),s={from:i.from,to:i.to};return r.createElement(f.McsDateRangePicker,{values:s,onChange:function(t){return e.updateLocationSearch({from:t.from,to:t.to})},disabled:o,excludeToday:!0,startDate:a})}},{key:"render",value:function(){var e=this.props,t=e.title,n=e.subTitle,a=e.datamartId,s=e.organisationId,l=e.config,p=e.showFilter,m=e.showDateRangePicker,g=e.disableAllUserFilter,y=e.defaultSegment,h=e.pageTitle,v=e.segmentToAggregate,b=e.location.search,_=this.state,S=_.isLoading,E=_.refresh,O=(0,c.parseSearch)(b,d.DATAMART_USERS_ANALYTICS_SETTING);return r.createElement("div",{className:"mcs-datamartUsersAnalytics"},r.createElement(i.Row,null,r.createElement(i.Col,{span:12},h&&r.createElement(f.ContentHeader,{title:h,size:"large"}))),!E&&r.createElement(i.Row,{justify:"space-between"},p&&r.createElement(u.default,{className:S?"mcs-datamartUsersAnalytics_segmentFilter _is_disabled":"mcs-datamartUsersAnalytics_segmentFilter",onChange:this.onSegmentFilterChange,onToggleAllUsersFilter:this.onAllUserFilterChange,datamartId:a,organisationId:s,disableAllUserFilter:g,defaultSegment:y}),m&&r.createElement(i.Col,{className:"text-right",offset:6},this.renderDatePicker())),r.createElement(i.Row,null,r.createElement(i.Col,{span:12},t&&r.createElement("div",null,r.createElement("div",{className:"mcs-datamartUsersAnalytics_title"},t),r.createElement("div",{className:"mcs-datamartUsersAnalytics_subTitle"},n)))),!E&&r.createElement(o.default,{datamartId:a,config:l,dateRange:{from:O.from,to:O.to},onChange:this.getLoadingState,segmentToAggregate:v}))}}]),t}(r.Component);t.default=(0,s.compose)(l.withRouter)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.acquisitionEngagementConfig=t.channelEngagementConfig=t.ecommerceEngagementConfig=t.abTestingDashboardConfig=t.averageSessionDurationConfig=t.sessionInTimeJsonConfig=void 0;var a,r=n(619),o=n(422),i=(a=o)&&a.__esModule?a:{default:a};var s=(new Date).getTimezoneOffset();t.sessionInTimeJsonConfig=[{title:"Session in time",layout:{i:"1",h:3,static:!1,w:6,x:0,y:0},charts:[{type:"AREA",options:{title:void 0,colors:i.default.scale(["#00a1df","#003056"]).mode("lch").colors(5),credits:{enabled:!1},chart:{reflow:!0},xAxis:Object.assign(Object.assign({},(0,r.generateXAxisGridLine)()),{type:"datetime",dateTimeLabelFormats:{day:"%d %b %Y"},title:{text:null}}),time:{timezoneOffset:s,useUTC:!0},yAxis:Object.assign(Object.assign({},(0,r.generateYAxisGridLine)()),{title:{text:null}}),legend:{enabled:!0,verticalAlign:"top",itemMarginBottom:6},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)())},dimensions:["channel_name","channel_id","date_yyyy_mm_dd"],filterBy:"channel_name",metricNames:["sessions"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]}],t.averageSessionDurationConfig=[{layout:{i:"0",h:1,static:!1,w:4,x:0,y:0},charts:[{type:"SINGLE_STAT",options:{title:{text:"Average Session Duration"}},unit:"time",metricNames:["avg_session_duration"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{layout:{i:"0",h:1,static:!1,w:4,x:4,y:0},charts:[{type:"SINGLE_STAT",options:{title:{text:"Average Events per Session"}},metricNames:["avg_number_of_user_events"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{layout:{i:"0",h:1,static:!1,w:4,x:8,y:0},charts:[{type:"SINGLE_STAT",options:{title:{text:"Average Conversion Rate"}},unit:"%",metricNames:["conversion_rate"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]}],t.abTestingDashboardConfig=[{title:"Average Revenue Per User Point",tabMode:!0,layout:{i:"1",h:3,static:!1,w:12,x:0,y:0},charts:[{type:"AREA",enhancedManualReportView:!0,options:{title:void 0,credits:{enabled:!1},chart:{reflow:!0},xAxis:Object.assign(Object.assign({},(0,r.generateXAxisGridLine)()),{type:"datetime",dateTimeLabelFormats:{day:"%d %b %Y"},title:{text:null}}),time:{timezoneOffset:s,useUTC:!0},yAxis:Object.assign(Object.assign({},(0,r.generateYAxisGridLine)()),{title:{text:null}}),legend:{enabled:!0,verticalAlign:"top",itemMarginBottom:6},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)())},dimensions:["date_yyyy_mm_dd"],metricNames:["avg_revenue_per_user_point"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{title:"Average Transaction Amount",tabMode:!0,layout:{i:"1",h:3,static:!1,w:12,x:0,y:0},charts:[{type:"AREA",enhancedManualReportView:!0,options:{title:void 0,credits:{enabled:!1},chart:{reflow:!0},xAxis:Object.assign(Object.assign({},(0,r.generateXAxisGridLine)()),{type:"datetime",dateTimeLabelFormats:{day:"%d %b %Y"},title:{text:null}}),time:{timezoneOffset:s,useUTC:!0},yAxis:Object.assign(Object.assign({},(0,r.generateYAxisGridLine)()),{title:{text:null}}),legend:{enabled:!0,verticalAlign:"top",itemMarginBottom:6},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)())},dimensions:["date_yyyy_mm_dd"],metricNames:["avg_transaction_amount"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{title:"Average Number Of Transactions",tabMode:!0,layout:{i:"1",h:3,static:!1,w:12,x:0,y:0},charts:[{type:"AREA",enhancedManualReportView:!0,options:{title:void 0,credits:{enabled:!1},chart:{reflow:!0},xAxis:Object.assign(Object.assign({},(0,r.generateXAxisGridLine)()),{type:"datetime",dateTimeLabelFormats:{day:"%d %b %Y"},title:{text:null}}),time:{timezoneOffset:s,useUTC:!0},yAxis:Object.assign(Object.assign({},(0,r.generateYAxisGridLine)()),{title:{text:null}}),legend:{enabled:!0,verticalAlign:"top",itemMarginBottom:6},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)())},dimensions:["date_yyyy_mm_dd"],metricNames:["avg_number_of_transactions"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{title:"Average Session Duration",tabMode:!0,layout:{i:"1",h:3,static:!1,w:12,x:0,y:0},charts:[{type:"AREA",enhancedManualReportView:!0,options:{title:void 0,credits:{enabled:!1},chart:{reflow:!0},xAxis:Object.assign(Object.assign({},(0,r.generateXAxisGridLine)()),{type:"datetime",dateTimeLabelFormats:{day:"%d %b %Y"},title:{text:null}}),time:{timezoneOffset:s,useUTC:!0},yAxis:Object.assign(Object.assign({},(0,r.generateYAxisGridLine)()),{title:{text:null}}),legend:{enabled:!0,verticalAlign:"top",itemMarginBottom:6},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)())},dimensions:["date_yyyy_mm_dd"],metricNames:["avg_session_duration"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{title:"Average Events per Session",tabMode:!0,layout:{i:"1",h:3,static:!1,w:12,x:0,y:0},charts:[{type:"AREA",enhancedManualReportView:!0,options:{title:void 0,credits:{enabled:!1},chart:{reflow:!0},xAxis:Object.assign(Object.assign({},(0,r.generateXAxisGridLine)()),{type:"datetime",dateTimeLabelFormats:{day:"%d %b %Y"},title:{text:null}}),time:{timezoneOffset:s,useUTC:!0},yAxis:Object.assign(Object.assign({},(0,r.generateYAxisGridLine)()),{title:{text:null}}),legend:{enabled:!0,verticalAlign:"top",itemMarginBottom:6},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)())},dimensions:["date_yyyy_mm_dd"],metricNames:["avg_number_of_user_events"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{title:"Average Conversion Rate",tabMode:!0,layout:{i:"1",h:3,static:!1,w:12,x:0,y:0},charts:[{type:"AREA",enhancedManualReportView:!0,options:{title:void 0,credits:{enabled:!1},chart:{reflow:!0},xAxis:Object.assign(Object.assign({},(0,r.generateXAxisGridLine)()),{type:"datetime",dateTimeLabelFormats:{day:"%d %b %Y"},title:{text:null}}),time:{timezoneOffset:s,useUTC:!0},yAxis:Object.assign(Object.assign({},(0,r.generateYAxisGridLine)()),{title:{text:null}}),legend:{enabled:!0,verticalAlign:"top",itemMarginBottom:6},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)())},dimensions:["date_yyyy_mm_dd"],metricNames:["conversion_rate"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]}],t.ecommerceEngagementConfig=[{layout:{i:"0",h:1,static:!1,w:4,x:0,y:0},charts:[{type:"SINGLE_STAT",options:{title:{text:"Average Number Of Transactions"}},unit:"number",metricNames:["avg_number_of_transactions"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{layout:{i:"0",h:1,static:!1,w:4,x:4,y:0},charts:[{type:"SINGLE_STAT",options:{title:{text:"Average Transaction Amount"}},metricNames:["avg_transaction_amount"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{layout:{i:"0",h:1,static:!1,w:4,x:8,y:0},charts:[{type:"SINGLE_STAT",options:{title:{text:"Average Revenue Per User Point"}},unit:"€",metricNames:["avg_revenue_per_user_point"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]}],t.channelEngagementConfig=[{title:"Session in time",layout:{i:"1",h:3,static:!1,w:6,x:0,y:0},charts:[{type:"AREA",options:{title:void 0,colors:i.default.scale(["#00a1df","#003056"]).mode("lch").colors(5),credits:{enabled:!1},chart:{reflow:!0},xAxis:Object.assign(Object.assign({},(0,r.generateXAxisGridLine)()),{type:"datetime",dateTimeLabelFormats:{day:"%d %b %Y"},title:{text:null}}),time:{timezoneOffset:s,useUTC:!0},yAxis:Object.assign(Object.assign({},(0,r.generateYAxisGridLine)()),{title:{text:null}}),legend:{enabled:!0,verticalAlign:"top",itemMarginBottom:6},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)())},dimensions:["channel_name","channel_id","date_yyyy_mm_dd"],filterBy:"channel_name",metricNames:["sessions"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{title:"Sessions by Channel",layout:{i:"2",h:3,static:!1,w:6,x:6,y:0},charts:[{type:"COLUMN",options:{title:void 0,colors:i.default.scale(["#00a1df","#003056"]).mode("lch").colors(5),credits:{enabled:!1},chart:{reflow:!0},xAxis:Object.assign({},(0,r.generateXAxisGridLine)()),time:{timezoneOffset:s,useUTC:!0},yAxis:Object.assign(Object.assign({},(0,r.generateYAxisGridLine)()),{title:{text:null}}),legend:{enabled:!0,verticalAlign:"top",itemMarginBottom:6},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)())},dimensions:["channel_name","channel_id"],metricNames:["sessions"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{title:"Sessions by Form Factor",layout:{i:"3",h:3,static:!1,w:4,x:0,y:3},charts:[{type:"PIE",options:{title:void 0,colors:i.default.scale(["#003056","#00a1df"]).mode("lch").colors(7),plotOptions:{pie:{dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f} %",style:{color:"rgba(0, 0, 0, 0.65)"}}}},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)()),credits:{enabled:!1}},dimensions:["device_form_factor"],metricNames:["sessions"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{title:"Sessions by Browser Family",layout:{i:"4",h:3,static:!1,w:4,x:4,y:3},charts:[{type:"PIE",options:{title:void 0,colors:i.default.scale(["#003056","#00a1df"]).mode("lch").colors(7),plotOptions:{pie:{dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f} %",style:{color:"rgba(0, 0, 0, 0.65)"}}}},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)()),credits:{enabled:!1}},dimensions:["device_browser_family"],metricNames:["sessions"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{title:"Sessions by OS",layout:{i:"5",h:3,static:!1,w:4,x:8,y:3},charts:[{type:"PIE",options:{title:void 0,colors:i.default.scale(["#003056","#00a1df"]).mode("lch").colors(7),plotOptions:{pie:{dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f} %",style:{color:"rgba(0, 0, 0, 0.65)"}}}},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)()),credits:{enabled:!1}},dimensions:["device_os_family"],metricNames:["sessions"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{title:"Active Users By Channel",layout:{i:"6",h:3,static:!1,w:6,x:0,y:6},charts:[{type:"AREA",options:{title:void 0,colors:i.default.scale(["#00a1df","#003056"]).mode("lch").colors(5),credits:{enabled:!1},chart:{reflow:!0},xAxis:Object.assign(Object.assign({},(0,r.generateXAxisGridLine)()),{type:"datetime",dateTimeLabelFormats:{day:"%d %b %Y"},title:{text:null}}),time:{timezoneOffset:s,useUTC:!0},yAxis:Object.assign(Object.assign({},(0,r.generateYAxisGridLine)()),{title:{text:null}}),legend:{enabled:!0,verticalAlign:"top",itemMarginBottom:6},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)())},dimensions:["channel_name","channel_id","date_yyyy_mm_dd"],filterBy:"channel_name",metricNames:["users"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]}],t.acquisitionEngagementConfig=[{title:"Sessions by Source in Time",layout:{i:"1",h:3,static:!1,w:6,x:0,y:0},charts:[{type:"AREA",options:{title:void 0,colors:i.default.scale(["#00a1df","#003056"]).mode("lch").colors(5),credits:{enabled:!1},chart:{reflow:!0},xAxis:Object.assign(Object.assign({},(0,r.generateXAxisGridLine)()),{type:"datetime",dateTimeLabelFormats:{day:"%d %b %Y"},title:{text:null}}),time:{timezoneOffset:s,useUTC:!0},yAxis:Object.assign(Object.assign({},(0,r.generateYAxisGridLine)()),{title:{text:null}}),legend:{enabled:!0,verticalAlign:"top",itemMarginBottom:6},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)())},dimensions:["origin_source","date_yyyy_mm_dd"],filterBy:"origin_source",metricNames:["sessions"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{title:"Sessions by Source",layout:{i:"1",h:3,static:!1,w:6,x:6,y:0},charts:[{type:"COLUMN",options:{title:void 0,colors:i.default.scale(["#00a1df","#003056"]).mode("lch").colors(5),credits:{enabled:!1},chart:{reflow:!0},xAxis:Object.assign({},(0,r.generateXAxisGridLine)()),time:{timezoneOffset:s,useUTC:!0},yAxis:Object.assign(Object.assign({},(0,r.generateYAxisGridLine)()),{title:{text:null}}),legend:{enabled:!0,verticalAlign:"top",itemMarginBottom:6},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)())},dimensions:["origin_source"],metricNames:["sessions"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{title:"Sessions By Origin in Time",layout:{i:"1",h:3,static:!1,w:6,x:0,y:3},charts:[{type:"AREA",options:{title:void 0,colors:i.default.scale(["#00a1df","#003056"]).mode("lch").colors(5),credits:{enabled:!1},chart:{reflow:!0},xAxis:Object.assign(Object.assign({},(0,r.generateXAxisGridLine)()),{type:"datetime",dateTimeLabelFormats:{day:"%d %b %Y"},title:{text:null}}),time:{timezoneOffset:s,useUTC:!0},yAxis:Object.assign(Object.assign({},(0,r.generateYAxisGridLine)()),{title:{text:null}}),legend:{enabled:!0,verticalAlign:"top",itemMarginBottom:6},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)())},dimensions:["origin_channel","date_yyyy_mm_dd"],filterBy:"origin_channel",metricNames:["sessions"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{title:"Sessions by Origin",layout:{i:"1",h:3,static:!1,w:6,x:6,y:3},charts:[{type:"COLUMN",options:{title:void 0,colors:i.default.scale(["#00a1df","#003056"]).mode("lch").colors(5),credits:{enabled:!1},chart:{reflow:!0},xAxis:Object.assign({},(0,r.generateXAxisGridLine)()),time:{timezoneOffset:s,useUTC:!0},yAxis:Object.assign(Object.assign({},(0,r.generateYAxisGridLine)()),{title:{text:null}}),legend:{enabled:!0,verticalAlign:"top",itemMarginBottom:6},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)())},dimensions:["origin_channel"],metricNames:["sessions"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]},{title:"Average Session duration by origin source",layout:{i:"1",h:3,static:!1,w:12,x:0,y:6},charts:[{type:"COLUMN",options:{title:void 0,colors:i.default.scale(["#00a1df","#003056"]).mode("lch").colors(5),credits:{enabled:!1},chart:{reflow:!0},xAxis:Object.assign({},(0,r.generateXAxisGridLine)()),time:{timezoneOffset:s,useUTC:!0},yAxis:Object.assign(Object.assign({},(0,r.generateYAxisGridLine)()),{title:{text:null}}),legend:{enabled:!0,verticalAlign:"top",itemMarginBottom:6},tooltip:Object.assign({shared:!0},(0,r.generateTooltip)(!0,!0))},dimensions:["origin_source"],metricNames:["avg_session_duration"],dimensionFilterClauses:{operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]}}]}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DisplayCreativeCreator=t.EditDisplayCreativePage=t.DisplayCreativeRendererSelector=t.DisplayCreativeFormLoader=t.DisplayCreativeForm=void 0;var a=l(n(2462)),r=l(n(1138)),o=l(n(1139)),i=l(n(2469)),s=l(n(2470));function l(e){return e&&e.__esModule?e:{default:e}}t.DisplayCreativeForm=a.default,t.DisplayCreativeFormLoader=r.default,t.DisplayCreativeRendererSelector=o.default,t.EditDisplayCreativePage=i.default,t.DisplayCreativeCreator=s.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({errorFormMessage:{id:"settings.site.form.errorMessage",defaultMessage:"There is an error with the data you have inputed, please check"},savingInProgress:{id:"settings.site.form.savingInProgress",defaultMessage:"Saving your Site"},createSiteTitle:{id:"settings.site.form.create",defaultMessage:"New Site"},editSiteTitle:{id:"settings.site.form.edit",defaultMessage:"Edit {name}"},breadcrumbTitle1:{id:"settings.site.form.settings",defaultMessage:"Sites"},saveSite:{id:"settings.site.form.save",defaultMessage:"Save"},sectionGeneralTitle:{id:"settings.site.form.section.general.title",defaultMessage:"General Information"},sectionGeneralSubTitle:{id:"settings.site.form.section.general.subtitle",defaultMessage:"Please fill the basic information for your website so we can generate a Tag."},sectionAliasesTitle:{id:"settings.site.form.section.aliases.title",defaultMessage:"Aliases"},sectionAliasesSubTitle:{id:"settings.site.form.section.aliases.subtitle",defaultMessage:"An Alias is a domain or a subdomain different from your main domain on which your website is being served."},sectionEventRulesTitle:{id:"settings.site.form.section.eventRules.title",defaultMessage:"Event Rules"},sectionVisitAnalyzer:{id:"settings.site.form.section.visitAnalyzer.title",defaultMessage:"Visit Analyzer"},sectionProcessingActivitiesTitle:{id:"settings.site.form.section.processingActivities.title",defaultMessage:"Processing Activities"},contentSectionGeneralNameLabel:{id:"settings.site.form.general.label",defaultMessage:"Name"},contentSectionGeneralNamePlaceholder:{id:"settings.site.form.general.placeholder",defaultMessage:"Site Name"},contentSectionGeneralNameTooltip:{id:"settings.site.form.general.tooltip",defaultMessage:"Give your Site a Name"},contentSectionGeneralTokenLabel:{id:"settings.site.form.general.token.label",defaultMessage:"Token"},contentSectionGeneralTokenPlaceholder:{id:"settings.site.form.general.token.placeholder",defaultMessage:"Site Token"},contentSectionGeneralTokenTooltip:{id:"settings.site.form.general.token.tooltip",defaultMessage:"Give your Site a unique token to identify your app. This token can be comprised of characters as well as numbers"},contentSectionGeneralDomainLabel:{id:"settings.site.form.general.domain.label",defaultMessage:"Domain"},contentSectionGeneralDomainPlaceholder:{id:"settings.site.form.general.domain.placeholder",defaultMessage:"Site Domain"},contentSectionGeneralDomainTooltip:{id:"settings.site.form.general.domain.tooltip",defaultMessage:"This is the main domain on which your website runs. Don't worry you can add several other later on!"},contentSectionAliasesNameLabel:{id:"settings.site.form.Aliases.label",defaultMessage:"Aliases"},contentSectionAliasesNamePlaceholder:{id:"settings.site.form.Aliases.placeholder",defaultMessage:"Add an alias and click on enter"},contentSectionGAliasesNameTooltip:{id:"settings.site.form.Aliases.tooltip",defaultMessage:"Type your alias name and then click on enter to validate."},warningOnTokenEdition:{id:"settings.site.warning.token.edition",defaultMessage:"Danger Zone: Editing this token may cause any web site data collection tag to fail if not updated properly. Please make sure you have updated all your tags before saving."},processingsWarningModalContent:{id:"settings.site.processings.warning.content",defaultMessage:"You are about to change the Processing Activities on behalf of which you are capturing personal data on this channel. mediarithmics platform will now automatically drop new User Events if the User Choices do not allow their capture. Do you want to continue?"},processingsWarningModalOk:{id:"settings.site.processings.warning.ok",defaultMessage:"OK"},processingsWarningModalCancel:{id:"settings.site.processings.warning.cancel",defaultMessage:"Cancel"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(0,n(6).defineMessages)({id:{id:"settings.organisation.ml-algorithms.id",defaultMessage:"Id"},name:{id:"settings.organisation.ml-algorithms.name",defaultMessage:"Name"},description:{id:"settings.organisation.ml-algorithms.description",defaultMessage:"Description"},lastUpdatedDate:{id:"settings.organisation.ml-algorithms.last-updated-date",defaultMessage:"Last Updated Date"},mlAlgorithms:{id:"settings.organisation.ml-algorithms.placeholder",defaultMessage:"ML Algorithms"},downloadNotebook:{id:"settings.organisation.ml-algorithms.download-notebook",defaultMessage:"Download Notebook"},archive:{id:"settings.organisation.ml-algorithms.archive",defaultMessage:"Archive"},fork:{id:"settings.organisation.ml-algorithms.fork",defaultMessage:"Fork ML Algorithm"},forkMlAlgorithmModalTitle:{id:"settings.organisation.ml-algorithms.fork-modal.title",defaultMessage:"Fork ML Algorithm"},forkMlAlgorithmModalSubtitle:{id:"settings.organisation.ml-algorithms.fork-modal.subtitle",defaultMessage:"Specify the ML Algorithm variable values for the new ML Algorithm"},archived:{id:"settings.organisation.ml-algorithms.archived",defaultMessage:"Archived"},isArchived:{id:"settings.organisation.ml-algorithms.is-archived",defaultMessage:"Yes"},notArchived:{id:"settings.organisation.ml-algorithms.not-archived",defaultMessage:"No"},newMlAlgorithm:{id:"settings.organisation.ml-algorithms.new",defaultMessage:"New ML Algorithm"},empty:{id:"settings.organisation.ml-algorithms.empty",defaultMessage:"No Ml Algorithms"},editMlAlgorithmRaw:{id:"settings.organisation.ml-algorithms.edit-raw",defaultMessage:"Edit"},editMlAlgorithm:{id:"settings.organisation.ml-algorithms.edit",defaultMessage:"Edit {name}"},sectionTitleGeneral:{id:"settings.organisation.ml-algorithms.edit.general-section",defaultMessage:"General Information"},sectionSubTitleGeneral:{id:"settings.organisation.ml-algorithms.edit.subtitle",defaultMessage:"Give your Ml Algorithm a name"},saveMlAlgorithm:{id:"settings.organisation.ml-algorithms.edit.save",defaultMessage:"Save"},labelMlAlgorithmName:{id:"settings.organisation.ml-algorithms.edit.label.name",defaultMessage:"ML Algorithm Name"},labelMlAlgorithmDescription:{id:"settings.organisation.ml-algorithms.edit.label.description",defaultMessage:"ML Algorithm Description"},tooltipMlAlgorithmName:{id:"settings.organisation.ml-algorithms.edit.label.name.tooltip",defaultMessage:"Give your ML Algorithm a name so you can find it back in the different screens."},savingInProgress:{id:"settings.organisation.ml-algorithms.edit.savingInProgress",defaultMessage:"Saving in progress"},updateSuccess:{id:"settings.organisation.ml-algorithms.edit.save.successMessage",defaultMessage:"ML Algorithm successfully saved"},updateError:{id:"settings.organisation.ml-algorithms.edit.list.errorMessage",defaultMessage:"ML Algorithm update failed"},forkSuccess:{id:"settings.organisation.ml-algorithms.fork.successMessage",defaultMessage:"Fork created with success"},forkError:{id:"settings.organisation.ml-algorithms.fork.errorMessage",defaultMessage:"Error while creating fork"},loadingError:{id:"settings.organisation.ml-algorithms.edit.list.loadingErrorMessage",defaultMessage:"Error while loading ML Algorithms"},mlVariableLabel:{id:"settings.organisation.ml-algorithms.ml-variable.label",defaultMessage:"ML Variable"},mlVariableKeyPlaceholder:{id:"settings.organisation.ml-algorithms.ml-variable.placeholder.key",defaultMessage:"Key"},mlVariableValuePlaceholder:{id:"settings.organisation.ml-algorithms.ml-variable.placeholder.value",defaultMessage:"Value"}});t.default=a},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawerReducer=t.closeDrawerEscapeKeyDown=t.closeDrawerClickOnBackground=t.closeNextDrawer=t.openNextDrawer=void 0;var a,r=n(54),o=(a=r)&&a.__esModule?a:{default:a};function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.openNextDrawer=function(e,t){return{type:"OPEN_NEXT_DRAWER",payload:{component:e,options:t}}},t.closeNextDrawer=function(){return{type:"CLOSE_NEXT_DRAWER"}},t.closeDrawerClickOnBackground=function(){return{type:"DRAWER_CLICK_ON_BACKGROUND"}},t.closeDrawerEscapeKeyDown=function(){return{type:"DRAWER_ESCAPE_KEY_DOWN"}},t.drawerReducer={drawableContents:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case"OPEN_NEXT_DRAWER":var n=t.payload,a=n.component,r=n.options,l=Object.assign(Object.assign({},s),r);return[].concat(i(e),[Object.assign({component:a},l)]);case"CLOSE_NEXT_DRAWER":return[].concat(i(o.default.initial(e)));case"DRAWER_CLICK_ON_BACKGROUND":var c=o.default.last(e);return c&&!c.isModal?[].concat(i(o.default.initial(e))):e;default:return e}}};var s={additionalProps:{},isModal:!1,size:"large"}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logOut=t.logIn=void 0;var a=n(247),r=n(104),o={request:(0,a.createAction)(r.LOG_IN.REQUEST,void 0,(function(e,t){return t})),success:(0,a.createAction)(r.LOG_IN.SUCCESS),failure:(0,a.createAction)(r.LOG_IN.FAILURE),expiredPassword:(0,a.createAction)(r.LOG_IN.EXPIRED_PASSWORD)},i=(0,a.createAction)(r.LOG_OUT,void 0,(function(e,t){return t}));t.logIn=o,t.logOut=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGoalFormData=function(e){return void 0!==e.goal},t.isGoalSelectionResource=function(e){return void 0!==e.id};t.INITIAL_DISPLAY_CAMPAIGN_FORM_DATA={campaign:{model_version:"V2017_09",max_budget_period:"DAY",editor_version_id:"11",time_zone:"Europe/Paris",type:"DISPLAY"},goalFields:[],adGroupFields:[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScenarioService=t.SCENARIOS_SEARCH_SETTINGS=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(38),s=n(46),l=(a=s)&&a.__esModule?a:{default:a},c=n(30);function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var d=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},f=(t.SCENARIOS_SEARCH_SETTINGS=[].concat(u(c.PAGINATION_SEARCH_SETTINGS),u(c.FILTERS_SEARCH_SETTINGS),u(c.KEYWORD_SEARCH_SETTINGS)),function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getScenarios",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="scenarios",a=Object.assign({organisation_id:e},t);return l.default.getRequest(n,a)}},{key:"getScenario",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="scenarios/"+e;return l.default.getRequest(n,t)}},{key:"deleteScenario",value:function(e){var t="scenarios/"+e;return l.default.deleteRequest(t)}},{key:"createScenario",value:function(e,t){var n="scenarios?organisation_id="+e;return l.default.postRequest(n,t)}},{key:"updateScenario",value:function(e,t){var n="scenarios/"+e;return l.default.putRequest(n,t)}},{key:"getScenarioStoryline",value:function(e){var t="scenarios/"+e+"/storyline";return l.default.getRequest(t)}},{key:"updateScenarioStoryline",value:function(e,t){var n="scenarios/"+e+"/storyline";return l.default.putRequest(n,t)}},{key:"getScenarioNodes",value:function(e){var t="scenarios/"+e+"/storyline/nodes";return l.default.getRequest(t)}},{key:"createScenarioNode",value:function(e,t){var n="scenarios/"+e+"/storyline/nodes";return l.default.postRequest(n,t)}},{key:"deleteScenarioNode",value:function(e,t){var n="scenarios/"+e+"/storyline/nodes/"+t;return l.default.deleteRequest(n)}},{key:"updateScenarioNode",value:function(e,t,n){var a="scenarios/"+e+"/storyline/nodes/"+t;return l.default.putRequest(a,n)}},{key:"getScenarioEdges",value:function(e){var t="scenarios/"+e+"/storyline/edges";return l.default.getRequest(t)}},{key:"createScenarioEdge",value:function(e,t){var n="scenarios/"+e+"/storyline/edges";return l.default.postRequest(n,t)}},{key:"deleteScenarioEdge",value:function(e,t){var n="scenarios/"+e+"/storyline/edges/"+t;return l.default.deleteRequest(n)}},{key:"updateScenarioEdge",value:function(e,t,n){var a="scenarios/"+e+"/storyline/edges/"+t;return l.default.putRequest(a,n)}},{key:"upsertUserScenarioByUserPointIdAndScenarioId",value:function(e){var t="datamarts/"+e.datamart_id+"/user_points/"+e.user_point_id+"/user_scenarios/scenario_id="+e.scenario_id;return l.default.putRequest(t,e)}}]),e}());t.ScenarioService=f=d([(0,i.injectable)()],f),t.ScenarioService=f},,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavigatorHeader=void 0;var a,r=n(1490),o=(a=r)&&a.__esModule?a:{default:a};t.NavigatorHeader=o.default},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=u(n(17)),s=u(n(84)),l=n(412),c=n(107);function u(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){f(this,t);var e=p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.updateStartDate=function(t){var n=e.props,a=n.input,r=n.startDateFieldName,o=n.unixTimestamp,i=n.startDatePickerProps.showTime,s=t;return t&&(i||(s=s.startOf("day")),o&&(s=parseInt(s.format("x"),0))),a.onChange(Object.assign(Object.assign({},a.value),d({},r,t)))},e.updateEndDate=function(t){var n=e.props,a=n.input,r=n.endDateFieldName,o=n.unixTimestamp,i=n.endDatePickerProps.showTime,s=t;return t&&(i||(s=s.endOf("day")),o&&(s=parseInt(s.format("x"),0))),a.onChange(Object.assign(Object.assign({},a.value),d({},r,t)))},e.disabledStartDate=function(t){var n=e.props,a=n.input,r=n.endDateFieldName,o=a.value[r],s=e.props.allowPastDate,l=(0,i.default)().startOf("day");return!(s||!t||!t.isBefore(l))||!(!t||!o)&&t.valueOf()>o.valueOf()},e.disabledEndDate=function(t){var n=e.props,a=n.input,r=n.startDateFieldName,o=a.value[r],s=e.props.allowPastDate,l=(0,i.default)().startOf("day");return!(s||!t||!t.isBefore(l))||!(!t||!o)&&t.valueOf()<=o.valueOf()},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.input,n=e.formItemProps,r=e.helpToolTipProps,u=e.startDatePickerProps,d=e.endDatePickerProps,f=e.startDateFieldName,p=e.endDateFieldName,m=e.unixTimestamp,g=e.small,y=e.disabled,h=void 0===t.value[f]||null===t.value[f]?void 0:m?(0,i.default)(t.value[f]):t.value[f],v=void 0===t.value[p]||null===t.value[p]?void 0:m?(0,i.default)(t.value[p]):t.value[p];return o.createElement(s.default,a({helpToolTipProps:r,small:g},n),o.createElement("div",{className:"range-picker"},o.createElement("div",{className:"date-picker"},o.createElement(c.DatePicker,a({allowClear:!1},u,{value:h},{onChange:this.updateStartDate,disabledDate:this.disabledStartDate,disabled:y,format:l.DEFAULT_DATE_FORMAT,size:"middle"}))),o.createElement("div",{className:"range-picker-separator"},o.createElement("p",{className:"form-split"},"-")),o.createElement("div",{className:"date-picker"},o.createElement(c.DatePicker,a({allowClear:!1},d,{value:v},{onChange:this.updateEndDate,disabledDate:this.disabledEndDate,disabled:y,format:l.DEFAULT_DATE_FORMAT,size:"middle"})))))}}]),t}(o.Component);m.defaultProps={startDateFieldName:"startDate",endDateFieldName:"endDate"},t.default=m},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(10),s=f(n(225)),l=n(271),c=n(788),u=f(n(84)),d=n(8);function f(e){return e&&e.__esModule?e:{default:e}}var p=(0,o.defineMessages)({pixelSectionCodeSnippetCopied:{id:"pixel.section.codesnippetcopied",defaultMessage:"Code snippet copied"},pixelSectionCodeSnippet:{id:"pixel.section.codesnippet",defaultMessage:"Code Snippet"},pixelSectionCodeSnippetIndication:{id:"pixel.section.codesnippet.indication",defaultMessage:"The code snippet to copy on your web page for custom intergration"},pixelSectionCodeSnippetTooltipHover:{id:"pixel.section.codesnippet.tooltiphover",defaultMessage:"Click to copy"},pixelSectionCodeSnippetCodeCopied:{id:"pixel.section.codesnippet.code.copied",defaultMessage:"Code snippet copied"}});t.default=(0,d.compose)(o.injectIntl)((function(e){var t="success";e.meta&&e.meta.touched&&e.meta.invalid&&(t="error"),e.meta&&e.meta.touched&&e.meta.warning&&(t="warning");var n={formItemProps:{label:e.intl.formatMessage(p.pixelSectionCodeSnippet)},helpToolTipProps:{title:e.intl.formatMessage(p.pixelSectionCodeSnippetIndication)},hoverToolTipProps:{title:e.intl.formatMessage(p.pixelSectionCodeSnippetTooltipHover)}},o=r.createElement(s.default,a({language:e.language,style:l.docco},e.input),e.codeSnippet);return r.createElement("div",null,r.createElement(u.default,a({help:e.meta&&e.meta.touched&&(e.meta.warning||e.meta.error),helpToolTipProps:e.helpToolTipProps,hoverToolTipProps:e.hoverToolTipProps,validateStatus:t},n.formItemProps),e.copyToClipboard?r.createElement(c.CopyToClipboard,{onCopy:function(t){i.message.info(e.intl.formatMessage(p.pixelSectionCodeSnippetCodeCopied))},text:e.codeSnippet},r.createElement("div",{style:{cursor:"pointer"}},o)):o))}))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=l(n(47)),i=n(10),s=l(n(84));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},u=i.Select.Option;t.default=function(e){var t=(0,o.default)(),n=e.formItemProps,l=e.helpToolTipProps,d=e.input,f=e.meta,p=e.selectProps,m=e.small,g=e.disabled,y="success";f.touched&&f.invalid&&(y="error"),f.touched&&f.warning&&(y="warning");var h=""===d.value?[]:e.valueAsString&&!Array.isArray(d.value)?d.value.split(","):d.value,v=p.options.map((function(e){var t=e.label,n=c(e,["label"]);return r.createElement(u,a({},n,{key:n.value,value:n.value}),t)}));return r.createElement(s.default,a({help:f.touched&&(f.warning||f.error),helpToolTipProps:l,validateStatus:y,small:m},n),r.createElement("div",{id:t},r.createElement(i.Select,a({},p,{mode:"multiple",onBlur:function(){return d.onBlur(void 0)},onChange:function(t){return e.valueAsString&&Array.isArray(t)?d.onChange(t.join(",")):d.onChange(t)},onFocus:d.onFocus,value:h,disabled:g,getPopupContainer:p&&p.getPopupContainer?p.getPopupContainer:function(){return document.getElementById(t)}}),v)))}},,,,,function(e,t){},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({deleteModalTitle:{id:"audienceFeed.modal.delete.title",defaultMessage:"Are you sure you want to continue ?"},deleteModalDescription:{id:"audienceFeed.modal.delete.description",defaultMessage:"Are you sure you want delete this feed ? Careful this action cannot be undone."},segmentId:{id:"audience.feeds.list.column.segmentId",defaultMessage:"Segment ID"},name:{id:"audience.feeds.list.column.name",defaultMessage:"Name"},source:{id:"audience.feeds.list.column.source",defaultMessage:"Source"},feedId:{id:"audience.feeds.list.column.feedId",defaultMessage:"Feed ID"},feedName:{id:"audience.feeds.list.column.feedName",defaultMessage:"Feed Name"},segmentNameNotFound:{id:"audience.feeds.list.column.segmentNameNotFound",defaultMessage:"Untitled"},scenarioNameNotFound:{id:"audience.feeds.list.column.scenarioNameNotFound",defaultMessage:"Untitled"},segmentDeleted:{id:"audience.feeds.list.column.segmentDeleted",defaultMessage:"Segment deleted"},artifactId:{id:"audience.feeds.list.column.artifactId",defaultMessage:"Connector"},createdFrom:{id:"audience.feeds.list.column.sourceType",defaultMessage:"Source type"},status:{id:"audience.feeds.list.column.status",defaultMessage:"Status"},EXTERNAL_FEED:{id:"audience.feeds.list.filter.externalFeed",defaultMessage:"Server Side"},TAG_FEED:{id:"audience.feeds.list.filter.tagFeed",defaultMessage:"Client Side"},filterArtifactId:{id:"audience.feeds.list.filter.artifactId",defaultMessage:"Connector"},filterStatus:{id:"audience.feeds.list.filter.status",defaultMessage:"Status"},INITIAL:{id:"audience.feeds.list.status.initial",defaultMessage:"Initial"},ACTIVE:{id:"audience.feeds.list.status.active",defaultMessage:"Active"},PAUSED:{id:"audience.feeds.list.status.paused",defaultMessage:"Paused"},PUBLISHED:{id:"audience.feeds.list.status.published",defaultMessage:"Published"},activate:{id:"audience.feeds.list.column.action.activate",defaultMessage:"Activate"},pause:{id:"audience.feeds.list.column.action.pause",defaultMessage:"Pause"},edit:{id:"audience.feeds.list.column.action.edit",defaultMessage:"Edit"},stats:{id:"audience.feeds.list.column.action.stats",defaultMessage:"Stats (BETA)"},delete:{id:"audience.feeds.list.column.action.delete",defaultMessage:"Delete"},audienceFeedsExportTitle:{id:"audience.feeds.actionbar.export.title",defaultMessage:"Audience Feed List"},audienceFeeds:{id:"audiencefeeds.actionbar.overview",defaultMessage:"Feeds Overview"},audienceFeedsList:{id:"audiencefeeds.actionbar.list",defaultMessage:"Feeds"},exportError:{id:"audienceFeeds.actionBar.export.error",defaultMessage:"There was an error generating your export please try again."},connectorType:{id:"audienceFeeds.actionBar.export.connectorType",defaultMessage:"Connector Type"},connectorName:{id:"audienceFeeds.actionBar.export.connectorName",defaultMessage:"Connector Name"},filterName:{id:"audienceFeeds.actionBar.export.filterName",defaultMessage:"Filter Name"},filterValues:{id:"audienceFeeds.actionBar.export.filterValues",defaultMessage:"Values"},filterAll:{id:"audienceFeeds.actionBar.export.filterAll",defaultMessage:"All"},date:{id:"audienceFeeds.actionBar.export.date",defaultMessage:"Date"},communityId:{id:"audienceFeeds.actionBar.export.comunnityId",defaultMessage:"Community ID"},communityName:{id:"audienceFeeds.actionBar.export.communityName",defaultMessage:"Community Name"},organisationId:{id:"audienceFeeds.actionBar.export.organisationId",defaultMessage:"Organisation ID"},organisationName:{id:"audienceFeeds.actionBar.export.orgnaisationName",defaultMessage:"Organisation Name"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({exportInProgress:{id:"export.in_progress",defaultMessage:"Export In Progress"},exportSuccess:{id:"export.success",defaultMessage:"Export Successful"},exportErrorNotificationTitle:{id:"export.error.title",defaultMessage:"Export Error"},exportErrorNotificationMessage:{id:"export.error.message",defaultMessage:"There was an export error"},audienceSegmentOverviewExportTitle:{id:"export.title.segment.overview",defaultMessage:"Audience Segment Overview"},audienceSegmentAdditionsDeletionsExportTitle:{id:"export.title.segment.additions_deletions",defaultMessage:"Audience Segment Add Del"},overlapExportTitle:{id:"segment.overlap.export_title",defaultMessage:"Audience Segment Overlap"},displayCampaignExportTitle:{id:"export.title.display.campaign",defaultMessage:"Display Campaign"},mediasExportTitle:{id:"export.title.medias",defaultMessage:"Medias"},adGroupsExportTitle:{id:"export.title.ad_groups",defaultMessage:"Ad Groups"},adsExportTitle:{id:"export.title.ads",defaultMessage:"Ads Export"},emailCampaignExportTitle:{id:"export.title.email.campaign",defaultMessage:"Email Campaign"},serviceUsageReportList:{id:"settings.datamart.seriveUsageReport.export.title",defaultMessage:"Serivce Usage Report List"},emailCampaignBlastExportTitle:{id:"export.title.email.campaign.blast",defaultMessage:"Email Campaign Blast"},providerOrganisationId:{id:"settings.datamart.seriveUsageReport.export.providerOrganisationId",defaultMessage:"Provider Organisation Id"},campaignId:{id:"settings.datamart.seriveUsageReport.export.campaign_id",defaultMessage:"Campaign Id"},serviceId:{id:"settings.datamart.seriveUsageReport.export.service_id",defaultMessage:"Service Id"},serviceElementId:{id:"settings.datamart.seriveUsageReport.export.serviceElementId",defaultMessage:"Service Element Id"},segmentName:{id:"settings.datamart.seriveUsageReport.export.segmentName",defaultMessage:"Segment Name"},serviceElementName:{id:"settings.datamart.seriveUsageReport.export.serviceElementName",defaultMessage:"Segment Element Name"},creativeName:{id:"settings.datamart.seriveUsageReport.export.CreativeName",defaultMessage:"Creative Snippets"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(6),s=n(107),l=n(11);function c(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var u=(0,i.defineMessages)({labelNoResults:{id:"components.labelsSelector.noResults",defaultMessage:"No Results"},labelButton:{id:"components.labelsSelector.label.button",defaultMessage:"Label"}}),d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.saveInputRef=function(e){return n.setState({input:e})},n.handleClose=function(e){var t=[].concat(c(n.props.selectedLabels.filter((function(t){return t.id!==e.id}))));n.props.onChange(t)},n.showInput=function(){n.setState({inputVisible:!0},(function(){return n.state.input&&n.state.input.focus()}))},n.handleInputChange=function(e){n.setState({inputValue:e.target.value})},n.handleInputConfirm=function(){var e=n.props.labels.find((function(e){return e.name===n.state.inputValue})),t=[].concat(c(n.props.selectedLabels));e&&t.push(e),n.props.onChange(t),n.setState({inputValue:"",inputVisible:!1})},n.handleVisibleChange=function(){n.setState({inputValue:"",inputVisible:!1})},n.state={inputVisible:!1,inputValue:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.labels,a=t.selectedLabels,c=t.buttonMessage,d=this.state,f=d.inputValue,p=d.inputVisible,m=function(t){return function(){e.handleClose(t)}},g=function(t){var n=e.props.labels.find((function(e){return e.id===t.key}));e.setState({inputValue:n&&n.name?n.name:""},(function(){e.handleInputConfirm()}))},y=n.filter((function(t){return t.name.includes(e.state.inputValue)&&!a.find((function(e){return e.id===t.id}))}));return r.createElement("div",{className:"mcs-labels"},a.map((function(e,t){var n=e.name.length>20,a=r.createElement(o.Tag,{className:"label",key:e.id,closable:!0,onClose:m(e)},n?e.name.slice(0,20)+"...":e.name);return n?r.createElement(o.Tooltip,{title:e.name,key:e.id},a):a})),p&&r.createElement(s.Dropdown,{overlay:r.createElement(o.Menu,{onClick:g,className:"mcs-label-dropdown",style:{}},y.length?y.map((function(e){return r.createElement(o.Menu.Item,{key:e.id},e.name)})):r.createElement(o.Menu.Item,{disabled:!0},r.createElement(i.FormattedMessage,u.labelNoResults))),visible:p,onVisibleChange:this.handleVisibleChange,trigger:["click"]},r.createElement(o.Input,{autoFocus:!0,id:"labelInput",ref:this.saveInputRef,type:"text",size:"small",style:{width:100,height:"22px",padding:"2px 7px"},value:f,onChange:this.handleInputChange,onPressEnter:this.handleInputConfirm,prefix:r.createElement(l.McsIcon,{type:"magnifier"})})),!p&&r.createElement(o.Button,{size:"small",className:"label-button",onClick:this.showInput},r.createElement(l.McsIcon,{type:"plus"}),r.createElement(i.FormattedMessage,c||u.labelButton)))}}]),t}(r.PureComponent);t.default=d},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DISPLAY_SEARCH_SETTINGS=void 0;var a=n(30);function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.DISPLAY_SEARCH_SETTINGS=[].concat(r(a.PAGINATION_SEARCH_SETTINGS),r(a.FILTERS_SEARCH_SETTINGS),r(a.KEYWORD_SEARCH_SETTINGS),r(a.DATE_SEARCH_SETTINGS),r(a.LABELS_SEARCH_SETTINGS))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=f(n(0)),o=f(n(203)),i=d(n(339)),s=n(6),l=n(8),c=d(n(17)),u=n(619);function d(e){return e&&e.__esModule?e:{default:e}}function f(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.formatSeries=function(e,t,a,r){var i=n.props.intl.formatMessage;return a.map((function(a,s){return{type:"area",data:e.map((function(e){var r=e[a.key];return[n.formatDateToTs(e[t],e.hour_of_day?e.hour_of_day:e.hour?e.hour:void 0),r&&"string"==typeof r?parseFloat(r):r]})),name:i(a.message),color:r[s],fillOpacity:.5,yAxis:s,fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,o.Color(r[s]).setOpacity(u.AREA_OPACITY).get("rgba")],[1,o.Color(r[s]).setOpacity(0).get("rgba")]]}}}))},n.formatDateToTs=function(e,t){return(0,c.default)(e).utc().seconds(0).hours((t||0)+24).milliseconds(0).minutes(0).valueOf()},n.formatXAxis=function(e,t){return e.map((function(e){return n.formatDateToTs(e[t])}))},n.generateMinValue=function(e,t){var n=[];return e.forEach((function(e){t.forEach((function(t){n.push(e[t.key])}))})),Math.min.apply(Math,n)},n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.dataset,n=e.options,a=n.xKey,s=n.yKeys,l=n.colors,c=n.isDraggable,d=n.onDragEnd,f=e.style,p=e.intl,m={chart:Object.assign({height:u.BASE_CHART_HEIGHT},c?(0,u.generateDraggable)(d):{}),title:{text:""},colors:l,plotOptions:{area:{animation:!0,marker:{radius:4,symbol:"circle"},lineWidth:1,states:{hover:{lineWidth:1}},threshold:0}},xAxis:Object.assign({type:"datetime",dateTimeLabelFormats:{month:{main:"%e. %b"},year:{main:"%b"}}},(0,u.generateXAxisGridLine)()),time:{useUTC:!0},yAxis:[Object.assign({title:{text:p.formatMessage(s[0].message)}},(0,u.generateYAxisGridLine)()),{title:{text:p.formatMessage(s[1].message)},opposite:!0}],series:this.formatSeries(t,a,s,l),credits:{enabled:!1},tooltip:Object.assign({shared:!0},(0,u.generateTooltip)()),legend:{enabled:!1}};return r.createElement("div",{style:f},r.createElement(i.default,{highcharts:o,options:m,style:{width:"100%"}}))}}]),t}(r.Component);t.default=(0,l.compose)(s.injectIntl)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(10),l=n(13),c=n(6),u=n(107),d=S(n(2052)),f=n(11),p=n(30),m=n(181),g=S(n(114)),y=n(61),h=n(112),v=S(n(23)),b=n(15),_=n(12);function S(e){return e&&e.__esModule?e:{default:e}}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=(0,c.defineMessages)({setStatus:{id:"display.campaigns.dashboard.adCard.status.setStatusTo",defaultMessage:"Set status to"},auditAction:{id:"display.campaigns.dashboard.adCard.auditAction",defaultMessage:"Audit Action"},activeAll:{id:"display.campaigns.dashboard.adCard.status.activeAll",defaultMessage:"Active"},pauseAll:{id:"display.campaigns.dashboard.adCard.status.pauseAll",defaultMessage:"Paused"},startAll:{id:"display.campaigns.dashboard.adCard.status.startAll",defaultMessage:"Start"},resetAll:{id:"display.campaigns.dashboard.adCard.status.resetAll",defaultMessage:"Reset"},archiveSuccess:{id:"display.campaigns.dashboard.adCard.archive.successMsg",defaultMessage:"Creatives successfully archived"}}),w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleAdModalOk=function(){var e=n.props.intl;n.setState({adModalvisible:!1,selectedRowKeys:[]}),s.message.success(e.formatMessage(O.archiveSuccess))},n.handleCancel=function(){n.setState({adModalvisible:!1})},n.archiveAds=function(){n.setState({adModalvisible:!0})},n.selectAllItemIds=function(){n.setState({allRowsAreSelected:!0})},n.unselectAllItemIds=function(){n.setState({selectedRowKeys:[],allRowsAreSelected:!1})},n.unsetAllItemsSelectedFlag=function(){n.setState({allRowsAreSelected:!1})},n.onSelectAdRowChange=function(e){n.setState({selectedRowKeys:e})},n.handleStatusAction=function(e){var t=n.state,a=t.allRowsAreSelected,r=t.selectedRowKeys,o=n.props,i=o.dataSet,s=o.updateAd;n.setState({isUpdatingStatuses:!0});var l=[];l=a&&i?i.map((function(e){return e.id})):r;var c=[];l.forEach((function(t){c.push((function(){return s(t,{status:e})}))})),(0,h.executeTasksInSequence)(c).then((function(){n.setState({selectedRowKeys:[],allRowsAreSelected:!1,isUpdatingStatuses:!1})})).catch((function(e){n.setState({isUpdatingStatuses:!1})}))},n.handleAuditAction=function(e){var t=n.state,a=t.allRowsAreSelected,r=t.selectedRowKeys,o=n.props,i=o.dataSet,s=o.notifyError,l=[];a&&i?l=i.map((function(e){return e.creative_id})):i&&(l=i.filter((function(e){return r.includes(e.id)})).map((function(e){return e.creative_id})));var c=[];l.forEach((function(t){c.push((function(){return n._creativeService.getDisplayAd(t).then((function(e){return e.data})).then((function(t){t.available_user_audit_actions.includes(e)&&n._creativeService.makeAuditAction(t.id,e)}))}))})),(0,h.executeTasksInSequence)(c).then((function(){n.setState({selectedRowKeys:[],allRowsAreSelected:!1})})).catch((function(e){s(e)}))},n.buildMenu=function(){return o.createElement(s.Menu,{onClick:function(e){switch(e.key){case"pause":return n.handleStatusAction("PAUSED");case"activate":return n.handleStatusAction("ACTIVE")}}},o.createElement(s.Menu.Item,{key:"pause"},o.createElement(c.FormattedMessage,O.pauseAll)),o.createElement(s.Menu.Item,{key:"activate"},o.createElement(c.FormattedMessage,O.activeAll)))},n.buildAuditMenu=function(){return o.createElement(s.Menu,{onClick:function(e){switch(e.key){case"start":return n.handleAuditAction("START_AUDIT");case"reset":return n.handleAuditAction("RESET_AUDIT")}}},o.createElement(s.Menu.Item,{key:"start"},o.createElement(c.FormattedMessage,O.startAll)),o.createElement(s.Menu.Item,{key:"reset"},o.createElement(c.FormattedMessage,O.resetAll)))},n.state={adModalvisible:!1,selectedRowKeys:[],allRowsAreSelected:!1,isArchivingAds:!1,isUpdatingStatuses:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"updateLocationSearch",value:function(e){var t=this.props,n=t.history,a=t.location,r=a.search,o={pathname:a.pathname,search:(0,p.updateSearch)(r,e,m.DISPLAY_DASHBOARD_SEARCH_SETTINGS)};n.push(o)}},{key:"renderDatePicker",value:function(){var e=this,t=this.props.location.search,n=(0,p.parseSearch)(t,m.DISPLAY_DASHBOARD_SEARCH_SETTINGS),a={from:n.from,to:n.to};return o.createElement(f.McsDateRangePicker,{values:a,onChange:function(t){return e.updateLocationSearch({from:t.from,to:t.to})}})}},{key:"render",value:function(){var e=this,t=this.props,n=t.title,a=t.isFetching,r=t.isFetchingStat,i=t.dataSet,l=t.updateAd,p=t.additionalButtons,m=this.state,y=m.selectedRowKeys,h=m.allRowsAreSelected,v=m.isUpdatingStatuses,b=!!(y&&y.length>0),_=o.createElement("span",null,p,this.renderDatePicker(),b?o.createElement(s.Modal,{title:o.createElement(c.FormattedMessage,g.default.archiveAdsModalTitle),visible:this.state.adModalvisible,onOk:this.handleAdModalOk,onCancel:this.handleCancel},o.createElement("p",null,o.createElement(c.FormattedMessage,g.default.archiveAdsModalMessage))):null,o.createElement(f.Slide,{toShow:b,horizontal:!0,content:o.createElement(s.Button,{className:"m-r-10 button-slider button-glow",onClick:this.archiveAds},o.createElement(f.McsIcon,{type:"delete"}),o.createElement(c.FormattedMessage,g.default.archiveAdGroup))}),o.createElement(f.Slide,{toShow:b,horizontal:!0,content:o.createElement(u.Dropdown,{overlay:e.buildMenu(),trigger:["click"]},o.createElement(s.Button,{className:"button-glow"},o.createElement(f.McsIcon,{type:"chevron"}),o.createElement(c.FormattedMessage,O.setStatus)))}),o.createElement(f.Slide,{toShow:b,horizontal:!0,content:o.createElement(u.Dropdown,{overlay:e.buildAuditMenu(),trigger:["click"]},o.createElement(s.Button,{className:"button-glow",style:{marginRight:"20px"}},o.createElement(f.McsIcon,{type:"chevron"}),o.createElement(c.FormattedMessage,O.auditAction)))})),S={selectedRowKeys:y,allRowsAreSelected:h,selectAllItemIds:this.selectAllItemIds,unselectAllItemIds:this.unselectAllItemIds,onChange:this.onSelectAdRowChange,onSelectAll:this.unsetAllItemsSelectedFlag,onSelect:this.unsetAllItemsSelectedFlag};return o.createElement(f.Card,{title:n,buttons:_},o.createElement("hr",null),o.createElement(d.default,{isFetching:a||v,isFetchingStat:r,dataSet:i,updateAd:l,rowSelection:S}))}}]),t}(o.Component);E([(0,b.lazyInject)(_.TYPES.ICreativeService)],w.prototype,"_creativeService",void 0),t.default=(0,i.compose)(c.injectIntl,l.withRouter,y.injectDrawer,v.default)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initialPageState={campaign:{data:{items:[],isLoading:!1,isUpdating:!1,isArchiving:!1},overallPerformance:{items:[],isLoading:!1,isUpdating:!1,isArchiving:!1},performance:{items:[],isLoading:!1,isUpdating:!1,isArchiving:!1},mediaPerformance:{items:[],isLoading:!1,isUpdating:!1,isArchiving:!1}},adGroups:{data:{items:{},isLoading:!1,isUpdating:!1,isArchiving:!1,adGroupCampaign:{}},performance:{items:{},isLoading:!1,isUpdating:!1,isArchiving:!1}},ads:{data:{items:{},adGroupCampaign:{},isLoading:!1,isUpdating:!1,isArchiving:!1},performance:{items:{},isLoading:!1,isUpdating:!1,isArchiving:!1}},goals:{items:[],isLoading:!1,isUpdating:!1,isArchiving:!1}},t.initialAdGroupPageState={campaign:{data:{items:[],isLoading:!1,isUpdating:!1,isArchiving:!1}},adGroups:{data:{items:[],isLoading:!1,isUpdating:!1,isArchiving:!1},overallPerformance:{items:[],isLoading:!1,isUpdating:!1,isArchiving:!1},performance:{items:[],isLoading:!1,isUpdating:!1,isArchiving:!1},mediaPerformance:{items:[],isLoading:!1,isUpdating:!1,isArchiving:!1}},ads:{data:{items:{},adGroupCampaign:{},isLoading:!1,isUpdating:!1,isArchiving:!1},performance:{items:{},isLoading:!1,isUpdating:!1,isArchiving:!1}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=t.InventoryCatalogFieldArray=t.AdFieldArray=t.LocationTargetingFieldArray=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=w(n(0)),i=n(35),s=n(25),l=n(10),c=n(8),u=n(13),d=O(n(2069)),f=O(n(95)),p=O(n(60)),m=O(n(101)),g=n(2070),y=n(2072),h=O(n(2078)),v=O(n(2081)),b=O(n(2083)),_=w(n(67)),S=O(n(1022)),E=O(n(1025));function O(e){return e&&e.__esModule?e:{default:e}}function w(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var T=l.Layout.Content,I=i.FieldArray,A=i.FieldArray,C=t.LocationTargetingFieldArray=i.FieldArray,j=t.AdFieldArray=i.FieldArray,R=(t.InventoryCatalogFieldArray=i.FieldArray,t.FORM_ID="adGroupForm"),N=function(e){function t(){M(this,t);var e=P(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFormSections=function(){var t=e.props,n=t.match.params.organisationId,r=t.change,i=t.initialValues,s=t.hasDatamarts,l={formChange:r,rerenderOnEveryChange:!0},c=!(!i.adGroup||!i.adGroup.name),u=[],p={id:"general",title:f.default.sectionTitleGeneral,component:o.createElement(g.GeneralFormSection,null)},m={id:"summary",title:f.default.sectionTitleSummary,component:o.createElement(y.SummaryFormSection,null)},_={id:"audience",title:f.default.sectionTitleAudience,component:o.createElement(d.default,{featureName:"campaigns.display.edition.audience_catalog",enabledComponent:o.createElement(A,a({name:"segmentFields",component:b.default},l)),disabledComponent:o.createElement(I,a({name:"segmentFields",component:v.default},l))})},O={id:"location",title:f.default.sectionTitleLocationTargeting,component:o.createElement(C,a({name:"locationFields",component:h.default},l))},w={id:"device",title:f.default.sectionTitleDevice,component:o.createElement(E.default,{formChange:e.props.change,initialValues:e.props.initialValues.adGroup})},M={id:"display",title:f.default.sectionTitleAds,component:o.createElement(j,a({name:"adFields",component:S.default},l))};u.push(p),s(n)&&u.push(_),u.push(w),u.push(O),u.push(M);var P=c?0:u.length;return u.splice(P,0,m),u},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.close,r={formId:R,paths:t,message:f.default.saveAdGroup,onClose:a},s=this.buildFormSections(),c={items:s.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:R},u=s.map((function(e,t){return o.createElement("div",{key:e.id},o.createElement("div",{key:e.id,id:e.id},e.component),t!==s.length-1&&o.createElement("hr",null))}));return o.createElement(l.Layout,{className:"edit-layout"},o.createElement(p.default,r),o.createElement(l.Layout,{className:"ant-layout-has-sider"},o.createElement(m.default,c),o.createElement(i.Form,{className:"edit-layout ant-layout",onSubmit:n},o.createElement("button",{type:"submit",style:{display:"none"}}),o.createElement(T,{id:R,className:"mcs-content-container mcs-form-container"},o.createElement("div",{className:"ad-group-form"},u)))))}}]),t}(o.Component);t.default=(0,c.compose)(u.withRouter,(0,i.reduxForm)({form:R,enableReinitialize:!0}),(0,s.connect)((function(e){return{hasDatamarts:_.hasDatamarts(e)}})))(N)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(11),s=n(6);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=(0,s.defineMessages)({removeRecordElement:{id:"popconfirm.remove.record.element",defaultMessage:"Are you sure delete this item?"}}),d=function(e){function t(){l(this,t);var e=c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.editTableField=function(){return e.props.onEdit&&e.props.onEdit(e.props.record)},e.removeTableField=function(){return e.props.onRemove&&e.props.onRemove(e.props.record)},e.computeDataClass=function(){var t=e.props,n=t.additionalData,a=t.additionalActionButtons;return n&&a?"additional-data-action-buttons":n||a?"additional-data":"data"},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.recordIconType,n=e.title,a=e.additionalData,s=e.additionalActionButtons,l=e.onEdit,c=e.onRemove,d=e.record,f=e.intl,p=e.editable,m=void 0!==p&&!1===p,g=(m?"non-editable-related-record":"related-record")+" row-height",y=m?void 0:r.createElement(r.Fragment,null,s&&r.createElement(o.Col,{className:this.computeDataClass()+" text-right m-r-20"},s(d)),l&&r.createElement(i.Button,{className:"action-button",onClick:this.editTableField},r.createElement(i.McsIcon,{type:"pen",className:"big"})),c&&r.createElement(o.Popconfirm,{title:f.formatMessage(u.removeRecordElement),onConfirm:this.removeTableField,okText:"Yes",cancelText:"No"},r.createElement("div",{className:"action-button",style:{cursor:"pointer"}},r.createElement(i.McsIcon,{type:"delete",className:"big"}))));return r.createElement(o.Row,{className:g},t&&r.createElement(o.Col,{style:{width:60}},r.createElement("div",{className:"icon-round-border"},r.createElement(i.McsIcon,{type:t}))),r.createElement(o.Col,{className:this.computeDataClass()},n(d)),a&&r.createElement(o.Col,{className:this.computeDataClass()},a(d)),y)}}]),t}(r.Component);t.default=(0,s.injectIntl)(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(618),l=(a=s)&&a.__esModule?a:{default:a};function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=function(e){function t(){return c(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.emptyOption,a=e.isLoading;return o.createElement(i.Spin,{spinning:a},o.Children.count(t)>0?o.createElement("div",{className:"related-records-container"},t):o.createElement(l.default,n))}}]),t}(o.Component);d.defaultProps={isLoading:!1},t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=m(n(1023)),l=n(13),c=n(6),u=n(44),d=m(n(808)),f=n(15),p=n(12);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},y=n(11).CollectionSelector,h=d.default,v=(0,c.defineMessages)({titleForEmailTemplates:{id:"creative-email-selector-title",defaultMessage:"Add Email Templates"},placeholderForEmailTemplates:{id:"creative-email-selector-search-placeholder",defaultMessage:"Search Email Templates"},placeholderForDisplayAd:{id:"creative-display-selector-search-placeholder",defaultMessage:"Search Ads"},titleForDisplayAd:{id:"creative-display-selector-title",defaultMessage:"Add Display Ads"},selectButton:{id:"creative-display-selector-select-button",defaultMessage:"Select"},selectButtonSelected:{id:"creative-display-selector-select-button-selected",defaultMessage:"Selected !"},addElementText:{id:"creative-card-selector.add",defaultMessage:"Add"}}),b=["DISPLAY_AD","EMAIL_TEMPLATE"],_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.fetchCreatives=function(e){var t=n.props,a=t.creativeType,r=t.match.params.organisationId,o=Object.assign({},(0,u.getPaginatedApiParam)(e.currentPage,e.pageSize));return e.keywords&&(o.keywords=[e.keywords]),"EMAIL_TEMPLATE"===a?(o.archived=!1,n._creativeService.getEmailTemplates(r,o)):n._creativeService.getDisplayAds(r,o)},n.fetchCreative=function(e){return n._creativeService.getCreative(e)},n.renderCreativeTitle=function(e){return o.createElement("span",null,e.name?e.name:"No Title")},n.renderCreativeFooter=function(e,t){return function(n){var a={onClick:function(){return t(n)}},r=v.selectButton;return e&&(r=v.selectButtonSelected,a.className="mcs-primary",a.type="primary"),o.createElement(s.default,a,o.createElement(c.FormattedMessage,r))}},n.renderCreative=function(e,t,a){return o.createElement(h,{key:e.id,creative:e,renderTitle:n.renderCreativeTitle,renderFooter:n.renderCreativeFooter(t,a)})},n.saveCreatives=function(e,t){n.props.save(t)};var a=n.props.creativeType;if(!b.includes(a))throw new Error("Unsupported creative type "+a);return n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.creativeType,n=e.singleSelection,a=e.selectedCreativeIds,r=e.intl.formatMessage,i=e.close,s=""+t,l=""+t;return"DISPLAY_AD"===t?(s=r(v.titleForDisplayAd),l=r(v.placeholderForDisplayAd)):"EMAIL_TEMPLATE"===t&&(s=r(v.titleForEmailTemplates),l=r(v.placeholderForEmailTemplates)),o.createElement(y,{actionBarTitle:s,displayFiltering:!0,searchPlaceholder:l,selectedIds:a,singleSelection:n,fetchDataList:this.fetchCreatives,fetchData:this.fetchCreative,renderCollectionItem:this.renderCreative,save:this.saveCreatives,close:i,addButtonText:r(v.addElementText),noElementText:""})}}]),t}(o.Component);g([(0,f.lazyInject)(p.TYPES.ICreativeService)],_.prototype,"_creativeService",void 0),t.default=(0,i.compose)(c.injectIntl,l.withRouter)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(47),c=(a=l)&&a.__esModule?a:{default:a},u=n(44),d=n(15),f=n(12),p=n(11);var m=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchScreenshotIfNeeded=function(e){e.id&&(n.cancelablePromise=(0,u.makeCancelable)(n._creativeService.getCreativeScreenshotStatus(e.id)),n.cancelablePromise.promise.then((function(e){n.setState({creativeScreenshot:e.data})})).catch((function(e){n.setState({error:e})})))},n.renderScreenshot=function(){var e=n.props.creative,t=n.state.creativeScreenshot;if(t){if("PENDING"===t.status||"PROCESSING"===t.status)return i.createElement("div",{className:"text-center",style:{lineHeight:"200px",textAlign:"center",backgroundColor:"#bdbdbd"}},i.createElement(s.Spin,null));if("SUCCEEDED"===t.status)return i.createElement("div",null,i.createElement("div",{className:"background-image",style:{backgroundImage:"url('https://ads.mediarithmics.com/ads/screenshot?rid="+e.id+"')"}}),i.createElement("div",{className:"image-container"},i.createElement("div",{className:"helper"}),i.createElement("img",{className:"image",src:"https://ads.mediarithmics.com/ads/screenshot?rid="+e.id,alt:e.name})))}return i.createElement("div",{className:"text-center",style:{lineHeight:"210px",textAlign:"center",backgroundColor:"#bdbdbd"}},i.createElement(p.McsIcon,{className:"mcs-icon-3x",type:"close-big"}))},n.state={creativeScreenshot:null},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.fetchScreenshotIfNeeded(this.props.creative)}},{key:"componentDidUpdate",value:function(e){var t=this.props.creative;t.id!==e.creative.id&&this.fetchScreenshotIfNeeded(t)}},{key:"componentWillUnmount",value:function(){this.cancelablePromise&&this.cancelablePromise.cancel()}},{key:"render",value:function(){var e=this.props,t=e.creative,n=e.renderTitle,a=e.renderSubtitles,r=e.renderFooter,o=n?n(t):t?t.name:"No title";return i.createElement("div",{className:"mcs-creative-card"},i.createElement("div",{className:"creative-cover"},this.renderScreenshot()),i.createElement("div",{className:"creative-details"},i.createElement("div",{className:"title"},i.createElement("strong",null,o)),a&&a.length>0&&a.map((function(e){return i.createElement("div",{key:(0,c.default)(),className:"subtitle"},i.createElement("span",null,e(t)))}))),i.createElement("div",{className:"creative-footer"},r(t)))}}]),t}(i.Component);m([(0,d.lazyInject)(f.TYPES.ICreativeService)],g.prototype,"_creativeService",void 0),t.default=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.creativeAuditStatusMessages=t.auditIconConfig=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(11);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=function(e){function t(){return s(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.auditStatus||"NOT_AUDITED";return r.createElement("div",null,r.createElement(i.McsIcon,{type:u[e].type,className:"m-r-10",style:{verticalAlign:"middle",color:u[e].color}}),r.createElement(o.FormattedMessage,d[e]))}}]),t}(r.Component);t.default=c;var u=t.auditIconConfig={NOT_AUDITED:{type:"close-big",color:"#fc3f48"},AUDIT_PENDING:{type:"refresh",color:"#fd7c12"},AUDIT_FAILED:{type:"close-big",color:"#fc3f48"},AUDIT_PASSED:{type:"check",color:"#00ab67"},AUDIT_PARTIALLY_PASSED:{type:"close-big",color:"#fd7c12"}},d=t.creativeAuditStatusMessages=(0,o.defineMessages)({NOT_AUDITED:{id:"creatives.audit.status.notAudited",defaultMessage:"Not Audited"},AUDIT_PENDING:{id:"creatives.audit.status.pending",defaultMessage:"Audit Pending"},AUDIT_FAILED:{id:"creatives.audit.status.failed",defaultMessage:"Audit Failed"},AUDIT_PASSED:{id:"creatives.audit.status.passed",defaultMessage:"Audit Success"},AUDIT_PARTIALLY_PASSED:{id:"creatives.audit.status.partiallypassed",defaultMessage:"Audit Partially Passed"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(35),i=n(8),s=n(10),l=n(2094),c=f(n(811)),u=f(n(60)),d=f(n(101));function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=s.Layout.Content,y=o.FieldArray,h=t.FORM_ID="goalForm",v=function(e){function t(){return p(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.close,i=e.goToTriggerTypeSelection,f={general:{sectionId:"general",title:c.default.sectionTitle1},conversion_value:{sectionId:"conversion_value",title:c.default.sectionTitle2},trigger:{sectionId:"trigger",title:c.default.sectionTitle3},attribution_models:{sectionId:"attribution_models",title:c.default.sectionTitle4}},p={formId:h,paths:t,message:c.default.saveGoal,onClose:a},m={items:Object.values(f),scrollId:h};return i&&m.items.unshift({sectionId:"type",title:c.default.goalFormSiderMenuTriggerType,onClick:i,type:"validated"}),r.createElement(s.Layout,{className:"edit-layout"},r.createElement(u.default,p),r.createElement(s.Layout,{className:"ant-layout-has-sider"},r.createElement(d.default,m),r.createElement(o.Form,{className:"edit-layout ant-layout",onSubmit:n},r.createElement("button",{type:"submit",style:{display:"none"}}),r.createElement(g,{id:h,className:"mcs-content-container mcs-form-container"},r.createElement("div",{id:f.general.sectionId},r.createElement(l.GeneralFormSection,null)),r.createElement("hr",null),r.createElement("div",{id:f.conversion_value.sectionId},r.createElement(l.ConversionValueFormSection,{initialValues:this.props.initialValues,formChange:this.props.change})),r.createElement("hr",null),r.createElement("div",{id:f.trigger.sectionId},r.createElement(l.TriggerFormSection,{initialValues:this.props.initialValues,formChange:this.props.change,datamart:this.props.datamart})),r.createElement("hr",null),r.createElement("div",{id:f.attribution_models.sectionId},r.createElement(y,{name:"attributionModels",component:l.AttributionModelFormSection,formChange:this.props.change,rerenderOnEveryChange:!0}))))))}}]),t}(r.Component);t.default=(0,i.compose)((0,o.reduxForm)({form:h,enableReinitialize:!0}))(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({saveGoal:{id:"message.submit.goalSimple",defaultMessage:"Save"},breadcrumbTitle1:{id:"goalSimpleEditor.breadcrumb.title",defaultMessage:"Create a new Goal"},dropdownNew:{id:"goalSimpleEditor.dropdown.new",defaultMessage:"New"},dropdownAdd:{id:"goalSimpleEditor.dropdown.add",defaultMessage:"Add"},dropdownAddExisting:{id:"goalSimpleEditor.dropdown.addExisting",defaultMessage:"Add existing"},goalFormSiderMenuTriggerType:{id:"goal.form.sider.menu.trigger.type",defaultMessage:"Trigger Type"},sectionTitle1:{id:"goalSimpleEditor.section.title1",defaultMessage:"General Information"},sectionTitle2:{id:"goalSimpleEditor.section.title2",defaultMessage:"Conversion Value"},sectionTitle3:{id:"goalSimpleEditor.section.title3",defaultMessage:"Trigger"},sectionTitle4:{id:"goalSimpleEditor.section.title4",defaultMessage:"Attribution Models"},sectionSubtitle1:{id:"goalSimpleEditor.section.subtitle1",defaultMessage:"Give your Goal a name."},sectionSubtitle2:{id:"goalSimpleEditor.section.subtitle2",defaultMessage:"Choose your Attribution Window to get advantage of custom reporting."},contentSectionGeneralRow1Label:{id:"goalSimpleEditor.section.general.row1.label",defaultMessage:"Goal Name"},contentSectionGeneralRow1Placeholder:{id:"goalSimpleEditor.section.general.row1.placeholder",defaultMessage:"Goal Name"},contentSectionGeneralRow1Tooltip:{id:"goalSimpleEditor.section.general.row1.tooltip",defaultMessage:"The Goal's name will help you identify it on the different screens. Make it as memorable as you want your results to be!"},contentSectionGeneralAdvancedPartTitle:{id:"goalSimpleEditor.section.general.advancedPart.title",defaultMessage:"Advanced"},contentSectionGeneralAdvancedPartRow1Label:{id:"goalSimpleEditor.section.general.advanced.row1.label",defaultMessage:"Technical Name"},contentSectionGeneralAdvancedPartRow1Placeholder:{id:"goalSimpleEditor.section.general.advanced.row1.placeholder",defaultMessage:"Technical Name"},contentSectionGeneralAdvancedPartRow1Tooltip:{id:"goalSimpleEditor.section.general.advanced.row1.tooltip",defaultMessage:"Use the Technical Name for custom integration with other DSPs"},contentSection2Row1Label:{id:"goalSimpleEditor.section2.row1.label",defaultMessage:"Post View"},contentSection2Row1Placeholder:{id:"goalSimpleEditor.section2.row1.placeholder",defaultMessage:"Post View"},contentSection2Row1Tooltip:{id:"goalSimpleEditor.section2.row1.tooltip",defaultMessage:"Attribution Window is in Days and can be between 0 and 30 days."},contentSection2Row2Label:{id:"goalSimpleEditor.section2.row2.label",defaultMessage:"Post Click"},contentSection2Row2Placeholder:{id:"goalSimpleEditor.section2.row2.placeholder",defaultMessage:"Post Click"},contentSection2Row2Tooltip:{id:"goalSimpleEditor.section2.row2.tooltip",defaultMessage:"Attribution Window is in Days and can be between 0 and 30 days."}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(51);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=function(e){function t(){return s(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){return o.createElement(i.OtqlConsole,a({value:this.props.input.value,datamartId:this.props.datamartId},this.props.inputProps,{onChange:this.props.input.onChange,showPrintMargin:!1,height:"250px",width:"100%",enableBasicAutocompletion:!0,enableLiveAutocompletion:!0}))}}]),t}(o.Component);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=O(n(0)),s=n(8),l=n(10),c=n(6),u=n(25),d=E(n(2100)),f=n(51),p=O(n(67)),m=E(n(23)),g=n(13),y=n(127),h=n(419),v=n(15),b=n(12),_=n(138),S=n(73);function E(e){return e&&e.__esModule?e:{default:e}}function O(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function w(e){return Array.isArray(e)?e:Array.from(e)}function M(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var P=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},T=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchObjectTypes=function(e){return n._runtimeSchemaService.getRuntimeSchemas(e).then((function(t){var a=t.data.find((function(e){return"LIVE"===e.status}));return a?n._runtimeSchemaService.getObjectTypeInfoResources(e,a.id):[]}))},n.handleUpdateQuery=function(e){n.setState((function(t){var n=e;return{queryHistory:{past:[].concat(M(t.queryHistory.past),[t.queryHistory.present]),present:n,future:[]},staleQueryResult:!0,queryResult:Object.assign(Object.assign({},t.queryResult),{error:void 0})}}))},n.handleUndo=function(){n.setState((function(e){var t=e.queryHistory,n=t.past,a=t.present,r=t.future,o=n[n.length-1];return{queryHistory:{past:n.slice(0,n.length-1),present:o,future:[a].concat(M(r))},staleQueryResult:!0,queryResult:Object.assign(Object.assign({},e.queryResult),{error:void 0})}}))},n.handleRedo=function(){n.setState((function(e){var t=e.queryHistory,n=t.past,a=t.present,r=t.future,o=r[0],i=r.slice(1);return{queryHistory:{past:[].concat(M(n),[a]),present:o,future:i},staleQueryResult:!0,queryResult:Object.assign(Object.assign({},e.queryResult),{error:void 0})}}))},n.runFieldProposal=function(e,t){var r=n.props,o=r.datamartId,i=r.isTrigger,s=r.hasFeature,l=r.isEdge,c=n.state,u=c.queryHistory.present,d=c.objectTypes;if(!s("audience-segment_builder-reference_table"))return Promise.resolve([]);var f=d.length?(0,y.computeFinalSchemaItem)(d,"UserPoint",!i,i||!1,l||!1):void 0,p="SELECT "+function e(t,n){if(!n)throw new Error("please provide a schema");if(1===t.length){var r=a(t,1)[0];return"{ "+n.fields[r].name+" @map(limit:10000) }"}var o=w(t),i=o[0],s=o.slice(1),l=n.fields[i];return"{ "+l.name+" "+e(s,l)+" }"}((0,y.computeSchemaPathFromQueryPath)(u,e,f,t),f)+" FROM UserPoint";return n._queryService.runOTQLQuery(o,p,{use_cache:!0}).then((function(e){if((0,_.isAggregateResult)(e.data.rows))return e.data.rows[0];throw new Error("err")})).then((function(e){return e.aggregations.buckets[0]})).then((function(e){return e.buckets.map((function(e){return e.key}))})).catch((function(){return[]}))},n.handleCopy=function(e){n.setState((function(t){return Object.assign(Object.assign({},t),{copyQuery:e})}))},n.runQuery=function(e){var t=n.props.datamartId,a={operations:[{directives:[{name:"count"}],selections:[]}],from:"UserPoint",where:n.state.queryHistory.present};n.setState({staleQueryResult:!1,queryResult:{loading:!0}}),n._queryService.runJSONOTQLQuery(t,a).then((function(e){n.setState({queryResult:{loading:!1,otqlResult:e.data}})})).catch((function(e){n.setState({queryResult:{loading:!1,error:e}})}))},n.state={fetchingObjectTypes:!1,staleQueryResult:!1,queryResult:{loading:!1},objectTypes:[],queryHistory:{past:[],present:void 0,future:[]}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.datamartId,n=e.queryId;this.loadData(t,n)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.datamartId,a=t.queryId,r=e.datamartId,o=e.queryId;r===n&&a===o||this.loadData(n,a)}},{key:"loadData",value:function(e,t){var n=this;this.setState({fetchingObjectTypes:!0}),Promise.all([this.fetchObjectTypes(e),t?this._queryService.getQuery(e,t).then((function(e){return e.data})):Promise.resolve(null)]).then((function(t){var r=a(t,2),o=r[0];r[1];n.setState((function(e){return{fetchingObjectTypes:!1,objectTypes:o.map((function(e){return Object.assign(Object.assign({},e),{fields:e.fields.sort((function(e,t){return e.name.localeCompare(t.name)}))})})).sort((function(e,t){return e.name.localeCompare(t.name)})),queryHistory:{past:[],present:n.props.queryDocument?n.props.queryDocument.where:void 0,future:[]}}}),(function(){n.runQuery(e)}))})).catch((function(e){n.props.notifyError(e),n.setState({fetchingObjectTypes:!1})}))}},{key:"render",value:function(){var e=this.props,t=e.editionLayout,n=e.renderActionBar,a=e.datamartId,r=e.match.params.organisationId,o=e.isTrigger,s=e.isEdge,c=e.hideCounterAndTimeline,u=this.state,p=u.fetchingObjectTypes,m=u.objectTypes,g=u.queryHistory.present,v=u.queryResult,b=u.staleQueryResult;if(p)return i.createElement(f.Loading,{isFullScreen:!0});var _=this.state.queryHistory.past.length>0,S=this.state.queryHistory.future.length>0,E=m.length?(0,y.computeFinalSchemaItem)(m,"UserPoint",!o,o||!1,s||!1):void 0;return i.createElement(l.Layout,{className:t?"edit-layout":""},n({operations:[{directives:[],selections:[{name:"id"}]}],from:"UserPoint",where:g},a),i.createElement(l.Layout.Content,{className:"mcs-content-container "+(t?"flex-basic":""),style:{padding:0,overflow:"hidden"}},i.createElement(h.JSONQLBuilderContext.Provider,{value:{query:g,schema:E,isTrigger:!!this.props.isTrigger,isEdge:!!this.props.isEdge,runFieldProposal:this.runFieldProposal}},i.createElement(d.default,{objectTypes:m,query:g,updateQuery:this.handleUpdateQuery,undoRedo:{enableUndo:_,enableRedo:S,handleUndo:this.handleUndo,handleRedo:this.handleRedo},edition:t,runQuery:this.runQuery,staleQueryResult:b,queryResult:v,datamartId:this.props.datamartId,organisationId:r,hideCounterAndTimeline:c}))))}}]),t}(i.Component);P([(0,v.lazyInject)(b.TYPES.IQueryService)],T.prototype,"_queryService",void 0),P([(0,v.lazyInject)(b.TYPES.IRuntimeSchemaService)],T.prototype,"_runtimeSchemaService",void 0),t.default=(0,s.compose)(g.withRouter,c.injectIntl,m.default,S.injectFeatures,(0,u.connect)((function(e){return{getWorkspace:p.getWorkspace}})))(T)},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"simple"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(n(89).LinkModel);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=t.frequencyModeMessageMap=void 0;var a=n(6);t.frequencyModeMessageMap=(0,a.defineMessages)({AT_LEAST:{id:"objectNode.frequency.mode.at-least",defaultMessage:"At least"},AT_MOST:{id:"objectNode.frequency.mode.at-most",defaultMessage:"At most"}}),t.messages=(0,a.defineMessages)({queryHasChanged:{id:"jsonOtqlFormSection.queryHasChangedWarningMessage",defaultMessage:"Warning: you have edited your query but it is not saved yet. Please click on the Save button to save your modifications."}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(127),s=u(n(2170)),l=u(n(2171)),c=u(n(47));function u(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=function(e){function t(){return d(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){var e=this.props,t=e.schema,n=e.disableDragAndDrop;return t?r.createElement(o.Tree,{treeData:function e(t,a){return t&&t.fields.map((function(t){return(0,i.isSchemaItem)(t)?{title:n?r.createElement(l.default,{id:t.id,item:t,type:"object"}):r.createElement(s.default,{id:t.id,item:t,type:"object"}),key:(0,c.default)(),selectable:!1,children:e(t,t.schemaType)}:{title:n?r.createElement(l.default,{id:t.id,type:"field",schemaType:a,item:t}):r.createElement(s.default,{id:t.id,type:"field",schemaType:a,item:t}),key:(0,c.default)(),selectable:!1}}))}(t)}):null}}]),t}(r.Component);t.default=p},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(2187),s=(a=i)&&a.__esModule?a:{default:a},l=n(11);var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={layout:[]},n.onLayoutChange=n.onLayoutChange.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"onLayoutChange",value:function(e,t){this.setState({layout:e})}},{key:"render",value:function(){var e=this.props,t=e.source,n=e.layout,a=e.title,r=e.datamartId;return o.createElement("div",null,o.createElement(l.ContentHeader,{title:a,size:t?"medium":"large"}),o.createElement(s.default,{layout:n,onLayoutChange:this.onLayoutChange,source:t,datamartId:r}))}}]),t}(o.Component);t.default=c},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BlastTemplateSectionFieldArray=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(35),i=n(10),s=n(8),l=n(1090),c=f(n(184)),u=f(n(60)),d=f(n(101));function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=i.Layout.Content,y=t.BlastTemplateSectionFieldArray=o.FieldArray,h=o.FieldArray,v="emailBlastForm",b=function(e){function t(){return p(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.close,s=e.form,f=e.change,p={general:{sectionId:"general",title:c.default.emailBlastEditorStepperGeneralInformation},blast:{sectionId:"blast",title:c.default.emailBlastEditorStepperBlastInformation},templates:{sectionId:"templates",title:c.default.emailBlastEditorStepperTemplateSelection},segments:{sectionId:"segments",title:c.default.emailBlastEditorStepperSegmentSelection}},m={formId:v,paths:t,message:c.default.emailEditorSave,onClose:a},b={items:Object.values(p),scrollId:v};return r.createElement(i.Layout,{className:"edit-layout"},r.createElement(u.default,m),r.createElement(i.Layout,{className:"ant-layout-has-sider"},r.createElement(d.default,b),r.createElement(o.Form,{className:"edit-layout ant-layout",onSubmit:n},r.createElement(g,{id:v,className:"mcs-content-container mcs-form-container"},r.createElement("div",{id:p.general.sectionId},r.createElement(l.GeneralFormSection,null)),r.createElement("hr",null),r.createElement("div",{id:p.blast.sectionId},r.createElement(l.BlastFormSection,null)),r.createElement("hr",null),r.createElement("div",{id:p.templates.sectionId},r.createElement(y,{name:"templateFields",component:l.TemplateFormSection,formChange:f,rerenderOnEveryChange:!0})),r.createElement("hr",null),r.createElement("div",{id:p.segments.sectionId},r.createElement(h,{name:"segmentFields",component:l.SegmentFormSection,formName:s,formChange:f,rerenderOnEveryChange:!0}))))))}}]),t}(r.Component);t.default=(0,s.compose)((0,o.reduxForm)({form:v,enableReinitialize:!0}))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EMAIL_SEARCH_SETTINGS=void 0;var a=n(30);function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.EMAIL_SEARCH_SETTINGS=[].concat(r(a.PAGINATION_SEARCH_SETTINGS),r(a.ARCHIVED_SEARCH_SETTINGS),r(a.DATE_SEARCH_SETTINGS),r(a.LABELS_SEARCH_SETTINGS),r(a.FILTERS_SEARCH_SETTINGS),r(a.KEYWORD_SEARCH_SETTINGS))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EMAIL_DASHBOARD_SEARCH_SETTINGS=void 0;var a=n(30);t.EMAIL_DASHBOARD_SEARCH_SETTINGS=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(a.DATE_SEARCH_SETTINGS))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmailStackedAreaChart=t.EmailPieCharts=void 0;var a=o(n(2248)),r=o(n(2249));function o(e){return e&&e.__esModule?e:{default:e}}t.EmailPieCharts=a.default,t.EmailStackedAreaChart=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(0,n(6).defineMessages)({save:{id:"automation.builder.node.customActionForm.save.button",defaultMessage:"Update"},sectionGeneralTitle:{id:"automation.builder.node.customActionForm.general.title",defaultMessage:"General information"},customActionNameTitle:{id:"automation.builder.node.customActionForm.name.title",defaultMessage:"Name"},customActionNamePlaceholder:{id:"automation.builder.node.customActionForm.name.placeholder",defaultMessage:"Name"},pluginVersionLabel:{id:"automation.builder.node.customActionForm.pluginVersion.label",defaultMessage:"Action name"},sectionPluginSettingsTitle:{id:"automation.builder.node.customActionForm.pluginSettings.title",defaultMessage:"Settings"},noInformationOnPlugin:{id:"automation.builder.node.customActionForm.pluginSettings.noInformationOnPlugin",defaultMessage:"No information was found on this plugin"}});t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormDataFileField=t.FormDataFile=void 0;var a,r=n(35),o=n(2298),i=(a=o)&&a.__esModule?a:{default:a};t.FormDataFile=i.default;t.FormDataFileField=r.Field},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({adLayoutButtonChoose:{id:"plugin.form.adLayout.button.choose",defaultMessage:"Choose an AdLayout"},adLayoutButtonChange:{id:"plugin.form.adLayout.button.change",defaultMessage:"Change your AdLayout"},adLayoutModalTitle:{id:"plugin.form.adLayout.modal.title",defaultMessage:"Pick your AdLayout"},adLayoutModalElement:{id:"plugin.form.adLayout.modal.element.label",defaultMessage:"Select your AdLayout"},adLayoutModalLabel:{id:"plugin.form.adLayout.modal.versions.label",defaultMessage:"Select your AdLayout Version"},noAdLayoutSelected:{id:"plugin.form.no.adLayout.selected",defaultMessage:"No AdLayout selected"},noStyleSheetSelected:{id:"plugin.form.no.stylesheet.selected",defaultMessage:"No StyleSheet selected"},styleSheetButtonChoose:{id:"plugin.form.stylesheet.button.choose",defaultMessage:"Choose a StyleSheet"},styleSheetButtonChange:{id:"plugin.form.stylesheet.button.change",defaultMessage:"Change your StyleSheet"},styleSheetModalTitle:{id:"plugin.form.stylesheet.modal.title",defaultMessage:"Pick your StyleSheet"},styleSheetModalElement:{id:"plugin.form.stylesheet.modal.element.label",defaultMessage:"Select your StyleSheet"},styleSheetModalVersions:{id:"plugin.form.stylesheet.modal.versions.label",defaultMessage:"Select your StyleSheet Version"},datafileFileSelect:{id:"plugin.form.datafile.button.upload",defaultMessage:"Select a File"},datafileDrawerUpload:{id:"plugin.form.datafile.drawer.select.upload",defaultMessage:"Upload a file"},datafileDrawerSelect:{id:"plugin.form.datafile.drawer.select.existing",defaultMessage:"Or Select an Existing Data File"},datafileDrawerSelectOk:{id:"plugin.form.datafile.drawer.select.Ok",defaultMessage:"Ok"}})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({save:{id:"plugin.edit.save",defaultMessage:"Save"},menuGeneralInformation:{id:"plugin.edit.general",defaultMessage:"General Information"},menuType:{id:"plugin.edit.type",defaultMessage:"Type"},menuProperties:{id:"plugin.edit.proerties",defaultMessage:"Properties"},sectionGeneralTitle:{id:"plugin.edit.section.general.title",defaultMessage:"General Information"},sectionGeneralName:{id:"plugin.edit.section.general.button.name",defaultMessage:"Name"},sectionGeneralPlaceholder:{id:"plugin.edit.section.general.button.placeholder",defaultMessage:"Name"},sectionGeneralHelper:{id:"plugin.edit.section.general.button.helper",defaultMessage:"Select a name and make it memorable so you can find it back across different screens."},sectionPropertiesTitle:{id:"plugin.edit.section.properties.title",defaultMessage:"Properties"},sectionTechnicalName:{id:"plugin.edit.section.technic.button.name",defaultMessage:"Technical Name"},sectionTechnicalPlaceholder:{id:"plugin.edit.section.technic.button.placeholder",defaultMessage:"Technical Name"},sectionTechnicalHelper:{id:"plugin.edit.section.technic.button.helper",defaultMessage:"Give your Email Template a technical name to leverage integrations such as external click tracking."},advanced:{id:"plugin.edit.advanced.button",defaultMessage:"Advanced"},feedModalNameFieldLabel:{id:"audience.segment.feed.create.nameField.label",defaultMessage:"Name"},feedModalNameFieldTitle:{id:"audience.segment.feed.create.nameField.title",defaultMessage:"The name used to identify this feed."},feedModalNameFieldTitleWarning:{id:"audience.segment.feed.create.nameField.title.warning",defaultMessage:"Warning: This name is only used in the platform, it won't be visible on the external system."},feedPresetModalNameFieldTitle:{id:"audience.segment.feed.preset.create.nameField.title",defaultMessage:"The name that will be used to identify this feed preset and the feeds created with it."},feedModalNameFieldPlaceholder:{id:"audience.segment.feed.create.nameField.placeholder",defaultMessage:"Name"},feedModalDescriptionFieldLabel:{id:"audience.segment.feed.create.descriptionField.label",defaultMessage:"Description"},feedModalDescriptionFieldTitle:{id:"audience.segment.feed.create.descriptionField.title",defaultMessage:"A description of the feed preset to help understand what this preset is about."},feedModalDescriptionFieldPlaceholder:{id:"audience.segment.feed.create.descriptionField.placeholder",defaultMessage:"Description"},presetDeletionModalDescription:{id:"audience.segment.feed.preset.delete.modal.description",defaultMessage:"Are you sure you want to archive this feed preset? This will be permanent. The feeds already created with this feed preset won't be deleted."},presetDeletionModalConfirm:{id:"audience.segment.feed.preset.delete.modal.confirm",defaultMessage:"Delete Now"},presetDeletionModalCancel:{id:"audience.segment.feed.preset.delete.modal.cancel",defaultMessage:"Cancel"}})},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(2424),s=(a=i)&&a.__esModule?a:{default:a},l=n(6),c=n(10);var u=(0,l.defineMessages)({expandAll:{id:"components.customObjectRenderer.expandAll",defaultMessage:"Expand all"},collapseAll:{id:"components.customObjectRenderer.collapseAll",defaultMessage:"Collapse all"}}),d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.authorizeExpandAll=function(){"INIT_OR_NOT_NEEDED"===n.state.expandAllStatus&&n.setState({expandAllStatus:"EXPAND_ALL"})},n.invertDisplayExpandAll=function(){var e=n.state.expandAllStatus;"EXPAND_ALL"===e?n.setState({expandAllStatus:"COLLAPSE_ALL"}):"COLLAPSE_ALL"===e&&n.setState({expandAllStatus:"EXPAND_ALL"})},n.getButtonExpandAll=function(){var e=n.state.expandAllStatus;if("INIT_OR_NOT_NEEDED"!==e){var t="EXPAND_ALL"===e?u.expandAll:u.collapseAll;return o.createElement(c.Row,{className:"button-expand-all"},o.createElement("button",{className:"button-sm",onClick:n.invertDisplayExpandAll},o.createElement(l.FormattedMessage,t)))}return null},n.state={expandAllStatus:"INIT_OR_NOT_NEEDED"},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.customObject,n=e.customRenderingTemplates,a=this.state.expandAllStatus,r=Object.assign({transformedTemplates:{}},n),i=this.getButtonExpandAll();return o.createElement("div",{className:"custom-object-renderer"},i,o.createElement(s.default,{objectToBeRendered:t,customRenderingTemplates:r,leftBorder:!1,expandAllStatus:a,authorizeExpandAll:this.authorizeExpandAll}))}}]),t}(o.Component);t.default=(0,l.injectIntl)(d)},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FEEDS_SEARCH_SETTINGS=void 0;var a=n(30);t.FEEDS_SEARCH_SETTINGS=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(a.PAGINATION_SEARCH_SETTINGS),[{paramName:"feedType",defaultValue:["EXTERNAL_FEED"],deserialize:function(e){return e.feedType?e.feedType.split(","):[]},serialize:function(e){return e.join(",")},isValid:function(e){return!e.feedType||e.feedType.split(",").length>0}},{paramName:"artifactId",defaultValue:[],deserialize:function(e){return e.artifactId?e.artifactId.split(","):[]},serialize:function(e){return e.join(",")},isValid:function(e){return!e.artifactId||e.artifactId.split(",").length>0}},{paramName:"status",defaultValue:[],deserialize:function(e){return e.status?e.status.split(","):[]},serialize:function(e){return e.join(",")},isValid:function(e){return!e.status||e.status.split(",").length>0}}])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(8);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=(0,o.defineMessages)({placeholder:{id:"creatives.create.loader.notSupported.placeholder",defaultMessage:"This plugin has been deprecated. Please contact your plugin developer if you wish to migrate your creative."}}),u=function(e){function t(){return s(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.intl;return r.createElement("div",{className:"mcs-custom-loader no-loader"},e.formatMessage(c.placeholder))}}]),t}(r.Component);t.default=(0,i.compose)(o.injectIntl)(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeneralMultipleSection=t.PropertiesFormSection=t.PreviewFormSection=t.GeneralFormSection=t.AuditFormSection=void 0;var a=l(n(2463)),r=l(n(2464)),o=l(n(2466)),i=l(n(2467)),s=l(n(2468));function l(e){return e&&e.__esModule?e:{default:e}}t.AuditFormSection=a.default,t.GeneralFormSection=r.default,t.PreviewFormSection=o.default,t.PropertiesFormSection=i.default,t.GeneralMultipleSection=s.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=n(10),l=n(77),c=n(137),u=f(n(164)),d=f(n(60));function f(e){return e&&e.__esModule?e:{default:e}}var p=s.Layout.Content,m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onClose=function(){var e=n.props,t=e.close,a=e.pristine,r=e.intl;a?t():s.Modal.confirm({title:r.formatMessage(u.default.modalConfirmTitle),content:r.formatMessage(u.default.modalConfirmContent),okText:r.formatMessage(u.default.modalConfirmOk),cancelText:r.formatMessage(u.default.modalConfirmCancel),onOk:t})},n.generateLayout=function(){var e=n.props,t=e.rightFormSections,a=e.leftFormSections,o=t.map((function(e,n){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),n!==t.length-1&&r.createElement("hr",null))})),i=a.map((function(e,t){return r.createElement("div",{key:e.id,id:e.id,style:function(e){switch(e){case"preview":return{flexGrow:1,display:"flex",justifyContent:"space-between",alignItems:"strech",flexDirection:"column"};case"loader":return{flexGrow:1,overflowX:"hidden"};case"no-loader":return{flexGrow:1,overflowX:"hidden",display:"flex"};default:return{flexGrow:0}}}(e.id)},e.component)}));return r.createElement(s.Layout,{className:"ant-layout-has-sider"},r.createElement("div",{className:"ant-layout-sider",style:{width:"53%",backgroundColor:"rgba(0, 0, 0, 0.64)"}},r.createElement("div",{className:"ant-layout-sider-children",style:{display:"flex",justifyContent:"space-between",flexDirection:"column"}},i)),r.createElement(s.Layout,null,r.createElement(p,{id:c.DISPLAY_CREATIVE_FORM,className:"mcs-content-container mcs-form-container",style:{borderLeft:"1px rgba(0, 0, 0, 0.64) solid"}},o)))},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.actionBarButtonText,n=e.breadCrumbPaths,a={formId:c.DISPLAY_CREATIVE_FORM,paths:n,message:t,onClose:this.onClose};return r.createElement(s.Layout,{className:"edit-layout"},r.createElement(d.default,a),r.createElement(s.Layout,{className:"ant-layout-has-sider"},r.createElement(l.Form,{className:"edit-layout ant-layout",layout:"vertical"},r.createElement("button",{type:"submit",style:{display:"none"}}),this.generateLayout())))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(15),l=n(12),c=n(11);var u=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchData=function(e){n._creativeService.getCreativeScreenshotStatus(e).then((function(e){e&&e.data&&e.data.status&&("SUCCEEDED"===e.data.status?n.setState((function(e){var t=Object.assign({},e);return t.success=!0,t})):"PENDING"===e.data.status||"PROCESSING"===e.data.status?n.setState((function(e){var t=Object.assign({},e);return t.loading=!0,t})):"FAILED"!==e.data.status&&"NOT_TAKEN"!==e.data.status||n.setState((function(e){var t=Object.assign({},e);return t.error=!0,t})))})).catch((function(){n.setState((function(e){var t=Object.assign({},e);return t.error=!0,t}))}))},n.renderSuccessScreenshot=function(e){return o.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"https://ads.mediarithmics.com/ads/screenshot?rid="+e.id},o.createElement("span",{className:"thumbnail-helper"}),o.createElement("img",{src:"https://ads.mediarithmics.com/ads/screenshot?rid="+e.id,alt:e.name}))},n.renderLoadingScreenshot=function(){return o.createElement(i.Spin,null)},n.renderErrorScreenshot=function(){return o.createElement(c.McsIcon,{className:"mcs-icon-3x",type:"close-big"})},n.state={loading:!1,error:!1,success:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.item;this.fetchData(e.id)}},{key:"componentDidUpdate",value:function(e){var t=this.props.item,n=e.item;t.id!==n.id&&this.fetchData(t.id)}},{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.error,a=t.loading,r=t.success;return o.createElement("div",{className:"mcs-table-cell-thumbnail"},n?this.renderErrorScreenshot():null,a?this.renderLoadingScreenshot():null,r?this.renderSuccessScreenshot(e):null)}}]),t}(o.Component);u([(0,s.lazyInject)(l.TYPES.ICreativeService)],d.prototype,"_creativeService",void 0),t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({catalog:{id:"catalog.name",defaultMessage:"Catalog"},noProduct:{id:"catalog.noProduct",defaultMessage:"No Products..."},category:{id:"catalog.category",defaultMessage:"Category"},brand:{id:"catalog.brand",defaultMessage:"Brand"},title:{id:"catalog.title",defaultMessage:"Title"},product_type:{id:"catalog.product_type",defaultMessage:"Product Type"}})},function(e,t,n){"use strict";function a(e){return void 0!==e.percent_value&&void 0!==e.fixed_value}function r(e){return void 0!==e.valuator_id}Object.defineProperty(t,"__esModule",{value:!0}),t.isLinearServiceItemConditionsResource=a,t.isPluginServiceItemConditionsResource=r,t.isProvidedServiceItemConditionResource=function(e){return!a(e)&&!r(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({saveMobileApp:{id:"settings.mobileapp.form.saveMobileApp",defaultMessage:"Save Mobile Application"},sectionGeneralTitle:{id:"settings.mobileapp.form.general.title",defaultMessage:"General Information"},sectionProcessingActivitiesTitle:{id:"settings.mobileapp.form.processingActivities.title",defaultMessage:"Processing Activities"},sectionVisitAnalyzerTitle:{id:"settings.mobileapp.form.visitAnalayzer.title",defaultMessage:"Visit Analyzer"},sectionEventRulesTitle:{id:"settings.mobileapp.form.section.eventRules.title",defaultMessage:"Event Rules"},sectionGeneralSubTitle:{id:"settings.mobileapp.form.general.subtitle",defaultMessage:"Give your Mobile Application a name"},contentSectionGeneralNameLabel:{id:"settings.mobileapp.form.general.label",defaultMessage:"Name"},contentSectionGeneralNamePlaceholder:{id:"settings.mobileapp.form.general.placeholder",defaultMessage:"Mobile Application Name"},contentSectionGeneralNameTooltip:{id:"settings.mobileapp.form.general.tooltip",defaultMessage:"Give your Mobile Application a Name"},contentSectionGeneralTokenLabel:{id:"settings.mobileapp.form.general.token.label",defaultMessage:"Token"},contentSectionGeneralTokenPlaceholder:{id:"settings.mobileapp.form.general.token.placeholder",defaultMessage:"Mobile Application Token"},contentSectionGeneralTokenTooltip:{id:"settings.mobileapp.form.general.token.tooltip",defaultMessage:"Give your Mobile Application a unique token to identify your app. This token can be comprised of characters as well as numbers"},errorFormMessage:{id:"settings.mobileapp.form.errorMessage",defaultMessage:"There is an error with the data you have inputed, please check"},savingInProgress:{id:"settings.mobileapp.form.savingInProgress",defaultMessage:"Saving your Mobile App"},createMobileApplicationTitle:{id:"settings.mobileapp.form.create",defaultMessage:"New Mobile Application"},editMobileApplicationTitle:{id:"settings.mobileapp.form.edit",defaultMessage:"Edit {name}"},breadcrumbTitle1:{id:"settings.mobileapp.form.settings",defaultMessage:"Mobile Applications"},warningOnTokenEdition:{id:"settings.datamart.mobileapp.edit.warning.token.edition",defaultMessage:"Danger Zone: Editing this token may cause any mobile application data collection to fail if not updated properly. Please make sure you have updated your tag in all your mobile apps before saving."},processingsWarningModalContent:{id:"settings.mobileapp.processings.warning.content",defaultMessage:"You are about to change the Processing Activities on behalf of which you are capturing personal data on this channel. mediarithmics platform will now automatically drop new User Events if the User Choices do not allow their capture. Do you want to continue?"},processingsWarningModalOk:{id:"settings.mobileapp.processings.warning.ok",defaultMessage:"OK"},processingsWarningModalCancel:{id:"settings.mobileapp.processings.warning.cancel",defaultMessage:"Cancel"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=m(n(47)),l=n(8),c=n(61),u=m(n(410)),d=m(n(806)),f=m(n(805)),p=m(n(1175));function m(e){return e&&e.__esModule?e:{default:e}}var g=(0,i.defineMessages)({dropdownCatalogAutoMatch:{id:"settings.form.eventRules.CatalogAutoMatch",defaultMessage:"Catalog Auto Match"},dropdownUserIdentifierInsertion:{id:"settings.form.eventRules.UserIdentifierInsertion",defaultMessage:"User Identifier Insertion"},dropdownUrlMatch:{id:"settings.form.eventRules.UrlMatch",defaultMessage:"Url Match"},dropdownPropertyCopy:{id:"settings.form.eventRules.PropertyCopy",defaultMessage:"Property to Origin Copy"},sectionSubtitleEventRules:{id:"settings.form.eventRules.subtitle",defaultMessage:"Add an Event Rule to your site so that you can run custom rules on any activity stored in your DMP."},sectionTitleEventRule:{id:"settings.form.eventRules.title",defaultMessage:"Event Rules"},sectionEmptyEventRules:{id:"settings.form.eventRules.empty",defaultMessage:"There is no Event Rules created yet!"},sectionTitleCreateEventRule:{id:"settings.form.eventRules.create",defaultMessage:"Create Event Rules"},userIdInsertRecordTitle:{id:"settings.form.eventRules.record.title.user-id-insert",defaultMessage:"{ruleType} - Property {propertyName} is hashed with {hashFunc} to be inserted as {identifierType} {optionnalCompartment}"},urlMatchRecordTitle:{id:"settings.form.eventRules.record.title.url-match",defaultMessage:"{ruleType} - Matches {url}"},propToOrigCopyRecordTitle:{id:"settings.form.eventRules.record.title.prop-to-orig-copy",defaultMessage:"{ruleType} - Property {propertyName} in {source} is copied to {dest}"},catalAutoMatchRecordTitle:{id:"settings.form.eventRules.record.title.catal-auto-match",defaultMessage:"{ruleType} - {matchType}"}}),y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateEventRules=function(e){var t=n.props,a=t.fields,r=t.formChange,o=e;"URL_MATCH"===o.model.type&&o.model.event_template&&o.model.event_template.$properties&&(o.model.event_template.$properties=o.model.event_template.$properties.reduce((function(e,t){return e[t.leftValue]=t.rightValue,e}),{}));var i=a.getAll();if(o.key){var l=i.map((function(e){return e.key===o.key?o:e}));r(a.name,l)}else{var c=Object.assign(Object.assign({},o),{key:(0,s.default)()});i.push(c),r(a.name,i)}n.props.closeNextDrawer()},n.openEventRulesSelector=function(e){var t=e;if("URL_MATCH"===e.model.type&&e.model.event_template&&e.model.event_template.$properties){var a=Object.keys(e.model.event_template.$properties).map((function(t){return{leftValue:t,rightValue:e.model.event_template.$properties[t]}}));t=Object.assign(Object.assign({},e),{model:Object.assign(Object.assign({},e.model),{event_template:Object.assign(Object.assign({},e.model.event_template),{$properties:a})})})}var r={close:n.props.closeNextDrawer,onSubmit:n.updateEventRules,breadCrumbPaths:[{name:"Create Event Rule"}],initialValues:t,datamartId:n.props.datamartId};n.props.openNextDrawer(p.default,{additionalProps:r})},n.openInitialEventRuleSelector=function(e){return function(){var t={};switch(e){case"CATALOG_AUTO_MATCH":t={model:{type:"CATALOG_AUTO_MATCH",auto_match_type:"CATEGORY"}};break;case"PROPERTY_TO_ORIGIN_COPY":t={model:{type:"PROPERTY_TO_ORIGIN_COPY",property_source:"URL"}};break;case"USER_IDENTIFIER_INSERTION":t={model:{type:"USER_IDENTIFIER_INSERTION",hash_function:"SHA_256",identifier_creation:"USER_ACCOUNT"}};break;case"URL_MATCH":t={model:{type:"URL_MATCH"}}}var a={close:n.props.closeNextDrawer,onSubmit:n.updateEventRules,breadCrumbPaths:[{name:n.props.intl.formatMessage(g.sectionTitleCreateEventRule)}],initialValues:t,datamartId:n.props.datamartId};n.props.openNextDrawer(p.default,{additionalProps:a})}},n.getEventRulesRecords=function(){var e=n.props.fields,t=function(e){switch(e.model.type){case"CATALOG_AUTO_MATCH":return o.createElement(i.FormattedMessage,a({},g.catalAutoMatchRecordTitle,{values:{ruleType:e.model.type,matchType:o.createElement("strong",null,e.model.auto_match_type)}}));case"PROPERTY_TO_ORIGIN_COPY":return o.createElement(i.FormattedMessage,a({},g.propToOrigCopyRecordTitle,{values:{ruleType:e.model.type,propertyName:o.createElement("strong",null,e.model.property_name),source:o.createElement("strong",null,e.model.property_source),dest:o.createElement("strong",null,e.model.destination)}}));case"URL_MATCH":return o.createElement(i.FormattedMessage,a({},g.urlMatchRecordTitle,{values:{ruleType:e.model.type,url:o.createElement("strong",null,e.model.pattern)}}));case"USER_IDENTIFIER_INSERTION":return o.createElement(i.FormattedMessage,a({},g.userIdInsertRecordTitle,{values:{ruleType:e.model.type,propertyName:o.createElement("strong",null,e.model.property_source),hashFunc:o.createElement("strong",null,e.model.hash_function),identifierType:e.model.identifier_creation,optionnalCompartment:e.model.compartment_id?"(comp: "+e.model.compartment_id+")":""}}));default:return""}};return e.map((function(a,r){var i=e.get(r);return o.createElement(f.default,{key:i.key,recordIconType:"optimization",record:i,title:t,onRemove:function(){return e.remove(r)},onEdit:n.openEventRulesSelector})}))},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props.intl.formatMessage;return o.createElement("div",null,o.createElement(u.default,{dropdownItems:[{id:g.dropdownCatalogAutoMatch.id,message:g.dropdownCatalogAutoMatch,onClick:this.openInitialEventRuleSelector("CATALOG_AUTO_MATCH")},{id:g.dropdownPropertyCopy.id,message:g.dropdownPropertyCopy,onClick:this.openInitialEventRuleSelector("PROPERTY_TO_ORIGIN_COPY")},{id:g.dropdownUrlMatch.id,message:g.dropdownUrlMatch,onClick:this.openInitialEventRuleSelector("URL_MATCH")},{id:g.dropdownUserIdentifierInsertion.id,message:g.dropdownUserIdentifierInsertion,onClick:this.openInitialEventRuleSelector("USER_IDENTIFIER_INSERTION")}],subtitle:g.sectionSubtitleEventRules,title:g.sectionTitleEventRule}),o.createElement(d.default,{emptyOption:{iconType:"optimization",message:e(g.sectionEmptyEventRules)}},this.getEventRulesRecords()))}}]),t}(o.Component);t.default=(0,l.compose)(i.injectIntl,c.injectDrawer)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({contentSectionNameLabel:{id:"settings.datamart.form.name.label",defaultMessage:"Name"},contentSectionNamePlaceholder:{id:"settings.datamart.form.name.placeholder",defaultMessage:"Datamart Name"},contentSectionNameTooltip:{id:"settings.datamart.form.name.tooltip",defaultMessage:"Give your Datamart a name to identify it."},sectionGeneralTitle:{id:"settings.datamart.form.general.title",defaultMessage:"General Information"},sectionGeneralSubTitle:{id:"settings.datamart.form.general.subtitle",defaultMessage:"Modify your Datamart's information"},contentSectionGeneralTokenLabel:{id:"settings.datamart.form.general.token.label",defaultMessage:"Token"},contentSectionGeneralTokenPlaceholder:{id:"settings.datamart.form.general.token.placeholder",defaultMessage:"Datamart Token"},contentSectionGeneralTokenTooltip:{id:"settings.datamart.form.general.token.tooltip",defaultMessage:"Give your Datamart a unique token to identify it. This token can be comprised of characters as well as numbers"},saveDatamart:{id:"settings.datamart.form.saveMobileApp",defaultMessage:"Save"},sectionEventRulesTitle:{id:"settings.datamart.form.section.eventRules.title",defaultMessage:"Event Rules"},errorFormMessage:{id:"settings.datamart.form.errorMessage",defaultMessage:"There is an error with the data you have inputed, please check"},savingInProgress:{id:"settings.datamart.form.savingInProgress",defaultMessage:"Saving your Datamart"},editDatamartTitle:{id:"settings.datamart.form.edit",defaultMessage:"Edit {name}"},createDatamartTitle:{id:"settings.datamart.form.create",defaultMessage:"New Datamart"},breadcrumbTitle1:{id:"settings.datamart.form.settings",defaultMessage:"Datamarts"},warningOnTokenEdition:{id:"settings.datamart.edit.warning.token.edition",defaultMessage:"Danger Zone: Editing this token may cause any integrations to fail if not updated properly. Please make sure you have reviewed all your integration before saving."}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(10),l=n(33),c=n(13),u=n(6),d=n(30),f=v(n(126)),p=v(n(23)),m=n(44),g=n(12),y=n(15),h=n(11);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=s.Layout.Content,S=t.messages=(0,u.defineMessages)({serviceOffers:{id:"settings.services.subscribed.service.offers.list",defaultMessage:"Subscribed Offers"},name:{id:"settings.services.subscribed.service.offers.list.column.name",defaultMessage:"Name"},creditedAccount:{id:"settings.services.subscribed.service.offers.list.column.credited.account",defaultMessage:"Credited Account"},providerName:{id:"settings.services.subscribed.service.offers.list.column.provider.name",defaultMessage:"Provider Name"},empty:{id:"settings.services.subscribed.service.offers.empty.list",defaultMessage:"You have not subscribed to service offers."},subscribedOffersTitle:{id:"settings.services.subscribed.service.offers.title",defaultMessage:"Subscribed Offers"},myOffersTitle:{id:"settings.services.my.service.offers.title",defaultMessage:"My Offers"},unknownOffer:{id:"settings.services.subscribed.offers.list.unknown.offer",defaultMessage:"Unknown offer"},addNewCondition:{id:"settings.services.myOffers.add.service_item.condition",defaultMessage:"Add new service item condition"},serviceItemNoDescription:{id:"settings.subscribedOffers.service.item.no.description.",defaultMessage:"There is no description provided for this service item."},serviceItemPriceSimulatorText:{id:"settings.subscribedOffers.service.item.price.simulator.text",defaultMessage:"In order to simulate your service price, please enter an impression cost value."},serviceItemPriceSimulatorInputPlaceholder:{id:"settings.subscribedOffers.service.item.price.simulator.input.placeholder",defaultMessage:"Usage cost (€)"},serviceItemPrice:{id:"settings.subscribedOffers.service.item.price",defaultMessage:"Service price:"},serviceItemPricePlaceholder:{id:"settings.subscribedOffers.service.item.price.placeholder",defaultMessage:"Enter an impression cost to see your service price."},invalidImpressionCost:{id:"settings.subscribedOffers.service.item.price.invalid.impression.cost",defaultMessage:"Impression cost is invalid, please use numbers."},usagePrice:{id:"settings.subscribedOffers.service.item.price.chart.usage_price",defaultMessage:"Usage Price"},usageCost:{id:"settings.subscribedOffers.service.item.price.chart.usage_cost",defaultMessage:"Usage Cost"},myServiceOffersEdit:{id:"settings.myOffers.edit",defaultMessage:"Edit offer"}}),E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchOffers=function(e,t){n.setState({loading:!0});var a=Object.assign({},(0,m.getPaginatedApiParam)(t.currentPage,t.pageSize));n._catalogService.getSubscribedOffers(e,a).then((function(e){n.setState({loading:!1,data:e.data,total:e.total||e.count})})).catch((function(e){n.setState({loading:!1}),n.props.notifyError(e)}))},n.state={data:[],total:0,loading:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.state,t=e.loading,n=e.data,a=e.total,r=this.props.match.params.organisationId,i=[{intlMessage:S.name,key:"name",isHideable:!1,render:function(e,t){return o.createElement(l.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+r+"/settings/services/subscribed_offers/"+t.id+"/service_item_conditions"},e)}},{intlMessage:S.creditedAccount,key:"credited_account_name",isHideable:!1,render:function(e,t){return o.createElement("span",null,e)}},{intlMessage:S.providerName,key:"provider_name",isHideable:!1,render:function(e,t){return o.createElement("span",null,e)}}],c={iconType:"settings",message:this.props.intl.formatMessage(S.empty)};return o.createElement("div",{className:"ant-layout"},o.createElement(_,{className:"mcs-content-container"},o.createElement(s.Row,{className:"mcs-table-container"},o.createElement(s.Breadcrumb,{className:"mcs-breadcrumb",separator:o.createElement(h.McsIcon,{type:"chevron-right"})},o.createElement(s.Breadcrumb.Item,null,o.createElement(u.FormattedMessage,S.subscribedOffersTitle)))),o.createElement(f.default,{fetchList:this.fetchOffers,dataSource:n,loading:t,total:a,columns:i,pageSettings:d.PAGINATION_SEARCH_SETTINGS,emptyTable:c})))}}]),t}(o.Component);b([(0,y.lazyInject)(g.TYPES.ICatalogService)],E.prototype,"_catalogService",void 0),t.default=(0,i.compose)(c.withRouter,u.injectIntl,p.default)(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OfferType=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=h(n(23)),l=n(6),c=n(8),u=h(n(2628)),d=h(n(2629)),f=h(n(220)),p=n(900),m=n(51),g=n(12),y=n(15);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=t.OfferType=void 0;!function(e){e[e.Automatic=0]="Automatic",e[e.Manual=1]="Manual"}(b||(t.OfferType=b={}));var _=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.chooseOfferType=function(e){n.setState({offerType:e})},n.redirect=function(){var e=n.props,t=e.history,a=e.location.state,r=e.match.params,o=r.organisationId,i=r.offerId,s=i?"/v2/o/"+o+"/settings/services/my_offers/"+i+"/service_item_conditions":"/v2/o/"+o+"/settings/services/my_offers",l=a&&a.from?a.from:s;t.push(l)},n.save=function(e){var t=n.props,a=t.match.params.organisationId,r=t.notifyError,o=t.history,i=n.state.offerFormData;n.setState({loading:!0}),n._serviceOfferPageService.createOrUpdateServiceOffer(a,e,i).then((function(e){var t="/v2/o/"+a+"/settings/services/my_offers/"+e+"/service_item_conditions";n.setState({loading:!1}),o.push(t)})).catch((function(e){r(e),n.setState({loading:!1})}))},n.state={loading:!0,offerType:void 0,offerFormData:p.INITIAL_SERVICE_OFFER_FORM_DATA},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params,n=t.organisationId,a=t.offerId;a?this._serviceOfferPageService.loadOffer(n,a).then((function(t){e.setState({loading:!1,offerType:null===t.offer.automatic_on?b.Manual:b.Automatic,offerFormData:t})})).catch((function(t){e.setState({loading:!1}),e.props.notifyError(t)})):this.setState({loading:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params,a=n.organisationId,r=n.offerId,i=t.intl.formatMessage,s=this.state,l=s.offerType,c=s.offerFormData;if(s.loading)return o.createElement(m.Loading,{isFullScreen:!0});var p=void 0===r?function(){e.setState({offerType:void 0})}:void 0,g=[{name:i(f.default.breadcrumbTitle),path:"/v2/o/"+a+"/settings/services/my_offers"},{name:i(f.default.newOffer)}];return void 0===l?o.createElement(u.default,{onSelect:this.chooseOfferType,close:this.redirect,breadCrumbPaths:g}):o.createElement(d.default,{initialValues:c,offerType:l,onSubmit:this.save,close:this.redirect,breadCrumbPaths:g,goToOfferTypeSelection:p})}}]),t}(o.Component);v([(0,y.lazyInject)(g.TYPES.IServiceOfferPageService)],_.prototype,"_serviceOfferPageService",void 0),t.default=(0,c.compose)(l.injectIntl,i.withRouter,s.default)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({breadcrumbTitle:{id:"settings.compartments.form.settings",defaultMessage:"Compartments"},sectionGeneralTitle:{id:"settings.compartments.form.general.title",defaultMessage:"General Information"},saveCompartment:{id:"settings.compartments.form.saveCompartment",defaultMessage:"Save Compartment"},sectionGeneralSubTitle:{id:"settings.compartments.form.general.subtitle",defaultMessage:"Give your compartment a name"},sectionGeneralNameLabel:{id:"settings.compartments.form.general.name.label",defaultMessage:"Name"},sectionGeneralNamePlaceholder:{id:"settings.compartments.form.general.name.placeholder",defaultMessage:"Compartment Name"},sectionGeneralNameTooltip:{id:"settings.compartments.form.general.name.tooltip",defaultMessage:"Give your Compartment a Name"},sectionGeneralTokenLabel:{id:"settings.compartments.form.general.token.label",defaultMessage:"Token"},sectionGeneralTokenPlaceholder:{id:"settings.compartments.form.general.Token.placeholder",defaultMessage:"Compartment Token"},sectionGeneralTokenTooltip:{id:"settings.compartments.form.general.token.tooltip",defaultMessage:"Give your Compartment a Token"},sectionProcessingActivitiesTitle:{id:"settings.compartments.form.processingActivities.title",defaultMessage:"Processing Activities"},warningOnTokenEdition:{id:"settings.compartments.form.general.token.warning",defaultMessage:"Danger Zone: Editing this token may cause any web site data collection tag to fail if not updated properly. Please make sure you have updated all your tags before saving."},sectionGeneralAdvancedTitle:{id:"settings.compartments.form.general.advanced.title",defaultMessage:"Advanced"},sectionGeneralDefaultLabel:{id:"settings.compartments.form.general.default.label",defaultMessage:"Default"},sectionGeneralDefaultTooltip:{id:"settings.compartments.form.general.default.tooltip",defaultMessage:"If 'true', this compartment will become the default compartment of your datamart. The current default compartment of your datamart will become a non-default compartment."},sectionDatamartTitle:{id:"settings.compartments.form.datamart.title",defaultMessage:"Datamart"},savingInProgress:{id:"settings.compartments.form.savingInProgress",defaultMessage:"Saving your Compartment"},processingsWarningModalContent:{id:"settings.compartments.processings.warning.content",defaultMessage:"You are about to change the Processing Activities on behalf of which you are capturing personal data on this compartment. mediarithmics platform will now automatically drop new User Profiles if the User Choices do not allow their capture. Do you want to continue?"},processingsWarningModalOk:{id:"settings.compartments.processings.warning.ok",defaultMessage:"OK"},processingsWarningModalCancel:{id:"settings.compartments.processings.warning.cancel",defaultMessage:"Cancel"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INITIAL_USER_EVENT_CLEANING_RULE_FORM_DATA={actionAndPeriod:{selectedValue:"KEEP",periodNumber:1,periodUnit:"D"},cleaningRuleType:"USER_EVENT_CLEANING_RULE"},t.INITIAL_USER_PROFILE_CLEANING_RULE_FORM_DATA={actionAndPeriod:{selectedValue:"DELETE",periodNumber:1,periodUnit:"D"},cleaningRuleType:"USER_PROFILE_CLEANING_RULE"},t.isUserEventCleaningRuleFormData=function(e){return"USER_EVENT_CLEANING_RULE"===e.cleaningRuleType},t.USER_EVENT_CLEANING_RULE_MIN_LIFE_DURATION="P1D",t.USER_EVENT_CLEANING_RULE_MAX_LIFE_DURATION="P36500D"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AUDIENCE_FEATURE_FORM_ID="audienceFeatureForm",t.AUDIENCE_BUILDER_FORM_ID="audienceBuilderForm",t.INITIAL_AUDIENCE_BUILDER_FORM_DATA={audienceBuilder:{},audienceFeatureDemographics:[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({adBlock:{id:"errors.adBlock",defaultMessage:"It appears you have an adblocker activated, in order to access mediarithmics navigator you need to disable your adblocker. Please contact the support if the issue persists afterwards"},generic:{id:"errors.generic",defaultMessage:"Oops, please try to reload the page or contact your support"},notFound:{id:"errors.notFound",defaultMessage:"404 not found"},noAccess:{id:"errors.noAccess",defaultMessage:"You currently don't have the right to view this page, if you think this is a mistake, please contact your administrator."}})},,,,,,,,,,,,,,,,function(e,t){},,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthService=t.ACCESS_TOKEN=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=l(n(17)),o=l(n(261)),i=l(n(46)),s=n(38);function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},d=t.ACCESS_TOKEN="access_token",f=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getAccessToken=function(){return o.default.getItem(d)},this.getAccessTokenExpirationDate=function(){var e=o.default.getItem("access_token_expiration_date");return e?(0,r.default)(e,"x"):(0,r.default)(0)},this.getRefreshTokenExpirationDate=function(){var e=o.default.getItem("refresh_token_expiration_date");return e?(0,r.default)(e,"x"):(0,r.default)(0)},this.tokenExpiresIn=function(e){return(0,r.default)(e).subtract("10","minutes").diff((0,r.default)(),"ms")},this.isTokenExpired=function(e){return(0,r.default)().isAfter(e)},this.isAuthenticated=function(){return!t.isTokenExpired(t.getAccessTokenExpirationDate())},this.canAuthenticate=function(){return!t.isTokenExpired(t.getRefreshTokenExpirationDate())},this.getRefreshToken=function(){return o.default.getItem("refresh_token")},this.revokeRefreshToken=function(){var e=o.default.getItem("refresh_token");if(e){var t={refresh_token:e};return i.default.postRequest("authentication/refresh_token/revoke",t)}return Promise.resolve()},this.getRememberMe=function(){return o.default.getItem("remember_me")},this.setAccessToken=function(e){o.default.setItem(c({},d,e))},this.setAccessTokenExpirationDate=function(e){var t=(0,r.default)().add(1,"hours");e&&(t=(0,r.default)().add(e,"seconds")),o.default.setItem(c({},"access_token_expiration_date",t.format("x")))},this.setRefreshToken=function(e){o.default.setItem(c({},"refresh_token",e))},this.setIsLogged=function(e){o.default.setItem({isLogged:String(e)})},this.setRememberMe=function(e){o.default.setItem(c({},"remember_me",String(e)))},this.setRefreshTokenExpirationDate=function(e){var n=(0,r.default)().add(e,"seconds");t.getRememberMe()&&(n=(0,r.default)().add(7,"days")),o.default.setItem(c({},"refresh_token_expiration_date",n.format("x")))},this.deleteCredentials=function(){o.default.removeItem(d),o.default.removeItem("access_token_expiration_date"),o.default.removeItem("refresh_token"),o.default.removeItem("refresh_token_expiration_date")},this.createAccessToken=function(e){var t=e.email,n=e.password,a={refresh_token:e.refreshToken,email:t,password:n};return i.default.postRequest("authentication/access_tokens",a,{},{},{authenticated:!1})},this.createRefreshToken=function(e){var t={email:e.email,password:e.password};return i.default.postRequest("authentication/refresh_tokens",t,{},{},{authenticated:!1}).then((function(e){return e.data.refresh_token}))},this.getConnectedUser=function(){return i.default.getRequest("connected_user").then((function(e){return e.data}))},this.sendPassword=function(e){var t={email:e};return i.default.postRequest("authentication/send_password_reset_email",t,{},{},{authenticated:!1})},this.resetPassword=function(e,t,n){var a={email:e,token:t,password:n};return i.default.postRequest("authentication/set_password",a,{},{},{authenticated:!1})}};t.AuthService=f=u([(0,s.injectable)()],f),t.AuthService=f},function(e,t,n){var a={"./af":454,"./af.js":454,"./ar":455,"./ar-dz":456,"./ar-dz.js":456,"./ar-kw":457,"./ar-kw.js":457,"./ar-ly":458,"./ar-ly.js":458,"./ar-ma":459,"./ar-ma.js":459,"./ar-sa":460,"./ar-sa.js":460,"./ar-tn":461,"./ar-tn.js":461,"./ar.js":455,"./az":462,"./az.js":462,"./be":463,"./be.js":463,"./bg":464,"./bg.js":464,"./bm":465,"./bm.js":465,"./bn":466,"./bn-bd":467,"./bn-bd.js":467,"./bn.js":466,"./bo":468,"./bo.js":468,"./br":469,"./br.js":469,"./bs":470,"./bs.js":470,"./ca":471,"./ca.js":471,"./cs":472,"./cs.js":472,"./cv":473,"./cv.js":473,"./cy":474,"./cy.js":474,"./da":475,"./da.js":475,"./de":476,"./de-at":477,"./de-at.js":477,"./de-ch":478,"./de-ch.js":478,"./de.js":476,"./dv":479,"./dv.js":479,"./el":480,"./el.js":480,"./en-au":481,"./en-au.js":481,"./en-ca":482,"./en-ca.js":482,"./en-gb":483,"./en-gb.js":483,"./en-ie":484,"./en-ie.js":484,"./en-il":485,"./en-il.js":485,"./en-in":486,"./en-in.js":486,"./en-nz":487,"./en-nz.js":487,"./en-sg":488,"./en-sg.js":488,"./eo":489,"./eo.js":489,"./es":490,"./es-do":491,"./es-do.js":491,"./es-mx":492,"./es-mx.js":492,"./es-us":493,"./es-us.js":493,"./es.js":490,"./et":494,"./et.js":494,"./eu":495,"./eu.js":495,"./fa":496,"./fa.js":496,"./fi":497,"./fi.js":497,"./fil":498,"./fil.js":498,"./fo":499,"./fo.js":499,"./fr":500,"./fr-ca":501,"./fr-ca.js":501,"./fr-ch":502,"./fr-ch.js":502,"./fr.js":500,"./fy":503,"./fy.js":503,"./ga":504,"./ga.js":504,"./gd":505,"./gd.js":505,"./gl":506,"./gl.js":506,"./gom-deva":507,"./gom-deva.js":507,"./gom-latn":508,"./gom-latn.js":508,"./gu":509,"./gu.js":509,"./he":510,"./he.js":510,"./hi":511,"./hi.js":511,"./hr":512,"./hr.js":512,"./hu":513,"./hu.js":513,"./hy-am":514,"./hy-am.js":514,"./id":515,"./id.js":515,"./is":516,"./is.js":516,"./it":517,"./it-ch":518,"./it-ch.js":518,"./it.js":517,"./ja":519,"./ja.js":519,"./jv":520,"./jv.js":520,"./ka":521,"./ka.js":521,"./kk":522,"./kk.js":522,"./km":523,"./km.js":523,"./kn":524,"./kn.js":524,"./ko":525,"./ko.js":525,"./ku":526,"./ku.js":526,"./ky":527,"./ky.js":527,"./lb":528,"./lb.js":528,"./lo":529,"./lo.js":529,"./lt":530,"./lt.js":530,"./lv":531,"./lv.js":531,"./me":532,"./me.js":532,"./mi":533,"./mi.js":533,"./mk":534,"./mk.js":534,"./ml":535,"./ml.js":535,"./mn":536,"./mn.js":536,"./mr":537,"./mr.js":537,"./ms":538,"./ms-my":539,"./ms-my.js":539,"./ms.js":538,"./mt":540,"./mt.js":540,"./my":541,"./my.js":541,"./nb":542,"./nb.js":542,"./ne":543,"./ne.js":543,"./nl":544,"./nl-be":545,"./nl-be.js":545,"./nl.js":544,"./nn":546,"./nn.js":546,"./oc-lnc":547,"./oc-lnc.js":547,"./pa-in":548,"./pa-in.js":548,"./pl":549,"./pl.js":549,"./pt":550,"./pt-br":551,"./pt-br.js":551,"./pt.js":550,"./ro":552,"./ro.js":552,"./ru":553,"./ru.js":553,"./sd":554,"./sd.js":554,"./se":555,"./se.js":555,"./si":556,"./si.js":556,"./sk":557,"./sk.js":557,"./sl":558,"./sl.js":558,"./sq":559,"./sq.js":559,"./sr":560,"./sr-cyrl":561,"./sr-cyrl.js":561,"./sr.js":560,"./ss":562,"./ss.js":562,"./sv":563,"./sv.js":563,"./sw":564,"./sw.js":564,"./ta":565,"./ta.js":565,"./te":566,"./te.js":566,"./tet":567,"./tet.js":567,"./tg":568,"./tg.js":568,"./th":569,"./th.js":569,"./tk":570,"./tk.js":570,"./tl-ph":571,"./tl-ph.js":571,"./tlh":572,"./tlh.js":572,"./tr":573,"./tr.js":573,"./tzl":574,"./tzl.js":574,"./tzm":575,"./tzm-latn":576,"./tzm-latn.js":576,"./tzm.js":575,"./ug-cn":577,"./ug-cn.js":577,"./uk":578,"./uk.js":578,"./ur":579,"./ur.js":579,"./uz":580,"./uz-latn":581,"./uz-latn.js":581,"./uz.js":580,"./vi":582,"./vi.js":582,"./x-pseudo":583,"./x-pseudo.js":583,"./yo":584,"./yo.js":584,"./zh-cn":585,"./zh-cn.js":585,"./zh-hk":586,"./zh-hk.js":586,"./zh-mo":587,"./zh-mo.js":587,"./zh-tw":588,"./zh-tw.js":588};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=o,e.exports=r,r.id=890},,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setClientFeature=t.setOrgFeature=void 0;var a=n(247),r=n(104),o=(0,a.createAction)(r.STORE_ORG_FEATURES),i=(0,a.createAction)(r.STORE_FEATURE_FLAG_CLIENT);t.setOrgFeature=o,t.setClientFeature=i},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INITIAL_SERVICE_OFFER_FORM_DATA={offer:{},serviceConditionFields:[]}},,function(e,t){},function(e,t){},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(299),s=(a=i)&&a.__esModule?a:{default:a},l=n(38),c=n(12);var u=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},d=function(e,t){return function(n,a){t(n,a,e)}},f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"audience_feed"));return n.getFeedsAggregationMetrics=function(e){return n.service.getFeedsAggregationMetrics(e)},n.getInstanceById=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.service.getInstanceById(e,t)},n.getInstanceProperties=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.service.getInstanceProperties(e,t)},n.updatePluginInstance=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.service.updatePluginInstance(e,t)},n.updatePluginInstanceProperty=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return n.service.updatePluginInstanceProperty(e,t,a,r)},n.createPluginInstance=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.service.createPluginInstance(e,t)},n.getAudienceFeed=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"EXTERNAL_FEED"===n.feedType?n.audienceSegmentService.getAudienceExternalFeed(n.segmentId,e,t):n.audienceSegmentService.getAudienceTagFeed(n.segmentId,e,t)},n.createAudienceFeed=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"EXTERNAL_FEED"===n.feedType?n.audienceSegmentService.createAudienceExternalFeeds(n.segmentId,e,t):n.audienceSegmentService.createAudienceTagFeeds(n.segmentId,e,t)},n.updateAudienceFeed=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return"EXTERNAL_FEED"===n.feedType?n.audienceSegmentService.updateAudienceExternalFeeds(n.segmentId,e,t,a):n.audienceSegmentService.updateAudienceTagFeeds(n.segmentId,e,t,a)},n.getAudienceFeedProperties=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"EXTERNAL_FEED"===n.feedType?n.audienceSegmentService.getAudienceExternalFeedProperties(n.segmentId,e,t):n.audienceSegmentService.getAudienceTagFeedProperties(n.segmentId,e,t)},n.updateAudienceFeedProperty=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return"EXTERNAL_FEED"===n.feedType?n.audienceSegmentService.updateAudienceSegmentExternalFeedProperty(e,n.segmentId,t,a,r):n.audienceSegmentService.updateAudienceSegmentTagFeedProperty(e,n.segmentId,t,a,r)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"getFeeds",value:function(e){return this.service.getFeeds(e)}},{key:"getAudienceFeeds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.service.getAudienceFeeds(e,t)}},{key:"deleteAudienceFeed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.service.deleteAudienceFeed(e,t)}},{key:"getLocalizedPluginLayout",value:function(e){return this.service.getLocalizedPluginLayout(e)}}]),t}(s.default);u([(0,l.inject)(c.TYPES.IAudienceSegmentService)],f.prototype,"audienceSegmentService",void 0),f=u([d(0,(0,l.inject)(c.TYPES.IAudienceSegmentFeedServiceFactory))],f),t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INITIAL_DEAL_LIST_FORM_DATA={name:"",deals:[]}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isHistoryCreateEvent=function(e){return"CREATE_EVENT"===e.type},t.isHistoryUpdateEvent=function(e){return"UPDATE_EVENT"===e.type},t.isHistoryDeleteEvent=function(e){return"DELETE_EVENT"===e.type},t.isHistoryLinkEvent=function(e){return"CREATE_LINK_EVENT"===e.type||"DELETE_LINK_EVENT"===e.type},t.isHistoryCreateLinkEvent=function(e){return"CREATE_LINK_EVENT"===e.type},t.isHistoryDeleteLinkEvent=function(e){return"DELETE_LINK_EVENT"===e.type},t.isHistoryEventAction=function(e){return"ACTION"===e.event_type}},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(1488),s=n(59),l=(a=s)&&a.__esModule?a:{default:a};function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=function(e){function t(){return c(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.layout,n=e.contentComponent,a=e.editComponent,r=e.actionBarComponent,s=e.organisationSelector,c=e.showOrgSelector,u=e.orgSelectorSize;switch(l.default.trace("Render "+t+" layout with component",n),t){case"main":return o.createElement(i.MainLayout,{contentComponent:n,actionBarComponent:r||null,organisationSelector:s||function(){return o.createElement("div",null,"no org selector")},showOrgSelector:c||!1,orgSelectorSize:u||200});case"settings":return o.createElement(i.SettingLayout,{contentComponent:n,actionBarComponent:r||null,organisationSelector:s||function(){return o.createElement("div",null,"no org selector")},showOrgSelector:c||!1,orgSelectorSize:u||200});case"edit":return a&&o.createElement(i.EditLayout,{editComponent:a});default:var d="Unhandled layout "+t;throw l.default.error(d),new Error(d)}}}]),t}(o.Component);d.defaultProps={contentComponent:function(){return o.createElement("div",null,"no content")},editComponent:function(){return o.createElement("div",null,"no edit")},organisationSelector:function(){return o.createElement("div",null,"no org selector")},showOrgSelector:!1,actionBarComponent:null,orgSelectorSize:200},t.default=d},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),r=n(10);var o=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};t.default=function(e){var t=e.title,n=o(e,["title"]);return a.createElement(r.Radio,n,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),r=n(6);t.default=function(e){var t=e.title,n=e.subtitle;return a.createElement("div",{className:"title-container"},a.createElement("div",{className:"title"},a.createElement(r.FormattedMessage,t)),!!n&&a.createElement("div",{className:"subtitle"},a.createElement(r.FormattedMessage,n)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(54),l=n(1667),c=(a=l)&&a.__esModule?a:{default:a};function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},p=function(e){function t(){return u(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.input,n=(e.meta,e.invert),a=e.disabled,o=f(e,["input","meta","invert","disabled"]),l=n?!t.value:t.value;return i.createElement(c.default,r({},o,(0,s.omit)(t,["onFocus","onBlur"]),{checked:l,onChange:function(e){n?t.onChange(!e):t.onChange(e)},disabled:a}))}}]),t}(i.Component);t.default=p},,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(47),l=(a=s)&&a.__esModule?a:{default:a},c=n(10);var u=c.Select.Option,d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.id=(0,l.default)(),n.state={didMount:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentDidMount",value:function(){this.setState({didMount:!0})}},{key:"render",value:function(){var e=this,t=this.props,n=t.selectProps,a=t.input,o=t.style,s=t.options,d=t.disabled,f=this.state.didMount,p=a.value||s[0],m=s.filter((function(e){return e.value!==p.key})).map((function(e){return i.createElement(u,r({key:e.key||(0,l.default)()},e),e.children||e.title)}));return i.createElement("span",{id:this.id,className:"mcs-addonSelect"},f&&i.createElement(c.Select,r({id:a.name,onBlur:function(){return a.onBlur(a.value)},onChange:a.onChange,onFocus:a.onFocus,value:a.value},n,{style:Object.assign({display:"flex",justifyContent:"center"},o),disabled:d,getPopupContainer:function(){return document.getElementById(e.id)}}),m))}}]),t}(i.Component);d.defaultProps={style:{width:100},disabled:!1},t.default=d},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(84),c=(a=l)&&a.__esModule?a:{default:a},u=n(11);var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.warningOnTokenChange=function(e){var t=n.state.value;n.setState({displayWarning:!!t&&t!==e.target.value})},n.state={displayWarning:!1,value:e.input.value},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.helpToolTipProps,n=e.formItemProps,a=e.inputProps,o=e.message,l=e.iconType,d=e.type,f=e.input,p=e.meta,m=e.small,g="success";p.touched&&p.invalid&&(g="error"),p.touched&&p.warning&&(g="warning");var y=s.Input,h=Object.assign(Object.assign({},a),{onKeyUp:this.warningOnTokenChange}),v=this.state.displayWarning;return i.createElement("div",null,v&&i.createElement(s.Row,null,i.createElement(s.Col,{offset:4,className:"modificationWarning"},i.createElement(s.Row,null,i.createElement(s.Col,{span:15},i.createElement(s.Alert,{message:i.createElement("div",null,i.createElement(u.McsIcon,{type:l}),o),type:d||"info"}))))),i.createElement(c.default,r({help:p.touched&&(p.warning||p.error),helpToolTipProps:t,validateStatus:g,small:m},n),i.createElement(y,r({id:f.name},f,h))))}}]),t}(i.Component);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(8),o=n(25),i=n(33),s=n(59),l=(a=s)&&a.__esModule?a:{default:a},c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(67));var u=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},d=0;t.default=(0,r.compose)(i.withRouter,(0,o.connect)((function(e){return{getDefaultDatamart:c.getDefaultDatamart(e)}})),(0,r.mapProps)((function(e){var t=e.getDefaultDatamart,n=u(e,["getDefaultDatamart"]),a=t(n.match.params.organisationId);return a||0!==d||(d=1,l.default.error("No datamart found for organisationId ",n.match.params.organisationId)),Object.assign({datamart:a},n)})))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=c(n(0)),o=n(8),i=n(25),s=n(33),l=c(n(67));function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e){function t(){return u(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.hasDatamarts,a=e.children;return r.createElement("div",null,n(t)&&a)}}]),t}(r.Component);t.default=(0,o.compose)(s.withRouter,(0,i.connect)((function(e){return{hasDatamarts:l.hasDatamarts(e)}})))(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(6),l=d(n(23)),c=n(8),u=d(n(1995));function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchData=function(){var e=n.props,t=e.convertQuery,a=e.notifyError;n.setState({loading:!0,query:void 0}),t().then((function(e){n.setState({query:e.data,loading:!1})})).catch((function(e){a(e)}))},n.state={loading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this.props,t=e.onOk,n=e.visible,r=f(e,["onOk","visible"]),l=this.state,c=l.query,d=l.loading;return o.createElement(i.Modal,a({},r,{visible:n,onOk:t,title:o.createElement(s.FormattedMessage,{id:"queryTool.query-tool-modal-saveas-export-title",defaultMessage:"Save As Export"})}),d?o.createElement(i.Spin,{size:"small"}):void 0,c?o.createElement(u.default,{language:"otql",value:c.query_text}):void 0)}}]),t}(o.Component);t.default=(0,c.compose)(l.default)(p)},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavigatorSettingsMainMenu=t.NavigatorSettingsSideMenu=t.NavigatorMenu=void 0;var a=i(n(2013)),r=i(n(2558)),o=i(n(2716));function i(e){return e&&e.__esModule?e:{default:e}}t.NavigatorMenu=a.default,t.NavigatorSettingsSideMenu=o.default,t.NavigatorSettingsMainMenu=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.campaignRoutes=t.campaignsDefinition=void 0;var a=n(2015),r=n(2036),o=n(2067),i=n(2091),s=g(n(2229)),l=g(n(2230)),c=g(n(2236)),u=n(2242),d=n(2245),f=n(2251),p=g(n(2255)),m=n(185);function g(e){return e&&e.__esModule?e:{default:e}}var y=t.campaignsDefinition={campaignDisplayList:{path:"/campaigns/display",layout:"main",contentComponent:a.DisplayCampaignsPage,requiredFeature:"campaigns-display"},campaignDisplayCreation:{path:"/campaigns/display/create",layout:"edit",editComponent:i.EditCampaignPage,requiredFeature:"campaigns-display"},campaignDisplayEdition:{path:"/campaigns/display/:campaignId(\\d+)/edit",layout:"edit",editComponent:i.EditCampaignPage,requiredFeature:"campaigns-display"},campaignDisplayDashboard:{path:"/campaigns/display/:campaignId(\\d+)",layout:"main",contentComponent:r.DisplayCampaignPage,requiredFeature:"campaigns-display"},campaignDisplayAdGroupDashboard:{path:"/campaigns/display/:campaignId(\\d+)/adgroups/:adGroupId(\\d+)",layout:"main",contentComponent:r.AdGroupPage,requiredFeature:"campaigns-display"},campaignDisplayAdGroupCreation:{path:"/campaigns/display/:campaignId(\\d+)/adgroups/create",layout:"edit",editComponent:o.EditAdGroupPage,requiredFeature:"campaigns-display"},campaignDisplayAdGroupEdition:{path:"/campaigns/display/:campaignId(\\d+)/adgroups/edit/:adGroupId(\\d+)",layout:"edit",editComponent:o.EditAdGroupPage,requiredFeature:"campaigns-display"},campaignEmailList:{path:"/campaigns/email",layout:"main",contentComponent:u.EmailCampaignListPage,actionBarComponent:u.EmailCampaignsActionbar,requiredFeature:"campaigns-email"},campaignEmailCreation:{path:"/campaigns/email/create",layout:"edit",editComponent:c.default,requiredFeature:"campaigns-email"},campaignEmailDashboard:{path:"/campaigns/email/:campaignId(\\d+)",layout:"main",contentComponent:d.EmailCampaignPage,requiredFeature:"campaigns-email"},campaignEmailEdition:{path:"/campaigns/email/:campaignId(\\d+)/edit",layout:"edit",editComponent:c.default,requiredFeature:"campaigns-email"},campaignEmailBlastCreation:{path:"/campaigns/email/:campaignId(\\d+)/blasts/create",layout:"edit",editComponent:l.default,requiredFeature:"campaigns-email"},campaignEmailBlastEdition:{path:"/campaigns/email/:campaignId(\\d+)/blasts/:blastId(\\d+)/edit",layout:"edit",editComponent:l.default,requiredFeature:"campaigns-email"},campaignGoalList:{path:"/campaigns/goals",layout:"main",contentComponent:f.GoalsTable,actionBarComponent:f.GoalsActionbar,requiredFeature:"campaigns-goals",requireDatamart:!0},campaignGoalDashboard:{path:"/campaigns/goals/:goalId(\\d+)",layout:"main",contentComponent:p.default,requiredFeature:"campaigns-goals",requireDatamart:!0},goalEdition:{path:"/campaigns/goals/:goalId/edit",layout:"edit",editComponent:s.default,requiredFeature:"campaigns-goals",requireDatamart:!0},goalCreation:{path:"/campaigns/goals/create",layout:"edit",editComponent:s.default,requiredFeature:"campaigns-goals",requireDatamart:!0}};t.campaignRoutes=(0,m.generateRoutesFromDefinition)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(33),l=n(6),c=n(8),u=n(25),d=n(107),f=n(11),p=w(n(142)),m=w(n(78)),g=n(56),y=n(83),h=n(800),v=n(30),b=w(n(2032)),_=n(61),S=w(n(23)),E=n(15),O=n(12);function w(e){return e&&e.__esModule?e:{default:e}}var M=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},P=(0,l.defineMessages)({setStatus:{id:"display.campaigns.list.multiEdit.status.setStatusTo",defaultMessage:"Set status to"},activeAll:{id:"display.campaigns.list.multiEdit.status.activeAll",defaultMessage:"Active"},pauseAll:{id:"display.campaigns.list.multiEdit.status.pauseAll",defaultMessage:"Paused"},exportInProgress:{id:"display.campaigns.list.actionbar.exportInProgress",defaultMessage:"Export in progress"},breadCrumbPath:{id:"display.campaigns.list.actionbar.breadCrumb.display",defaultMessage:"Display"}}),T=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchExportData=function(e,t){var a,r,o=t.from,i=t.to;return Promise.all([n._displayCampaignService.getDisplayCampaigns(e,"DISPLAY",(a={archived:t.statuses.includes("ARCHIVED"),first_result:0,max_results:2e3},r=t.statuses.filter((function(e){return"ARCHIVED"!==e})),t.keywords&&(a.keywords=t.keywords),r.length>0&&(a.status=r),a)),m.default.getDisplayCampaignPerformanceReport(e,o,i,[""])]).then((function(e){var t=(0,y.normalizeArrayOfObject)(e[0].data,"id"),n=(0,y.normalizeArrayOfObject)((0,g.normalizeReportView)(e[1].data.report_view),"campaign_id");return Object.keys(t).map((function(e){return Object.assign(Object.assign({},t[e]),n[e])}))}))},n.handleRunExport=function(){var e=n.props,t=e.match.params.organisationId,a=e.intl,r=(0,v.parseSearch)(n.props.location.search,h.DISPLAY_SEARCH_SETTINGS);n.setState({exportIsRunning:!0});var o=i.message.loading(a.formatMessage(P.exportInProgress),0);n.fetchExportData(t,r).then((function(e){p.default.exportDisplayCampaigns(t,e,r,a.formatMessage),n.setState({exportIsRunning:!1}),o()})).catch((function(e){n.props.notifyError(e),n.setState({exportIsRunning:!1}),o()}))},n.buildMenu=function(){var e=n.props.multiEditProps.handleStatusAction;return o.createElement(i.Menu,{onClick:function(t){switch(t.key){case"pause":return e("PAUSED");case"activate":return e("ACTIVE")}}},o.createElement(i.Menu.Item,{key:"pause"},o.createElement(l.FormattedMessage,P.pauseAll)),o.createElement(i.Menu.Item,{key:"activate"},o.createElement(l.FormattedMessage,P.activeAll)))},n.state={exportIsRunning:!1,allCampaignsActivated:!1,allCampaignsPaused:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.state.exportIsRunning,n=this.props,a=n.match.params.organisationId,r=n.intl,c=n.rowSelection.selectedRowKeys,u=n.multiEditProps,p=u.archiveCampaigns,m=u.visible,g=u.handleCancel,y=u.handleOk,h=u.openEditCampaignsDrawer,v=u.isArchiving,_=!!(c&&c.length>0),S=[{name:r.formatMessage(P.breadCrumbPath),path:"/v2/o/"+a+"/campaigns/display"}];return o.createElement(f.Actionbar,{paths:S},o.createElement(s.Link,{to:"/v2/o/"+a+"/campaigns/display/create"},o.createElement(i.Button,{className:"mcs-primary",type:"primary"},o.createElement(f.McsIcon,{type:"plus"})," ",o.createElement(l.FormattedMessage,{id:"display.campaigns.list.actionbar.newCampaignButton",defaultMessage:"New Campaign"}))),o.createElement(i.Button,{onClick:this.handleRunExport,loading:t},!t&&o.createElement(f.McsIcon,{type:"download"}),o.createElement(l.FormattedMessage,{id:"display.campaigns.list.actionbar.newExportButton",defaultMessage:"Export"})),o.createElement(f.Slide,{toShow:_,horizontal:!0,content:o.createElement(i.Button,{onClick:p,className:"button-slider button-glow"},o.createElement(f.McsIcon,{type:"delete"}),o.createElement(l.FormattedMessage,{id:"display.campaigns.list.actionbar.archiveButton",defaultMessage:"Archive"}))}),_?o.createElement(i.Modal,{title:o.createElement(l.FormattedMessage,b.default.archiveCampaignsModalTitle),visible:m,onOk:y,onCancel:g,confirmLoading:v},o.createElement(l.FormattedMessage,b.default.archiveCampaignsModalMessage)):null,o.createElement(f.Slide,{toShow:_,horizontal:!0,content:o.createElement(i.Button,{onClick:h,className:"button-slider button-glow"},o.createElement(f.McsIcon,{type:"pen"}),o.createElement(l.FormattedMessage,{id:"display.campaigns.list.actionbar.editCampaignButton",defaultMessage:"Edit"}))}),o.createElement(f.Slide,{toShow:_,horizontal:!0,content:o.createElement(d.Dropdown,{overlay:e.buildMenu(),trigger:["click"]},o.createElement(i.Button,{className:"button-glow"},o.createElement(f.McsIcon,{type:"chevron"}),o.createElement(l.FormattedMessage,P.setStatus)))}))}}]),t}(o.Component);M([(0,E.lazyInject)(O.TYPES.IDisplayCampaignService)],T.prototype,"_displayCampaignService",void 0);t.default=(0,c.compose)(s.withRouter,_.injectDrawer,S.default,(0,u.connect)((function(e){return{drawableContents:e.drawableContents}}),void 0),l.injectIntl)(T)},,function(e,t){},function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(8),l=n(30),c=n(6),u=n(13),d=n(1013),f=n(126),p=(a=f)&&a.__esModule?a:{default:a};function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=i.Layout.Content,h=t.messages=(0,c.defineMessages)({providerName:{id:"settings.datamart.seriveUsageReport.table.column.providerName",defaultMessage:"Provider Name"},campaignId:{id:"settings.datamart.seriveUsageReport.table.column.campaignId",defaultMessage:"Campaign Id"},campaignName:{id:"settings.datamart.seriveUsageReport.table.column.campaignName",defaultMessage:"Campaign Name"},subCampaignId:{id:"settings.datamart.seriveUsageReport.table.column.subCampaignId",defaultMessage:"Sub Campaign Id"},subCampaignName:{id:"settings.datamart.seriveUsageReport.table.column.subCampaignName",defaultMessage:"Sub Campaign Name"},serviceName:{id:"settings.datamart.seriveUsageReport.table.column.serviceName",defaultMessage:"Service Name"},serviceElementName:{id:"settings.datamart.seriveUsageReport.table.column.serviceElementName",defaultMessage:"Serivce Element Name"},usage:{id:"settings.datamart.seriveUsageReport.table.column.usage",defaultMessage:"Usage"},noData:{id:"settings.datamart.seriveUsageReport.empty.table",defaultMessage:"No data"}}),v=function(e){function t(){m(this,t);var e=g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.updateLocationSearch=function(t){var n=e.props,a=n.history,r=n.location,o=r.search,i={pathname:r.pathname,search:(0,l.updateSearch)(o,t,d.DISPLAY_SEARCH_SETTINGS)};a.push(i)},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.dataSource,a=t.additionnalComponent,r=t.location.search,i=[{intlMessage:h.providerName,key:"provider_name",isHideable:!1},{intlMessage:h.campaignName,key:"campaign_name",isHideable:!1},{intlMessage:h.subCampaignId,key:"sub_campaign_id",isHideable:!1},{intlMessage:h.serviceName,key:"service_name",isHideable:!1},{intlMessage:h.serviceElementName,key:"service_element_name",isHideable:!1},{intlMessage:h.usage,key:"usage",isHideable:!1}],s={iconType:"library",message:this.props.intl.formatMessage(h.noData)},c=(0,l.parseSearch)(r,d.DISPLAY_SEARCH_SETTINGS),u={isEnabled:!0,onChange:function(t){return e.updateLocationSearch({from:t.from,to:t.to})},values:{from:c.from,to:c.to}};return o.createElement("div",{className:"ant-layout"},o.createElement(y,{className:"mcs-content-container"},o.createElement(p.default,{fetchList:this.props.fetchList,dataSource:n,loading:this.props.loading,total:this.props.total,columns:i,pageSettings:l.PAGINATION_SEARCH_SETTINGS,emptyTable:s,additionnalComponent:a,dateRangePickerOptions:u})))}}]),t}(o.Component);t.default=(0,s.compose)(c.injectIntl,u.withRouter)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DISPLAY_SEARCH_SETTINGS=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(8),l=n(13),c=n(6),u=n(30),d=y(n(1012)),f=y(n(142)),p=n(15),m=n(12),g=n(11);function y(e){return e&&e.__esModule?e:{default:e}}function h(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=(0,c.defineMessages)({serviceUsageReportTitle:{id:"settings.datamart.serviceUsageReport.list.title",defaultMessage:"Service Usage Report List"}}),_=t.DISPLAY_SEARCH_SETTINGS=[].concat(h(u.PAGINATION_SEARCH_SETTINGS),h(u.FILTERS_SEARCH_SETTINGS),h(u.KEYWORD_SEARCH_SETTINGS),h(u.DATE_SEARCH_SETTINGS),h(u.LABELS_SEARCH_SETTINGS)),S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchAndStoreData=function(){n.fetchData().then((function(e){n.setState({dataSource:e.data.report_view.rows.map((function(e){return{provider_organisation_id:e[0],provider_name:e[1],campaign_id:e[2],campaign_name:e[3],sub_campaign_id:e[4],service_name:e[6],service_element_id:e[8],service_element_name:e[9],usage:e[10]}}))},(function(){n.setState({loading:!1,total:e.data.report_view.total_items})}))}))},n.fetchData=function(){var e=n.props,t=e.match.params.organisationId,a=e.location.search,r=(0,u.parseSearch)(a,_);return n._serviceUsageReportService.getServiceUsageProviders(t,r.from,r.to,["provider_organisation_id","provider_name","campaign_id","campaign_name","sub_campaign_id","sub_campaign_name","service_id","service_name","service_element_id","service_element_name","segment_name"])},n.handleRunExport=function(){var e=n.props,t=e.match.params.organisationId,a=e.location.search,r=e.intl.formatMessage,o=(0,u.parseSearch)(a,_);n.setState({exportIsRunning:!0}),n.fetchData().then((function(e){Promise.resolve(e.data.report_view.rows.map((function(e){return{provider_organisation_id:e[0],provider_name:e[1],campaign_id:e[2],campaign_name:e[3],sub_campaign_id:e[4],sub_campaign_name:e[5],service_id:e[6],service_name:e[7],service_element_id:e[8],segment_name:e[9],unit_count:e[10]}}))).then((function(e){f.default.exportServiceUsageReportList(t,e,o,r),n.setState({exportIsRunning:!1})}))}))},n.additionnalComponentRenderer=function(){var e=n.state.exportIsRunning;return o.createElement("div",null,o.createElement("span",{className:"mcs-card-title"},o.createElement(c.FormattedMessage,b.serviceUsageReportTitle)),o.createElement(i.Button,{onClick:n.handleRunExport,loading:e,style:{float:"right",bottom:"10px"}},!e&&o.createElement(g.McsIcon,{type:"download"}),o.createElement(c.FormattedMessage,{id:"settings.datamart.serviceUsageReport.list.export",defaultMessage:"Export"})),o.createElement("hr",{className:"mcs-separator"}))},n.state={loading:!0,dataSource:[],exportIsRunning:!1,total:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){this.fetchAndStoreData()}},{key:"render",value:function(){var e=this.state,t=e.dataSource,n=e.loading,a=e.total;return o.createElement(d.default,{fetchList:this.fetchAndStoreData,dataSource:t,loading:n,total:a,additionnalComponent:this.additionnalComponentRenderer()})}}]),t}(o.Component);v([(0,p.lazyInject)(m.TYPES.IServiceUsageReportService)],S.prototype,"_serviceUsageReportService",void 0),t.default=(0,s.compose)(c.injectIntl,l.withRouter)(S)},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CustomHighlightRules=void 0,n(2030);var i=t.CustomHighlightRules=function(e){function t(){a(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),n=e.createKeywordMapper({"support.function":"@count|@avg|@min|@max|@stats|@cardinality|@map|@histogram|@range|@geo|@missing|@filter",keyword:"select|from|where|and|or","constant.language":"true|false","storage.type":"int|numeric|decimal|date|varchar|char|bigint|float|double|bit|binary|text|set|timestamp|money|real|number|integer"},"identifier",!0);return e.$rules={start:[{token:"comment",regex:"--.*$"},{token:"comment",start:"/\\*",end:"\\*/"},{token:"string",regex:'".*?"'},{token:"string",regex:"'.*?'"},{token:"string",regex:"`.*?`"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:n,regex:"[a-zA-Z\\@_$][a-zA-Z0-9_$]*\\b"},{token:"keyword.operator",regex:"\\+|\\-|\\/|\\/\\/|%|<@>|@>|<@|&|\\^|~|<|>|<=|=>|==|!=|<>|="},{token:"paren.lparen",regex:"[\\{]"},{token:"paren.rparen",regex:"[\\}]"},{token:"text",regex:"\\s+"}]},e}return o(t,window.ace.acequire("ace/mode/text_highlight_rules").TextHighlightRules),t}(),s=function(e){function t(){a(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.HighlightRules=i,e}return o(t,window.ace.acequire("ace/mode/sql").Mode),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(34);var i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.el=document.createElement("div"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){document.body.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){document.body.removeChild(this.el)}},{key:"render",value:function(){return this.el.focus(),(0,o.createPortal)(this.props.children,this.el)}}]),t}(r.Component);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(33),s=n(41),l=n(10),c=n(6),u=n(68),d=n(800),f=n(30),p=n(56),m=n(1017),g=n(152),y=n(11);function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=(0,c.defineMessages)({PENDING:{id:"display.campaigns.list.status.new",defaultMessage:"New"},ACTIVE:{id:"display.campaigns.list.status.active",defaultMessage:"Active"},PAUSED:{id:"display.campaigns.list.status.paused",defaultMessage:"Paused"},ARCHIVED:{id:"display.campaigns.list.status.archived",defaultMessage:"Archived"},noCampaign:{id:"display.campaigns.noCampaign",defaultMessage:"No campaign"}}),_=function(e){function t(){h(this,t);var e=v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.editCampaign=function(t){var n=e.props,a=n.match.params.organisationId,r=n.location,o=n.history,i=n.intl;if("V2014_06"===t.model_version)l.message.info(i.formatMessage(g.messages.editionNotAllowed));else{var s="/v2/o/"+a+"/campaigns/display/"+t.id+"/edit";o.push({pathname:s,state:{from:""+r.pathname+r.search}})}},e.duplicateCampaign=function(t){var n=e.props,a=n.match.params.organisationId,r=n.history,o=n.intl,i="/v2/o/"+a+"/campaigns/display/create";"V2014_06"===t.model_version?l.message.info(o.formatMessage(g.messages.editionNotAllowed)):r.push({pathname:i,state:{campaignId:t.id}})},e.updateLocationSearch=function(t){var n=e.props,a=n.history,r=n.location,o=r.search,i={pathname:r.pathname,search:(0,f.updateSearch)(o,t,d.DISPLAY_SEARCH_SETTINGS)};a.push(i)},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.archiveCampaign,o=t.location.search,h=t.hasCampaigns,v=t.isFetchingCampaigns,_=t.isFetchingStats,S=t.dataSource,E=t.totalCampaigns,O=t.labels,w=t.rowSelection,M=t.isUpdatingStatuses,P=t.intl,T=(0,f.parseSearch)(o,d.DISPLAY_SEARCH_SETTINGS),I={placeholder:P.formatMessage(g.messages.searchDisplayCampaign),onSearch:function(t){return e.updateLocationSearch({keywords:t,currentPage:1})},defaultValue:T.keywords},A={isEnabled:!0,onChange:function(t){return e.updateLocationSearch({from:t.from,to:t.to})},values:{from:T.from,to:T.to}},C={current:T.currentPage,pageSize:T.pageSize,total:E,onChange:function(t,n){e.updateLocationSearch({currentPage:t,pageSize:n}),w&&w.unselectAllItemIds&&w.allRowsAreSelected&&w.unselectAllItemIds()},onShowSizeChange:function(t,n){return e.updateLocationSearch({currentPage:1,pageSize:n})}},j=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(_)return r.createElement("i",{className:"mcs-table-cell-loading"});switch(n){case"EUR":var a="€ ";return(0,p.formatMetric)(e,t,a);default:var o="";return(0,p.formatMetric)(e,t,o)}},R=[{intlMessage:g.messages.status,key:"status",isHideable:!1,render:function(e){return r.createElement(l.Tooltip,{placement:"top",title:P.formatMessage(b[e])},r.createElement("span",{className:"mcs-campaigns-status-"+e.toLowerCase()},r.createElement(y.McsIcon,{type:"status"})))}},{intlMessage:g.messages.name,key:"name",isHideable:!1,render:function(e,t){return r.createElement(i.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+n+"/campaigns/display/"+t.id},e)}},{intlMessage:g.messages.impressions,key:"impressions",isVisibleByDefault:!0,isHideable:!0,render:function(e){return j(e,"0,0")}},{intlMessage:g.messages.clicks,key:"clicks",isVisibleByDefault:!0,isHideable:!0,render:function(e){return j(e,"0,0")}},{intlMessage:g.messages.impressionCost,key:"impressions_cost",isVisibleByDefault:!0,isHideable:!0,render:function(e){return j(e,"0,0.00","EUR")}},{intlMessage:g.messages.cpm,key:"cpm",isVisibleByDefault:!0,isHideable:!0,render:function(e){return j(e,"0,0.00","EUR")}},{intlMessage:g.messages.ctr,key:"ctr",isVisibleByDefault:!0,isHideable:!0,render:function(e){return j(parseFloat(e)/100,"0.000%")}},{intlMessage:g.messages.cpc,key:"cpc",isVisibleByDefault:!0,isHideable:!0,render:function(e){return j(e,"0,0.00","EUR")}}],N=[{key:"action",actions:function(){return[{intlMessage:g.messages.editDisplayCampaign,callback:e.editCampaign},{intlMessage:g.messages.duplication,callback:e.duplicateCampaign},{intlMessage:g.messages.archiveDisplayCampaign,callback:a}]}}],k=m.campaignStatuses.map((function(e){return{key:e,value:e}})),D=[{displayElement:r.createElement("div",null,r.createElement(c.FormattedMessage,{id:"display.campaigns.list.filterStatus",defaultMessage:"Status"})," ",r.createElement(s.DownOutlined,null)),selectedItems:T.statuses.map((function(e){return{key:e,value:e}})),items:k,getKey:function(e){return e.key},display:function(e){return e.value},handleMenuClick:function(t){return e.updateLocationSearch({statuses:t.map((function(e){return e.value}))})}}],F={labels:this.props.labels,selectedLabels:O.filter((function(e){return!!T.label_id.find((function(t){return t===e.id}))})),onChange:function(t){var n=t.map((function(e){return e.id}));e.updateLocationSearch({label_id:n})},buttonMessage:g.messages.filterByLabel};return h?r.createElement("div",{className:"mcs-table-container"},r.createElement(u.TableViewFilters,{columns:R,actionsColumnsDefinition:N,searchOptions:I,dateRangePickerOptions:A,filtersOptions:D,columnsVisibilityOptions:{isEnabled:!0},dataSource:S,loading:v||M,pagination:C,labelsOptions:F,rowSelection:w})):r.createElement(y.EmptyTableView,{iconType:"display",message:P.formatMessage(b.noCampaign)})}}]),t}(r.Component);t.default=(0,o.compose)(i.withRouter,c.injectIntl)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.campaignStatuses=["ACTIVE","PAUSED","PENDING"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=d(n(0)),o=n(8),i=n(33),s=n(6),l=n(11),c=n(1019),u=d(n(114));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl,n=e.goals,a=e.campaignStat,o=e.isFetchingCampaignStat,i=e.isFetchingMediaStat,s=e.overallStat,d=e.mediaStat,f=e.isFetchingOverallStat,p=n.map((function(e){return{title:e.goal_name,key:e.id,display:r.default.createElement(c.GoalStackedAreaChart,{goal:e})}})),m=[{title:t.formatMessage(u.default.dashboardOverview),display:r.default.createElement(c.DisplayStackedAreaChart,{isFetchingCampaignStat:o,dataSource:a,overallStat:s,isFetchingOverallStat:f,renderCampaignProgress:!0})},{title:t.formatMessage(u.default.dashboardTopSites),display:r.default.createElement(c.MediaPerformanceTable,{isFetchingMediaStat:i,dataSet:d})}].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(p));return r.default.createElement(l.Card,null,r.default.createElement(l.McsTabs,{items:m}))}}]),t}(r.default.Component);t.default=(0,o.compose)(s.injectIntl,i.withRouter)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoalStackedAreaChart=t.MediaPerformanceTable=t.DisplayStackedAreaChart=void 0;var a=i(n(2041)),r=i(n(2046)),o=i(n(2047));function i(e){return e&&e.__esModule?e:{default:e}}t.DisplayStackedAreaChart=a.default,t.MediaPerformanceTable=r.default,t.GoalStackedAreaChart=o.default},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(8),l=n(13),c=b(n(272)),u=n(56),d=n(44),f=n(65),p=b(n(78)),m=b(n(81)),g=n(83),y=n(12),h=n(15),v=n(163);function b(e){return e&&e.__esModule?e:{default:e}}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=c.default,E=(0,i.defineMessages)({segmentSelectorTitle:{id:"segment-selector-title",defaultMessage:"Add an audience"},segmentSelectorSearchPlaceholder:{id:"segment-selector-search-placeholder",defaultMessage:"Search audience"},segmentSelectorColumnName:{id:"segment-selector-column-name",defaultMessage:"Name"},segmentSelectorColumnUserPoints:{id:"segment-selector-column-userPoints",defaultMessage:"User Points"},segmentSelectorColumnCookieIds:{id:"segment-selector.column-cookieIds",defaultMessage:"Desktop Cookie Ids"}}),O=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.saveSegments=function(e,t){n.props.save(t)},n.fetchSegments=function(e){var t=n.props.match.params.organisationId,a=Object.assign(Object.assign({},(0,d.getPaginatedApiParam)(e.currentPage,e.pageSize)),{persisted:!0});return e.keywords&&(a.keywords=e.keywords),e.datamartId&&(a.datamart_id=e.datamartId),n._audienceSegmentService.getSegments(t,a)},n.fetchSegment=function(e){return n._audienceSegmentService.getSegment(e)},n.state={reportBySegmentId:{},fetchingReport:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.organisationId;this.setState({fetchingReport:!0}),p.default.getAudienceSegmentReport(t,new m.default("now"),new m.default("now"),["audience_segment_id"],void 0).then((function(t){e.setState({fetchingReport:!1,reportBySegmentId:(0,g.normalizeArrayOfObject)((0,u.normalizeReportView)(t.data.report_view),"audience_segment_id")})}))}},{key:"render",value:function(){var e=this.props,t=e.selectedSegmentIds,n=e.close,a=e.intl.formatMessage,r=this.state,i=r.fetchingReport,s=r.reportBySegmentId,l=function(e,t){if(i)return o.createElement("i",{className:"mcs-table-cell-loading"});var n=s[e],a=n&&n[t];return(0,u.formatMetric)(a,"0,0")},c=[{intlMessage:E.segmentSelectorColumnName,key:"name",render:function(e,t){return o.createElement(v.SegmentNameDisplay,{audienceSegmentResource:t})}},{intlMessage:E.segmentSelectorColumnUserPoints,key:"user_points",render:function(e,t){return l(t.id,"user_points")}},{intlMessage:E.segmentSelectorColumnCookieIds,key:"desktop_cookie_ids",render:function(e,t){return l(t.id,"desktop_cookie_ids")}}];return o.createElement(S,{actionBarTitle:a(E.segmentSelectorTitle),displayFiltering:!0,searchPlaceholder:a(E.segmentSelectorSearchPlaceholder),selectedIds:t,fetchDataList:this.fetchSegments,fetchData:this.fetchSegment,columnsDefinitions:c,save:this.saveSegments,close:n,displayDatamartSelector:!0})}}]),t}(o.Component);_([(0,h.lazyInject)(y.TYPES.IAudienceSegmentService)],O.prototype,"_audienceSegmentService",void 0),t.default=(0,s.compose)(l.withRouter,i.injectIntl,f.injectDatamart)(O)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=T(n(47)),s=n(54),l=n(13),c=n(10),u=n(6),d=n(8),f=T(n(95)),p=n(178),m=n(61),g=n(83),y=T(n(807)),h=n(137),v=n(1024),b=n(11),_=T(n(809)),S=T(n(808)),E=T(n(410)),O=T(n(618)),w=n(44),M=n(15),P=n(12);function T(e){return e&&e.__esModule?e:{default:e}}var I=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateAds=function(e,t){var a=n.props,r=a.fields,o=a.formChange,s=[];t?r.getAll().forEach((function(n){t===n.key?s.push({key:t,model:e}):s.push(n)})):(s.push.apply(s,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(r.getAll())),s.push({key:(0,i.default)(),model:e})),o(r.name,s)},n.openCreativeCardSelector=function(){var e=n.props.fields,t=[];e.getAll().forEach((function(e){(0,p.isDisplayCreativeFormData)(e.model)?(0,h.isDisplayAdResource)(e.model.creative)&&t.push(e.model.creative.id):t.push(e.model.creative_id)}));var a={additionalProps:{close:n.props.closeNextDrawer,save:function(e){n.updateExistingAds(e),n.props.closeNextDrawer()},creativeType:"DISPLAY_AD",selectedCreativeIds:t}};n.props.openNextDrawer(y.default,a)},n.updateExistingAds=function(e){var t=n.props,a=t.fields,r=t.formChange,o=e.map((function(e){return e.id})),s=[];a.getAll().forEach((function(e){(0,p.isDisplayCreativeFormData)(e.model)?(0,h.isDisplayAdResource)(e.model.creative)&&o.includes(e.model.creative.id)&&s.push(e):o.includes(e.model.creative_id)&&s.push(e)}));var l=[];a.getAll().forEach((function(e){(0,p.isDisplayCreativeFormData)(e.model)||l.push(e.model.creative_id)}));var c=e.filter((function(e){return!l.includes(e.id)})).map((function(e){return{key:(0,i.default)(),model:{creative_id:e.id}}}));r(a.name,s.concat(c))},n.getCreativeCardFooter=function(e){var t=n.props,a=t.fields,r=t.disabled,i=(0,s.split)(e.creativeResource.format,"x"),l=(0,v.computeDimensionsByRatio)(Number(i[0]),Number(i[1])),u={backgroundColor:"#e8e8e8",border:"solid 1px #c7c7c7",height:l.width+"em",width:l.height+"em"},d=(0,h.isDisplayAdResource)(e.creativeResource)?e.creativeResource.audit_status:void 0;return o.createElement("div",null,o.createElement(c.Row,{className:"footer"},o.createElement(c.Col,{className:"inline formatWrapper",span:16},o.createElement("div",{style:u}),o.createElement("div",{className:"dimensions"},e.creativeResource.format)),o.createElement(c.Col,{className:"inline buttons",span:4},o.createElement(b.Button,{disabled:r,onClick:function(){return a.remove(e.fieldIndex)}},o.createElement(b.McsIcon,{className:"button",type:"delete"})))),o.createElement(c.Row,{className:"footer"},o.createElement(c.Col,{className:"inline formatWrapper",span:22},o.createElement(_.default,{auditStatus:d}))))},n.state={loading:!1,displayCreativeCacheById:{}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidUpdate",value:function(){var e=this,t=Object.keys(this.state.displayCreativeCacheById),n=[];this.props.fields.getAll().forEach((function(e){(0,p.isDisplayCreativeFormData)(e.model)||t.includes(e.model.creative_id)||n.push(e.model.creative_id)})),0!==n.length&&(this.cancelablePromise=(0,w.makeCancelable)(Promise.all(n.map((function(t){return e._creativeService.getDisplayAd(t).then((function(e){return e.data}))})))),this.cancelablePromise.promise.then((function(t){e.setState((function(e){return{displayCreativeCacheById:Object.assign(Object.assign({},e.displayCreativeCacheById),(0,g.normalizeArrayOfObject)(t,"id"))}}))})))}},{key:"componentWillUnmount",value:function(){this.cancelablePromise&&this.cancelablePromise.cancel()}},{key:"render",value:function(){var e=this,t=this.props,n=t.intl.formatMessage,a=t.fields,r=t.disabled,i=t.small,s=this.state.displayCreativeCacheById,l=[];a.getAll()&&a.getAll().forEach((function(e,t){(0,p.isDisplayCreativeFormData)(e.model)?l.push({creativeResource:e.model.creative,fieldIndex:t,fieldModel:e}):s[e.model.creative_id]&&l.push({creativeResource:s[e.model.creative_id],fieldIndex:t,fieldModel:e})}));var u=l.map((function(t){return o.createElement(c.Col,{key:t.fieldModel.key,span:i?12:6},o.createElement("div",{className:"ad-group-card"},o.createElement(S.default,{key:t.fieldModel.key,creative:t.creativeResource,renderFooter:function(){return e.getCreativeCardFooter(t)}})))}));return o.createElement("div",null,o.createElement(E.default,{dropdownItems:[{id:f.default.dropdownAddExisting.id,message:f.default.dropdownAddExisting,onClick:this.openCreativeCardSelector,disabled:r}],subtitle:f.default.sectionSubtitleAds,title:f.default.sectionTitleAds}),o.createElement(c.Spin,{spinning:this.state.loading},o.createElement("div",{className:"ad-group-ad-section",style:{overflow:"hidden"}},o.createElement("div",{className:"mcs-table-card content"},o.createElement(c.Row,{gutter:20},u)),!a.length&&o.createElement(O.default,{iconType:"ads",message:n(f.default.contentSectionAdEmptyTitle)}))))}}]),t}(o.Component);I([(0,M.lazyInject)(P.TYPES.ICreativeService)],A.prototype,"_creativeService",void 0),t.default=(0,d.compose)(l.withRouter,u.injectIntl,m.injectDrawer)(A)},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeDimensionsByRatio=function(e,t){var n=e>=t?t/e:e/t;return e>=t?{height:2,width:2*n}:{width:2,height:2*n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(8),s=p(n(95)),l=p(n(49)),c=p(n(63)),u=n(24),d=p(n(333)),f=n(152);function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.operatingSystems=function(){return[{value:"ALL",children:(0,f.formatAdGroupProperty)("targeted_operating_systems","ALL").formattedValue},{value:"IOS",children:(0,f.formatAdGroupProperty)("targeted_operating_systems","IOS").formattedValue},{value:"ANDROID",children:(0,f.formatAdGroupProperty)("targeted_operating_systems","ANDROID").formattedValue},{value:"WINDOWS_PHONE",children:(0,f.formatAdGroupProperty)("targeted_operating_systems","WINDOWS_PHONE").formattedValue}]},n.medias=function(){return[{value:"WEB",children:(0,f.formatAdGroupProperty)("targeted_medias","WEB").formattedValue},{value:"MOBILE_APP",children:(0,f.formatAdGroupProperty)("targeted_medias","MOBILE_APP").formattedValue}]},n.devices=function(){var e=n.state.mediaValue;return[{value:"ALL",children:(0,f.formatAdGroupProperty)("targeted_devices","ALL").formattedValue,disabled:"MOBILE_APP"===e},{value:"ONLY_DESKTOP",children:(0,f.formatAdGroupProperty)("targeted_devices","ONLY_DESKTOP").formattedValue,disabled:"MOBILE_APP"===e},{value:"ONLY_MOBILE",children:(0,f.formatAdGroupProperty)("targeted_devices","ONLY_MOBILE").formattedValue},{value:"ONLY_TABLET",children:(0,f.formatAdGroupProperty)("targeted_devices","ONLY_TABLET").formattedValue},{value:"MOBILE_AND_TABLET",children:(0,f.formatAdGroupProperty)("targeted_devices","MOBILE_AND_TABLET").formattedValue}]},n.connectionTypes=function(){var e=n.state.mediaValue;return[{value:"ALL",children:(0,f.formatAdGroupProperty)("targeted_connection_types","ALL").formattedValue},{value:"ETHERNET",children:(0,f.formatAdGroupProperty)("targeted_connection_types","ETHERNET").formattedValue,disabled:"MOBILE_APP"===e},{value:"WIFI",children:(0,f.formatAdGroupProperty)("targeted_connection_types","WIFI").formattedValue},{value:"CELLULAR_NETWORK_2G",children:(0,f.formatAdGroupProperty)("targeted_connection_types","CELLULAR_NETWORK_2G").formattedValue},{value:"CELLULAR_NETWORK_3G",children:(0,f.formatAdGroupProperty)("targeted_connection_types","CELLULAR_NETWORK_3G").formattedValue},{value:"CELLULAR_NETWORK_4G",children:(0,f.formatAdGroupProperty)("targeted_connection_types","CELLULAR_NETWORK_4G").formattedValue}]},n.browserFamilies=function(){return[{value:"ALL",children:(0,f.formatAdGroupProperty)("targeted_browser_families","ALL").formattedValue},{value:"CHROME",children:(0,f.formatAdGroupProperty)("targeted_browser_families","CHROME").formattedValue},{value:"FIREFOX",children:(0,f.formatAdGroupProperty)("targeted_browser_families","FIREFOX").formattedValue},{value:"SAFARI",children:(0,f.formatAdGroupProperty)("targeted_browser_families","SAFARI").formattedValue},{value:"INTERNET_EXPLORER",children:(0,f.formatAdGroupProperty)("targeted_browser_families","INTERNET_EXPLORER").formattedValue},{value:"OPERA",children:(0,f.formatAdGroupProperty)("targeted_browser_families","OPERA").formattedValue}]},n.onMediaChange=function(e){var t=n.props.name;n.setState({mediaValue:e}),n.props.formChange(t+".targeted_devices","WEB"===e?"ALL":"ONLY_MOBILE"),n.props.formChange("adGroup.targeted_operating_systems","ALL"),n.props.formChange("adGroup.targeted_connection_types","ALL"),n.props.formChange("adGroup.targeted_browser_families","ALL")},n.state={displayAdvancedSection:!1,mediaValue:n.props.initialValues.targeted_medias},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage,a=e.small,o=e.name,i=e.disabled;return r.createElement("div",null,r.createElement(u.FormSection,{subtitle:s.default.sectionSubtitleDevice,title:s.default.sectionTitleDevice}),r.createElement("div",null,r.createElement(u.FormSelectField,{name:o+".targeted_medias",component:d.default,validate:[t],formItemProps:{label:n((0,f.formatAdGroupProperty)("targeted_medias").message),required:!0},helpToolTipProps:{title:n(s.default.contentSectionDeviceMediaTypeTooltip)},selectProps:{onSelect:this.onMediaChange},options:this.medias(),small:a,disabled:i}),r.createElement(u.FormSelectField,{name:o+".targeted_devices",component:d.default,validate:[t],formItemProps:{label:n((0,f.formatAdGroupProperty)("targeted_devices").message),required:!0},selectProps:{},helpToolTipProps:{title:n(s.default.contentSectionDeviceTypeTooltip)},options:this.devices(),small:a,disabled:i}),r.createElement(u.FormSelectField,{name:o+".targeted_operating_systems",component:d.default,validate:[t],formItemProps:{label:n((0,f.formatAdGroupProperty)("targeted_operating_systems").message),required:!0},selectProps:{},helpToolTipProps:{title:n(s.default.contentSectionDeviceOSTooltip)},options:this.operatingSystems(),small:a,disabled:i}),r.createElement(u.FormSelectField,{name:o+".targeted_connection_types",component:d.default,validate:[t],formItemProps:{label:n((0,f.formatAdGroupProperty)("targeted_connection_types").message),required:!0},selectProps:{},helpToolTipProps:{title:n(s.default.contentSectionDeviceConnectionTypeTooltip)},disabled:i,options:this.connectionTypes(),small:a}),r.createElement(u.FormSelectField,{name:o+".targeted_browser_families",component:d.default,validate:[t],formItemProps:{label:n((0,f.formatAdGroupProperty)("targeted_browser_families").message),required:!0},selectProps:{},helpToolTipProps:{title:n(s.default.contentSectionDeviceBrowserTooltip)},options:this.browserFamilies(),small:a,disabled:i})))}}]),t}(r.Component);m.defaultProps={name:"adGroup"},t.default=(0,i.compose)(o.injectIntl,l.default,c.default)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=t.GoalFieldArray=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=_(n(0)),i=n(35),s=n(8),l=n(25),c=n(10),u=n(13),d=n(6),f=b(n(60)),p=b(n(101)),m=b(n(95)),g=b(n(1027)),y=b(n(1028)),h=b(n(1086)),v=_(n(67));function b(e){return e&&e.__esModule?e:{default:e}}function _(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var O=c.Layout.Content,w=t.GoalFieldArray=i.FieldArray,M=i.FieldArray,P=t.FORM_ID="campaignForm",T=function(e){function t(){return S(this,t),E(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.breadCrumbPaths,r=e.close,s=e.change,l=e.match.params.organisationId,u=e.hasDatamarts,d={formChange:s,rerenderOnEveryChange:!0},v={formId:P,paths:n,message:m.default.saveAdGroup,onClose:r},b=[];b.push({id:"general",title:m.default.sectionTitle1,component:o.createElement(g.default,null)}),u(l)&&b.push({id:"goals",title:m.default.sectionTitle2,component:o.createElement(w,a({name:"goalFields",component:y.default},d))}),b.push({id:"adGroups",title:m.default.sectionTitle3,component:o.createElement(M,a({name:"adGroupFields",component:h.default},d))});var _={items:b.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:P},S=b.map((function(e,t){return o.createElement("div",{key:e.id},o.createElement("div",{key:e.id,id:e.id},e.component),t!==b.length-1&&o.createElement("hr",null))}));return o.createElement(c.Layout,{className:"edit-layout"},o.createElement(f.default,v),o.createElement(c.Layout,{className:"ant-layout-has-sider"},o.createElement(p.default,_),o.createElement(i.Form,{className:"edit-layout ant-layout",onSubmit:t},o.createElement("button",{type:"submit",style:{display:"none"}}),o.createElement(O,{id:P,className:"mcs-content-container mcs-form-container"},S))))}}]),t}(o.Component);t.default=(0,s.compose)(d.injectIntl,u.withRouter,(0,i.reduxForm)({form:P,enableReinitialize:!0}),(0,l.connect)((function(e){return{hasDatamarts:v.hasDatamarts(e)}})))(T)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=m(n(95)),l=n(11),c=n(24),u=m(n(49)),d=m(n(63)),f=n(13),p=n(152);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldNormalizer.normalizeInteger,n=e.fieldValidators,a=n.isRequired,o=n.isNotZero,i=n.isValidFloat,u=n.isValidInteger,d=e.intl.formatMessage;return r.createElement("div",null,r.createElement(c.FormSection,{subtitle:s.default.sectionSubtitle1,title:s.default.sectionTitle1}),r.createElement("div",null,r.createElement(c.FormInputField,{name:"campaign.name",component:c.FormInput,validate:[a],formItemProps:{label:d((0,p.formatDisplayCampaignProperty)("name").message),required:!0},inputProps:{placeholder:d(s.default.campaignFormPlaceholderCampaignName)},helpToolTipProps:{title:d(s.default.contentSectionGeneralRow1Tooltip)}}),r.createElement(c.FormInputField,{name:"campaign.total_impression_capping",component:c.FormInput,normalize:t,validate:[u],formItemProps:{label:d((0,p.formatDisplayCampaignProperty)("total_impression_capping").message)},inputProps:{placeholder:d(s.default.contentSectionGeneralAdvancedPartRow2Placeholder)},helpToolTipProps:{title:d(s.default.contentSectionGeneralAdvancedPartRow2Tooltip)}}),r.createElement(c.FormInputField,{name:"campaign.per_day_impression_capping",component:c.FormInput,normalize:t,validate:[u],formItemProps:{label:d((0,p.formatDisplayCampaignProperty)("per_day_impression_capping").message)},inputProps:{placeholder:d(s.default.contentSectionGeneralAdvancedPartRow3Placeholder)},helpToolTipProps:{title:d(s.default.contentSectionGeneralAdvancedPartRow3Tooltip)}}),r.createElement(c.FormInputField,{name:"campaign.total_budget",component:c.FormInput,validate:[i,o],formItemProps:{label:d((0,p.formatDisplayCampaignProperty)("total_budget").message)},inputProps:{suffix:r.createElement("span",null,"€"),placeholder:d(s.default.contentSectionGeneralAdvancedPartRow4Placeholder)},helpToolTipProps:{title:d(s.default.contentSectionGeneralAdvancedPartRow4Tooltip)}}),r.createElement(c.FormInputField,{name:"campaign.max_budget_per_period",component:c.FormInput,validate:[i,o],formItemProps:{label:d((0,p.formatDisplayCampaignProperty)("max_budget_per_period").message)},inputProps:{suffix:r.createElement("span",null,"€"),addonAfter:r.createElement(c.FormAddonSelectField,{name:"campaign.max_budget_period",component:c.AddonSelect,options:[{value:"DAY",title:"DAY",children:(0,p.formatDisplayCampaignProperty)("max_budget_period","DAY").formattedValue},{value:"WEEK",title:"WEEK",children:(0,p.formatDisplayCampaignProperty)("max_budget_period","WEEK").formattedValue},{value:"MONTH",title:"MONTH",children:(0,p.formatDisplayCampaignProperty)("max_budget_period","MONTH").formattedValue}]}),placeholder:d(s.default.contentSectionGeneralAdvancedPartRow5Placeholder),style:{width:"100%"}},helpToolTipProps:{title:d(s.default.contentSectionGeneralAdvancedPartRow5Tooltip)}})),r.createElement("div",null,r.createElement(l.Button,{className:"optional-section-title",onClick:this.toggleAdvancedSection},r.createElement(l.McsIcon,{type:"settings"}),r.createElement("span",{className:"step-title"},d(s.default.contentSectionGeneralAdvancedPartTitle)),r.createElement(l.McsIcon,{type:"chevron"})),r.createElement("div",{className:this.state.displayAdvancedSection?"optional-section-content":"hide-section"},r.createElement(c.FormAlertInputField,{name:"campaign.technical_name",component:c.FormAlertInput,formItemProps:{label:d((0,p.formatDisplayCampaignProperty)("technical_name").message)},inputProps:{placeholder:d(s.default.contentSectionGeneralAdvancedPartRow1Placeholder)},helpToolTipProps:{title:d(s.default.contentSectionGeneralAdvancedPartRow1Tooltip)},iconType:"warning",type:"warning",message:d(s.default.warningOnTokenEdition)}))))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,u.default,d.default,f.withRouter)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(10),l=n(13),c=n(6),u=n(271),d=T(n(225)),f=T(n(95)),p=n(61),m=n(739),g=T(n(2093)),y=n(65),h=n(11),v=n(183),b=n(24),_=n(112),S=n(263),E=T(n(1029)),O=T(n(2222)),w=n(15),M=n(12),P=n(160);function T(e){return e&&e.__esModule?e:{default:e}}var I=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.openGoalSelector=function(){var e={additionalProps:{selectedGoalIds:C(n.props.fields.getAll()),close:n.props.closeNextDrawer,save:function(e){n.updateExistingGoals(e),n.props.closeNextDrawer()}}};n.props.openNextDrawer(g.default,e)},n.updateExistingGoals=function(e){var t=n.props,a=t.fields,r=t.formChange,o=e.map((function(e){return e.id})),i=[];a.getAll().forEach((function(e){(0,m.isGoalFormData)(e.model)?(0,S.isGoalResource)(e.model.goal)?o.includes(e.model.goal.id)&&i.push(e):(0,m.isGoalFormData)(e.model)&&i.push(e):o.includes(e.model.goal_id)&&i.push(e)})),r(a.name,i);var s=C(a.getAll()),l=[];e.filter((function(e){return!s.includes(e.id)})).forEach((function(e){var t={goal_id:e.id,goal_selection_type:"CONVERSION",default:!0};return n._goalService.getGoal(t.goal_id).then((function(e){return e.data})).then((function(n){var a=n.new_query_id?"QUERY":"PIXEL";l.push({key:(0,P.generateFakeId)(),model:t,meta:{name:e.name,triggerMode:a}})})).then((function(){r(a.name,i.concat(l))}))}))},n.updateGoals=function(e,t){var a=n.props,r=a.fields,o=a.formChange,i=[];t?r.getAll().forEach((function(n){t===n.key?i.push({key:t,model:e,meta:{name:e.goal.name||"",triggerMode:e.triggerType}}):i.push(n)})):(i.push.apply(i,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(r.getAll())),i.push({key:(0,P.generateFakeId)(),model:e,meta:{name:e.goal.name||"",triggerMode:e.triggerType}})),o(r.name,i)},n.openGoalForm=function(e){var t=n.props.intl.formatMessage,a={breadCrumbPaths:[{name:e&&e.meta.name?t(f.default.editGoal,{goalName:e.meta.name}):t(f.default.newGoal)}],close:n.props.closeNextDrawer,onSubmit:function(t){n.updateGoals(t,e&&e.key),n.props.closeNextDrawer()}},r={additionalProps:a},o=E.default;e?(0,m.isGoalFormData)(e.model)?a.initialValues=e.model:(o=O.default,a.goalId=e.model.goal_id):a.initialValues=Object.assign({},S.INITIAL_GOAL_FORM_DATA),n.props.openNextDrawer(o,r)},n.getPixelSnippet=function(e){var t=n.props.intl.formatMessage;return o.createElement(h.Button,{onClick:n.handleCodeSnippetClick(e),title:t(f.default.getCodeSnippet)},o.createElement(h.McsIcon,{type:"code",className:"big"}))},n.updateFields=function(e,t){var a=n.props,r=a.fields,o=a.formChange,i=n.state.field,s=[],l=[];return r.getAll().forEach((function(a){l.push((function(){return n._goalService.getGoal(e).then((function(e){return e.data})).then((function(n){i&&a.key===i.key?s.push({key:(0,P.generateFakeId)(),model:{goal_id:e,goal_selection_type:"CONVERSION",default:!0},meta:{name:t,triggerMode:n.new_query_id?"QUERY":"PIXEL"}}):s.push(a)}))}))})),(0,_.executeTasksInSequence)(l).then((function(){o(r.name,s)}))},n.goalPixelModalOnOk=function(){var e=n.props.match.params.organisationId,t=n.state.field;if(t&&t.model){n.setState({loading:!0});var a=t.model;n._goalFormService.saveGoal(e,a).then((function(e){n.setState({loading:!1,visible:!1}),n.showPixelSnippet(e.id,(function(){return n.updateFields(e.id,e.name)}))}))}},n.getGoalRecords=function(){var e=n.props.fields,t=function(e){return e.meta.name};return e.getAll().map((function(a,r){var i="PIXEL"===a.meta.triggerMode;return o.createElement(v.RecordElement,{key:a.key,recordIconType:"goals",record:a,title:t,additionalActionButtons:i?n.getPixelSnippet:void 0,onEdit:function(){return n.openGoalForm(a)},onRemove:function(){return e.remove(r)}})}))},n.closeGoalPixelModal=function(){n.setState({visible:!1})},n.displayGoalPixelModal=function(e){n.setState({visible:!0,field:e})},n.showPixelSnippet=function(e,t){var a=n.props,r=a.intl.formatMessage,i=a.datamart;s.Modal.info({width:520,title:r(f.default.goalPixelModalTitle),content:o.createElement("div",null,o.createElement("p",null,r(f.default.goalPixelModalContent)),o.createElement("br",null),o.createElement(d.default,{language:"html",style:u.docco},'<img style="display:none" src="https://events.mediarithmics.com/v1/touches/pixel?$ev=$conversion&$dat_token='+i.token+"&$goal_id="+e+'" />')),onOk:function(){t&&t()}})},n.handleCodeSnippetClick=function(e){return function(){(0,m.isGoalFormData)(e.model)?(0,S.isGoalResource)(e.model.goal)?n.showPixelSnippet(e.model.goal.id):n.displayGoalPixelModal(e):n.showPixelSnippet(e.model.goal_id)}},n.state={visible:!1,loading:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.intl.formatMessage,t=this.state,n=t.visible,a=t.loading;return o.createElement("div",{id:"goals"},o.createElement(b.FormSection,{dropdownItems:[{id:f.default.dropdownNew.id,message:f.default.dropdownNew,onClick:this.openGoalForm},{id:f.default.dropdownAddExisting.id,message:f.default.dropdownAddExisting,onClick:this.openGoalSelector}],subtitle:f.default.sectionSubtitle2,title:f.default.sectionTitle2}),o.createElement(v.RelatedRecords,{emptyOption:{iconType:"goals",message:e(f.default.campaignGoalSelectionEmpty)}},this.getGoalRecords()),o.createElement(s.Modal,{title:e(f.default.goalPixelModalTitle),visible:n,onOk:this.goalPixelModalOnOk,confirmLoading:a,onCancel:this.closeGoalPixelModal},o.createElement("p",null,e(f.default.goalPixelModalSaveGoal))))}}]),t}(o.Component);function C(e){var t=[];return e.forEach((function(e){(0,m.isGoalFormData)(e.model)?(0,S.isGoalResource)(e.model.goal)&&t.push(e.model.goal.id):t.push(e.model.goal_id)})),t}I([(0,w.lazyInject)(M.TYPES.IGoalFormService)],A.prototype,"_goalFormService",void 0),I([(0,w.lazyInject)(M.TYPES.IGoalService)],A.prototype,"_goalService",void 0),t.default=(0,i.compose)(c.injectIntl,l.withRouter,y.injectDatamart,p.injectDrawer)(A)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(263),l=n(810),c=b(l),u=b(n(23)),d=n(13),f=n(109),p=b(n(200)),m=n(65),g=n(51),y=b(n(2221)),h=n(12),v=n(15);function b(e){return e&&e.__esModule?e:{default:e}}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onDatamartSelect=function(e){var t=n.props.initialValues;n.setState({selectedDatamart:e,initialValues:Object.assign(Object.assign({},t),{goal:Object.assign(Object.assign({},s.INITIAL_GOAL_FORM_DATA.goal),{datamart_id:e.id}),attributionModels:t.attributionModels})})},n.handleTriggerTypeSelect=function(e,t){n.setState((function(n){return Object.assign(Object.assign({},n),{showTriggerTypeSelector:!1,initialValues:Object.assign(Object.assign({},n.initialValues),{triggerType:e,queryLanguage:t})})}))},n.state={selectedDatamart:void 0,initialValues:n.props.match.params.goalId?n.props.initialValues:s.INITIAL_GOAL_FORM_DATA,loading:!1,showTriggerTypeSelector:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.initialValues,a=t.workspace;n.goal&&(0,s.isGoalResource)(n.goal)?(this.setState({loading:!0}),this._datamartService.getDatamart(n.goal.datamart_id).then((function(t){e.setState({loading:!1,showTriggerTypeSelector:!1,selectedDatamart:t.data})})).catch((function(t){e.props.notifyError(t),e.setState({loading:!1})}))):1===a.datamarts.length&&this.onDatamartSelect(a.datamarts[0])}},{key:"render",value:function(){var e=this,t=this.props,n=t.save,a=t.close,r=t.onSubmitFail,i=t.breadCrumbPaths,s=t.onSubmit,u=this.state,d=u.selectedDatamart,m=u.initialValues,h=u.loading,v=u.showTriggerTypeSelector;if(h)return o.createElement(g.Loading,{isFullScreen:!0});return!v&&d?o.createElement(c.default,{initialValues:m,onSubmit:n||s,close:a,breadCrumbPaths:i,onSubmitFail:r,datamart:d,goToTriggerTypeSelection:function(){e.setState({showTriggerTypeSelector:!0})}}):v&&d?o.createElement(f.EditContentLayout,{paths:i,formId:l.FORM_ID,onClose:a},"(",o.createElement(y.default,{onSelect:this.handleTriggerTypeSelect,datamart:d})):o.createElement(p.default,{onSelect:this.onDatamartSelect,actionbarProps:{onClose:a,paths:i}})}}]),t}(o.Component);_([(0,v.lazyInject)(h.TYPES.IDatamartService)],S.prototype,"_datamartService",void 0),t.default=(0,i.compose)(u.default,d.withRouter,m.injectWorkspace)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(2099),l=(a=s)&&a.__esModule?a:{default:a};function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=function(e){function t(){return c(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){return i.createElement(l.default,r({value:this.props.input.value},this.props.inputProps,{onChange:this.props.input.onChange}))}}]),t}(i.Component);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BooleanOperatorNodeWidget=t.BooleanOperatorNodeModel=t.BooleanOperatorNodeFactory=void 0;var a=i(n(2101)),r=i(n(1052)),o=i(n(1032));function i(e){return e&&e.__esModule?e:{default:e}}t.BooleanOperatorNodeFactory=a.default,t.BooleanOperatorNodeModel=r.default,t.BooleanOperatorNodeWidget=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=m(n(47)),i=n(1033),s=m(n(1015)),l=n(226),c=n(8),u=m(n(69)),d=m(n(625)),f=n(6),p=m(n(626));function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.top=0,n.left=0,n.id=(0,o.default)(),n.setPosition=function(e){var t=e?e.getBoundingClientRect():null;n.top=t?t.top:0,n.left=t?t.left:0},n.changeBooleanOperator=function(e){return function(){var t=n.props,a=t.node,r=t.treeNodeOperations;return(0,t.lockGlobalInteraction)(!1),n.setState({focus:!1}),r.updateNode(a.treeNodePath,Object.assign(Object.assign({},a.objectOrGroupNode),{negation:e.negation,boolean_operator:e.booleanOperator}))}},n.removeGroup=function(){var e=n.props,t=e.node,a=e.treeNodeOperations,r=e.lockGlobalInteraction;return n.setState({focus:!1}),r(!1),a.deleteNode(t.treeNodePath)},n.copyNode=function(){var e=n.props,t=e.node,a=e.treeNodeOperations,r=e.lockGlobalInteraction;n.setState({focus:!1},(function(){r(!1),"GROUP"===n.props.node.objectOrGroupNode.type&&a.copyNode(t.treeNodePath,"UserPoint",n.props.node.treeNodePath)}))},n.cutNode=function(){var e=n.props,t=e.node,a=e.treeNodeOperations,r=e.lockGlobalInteraction;n.setState({focus:!1},(function(){r(!1),"GROUP"===n.props.node.objectOrGroupNode.type&&(a.copyNode(t.treeNodePath,"UserPoint",n.props.node.treeNodePath),a.deleteNode(t.treeNodePath))}))},n.pasteNode=function(){var e=n.props,t=e.node,a=e.treeNodeOperations,r=e.lockGlobalInteraction,o=n.canPasteHere(),i=o?Object.assign({},o):void 0;i&&n.setState({focus:!1},(function(){if(r(!1),"GROUP"===t.objectOrGroupNode.type){var e=Object.assign({},t.objectOrGroupNode),o=Object.assign({},i);e.expressions.push(o),a.updateNode(t.treeNodePath,e)}n.props.diagramEngine.emptyClipboard()}))},n.canPasteHere=function(){if("GROUP"===n.props.node.objectOrGroupNode.type&&n.props.diagramEngine.isCopying()){var e=n.props.diagramEngine.getCopiedValue();if(e&&e.copiedObjectType&&e.objectType&&"UserPoint"===e.objectType&&e.treeNodePath!==n.props.node.treeNodePath)return e.copiedObjectType}},n.state={hover:!1,focus:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.node,a=t.connectDropTarget,o=t.isDragging,l=function(t){return function(){return e.setState({hover:"enter"===t})}},c=function(){e.setPosition(document.getElementById(e.id)),e.props.lockGlobalInteraction(!e.state.focus),e.setState({focus:!e.state.focus})},u=this.props.diagramEngine.getDiagramModel().zoom/100,m="#ffffff";this.state.hover&&(m=n.getColor());var g=o?.3:1,y={AND:{booleanOperator:"AND",negation:!1},AND_NOT:{booleanOperator:"AND",negation:!0},OR:{booleanOperator:"OR",negation:!1},OR_NOT:{booleanOperator:"OR",negation:!0}},h=[];return this.props.diagramEngine.isCopying()?this.canPasteHere()&&h.push(r.createElement("div",{onClick:this.pasteNode,className:"boolean-menu-item"},r.createElement(f.FormattedMessage,p.default.paste))):"GROUP"===this.props.node.objectOrGroupNode.type&&(h.push(r.createElement("div",{onClick:this.copyNode,className:"boolean-menu-item"},r.createElement(f.FormattedMessage,p.default.copy))),h.push(r.createElement("div",{onClick:this.cutNode,className:"boolean-menu-item"},r.createElement(f.FormattedMessage,p.default.cut)))),h.push(r.createElement("div",{onClick:this.removeGroup,className:"boolean-menu-item"},r.createElement(f.FormattedMessage,p.default.remove))),a&&a(r.createElement("div",{id:this.id,ref:function(t){return e.setPosition(t)},style:{opacity:g}},r.createElement("span",{className:"boolean-node",style:Object.assign(Object.assign({},n.getSize()),{backgroundColor:m,color:this.state.hover?"#ffffff":n.getColor(),borderColor:n.getColor()}),onMouseEnter:l("enter"),onMouseLeave:l("leave"),onClick:c},n.objectOrGroupNode.boolean_operator,r.createElement(d.default,{node:n})),this.state.focus&&r.createElement(s.default,null,r.createElement("div",{className:"query-builder"},r.createElement("div",{onClick:c,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"black",zIndex:1e3,opacity:.6}}),r.createElement("span",{className:"boolean-node",style:Object.assign(Object.assign({},n.getSize()),{backgroundColor:n.getColor(),color:"#ffffff",borderColor:n.getColor(),top:this.top-n.getSize().height*((1-u)/2),left:this.left-n.getSize().width*((1-u)/2),position:"absolute",zIndex:1002,transform:"scale("+u+")"})},n.objectOrGroupNode.boolean_operator),r.createElement(i.CSSTransition,{timeout:500,classNames:"fade",in:this.state.focus},r.createElement("div",{className:"boolean-menu",style:{top:this.top,left:this.left+n.getSize().width*u,zIndex:1001}},Object.keys(y).filter((function(t){return y[t].booleanOperator!==e.props.node.objectOrGroupNode.boolean_operator||y[t].negation!==(e.props.node.objectOrGroupNode.negation||!1)})).map((function(t){return r.createElement("div",{onClick:e.changeBooleanOperator(y[t]),className:"boolean-menu-item",key:t},r.createElement(f.FormattedMessage,p.default[t]))})),h))))))}}]),t}(r.Component);t.default=(0,c.compose)((0,l.DropTarget)((function(){return"none"}),{canDrop:function(){return!1}},(function(e,t){return{connectDropTarget:e.dropTarget(),isDragging:!!t.getItemType()}})),u.default)(g)},,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(89),i=n(274),s=(a=i)&&a.__esModule?a:{default:a};var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"boolean-operator-node"));if(a.collapsed=!1,a.negation=!1,a.treeNodePath=[],a.getColor=function(){return a.extras.negation?"#ff5959":"GROUP"===a.objectOrGroupNode.type?"#00a1df":"#00ad68"},void 0===e||void 0===n)throw new Error("Missing parameters");return a.addPort(new s.default("right")),a.addPort(new s.default("left")),a.addPort(new s.default("bottom")),a.addPort(new s.default("top")),a.objectOrGroupNode=e,a.treeNodePath=n,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"getSize",value:function(){return{width:51,height:51,borderWidth:2}}}]),t}(o.NodeModel);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FieldNodeWidget=t.FieldNodeModel=t.FieldNodeFactory=void 0;var a=i(n(2157)),r=i(n(1068)),o=i(n(1054));function i(e){return e&&e.__esModule?e:{default:e}}t.FieldNodeFactory=a.default,t.FieldNodeModel=r.default,t.FieldNodeWidget=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=v(n(47)),i=v(n(2158)),s=n(51),l=n(11),c=v(n(2165)),u=n(342),d=n(8),f=n(35),p=n(25),m=n(226),g=v(n(625)),y=n(6),h=v(n(626));function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.top=0,n.left=0,n.right=0,n.bottom=0,n.id=(0,o.default)(),n.wrapperId=(0,o.default)(),n.wrapperRef=null,n.selectRef=null,n.isDragging=!1,n.formName=u.FORM_ID+"-"+(0,o.default)(),n.setWrapperRef=function(e){n.wrapperRef=e},n.setSelectRef=function(e){n.selectRef=e},n.handleClickOutside=function(e){var t=n.props,a=t.formValues,r=t.treeNodeOperations,o=t.node,i=t.lockGlobalInteraction;!n.isDragging&&n.wrapperRef&&!n.wrapperRef.contains(e.target)&&n.selectRef&&!n.selectRef.contains(e.target)&&n.state.edit?(n.editNode(!1),r.updateNode(o.treeNodePath,a.fieldNodeForm),i(!1)):n.isDragging=!1},n.setFlag=function(e){return function(){n.isDragging=!!e}},n.setPosition=function(e){var t=document.body.getBoundingClientRect(),a=e?e.getBoundingClientRect():null;n.top=a?a.top+t.top:0,n.left=a?a.left+t.left:0,n.right=a?t.right-a.right:0,n.bottom=a?t.bottom-a.bottom:0},n.copyNode=function(){n.setState({focus:!1},(function(){n.props.treeNodeOperations.copyNode(n.props.node.treeNodePath,n.props.node.objectTypeInfo.name,n.props.node.treeNodePath),n.props.treeNodeOperations.updateLayout()}))},n.cutNode=function(){n.setState({focus:!1},(function(){n.props.treeNodeOperations.cutNode(n.props.node.treeNodePath,n.props.node.objectTypeInfo.name,n.props.node.treeNodePath),n.props.treeNodeOperations.updateLayout()}))},n.removeNode=function(){n.setState({focus:!1},(function(){n.props.treeNodeOperations.deleteNode(n.props.node.treeNodePath),n.props.treeNodeOperations.updateLayout()}))},n.editNode=function(e){n.props.keyboardOnlyLock(e),n.setState({edit:e},(function(){n.props.node.extras.edition=e,n.props.lockGlobalInteraction(!1),n.props.treeNodeOperations.updateLayout()}))},n.renderEditNode=function(){var e=n.props,t=e.node,a=e.treeNodeOperations,o=e.datamartId,i=e.runFieldProposal;return r.createElement(r.Fragment,null,r.createElement("div",{id:n.id,style:{backgroundColor:"#ffffff",borderStyle:"solid",color:t.getColor(),borderColor:t.getColor(),zIndex:999999,padding:10,borderRadius:4,width:300},className:"mcs-form-container no-padding",onMouseOver:function(){return n.props.lockGlobalInteraction(!0)},onMouseLeave:function(){return n.props.lockGlobalInteraction(!1)}},r.createElement(g.default,{node:t}),r.createElement("div",{style:{width:0,height:0,borderLeft:"10px solid transparent",borderRight:"10px solid transparent",borderBottom:"10px solid "+t.getColor(),transform:"rotate(-90deg)",position:"absolute",left:-13,top:t.getSize().height/2-5}}),r.createElement(l.Button,{className:"mcs-fieldNodeFormWrapper_closeButton",onClick:function(){return n.editNode(!1)}},r.createElement(l.McsIcon,{type:"close"})),r.createElement(c.default,{breadCrumbPaths:[],objectType:t.objectTypeInfo,objectTypes:n.props.objectTypes,initialValues:{fieldNodeForm:t.fieldNode},onSubmit:function(e){a.updateNode(t.treeNodePath,e.fieldNodeForm),n.editNode(!1)},idToAttachDropDowns:"popoverId",runtimeSchemaId:t.objectTypeInfo.runtime_schema_id,datamartId:o,form:n.formName,treeNodePath:t.treeNodePath,runFieldProposal:i,isEdge:n.props.isEdge})))},n.renderedStandardNode=function(){var e=n.props,t=e.node,a=e.datamartId,o=function(e){return function(){n.setState({hover:"enter"===e})}},l=function(){n.props.lockGlobalInteraction(!n.state.focus),n.setPosition(document.getElementById(n.id)),n.setState({focus:!n.state.focus})},c=n.props.diagramEngine.getDiagramModel().zoom/100,u=[r.createElement("div",{onClick:function(){return n.editNode(!0)},className:"boolean-menu-item",key:"EDIT"},r.createElement(y.FormattedMessage,h.default.edit))];return n.props.diagramEngine.isCopying()||(u.push(r.createElement("div",{onClick:n.copyNode,className:"boolean-menu-item",key:"COPY"},r.createElement(y.FormattedMessage,h.default.copy))),u.push(r.createElement("div",{onClick:n.cutNode,className:"boolean-menu-item",key:"CUT"},r.createElement(y.FormattedMessage,h.default.cut)))),u.push(r.createElement("div",{onClick:n.removeNode,className:"boolean-menu-item",key:"REMOVE"},r.createElement(y.FormattedMessage,h.default.remove))),r.createElement("div",{id:n.id,className:"field-node",onClick:l,style:Object.assign(Object.assign({},t.getSize()),{backgroundColor:"#ffffff",borderStyle:"solid",color:t.getColor(),borderColor:t.getColor()}),onMouseEnter:o("enter"),onMouseLeave:o("leave")},r.createElement("div",{className:"field"},r.createElement(i.default,{node:t,datamartId:a})),r.createElement(g.default,{node:t}),n.state.focus&&r.createElement(s.WindowBodyPortal,null,r.createElement("div",{className:"query-builder full-screen"},r.createElement("div",{onClick:l,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"black",zIndex:1e3,opacity:.6}}),r.createElement("span",{className:"object-node no-hover",style:Object.assign(Object.assign({},t.getSize()),{backgroundColor:"#ffffff",borderStyle:"solid",color:t.getColor(),borderColor:t.getColor(),top:n.top-t.getSize().height*((1-c)/2),left:n.left-t.getSize().width*((1-c)/2),position:"absolute",zIndex:1002,transform:"scale("+c+")"}),onClick:l},r.createElement("div",{className:"field"},r.createElement(i.default,{node:t,datamartId:a}))),r.createElement("div",{className:"boolean-menu",style:{top:n.top,left:n.left+t.getSize().width*c,zIndex:1001}},u))))},n.state={focus:!1,hover:!1,edit:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){window.addEventListener("mousedown",this.setFlag()),window.addEventListener("mousemove",this.setFlag(!0)),window.addEventListener("mouseup",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("mouseup",this.handleClickOutside),window.removeEventListener("mousedown",this.setFlag()),window.removeEventListener("mousemove",this.setFlag(!0))}},{key:"render",value:function(){var e=this.props,t=e.connectDropTarget,n=e.isDragging?.3:1,a=r.createElement("div",{ref:this.setWrapperRef,style:{opacity:n}},this.state.edit?this.renderEditNode():this.renderedStandardNode());return t&&t(a)}}]),t}(r.Component);t.default=(0,d.compose)((0,m.DropTarget)((function(){return"none"}),{canDrop:function(){return!1}},(function(e,t){return{connectDropTarget:e.dropTarget(),isDragging:!!t.getItemType()}})),(0,p.connect)((function(e){return{formValues:(0,f.getFormValues)(u.FORM_ID)(e)}})))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleLinkWidget=t.SimpleLinkModel=t.SimpleLinkFactory=void 0;var a=i(n(2161)),r=i(n(819)),o=i(n(1056));function i(e){return e&&e.__esModule?e:{default:e}}t.SimpleLinkFactory=a.default,t.SimpleLinkModel=r.default,t.SimpleLinkWidget=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(226);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=function(e){function t(){return l(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"generateLink",value:function(e,t){var n=o.createElement("path",a({strokeWidth:"2",stroke:"url(#"+this.props.link.getID()+")"},e));return o.createElement("g",{key:"link-"+t},n)}},{key:"render",value:function(){var e,t,n=this.props,a=n.link,r=n.isDragging,i=n.connectDropTarget,s=a.points,l=[],c=a.getSourcePort().getParent(),u=a.getTargetPort().getParent(),d=!u.extras.collapsed;if(2===s.length&&d){var f=s[0],p=s[1];f.x>p.x&&(f=s[1],p=s[0]),l.push(o.createElement("defs",{key:this.props.link.getID()},o.createElement("linearGradient",{id:this.props.link.getID(),x1:f.x,y1:f.y,x2:p.x,y2:p.y,gradientUnits:"userSpaceOnUse"},o.createElement("stop",{stopColor:c.getColor(),offset:"0"}),o.createElement("stop",{stopColor:u.getColor(),offset:"1"})))),l.push(this.generateLink({d:(e=f,t=p,"M"+e.x+" "+e.y+" L"+t.x+" "+t.y)},"0"))}var m=r?.3:1;return i&&i(o.createElement("g",{style:{opacity:m}},l))}}]),t}(o.Component);t.default=(0,i.compose)((0,s.DropTarget)((function(){return"none"}),{canDrop:function(){return!1}},(function(e,t){return{connectDropTarget:e.dropTarget(),isDragging:!!t.getItemType()}})))(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlusNodeWidget=t.PlusNodeModel=t.PlusNodeFactory=void 0;var a=i(n(2162)),r=i(n(1064)),o=i(n(1058));function i(e){return e&&e.__esModule?e:{default:e}}t.PlusNodeFactory=a.default,t.PlusNodeModel=r.default,t.PlusNodeWidget=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(61),s=n(127),l=n(51),c=h(n(1059)),u=n(342),d=n(226),f=h(n(69)),p=h(n(625)),m=h(n(626)),g=n(6),y=n(11);function h(e){return e&&e.__esModule?e:{default:e}}var v={drop:function(e,t){var n=t.getItem().path.split(".").map((function(e){return parseInt(e,10)})),a=(0,s.computeSchemaPathFromQueryPath)(e.query,e.node.treeNodePath,e.schema),r=(0,s.computeAdditionalNode)(n,a.length,e.schema);if(r)return e.treeNodeOperations.addNode(e.node.treeNodePath,r)},canDrop:function(e,t){if(e.node.root&&!e.query)return!0;if(e.node.root&&e.query)return!1;var n=(0,s.computeSchemaPathFromQueryPath)(e.query,e.node.treeNodePath,e.schema).join("."),a=t.getItem().path.startsWith(n);return a}},b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.top=0,n.left=0,n.addObjectNode=function(){var e=n.props,t=e.node,a=e.lockGlobalInteraction;n.setState({focus:!1},(function(){a(!1),n.props.openNextDrawer(c.default,{additionalProps:{close:n.props.closeNextDrawer,breadCrumbPaths:[{name:t.objectTypeInfo.name}],objectTypes:n.props.objectTypes,objectType:t.objectTypeInfo,onSubmit:function(e){n.props.treeNodeOperations.addNode(t.treeNodePath,(0,u.generateObjectNodeFromFormData)(e)),n.props.closeNextDrawer()},initialValues:u.QUERY_DOCUMENT_INITIAL_VALUE,isTrigger:n.props.isTrigger,isEdge:n.props.isEdge,datamartId:n.props.datamartId,runtimeSchemaId:n.props.runtimeSchemaId},size:"small"})}))},n.addGroup=function(){var e=n.props,t=e.treeNodeOperations,a=e.node,r=e.lockGlobalInteraction;a.root?(t.addNewGroupAsRoot(),r(!1)):(t.addNode(a.treeNodePath,{type:"GROUP",boolean_operator:"OR",expressions:[]}),r(!1))},n.pasteNode=function(){var e=n.props,t=e.node,a=e.treeNodeOperations,r=e.lockGlobalInteraction,o=n.canPasteHere();if(o){if(t.objectOrGroupNode&&"GROUP"===t.objectOrGroupNode.type){var i=Object.assign({},t.objectOrGroupNode);i.expressions.push(o),a.updateNode(t.treeNodePath,i),n.props.diagramEngine.emptyClipboard()}r(!1)}},n.canPasteHere=function(){if(!n.props.node.root&&n.props.diagramEngine.isCopying()){var e=n.props.diagramEngine.getCopiedValue();if(e&&e.copiedObjectType&&e.objectType&&"UserPoint"===e.objectType&&e.treeNodePath&&e.treeNodePath.length===n.props.node.treeNodePath.length&&e.treeNodePath!==n.props.node.treeNodePath)return e.copiedObjectType}},n.setPosition=function(e){var t=e?e.getBoundingClientRect():null;n.top=t?t.top:0,n.left=t?t.left:0},n.state={focus:!1,hover:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.node,a=t.isDragging,o=t.connectDropTarget,i=t.canDrop,s=t.isOver,c=t.colors,u=function(){e.props.lockGlobalInteraction(!e.state.focus),e.setState({focus:!e.state.focus})},d=function(t){return function(){e.setState({hover:"enter"===t})}},f=this.props.diagramEngine.getDiagramModel().zoom/100,h=a&&!i?.3:1,v="#ffffff",b=n.getColor(),_=n.getColor();this.state.hover&&(v=n.getColor(),b="#ffffff"),i&&!s&&(v=c["mcs-info"],b="#ffffff",_=c["mcs-info"]),s&&i&&(v="#ffffff",b=n.getColor(),_=n.getColor());var S=this.canPasteHere();return o&&o(r.createElement("div",{className:"plus-node noFocus",style:{opacity:h},ref:function(t){return e.setPosition(t)}},r.createElement("div",{style:{width:n.getSize().width,height:n.getSize().height,borderWidth:n.getSize().borderWidth,borderColor:_,float:"left",color:b,backgroundColor:v},onClick:u,onMouseEnter:d("enter"),onMouseLeave:d("leave"),className:"plus-button "+(this.state.focus?"plus-clicked":"")},r.createElement(y.McsIcon,{type:"plus"})),r.createElement(p.default,{node:n}),this.state.focus&&r.createElement(l.WindowBodyPortal,null,r.createElement("div",{className:"query-builder"},r.createElement("div",{onClick:u,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"black",zIndex:1e3,opacity:.6}}),r.createElement("span",{className:"plus-button "+(this.state.focus?"plus-clicked":""),style:Object.assign(Object.assign({},n.getSize()),{backgroundColor:n.getColor(),color:"#ffffff",borderColor:n.getColor(),top:this.top-n.getSize().height*((1-f)/2),left:this.left-n.getSize().width*((1-f)/2),position:"absolute",zIndex:1002,transform:"scale("+f+")"}),onClick:u},r.createElement(y.McsIcon,{type:"plus"})),r.createElement("div",{className:"boolean-menu",style:{top:this.top,left:this.left+n.getSize().width,zIndex:1001}},(!n.root||1===Object.keys(this.props.diagramEngine.diagramModel.nodes).length)&&r.createElement("div",{onClick:this.addObjectNode,className:"boolean-menu-item"},r.createElement(g.FormattedMessage,m.default.object)),(n.root||n.objectOrGroupNode&&"GROUP"===n.objectOrGroupNode.type)&&r.createElement("div",{onClick:this.addGroup,className:"boolean-menu-item"},r.createElement(g.FormattedMessage,m.default.group)),S&&r.createElement("div",{onClick:this.pasteNode,className:"boolean-menu-item"},r.createElement(g.FormattedMessage,m.default.paste)))))))}}]),t}(r.Component);t.default=(0,o.compose)((0,d.DropTarget)((function(){return["object","field"]}),v,(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop(),isDragging:!!t.getItemType()}})),i.injectDrawer,f.default)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=b(n(54)),i=n(25),s=n(35),l=n(342),c=n(10),u=n(77),d=b(n(60)),f=n(8),p=n(6),m=n(13),g=b(n(418)),y=b(n(2163)),h=b(n(1060)),v=n(127);function b(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var E=c.Layout.Content,O=s.FieldArray,w=function(e){function t(){_(this,t);var e=S(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.getQueryableObjectTypes=function(t,n){var a=e.props,r=a.objectType,o=a.objectTypes;if(t&&"UserPoint"===r.name){var i=o.filter((function(t){return e.filterAvailableFields(t)}));return r.fields.filter((function(e){return!!i.find((function(t){var n=e.field_type.match(/\w+/);return!(!n||n[0]!==t.name)}))}))}return r.fields.filter((function(e){var t=o.find((function(t){var n=e.field_type.match(/\w+/);return!(!n||n[0]!==t.name)})),a=!!t&&!!t.fields.find((function(e){return!(!e.directives.find((function(e){return"TreeIndex"===e.name}))||n&&!e.directives.find((function(e){return"EdgeAvailability"===e.name})))}));return!!t&&a}))},e.getSelectedObjectType=function(){var t=e.props,n=t.objectType,a=t.objectTypes,r=t.formValues,o=n.fields.find((function(e){return e.name===r.objectNodeForm.field})).field_type;return a.find((function(e){var t=o.match(/\w+/);return!(!t||t[0]!==e.name)}))},e.getQueryableFields=function(){var t=e.props,n=t.objectTypes,a=t.isEdge;return e.getSelectedObjectType().fields.filter((function(e){return!n.find((function(t){var n=e.field_type.match(/\w+/);return!(!n||n[0]!==t.name)}))&&e.directives.find((function(e){return"TreeIndex"===e.name}))&&(!a||e.directives.find((function(e){return"EdgeAvailability"===e.name})))}))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"filterAvailableFields",value:function(e){return o.default.flatMap(e.directives,(function(e){return e.arguments.map((function(e){return Object.values(v.typesTrigger).includes(e.value.replace(/[^a-zA-Z]+/g,""))}))})).reduce((function(e,t){return e||t}),!1)}},{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.breadCrumbPaths,a=e.close,o=e.change,i=e.formValues,s=e.isTrigger,f=e.isEdge,p=e.objectType,m=e.datamartId,v=e.runtimeSchemaId,b={formId:l.FORM_ID,paths:n,message:g.default.save,onClose:a},_=i&&i.objectNodeForm.field,S=_,w=[];w.push({id:"objectNode",title:g.default.objectNodeTitle,component:r.createElement(y.default,{objectTypeFields:this.getQueryableObjectTypes(s,f),objectType:p,selectedObjectType:_?this.getSelectedObjectType():void 0,onSelect:function(){o("frequency",{enabled:!1,mode:"AT_LEAST"}),o("fieldNodeForm",[])},isTrigger:s})});S&&w.push({id:"fieldConditions",title:g.default.objectNodeTitle,component:r.createElement(O,{name:"fieldNodeForm",component:h.default,availableFields:this.getQueryableFields(),formChange:o,rerenderOnEveryChange:!0,booleanOperator:i.objectNodeForm.boolean_operator,onBooleanOperatorChange:function(e){return o("objectNodeForm.boolean_operator",e)},objectType:this.getSelectedObjectType(),datamartId:m,runtimeSchemaId:v,title:g.default.fieldConditionTitle,subtitle:g.default.fieldConditionSubTitle,isEdge:f})});var M=w.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==w.length-1&&r.createElement("hr",null))}));return r.createElement(c.Layout,{className:"edit-layout"},r.createElement(d.default,b),r.createElement(c.Layout,{className:"ant-layout-has-sider"},r.createElement(u.Form,{className:"edit-layout ant-layout",onSubmit:t,layout:"vertical"},r.createElement(E,{id:l.FORM_ID,className:"mcs-content-container mcs-form-container"},M))))}}]),t}(r.Component);t.default=(0,f.compose)(p.injectIntl,m.withRouter,(0,i.connect)((function(e){return{formValues:(0,s.getFormValues)(l.FORM_ID)(e)}})),(0,s.reduxForm)({form:l.FORM_ID,enableReinitialize:!0}))(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(10),s=f(n(47)),l=f(n(418)),c=n(24),u=f(n(311)),d=n(11);function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=function(e){function t(){return p(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fields,n=e.intl,a=e.availableFields,o=e.formChange,f=e.onBooleanOperatorChange,p=e.booleanOperator,m=e.objectType,g=e.datamartId,y=e.runtimeSchemaId,h=e.formName,v=e.title,b=e.subtitle,_=e.disabled,S=e.isEdge,E=t.map((function(e,n,i){return r.createElement("div",{className:"form-input-group",key:i.get(n).key},!_&&r.createElement("div",{className:"action-buttons",onClick:function(){return t.remove(n)}},r.createElement(d.McsIcon,{type:"close"})),r.createElement("div",null,r.createElement(u.default,{formChange:o,name:e,expressionIndex:n,availableFields:a,objectType:m,datamartId:g,runtimeSchemaId:y,formName:h,disabled:_,isEdge:S})))})),O=function(){return f("OR"===p?"AND":"OR")};return E=E.reduce((function(e,t,n){return n===E.length-1?e.concat(t):e.concat(t,(a="operator"+n,r.createElement("div",{key:a,className:"form-input-group-separator"},r.createElement("div",{className:"wrapper"},r.createElement("div",{className:"item"},r.createElement("input",{id:a,className:"tgl tgl-operator",type:"checkbox",checked:"OR"===p,onChange:O}),r.createElement("label",{className:"tgl-btn","data-tg-off":"AND","data-tg-on":"OR",htmlFor:a}))))));var a}),[]),r.createElement("div",null,r.createElement(c.FormSection,{title:v,subtitle:b}),r.createElement("div",{className:"form-field-wrapper"},E),!_&&r.createElement(i.Row,null,r.createElement(i.Col,{span:24},r.createElement("div",{onClick:function(){return t.push({type:"FIELD",field:"",key:(0,s.default)()})}},r.createElement(i.Col,{span:24,className:"add-field-button"},r.createElement("p",null,r.createElement(d.McsIcon,{type:"plus"}),n.formatMessage(l.default.fieldConditionAdditionButton)))))))}}]),t}(r.Component);t.default=(0,o.injectIntl)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(84),l=(a=s)&&a.__esModule?a:{default:a},c=n(6);var u=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},d=i.Select.Option;t.default=(0,c.injectIntl)((function(e){var t=e.formItemProps,n=e.helpToolTipProps,a=e.input,s=e.meta,c=e.selectProps,f=e.small,p="success";s.touched&&s.invalid&&(p="error"),s.touched&&s.warning&&(p="warning");var m=c?c.options.map((function(e){var t=e.label,n=u(e,["label"]);return o.createElement(d,r({},n,{key:n.value,value:n.value}),t)})):[];return o.createElement(l.default,r({help:s.touched&&(s.warning||s.error),helpToolTipProps:n,validateStatus:p,small:f},t),o.createElement(i.Select,r({mode:"tags",onChange:a.onChange,onFocus:a.onFocus,value:a.value||[]},c),m))}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=u(n(17)),l=u(n(84)),c=n(6);function u(e){return e&&e.__esModule?e:{default:e}}var d=i.Radio.Button,f=i.Radio.Group,p=i.Input.Group,m=(0,c.defineMessages)({absolute:{id:"queryTool.datepicker.label.absolute",defaultMessage:"Absolute"},relative:{id:"queryTool.datepicker.label.relative",defaultMessage:"Relative"},days:{id:"queryTool.datepicker.label.days",defaultMessage:"Days"},month:{id:"queryTool.datepicker.label.month",defaultMessage:"Month"},year:{id:"queryTool.datepicker.label.year",defaultMessage:"Year"},ago:{id:"queryTool.datepicker.label.ago",defaultMessage:"Ago"}}),g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getValueType=function(e){return n.props.noListValue&&e?e.toString().includes("now")?"RELATIVE":"ABSOLUTE":e&&e.length&&e[0]&&"string"==typeof e[0]&&e[0].indexOf("now")>-1?"RELATIVE":"ABSOLUTE"},n.getNumericRelativeValue=function(e){if(e&&"string"==typeof e){if("now"===e)return 0;if(e.indexOf("now-")>-1){var t=parseInt(e.replace(/now\-/g,"").replace(/\//g,"").replace(/M/g,"").replace(/d/g,"").replace(/y/g,""),0);return isNaN(t)?0:t}return 0}return 0},n.onValueChange=function(e){if(!isNaN(e))return n.generateRelativeValue(e)},n.generateRelativeValue=function(e){var t=n.props.noListValue;return n.props.input.onChange(t?"now-"+e+n.state.relativePeriod+"/"+n.state.relativePeriod:["now-"+e+n.state.relativePeriod+"/"+n.state.relativePeriod])},n.getAdjustedAbsoluteTimestamp=function(e){var t=n.props.dateComparisonOperator,a=e||(0,s.default)();if(!t)return a.startOf("day");switch(t){case"BEFORE":case"AFTER_OR_EQUAL":return a.startOf("day");case"BEFORE_OR_EQUAL":case"AFTER":return a.endOf("day");default:return a.startOf("day")}},n.state={datePickerType:n.getValueType(e.input.value),relativePeriod:"d"},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.input,n=e.noListValue;t.value&&0!==t.value.length||("RELATIVE"===this.state.datePickerType?t.onChange(n?"now-1d":["now-1d"]):this.props.unixTimstamp?t.onChange(n?this.getAdjustedAbsoluteTimestamp().valueOf():[this.getAdjustedAbsoluteTimestamp().valueOf()]):t.onChange(n?this.getAdjustedAbsoluteTimestamp().toISOString():[this.getAdjustedAbsoluteTimestamp().toISOString()]))}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.dateComparisonOperator,a=t.noListValue;if(n!==e.dateComparisonOperator&&"ABSOLUTE"===this.state.datePickerType){var r=this.props.input.value.length?this.getAdjustedAbsoluteTimestamp((0,s.default)(this.props.input.value[0])):this.getAdjustedAbsoluteTimestamp(),o=this.props.unixTimstamp?this.getAdjustedAbsoluteTimestamp(r).valueOf():this.getAdjustedAbsoluteTimestamp(r);this.props.input.onChange(a?o:[o])}}},{key:"render",value:function(){var e=this,t=this.props,n=t.disabled,r=t.noListValue,u="success";this.props.meta.touched&&this.props.meta.invalid&&(u="error"),this.props.meta.touched&&this.props.meta.warning&&(u="warning");var g=void 0;g="ABSOLUTE"===this.state.datePickerType?this.props.input.value?this.getAdjustedAbsoluteTimestamp((0,s.default)(r?parseInt(this.props.input.value,10):this.props.input.value[0])):this.getAdjustedAbsoluteTimestamp():this.getNumericRelativeValue(r?this.props.input.value:this.props.input.value[0]);return o.createElement(l.default,a({help:this.props.meta.touched&&(this.props.meta.warning||this.props.meta.error),helpToolTipProps:this.props.helpToolTipProps,validateStatus:u,small:this.props.small},this.props.formItemProps),o.createElement("div",{style:{marginBottom:20}},o.createElement(f,{style:{width:"100%"},defaultValue:this.state.datePickerType,onChange:function(t){e.setState({datePickerType:t.target.value});var n="ABSOLUTE"===t.target.value?e.props.unixTimstamp?e.getAdjustedAbsoluteTimestamp().valueOf():e.getAdjustedAbsoluteTimestamp().toISOString():"now";e.props.input.onChange(r?n:[n])},disabled:n},o.createElement(d,{style:{width:"50%"},value:"ABSOLUTE"},o.createElement(c.FormattedMessage,m.absolute)),o.createElement(d,{style:{width:"50%"},value:"RELATIVE"},o.createElement(c.FormattedMessage,m.relative)))),o.createElement("div",null,"ABSOLUTE"===this.state.datePickerType?o.createElement(i.DatePicker,a({allowClear:!1,value:(0,s.default)(g),onChange:function(t,n){var a=e.props.unixTimstamp?e.getAdjustedAbsoluteTimestamp(t).valueOf():e.getAdjustedAbsoluteTimestamp(t);return e.props.input.onChange(r?a:[a])},style:{width:"100%"},defaultValue:this.getAdjustedAbsoluteTimestamp()},this.props.datePickerProps,{disabled:n})):o.createElement("div",null,o.createElement(p,{compact:!0},o.createElement(i.Col,{span:15},o.createElement(i.InputNumber,{style:{width:"100%"},defaultValue:1,value:g,onChange:this.onValueChange,disabled:n})),o.createElement(i.Col,{span:7},o.createElement(i.Select,{defaultValue:this.state.relativePeriod,onChange:function(t){e.setState({relativePeriod:t},(function(){return e.generateRelativeValue(e.getNumericRelativeValue(r?e.props.input.value:e.props.input.value[0]))}))},getPopupContainer:this.props.datePickerProps&&this.props.datePickerProps.getPopupContainer,disabled:n},o.createElement(i.Select.Option,{value:"d"},o.createElement(c.FormattedMessage,m.days)),o.createElement(i.Select.Option,{value:"M"},o.createElement(c.FormattedMessage,m.month)),o.createElement(i.Select.Option,{value:"y"},o.createElement(c.FormattedMessage,m.year)))),o.createElement(i.Col,{span:2,style:{height:40,lineHeight:"40px"}},o.createElement(c.FormattedMessage,m.ago))))))}}]),t}(o.Component);t.default=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.builtinEnumTypeOptions=void 0;var a,r=n(418),o=(a=r)&&a.__esModule?a:{default:a};var i={generateNumericComparisonOperator:function(e){return{values:[{value:"EQUAL",title:e.formatMessage(o.default.EQUAL)},{value:"NOT_EQUAL",title:e.formatMessage(o.default.NOT_EQUAL)},{value:"LT",title:e.formatMessage(o.default.LT)},{value:"LTE",title:e.formatMessage(o.default.LTE)},{value:"GT",title:e.formatMessage(o.default.GT)},{value:"GTE",title:e.formatMessage(o.default.GTE)}],defaultValue:{type:"NUMERIC",operator:"EQUAL",values:[]}}},generateBooleanComparisonOperator:function(e){return{values:[{value:"EQUAL",title:e.formatMessage(o.default.EQUAL)},{value:"NOT_EQUAL",title:e.formatMessage(o.default.NOT_EQUAL)}],defaultValue:{type:"BOOLEAN",operator:"EQUAL",values:[]}}},generateEnumComparisonOperator:function(e){return{values:[{value:"EQUAL",title:e.formatMessage(o.default.EQUAL)},{value:"NOT_EQUAL",title:e.formatMessage(o.default.NOT_EQUAL)}],defaultValue:{type:"ENUM",operator:"EQUAL",values:[]}}},generateTimeComparisonOperator:function(e){return{values:[{value:"BEFORE",title:e.formatMessage(o.default.BEFORE)},{value:"BEFORE_OR_EQUAL",title:e.formatMessage(o.default.BEFORE_OR_EQUAL)},{value:"AFTER",title:e.formatMessage(o.default.AFTER)},{value:"AFTER_OR_EQUAL",title:e.formatMessage(o.default.AFTER_OR_EQUAL)}],defaultValue:{type:"TIME",operator:"BEFORE",values:[]}}},generateStringComparisonOperator:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"keyword",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch(t){case"text":return{values:[{value:"MATCHES",title:e.formatMessage(o.default.MATCHES)}],defaultValue:{type:"STRING",operator:"MATCHES",values:[]}};default:return n?{values:[{value:"EQ",title:e.formatMessage(o.default.EQ)},{value:"NOT_EQ",title:e.formatMessage(o.default.NOT_EQ)},{value:"MATCHES",title:e.formatMessage(o.default.MATCHES)},{value:"DOES_NOT_MATCH",title:e.formatMessage(o.default.DOES_NOT_MATCH)},{value:"STARTS_WITH",title:e.formatMessage(o.default.STARTS_WITH)},{value:"DOES_NOT_START_WITH",title:e.formatMessage(o.default.DOES_NOT_START_WITH)},{value:"CONTAINS",title:e.formatMessage(o.default.CONTAINS)},{value:"DOES_NOT_CONTAIN",title:e.formatMessage(o.default.DOES_NOT_CONTAIN)}],defaultValue:{type:"STRING",operator:"EQ",values:[]}}:{values:[{value:"EQ",title:e.formatMessage(o.default.EQ)},{value:"NOT_EQ",title:e.formatMessage(o.default.NOT_EQ)},{value:"STARTS_WITH",title:e.formatMessage(o.default.STARTS_WITH)}],defaultValue:{type:"STRING",operator:"EQ",values:[]}}}}};t.builtinEnumTypeOptions={ActivitySource:["PIXEL_TRACKING","API","INTERNAL","SESSION_AGGREGATOR","ACTIVITY_STORE"],UserActivityType:["ALL","USER_PLATFORM","TOUCH","SITE_VISIT","APP_VISIT","EMAIL","DISPLAY_AD","STOPWATCH","STAGING_AREA","RECOMMENDER","USER_SCENARIO_START","USER_SCENARIO_STOP","USER_SCENARIO_NODE_ENTER","USER_SCENARIO_NODE_EXIT"],OperatingSystemFamily:["OTHER","WINDOWS","MAC_OS","LINUX","ANDROID","IOS"],HashFunction:["MD2","MD5","SHA_1","SHA_256","SHA_384","SHA_512","NO_HASH"],FormFactor:["OTHER","PERSONAL_COMPUTER","SMART_TV","GAME_CONSOLE","SMARTPHONE","TABLET","WEARABLE_COMPUTER"],BrowserFamily:["OTHER","CHROME","IE","FIREFOX","SAFARI","OPERA","STOCK_ANDROID","BOT","EMAIL_CLIENT","MICROSOFT_EDGE"],UserAgentType:["WEB_BROWSER","MOBILE_APP"]};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(89),i=n(274),s=(a=i)&&a.__esModule?a:{default:a};var l=function(e){function t(e,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"plus-node"));return r.collapsed=!1,r.negation=!1,r.treeNodePath=[],r.addPort(new s.default("right")),r.addPort(new s.default("left")),r.addPort(new s.default("bottom")),r.addPort(new s.default("top")),void 0!==e&&void 0!==n&&(r.objectOrGroupNode=e,r.treeNodePath=n),r.objectTypeInfo=a,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"getSize",value:function(){return{width:50,height:50,borderWidth:2}}},{key:"getColor",value:function(){return"#cecece"}}]),t}(o.NodeModel);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectNodeWidget=t.ObjectNodeModel=t.ObjectNodeFactory=void 0;var a=i(n(2164)),r=i(n(1067)),o=i(n(1066));function i(e){return e&&e.__esModule?e:{default:e}}t.ObjectNodeFactory=a.default,t.ObjectNodeModel=r.default,t.ObjectNodeWidget=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=v(n(47)),i=n(8),s=n(51),l=n(127),c=n(61),u=v(n(1059)),d=n(342),f=n(6),p=n(820),m=n(226),g=v(n(69)),y=v(n(625)),h=v(n(626));function v(e){return e&&e.__esModule?e:{default:e}}var b={drop:function(e,t){var n=t.getItem().path.split(".").map((function(e){return parseInt(e,10)})),a=(0,l.computeSchemaPathFromQueryPath)(e.query,e.node.treeNodePath,e.schema),r=(0,l.computeAdditionalNode)(n,a.length,e.schema);r&&e.treeNodeOperations.addNode(e.node.treeNodePath,r)},canDrop:function(e,t){var n=(0,l.computeSchemaPathFromQueryPath)(e.query,e.node.treeNodePath,e.schema).join("."),a=t.getItem().path.startsWith(n);return a}},_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.top=0,n.left=0,n.id=(0,o.default)(),n.setPosition=function(e){var t=document.body.getBoundingClientRect(),a=e?e.getBoundingClientRect():null;n.top=a?a.top+t.top:0,n.left=a?a.left+t.left:0},n.toggleCollapsed=function(){n.setState({focus:!1},(function(){n.props.treeNodeOperations.updateLayout()}))},n.copyNode=function(){n.setState({focus:!1},(function(){n.props.treeNodeOperations.copyNode(n.props.node.treeNodePath,n.props.node.objectTypeInfo.name,n.props.node.treeNodePath),n.props.treeNodeOperations.updateLayout()}))},n.cutNode=function(){n.setState({focus:!1},(function(){n.props.treeNodeOperations.cutNode(n.props.node.treeNodePath,n.props.node.objectTypeInfo.name,n.props.node.treeNodePath),n.props.treeNodeOperations.updateLayout()}))},n.pasteNode=function(){n.setState({focus:!1},(function(){var e=n.canPasteHere();if(e){var t=Object.assign({},n.props.node.objectNode);t.expressions.push(e),n.props.treeNodeOperations.updateNode(n.props.node.treeNodePath,t)}n.props.diagramEngine.emptyClipboard(),n.props.treeNodeOperations.updateLayout()}))},n.removeNode=function(){n.setState({focus:!1},(function(){n.props.treeNodeOperations.deleteNode(n.props.node.treeNodePath),n.props.treeNodeOperations.updateLayout()}))},n.editNode=function(){var e=n.props,t=e.node,a=e.lockGlobalInteraction,r=e.datamartId;n.setState({focus:!1},(function(){a(!1),n.props.openNextDrawer(u.default,{additionalProps:{close:n.props.closeNextDrawer,breadCrumbPaths:[{name:t.objectTypeInfo.name}],objectTypes:n.props.objectTypes,objectType:t.objectTypeInfo,onSubmit:function(e){n.props.treeNodeOperations.updateNode(t.treeNodePath,(0,d.generateObjectNodeFromFormData)(e)),n.props.closeNextDrawer()},initialValues:(0,d.generateFormDataFromObjectNode)(t.objectNode),isTrigger:n.props.isTrigger,isEdge:n.props.isEdge,datamartId:r,runtimeSchemaId:t.objectTypeInfo.runtime_schema_id},size:"small"})}))},n.canPasteHere=function(){var e=n.props.diagramEngine.getCopiedValue();if(e&&e.copiedObjectType&&e.objectType){var t=e.copiedObjectType;if("FIELD"===t.type||"OBJECT"===t.type)if(n.props.node.objectTypeInfo.fields.find((function(t){var n=t.field_type.match(/\w+/);return!!n&&n[0]===e.objectType})))return e.copiedObjectType}},n.state={focus:!1,hover:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.node,a=t.intl,o=t.isOver,i=t.isDragging,l=t.canDrop,c=t.connectDropTarget,u=t.colors,m=o&&l,g=function(t){return function(){return e.setState({hover:"enter"===t})}},v=function(){e.props.lockGlobalInteraction(!e.state.focus),e.setPosition(document.getElementById(e.id)),e.setState({focus:!e.state.focus})},b=this.props.diagramEngine.getDiagramModel().zoom/100,_=d.FrequencyConverter.toFrequency(n.objectNode),S=n.objectTypeInfo.fields.find((function(e){return e.name===n.objectNode.field})),E=S&&S.decorator&&!1===S.decorator.hidden?S.decorator.label:n.objectNode.field,O=r.createElement("div",{className:"field"},r.createElement("div",{className:"objectValue"},r.createElement("span",null,E),_.enabled&&r.createElement("div",null,a.formatMessage(p.frequencyModeMessageMap[_.mode])," ",_.value," times"))),w=n.getColor(),M=n.getColor();l&&(w=u["mcs-info"],M=u["mcs-info"]),m&&(w=u["mcs-success"],M=u["mcs-success"]);var P=i&&!l?.3:1,T=[r.createElement("div",{onClick:this.editNode,className:"boolean-menu-item",key:"EDIT"},r.createElement(f.FormattedMessage,h.default.edit))];return this.props.diagramEngine.isCopying()?this.canPasteHere()&&T.push(r.createElement("div",{onClick:this.pasteNode,className:"boolean-menu-item",key:"PASTE"},r.createElement(f.FormattedMessage,h.default.paste))):(T.push(r.createElement("div",{onClick:this.copyNode,className:"boolean-menu-item",key:"COPY"},r.createElement(f.FormattedMessage,h.default.copy))),T.push(r.createElement("div",{onClick:this.cutNode,className:"boolean-menu-item",key:"CUT"},r.createElement(f.FormattedMessage,h.default.cut)))),T.push(r.createElement("div",{onClick:this.removeNode,className:"boolean-menu-item",key:"REMOVE"},r.createElement(f.FormattedMessage,h.default.remove))),c&&c(r.createElement("div",{id:this.id,className:"object-node",onClick:v,onMouseEnter:g("enter"),onMouseLeave:g("leave"),style:Object.assign(Object.assign({},n.getSize()),{borderRadius:4,borderStyle:"solid",fontWeight:"bold",color:"#ffffff",borderColor:M,backgroundColor:w,opacity:P})},O,r.createElement(y.default,{node:n}),this.state.focus&&r.createElement(s.WindowBodyPortal,null,r.createElement("div",{className:"query-builder"},r.createElement("div",{onClick:v,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"black",zIndex:1e3,opacity:.6}}),r.createElement("span",{className:"object-node no-hover",style:Object.assign(Object.assign({},n.getSize()),{borderRadius:4,borderStyle:"solid",fontWeight:"bold",color:"#ffffff",borderColor:n.getColor(),backgroundColor:n.getColor(),top:this.top-n.getSize().height*((1-b)/2),left:this.left-n.getSize().width*((1-b)/2),position:"absolute",zIndex:1002,transform:"scale("+b+")"}),onClick:v},O),r.createElement("div",{className:"boolean-menu",style:{top:this.top,left:this.left+n.getSize().width*b,zIndex:1001}},T)))))}}]),t}(r.Component);t.default=(0,i.compose)((0,m.DropTarget)((function(){return["field","object"]}),b,(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop(),isDragging:t.getItemType()}})),f.injectIntl,c.injectDrawer,g.default)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(89),i=n(274),s=(a=i)&&a.__esModule?a:{default:a};var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"object-node"));if(a.collapsed=!1,a.negation=!1,a.treeNodePath=[],a.getColor=function(){return a.extras.negation?"#ff5959":"#00ad68"},void 0===e||void 0===n)throw new Error("Missing parameters");return a.addPort(new s.default("right")),a.addPort(new s.default("left")),a.addPort(new s.default("bottom")),a.addPort(new s.default("top")),a.objectNode=e,a.negation=!!e.negation,a.treeNodePath=n,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"getSize",value:function(){return{width:200,height:70,borderWidth:2}}}]),t}(o.NodeModel);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(89),i=n(274),s=(a=i)&&a.__esModule?a:{default:a};var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"field-node"));if(a.collapsed=!1,a.negation=!1,a.edition=!1,a.treeNodePath=[],a.getColor=function(){return a.extras.edition?"#00a1df":a.extras.negation?"#ff5959":"#00ad68"},void 0===e||void 0===n)throw new Error("Missing parameters");return a.addPort(new s.default("right")),a.addPort(new s.default("left")),a.addPort(new s.default("bottom")),a.addPort(new s.default("top")),a.fieldNode=e,a.treeNodePath=n,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"getSize",value:function(){return{width:200,height:70,borderWidth:2}}}]),t}(o.NodeModel);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(89),i=n(274),s=(a=i)&&a.__esModule?a:{default:a};var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"simple"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"getNewInstance",value:function(e){return new s.default("unknown")}}]),t}(o.AbstractPortFactory);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(11),l=n(6),c=n(8),u=n(15),d=n(12);var f=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},p=(0,l.defineMessages)({buttonLabel:{id:"queryBuilder.timelineSelector.button.label",defaultMessage:"View Matching Timeline"},errorLabel:{id:"queryBuilder.timelineSelector.error.label",defaultMessage:"There is an error with your query"},noResultsLabel:{id:"queryBuilder.timelineSelector.noResults.label",defaultMessage:"There is no matching timeline for your query"}}),m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.runQuery=function(){var e=n.props,t=e.organisationId,a=e.datamartId,r=e.query,o=e.stale,i={operations:[{directives:[],selections:[{name:"id"}]}],from:"UserPoint",where:r};n.setState({loading:!0,error:!1,results:void 0}),n._queryService.runJSONOTQLQuery(a,i).then((function(e){0===e.data.rows.length||o||window.open(window.location.origin+"/#/v2/o/"+t+"/audience/timeline/user_point_id/"+e.data.rows[Math.floor(Math.random()*e.data.rows.length)]+"?datamartId="+a),n.setState({loading:!1,error:!1,results:e.data.rows})})).catch((function(){n.setState({loading:!1,error:!0,results:void 0})}))},n.state={error:!1,loading:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props.intl.formatMessage;return o.createElement("div",{className:"m-t-5 timeline-selector",style:{float:"left",padding:"0 8px",position:"relative"}},this.state.loading?o.createElement(i.Spin,{size:"small"}):o.createElement(s.Button,{onClick:function(){return e.runQuery()}},t(p.buttonLabel)),this.state.error&&!this.state.loading&&o.createElement("div",{className:"error"},t(p.errorLabel)),this.state.results&&0===this.state.results.length&&!this.state.loading&&o.createElement("div",{className:"error"},t(p.noResultsLabel)))}}]),t}(o.Component);f([(0,u.lazyInject)(d.TYPES.IQueryService)],m.prototype,"_queryService",void 0),t.default=(0,c.compose)(l.injectIntl)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(226),o=n(1072),i=(a=o)&&a.__esModule?a:{default:a};t.default=(0,r.DragDropContext)(i.default)},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),r=n(25),o=n(33),i=l(n(204)),s=l(n(67));function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var c=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};t.default=(0,a.compose)(o.withRouter,(0,r.connect)((function(e){return{getFeatureFlagClient:i.getFeatureFlagClient(e),hasFeatureStore:i.hasFeature(e),getDefaultDatamart:s.getDefaultDatamart(e),getConnectedUser:s.getStoredConnectedUser(e)}})),(0,a.mapProps)((function(e){var t=e.getDefaultDatamart,n=e.getFeatureFlagClient,a=e.getConnectedUser,r=e.hasFeatureStore,o=c(e,["getDefaultDatamart","getFeatureFlagClient","getConnectedUser","hasFeatureStore"]),i=t(o.match&&o.match.params&&o.match.params.organisationId?o.match.params.organisationId:o.computedMatch&&o.computedMatch.params.organisationId?o.computedMatch.params.organisationId:""),s=n,l=a,u={user_id:l.id,is_mics:!!l.workspaces.find((function(e){return"1"===e.organisation_id})),organisation_ids:l.workspaces.map((function(e){return e.organisation_id})),locale:l.locale,domain:window.MCS_CONSTANTS?window.MCS_CONSTANTS.NAVIGATOR_URL:window.location.host};return Object.assign({hasFeature:function(e,t){if(e&&"string"==typeof e){if(r(e))return r(e)&&(!!i||!t)}else if(e&&Array.isArray(e)){var n=e.reduce((function(e,n){return r(n)&&(!!i||!t)}),!1);if(n)return n}else if(!e)return!!i||!t;if(s){if(e&&"string"==typeof e)return!(!i&&t)&&"on"===s.getTreatment(e,u);if(e&&Array.isArray(e)){if(i||!t){var a=s.getTreatments(e,u);return Object.keys(a).reduce((function(e,t){return!0===e&&"on"===a[t]}),!0)}return!1}return!!e||(!!i||!t)}return!1}},o)})))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryFragmentFieldArray=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=E(n(54)),l=n(6),c=n(13),u=n(10),d=n(25),f=n(8),p=n(35),m=n(227),g=n(2185),y=E(n(2186)),h=E(n(2214)),v=n(15),b=n(12),_=n(11),S=E(n(23));function E(e){return e&&e.__esModule?e:{default:e}}var O=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},w=t.QueryFragmentFieldArray=p.FieldArray,M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.runQuery=function(e){var t=n.props.audienceBuilder;n.setState({isQueryRunning:!0,isMaskVisible:!1});var a=(0,m.buildQueryDocument)(e);n._queryService.runJSONOTQLQuery(t.datamart_id,a).then((function(e){n.setState({queryResult:e.data,isQueryRunning:!1,queryDocument:a})})).catch((function(e){n.setState({isQueryRunning:!1}),n.props.notifyError(e)}))},n.toggleDashboard=function(){n.setState({isDashboardToggled:!n.state.isDashboardToggled}),setTimeout((function(){window.dispatchEvent(new Event("resize"))}),50)},n.refreshDashboard=function(){var e=n.props.formValues;n.runQuery(e)},n.state={isLoadingObjectTypes:!0,objectTypes:[],isQueryRunning:!1,isDashboardToggled:!1,isMaskVisible:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.audienceBuilder,a=t.formValues;this.runQuery(a),this._runtimeSchemaService.getRuntimeSchemas(n.datamart_id).then((function(t){var a=t.data.find((function(e){return"LIVE"===e.status}));if(a)return e._runtimeSchemaService.getObjectTypeInfoResources(n.datamart_id,a.id).then((function(t){e.setState({objectTypes:t,isLoadingObjectTypes:!1})}))}));var r=[];a.where.expressions.forEach((function(e){e.expressions.forEach((function(e){(0,g.isAudienceBuilderParametricPredicateNode)(e)&&r.push(e.parametric_predicate_id)}))}));var o=r.map((function(t){return e._audienceFeatureService.getAudienceFeature(n.datamart_id,t)}));Promise.all(o).then((function(t){var n=t.map((function(e){return e.data}));e.setState({audienceFeatures:n})}))}},{key:"componentDidUpdate",value:function(e){var t=this.props.formValues;s.default.isEqual(t,e.formValues)||this.setState({isMaskVisible:!0})}},{key:"render",value:function(){var e=this.props,t=e.renderActionBar,n=e.formValues,r=e.match.params.organisationId,o=e.intl,s=e.audienceBuilder,l=e.change,c=this.state,d=c.objectTypes,f=c.queryResult,p=c.isQueryRunning,g=c.queryDocument,v=c.isDashboardToggled,b=c.isMaskVisible,S=c.isLoadingObjectTypes,E=c.audienceFeatures;return i.createElement(i.Fragment,null,t({operations:[{directives:[],selections:[{name:"id"}]}],from:"UserPoint",where:n.where},s.datamart_id),i.createElement(u.Layout,null,i.createElement(u.Row,{className:"ant-layout-content mcs-audienceBuilder_container"},i.createElement(u.Col,{span:v?1:12},i.createElement("div",{className:""+(v&&"mcs-audienceBuilder_hiddenForm")},S?i.createElement(_.Loading,{className:"m-t-40",isFullScreen:!0}):i.createElement(w,a({name:"where.expressions",component:h.default,datamartId:s.datamart_id,formChange:l,demographicsFeaturesIds:s.demographics_features_ids,audienceFeatures:E,objectTypes:d},{rerenderOnEveryChange:!0})))),i.createElement(u.Col,{span:v?23:12,className:"mcs-audienceBuilder_liveDashboardContainer"},i.createElement(_.Button,{className:"mcs-audienceBuilder_sizeButton "+(v&&"mcs-audienceBuilder_rightChevron"),onClick:this.toggleDashboard},i.createElement(_.McsIcon,{type:"chevron-right"})),!!b&&i.createElement("div",{className:"mcs-audienceBuilder_liveDashboardMask"},i.createElement(_.Button,{onClick:this.refreshDashboard,className:"mcs-audienceBuilder_dashboard_refresh_button"},o.formatMessage(m.messages.refreshMessage))),i.createElement(y.default,{organisationId:r,datamartId:s.datamart_id,audienceBuilderId:s.id,totalAudience:f&&f.rows[0].count,isQueryRunning:p,queryDocument:g})))))}}]),t}(i.Component);O([(0,v.lazyInject)(b.TYPES.IRuntimeSchemaService)],M.prototype,"_runtimeSchemaService",void 0),O([(0,v.lazyInject)(b.TYPES.IQueryService)],M.prototype,"_queryService",void 0),O([(0,v.lazyInject)(b.TYPES.IAudienceFeatureService)],M.prototype,"_audienceFeatureService",void 0);t.default=(0,f.compose)(l.injectIntl,c.withRouter,S.default,(0,p.reduxForm)({form:m.FORM_ID,enableReinitialize:!0}),(0,d.connect)((function(e){return{formValues:(0,p.getFormValues)(m.FORM_ID)(e)}})))(M)},,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormSearchObjectField=t.FormRelativeAbsoluteDateField=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(6),l=n(15),c=n(12),u=n(24),d=_(n(1061)),f=n(35),p=_(n(1062)),m=n(1063),g=n(127),y=_(n(343)),h=n(13),v=n(65),b=n(163);function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=t.FormRelativeAbsoluteDateField=f.Field,O=t.FormSearchObjectField=f.Field,w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderSelectField=function(){var e,t=n.props,a=t.variable,r=t.formPath,i=t.datamartId,s=t.objectTypes,l=t.match.params.organisationId,c=t.workspace.community_id,u=t.disabled;e=r+".parameters."+a.parameter_name;var d=s.find((function(e){return"UserPoint"===e.name})),f=d&&d.fields.find((function(e){return e.name===a.path[0]})),p=f?s.find((function(e){return f.field_type.includes(e.name)})):void 0,m=null==p?void 0:p.fields.find((function(e){return e.name===a.field_name})),h=m?m.directives:void 0,v={},_=!1,S=!1,E=function(e){return a.field_name&&f?n._referenceTableService.getReferenceTable(i,f.runtime_schema_id,f.name,a.field_name).then((function(e){return e.data.map((function(e){return{key:e.value,label:e.display_value,value:e.value}}))})):Promise.resolve([])},w=function(e){return Promise.resolve({key:e,label:e,value:e})},M=h&&(0,g.getCoreReferenceTypeAndModel)(h);if(h&&M){if(M.type&&"CORE_OBJECT"===M.type)switch(M.modelType){case"COMPARTMENTS":E=function(e){return n._datamartService.getUserAccountCompartmentDatamartSelectionResources(i).then((function(e){return e.data.map((function(e){return{key:e.compartment_id,label:e.name?e.name:e.token,value:e.compartment_id}}))}))},w=function(e){return n._compartmentService.getCompartment(e).then((function(e){return{key:e.data.id,label:e.data.name,value:e.data.id}}))};break;case"CHANNELS":E=function(e){return n._channelService.getChannelsByOrganisation(l,{community_id:l===c?c:void 0,keywords:e,with_source_datamarts:!0}).then((function(e){return e.data.map((function(e){return{key:e.id,label:e.name,value:e.id}}))}))},w=function(e){return n._channelService.getChannel(i,e).then((function(e){return{key:e.data.id,label:e.data.name,value:e.data.id}}))};break;case"SEGMENTS":E=function(e){return n._audienceSegmentService.getSegments(l,{keywords:e,datamart_id:i}).then((function(e){return e.data.map((function(e){return{key:e.id,label:o.createElement(b.SegmentNameDisplay,{audienceSegmentResource:e}),value:e.id}}))}))},w=function(e){return n._audienceSegmentService.getSegment(e).then((function(e){return{key:e.data.id,label:e.data.name,value:e.data.id}}))}}}else E=function(e){var t="SELECT "+a.path.slice().reverse().reduce((function(e,t,n){return"{ "+t+" "+e+" }"}),"@map(limit:10000)")+" FROM UserPoint";return n._queryService.runOTQLQuery(i,t,{use_cache:!0}).then((function(e){return e.data.rows[0].aggregations.buckets[0].buckets.map((function(e){return{key:e.key,label:e.key}}))}))},v=Object.assign(Object.assign({},v),{mode:"tags",disabled:!!u}),_=!0,S=!0;return o.createElement(O,{name:e,component:y.default,formItemProps:Object.assign({label:a.parameter_name},{labelCol:{span:5},wrapperCol:{span:18,offset:1}}),fetchListMethod:E,fetchSingleMethod:w,selectProps:v,loadOnlyOnce:_,shouldFilterData:S})},n.renderField=function(){var e=n.props,t=e.variable,a=e.formPath,r=e.fieldValidators,i=r.isValidFloat,s=r.isValidInteger,l=e.disabled,c=a+".parameters."+t.parameter_name,f={labelCol:{span:5},wrapperCol:{span:18,offset:1}};if(t.container_type&&t.container_type.includes("List"))return n.renderSelectField();switch(t.type){case"Boolean":return o.createElement(u.FormSelectField,{name:c,component:u.DefaultSelect,formItemProps:Object.assign({label:t.parameter_name},f),disabled:!!l,options:[{title:"true",value:"true"},{title:"false",value:"false"}]});case"Int":return o.createElement(u.FormInputNumberField,{name:c,normalize:function(e){return parseInt(e,0)||e},component:u.FormInputNumber,validate:[s],formItemProps:Object.assign({label:t.parameter_name},f),inputNumberProps:{disabled:!!l}});case"Float":return o.createElement(u.FormInputNumberField,{name:c,normalize:function(e){return parseFloat(e)||e},component:u.FormInputNumber,validate:[i],formItemProps:Object.assign({label:t.parameter_name},f),inputNumberProps:{disabled:!!l}});case"String":return n.renderSelectField();case"Timestamp":case"Date":return o.createElement(E,{name:c,component:p.default,formItemProps:Object.assign({label:t.parameter_name},f),unixTimstamp:!0,disabled:!!l,noListValue:!0});case"OperatingSystemFamily":case"FormFactor":case"HashFunction":case"BrowserFamily":case"UserAgentType":case"ActivitySource":case"UserActivityType":return o.createElement(u.FormMultiTagField,{name:c,component:d.default,selectProps:{options:m.builtinEnumTypeOptions[t.type].map((function(e){return{label:e,value:e}})),disabled:!!l},formItemProps:Object.assign({label:t.parameter_name},f)});default:return"not supported"}},n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){return o.createElement("div",{className:"mcs-audienceBuilder_audienceFeatureInput"},this.renderField())}}]),t}(o.Component);S([(0,l.lazyInject)(c.TYPES.IQueryService)],w.prototype,"_queryService",void 0),S([(0,l.lazyInject)(c.TYPES.IReferenceTableService)],w.prototype,"_referenceTableService",void 0),S([(0,l.lazyInject)(c.TYPES.IDatamartService)],w.prototype,"_datamartService",void 0),S([(0,l.lazyInject)(c.TYPES.ICompartmentService)],w.prototype,"_compartmentService",void 0),S([(0,l.lazyInject)(c.TYPES.IChannelService)],w.prototype,"_channelService",void 0),S([(0,l.lazyInject)(c.TYPES.IAudienceSegmentService)],w.prototype,"_audienceSegmentService",void 0),t.default=(0,i.compose)(s.injectIntl,u.withValidators,h.withRouter,v.injectWorkspace)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=n(6),c=n(227),u=n(15),d=n(12),f=n(44),p=n(272);var m=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},g=((a=p)&&a.__esModule?a:{default:a}).default,y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchAudienceFeatures=function(e){var t=n.props,a=t.datamartId,r=t.demographicIds,o=Object.assign({},(0,f.getPaginatedApiParam)(e.currentPage,e.pageSize));return e.keywords&&(o.keywords=[e.keywords]),r&&r.length>=1&&(o.exclude=r),n._audienceFeatureService.getAudienceFeatures(a,o)},n.saveAudienceFeatures=function(e,t){n.props.save(t)},n.state={isLoading:!1,parametricPredicates:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.close,a=t.intl.formatMessage,r=[{intlMessage:c.messages.audienceFeatureName,key:"name",render:function(e,t){return i.createElement("span",null,t.name)}},{intlMessage:c.messages.audienceFeatureDescription,key:"description",render:function(e,t){return i.createElement("i",null,t.description)}}];return i.createElement(g,{actionBarTitle:a(c.messages.addAudienceFeature),displayFiltering:!0,searchPlaceholder:a(c.messages.searchAudienceFeature),fetchDataList:this.fetchAudienceFeatures,fetchData:function(t){var n=e.props.datamartId;return e._audienceFeatureService.getAudienceFeature(t,n)},singleSelection:!0,columnsDefinitions:r,save:this.saveAudienceFeatures,close:n})}}]),t}(i.Component);m([(0,u.lazyInject)(d.TYPES.IAudienceFeatureService)],y.prototype,"_audienceFeatureService",void 0),t.default=(0,s.compose)(l.injectIntl)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=g(n(47)),i=n(6),s=n(8),l=n(13),c=n(61),u=n(24),d=n(183),f=g(n(95)),p=g(n(804)),m=n(178);function g(e){return e&&e.__esModule?e:{default:e}}function y(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=function(e){function t(){h(this,t);var e=v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.updateAdGroups=function(t,n){var a=e.props,r=a.fields,i=a.formChange,s=[];n?r.getAll().forEach((function(e){e.key===n?s.push({key:n,model:t}):s.push(e)})):(s.push.apply(s,y(r.getAll())),s.push({key:(0,o.default)(),model:t})),i(r.name,s),e.props.closeNextDrawer()},e.openAdGroupForm=function(t){e.props.closeNextDrawer();var n=e.props.intl.formatMessage,a={breadCrumbPaths:[{name:t&&t.model.adGroup.name?n(f.default.editAdGroup,{adGroupName:t.model.adGroup.name}):n(f.default.breadcrumbTitle2)}],close:e.props.closeNextDrawer,onSubmit:function(n){return e.updateAdGroups(n,t&&t.key)}};a.initialValues=t?t.model:m.INITIAL_AD_GROUP_FORM_DATA;var r={additionalProps:a};e.props.openNextDrawer(p.default,r)},e.getAdGroupRecords=function(){var t=e.props.fields,n=function(e){return e.model.adGroup.name};return t.getAll().map((function(a,o){return r.createElement(d.RecordElement,{key:a.key,recordIconType:"adGroups",record:a,title:n,onEdit:function(){return e.openAdGroupForm(a)},onRemove:function(){return t.remove(o)}})}))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props.intl.formatMessage;return r.createElement("div",null,r.createElement(u.FormSection,{button:{message:t(f.default.breadcrumbTitle2),onClick:function(){return e.openAdGroupForm()}},subtitle:f.default.sectionSubtitle3,title:f.default.sectionTitle3}),r.createElement(d.RelatedRecords,{emptyOption:{iconType:"adGroups",message:t(f.default.contentSection3EmptyTitle)}},this.getAdGroupRecords()))}}]),t}(r.Component);t.default=(0,s.compose)(i.injectIntl,l.withRouter,c.injectDrawer)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuditActionButtonList=t.AuditComponent=t.AuditStatusRenderer=t.AuditComponentContainer=void 0;var a=s(n(2228)),r=s(n(809)),o=s(n(1088)),i=s(n(1089));function s(e){return e&&e.__esModule?e:{default:e}}t.AuditComponentContainer=a.default,t.AuditStatusRenderer=r.default,t.AuditComponent=o.default,t.AuditActionButtonList=i.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.auditStatusMessageMap=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=u(n(17)),s=n(6),l=u(n(809)),c=u(n(1089));function u(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleDisplayModal=function(){n.setState((function(e){return{modalVisible:!e.modalVisible}}))},n.state={modalVisible:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.auditStatuses,n=e.creative,a=e.onMakeAuditAction,u=e.intl,d=r.createElement(s.FormattedMessage,{id:"creatives.audit.status.details.button-label",defaultMessage:"Audit Details"}),p=t.length>0&&r.createElement("div",{className:"float-right m-l-10"},r.createElement(o.Button,{onClick:this.toggleDisplayModal},d));return r.createElement("div",{style:{overflow:"hidden"}},r.createElement("div",null,r.createElement("div",{className:"float-left",style:{lineHeight:"59px"}},r.createElement(l.default,{auditStatus:n.audit_status})),r.createElement("div",{className:"left-part-margin"},r.createElement(c.default,{auditActions:n.available_user_audit_actions,confirmAuditAction:a}),p)),r.createElement(o.Modal,{title:d,visible:this.state.modalVisible,footer:null,onCancel:this.toggleDisplayModal},t.map((function(e){return r.createElement(o.Row,{key:e.date},r.createElement(o.Col,{span:e.feedback?8:12},e.display_network,":"," ",r.createElement("span",null,u.formatMessage(f[e.status]))),e.feedback?r.createElement(o.Col,{span:8},e.feedback):null,r.createElement(o.Col,{span:e.feedback?8:12},(0,i.default)(e.date).format("DD/MM/YYYY HH:mm:ss")))}))))}}]),t}(r.Component);t.default=(0,s.injectIntl)(d);var f=t.auditStatusMessageMap=(0,s.defineMessages)({AUDIT_PENDING:{id:"creatives.display.audit.status.pending",defaultMessage:"Audit Pending"},AUDIT_FAILURE:{id:"creatives.display.audit.status.failed",defaultMessage:"Audit Failed"},AUDIT_SUCCESS:{id:"creatives.display.audit.status.passed",defaultMessage:"Audit Success"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.confirmAuditActionOkTestMap=t.confirmAuditActionContentMap=t.confirmAuditActionTitleMap=t.auditActionMessageMap=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(6);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=function(e){function t(){s(this,t);var e=l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.confirmMakeAuditAction=function(t){var n=e.props,a=n.confirmAuditAction,r=n.intl;o.Modal.confirm({title:r.formatMessage(d[t]),content:r.formatMessage(f[t]),okText:r.formatMessage(p[t]),onOk:function(){a(t)}})},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props.auditActions;return r.createElement("div",null,t.map((function(t){return r.createElement("div",{key:t,className:"float-right m-l-10"},r.createElement(o.Button,{type:"primary",onClick:function(){return e.confirmMakeAuditAction(t)}},r.createElement(i.FormattedMessage,u[t])))})))}}]),t}(r.Component);t.default=(0,i.injectIntl)(c);var u=t.auditActionMessageMap=(0,i.defineMessages)({START_AUDIT:{id:"creatives.audit.action.start",defaultMessage:"Start Audit"},FAIL_AUDIT:{id:"creatives.audit.action.fail",defaultMessage:"Fail Audit"},PASS_AUDIT:{id:"creatives.audit.action.pass",defaultMessage:"Pass Audit"},RESET_AUDIT:{id:"creatives.audit.action.reset",defaultMessage:"Reset Audit"}}),d=t.confirmAuditActionTitleMap=(0,i.defineMessages)({START_AUDIT:{id:"creatives.audit.action.start.confirm.title",defaultMessage:"Submit your Creative to Audit"},FAIL_AUDIT:{id:"creatives.audit.action.fail.confirm.title",defaultMessage:"Fail your Creative Audit Status"},PASS_AUDIT:{id:"creatives.audit.action.pass.confirm.title",defaultMessage:"Pass your Creative Audit Status"},RESET_AUDIT:{id:"creatives.audit.action.reset.confirm.title",defaultMessage:"Reset your Creative Audit Status"}}),f=t.confirmAuditActionContentMap=(0,i.defineMessages)({START_AUDIT:{id:"creatives.audit.action.start.confirm.content",defaultMessage:"You are about to submit your creative to an external audit. Please be sure to save any modification on your creative before starting the audit. It can take approximatly between 24 to 48 hours. You won't be able to modify your creative during the audit process. Are you sure you want to proceed ?"},FAIL_AUDIT:{id:"creatives.audit.action.fail.confirm.content",defaultMessage:"Are you sure you want to proceed ?"},PASS_AUDIT:{id:"creatives.audit.action.pass.confirm.content",defaultMessage:"Are you sure you want to proceed ?"},RESET_AUDIT:{id:"creatives.audit.action.reset.confirm.content",defaultMessage:"You are about to reset your creative audit status, which means that you will need to pass the audit again to use it in a campaign. Are you sure you want to proceed ?"}}),p=t.confirmAuditActionOkTestMap=(0,i.defineMessages)({START_AUDIT:{id:"creatives.audit.action.start.confirm.oktext",defaultMessage:"Start the audit"},FAIL_AUDIT:{id:"creatives.audit.action.fail.confirm.oktext",defaultMessage:"Fail the audit"},PASS_AUDIT:{id:"creatives.audit.action.pass.confirm.oktext",defaultMessage:"Pass the audit"},RESET_AUDIT:{id:"creatives.audit.action.reset.confirm.oktext",defaultMessage:"Reset the audit"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TemplateFormSection=t.SegmentFormSection=t.GeneralFormSection=t.BlastFormSection=void 0;var a=s(n(2231)),r=s(n(2232)),o=s(n(2233)),i=s(n(2235));function s(e){return e&&e.__esModule?e:{default:e}}t.BlastFormSection=a.default,t.GeneralFormSection=r.default,t.SegmentFormSection=o.default,t.TemplateFormSection=i.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(33),s=n(41),l=n(10),c=n(6),u=n(68),d=n(616),f=(a=d)&&a.__esModule?a:{default:a},p=n(56),m=n(1017),g=n(30),y=n(829),h=n(8),v=n(11);function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var S=function(e){function t(){b(this,t);var e=_(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.handleEditCampaign=function(t){var n=e.props,a=n.match.params.organisationId;n.history.push("/v2/o/"+a+"/campaigns/email/"+t.id+"/edit")},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.dataSource,a=t.archiveCampaign,r=t.isFetchingCampaigns,d=t.intl.formatMessage,h=t.onFilterChange,b=t.location.search,_=t.isFetchingStats,S=t.totalCampaigns,E=t.labelsOptions,O=t.hasEmailCampaigns,w=(0,g.parseSearch)(b,y.EMAIL_SEARCH_SETTINGS),M={placeholder:d(f.default.searchPlaceholder),onSearch:function(e){return h({keywords:e})},defaultValue:w.keywords},P={isEnabled:!0,onChange:function(e){return h({from:e.from,to:e.to})},values:{from:w.from,to:w.to}},T={current:w.currentPage,pageSize:w.pageSize,total:S,onChange:function(e){return h({currentPage:e})},onShowSizeChange:function(e,t){return h({pageSize:t,currentPage:1})}},I=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(_)return o.createElement("i",{className:"mcs-table-cell-loading"});var a="EUR"===n?"€ ":"";return(0,p.formatMetric)(e,t,a)},A=[{intlMessage:f.default.emailHeaderStatus,key:"status",isHideable:!1,render:function(e){return o.createElement(l.Tooltip,{placement:"top",title:d(f.default[e])},o.createElement("span",{className:"mcs-campaigns-status-"+e.toLowerCase()},o.createElement(v.McsIcon,{type:"status"})))}},{intlMessage:f.default.emailHeaderName,key:"name",isHideable:!1,render:function(e,t){return o.createElement(i.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+t.organisation_id+"/campaigns/email/"+t.id},e)}},{intlMessage:f.default.emailHeaderSent,key:"email_sent",isVisibleByDefault:!0,isHideable:!0,render:function(e){return I(e,"0,0")}},{intlMessage:f.default.emailHeaderHardBounced,key:"email_hard_bounced",isVisibleByDefault:!0,isHideable:!0,render:function(e){return I(e,"0,0")}},{intlMessage:f.default.emailHeaderSoftBounced,key:"email_soft_bounced",isVisibleByDefault:!0,isHideable:!0,render:function(e){return I(e,"0,0")}},{intlMessage:f.default.emailHeaderClicks,key:"clicks",isVisibleByDefault:!0,isHideable:!0,render:function(e){return I(e,"0,0")}},{intlMessage:f.default.emailHeaderImpressions,key:"impressions",isVisibleByDefault:!0,isHideable:!0,render:function(e){return I(e,"0,0")}}],C=[{key:"action",actions:function(){return[{intlMessage:f.default.editCampaign,callback:e.handleEditCampaign},{intlMessage:f.default.archiveCampaign,callback:a}]}}],j=m.campaignStatuses.map((function(e){return{key:e,value:e}})),R=[{displayElement:o.createElement("div",null,o.createElement(c.FormattedMessage,f.default.emailHeaderStatus),o.createElement(s.DownOutlined,null)),selectedItems:w.statuses.map((function(e){return{key:e,value:e}})),items:j,getKey:function(e){return e.key},display:function(e){return e.value},handleMenuClick:function(e){h({statuses:e.map((function(e){return e.value}))})}}];return O?o.createElement("div",{className:"mcs-table-container"},o.createElement(u.TableViewFilters,{columns:A,actionsColumnsDefinition:C,searchOptions:M,dateRangePickerOptions:P,filtersOptions:R,columnsVisibilityOptions:{isEnabled:!0},dataSource:n,loading:r,pagination:T,labelsOptions:E})):o.createElement(v.EmptyTableView,{iconType:"email",message:d(f.default.noCampaign)})}}]),t}(o.Component);t.default=(0,h.compose)(c.injectIntl,i.withRouter)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(831),s=n(56),l=f(n(78)),c=f(n(81)),u=f(n(23)),d=f(n(59));function f(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchData=function(e){n.setState({isLoading:!0}),l.default.getSingleEmailDeliveryReport(e.organisation_id,e.id,new c.default(e.creation_ts),new c.default("now"),["day"]).then((function(e){n.setState({isLoading:!1,emailReportView:e.data})})).catch((function(e){d.default.error(e),n.props.notifyError(e),n.setState({isLoading:!1})}))},n.state={isLoading:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.campaign;e&&this.fetchData(e)}},{key:"componentDidUpdate",value:function(e){var t=e.campaign,n=this.props.campaign;!n||t&&n.id===t.id||this.fetchData(n)}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.emailReportView,a=void 0;if(n){var o=(0,s.normalizeReportView)(n.report_view),l=(0,s.formatNormalizeReportView)(o),c=l.email_sent;a={emailDelivered:c-l.uniq_email_hard_bounced-l.uniq_email_soft_bounced,emailOpened:l.uniq_impressions,emailUnsubscribed:l.uniq_email_unsubscribed,emailClicks:l.uniq_clicks,emailSent:c}}return r.createElement(i.EmailPieCharts,{isLoading:t,deliveryReport:a})}}]),t}(r.Component);t.default=(0,o.compose)(u.default)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({emailBlast:{id:"email.email_blast",defaultMessage:"Email Blast"},emailSent:{id:"emailMetric.email_sent",defaultMessage:"Email Sent"},emailImpressions:{id:"emailMetric.impressions",defaultMessage:"Email Opens"},emailClicks:{id:"emailMetric.clicks",defaultMessage:"Clicks"},emailHardBounce:{id:"emailMetric.email_hard_bounced",defaultMessage:"Hard Bounce"},blastStatusUpdateSuccessMessage:{id:"email.blast.status.update.success.message",defaultMessage:"Success"},blastStatusUpdateSuccessDescription:{id:"email.blast.status.update.success.description",defaultMessage:"Blast Status Successfully Updated"},blastStatusUpdateFailure:{id:"email.blast.status.update.failure",defaultMessage:"Blast Not Updated"},blastArchiveTitle:{id:"email.blast.archive.title",defaultMessage:"Archive Blast"},blastArchivetext:{id:"email.blast.archive.text",defaultMessage:"You are about to archive your Email Blast. This operation cannot be undone. Are you sure you want to proceed?"},blastArchiveOk:{id:"email.blast.archive.Ok",defaultMessage:"Ok"},blastArchiveCancel:{id:"email.blast.archive.cancel",defaultMessage:"Cancel"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messagesMap=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(6),l=n(33),c=n(41),u=n(10),d=n(107),f=n(68),p=n(56),m=_(n(162)),g=_(n(273)),y=n(615),h=_(n(182)),v=n(12),b=n(15);function _(e){return e&&e.__esModule?e:{default:e}}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var O=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},w=(0,s.defineMessages)({SCENARIO_ACTIVATED:{id:"email.campaigns.dashboard.blastList.scenarioActivation",defaultMessage:"Scenario activation"},PENDING:{id:"email.campaigns.dashboard.blastList.status.pending",defaultMessage:"Pending"},SCHEDULED:{id:"email.campaigns.dashboard.blastList.status.scheduled",defaultMessage:"Scheduled"},FINISHED:{id:"email.campaigns.dashboard.blastList.status.finished",defaultMessage:"Sent"},ERROR:{id:"email.campaigns.dashboard.blastList.status.error",defaultMessage:"Error"}}),M=t.messagesMap=(0,s.defineMessages)({status:{id:"email.campaigns.dashboard.blastList.status",defaultMessage:"Status"},name:{id:"email.campaigns.dashboard.blastList.name",defaultMessage:"Name"},emailSent:{id:"email.campaigns.dashboard.blastList.emailSent",defaultMessage:"Email Sent"},emailHardBounced:{id:"email.campaigns.dashboard.blastList.emailHardBounced",defaultMessage:"Email Hard Bounced"},emailSoftBounced:{id:"email.campaigns.dashboard.blastList.emailSoftBounced",defaultMessage:"Email Soft Bounced"},clicks:{id:"email.campaigns.dashboard.blastList.clicks",defaultMessage:"Clicks"},impressions:{id:"email.campaigns.dashboard.blastList.impressions",defaultMessage:"Impressions"},noEmailStats:{id:"email.campaigns.dashboard.blastList.noEmailStats",defaultMessage:"No Data during the selected period."},editBlast:{id:"email.campaigns.dashboard.blastList.edit",defaultMessage:"Edit"},blastHistory:{id:"email.campaigns.dashboard.blastList.history",defaultMessage:"History"},archiveBlast:{id:"email.campaigns.dashboard.blastList.archive",defaultMessage:"Archive"}}),P={PENDING:["SCENARIO_ACTIVATED","SCHEDULED"],SCENARIO_ACTIVATED:["PENDING"],SCHEDULED:["PENDING"],FINISHED:[],ERROR:[]},T=f.TableView,I=function(e){function t(){S(this,t);var e=E(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.editBlast=function(t){var n=e.props,a=n.match.params,r=a.organisationId,o=a.campaignId;n.history.push("/v2/o/"+r+"/campaigns/email/"+o+"/blasts/"+t.id+"/edit")},e.renderStatus=function(t){return P[t.status]?o.createElement(d.Dropdown,{overlay:e.getStatusMenu(t),trigger:["click"]},o.createElement("a",{className:"ant-dropdown-link"},o.createElement(s.FormattedMessage,w[t.status]),o.createElement(c.DownOutlined,null))):o.createElement(s.FormattedMessage,w[t.status])},e.getStatusMenu=function(t){var n=e.props.updateBlastStatus,a=P[t.status].map((function(e){return o.createElement(u.Menu.Item,{key:e},o.createElement(s.FormattedMessage,w[e]))}));return o.createElement(u.Menu,{onClick:function(e){return n(t.id,e.key)}},a)},e.openHistoryDrawer=function(t){var n=e.props,a=n.match.params.organisationId,r=n.history;e.props.openNextDrawer(g.default,{additionalProps:{resourceType:"EMAIL_BLAST",resourceId:t.id,handleClose:function(){return e.props.closeNextDrawer()},formatProperty:y.formatEmailBlastProperty,resourceLinkHelper:{EMAIL_CAMPAIGN:{direction:"PARENT",getType:function(){return o.createElement(s.FormattedMessage,h.default.emailCampaignResourceType)},getName:function(t){return e._emailCampaignService.getEmailCampaign(t).then((function(e){return e.data.name}))},goToResource:function(e){r.push("/v2/o/"+a+"/campaigns/email/"+e)}},CAMPAIGN:{direction:"PARENT",getType:function(){return o.createElement(s.FormattedMessage,h.default.emailCampaignResourceType)},getName:function(t){return e._emailCampaignService.getEmailCampaign(t).then((function(e){return e.data.name}))},goToResource:function(e){r.push("/v2/o/"+a+"/campaigns/email/"+e)}},EMAIL_TEMPLATE_SELECTION:{direction:"CHILD",getType:function(){return o.createElement(s.FormattedMessage,h.default.emailTemplateResourceType)},getName:function(t){return e._resourceHistoryService.getLinkedResourceIdInSelection(a,"EMAIL_TEMPLATE_SELECTION",t,"CREATIVE").then((function(t){return e._creativeService.getEmailTemplate(t).then((function(e){return e.data.name}))}))},goToResource:function(t){e._resourceHistoryService.getLinkedResourceIdInSelection(a,"EMAIL_TEMPLATE_SELECTION",t,"CREATIVE").then((function(e){r.push("/v2/o/"+a+"/creatives/email/"+e+"/edit")}))}},AUDIENCE_SEGMENT_EMAIL_SELECTION:{direction:"CHILD",getType:function(){return o.createElement(s.FormattedMessage,h.default.segmentResourceType)},getName:function(t){return e._resourceHistoryService.getLinkedResourceIdInSelection(a,"AUDIENCE_SEGMENT_EMAIL_SELECTION",t,"AUDIENCE_SEGMENT").then((function(t){return e._audienceSegmentService.getSegment(t).then((function(e){return e.data.name}))}))},goToResource:function(t){e._resourceHistoryService.getLinkedResourceIdInSelection(a,"AUDIENCE_SEGMENT_EMAIL_SELECTION",t,"AUDIENCE_SEGMENT").then((function(e){r.push("/v2/o/"+a+"/audience/segments/"+e)}))}}}},size:"small"})},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.match.params,a=n.organisationId,r=n.campaignId,i=t.data,s=t.isStatLoading,c=t.isLoading,u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(s)return o.createElement("i",{className:"mcs-table-cell-loading"});var a="EUR"===n?"€ ":"";return(0,p.formatMetric)(e,t,a)},d=[{intlMessage:M.status,key:"status",isHideable:!1,render:function(t,n){return e.renderStatus(n)}},{intlMessage:M.name,key:"blast_name",isHideable:!1,render:function(e,t){return o.createElement(l.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+a+"/campaigns/email/"+r+"/blasts/"+t.id+"/edit"},t.blast_name)}},{intlMessage:M.emailSent,key:"email_sent",isVisibleByDefault:!0,isHideable:!0,render:function(e,t){return u(t.email_sent,"0,0")}},{intlMessage:M.emailHardBounced,key:"email_hard_bounced",isVisibleByDefault:!0,isHideable:!0,render:function(e,t){return u(t.email_hard_bounced,"0,0")}},{intlMessage:M.emailSoftBounced,key:"email_soft_bounced",isVisibleByDefault:!0,isHideable:!0,render:function(e,t){return u(t.email_soft_bounced,"0,0")}},{intlMessage:M.clicks,key:"clicks",isVisibleByDefault:!0,isHideable:!0,render:function(e,t){return u(t.clicks,"0,0")}},{intlMessage:M.impressions,key:"impressions",isVisibleByDefault:!0,isHideable:!0,render:function(e,t){return u(t.impressions,"0,0")}}],f=[{key:"action",actions:function(){return[{intlMessage:M.editBlast,callback:e.editBlast},{intlMessage:M.blastHistory,callback:e.openHistoryDrawer},{intlMessage:M.archiveBlast,callback:e.props.archiveBlast}]}}];return o.createElement(T,{columns:d,actionsColumnsDefinition:f,dataSource:i,loading:c})}}]),t}(o.Component);O([(0,b.lazyInject)(v.TYPES.IAudienceSegmentService)],I.prototype,"_audienceSegmentService",void 0),O([(0,b.lazyInject)(v.TYPES.IResourceHistoryService)],I.prototype,"_resourceHistoryService",void 0),O([(0,b.lazyInject)(v.TYPES.ICreativeService)],I.prototype,"_creativeService",void 0),O([(0,b.lazyInject)(v.TYPES.IEmailCampaignService)],I.prototype,"_emailCampaignService",void 0),t.default=(0,i.compose)(l.withRouter,s.injectIntl,m.default)(I)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GOAL_SEARCH_SETTINGS=void 0;var a=n(30);function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.GOAL_SEARCH_SETTINGS=[].concat(r(a.PAGINATION_SEARCH_SETTINGS),r(a.FILTERS_SEARCH_SETTINGS),r(a.DATE_SEARCH_SETTINGS),r(a.LABELS_SEARCH_SETTINGS),r(a.KEYWORD_SEARCH_SETTINGS),r(a.DATAMART_SEARCH_SETTINGS))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.automationRoutes=t.automationDefinition=void 0;var a=l(n(2264)),r=n(185),o=l(n(1109)),i=l(n(2335)),s=l(n(2361));function l(e){return e&&e.__esModule?e:{default:e}}var c=t.automationDefinition={automationBuilder:{path:"/automation-builder",layout:"main",contentComponent:o.default,requiredFeature:"automations-builder",requireDatamart:!0},automationBuilderOld:{path:"/automation-builder-old",layout:"edit",editComponent:a.default,requiredFeature:"automations-builder",requireDatamart:!0},automationBuilderEditOld:{path:"/automation-builder-old/:automationId",layout:"edit",editComponent:a.default,requiredFeature:"automations-builder",requireDatamart:!0},automationsEdit:{path:"/automations/:automationId/edit",layout:"main",contentComponent:a.default,requiredFeature:"automations-builder",requireDatamart:!0},automationsDashboard:{path:"/automations/:automationId",layout:"main",contentComponent:s.default,requiredFeature:"automations-builder",requireDatamart:!0},automationsList:{path:"/automations",layout:"main",contentComponent:i.default,requiredFeature:"automations-list",requireDatamart:!0}};t.automationRoutes=(0,r.generateRoutesFromDefinition)(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=h(n(0)),o=n(8),i=n(10),s=n(25),l=h(n(67)),c=y(n(23)),u=y(n(1098)),d=n(221),f=y(n(2332)),p=n(300),m=n(13),g=n(51);function y(e){return e&&e.__esModule?e:{default:e}}function h(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleUpdateAutomationData=function(e,t){return t?n.setState({automationTreeData:e,exitConditionFormResource:t}):n.setState({automationTreeData:e}),e},n.state={automationTreeData:e.automationFormData&&e.automationFormData.automationTreeData?e.automationFormData.automationTreeData:p.INITIAL_AUTOMATION_DATA.automationTreeData,exitConditionFormResource:e.automationFormData&&e.automationFormData.exitCondition?e.automationFormData.exitCondition:p.INITIAL_AUTOMATION_DATA.exitCondition},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.automationFormData,n=e.automationFormData;t&&n&&t.automationTreeData&&n.automationTreeData&&t.automationTreeData.node&&n.automationTreeData.node&&n.automationTreeData.node.id!==t.automationTreeData.node.id&&this.setState({automationTreeData:t.automationTreeData})}},{key:"render",value:function(){var e=this.props,t=e.datamartId,n=e.automationFormData,a=e.saveOrUpdate,o=e.loading,s=e.creation_mode,l=this.state,c=l.automationTreeData,p=l.exitConditionFormResource;return o?r.createElement(g.Loading,{isFullScreen:!0}):r.createElement("div",{style:{height:"100%",display:"flex"}},r.createElement(i.Layout,null,r.createElement(f.default,{automationData:{automation:n&&n.automation?Object.assign(Object.assign({},n.automation),{datamart_id:t}):void 0,exitCondition:p,automationTreeData:c},saveOrUpdate:a}),r.createElement(i.Layout.Content,{className:"mcs-content-container",style:{padding:0,overflow:"hidden"}},r.createElement(u.default,{datamartId:t,automationTreeData:c,exitCondition:p,scenarioId:d.storylineNodeData[0].scenario_id,updateAutomationData:this.handleUpdateAutomationData,viewer:!1,creation_mode:s}))))}}]),t}(r.Component);t.default=(0,o.compose)(c.default,m.withRouter,(0,s.connect)((function(e){return{getWorkspace:l.getWorkspace}})))(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(89),i=n(127),s=n(10),l=n(11),c=P(n(1069)),u=P(n(2265)),d=P(n(1100)),f=P(n(2324)),p=P(n(2326)),m=P(n(2329)),g=n(221),y=P(n(1108)),h=P(n(1107)),v=P(n(1071)),b=n(6),_=n(160),S=n(73),E=P(n(162)),O=P(n(2331)),w=n(300),M=n(8);function P(e){return e&&e.__esModule?e:{default:e}}var T=t.messages=(0,b.defineMessages)({ifNodeFalsePathLabel:{id:"automation.builder.ifNode.label.false",defaultMessage:"If Condition False"},ifNodeTruePathLabel:{id:"automation.builder.ifNode.label.true",defaultMessage:"If Condition True"},eventGlobalExitCondition:{id:"automation.builder.exitCondition.event",defaultMessage:"Exit on Event"},addGlobalExitCondition:{id:"automation.builder.exitCondition.new",defaultMessage:"Add Exit condition"},noGlobalExitCondition:{id:"automation.builder.exitCondition.empty",defaultMessage:"No exit condition"},deleteGlobalExitConditionTitle:{id:"automation.builder.exitCondition.delete.info",defaultMessage:"Are you sure you want to delete the exit condition ?"},deleteGlobalExitConditionConfirm:{id:"automation.builder.exitCondition.delete.confirm",defaultMessage:"Yes"},deleteGlobalExitConditionCancel:{id:"automation.builder.exitCondition.delete.cancel",defaultMessage:"No"}}),I=function(e){return!1===e.viewer},A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.engine=new o.DiagramEngine,n.getTreeNodeOperations=function(){return{deleteNode:n.deleteNode,addNode:n.addNode,updateNode:n.updateNode,updateLayout:function(){return n.engine.repaintCanvas()}}},n.lockInteraction=function(e){n.setState({locked:e})},n.addNode=function(e,t,a){var r=n.props;if(I(r)&&r.automationTreeData)return a.id=(0,_.generateFakeId)(),r.updateAutomationData(new g.AddNodeOperation(e,t,a).execute(r.automationTreeData))},n.deleteNode=function(e){var t=n.props;if(I(t)&&t.automationTreeData)return t.updateAutomationData(new g.DeleteNodeOperation(e).execute(t.automationTreeData))},n.updateNode=function(e,t,a){var r=n.props;if(I(r)&&r.automationTreeData)return r.updateAutomationData(new g.UpdateNodeOperation(e,t,a).execute(r.automationTreeData))},n.updateExitCondition=function(e){var t=n.props;I(t)&&t.automationTreeData&&t.exitCondition&&t.updateAutomationData(t.automationTreeData,Object.assign(Object.assign({},t.exitCondition),{formData:e}))},n.drawAutomationTree=function(e,t,a,r,o){return t.out_edges.reduce((function(o,s,l){var c=l>0?o+1:o,u=r+1,d=void 0,f=void 0;if(s.node instanceof g.DropNode?((d=n.buildDropNode(s.node,a.getNodeSize().height)).y=i.ROOT_NODE_POSITION.y*c+a.getNodeSize().height/2-10,f=d.y+10,d.x=80+i.ROOT_NODE_POSITION.x+180*u):((d=n.buildAutomationNode(s)).y=i.ROOT_NODE_POSITION.y*c,f=d.y+a.getNodeSize().height/2,d.x=i.ROOT_NODE_POSITION.x+180*u),e.addNode(d),t.out_edges.length>0&&0===l){var p=new h.default;p.setSourcePort(a.ports.center),p.setTargetPort(d.ports.center),p.setColor("#afafaf"),n.addLabelForIfNodeLink(p,s),e.addLink(p)}if(0!==l){var m=new h.default;m.setColor("#afafaf"),m.setSourcePort(a.ports.right),m.setTargetPort(d.ports.center),m.point(a.x+a.getNodeSize().width+21.5,f),n.addLabelForIfNodeLink(m,s),e.addLink(m)}return n.drawAutomationTree(e,s,d,u,c)}),o)},n.addLabelForIfNodeLink=function(e,t){void 0!==t.in_edge&&("IF_CONDITION_FALSE"===t.in_edge.handler?e.addLabel(new o.LabelModel(T.ifNodeFalsePathLabel.defaultMessage)):"IF_CONDITION_TRUE"===t.in_edge.handler&&e.addLabel(new o.LabelModel(T.ifNodeTruePathLabel.defaultMessage)))},n.startAutomationTree=function(e,t){if(e&&e.node&&t){var a=n.props.intl.formatMessage,r=(0,g.generateNodeProperties)(e.node,a),o=new d.default(n.props.datamartId,e,r.title,r.subtitle,r.color,r.iconType,void 0,r.iconAnt,void 0,!0,n.props.creation_mode);o.root=!0,o.x=i.ROOT_NODE_POSITION.x,o.y=i.ROOT_NODE_POSITION.y,t.addNode(o),n.drawAutomationTree(t,n.convertToFrontData(e),o,0,1)}},n.onNodeSelectorClick=function(){n.setState({viewNodeSelector:!n.state.viewNodeSelector})},n.onGlobalExitConditionSelect=function(){var e=n.props,t=e.openNextDrawer,a=e.closeNextDrawer,r=e.exitCondition,o=e.datamartId,i=e.viewer;r&&t(O.default,{additionalProps:{exitCondition:r,disabled:i,initialValues:Object.assign(Object.assign({},r.formData),{datamart_id:o,events:[]}),close:function(){a()},onSubmit:function(e){n.updateExitCondition(e),a()}},size:"small"})},n.onGlobalExitConditionDelete=function(){n.updateExitCondition(w.INITIAL_AUTOMATION_DATA.exitCondition.initialFormData)},n.engine.registerNodeFactory(new p.default(n.getTreeNodeOperations())),n.engine.registerNodeFactory(new u.default(n.getTreeNodeOperations(),n.lockInteraction,e.datamartId,e.viewer)),n.engine.registerLinkFactory(new f.default),n.engine.registerPortFactory(new c.default),n.state={locked:!1,viewNodeSelector:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"convertToFrontData",value:function(e){var t=this,n=e.out_edges.map((function(n,a){return{node:new g.DropNode("1",n,e),in_edge:{id:"1",source_id:e.node.id,target_id:n.node.id,handler:"ON_VISIT",scenario_id:t.props.scenarioId},out_edges:[t.convertToFrontData(n)]}}));return{node:e.node,in_edge:e.in_edge,out_edges:n}}},{key:"componentDidMount",value:function(){var e=this.props.automationTreeData,t=new o.DiagramModel;t.setLocked(!0),this.startAutomationTree(e,t),this.engine.setDiagramModel(t)}},{key:"componentDidUpdate",value:function(e,t){var n=this,a=this.props.automationTreeData,r=e.automationTreeData,i=a;if(a){var s=a?(0,g.findLastAddedNode)(a):void 0,l=r?(0,g.findLastAddedNode)(r):void 0;s&&l&&s.node.id===l.node.id&&(i=(0,g.cleanLastAdded)(a))}if(this.state.viewNodeSelector===t.viewNodeSelector){var c=new o.DiagramModel;c.setLocked(this.engine.getDiagramModel().locked),c.setZoomLevel(this.engine.getDiagramModel().getZoomLevel()),c.setOffsetX(this.engine.getDiagramModel().getOffsetX()),c.setOffsetY(this.engine.getDiagramModel().getOffsetY()),setTimeout((function(){n.startAutomationTree(i,c),n.engine.setDiagramModel(c),n.engine.repaintCanvas()}),10)}}},{key:"buildAutomationNode",value:function(e){var t=this.props.intl.formatMessage,n=(0,g.generateNodeProperties)(e.node,t);return new d.default(this.props.datamartId,e,n.title,n.subtitle,n.color,n.iconType,n.iconAssetUrl,n.iconAnt)}},{key:"buildDropNode",value:function(e,t){return new y.default(e,t)}},{key:"render",value:function(){var e=this.state.viewNodeSelector,t=this.props,n=t.hasFeature,a=t.viewer,i=t.intl.formatMessage,c=t.exitCondition,u=n("automations-global-exit-condition")&&r.createElement("div",{className:"button-helpers bottom"},r.createElement("div",{className:"helper exit-condition"},r.createElement("div",{className:"edit",onClick:!a||c&&c.formData.query_text?this.onGlobalExitConditionSelect:void 0},c&&c.formData.query_text?r.createElement(b.FormattedMessage,T.eventGlobalExitCondition):a?r.createElement(b.FormattedMessage,T.noGlobalExitCondition):r.createElement(b.FormattedMessage,T.addGlobalExitCondition)),!a&&c&&c.formData.query_text&&r.createElement(s.Popconfirm,{title:i(T.deleteGlobalExitConditionTitle),onConfirm:this.onGlobalExitConditionDelete,placement:"topRight",okText:i(T.deleteGlobalExitConditionConfirm),cancelText:i(T.deleteGlobalExitConditionCancel)},r.createElement("div",{className:"delete"},r.createElement(l.McsIcon,{type:"close"}))))),d=r.createElement("div",{className:"automation-builder",ref:this.div},r.createElement(s.Col,{span:e?18:24,className:"diagram"},r.createElement(o.DiagramWidget,{diagramEngine:this.engine,allowCanvasZoom:!this.state.locked,allowCanvasTranslation:!this.state.locked,inverseZoom:!0}),r.createElement("div",{className:"button-helpers top"},r.createElement(l.Button,{onClick:this.onNodeSelectorClick,className:"helper nodes-drawer"},r.createElement(l.McsIcon,{type:"chevron-right",style:e?{}:{transform:"rotate(180deg)",transition:"all 0.5s ease"}})," ")),u),r.createElement(s.Col,{span:e?6:0,className:"available-nodes-visualizer"},r.createElement(m.default,null)));return a&&(d=r.createElement("div",{className:"automation-builder",ref:this.div},r.createElement(s.Col,{span:24,className:"diagram"},r.createElement(o.DiagramWidget,{diagramEngine:this.engine,allowCanvasZoom:!this.state.locked,allowCanvasTranslation:!this.state.locked,inverseZoom:!0}),u))),d}}]),t}(r.Component);t.default=(0,M.compose)(b.injectIntl,S.injectFeatures,E.default)((0,v.default)(A))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(591),s=n(12),l=n(15),c=n(56),u=n(6),d=n(8),f=v(n(69)),p=n(81),m=v(p),g=n(10),y=n(11),h=v(n(17));function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={dataSource:[],isLoading:!0,dateRange:{from:new m.default("now-6d"),to:new m.default("now")}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){this.fetchStats()}},{key:"componentDidUpdate",value:function(e,t){this.state.dateRange!==t.dateRange&&this.fetchStats()}},{key:"fetchStats",value:function(){var e=this,t=this.props,n=t.organisationId,a=t.feedId,r=t.feedStatsUnit,o=this.state.dateRange;if(this.setState({isLoading:!0}),!r)throw new Error("Undefined 'feedStatsUnit'");for(var s=(0,p.formatMcsDate)(o,!0),l=(0,p.formatMcsDate)(o),u=[l.from];u[u.length-1]!==(0,h.default)(l.to).format("YYYY-MM-DD");)u.push((0,h.default)(u[u.length-1]).add(1,"days").format("YYYY-MM-DD"));var d=(0,i.buildFeedStatsByFeedRequestBody)(a,{start_date:s.from,end_date:s.to},["UNIQ_USER_POINTS_COUNT","UNIQ_USER_IDENTIFIERS_COUNT"]);return this._feedsStatsService.getStats(n,d).then((function(t){var n=(0,c.normalizeReportView)(t.data.report_view),a=n.filter((function(e){return"UPSERT"===e.sync_type})),o=n.filter((function(e){return"DELETE"===e.sync_type})),i=u.map((function(e){var t=a.find((function(t){return t.date_yyyy_mm_dd===e})),n=o.find((function(t){return t.date_yyyy_mm_dd===e}));return{day:e,upserted:t?"USER_POINTS"===r?t.uniq_user_points_count:t.uniq_user_identifiers_count:0,deleted:n?"USER_POINTS"===r?n.uniq_user_points_count:n.uniq_user_identifiers_count:0,unit:r}}));return i=i.sort((function(e,t){return e.day.localeCompare(t.day)})),e.setState({dataSource:i,isLoading:!1})})).catch((function(){e.setState({isLoading:!1})}))}},{key:"render",value:function(){var e=this.props,t=e.colors,n=e.intl.formatMessage,a=this.state,r=a.dataSource,i=a.isLoading,s={xKey:"day",yKeys:(r&&r[0]?Object.keys(r[0]).filter((function(e){return"day"!==e&&"unit"!==e})):[]).map((function(e){if("USER_POINTS"===r[0].unit){if("upserted"===e)return{key:e,message:n(S.upserted_user_points)};if("deleted"===e)return{key:e,message:n(S.deleted_user_points)};throw new Error("Unsupported metric: "+e)}if("USER_IDENTIFIERS"===r[0].unit){if("upserted"===e)return{key:e,message:n(S.upserted_identifiers)};if("deleted"===e)return{key:e,message:n(S.deleted_identifiers)};throw new Error("Unsupported metric: "+e)}throw new Error("Unsupported unit: "+r[0].unit)})),colors:[t["mcs-info"],t["mcs-error"]],showLegend:!0};return o.createElement("div",{className:"mcs-feed-chart"},o.createElement("div",{className:"mcs-feed-chart_header"},o.createElement("img",{className:"mcs-feed-chart_header_image",src:"/react/src/assets/images/beta-icon.png"}),o.createElement("div",{className:"mcs-feed-chart_header_description"},o.createElement(u.FormattedMessage,S.stats_description1),o.createElement(u.FormattedMessage,S.stats_description2))),i?o.createElement(y.LoadingChart,null):o.createElement(g.Card,{className:"compact",title:n(S.graph_title)},o.createElement(y.StackedBarPlot,{dataset:r,options:s})))}}]),t}(o.Component);b([(0,l.lazyInject)(s.TYPES.IFeedsStatsService)],_.prototype,"_feedsStatsService",void 0),t.default=(0,d.compose)(f.default,u.injectIntl)(_);var S=(0,u.defineMessages)({upserted_user_points:{id:"feed.upserted_user_points",defaultMessage:"Upserted User Points"},deleted_user_points:{id:"feed.deleted_user_points",defaultMessage:"Deleted User Points"},upserted_identifiers:{id:"feed.upserted_identifiers",defaultMessage:"Upserted Identifiers"},deleted_identifiers:{id:"feed.deleted_identifiers",defaultMessage:"Deleted Identifiers"},graph_title:{id:"feed.graph_title",defaultMessage:"Last 7 days"},stats_description1:{id:"audience.feeds.stats.description1",defaultMessage:"The chart below displays the segment loads sent to the external platform,     day by day: whenever a user is entering / leaving the segment,     this feed is keeping in sync the destination segment."},stats_description2:{id:"audience.feeds.stats.description2",defaultMessage:"When the feed is created, the platform is streaming all the users that     entered the segment prior to the feed creation to be sure that the full segment is     shared with the external platform. Hence, it is normal to see a spike in the user     additions load at the creation of the feed and afterwards a decrease in the segment loads size."}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(89),o=b(n(274)),i=b(n(2270)),s=b(n(2273)),l=b(n(2275)),c=b(n(2277)),u=b(n(2279)),d=b(n(2280)),f=b(n(2282)),p=b(n(2285)),m=b(n(2287)),g=b(n(2289)),y=b(n(2291)),h=b(n(2294)),v=b(n(2322));function b(e){return e&&e.__esModule?e:{default:e}}var _=function(e){function t(e,n,a,r,b,_,S,E,O,w,M){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var P=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"automation-node"));if(P.collapsed=!1,P.negation=!1,P.getPosition=function(){return{x:P.x,y:P.y}},P.addPort(new o.default("center")),P.addPort(new o.default("right")),P.icon=_,void 0===e||void 0===a||void 0===b||void 0===n)throw new Error("missing parameters");switch(P.datamartId=e,P.title=a,P.subtitle=r,P.color=b,P.storylineNodeModel=n,P.iconAnt=E,P.iconAssetUrl=S,P.isFirstNode=w,P.creationMode=M,P.storylineNodeModel.node.type){case"DISPLAY_CAMPAIGN":P.editFormComponent=i.default;break;case"EMAIL_CAMPAIGN":P.editFormComponent=c.default;break;case"ADD_TO_SEGMENT_NODE":P.editFormComponent=f.default;break;case"DELETE_FROM_SEGMENT_NODE":P.editFormComponent=p.default;break;case"ABN_NODE":P.editFormComponent=s.default;break;case"QUERY_INPUT":"REACT_TO_EVENT_STANDARD"===P.creationMode||"REACT_TO_EVENT_ADVANCED"===P.creationMode?P.editFormComponent=m.default:P.editFormComponent=u.default;break;case"ON_SEGMENT_ENTRY_INPUT_NODE":P.editFormComponent=g.default;break;case"ON_SEGMENT_EXIT_INPUT_NODE":P.editFormComponent=y.default;break;case"WAIT_NODE":P.editFormComponent=d.default;break;case"IF_NODE":P.editFormComponent=u.default;break;case"CUSTOM_ACTION_NODE":P.editFormComponent=h.default;break;case"SCENARIO_AUDIENCE_SEGMENT_FEED_NODE":P.editFormComponent=v.default;break;default:P.editFormComponent=l.default}return P}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"getSize",value:function(){return{width:50,height:50,borderWidth:2}}},{key:"getNodeSize",value:function(){return{width:180,height:90}}},{key:"getColor",value:function(){return this.color}}]),t}(r.NodeModel);t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({dropdownAddProcessingActivity:{id:"settings.datamart.processings.section.add",defaultMessage:"Add Processing Activity"},processingActivitiesForChannelsSectionSubtitle:{id:"settings.datamart.processings.forChannels.section.subtitle",defaultMessage:"Select the Processing Activities on behalf of which you are capturing personal data on this channel. mediarithmics platform will automatically check the related User Choices before storing the captured data."},processingActivitiesForCompartmentsSectionSubtitle:{id:"settings.datamart.processings.forCompartments.section.subtitle",defaultMessage:"Select the Processing Activities on behalf of which you are capturing personal data on this compartment. mediarithmics platform will automatically check the related User Choices before storing the captured data."},processingActivitiesForSegmentsSectionSubtitle:{id:"settings.datamart.processings.forSegments.section.subtitle",defaultMessage:"Select the Processing Activities on behalf of which you are creating this audience segment. mediarithmics platform will automatically take the related User Choices into account to include or exclude them from the segment."},processingActivitiesForChannelsOrCompartmentsSectionTitle:{id:"settings.datamart.processings.forChannelsOrCompartments.section.title",defaultMessage:"User Choices - Privacy Wall"},processingActivitiesForSegmentsSectionTitle:{id:"settings.datamart.processings.forSegments.section.title",defaultMessage:"User Choices"},processingActivitiesEmptySection:{id:"settings.datamart.processings.section.empty",defaultMessage:"There is no Processing Activity selected yet!"},processingActivitiesForEdge:{id:"settings.datamart.processings.section.edge",defaultMessage:"This feature is not available for Edge segments."},processingActivitiesSelectorColumnName:{id:"settings.datamart.processings.selector.columns.name",defaultMessage:"Name"},processingActivitiesSelectorColumnLegalBasis:{id:"settings.datamart.processings.selector.columns.legalBasis",defaultMessage:"Legal Basis"},processingActivitiesSelectorTitle:{id:"settings.datamart.processings.selector.title",defaultMessage:"Select Processing Activities"},processingActivitiesSelectorSearchPlaceholder:{id:"settings.datamart.processings.selector.search.placeholder",defaultMessage:"Search Processing Activities"},warningProcessingActivitiesForChannels:{id:"settings.datamart.processings.warning",defaultMessage:"Danger Zone: When you link a Channel to a Processing Activity, the platform allows the storage of User Events if and only if the User Choices allow it. Therefore, to avoid unwanted data loss, you must be sure that User Choices are captured properly before doing so."},addToSegmentAutomationSectionSubtitle:{id:"settings.datamart.processings.forAddToSegmentAutomationNode.section.subtitle",defaultMessage:"If your segment is subject to user consent, you can automate whether or not users should be included in the segment by linking it to a Processing Activity. Processing Activities can be managed in your {organisationSettings}."},organisationSettings:{id:"settings.datamart.processings.forAddToSegmentAutomationNode.section.subtitle.organisationSettings",defaultMessage:"organisation settings"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));var o=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={iframeHeight:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this;return r.createElement("div",null,r.createElement("iframe",{sandbox:"allow-same-origin",scrolling:"no",style:{width:"100%",height:this.state.iframeHeight,margin:0,padding:0,border:"none"},ref:function(t){if(t&&t.contentDocument&&t.contentDocument.body&&t.contentDocument.documentElement){t.contentDocument.body.innerHTML=e.props.content;var n=t.contentDocument.body,a=t.contentDocument.documentElement;setTimeout((function(){var t=Math.max(n.scrollHeight,n.offsetHeight,a.clientHeight,a.scrollHeight,a.offsetHeight);e.state.iframeHeight!==t&&e.setState({iframeHeight:t})}),500)}}}))}}]),t}(r.Component);t.default=o},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),l=n(10),c=n(6),u=n(834),d=(a=u)&&a.__esModule?a:{default:a},f=n(11),p=n(15),m=n(12);var g=function(e,t,n,a){var r,o=arguments.length,s=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},y=l.Select.Option,h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onIdChange=function(e){var t=n.props.type;n.setState({id:e}),"formAdLayout"===t?n.getNewAdlayoutVersion(e):"stylesheet"===t&&n.getNewStyleSheetsVersion(e)},n.onVersionChange=function(e){n.setState({selectedVersion:e})},n.delete=function(){var e=n.props.input;n.setState({open:!1,id:"",selectedVersion:""}),e.onChange({})},n.onConfirm=function(){var e=n.props.input,t=n.state,a=t.id,r=t.selectedVersion;if(a&&r){var o={id:a,version:r};e.onChange(o),n.setState({open:!1})}},n.showModal=function(){n.setState({open:!0,id:"",selectedVersion:""})},n.closeModal=function(){n.setState({open:!1})},n.getAdLayouts=function(e,t){var a=n.props.options.disabled;n._pluginService.getAdLayouts(e,t).then((function(e){return e.data})).then((function(e){n.setState({elements:e?e.map((function(e){return{key:e.id,disabled:a,value:e.id,name:e.name,title:e.name+" ("+e.id+")",text:e.name+" ("+e.id+")"}})):[]})}))},n.getStylesheets=function(e){var t=n.props.options.disabled;n._pluginService.getStyleSheets(e).then((function(e){return e.data})).then((function(e){n.setState({elements:e?e.map((function(e){return{key:e.id,disabled:t,value:e.id,name:e.name,title:e.name+" ("+e.id+")",text:e.name+" ("+e.id+")"}})):[]})}))},n.getNewAdlayoutVersion=function(e){var t=n.props.options,a=t.disabled,r=t.organisationId;n.setState({loading:!0}),n._pluginService.getAdLayoutVersion(r,e).then((function(e){return e.data})).then((function(e){n.setState({pluginVersions:e.map((function(e){var t=e.filename+" "+(e.filename?"-":"")+" "+e.status+" ("+e.id+")";return{key:e.id,disabled:a,value:e.id,title:t,text:t}}))})})).then((function(){n.setState({loading:!1})}))},n.getNewStyleSheetsVersion=function(e){var t=n.props.options,a=t.disabled,r=t.organisationId;n.setState({loading:!0}),n._pluginService.getStyleSheetsVersion(r,e).then((function(e){return e.data})).then((function(e){n.setState({pluginVersions:e.map((function(e){var t=e.description+" "+(e.description?"-":"")+" "+e.status+" ("+e.id+")";return{key:e.id,disabled:a,value:e.id,title:t,text:t}}))})})).then((function(){n.setState({loading:!1})}))},n.state={open:!1,loading:!1,id:e.input&&e.input.value&&e.input.value.id?e.input.value.id:"",selectedVersion:e.input&&e.input.value&&e.input.value.version?e.input.value.version:"",pluginVersions:[],elements:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.options,n=t.pluginVersionId,a=t.organisationId,r=e.type;"formAdLayout"===r?this.getAdLayouts(a,n):"stylesheet"===r&&this.getStylesheets(a)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.options,a=n.pluginVersionId,r=n.organisationId,o=t.type,i=e.options,s=i.pluginVersionId,l=i.organisationId;a===s&&r===l||("formAdLayout"===o?this.getAdLayouts(r,a):"stylesheet"===o&&this.getStylesheets(r))}},{key:"render",value:function(){var e=this.props,t=e.input,n=e.options.disabled,a=e.type,o=this.state,i=o.open,u=o.loading,p=o.elements,m=o.pluginVersions,g=void 0;t&&t.value&&(g=(p.find((function(e){return e.value===t.value.id}))||{}).title);var h=void 0,v=void 0,b=void 0,_=void 0,S=void 0,E=void 0;return"formAdLayout"===a?(h=s.createElement(c.FormattedMessage,d.default.adLayoutButtonChange),v=s.createElement(c.FormattedMessage,d.default.adLayoutButtonChoose),b=s.createElement(c.FormattedMessage,d.default.adLayoutModalTitle),_=s.createElement(c.FormattedMessage,d.default.adLayoutModalElement),S=s.createElement(c.FormattedMessage,d.default.adLayoutModalLabel),E=s.createElement(c.FormattedMessage,d.default.noAdLayoutSelected)):(h=s.createElement(c.FormattedMessage,d.default.styleSheetButtonChange),v=s.createElement(c.FormattedMessage,d.default.styleSheetButtonChoose),b=s.createElement(c.FormattedMessage,d.default.styleSheetModalTitle),_=s.createElement(c.FormattedMessage,d.default.styleSheetModalElement),S=s.createElement(c.FormattedMessage,d.default.styleSheetModalVersions),E=s.createElement(c.FormattedMessage,d.default.noStyleSheetSelected)),s.createElement("div",null,s.createElement(l.Button,{onClick:this.showModal,disabled:n},t.value&&t.value.id?h:v),s.createElement(l.Modal,{title:b,visible:i,onOk:this.onConfirm,onCancel:this.closeModal,confirmLoading:u,maskClosable:!1},p&&p.length?s.createElement("div",null,_,s.createElement(l.Select,{style:{width:"100%"},onChange:this.onIdChange,onSelect:this.onIdChange,value:this.state.id},p.map((function(e){var t=e.value,n=e.title,a=e.key;return s.createElement(y,r({value:t,title:n},{key:a}),n)})))):null,s.createElement("br",null),m&&m.length&&!u?s.createElement("div",null,S,s.createElement(l.Select,{style:{width:"100%"},onChange:this.onVersionChange,value:this.state.selectedVersion},m.map((function(e){var t=e.value,n=e.title,a=e.key;return s.createElement(y,r({value:t,title:n},{key:a}),n)})))):null),s.createElement("span",{style:{marginLeft:"20px"}},g?s.createElement("span",null,g,s.createElement(f.Button,{onClick:this.delete,style:{verticalAlign:"bottom",marginLeft:"5px"}},s.createElement(f.McsIcon,{type:"delete",className:"big"}))):E))}}]),t}(s.Component);g([(0,p.lazyInject)(m.TYPES.IPluginService)],h.prototype,"_pluginService",void 0),t.default=(0,c.injectIntl)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(0,n(6).defineMessages)({save:{id:"automation.builder.node.FeedNodeForm.save.button",defaultMessage:"Update"},sectionGeneralTitle:{id:"automation.builder.node.FeedNodeForm.general.title",defaultMessage:"General information"},nameFieldLabel:{id:"automation.builder.node.FeedNodeForm.nameField.label",defaultMessage:"Name"},nameFieldTitle:{id:"automation.builder.node.FeedNodeForm.nameField.title",defaultMessage:"The name that will be used to identify this feed preset and the feeds created with it."},nameFieldPlaceholder:{id:"automation.builder.node.FeedNodeForm.nameField.placeholder",defaultMessage:"Name"},descriptionFieldLabel:{id:"automation.builder.node.FeedNodeForm.descriptionField.label",defaultMessage:"Description"},descriptionFieldTitle:{id:"automation.builder.node.FeedNodeForm.descriptionField.title",defaultMessage:"A description of the feed preset to help understand what this preset is about."},descriptionFieldPlaceholder:{id:"automation.builder.node.FeedNodeForm.descriptionField.placeholder",defaultMessage:"Description"},nameFieldTitleWarning:{id:"automation.builder.node.FeedNodeForm.nameField.title.warning",defaultMessage:"Warning: This name is only used in the platform, it won't be visible on the external system."},descriptionFormSectionTitle:{id:"automation.builder.node.FeedNodeForm.descriptionFormSection.title",defaultMessage:"Description"},descriptionFormSectionSubtitle:{id:"automation.builder.node.FeedNodeForm.descriptionFormSection.subtitle",defaultMessage:"Using feeds you can synchronize your data with third party receivers. Any user going through this component will be sent to the configured third party."}});t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"simple"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"setColor",value:function(e){this.color=e,this.iterateListeners((function(t,n){t.colorChanged&&t.colorChanged(Object.assign(Object.assign({},n),{color:e}))}))}}]),t}(n(89).LinkModel);t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(89),i=n(274),s=(a=i)&&a.__esModule?a:{default:a};var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"drop-node"));if(a.collapsed=!1,a.negation=!1,a.getPosition=function(){return{x:a.x,y:a.y}},void 0===e)throw new Error("Missing parameters");return a.addPort(new s.default("center")),a.addPort(new s.default("right")),a.color="#919191",a.dropNode=e,a.height=n||80,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"getNodeSize",value:function(){return{width:20,height:20,borderWidth:1}}},{key:"getColor",value:function(){return this.color}}]),t}(o.NodeModel);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=w(n(139)),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(6),c=n(25),u=n(13),d=n(8),f=w(n(23)),p=w(n(1097)),m=n(65),g=n(15),y=n(12),h=n(300),v=w(n(2333)),b=n(51),_=n(11),S=n(73),E=n(221),O=n(112);function w(e){return e&&e.__esModule?e:{default:e}}var M=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},P=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.checkReactToEvent=function(){var e=n.props.notifyError;n.setState({disableReactToEvent:!0,isCheckingReactToEventAvailable:!0});var t=n.getSelectedDatamart();t&&n._runtimeSchemaService.getRuntimeSchemas(t.id).then((function(e){var a=e.data.find((function(e){return"LIVE"===e.status}));if(a)return n._runtimeSchemaService.getObjectTypes(t.id,a.id).then((function(e){var r=e.data;return(0,O.reducePromises)((0,E.getValidObjectTypesForWizardReactToEvent)(r).map((function(e){return n._runtimeSchemaService.getFields(t.id,a.id,e.id).then((function(t){var n=t.data;return{objectType:e,validFields:(0,E.getValidFieldsForWizardReactToEvent)(e,n)}}))}))).then((function(e){E.wizardValidObjectTypes.find((function(t){return!!e.find((function(e){return e.objectType.name===t.objectTypeName&&!!e.validFields.find((function(e){return e.name===t.fieldName}))}))}))&&n.setState({disableReactToEvent:!1,isCheckingReactToEventAvailable:!1})}))}))})).then((function(){n.setState({isCheckingReactToEventAvailable:!1})})).catch((function(t){e(t),n.setState({isCheckingReactToEventAvailable:!1})}))},n.saveAutomation=function(e){var t=n.props,a=t.intl,r=t.notifyError,o=t.match.params.organisationId,i=n.state.automationFormData,l=s.message.loading(a.formatMessage(T.savingInProgress),0);n.setState({isLoading:!0}),n._automationFormService.validateAutomation(e.automationTreeData).then((function(){return n._automationFormService.saveOrCreateAutomation(o,e,i).then((function(e){l(),n.setState({isLoading:!1}),n.redirect(e.data.id),s.message.success(a.formatMessage(T.automationSaved))})).catch((function(e){n.setState({isLoading:!1}),r(e),l()}))})).catch((function(e){n.setState({isLoading:!1}),s.message.error(a.formatMessage(e)),l()}))},n.redirect=function(e){var t=n.props,a=t.history,r=t.match.params.organisationId,o=e?"/v2/o/"+r+"/automations/"+e:"/v2/o/"+r+"/automations";return a.push(o)},n.hasSelectedType=function(e){var t=(0,h.generateInitialAutomationData)(e);n.setState({type:e,automationFormData:t})},n.getSelectedDatamart=function(){var e=n.props,t=e.location,a=void 0,r=e.connectedUser.workspaces.find((function(e){return e.organisation_id===n.props.match.params.organisationId})),i=o.default.parse(t.search).datamartId;return void 0!==r&&r.datamarts&&1===r.datamarts.length&&(a=r.datamarts[0]),i&&void 0!==r&&(a=r.datamarts.find((function(e){return e.id===i}))),a},n.state={isLoading:!1,isCheckingReactToEventAvailable:!1,automationFormData:h.INITIAL_AUTOMATION_DATA,disableReactToEvent:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.automationId;t&&(this.setState({isLoading:!0}),this._automationFormService.loadInitialAutomationValues(t).then((function(t){e.setState({automationFormData:t,isLoading:!1})})))}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,a=n.location,r=n.match.params.automationId,i=n.hasFeature,s=e.location,l=e.match.params.automationId;o.default.parse(a.search).datamartId!==o.default.parse(s.search).datamartId&&i("automations-wizard-react-to-event")&&this.checkReactToEvent(),r||r===l?r&&r!==l&&(this.setState({isLoading:!0}),this._automationFormService.loadInitialAutomationValues(r).then((function(e){t.setState({automationFormData:e,isLoading:!1})}))):this.setState({automationFormData:h.INITIAL_AUTOMATION_DATA})}},{key:"render",value:function(){var e=this,t=this.props,n=t.location,a=t.intl,r=t.history,l=this.state,c=l.automationFormData,u=l.isLoading,d=l.type,f=l.disableReactToEvent,g=l.isCheckingReactToEventAvailable,y=this.getSelectedDatamart();return y?d?i.createElement(p.default,{datamartId:y.id,automationFormData:c,saveOrUpdate:this.saveAutomation,loading:u,creation_mode:"REACT_TO_EVENT"===d?"REACT_TO_EVENT_STANDARD":"QUERY"}):g?i.createElement(s.Layout,null,i.createElement(_.Actionbar,{paths:[{name:a.formatMessage(T.automationBuilder)}]}),i.createElement(b.Loading,{isFullScreen:!1})):i.createElement(v.default,{onSelectTemplate:this.hasSelectedType,disableReactToEvent:f,actionbarProps:{paths:[{name:a.formatMessage(T.automationBuilder)}]}}):i.createElement(m.DatamartSelector,{onSelect:function(t){e.setState({type:void 0},(function(){r.push({pathname:n.pathname,search:o.default.stringify({datamartId:t.id})})}))},actionbarProps:{paths:[{name:a.formatMessage(T.automationBuilder)}]},isMainlayout:!0})}}]),t}(i.Component);M([(0,g.lazyInject)(y.TYPES.IAutomationFormService)],P.prototype,"_automationFormService",void 0),M([(0,g.lazyInject)(y.TYPES.IRuntimeSchemaService)],P.prototype,"_runtimeSchemaService",void 0),t.default=(0,d.compose)(l.injectIntl,u.withRouter,f.default,S.injectFeatures,(0,c.connect)((function(e){return{connectedUser:e.session.connectedUser}})))(P);var T=t.messages=(0,l.defineMessages)({newAutomation:{id:"automation.builder.page.actionbar.new.automation",defaultMessage:"New Automation"},automationBuilder:{id:"automation.builder.page.actionbar.title",defaultMessage:"Automation Builder"},savingInProgress:{id:"automation.builder.page.actionbar.save.in.progress",defaultMessage:"Saving in progress"},automationSaved:{id:"automation.builder.page.automation.saved",defaultMessage:"Automation Saved"},saveAutomation:{id:"automation.builder.page.actionBar.save",defaultMessage:"Save"},updateAutomation:{id:"automation.builder.page.actionBar.update",defaultMessage:"Update"},editAutomation:{id:"automation.builder.page.actionBar.edit",defaultMessage:"Edit"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({setStatus:{id:"automation.list.setStatus",defaultMessage:"Set status to"},pauseAutomation:{id:"automation.list.pause",defaultMessage:"Pause"},activateAutomation:{id:"automation.list.activate",defaultMessage:"Activate"},automationListTitle:{id:"automations.list.title",defaultMessage:"Automations"},activeAll:{id:"automations.list.activeAll",defaultMessage:"Active"},pauseAll:{id:"automations.list.pauseAll",defaultMessage:"Paused"},searchScenarios:{id:"automations.list.search.placeholder",defaultMessage:"Search automation"},automationModalConfirmDeletionTitle:{id:"automation.modal.confirm.deletion.title",defaultMessage:"Are you sure to delete this automation ?"},automationModalConfirmDeletionContent:{id:"automation.modal.confirm.deletion.content",defaultMessage:"By deleting this automation, you won't be able to recover the related campaigns. Are you sure you wan't to continue ?"},deleteAutomation:{id:"automation.delete.ok",defaultMessage:"Delete"},automationModalConfirmDeletionCancel:{id:"automation.modal.confirm.cancel",defaultMessage:"Cancel"}})},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.audienceRoutes=t.audienceDefinition=void 0;var a=n(2364),r=n(2368),o=n(2376),i=y(n(2413)),s=y(n(2419)),l=n(185),c=n(2444),u=n(2450),d=y(n(2454)),f=y(n(1133)),p=n(2455),m=y(n(1134)),g=n(2458);function y(e){return e&&e.__esModule?e:{default:e}}var h=t.audienceDefinition={audienceHome:{path:"/audience/home",layout:"main",contentComponent:d.default,requiredFeature:"audience-dashboards",requireDatamart:!0},audienceSegmentList:{path:"/audience/segments",layout:"main",contentComponent:a.AudienceSegmentsTable,actionBarComponent:a.SegmentsActionbar,requiredFeature:"audience-segments",requireDatamart:!0},audienceFeedList:{path:"/audience/feeds/list",layout:"main",contentComponent:p.AudienceFeedsTable,actionBarComponent:f.default,requiredFeature:"audience-feeds",requireDatamart:!0},audienceFeedOverview:{path:"/audience/feeds",layout:"main",contentComponent:g.AudienceFeedsOverview,actionBarComponent:m.default,requiredFeature:"audience-feeds",requireDatamart:!0},audienceSegmentCreation:{path:"/audience/segments/create",layout:"edit",editComponent:r.EditAudienceSegmentPage,requiredFeature:"audience-segments",requireDatamart:!0},audienceSegmentEdit:{path:"/audience/segments/:segmentId/edit",layout:"edit",editComponent:r.EditAudienceSegmentPage,requiredFeature:"audience-segments",requireDatamart:!0},audienceSegmentDashboard:{path:"/audience/segments/:segmentId",layout:"main",contentComponent:o.AudienceSegmentPage,requiredFeature:"audience-segments",requireDatamart:!0},feedCreate:{path:"/audience/segments/:segmentId/feeds/create",layout:"edit",editComponent:i.default,requiredFeature:"audience-segments",requireDatamart:!0},feedEdit:{path:"/audience/segments/:segmentId/feeds/:feedType/:feedId/edit",layout:"edit",editComponent:i.default,requiredFeature:"audience-segments",requireDatamart:!0},audienceSegmentBuilder:{path:"/audience/segment-builder",layout:"main",contentComponent:c.SegmentBuilderPage,requiredFeature:"audience-segment_builder",requireDatamart:!0},audienceSegmentBuilderV2:{path:"/audience/segment-builder-v2",layout:"main",contentComponent:u.AudienceBuilderPage,requiredFeature:"audience-segment_builder_v2",requireDatamart:!0},audienceTimeline:{path:"/audience/timeline/:identifierType/:identifierId",layout:"main",contentComponent:s.default,requiredFeature:"audience-monitoring",requireDatamart:!0},audienceTimelineHome:{path:"/audience/timeline",layout:"main",contentComponent:s.default,requiredFeature:"audience-monitoring",requireDatamart:!0}};t.audienceRoutes=(0,l.generateRoutesFromDefinition)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SEGMENT_SETTINGS=t.SEGMENTS_SEARCH_SETTINGS=void 0;var a=n(30);function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.SEGMENTS_SEARCH_SETTINGS=[].concat(r(a.PAGINATION_SEARCH_SETTINGS),r(a.KEYWORD_SEARCH_SETTINGS),r(a.LABELS_SEARCH_SETTINGS),r(a.DATAMART_SEARCH_SETTINGS),r(a.SORT_SEARCH_SETTINGS),[{paramName:"type",defaultValue:[],deserialize:function(e){return e.type?e.type.split(","):[]},serialize:function(e){return e.join(",")},isValid:function(e){return!e.type||e.type.split(",").length>0}},{paramName:"feed_type",defaultValue:[],deserialize:function(e){return e.feed_type?e.feed_type.split(","):[]},serialize:function(e){return e.join(",")},isValid:function(e){return!e.feed_type||e.feed_type.split(",").length>0}}]),t.SEGMENT_SETTINGS=[].concat(r(a.DATE_SEARCH_SETTINGS))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(33),i=y(n(2381)),s=n(340),l=y(n(2382)),c=y(n(2409)),u=n(8),d=n(6),f=n(228),p=n(11),m=y(n(2410)),g=y(n(2412));function y(e){return e&&e.__esModule?e:{default:e}}var h=t.messages=(0,d.defineMessages)({ABComparison:{id:"audience.segments.dashboard.ABComparisonDashboard.title",defaultMessage:"A/B Comparison"},ABDetails:{id:"audience.segments.dashboard.ABComparisonDashboard.details",defaultMessage:"A/B Details"},experimentation:{id:"audience.segments.dashboard.ABComparisonDashboard.experimentation",defaultMessage:"Experimentation"},controlGroup:{id:"audience.segments.dashboard.ABComparisonDashboard.controlGroup",defaultMessage:"Control Group"}}),v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.buildExperimentationItems=function(e){var t=n.props,a=t.intl,o=t.isLoading,i=t.datamarts,s=t.controlGroupSegment;return[{title:a.formatMessage(h.ABComparison),display:r.createElement(m.default,{experimentationSegment:e,controlGroupSegment:s})},{title:a.formatMessage(h.ABDetails),display:r.createElement(g.default,{experimentationSegment:e,controlGroupSegment:s})},{title:a.formatMessage(h.experimentation),display:r.createElement(l.default,{segment:e,isLoading:o,datamarts:i})}]},n.renderDashboard=function(){var e=n.props,t=e.datamarts,a=e.segment,o=e.isLoading;return a&&(0,f.isUserQuerySegment)(a)&&"AB_TESTING_EXPERIMENT"===a.subtype?r.createElement(p.McsTabs,{items:n.buildExperimentationItems(a)}):r.createElement(l.default,{segment:a,isLoading:o,datamarts:t})},n.state={isLoadingControlGroup:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.match.params,n=t.segmentId,a=t.organisationId,o=e.isLoading,l=e.segment;return r.createElement("div",null,r.createElement(i.default,{isLoading:o,segment:l}),r.createElement(s.Labels,{labellableId:n,labellableType:"SEGMENT",organisationId:a}),l&&l.short_description&&r.createElement("div",{className:"mcs-audienceSegmentDashboard_description"},l.short_description),r.createElement(c.default,{isFetching:o,segment:l}),this.renderDashboard())}}]),t}(r.Component);t.default=(0,u.compose)(o.withRouter,d.injectIntl)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=h(n(2389)),l=h(n(1119)),c=n(13),u=n(8),d=n(12),f=n(15),p=n(11),m=n(56),g=n(83),y=n(73);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchFeeds=function(e){n.setState({isLoading:!0});var t=n._audienceSegmentService.getAudienceExternalFeeds(e).then((function(e){return e.data})),a=n._audienceSegmentService.getAudienceTagFeeds(e).then((function(e){return e.data}));return Promise.all([t,a]).then((function(e){var t=e[0].map((function(e){return Object.assign(Object.assign({},e),{type:"EXTERNAL_FEED"})})),a=e[1].map((function(e){return Object.assign(Object.assign({},e),{type:"TAG_FEED"})})),r=t;a.forEach((function(e){return r.push(e)})),n.setState({isLoading:!1,feeds:r.sort((function(e,t){return e.id.localeCompare(t.id)}))})}))},n.onFeedDelete=function(e){var t=n.state.feeds.filter((function(t){return!(t.id===e.id&&t.artifact_id===e.artifact_id)}));n.setState({feeds:t})},n.onFeedUpdate=function(e){var t=n.state.feeds.map((function(t){return t.id===e.id&&t.artifact_id===e.artifact_id?e:t}));n.setState({feeds:t})},n.getRef=function(e){var t=n.state.shouldScrollWhenLoaded;e&&t&&(e.scrollIntoView({block:"end",behavior:"smooth",inline:"end"}),n.setState({shouldScrollWhenLoaded:!1}))},n.fetchFeedsStats=function(){var e=n.props.match.params,t=e.segmentId,a=e.organisationId;return n._feedsStatsService.getSegmentStats(a,t).then((function(e){var t=(0,m.normalizeReportView)(e.data.report_view),a=(0,g.normalizeArrayOfObject)(t,"feed_id");return n.state.feeds.forEach((function(e){a[e.id]||(a[e.id]={feed_id:e.id,uniq_user_points_count:0,uniq_user_identifiers_count:0})})),n.setState({feedsStatsByFeedId:a})}))},n.state={isLoading:!0,feeds:[],shouldScrollWhenLoaded:!(!e.location.state||!e.location.state.scrollToFeed),feedsStatsByFeedId:{}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.segmentId,n=e.hasFeature;t&&(this.fetchFeeds(t),n("audience-feeds_stats")&&this.fetchFeedsStats())}},{key:"componentDidUpdate",value:function(e){var t=this.props.match.params.segmentId;t!==e.match.params.segmentId&&this.fetchFeeds(t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params,a=n.segmentId,r=n.organisationId,c=t.hasFeature,u=this.state,d=u.feeds,f=u.isLoading,m=u.feedsStatsByFeedId;return f?o.createElement(i.Row,{gutter:24},o.createElement(i.Col,{span:8},o.createElement(l.default,null)),o.createElement(i.Col,{span:8},o.createElement(l.default,null)),o.createElement(i.Col,{span:8},o.createElement(l.default,null))):o.createElement("div",{ref:this.getRef},c("audience-dashboards")&&d.length>=1&&o.createElement(p.ContentHeader,{title:"Feed Card List",size:"medium"}),o.createElement(i.Row,{gutter:24},d&&d.map((function(t){return o.createElement(i.Col,{span:8,key:""+t.id+t.artifact_id},o.createElement(s.default,{feed:t,onFeedDelete:e.onFeedDelete,onFeedUpdate:e.onFeedUpdate,segmentId:a,organisationId:r,exportedUserPointsCount:m[t.id]?m[t.id].uniq_user_points_count:void 0,exportedUserIdentifiersCount:m[t.id]?m[t.id].uniq_user_identifiers_count:void 0}))}))))}}]),t}(o.Component);v([(0,f.lazyInject)(d.TYPES.IAudienceSegmentService)],b.prototype,"_audienceSegmentService",void 0),v([(0,f.lazyInject)(d.TYPES.IFeedsStatsService)],b.prototype,"_feedsStatsService",void 0),t.default=(0,u.compose)(c.withRouter,y.injectFeatures)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(11);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){function t(){return i(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){return r.createElement(o.Card,{className:"hoverable-card actionable-card compact feed-card"},r.createElement("hr",null),r.createElement("div",{className:"wrapper"},r.createElement("div",{className:"card-header"},r.createElement("div",{className:"image-placeholder"}),r.createElement("div",{className:"title"},r.createElement("i",{className:"mcs-table-cell-loading"}))),r.createElement("div",{className:"content"},r.createElement("div",null,r.createElement("i",{className:"mcs-table-cell-loading"}))),r.createElement("div",{className:"actions"},r.createElement("i",{className:"mcs-table-cell-loading"}))))}}]),t}(r.Component);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(824),i=y(n(2393)),s=y(n(153)),l=n(30),c=n(229),u=n(13),d=n(8),f=y(n(422)),p=y(n(69)),m=n(54),g=y(n(47));function y(e){return e&&e.__esModule?e:{default:e}}var h=(0,o.WidthProvider)(o.Responsive),v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._cuid=g.default,n._lastFilterColor="#000",n.generateDOM=function(e,t,a,o){return e.map((function(e,l){return r.createElement(s.default,{title:e.tabMode?void 0:e.title,key:e.layout.i&&e.layout.i.toString(),className:e.layout.static?"static mcs-datamartUsersAnalytics_card":"mcs-datamartUsersAnalytics_card",style:e.tabMode?{boxShadow:"none"}:{borderLeft:"5px solid "+e.color}},e.charts.map((function(s){return r.createElement(i.default,{key:e.layout.i&&e.layout.i.toString(),chart:s,datamartId:t,dateRange:a,onChange:o,segmentId:e.segments?e.segments.baseSegmentId:void 0,segmentName:e.segments?e.segments.baseSegmentName:void 0,compareWithSegmentName:e.segments?e.segments.segmentToCompareWithName:void 0,compareWithSegmentId:e.segments?e.segments.segmentIdToCompareWith:void 0,segmentToAggregate:n.props.segmentToAggregate})})))}))},n.state={formattedConfig:[],segmentsFilters:[],allUsersConfig:[],allUsersFilter:!0,filterColors:[],allUsersFilterColor:e.colors["mcs-primary"],lastFilterColor:n._lastFilterColor,generatedDom:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.config,n=e.colors,a=e.datamartId,r=e.onChange,o=e.dateRange,i=this.state,s=i.allUsersFilterColor,l=i.lastFilterColor,c=[],u=!0,d=!1,p=void 0;try{for(var m,g=t[Symbol.iterator]();!(u=(m=g.next()).done);u=!0){var y=m.value,h=Object.assign(Object.assign({},y),{color:y.color||s,layout:Object.assign(Object.assign({},y.layout),{i:this._cuid()})});c.push(h)}}catch(e){d=!0,p=e}finally{try{!u&&g.return&&g.return()}finally{if(d)throw p}}this.setState({allUsersConfig:c.filter((function(e){return!e.segments})),formattedConfig:c,filterColors:f.default.scale([n["mcs-info"],l]).mode("lch").colors(3),generatedDom:this.generateDOM(c,a,o,r)})}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,a=n.location.search,r=n.config,o=n.datamartId,i=n.onChange,s=n.dateRange,u=this.state,d=u.segmentsFilters,f=u.allUsersFilter,p=u.filterColors,g=u.formattedConfig,y=u.generatedDom,h=u.allUsersConfig,v=(0,l.parseSearch)(a,c.DATAMART_USERS_ANALYTICS_SETTING);if(!(0,m.isEqual)(v.segments,d)){var b=g.slice(),_=[],S=[],E=[];if(d.length<v.segments.length)!function(){var e=b.map((function(e){return e.color})),n=v.segments[d.length],a=JSON.parse(JSON.stringify(h)),r=!0,o=!1,i=void 0;try{for(var s,l=a[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value,u=JSON.parse(JSON.stringify(c.charts));u.map((function(e){"SINGLE_STAT"!==e.type&&(e.options.title=void 0),e.dimensionFilterClauses&&(e.dimensionFilterClauses.operator="AND",e.dimensionFilterClauses.filters.push({dimension_name:"segment_id",not:!1,operator:"EXACT",expressions:[n],case_sensitive:!1}))}));var f={layout:Object.assign(Object.assign({},c.layout),{i:t._cuid()}),title:c.title,charts:u,segments:{baseSegmentId:n},color:e.includes(p[0])?p[1]:p[0]};_.push(f)}}catch(e){o=!0,i=e}finally{try{!r&&l.return&&l.return()}finally{if(o)throw i}}E=b.concat(_)}();else{var O=(0,m.difference)(d,v.segments),w=(E=b.filter((function(e){return!e.segments||e.segments&&e.segments.baseSegmentId!==O[0]}))).map((function(e){return e.layout.i}));S.concat(y.filter((function(e){return w.includes(e.key)})))}this.setState({formattedConfig:E,segmentsFilters:v.segments,generatedDom:S.length>0?S:this.generateDOM(E,o,s,i)})}(0,m.isEqual)(v.allusers,f)||this.setState((function(e){var n=e.formattedConfig.slice(),a=v.allusers?n.concat(h):n.filter((function(e){return e.segments})),r=a.map((function(e){return e.layout.i})),l=v.allusers?t.generateDOM(a,o,s,i):e.generatedDom.filter((function(e){return r.includes(e.key)}));return{formattedConfig:a,allUsersFilter:v.allusers,generatedDom:l}})),e.dateRange.from.value&&e.dateRange.to.value&&(e.dateRange.from.value!==s.from.value||e.dateRange.to.value!==s.to.value)&&this.setState({generatedDom:this.generateDOM(g,o,s,i)}),(0,m.isEqual)(r,e.config)||this.setState({generatedDom:this.generateDOM(r,o,s,i)})}},{key:"render",value:function(){var e=this.state,t=e.formattedConfig,n=e.generatedDom,a=t.map((function(e){return Object.assign({},e.layout)}));return r.createElement(h,{className:"layout mcs-datamartUsersAnalytics_components",layouts:{lg:a},cols:{lg:12,md:12,sm:12,xs:12,xxs:12},isDraggable:!1,isResizable:!1,measureBeforeMount:!1},n)}}]),t}(r.Component);t.default=(0,d.compose)(u.withRouter,p.default)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(41),i=n(10),s=f(n(1122)),l=f(n(422)),c=f(n(69)),u=n(8),d=n(6);function f(e){return e&&e.__esModule?e:{default:e}}var p=(0,d.defineMessages)({allUsers:{id:"audience.segments.datamartUsersAnalytics.segmentFilter.allUsers",defaultMessage:"All Users"},segmentFilterPlaceholder:{id:"audience.segments.datamartUsersAnalytics.segmentFilter.placeholder",defaultMessage:"Select a segment to compare with"}}),m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._lastFilterColor="#000",n.showSegmentSearch=function(){n.setState({segmentSearchDisplayed:!0})},n.onSegmentByNameSelectorChange=function(e){var t=n.state,a=t.appliedSegmentFilters,r=t.filterColors,o=n.props.onChange,i=a.find((function(t){return t.key===e.key})),s=a.map((function(e){return e.color}));i||n.setState((function(t){var n=t.appliedSegmentFilters.concat(Object.assign(Object.assign({},e),{color:e.color||(s.includes(r[0])?r[1]:r[0])})),a=n.slice().map((function(e){return e.key}));return o(a),{appliedSegmentFilters:n,segmentSearchDisplayed:!1}}))},n.removeFilter=function(e){var t=n.props,a=t.onChange,r=t.defaultSegment,o=t.defaultSegmentCanBeRemoved;(e&&!r||r&&r.key!==e||o)&&n.setState((function(t){var n=t.appliedSegmentFilters.filter((function(t){return t.key!==e})),r=n.slice().map((function(e){return e.key}));return a(r),{appliedSegmentFilters:n}}))},n.toggleAllUserFilter=function(){var e=n.props.onToggleAllUsersFilter,t=n.state.allUsersEnabled;e(!t),n.setState({allUsersEnabled:!t})},n.handleOnSegmentNameFilterClick=function(e){return n.removeFilter(e)},n.handleOnAllUserFilterToggle=function(){return n.toggleAllUserFilter()},n.state={segmentSearchDisplayed:!1,appliedSegmentFilters:[],filterColors:[],allUsersEnabled:!0,allUsersFilterColor:e.colors["mcs-primary"],lastFilterColor:n._lastFilterColor},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.colors,n=e.defaultSegment,a=e.disableAllUserFilter,r=e.segmentcolors,o=this.state.lastFilterColor;this.setState({filterColors:r||l.default.scale([t["mcs-info"],o]).mode("lch").colors(3)}),n&&this.onSegmentByNameSelectorChange(Object.assign(Object.assign({},n),{color:r?r[0]:t["mcs-info"]})),a&&this.toggleAllUserFilter()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.defaultSegment,a=t.segmentcolors,r=t.colors,o=e.defaultSegment;!n&&o&&this.removeFilter(o.value),n&&!o&&this.onSegmentByNameSelectorChange(Object.assign(Object.assign({},n),{color:a?a[0]:r["mcs-info"]}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.segmentSearchDisplayed,a=t.appliedSegmentFilters,l=t.allUsersEnabled,c=t.allUsersFilterColor,u=this.props,d=u.className,f=u.datamartId,m=u.organisationId,g=u.hideAllUsersButton,y=u.segmentFiltersLength,h=u.intl,v=u.placeholder,b=u.segmentType,_=y||2;return r.createElement("div",{className:d,id:"mcs-segmentFilter",style:{position:"relative"}},!g&&r.createElement(i.Button,{className:l?"appliedSegmentName":"appliedSegmentName _is_disable",ghost:!0,style:{border:"1px solid "+c},onClick:this.handleOnAllUserFilterToggle},r.createElement("span",{className:"oval",style:{border:"5px solid "+c}}),r.createElement("span",{className:"name"},h.formatMessage(p.allUsers))),a.map((function(t){return r.createElement(i.Button,{key:t.key,className:"appliedSegmentName",ghost:!0,style:{border:"1px solid "+t.color},onClick:e.handleOnSegmentNameFilterClick.bind(e,t.key)},r.createElement("span",{className:"oval",style:{border:"5px solid "+t.color}}),r.createElement("span",{className:"name"},t.label))})),a.length<_&&(n?r.createElement(s.default,{value:[],datamartId:f,organisationId:m,onchange:this.onSegmentByNameSelectorChange,filter:{segmentType:b},anchorId:"mcs-segmentFilter"}):r.createElement(i.Button,{type:"dashed",ghost:!0,className:"segmentFilter",icon:r.createElement(o.PlusOutlined,null),onClick:this.showSegmentSearch},r.createElement("span",{className:"placeholder"},v||h.formatMessage(p.segmentFilterPlaceholder)))))}}]),t}(r.Component);t.default=(0,u.compose)(c.default,d.injectIntl)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(15),s=n(12),l=n(163),c=n(1123),u=(a=c)&&a.__esModule?a:{default:a},d=n(312);var f=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getForKeyword",value:function(e){return this._audienceSegmentService.getSegments(e.organisation_id,e).then((function(e){return e.data.sort((function(e,t){return e.name.localeCompare(t.name)}))}))}}]),e}();f([(0,i.lazyInject)(s.TYPES.IAudienceSegmentService)],p.prototype,"_audienceSegmentService",void 0);var m=new p;var g=(0,u.default)(l.SegmentNameDisplay,(function(e){return{audienceSegmentResource:e}}));t.default=(0,d.ResourceByKeywordSelector)(g,m,"Search segment by name")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.default=function(e,t){return function(n){function l(){return i(this,l),s(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(l,n),r(l,[{key:"render",value:function(){var n=this.props,r=t(n);return o.createElement(e,a({},n,r))}}]),l}(o.Component)}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(35),s=n(8),l=n(10),c=n(6),u=n(24),d=b(n(308)),f=n(160),p=n(628),m=b(n(836)),g=n(61),y=n(11),h=n(13),v=b(n(421));function b(e){return e&&e.__esModule?e:{default:e}}var _=l.Layout.Content,S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.onSubmit=function(e){var t=n.props,a=t.editionMode,r=t.save;!1===a&&(e.id=e.id?e.id:(0,f.generateFakeId)()),r(Object.assign({},e.plugin),n.props.pluginProperties.filter((function(e){return!0===e.writable})).map((function(t){return Object.assign(Object.assign({},t),{value:e.properties[t.technical_name]?e.properties[t.technical_name].value:t.value})})))},n.pluginFieldGenerated=function(){var e=n.props,t=e.disableFields,a=e.organisationId,r=e.pluginVersionId;return e.pluginProperties.map((function(e){return o.createElement(p.PluginFieldGenerator,{key:""+e.technical_name,definition:e,disabled:t,pluginVersionId:r,organisationId:a})}))},n.renderTechnicalName=function(){var e=n.props.intl,t=i.Field;return o.createElement("div",null,o.createElement(y.Button,{className:"optional-section-title",onClick:n.toggleAdvancedSection},o.createElement(y.McsIcon,{type:"settings"}),o.createElement("span",{className:"step-title"},e.formatMessage(m.default.advanced)),o.createElement(y.McsIcon,{type:"chevron"})),o.createElement("div",{className:n.state.displayAdvancedSection?"optional-section-content":"hide-section"},o.createElement(t,{name:"plugin.technical_name",component:d.default,formItemProps:{label:e.formatMessage(m.default.sectionTechnicalName)},inputProps:{placeholder:e.formatMessage(m.default.sectionTechnicalPlaceholder)},helpToolTipProps:{title:e.formatMessage(m.default.sectionTechnicalHelper)}})))},n.generateFormFromPluginLayout=function(e){var t=n.props,a=t.organisationId,r=t.pluginVersionId,i=t.pluginProperties,s=t.disableFields;return e.sections.map((function(t,n){var l=n!==e.sections.length-1,c=null!==t.fields&&0!==t.fields.length,u=null!==t.advanced_fields&&0!==t.advanced_fields.length,d=l&&(c||u);return o.createElement("div",{key:t.title},o.createElement(v.default,{pluginLayoutSection:t,organisationId:a,pluginProperties:i,disableFields:s,pluginVersionId:r}),d?o.createElement("hr",null):null)}))},n.state={loading:!1,displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.formId,r=e.fieldValidators.isRequired,s=e.intl.formatMessage,c=e.disableFields,f=e.showTechnicalName,p=e.showGeneralInformation,g=e.showedMessage,y=e.pluginLayout,h=e.renderSpecificFields,v=i.Field,b={formItemProps:{label:s(m.default.sectionGeneralName),required:!0},inputProps:{placeholder:s(m.default.sectionGeneralPlaceholder),disabled:c},helpToolTipProps:{title:s(m.default.sectionGeneralHelper)}};return o.createElement(l.Layout,null,o.createElement(i.Form,{className:this.state.loading?"hide-section":"edit-layout ant-layout",onSubmit:t(this.onSubmit),id:n},o.createElement(_,{className:"mcs-content-container mcs-form-container ad-group-form",id:n},o.createElement(l.Row,null,o.createElement("span",{className:"ant-col-3"}),o.createElement(u.FormFieldWrapper,null,g)),p?o.createElement("div",null,o.createElement("div",{id:"general"},o.createElement(l.Row,{align:"middle",justify:"space-between",className:"section-header"},o.createElement(u.FormTitle,{title:m.default.sectionGeneralTitle})),o.createElement("div",null,o.createElement(v,a({name:"plugin.name",component:d.default,validate:[r]},b)),h?h(c,"plugin"):null,f?this.renderTechnicalName():null)),o.createElement("hr",null)):null,void 0===y?o.createElement("div",{id:"properties"},o.createElement(l.Row,{align:"middle",justify:"space-between",className:"section-header"},o.createElement(u.FormTitle,{title:m.default.sectionPropertiesTitle})),o.createElement("div",{style:{display:"block"}},this.pluginFieldGenerated())):o.createElement("div",null,this.generateFormFromPluginLayout(y)))))}}]),t}(o.Component);S.defaultProps={editionMode:!1},t.default=(0,s.compose)(c.injectIntl,h.withRouter,g.injectDrawer,(0,i.reduxForm)({form:"pluginForm",enableReinitialize:!0}),u.withValidators)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(11),i=n(65),s=n(8);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=function(e){function t(){l(this,t);var e=c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.onClick=function(t){var n=e.props.onPresetDelete;t.stopPropagation(),n&&n()},e.truncateDescription=function(e){return e&&e.length>65?e.substring(0,65)+"...":e},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"hasRightToDeletePreset",value:function(){var e=this.props.workspace.role;return"ORGANISATION_ADMIN"===e||"COMMUNITY_ADMIN"===e||"CUSTOMER_ADMIN"===e}},{key:"render",value:function(){var e=this,t=this.props,n=t.plugin,a=t.hoverable,i=t.onPresetDelete,s=function(){e.props.onSelect()};return!!n.plugin_layout&&r.createElement("div",{onClick:a?s:void 0,className:"plugin-card"},r.createElement(o.Card,{className:"plugin-card "+n.id+" "+(a?"hoverable":""),onClick:a?s:void 0,type:"flex"},r.createElement("div",{className:"image-placehodlder"},r.createElement("img",{src:void 0!==n.plugin_layout?window.MCS_CONSTANTS.ASSETS_URL+n.plugin_layout.metadata.small_icon_asset_url:void 0}),n.plugin_preset&&this.hasRightToDeletePreset()&&i&&r.createElement("div",{className:"delete-preset",onClick:this.onClick},r.createElement(o.McsIcon,{style:{marginRight:0},type:"close"}))),r.createElement("div",{className:"plugin-title"},n.plugin_preset?n.plugin_preset.name:n.plugin_layout.metadata.display_name),r.createElement("div",{className:"plugin-description"},n.plugin_preset&&n.plugin_preset.description?this.truncateDescription(n.plugin_preset.description):this.truncateDescription(n.plugin_layout.metadata.description)),r.createElement("div",{className:"select-button"},r.createElement(o.Button,{className:"button",onClick:s},"Select"))))}}]),t}(r.Component);t.default=(0,s.compose)(i.injectWorkspace)(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=l(n(0)),o=n(10),i=l(n(17)),s=l(n(839));function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e){return void 0!==e.userAccountId}var f=function(e){function t(){return c(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.profileGlobal,t=d(e)?e.userAccountId:void 0,n=d(e)?e.profile:e,a=function(e){return(0,i.default)(e).format("YYYY-MM-DD, hh:mm:ss")},l={absoluteTemplates:{},relativeTemplates:{$creation_ts:a,$last_modified_ts:a}};return r.default.createElement("div",{className:"single-profile-info"},t&&r.default.createElement("div",{className:"sub-title"},"User Account Id: ",r.default.createElement("br",null),r.default.createElement(o.Tooltip,{title:t},r.default.createElement(o.Tag,{className:"card-tag alone"},t))),r.default.createElement(s.default,{customObject:n,customRenderingTemplates:l}))}}]),t}(r.default.Component);t.default=f,f.defaultProps={profileWithAccountId:{}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),r=n(10),o=n(77),i=n(11);t.default=function(e){var t=e.vectorId,n=e.device;return n&&t?a.createElement(r.Row,{gutter:10,key:t,className:"table-line border-top"},a.createElement(r.Col,{className:"table-left",span:12},a.createElement("span",{style:{float:"left"}},function(e){switch(e){case"TABLET":return a.createElement(i.McsIcon,{type:"tablet"});case"SMARTPHONE":return a.createElement(i.McsIcon,{type:"smartphone"});case"PERSONAL_COMPUTER":return a.createElement(i.McsIcon,{type:"laptop"});default:return a.createElement(o.Icon,{type:"question"})}}(n.form_factor)),a.createElement("span",{style:{float:"left"}},n.browser_family&&a.createElement("span",null,a.createElement("span",{className:"title"}," ",n.browser_family),a.createElement("br",null)," "),a.createElement("span",{className:"subtitle"}," ",n.os_family))),a.createElement(r.Col,{className:"table-right",span:12},a.createElement("span",{style:{float:"right"},className:"subtitle"},t))):null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(10),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(8),l=n(1131),c=f(n(23)),u=f(n(1e3)),d=n(11);function f(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={segmentModalLoading:!1,segmentModalVisible:!1,exportModalLoading:!1,exportModalVisible:!1,conversionModalVisible:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.saveAsExort,a=t.saveAsUserQuery,s=t.convertToOtql,c=t.breadcrumb,f=t.csvExportDisabled,p=function(){return e.setState({conversionModalVisible:!1})},m=o.createElement(r.Menu,{onClick:function(t){"USER_QUERY"===t.key?e.setState({segmentModalVisible:!0}):"EXPORT"===t.key&&e.setState({exportModalVisible:!0})}},o.createElement(r.Menu.Item,{key:"USER_QUERY",disabled:!a},o.createElement(i.FormattedMessage,{id:"queryTool.query-builder-page-actionbar-saveas-segment",defaultMessage:"User Query Segment"})),n&&o.createElement(r.Menu.Item,{key:"EXPORT"},o.createElement(i.FormattedMessage,{id:"queryTool.query-builder-page-actionbar-saveas-export",defaultMessage:"Export"})));return o.createElement(d.Actionbar,{paths:c},o.createElement(r.Dropdown,{overlay:m,trigger:["click"]},o.createElement(r.Button,{className:"mcs-primary",type:"primary"},o.createElement(i.FormattedMessage,{id:"queryTool.query-builder.actionbar.save",defaultMessage:"Save As"}))),s&&o.createElement(r.Button,{onClick:function(){return e.setState({conversionModalVisible:!0})}},o.createElement(i.FormattedMessage,{id:"queryTool.query-builder.actionbar.convert",defaultMessage:"Convert to OTQL"})),s&&this.state.conversionModalVisible&&o.createElement(u.default,{onOk:p,onCancel:p,footer:null,visible:this.state.conversionModalVisible,convertQuery:s}),o.createElement(l.SaveAsUserQuerySegmentModal,{onOk:function(t){e.setState({segmentModalLoading:!0}),a(t).catch((function(t){e.props.notifyError(t),e.setState({segmentModalVisible:!1,segmentModalLoading:!1})}))},onCancel:function(){return e.setState({segmentModalVisible:!1,segmentModalLoading:!1})},visible:this.state.segmentModalVisible,confirmLoading:this.state.segmentModalLoading}),o.createElement(l.SaveAsExportModal,{onOk:function(t){e.setState({exportModalLoading:!0}),n(t).catch((function(t){e.props.notifyError(t),e.setState({exportModalVisible:!1,exportModalLoading:!1})}))},onCancel:function(){return e.setState({exportModalVisible:!1,exportModalLoading:!1})},visible:this.state.exportModalVisible,confirmLoading:this.state.exportModalLoading,csvExportDisabled:f}))}}]),t}(o.Component);t.default=(0,s.compose)(i.injectIntl,c.default)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SaveAsUserQuerySegmentModal=t.SaveAsExportModal=void 0;var a=o(n(2446)),r=o(n(2448));function o(e){return e&&e.__esModule?e:{default:e}}t.SaveAsExportModal=a.default,t.SaveAsUserQuerySegmentModal=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t.withDatamartSelector=function(e){var t=function(t){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));t.assignAvailableDatamart=function(e,n){var a=t.findAvailableDatamarts(e,n);a&&1===a.length?t.setState({datamartId:a[0].id}):t.setState({datamartId:void 0,datafarm:void 0})},t.findAvailableDatamarts=function(e,t){var n=[],a=e.workspaces.find((function(e){return e.organisation_id===t}));return a&&(n=a.datamarts),n},t.onSelectDatamart=function(e){t.setState({datamartId:e.id,datafarm:e.datafarm})};var a=t.findAvailableDatamarts(e.connectedUser,e.match.params.organisationId);return t.state={datamartId:a&&1===a.length?a[0].id:void 0,datafarm:a&&1===a.length?a[0].datafarm:void 0},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,t),r(n,[{key:"componentDidMount",value:function(){this.assignAvailableDatamart(this.props.connectedUser,this.props.match.params.organisationId)}},{key:"componentDidUpdate",value:function(e,t){e.match.params.organisationId!==this.props.match.params.organisationId&&this.assignAvailableDatamart(this.props.connectedUser,this.props.match.params.organisationId)}},{key:"render",value:function(){var t=this,n=this.props,r=n.connectedUser,i=n.match.params.organisationId,s=this.state,l=s.datamartId,p=s.datafarm;if(!l){var m=this.findAvailableDatamarts(r,i);return o.createElement(c.Layout,null,o.createElement(c.Layout.Content,{className:"mcs-content-container mcs-form-container text-center"},o.createElement(d.FormTitle,{title:f.title,subtitle:f.subTitle}),o.createElement(c.Row,{className:"mcs-selector_container"},o.createElement(c.Row,{className:"menu"},m.map((function(e){return o.createElement(u.MenuList,{key:e.id,title:e.name||e.token,select:function(){return t.onSelectDatamart(e)}})}))))))}var g={selectedDatamartId:l,selectedDatafarm:p,connectedUser:r};return o.createElement(e,a({},this.props,g))}}]),n}(o.Component);return(0,s.compose)(i.withRouter,(0,l.connect)((function(e){return{connectedUser:e.session.connectedUser}})))(t)};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(8),l=n(25),c=n(10),u=n(11),d=n(24);var f=(0,n(6).defineMessages)({title:{id:"datamart_selector.title",defaultMessage:"Datamarts"},subTitle:{id:"datamart_selector.subtitle",defaultMessage:"Choose your datamart"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(65),l=v(n(23)),c=n(8),u=v(n(142)),d=n(10),f=n(30),p=n(841),m=n(15),g=n(12),y=v(n(796)),h=n(11);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.buildApiSearchFilters=function(e){return{status:e.status&&e.status.length>0?e.status:void 0,artifact_id:e.artifactId&&e.artifactId.length>0?e.artifactId:void 0}},n.handleExport=function(){var e=n.props,t=e.match.params.organisationId,a=e.location.search,r=e.intl.formatMessage,o=e.workspace;n.setState({exportRunning:!0});var i=(0,f.parseSearch)(a,p.FEEDS_SEARCH_SETTINGS),s=i.feedType&&"TAG_FEED"===i.feedType[0]?n.tagFeedService:n.externalFeedService;(function e(a){return s.getFeeds(Object.assign({first_result:a.length,organisation_id:t,order_by:"AUDIENCE_SEGMENT_NAME",max_results:500},n.buildApiSearchFilters(i))).then((function(t){if(0===t.data.length)return a;var n=a.concat(t.data);return t.total&&n.length>=t.total?n:e(n)}))})([]).then((function(e){var t=e.map((function(e){return e.audience_segment_id})).filter((function(e,t,n){return n.indexOf(e)===t}));return Promise.all(t.map((function(e){return n._audienceSegmentService.getSegment(e).catch((function(){return{data:void 0}}))}))).then((function(t){var a=e.map((function(e){return{feed:e,audienceSegment:t.map((function(e){return e.data})).find((function(t){return!!t&&t.id===e.audience_segment_id}))}}));n.setState({exportRunning:!1}),u.default.exportAudienceFeeds(a,{feedType:i.feedType&&"TAG_FEED"===i.feedType[0]?"TAG_FEED":"EXTERNAL_FEED",artifactIds:i.artifactId,status:i.status},o,r)}))})).catch((function(){n.setState({exportRunning:!1}),d.message.error(r(y.default.exportError),5)}))},n.state={exportRunning:!1},n.externalFeedService=n._audienceSegmentFeedServiceFactory("EXTERNAL_FEED")(""),n.tagFeedService=n._audienceSegmentFeedServiceFactory("TAG_FEED")(""),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.intl,a=this.state.exportRunning,r=[{name:n.formatMessage(y.default.audienceFeeds),path:"/v2/o/"+t+"/audience/feeds"},{name:n.formatMessage(y.default.audienceFeedsList),path:"/v2/o/"+t+"/audience/feeds/list"}];return o.createElement(h.Actionbar,{paths:r},o.createElement(d.Button,{onClick:this.handleExport,loading:a},o.createElement(h.McsIcon,{type:"download"}),o.createElement(i.FormattedMessage,{id:"audience.feeds.actionbar.exportButton",defaultMessage:"Export feed list"})))}}]),t}(o.Component);b([(0,m.lazyInject)(g.TYPES.IAudienceSegmentService)],_.prototype,"_audienceSegmentService",void 0),b([(0,m.lazyInject)(g.TYPES.IAudienceSegmentFeedServiceFactory)],_.prototype,"_audienceSegmentFeedServiceFactory",void 0),t.default=(0,c.compose)(i.injectIntl,s.injectDatamart,l.default,s.injectWorkspace)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(65),l=n(23),c=(a=l)&&a.__esModule?a:{default:a},u=n(8),d=n(10),f=n(11);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=(0,i.defineMessages)({audienceFeeds:{id:"audiencefeedsOverview.actionbar.title",defaultMessage:"Feeds Overview"}}),y=function(e){function t(){return p(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.history,n=e.match.params.organisationId,a=[{name:e.intl.formatMessage(g.audienceFeeds),path:"/v2/o/"+n+"/audience/feeds"}];return o.createElement(f.Actionbar,{paths:a},o.createElement(d.Button,{onClick:function(){return t.push("/v2/o/"+n+"/audience/feeds/list")}},o.createElement(i.FormattedMessage,{id:"audiencefeedsOverview.actionbar.view-details",defaultMessage:"View Details"})))}}]),t}(o.Component);t.default=(0,u.compose)(i.injectIntl,s.injectDatamart,c.default)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(6),l=n(8),c=n(11),u=h(n(2461)),d=n(841),f=n(30),p=n(10),m=h(n(23)),g=n(15),y=n(12);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=(0,s.defineMessages)({ACTIVE:{id:"audience.feeds.overview.card.status.live",defaultMessage:"Live"},PAUSED:{id:"audience.feeds.overview.card.status.paused",defaultMessage:"Paused"},INITIAL:{id:"audience.feeds.overview.card.status.initial",defaultMessage:"Initial"}}),_=(0,s.defineMessages)({ACTIVE:{id:"audience.feeds.overview.card.metric.tooltip.live",defaultMessage:"View all related live feeds"},PAUSED:{id:"audience.feeds.overview.card.metric.tooltip.paused",defaultMessage:"View all related paused feeds"},INITIAL:{id:"audience.feeds.overview.card.metric.tooltip.initial",defaultMessage:"View all related feeds in initial state"}}),S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.goToFeedsTable=function(e,t,a){return function(){var r=n.props,o=r.match.params.organisationId,i=r.history,s=r.location.search,l={artifactId:[e],status:[t],feedType:[a]},c={pathname:"/v2/o/"+o+"/audience/feeds/list",search:(0,f.updateSearch)(s,l,d.FEEDS_SEARCH_SETTINGS)};return i.push(c)}},n.getIconType=function(e){switch(e){case"ACTIVE":return"play";case"INITIAL":return"status";case"PAUSED":return"pause";default:return"status"}},n.state={isLoading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){this.fetchPluginAndLayout()}},{key:"fetchPluginAndLayout",value:function(){var e=this,t=this.props,n=t.pluginVersionId,a=t.notifyError;this.setState({isLoading:!0}),this._pluginService.getLocalizedPluginLayoutFromVersionId(n).then((function(t){var a=t.plugin,r=t.layout;e._pluginService.getPluginVersion(a.id,n).then((function(t){r?e.setState({feedTitle:r.metadata.display_name,pluginVersionValue:t.data.version_id,assetUrl:r.metadata.small_icon_asset_url,artifactId:a.artifact_id,isLoading:!1}):e.setState({feedTitle:a.artifact_id,artifactId:a.artifact_id,pluginVersionValue:t.data.version_id,isLoading:!1})}))})).catch((function(t){a(t),e.setState({isLoading:!1})}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.aggregatesByStatus,a=t.pluginVersionId,r=t.feedType,i=this.state,s=i.artifactId,l=i.assetUrl,d=i.feedTitle,f=i.isLoading,m=i.pluginVersionValue;return o.createElement(c.Card,{className:"feed-overview-card-content"},f?o.createElement("div",{className:"wrapper loading"},o.createElement(p.Spin,{size:"large"})):o.createElement("div",{className:"wrapper"},o.createElement("div",{className:"card-header"},l?o.createElement("img",{className:"image-title",src:""+window.MCS_CONSTANTS.ASSETS_URL+l}):o.createElement("i",{className:"image-title placeholder"})),o.createElement("div",{className:"feed-infos"},o.createElement("div",{className:"feed-title"},d),o.createElement("div",{className:"feed-version"},m)),o.createElement("div",{className:"feed-metrics"},["ACTIVE","PAUSED","INITIAL"].map((function(t){var i=t;return o.createElement(u.default,{key:"card-"+a+"-"+t,color:i,iconType:e.getIconType(i),message:b[i],metricValue:n[i]||"0",tooltipMessage:_[i],onClick:e.goToFeedsTable(s||"",t,r)})})))))}}]),t}(o.Component);v([(0,g.lazyInject)(y.TYPES.IPluginService)],S.prototype,"_pluginService",void 0),t.default=(0,l.compose)(i.withRouter,s.injectIntl,m.default)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.creativeRoutes=t.creativesDefinition=void 0;var a=n(633),r=u(n(2473)),o=u(n(2476)),i=n(2479),s=n(2482),l=u(n(2485)),c=n(185);function u(e){return e&&e.__esModule?e:{default:e}}var d=t.creativesDefinition={creativeDisplayList:{path:"/creatives/display",layout:"main",contentComponent:r.default,requiredFeature:"creatives-display"},creativeDisplayCreation:{path:"/creatives/display/create",layout:"edit",editComponent:a.EditDisplayCreativePage,requiredFeature:"creatives-display"},creativeDisplayEdit:{path:"/creatives/display/edit/:creativeId(\\d+)",layout:"edit",editComponent:a.EditDisplayCreativePage,requiredFeature:"creatives-display"},creativeEmailList:{path:"/creatives/email",layout:"main",contentComponent:s.EmailTemplatesPage,requiredFeature:"creatives-email"},creativeNativeList:{path:"/creatives/native",layout:"main",contentComponent:o.default,requiredFeature:"creatives-native"},creativeNativeCreation:{path:"/creatives/native/create",layout:"edit",editComponent:l.default,requiredFeature:"creatives-native"},creativeNativeEdit:{path:"/creatives/native/edit/:nativeId(\\d+)",layout:"edit",editComponent:l.default,requiredFeature:"creatives-native"},creativeEmailCreation:{path:"/creatives/email/create",layout:"edit",editComponent:i.CreateEmailTemplate,requiredFeature:"creatives-email"},creativeEmailEdition:{path:"/creatives/email/:creativeId(\\d+)/edit",layout:"edit",editComponent:i.CreateEmailTemplate,requiredFeature:"creatives-email"}};t.creativeRoutes=(0,c.generateRoutesFromDefinition)(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(8);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=(0,o.defineMessages)({placeholder:{id:"creatives.create.loader.empty.placeholder",defaultMessage:"Please fill out the form and save to see a preview of your creative."}}),u=function(e){function t(){return s(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.intl;return r.createElement("div",{className:"mcs-custom-loader no-loader"},e.formatMessage(c.placeholder))}}]),t}(r.Component);t.default=(0,i.compose)(o.injectIntl)(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=g(n(59)),c=n(633),u=n(13),d=n(51),f=g(n(23)),p=n(15),m=n(12);function g(e){return e&&e.__esModule?e:{default:e}}var y=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},h=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.loadFormData=function(e,t){n.setState({isLoading:!0}),n._displayCreativeFormService.loadFormData(t).then((function(e){n.setState({creativeFormData:e,isLoading:!1})})).catch((function(e){l.default.debug(e),n.props.notifyError(e),n.setState((function(){return{isLoading:!1}}))}))},n.saveFormData=function(){n.setState({isLoading:!0})},n.state={isLoading:!0,creativeFormData:{}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.creativeId;this.loadFormData(t,n)}},{key:"render",value:function(){var e=this.props,t=(e.creativeId,h(e,["creativeId"]));return this.state.isLoading?i.createElement(d.Loading,{isFullScreen:!0}):i.createElement(c.DisplayCreativeForm,a({},t,{initialValues:this.state.creativeFormData}))}}]),t}(i.Component);y([(0,p.lazyInject)(m.TYPES.IDisplayCreativeFormService)],v.prototype,"_displayCreativeFormService",void 0),t.default=(0,s.compose)(u.withRouter,f.default)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(10),l=n(13),c=n(24),u=n(11),d=y(n(164)),f=y(n(60)),p=n(137),m=n(15),g=n(12);function y(e){return e&&e.__esModule?e:{default:e}}var h=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},v=s.Layout.Content,b=p.IMAGE_AD_RENDERER,_=p.HTML_AD_RENDRER,S=p.EXTERNAL_AD_RENDERER,E=p.IMAGE_SKINS_AD_RENDERER,O=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderAdRendererSubmenu=function(){var e=n.props.onSelect,t=[b,_,S,E];return n._pluginService.getPlugins({max_results:1e3,plugin_type:"DISPLAY_AD_RENDERER"}).then((function(e){return e.data})).then((function(n){return n.filter((function(e){return!t.includes(e.id)})).map((function(t){return{title:t.artifact_id.split(new RegExp(["_","-"].join("|"),"g")).map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" "),select:function(){return e(t.id)}}}))}))},n.state={adRendererSubmenu:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.onSelect,n=e.intl.formatMessage,a=function(e){return function(){t(e)}},r={formId:"typePickerForm",onClose:this.props.close,paths:[{name:n(d.default.creativeCreationBreadCrumb)}]};return o.createElement(s.Layout,null,o.createElement("div",{className:"edit-layout ant-layout"},o.createElement(f.default,r),o.createElement(s.Layout,null,o.createElement(v,{className:"mcs-content-container mcs-form-container text-center"},o.createElement(c.FormTitle,{title:d.default.creativesTypePickerTitle,subtitle:d.default.creativesTypePickerSubTitle}),o.createElement(s.Row,{className:"mcs-selector_container"},o.createElement(s.Row,{className:"menu"},o.createElement("div",{className:"presentation"},o.createElement(u.MenuPresentational,{title:n(d.default.creativeTypeImage),type:"image",select:a(b)}),o.createElement("div",{className:"separator"},o.createElement(i.FormattedMessage,d.default.creativeTypeOr)),o.createElement(u.MenuPresentational,{title:n(d.default.creativeTypeHtml),type:"code",select:a(_)}))),o.createElement(s.Row,{className:"intermediate-title"},o.createElement(i.FormattedMessage,d.default.creativeTypeAdvanced)),o.createElement(s.Row,{className:"menu"},o.createElement(u.MenuList,{title:n(d.default.creativeTypeAgency),select:a(S)}),o.createElement(u.MenuList,{title:n(d.default.creativeTypeSkin),select:a(E)}),o.createElement(u.MenuSubList,{title:n(d.default.allRendererList),subtitles:[n(d.default.allRendererListSubtitle)],submenu:this.renderAdRendererSubmenu})))))))}}]),t}(o.Component);h([(0,m.lazyInject)(g.TYPES.IPluginService)],O.prototype,"_pluginService",void 0),t.default=(0,l.withRouter)((0,i.injectIntl)(O))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CREATIVE_DISPLAY_SEARCH_SETTINGS=void 0;var a=n(30);function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.CREATIVE_DISPLAY_SEARCH_SETTINGS=[].concat(r(a.PAGINATION_SEARCH_SETTINGS),r(a.ARCHIVED_SEARCH_SETTINGS),r(a.KEYWORD_SEARCH_SETTINGS))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NATIVE_SEARCH_SETTINGS=void 0;var a=n(30);function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.NATIVE_SEARCH_SETTINGS=[].concat(r(a.PAGINATION_SEARCH_SETTINGS),r(a.ARCHIVED_SEARCH_SETTINGS),r(a.KEYWORD_SEARCH_SETTINGS))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(33),s=n(6),l=n(8),c=n(11);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=(0,s.defineMessages)({archiveEmailsModalTitle:{id:"creatives.email.list.archiveModal.title",defaultMessage:"Archive Emails"},archiveEmailsModalMessage:{id:"creatives.email.list.archiveModal.message",defaultMessage:"Are you sure to archive all the selected emails ?"},emailTemplates:{id:"creatives.email.list.actionbar.breadCrumbPath.emailTemplates",defaultMessage:"Email Templates"}}),p=function(e){function t(){return u(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.rowSelection,a=e.multiEditProps,l=a.archiveEmails,u=a.isArchiveModalVisible,d=a.handleCancel,p=a.handleOk,m=a.isArchiving,g=e.intl,y=[{name:g.formatMessage(f.emailTemplates),path:"/v2/o/"+t+"/creatives/email"}],h=!!(n.selectedRowKeys&&n.selectedRowKeys.length>0);return r.createElement(c.Actionbar,{paths:y},r.createElement(i.Link,{to:"/v2/o/"+t+"/creatives/email/create"},r.createElement(o.Button,{className:"mcs-primary",type:"primary"},r.createElement(c.McsIcon,{type:"plus"})," ",r.createElement(s.FormattedMessage,{id:"creatives.email.list.actionbar.newEmailTemplate",defaultMessage:"New Email Template"}))),r.createElement(c.Slide,{toShow:h,horizontal:!0,content:r.createElement(o.Button,{onClick:l,className:"button-slider button-glow"},r.createElement(c.McsIcon,{type:"delete"}),r.createElement(s.FormattedMessage,{id:"creatives.email.list.actionbar.deleteEmailTemplate",defaultMessage:"Archive"}))}),h?r.createElement(o.Modal,{title:g.formatMessage(f.archiveEmailsModalTitle),visible:u,onOk:p,onCancel:d,confirmLoading:m},r.createElement("p",null,g.formatMessage(f.archiveEmailsModalMessage))):null)}}]),t}(r.Component);t.default=(0,l.compose)(i.withRouter,s.injectIntl)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(33),i=n(8),s=n(6),l=n(68),c=g(n(2483)),u=n(1144),d=n(30),f=g(n(348)),p=g(n(845)),m=n(11);function g(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.viewTestModal=function(e){n.setState({modalVisible:!0,selectedtemplateId:e.id})},n.handleCancel=function(){n.setState({modalVisible:!1,selectedtemplateId:""})},n.editEmailTemplate=function(e){var t=n.props,a=t.match.params.organisationId;t.history.push("/v2/o/"+a+"/creatives/email/"+e.id+"/edit")},n.state={modalVisible:!1,selectedtemplateId:"",inputValue:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"updateLocationSearch",value:function(e){var t=this.props,n=t.history,a=t.location,r=a.search,o={pathname:a.pathname,search:(0,d.updateSearch)(r,e,u.CREATIVE_EMAIL_SEARCH_SETTINGS)};n.push(o)}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.location.search,i=t.isLoadingEmailTemplates,s=t.dataSource,g=t.totalEmailTemplates,y=t.hasEmailTemplates,h=t.archiveEmailTemplate,v=t.rowSelection,b=t.intl,_=(0,d.parseSearch)(a,u.CREATIVE_EMAIL_SEARCH_SETTINGS),S={current:_.currentPage,pageSize:_.pageSize,total:g,onChange:function(t,n){e.updateLocationSearch({currentPage:t,pageSize:n}),v&&v.unselectAllItemIds&&v.allRowsAreSelected&&v.unselectAllItemIds()},onShowSizeChange:function(t,n){return e.updateLocationSearch({pageSize:n,currentPage:1})}},E=[{intlMessage:f.default.preview,key:"asset_path",isHideable:!1,className:"mcs-table-image-col",render:function(e,t){return r.createElement(p.default,{item:t})}},{intlMessage:f.default.name,key:"name",isHideable:!1,render:function(e,t){return r.createElement(o.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+n+"/creatives/email/"+t.id+"/edit"},e)}},{intlMessage:f.default.auditStatus,key:"audit_status",isHideable:!1,render:function(e){return r.createElement("span",null,e)}},{intlMessage:f.default.publishedVersion,key:"published_version",isHideable:!1,render:function(e){return r.createElement("span",null,e)}}],O=[{key:"action",actions:function(){return[{intlMessage:f.default.sendTest,callback:e.viewTestModal},{intlMessage:f.default.edit,callback:e.editEmailTemplate},{intlMessage:f.default.archive,callback:h}]}}],w={placeholder:b.formatMessage(f.default.searchPlaceholderEmail),onSearch:function(t){return e.updateLocationSearch({keywords:t,currentPage:1})},defaultValue:_.keywords};return y?r.createElement("div",{className:"mcs-table-container"},r.createElement(c.default,{organisationId:this.props.match.params.organisationId,isModalVisible:this.state.modalVisible,selectedtemplateId:this.state.selectedtemplateId,handleCancel:this.handleCancel}),r.createElement(l.TableViewFilters,{columns:E,actionsColumnsDefinition:O,dataSource:s,loading:i,pagination:S,rowSelection:v,searchOptions:w})):r.createElement(m.EmptyTableView,{iconType:"email",message:b.formatMessage(f.default.noEmailTemplate)})}}]),t}(r.Component);t.default=(0,i.compose)(o.withRouter,s.injectIntl)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CREATIVE_EMAIL_SEARCH_SETTINGS=void 0;var a=n(30);function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.CREATIVE_EMAIL_SEARCH_SETTINGS=[].concat(r(a.PAGINATION_SEARCH_SETTINGS),r(a.ARCHIVED_SEARCH_SETTINGS),r(a.KEYWORD_SEARCH_SETTINGS))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(35),i=n(8),s=n(6),l=n(137),c=g(n(164)),u=g(n(1137)),d=n(843),f=g(n(2489)),p=g(n(844)),m=g(n(842));function g(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.buildFormSections=function(){var e=n.props.initialValues,t=[],a=[],o=(0,l.isExistingCreative)(e);return a.push({id:"general",title:c.default.creativeSectionGeneralTitle,component:r.createElement(f.default,{small:!0})}),void 0===e.pluginLayout?a.push({id:"properties",title:c.default.creativeSectionPropertyTitle,component:r.createElement(d.PropertiesFormSection,{small:!0})}):e.pluginLayout.sections.forEach((function(e){a.push({id:e.title,title:e.title,component:r.createElement(d.PropertiesFormSection,{sectionTitle:e.title,small:!0})})})),o&&t.push({id:"preview",title:c.default.creativeSectionPreviewTitle,component:e.rendererPlugin&&e.rendererPlugin.archived?r.createElement(m.default,null):r.createElement(d.PreviewFormSection,null)}),o||t.push({id:"no-loader",title:c.default.creativeSectionPreviewTitle,component:r.createElement(u.default,null)}),{leftPanel:t,rightPanel:a}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.actionBarButtonText,n=e.breadCrumbPaths,a=e.pristine,o=e.close,i=this.buildFormSections();return r.createElement(p.default,{actionBarButtonText:t,close:o,breadCrumbPaths:n,leftFormSections:i.leftPanel,rightFormSections:i.rightPanel,pristine:a})}}]),t}(r.Component);t.default=(0,i.compose)((0,o.reduxForm)({form:l.DISPLAY_CREATIVE_FORM,enableReinitialize:!0}),s.injectIntl)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.libraryRoutes=t.libraryDefinition=void 0;var a=l(n(2492)),r=l(n(2495)),o=l(n(2499)),i=l(n(2504)),s=n(185);function l(e){return e&&e.__esModule?e:{default:e}}var c=t.libraryDefinition={libraryDealList:{path:"/library/deallist",layout:"main",actionBarComponent:i.default.actionBarComponent,contentComponent:i.default.contentComponent,requiredFeature:"library-keywords"},libraryDealEdition:{path:"/library/deallist/:dealListId(\\d+)/edit",layout:"edit",editComponent:o.default,requiredFeature:"library-keywords"},libraryDealCreation:{path:"/library/deallist/create",layout:"edit",editComponent:o.default,requiredFeature:"library-keywords"},libraryAssetList:{path:"/library/assets",layout:"main",contentComponent:a.default.contentComponent,requiredFeature:"library-assets"},libraryCatalogList:{path:"/library/catalog",layout:"main",actionBarComponent:r.default.actionBarComponent,contentComponent:r.default.contentComponent,requiredFeature:"library-catalog",requireDatamart:!0}};t.libraryRoutes=(0,s.generateRoutesFromDefinition)(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({assets:{id:"assets.breadcrumb.title",defaultMessage:"Assets"},newAsset:{id:"assets.actionbar.button.new",defaultMessage:"New Asset"},assetArchiveTitle:{id:"asssets.modal.archive.title",defaultMessage:"Are you sure you want to archive this Asset?"},assetArchiveMessage:{id:"asssets.modal.archive.message",defaultMessage:"By archiving this Asset it will stop creatives using it. Are you sure?"},assetArchiveOk:{id:"asssets.modal.archive.ok",defaultMessage:"Archive Now"},assetArchiveCancel:{id:"asssets.modal.archive.cancel",defaultMessage:"Cancel"},preview:{id:"asssets.table.column.preview",defaultMessage:"Preview"},name:{id:"asssets.table.column.name",defaultMessage:"Name"},type:{id:"asssets.table.column.type",defaultMessage:"Type"},dimensions:{id:"asssets.table.column.dimensions",defaultMessage:"Dimensions"},empty:{id:"asssets.table.empty",defaultMessage:"There is no Assets created yet! Click on New to get started"},uploadMessage:{id:"assets.modal.upload.message",defaultMessage:"You can upload one or multiple file at the time.\nYou can only upload image files with the following format .jpg,.jpeg,.png,.gif,.svg with a maximum size of 200kB"},uploadTitle:{id:"assets.modal.upload.title",defaultMessage:"Click or drag file to this area to upload"},uploadError:{id:"assets.modal.upload.error",defaultMessage:"is above 200kB!"},uploadButton:{id:"assets.modal.upload.button",defaultMessage:"Upload"},archive:{id:"assets.list.actionColumn.archive",defaultMessage:"Archive"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({dealList:{id:"deals.breadcrumb.title",defaultMessage:"Deal Lists"},newDealList:{id:"deals.actionbar.button.new",defaultMessage:"New Deal List"},dealListArchiveTitle:{id:"deals.modal.archive.title",defaultMessage:"Are you sure you want to archive this Deal List?"},dealListArchiveMessage:{id:"deals.modal.archive.message",defaultMessage:"By archiving this Deal List it will stop campaigns using it. Are you sure?"},dealListArchiveOk:{id:"deals.modal.archive.ok",defaultMessage:"Archive Now"},dealListArchiveCancel:{id:"deals.modal.archive.cancel",defaultMessage:"Cancel"},name:{id:"deals.list.column.name",defaultMessage:"Name"},empty:{id:"deals.list.empty",defaultMessage:"There is no Deal List List created yet! Click on New to get started"},edit:{id:"deals.list.actionColumn.edit",defaultMessage:"Edit"},archive:{id:"deals.list.actionColumn.archive",defaultMessage:"Archive"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.datastudioRoutes=t.datastudioDefinition=void 0;var a=p(n(2507)),r=n(2516),o=p(n(2521)),i=p(n(2524)),s=p(n(2527)),l=p(n(2531)),c=n(185),u=p(n(2534)),d=p(n(2538)),f=p(n(2541));function p(e){return e&&e.__esModule?e:{default:e}}var m=t.datastudioDefinition={datastudioQueryTool:{path:"/datastudio/query-tool",layout:"main",contentComponent:a.default,requiredFeature:"datastudio-query_tool",requireDatamart:!0},datastudioFunnel:{path:"/datastudio/funnel",layout:"main",contentComponent:f.default,requiredFeature:"funnel-analytics",requireDatamart:!0},datastudioReport:{path:"/datastudio/report",layout:"edit",editComponent:r.CreateReportPage,requiredFeature:"datastudio-report"},datastudioExportList:{path:"/datastudio/exports",layout:"main",contentComponent:s.default.contentComponent,actionBarComponent:s.default.actionBarComponent,requiredFeature:"datastudio-exports",requireDatamart:!0},datastudioExportDashboard:{path:"/datastudio/exports/:exportId(\\d+)",layout:"main",contentComponent:o.default,requiredFeature:"datastudio-exports",requireDatamart:!0},datastudioExportCreation:{path:"/datastudio/exports/create",layout:"edit",editComponent:u.default,requiredFeature:"datastudio-exports",requireDatamart:!0},datastudioExportEdition:{path:"/datastudio/exports/:exportId/edit",layout:"edit",editComponent:u.default,requiredFeature:"datastudio-exports",requireDatamart:!0},datastudioImportList:{path:"/datastudio/imports",layout:"main",contentComponent:l.default.contentComponent,actionBarComponent:l.default.actionBarComponent,requiredFeature:"datastudio-imports",requireDatamart:!0},datastudioImportEdition:{path:"/datastudio/datamart/:datamartId/imports/:importId/edit",layout:"edit",editComponent:d.default,requiredFeature:"datastudio-imports",requireDatamart:!0},datastudioImportCreation:{path:"/datastudio/imports/create",layout:"edit",editComponent:d.default,requiredFeature:"datastudio-imports",requireDatamart:!0},datastudioImportDashboard:{path:"/datastudio/datamart/:datamartId/imports/:importId(\\d+)",layout:"main",contentComponent:i.default,requiredFeature:"datastudio-imports",requireDatamart:!0}};t.datastudioRoutes=(0,c.generateRoutesFromDefinition)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(13),l=n(8),c=n(6),u=n(44),d=n(11),f=_(n(23)),p=_(n(2512)),m=_(n(2515)),g=_(n(821)),y=n(127),h=n(51),v=n(15),b=n(12);function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=i.Layout.Content,O=i.Layout.Sider,w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchObjectTypes=function(e){return n.setState({schemaLoading:!0,noLiveSchemaFound:!1,error:null}),n._runtimeSchemaService.getRuntimeSchemas(e).then((function(t){var a=t.data.find((function(e){return"LIVE"===e.status}));return a?n._runtimeSchemaService.getObjectTypeInfoResources(e,a.id):(n.setState({noLiveSchemaFound:!0}),[])})).then((function(e){return n.setState({rawSchema:e,schemaLoading:!1}),e})).catch((function(e){n.setState({error:e,schemaLoading:!1})}))},n.runQuery=function(e){var t=n.props.datamartId,a=n.state,r=a.precision,o=a.useCache,i=a.evaluateGraphQl;n.setState({runningQuery:!0,error:null,queryAborted:!1,queryResult:null}),n.asyncQuery=(0,u.makeCancelable)(n._queryService.runOTQLQuery(t,e,{precision:r,use_cache:o,graphql_select:i})),n.asyncQuery.promise.then((function(e){n.setState({runningQuery:!1,queryResult:e.data})})).catch((function(e){n.setState({error:e.isCanceled?null:e,runningQuery:!1})}))},n.abortQuery=function(){n.asyncQuery.cancel(),n.setState({queryAborted:!0,runningQuery:!1})},n.dismissError=function(){return n.setState({error:null})},n.state={queryResult:null,runningQuery:!1,queryAborted:!1,error:null,query:e.query||"SELECT @count{} FROM UserPoint",schemaVizOpen:!0,schemaLoading:!0,precision:"FULL_PRECISION",evaluateGraphQl:!0,useCache:!1,noLiveSchemaFound:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.datamartId;this.fetchObjectTypes(e)}},{key:"componentDidUpdate",value:function(e){var t=this.props.datamartId;e.datamartId!==t&&this.fetchObjectTypes(t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.intl,a=t.datamartId,r=t.queryEditorClassName,s=this.state,l=s.error,u=s.queryResult,f=s.runningQuery,v=s.queryAborted,b=s.schemaVizOpen,_=s.schemaLoading,S=s.rawSchema,w=s.query,P=s.precision,T=s.evaluateGraphQl,I=s.useCache,A=s.noLiveSchemaFound;if(_)return o.createElement(h.Loading,{isFullScreen:!0});var C=l&&o.createElement(i.Alert,{message:"Error",style:{marginBottom:40},description:l.error_id?o.createElement("span",null,l.error,o.createElement("br",null),o.createElement("code",null,l.error_id)):n.formatMessage(M.queryErrorDefaultMsg),type:"error",showIcon:!0,closable:!0,onClose:this.dismissError}),j=A&&o.createElement(i.Alert,{message:"Error",style:{marginBottom:40},description:n.formatMessage(M.noLiveSchemaFound),type:"error",showIcon:!0}),R=(f||v||u)&&o.createElement(p.default,{loading:f,result:u,aborted:v}),N="UserPoint";if(S){var k=S.find((function(e){return!!w.includes(e.name)}));k&&(N=k.name)}return o.createElement(i.Layout,null,this.props.renderActionBar(this.state.query,a),o.createElement(i.Layout,null,o.createElement(i.Layout,null,o.createElement(E,{className:"mcs-content-container"},o.createElement(d.ContentHeader,{title:o.createElement(c.FormattedMessage,{id:"queryTool.query-tool-page-title",defaultMessage:"Query Tool"})}),C,j,o.createElement(m.default,{onRunQuery:this.runQuery,onAbortQuery:this.abortQuery,runningQuery:f,datamartId:a,onQueryChange:function(t){return e.setState({query:t})},defaultValue:w,handleChange:function(t,n,a){return e.setState({evaluateGraphQl:t,useCache:n,precision:a})},precision:P,evaluateGraphQl:T,useCache:I,queryEditorClassName:r}),R)),o.createElement(O,{width:b?250:0},o.createElement("div",{className:"schema-visualizer"},o.createElement(g.default,{schema:S&&S.length>0?(0,y.computeFinalSchemaItem)(S,N,!1,!1,!1):void 0,disableDragAndDrop:!0})))))}}]),t}(o.Component);S([(0,v.lazyInject)(b.TYPES.IQueryService)],w.prototype,"_queryService",void 0),S([(0,v.lazyInject)(b.TYPES.IRuntimeSchemaService)],w.prototype,"_runtimeSchemaService",void 0),t.default=(0,l.compose)(c.injectIntl,s.withRouter,f.default)(w);var M=(0,c.defineMessages)({queryToolBreadcrumbLabel:{id:"query-tool.action-bar.breadcrumb.label.query-tool",defaultMessage:"Query Tool"},queryErrorDefaultMsg:{id:"query-tool.error.default-message",defaultMessage:"An error occured"},noLiveSchemaFound:{id:"query-tool.error.no-live-schena",defaultMessage:"This datamart can't be queried as there is no LIVE schema associated to it"}})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=P(n(0)),o=n(33),i=M(n(799)),s=n(25),l=n(35),c=n(8),u=n(10),d=n(6),f=n(13),p=n(11),m=n(24),g=M(n(784)),y=M(n(1153)),h=M(n(333)),v=M(n(789)),b=M(n(1154)),_=M(n(2518)),S=M(n(335)),E=M(n(2519)),O=n(2520),w=P(n(124));function M(e){return e&&e.__esModule?e:{default:e}}function P(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var T=u.Layout.Content,I=u.Layout.Sider,A=l.Field,C=l.Field,j=l.Field,R=l.Field,N=l.FieldArray,k=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.exportReport=function(e){var t=!0;n.setState({loadingData:t}),E.default.exportReport(e,n.props.organisationId).then((function(e){t=!1,n.setState({loadingData:t})})).catch((function(e){t=!1,n.setState({loadingData:t}),n.props.notifyError(e)}))},n.preview=function(){var e=n.props.formValue,t=n.props.organisationId,a=!0;n.setState({loadingData:a}),E.default.preview(e,t).then((function(e){n.setState(e),a=!1,n.setState({loadingData:a})})).catch((function(e){a=!1,n.setState({loadingData:a}),n.props.notifyError(e)}))},n.state={dataSource:[],columns:[],loadingData:!1,noPreviewValues:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.match.url,n=e.history,a=e.intl,s=e.handleSubmit,c=e.isFormValid,f=e.fieldValidators.isRequired,E=e.organisationId,w=null;0!==this.state.dataSource.length&&(w=r.createElement("div",{className:"mcs-table-container"},r.createElement(S.default,{columns:this.state.columns,loading:this.state.loadingData,dataSource:this.state.dataSource}))),!0===this.state.noPreviewValues&&(w=r.createElement(u.Row,{className:"report-previewNoValues"},r.createElement("p",null,r.createElement(d.FormattedMessage,b.default.previewSectionNoValues))));return r.createElement(u.Layout,null,r.createElement(l.Form,{className:"edit-layout ant-layout",onSubmit:s(this.exportReport)},r.createElement("button",{type:"submit",style:{display:"none"}}),r.createElement(p.Actionbar,{paths:[{name:a.formatMessage(b.default.actionBarTitle)}],edition:!0},r.createElement(u.Button,{type:"primary",className:"mcs-primary",htmlType:"submit",loading:this.state.loadingData},r.createElement(d.FormattedMessage,b.default.reportCreationSaveButton)),r.createElement(p.McsIcon,{type:"close",className:"close-icon",onClick:function(){n.push({pathname:"/v2/o/"+E+"/campaigns/display"})}})),r.createElement(u.Layout,null,r.createElement(I,{className:"stepper"},r.createElement(i.default,{rootEl:"#reportSteps",items:["general_information","detailed_information"],currentClassName:"currentStep"},r.createElement("li",null,r.createElement(o.Link,{to:t+"#general_information"},r.createElement(p.McsIcon,{type:"check-rounded-inverted"}),r.createElement("span",{className:"step-title"},r.createElement(d.FormattedMessage,b.default.reportSiderMenuGeneralInformation)))),r.createElement("li",null,r.createElement(o.Link,{to:t+"#detailed_information"},r.createElement(p.McsIcon,{type:"check-rounded-inverted"}),r.createElement("span",{className:"step-title"},r.createElement(d.FormattedMessage,b.default.reportSiderMenuDetailedInformation)))))),r.createElement(u.Layout,null,r.createElement("div",{id:"reportSteps",className:"ant-layout"},r.createElement(T,{className:"mcs-content-container mcs-form-container"},r.createElement("div",{id:"general_information"},r.createElement(u.Row,{style:{display:"block"},align:"middle",justify:"space-between",className:"section-header"},r.createElement(m.FormTitle,{title:b.default.reportSectionGeneralTitle,subtitle:b.default.reportSectionGeneralSubTitle})),r.createElement(u.Row,{style:{display:"block"}},r.createElement(A,{name:"type",component:h.default,validate:[f],options:O.typeOptions,formItemProps:{label:a.formatMessage(b.default.reportSectionGeneralTypeLabel),colon:!1,required:!0},helpToolTipProps:{title:a.formatMessage(b.default.reportSectionGeneralTypeTooltip)}}))),r.createElement("hr",null),r.createElement("div",{id:"detailed_information"},r.createElement(u.Row,{align:"middle",justify:"space-between",className:"section-header"},r.createElement(m.FormTitle,{title:b.default.reportSectionDetailedTitle,subtitle:b.default.reportSectionDetailedSubTitle})),r.createElement(u.Row,{style:{display:"block"}},r.createElement(C,{name:"dimensions",component:v.default,validate:[f],selectProps:{options:O.availableDimensions},formItemProps:{label:a.formatMessage(b.default.reportSectionDetailedDimensionsLabel),colon:!1,required:!0},helpToolTipProps:{title:a.formatMessage(b.default.reportSectionDetailedDimensionsTooltip)}}),r.createElement(C,{name:"metrics",component:v.default,validate:[f],selectProps:O.selectPropsMetrics,formItemProps:{label:a.formatMessage(b.default.reportSectionDetailedMetricsLabel),colon:!1,required:!0},helpToolTipProps:{title:a.formatMessage(b.default.reportSectionDetailedMetricsTooltip)}}),r.createElement(j,{name:"duration",component:g.default,validate:[f],formItemProps:{label:a.formatMessage(b.default.reportSectionDetailedDurationLabel),colon:!1,required:!0},helpToolTipProps:{title:a.formatMessage(b.default.reportSectionDetailedDurationTooltip)},allowPastDate:!0,startDatePickerProps:{},endDatePickerProps:{}}),r.createElement(R,{name:"filter",component:y.default,formItemProps:{label:a.formatMessage(b.default.reportSectionDetailedFilterLabel),colon:!1},helpToolTipProps:{title:a.formatMessage(b.default.reportSectionDetailedFilterTooltip)},leftFormSelectProps:{placeholder:a.formatMessage(b.default.reportSectionDetailedFilterLeftSelectPlaceholder)},leftOptionsProps:O.linkedSelectOptions}),r.createElement(N,{name:"additionalFilters",component:_.default,formItemProps:{colon:!1},leftFormSelectProps:{placeholder:a.formatMessage(b.default.reportSectionDetailedFilterLeftSelectPlaceholder)},leftOptionsProps:O.linkedSelectOptions})),r.createElement(u.Row,null,r.createElement(u.Col,{span:15,offset:4},r.createElement(u.Col,{span:20,className:"report-previewButton"},r.createElement(u.Button,{onClick:this.preview,loading:this.state.loadingData,disabled:!c},r.createElement(d.FormattedMessage,b.default.previewButton))))),w)))))))}}]),t}(r.Component);t.default=(0,c.compose)(d.injectIntl,f.withRouter,(0,l.reduxForm)({form:"report"}),m.withValidators,(0,s.connect)((function(e){return{formValue:(0,l.getFormValues)("report")(e),isFormValid:(0,l.isValid)("report")(e)}}),{notifyError:w.notifyError}))(k)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(84),c=(a=l)&&a.__esModule?a:{default:a};function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e){function t(){u(this,t);var e=d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.updateLeftSelect=function(t){e.props.input.onChange({leftValue:t})},e.updateRightInput=function(t){var n=e.props.input;n.onChange(Object.assign(Object.assign({},n.value),{rightValue:t.target.value}))},e.createLeftOptions=function(){return e.props.leftOptionsProps.map((function(e){return i.createElement(s.Select.Option,{key:e.value,value:e.value},e.label)}))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.input,n=e.meta,a=e.formItemProps,o=e.helpToolTipProps,l=e.leftFormSelectProps,u=e.renderFieldAction,d=e.small,f=this.createLeftOptions(),p="success";return n.touched&&n.invalid&&(p="error"),n.touched&&n.warning&&(p="warning"),i.createElement(c.default,r({help:n.touched&&(n.warning||n.error),helpToolTipProps:o,renderFieldAction:u,validateStatus:p,small:d},a),i.createElement("div",{className:"range-filter"},i.createElement("div",{className:"filter-input"},i.createElement(s.Select,r({value:t.value.leftValue,onChange:this.updateLeftSelect},l),f)),i.createElement("div",{className:"range-filter-separator"},i.createElement("p",{className:"form-split"},"=")),i.createElement("div",{className:"filter-input"},i.createElement(s.Input,{value:t.value.rightValue,onChange:this.updateRightInput}))))}}]),t}(i.Component);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({reportCreationSaveButton:{id:"report.create.actionbar.button.save",defaultMessage:"Export"},reportSiderMenuGeneralInformation:{id:"report.sider.menu.generalInformation",defaultMessage:"General Information"},reportSiderMenuDetailedInformation:{id:"report.sider.menu.detailedInformation",defaultMessage:"Detailed Information"},reportSectionGeneralTitle:{id:"report.create.section.general.title",defaultMessage:"General Information"},reportSectionGeneralSubTitle:{id:"report.create.section.general.subtitle",defaultMessage:"Give your report a name"},reportSectionGeneralTypeLabel:{id:"report.create.section.general.type.label",defaultMessage:"Report type"},reportSectionGeneralTypeTooltip:{id:"report.create.section.general.type.tooltip",defaultMessage:"Please select a report type based on your needs"},reportSectionDetailedTitle:{id:"report.create.section.detailed.title",defaultMessage:"Detailed Information"},reportSectionDetailedSubTitle:{id:"report.create.section.detailed.subtitle",defaultMessage:"Select the type of information you need to extract"},reportSectionDetailedDimensionsLabel:{id:"report.create.section.detailed.dimensions.label",defaultMessage:"Dimensions"},reportSectionDetailedDimensionsTooltip:{id:"report.create.section.detailed.dimensions.tooltip",defaultMessage:"Add dimensions to your report"},reportSectionDetailedMetricsLabel:{id:"report.create.section.detailed.metrics.label",defaultMessage:"Metrics"},reportSectionDetailedMetricsTooltip:{id:"report.create.section.detailed.metrics.tooltip",defaultMessage:"Add metrics to your report"},reportSectionDetailedDurationLabel:{id:"report.create.section.detailed.duration.label",defaultMessage:"Duration"},reportSectionDetailedDurationTooltip:{id:"report.create.section.detailed.duration.tooltip",defaultMessage:"Select a start date and an end date for your report"},reportSectionDetailedDurationStartDatePlaceholder:{id:"report.create.section.detailed.duration.startDate.placeholder",defaultMessage:"Start date"},reportSectionDetailedDurationEndDatePlaceholder:{id:"report.create.section.detailed.duration.endDate.placeholder",defaultMessage:"End date"},reportSectionDetailedFilterLabel:{id:"report.create.section.detailed.filter.label",defaultMessage:"Filters"},reportSectionDetailedFilterTooltip:{id:"report.create.section.detailed.filter.tooltip",defaultMessage:"Add filters to your report"},reportSectionDetailedFilterLeftSelectPlaceholder:{id:"report.create.section.detailed.filter.leftSelect.placeholder",defaultMessage:"Filter"},reportSectionDetailedFilterRightSelectPlaceholder:{id:"report.create.section.detailed.filter.rightSelect.placeholder",defaultMessage:"Value"},previewSectionNoValues:{id:"report.previewSection.noValues",defaultMessage:"No Values"},previewButton:{id:"report.previewButton",defaultMessage:"Preview your results"},actionBarTitle:{id:"report.actionBarTitle",defaultMessage:"Create a report"},AddFilterButtonText:{id:"report.AddFilterButtonText",defaultMessage:"Add Filter"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatExportProperty=void 0;var a=n(6),r=n(414);t.default=(0,a.defineMessages)({name:{id:"exports.dashboard.table.name",defaultMessage:"Name"},creationDate:{id:"exports.dashboard.table.creationDate",defaultMessage:"Creation Date"},startDate:{id:"exports.dashboard.table.startDate",defaultMessage:"Start Date"},download:{id:"exports.dashboard.table.download",defaultMessage:"Download"},archive:{id:"exports.dashboard.actionbar.archive",defaultMessage:"Archive"},exportExecutionsTitle:{id:"exports.dashboard.table.title",defaultMessage:"Export Executions"},newExecution:{id:"exports.dashboard.actionbar.newExecution",defaultMessage:"New Execution"},edit:{id:"exports.dashboard.actionbar.edit",defaultMessage:"Edit"},exportRunning:{id:"exports.dashboard.actionbar.running",defaultMessage:"An export execution is already running"},exportFailed:{id:"exports.dashboard.actionbar.failed",defaultMessage:"This export has failed. Please launch another execution."},exportRunningDownload:{id:"exports.dashboard.actionbar.running.download",defaultMessage:"This export is being created, please try again when the export is succeeded."},wait:{id:"exports.dashboard.actionbar.wait",defaultMessage:"Please wait until the export is done."},notStarted:{id:"exports.dashboard.actionbar.notStarted",defaultMessage:"Not Started"},status:{id:"exports.table.column.status",defaultMessage:"Status"},history:{id:"exports.dashboard.actionbar.history",defaultMessage:"History"}});var o=(0,a.defineMessages)({id:{id:"export.fields.id",defaultMessage:"ID"},datamart_id:{id:"export.fields.datamartId",defaultMessage:"Datamart ID"},name:{id:"export.fields.name",defaultMessage:"Export Name"},organisation_id:{id:"export.fields.organisationId",defaultMessage:"Organisation ID"},output_format:{id:"export.fields.outputFormat",defaultMessage:"Output Format"},query_id:{id:"export.fields.queryId",defaultMessage:"Query ID"},type:{id:"export.fields.type",defaultMessage:"Typet"},history_title:{id:"export.resourceHistory.title",defaultMessage:"Export History"},history_resource_type:{id:"export.resourceHistory.type",defaultMessage:"Export"}}),i={id:{format:"STRING"},datamart_id:{format:"STRING"},name:{format:"STRING"},organisation_id:{format:"STRING"},output_format:{format:"STRING"},query_id:{format:"STRING"},type:{format:"STRING"},history_title:{format:"STRING"},history_resource_type:{format:"STRING"}};t.formatExportProperty=function(e,t){return{message:o[e],formattedValue:t&&i[e]?(0,r.formatToFormattingFunction)(t,i[e].format,i[e].messageMap):void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatDocumentTypeText=function(e){switch(e){case"USER_ACTIVITY":return"User Activity";case"USER_PROFILE":return"User Profile";case"USER_SEGMENT":return"User Segment";case"USER_IDENTIFIERS_ASSOCIATION_DECLARATIONS":return"User Identifiers Association";case"USER_IDENTIFIERS_DISSOCIATION_DECLARATIONS":return"User Identifiers Dissociation";case"USER_IDENTIFIERS_DELETION":return"User Identifiers Deletion";default:return""}},t.formatMimeTypeText=function(e){switch(e){case"APPLICATION_X_NDJSON":return"NDJSON";case"TEXT_CSV":return"CSV";default:return""}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({id:{id:"imports.dashboard.table.column.id",defaultMessage:"ID"},name:{id:"imports.dashboard.table.name",defaultMessage:"Name"},creationDate:{id:"imports.dashboard.table.creationDate",defaultMessage:"Creation Date"},startDate:{id:"imports.dashboard.table.startDate",defaultMessage:"Start Date"},endDate:{id:"imports.dashboard.table.endDate",defaultMessage:"End Date"},progress:{id:"imports.table.column.progress",defaultMessage:"Progress"},delete:{id:"imports.dashboard.actionbar.delete",defaultMessage:"Delete"},importExecutionsTitle:{id:"imports.dashboard.table.title",defaultMessage:"Import Executions"},newExecution:{id:"imports.dashboard.actionbar.newExecution",defaultMessage:"New Execution"},edit:{id:"imports.dashboard.actionbar.edit",defaultMessage:"Edit"},importRunning:{id:"imports.dashboard.actionbar.running",defaultMessage:"An import execution is already running"},importFailed:{id:"imports.dashboard.actionbar.failed",defaultMessage:"This import has failed. Please launch another execution."},importRunningDownload:{id:"imports.dashboard.actionbar.running.download",defaultMessage:"This import is being created, please try again when the import is succeeded."},wait:{id:"imports.dashboard.actionbar.wait",defaultMessage:"Please wait until the import is done."},notStarted:{id:"imports.dashboard.actionbar.notStarted",defaultMessage:"Not Started"},notEnded:{id:"imports.dashboard.actionbar.notEnded",defaultMessage:"Not ended"},notCreated:{id:"imports.dashboard.actionbar.notCreated",defaultMessage:"Not created"},status:{id:"imports.table.column.status",defaultMessage:"Status"},uploadError:{id:"imports.dashboard.new.import.error",defaultMessage:"Upload Error"},uploadTitle:{id:"imports.dashboard.new.execution.modal.title",defaultMessage:"New Import"},uploadErrorTooBig:{id:"imports.dashboard.new.import.error.fileTooBig",defaultMessage:"is too big (max size 100Mo)."},uploadMessage:{id:"imports.dashboard.new.execution.modal.message",defaultMessage:"Drag & Drop your file or click to import your file"},uploadMessage2:{id:"imports.dashboard.new.execution.modal.message2",defaultMessage:"(.ndjson or .csv and max size 100Mo)"},uploadConfirm:{id:"imports.dashboard.new.execution.modal.confirm",defaultMessage:"Ok"},uploadCancel:{id:"imports.dashboard.new.execution.modal.cancel",defaultMessage:"Cancel"},downloadErrorFile:{id:"imports.execution.result.error.download",defaultMessage:"Download error file"},downloadInputFile:{id:"imports.execution.result.input.download",defaultMessage:"Download input file"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExecutionInfo=function(e,t){var n=e.num_tasks?e.num_tasks:0,a=e.completed_tasks?e.completed_tasks:0;return{percent:n?a/n:0,color:function(e){switch(e){case"RUNNING":case"PENDING":return t["mcs-primary"];case"SUCCESS":case"SUCCEEDED":return t["mcs-success"];case"FAILED":return t["mcs-error"];default:return t["mcs-primary"]}}(e.status)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({exports:{id:"exports.breadcrumb.title",defaultMessage:"Exports"},newExport:{id:"exports.actionbar.button.new",defaultMessage:"New Export"},exportsArchiveTitle:{id:"exports.modal.archive.title",defaultMessage:"Are you sure you want to archive this Export?"},exportsArchiveMessage:{id:"exports.modal.archive.message",defaultMessage:"By archiving this Export it will stop campaigns using it. Are you sure?"},exportsArchiveOk:{id:"exports.modal.archive.ok",defaultMessage:"Archive Now"},exportsArchiveCancel:{id:"exports.modal.archive.cancel",defaultMessage:"Cancel"},searchTitle:{id:"exports.table.searchBar.label",defaultMessage:"Search Exports"},name:{id:"exports.list.column.name",defaultMessage:"Name"},type:{id:"exports.list.column.type",defaultMessage:"Type"},empty:{id:"exports.list.empty",defaultMessage:"There is no Export List created yet! Click on New to get started"},archive:{id:"exports.list.actionColumn.archive",defaultMessage:"Archive"},filterByLabel:{id:"exports.list.labelFilter.placeholder",defaultMessage:"Filter By Label"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({imports:{id:"imports.breadcrumb.title",defaultMessage:"Imports"},newImport:{id:"imports.actionbar.button.new",defaultMessage:"New Import"},importsDeleteTitle:{id:"imports.modal.delete.title",defaultMessage:"Are you sure you want to delete this Import?"},importsDeleteMessage:{id:"imports.modal.delete.message",defaultMessage:"By deleting this Import, all its executions and associated files will be unavailable."},importsDeleteOk:{id:"imports.modal.delete.ok",defaultMessage:"Delete Now"},importsDeleteCancel:{id:"imports.modal.delete.cancel",defaultMessage:"Cancel"},searchTitle:{id:"imports.table.searchbar.label",defaultMessage:"Search Imports"},name:{id:"imports.table.column.name",defaultMessage:"Name"},type:{id:"imports.table.column.type",defaultMessage:"Type"},mimeType:{id:"imports.table.column.mimeType",defaultMessage:"Mime-Type"},documentType:{id:"imports.table.column.documentType",defaultMessage:"Document Type"},priority:{id:"imports.table.column.priority",defaultMessage:"Priority"},id:{id:"imports.table.column.id",defaultMessage:"ID"},startTime:{id:"imports.table.column.start.time",defaultMessage:"Start Time"},endTime:{id:"imports.table.column.end.time",defaultMessage:"End Time"},empty:{id:"imports.table.empty",defaultMessage:"There is no Import List created yet! Click on New to get started"},filterStatus:{id:"imports.table.filter.status",defaultMessage:"Status"},edit:{id:"imports.table.actionColumn.edit",defaultMessage:"Edit"},delete:{id:"imports.table.actionColumn.delete",defaultMessage:"Delete"},filterByLabel:{id:"imports.table.labelFilter.placeholder",defaultMessage:"Filter By Label"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IMPORTS_SEARCH_SETTINGS=void 0;var a=n(30);function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.IMPORTS_SEARCH_SETTINGS=[].concat(r(a.PAGINATION_SEARCH_SETTINGS),r(a.DATAMART_SEARCH_SETTINGS),r(a.KEYWORD_SEARCH_SETTINGS),r(a.LABELS_SEARCH_SETTINGS),[{paramName:"status",defaultValue:[],deserialize:function(e){return e.type?e.type.split(","):[]},serialize:function(e){return e.join(",")},isValid:function(e){return!e.type||e.type.split(",").length>0}}])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=n(13),c=n(6),u=n(68),d=n(1160),f=(a=d)&&a.__esModule?a:{default:a},p=n(41),m=n(10),g=n(33),y=n(15),h=n(12),v=n(44),b=n(1156),_=n(30),S=n(124),E=n(1161),O=n(25);var w=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.deleteImport=function(e,t){return n._importService.deleteImport(e,t)},n.fetchImport=function(e,t){n.setState({loading:!0},(function(){var a=Object.assign({},(0,v.getPaginatedApiParam)(t.currentPage,t.pageSize));t.keywords&&(a.keywords=t.keywords),t.label_id&&t.label_id.length&&(a.label_ids=t.label_id),n._importService.getImportList(e,a).then((function(e){n.setState({loading:!1,data:e.data,total:e.total||e.count})}))}))},n.onClickDelete=function(e){var t=n.props,a=t.location,r=a.search,o=a.pathname,s=a.state,l=t.history,c=t.intl.formatMessage,u=t.datamartId,d=n.state.data,g=(0,_.parseSearch)(r,E.IMPORTS_SEARCH_SETTINGS);m.Modal.confirm({icon:i.createElement(p.ExclamationCircleOutlined,null),title:c(f.default.importsDeleteTitle),content:c(f.default.importsDeleteMessage),okText:c(f.default.importsDeleteOk),cancelText:c(f.default.importsDeleteCancel),onOk:function(){n.deleteImport(e.datamart_id,e.id).then((function(){if(1===d.length&&1!==g.currentPage){var e=Object.assign(Object.assign({},g),{currentPage:g.currentPage?g.currentPage-1:1});return l.replace({pathname:o,search:(0,_.updateSearch)(r,e),state:s}),Promise.resolve()}return n.fetchImport(u,g)}))},onCancel:function(){}})},n.onClickEdit=function(e){var t=n.props,a=t.history,r=t.location,o=t.match.params.organisationId;a.push({pathname:"/v2/o/"+o+"/datastudio/datamart/"+e.datamart_id+"/imports/"+e.id+"/edit",state:{from:""+r.pathname+r.search}})},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,_.updateSearch)(o,e,n.getSearchSetting())};a.push(i)},n.state={loading:!1,data:[],total:0,datamarts:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.datamartId,a=t.match.params.organisationId,r=t.noFilterDatamart,o=t.location,i=o.search,s=o.pathname,l=t.history;this.setState({loading:!0});if((0,_.isSearchValid)(i,E.IMPORTS_SEARCH_SETTINGS)){var c=(0,_.parseSearch)(i,E.IMPORTS_SEARCH_SETTINGS);r||this._datamartService.getDatamarts(a,{allow_administrator:!0,archived:!1}).then((function(t){e.setState({datamarts:t.data,loading:!1})})).catch((function(t){e.setState({loading:!1}),(0,S.notifyError)(t)})),this.fetchImport(n,c)}else l.replace({pathname:s,search:(0,_.buildDefaultSearch)(i,E.IMPORTS_SEARCH_SETTINGS)})}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,a=n.match.params,r=a.organisationId,o=a.datamartId,i=n.location.search,s=n.noFilterDatamart,l=e.match.params.organisationId,c=e.location.search,u=(0,_.parseSearch)(i,E.IMPORTS_SEARCH_SETTINGS);if(r!==l||!(0,_.compareSearches)(i,c)){s||this._datamartService.getDatamarts(r,{allow_administrator:!0,archived:!1}).then((function(e){t.setState({datamarts:e.data})})),this.fetchImport(u.datamartId||o||this.props.datamartId,u)}}},{key:"getSearchSetting",value:function(){return[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(E.IMPORTS_SEARCH_SETTINGS))}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.datamartId,r=t.noFilterDatamart,o=t.intl,s=t.labels,l=t.location.search,d=this.state,y=d.data,h=d.loading,v=d.datamarts,S=(0,_.parseSearch)(l,E.IMPORTS_SEARCH_SETTINGS),O=[{key:"action",actions:function(){return[{intlMessage:f.default.edit,callback:e.onClickEdit},{intlMessage:f.default.delete,callback:e.onClickDelete}]}}],w=[{intlMessage:f.default.id,key:"id",isHideable:!1,render:function(e,t){return i.createElement("span",null,e)}},{intlMessage:f.default.name,key:"name",isHideable:!1,render:function(e,t){return i.createElement(g.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+n+"/datastudio/datamart/"+t.datamart_id+"/imports/"+t.id},e)}},{intlMessage:f.default.documentType,key:"document_type",isHideable:!1,render:function(e,t){return i.createElement("span",null,(0,b.formatDocumentTypeText)(e))}},{intlMessage:f.default.priority,key:"priority",isHideable:!1,render:function(e){return i.createElement("span",null,e)}},{intlMessage:f.default.mimeType,key:"mime_type",isHideable:!1,render:function(e,t){return i.createElement("span",null,(0,b.formatMimeTypeText)(e))}}],M=v.map((function(e){return{key:e.id,value:e.name||e.token}})),P=[];if(v.length>1){var T={displayElement:i.createElement("div",null,i.createElement(c.FormattedMessage,{id:"imports.list.datamartFilter",defaultMessage:"Datamart"})," ",i.createElement(p.DownOutlined,null)),selectedItems:[M.find((function(e){return e.key===a}))],items:M,singleSelectOnly:!0,getKey:function(e){return e&&e.key?e.key:""},display:function(e){return e.value},handleItemClick:function(t){e.updateLocationSearch({datamartId:t&&t.key?t.key:void 0,currentPage:1,pageSize:S.pageSize})}};r||P.push(T)}var I={placeholder:o.formatMessage(f.default.searchTitle),onSearch:function(t){return e.updateLocationSearch({keywords:t,currentPage:1,pageSize:S.pageSize})},defaultValue:S.keywords},A={current:S.currentPage,pageSize:S.pageSize,total:this.state.total,onChange:function(t,n){return e.updateLocationSearch({currentPage:t,pageSize:n,datamartId:a})},onShowSizeChange:function(t,n){return e.updateLocationSearch({currentPage:1,pageSize:n,datamartId:a})}},C={labels:s,selectedLabels:s.filter((function(e){return S.label_id.some((function(t){return t===e.id}))})),onChange:function(t){var n=t.map((function(e){return e.id}));e.updateLocationSearch({label_id:n,currentPage:1})},buttonMessage:f.default.filterByLabel};return i.createElement(m.Row,{className:"mcs-table-container"},i.createElement("div",null,i.createElement("div",{className:"mcs-card-header mcs-card-title"},i.createElement("span",{className:"mcs-card-title"},i.createElement(c.FormattedMessage,f.default.imports))),i.createElement("hr",{className:"mcs-separator"}),i.createElement(u.TableViewFilters,{columns:w,actionsColumnsDefinition:O,searchOptions:I,filtersOptions:P,dataSource:y,loading:h,pagination:A,labelsOptions:C})))}}]),t}(i.Component);w([(0,y.lazyInject)(h.TYPES.IImportService)],M.prototype,"_importService",void 0),w([(0,y.lazyInject)(h.TYPES.IDatamartService)],M.prototype,"_datamartService",void 0);t.default=(0,s.compose)(l.withRouter,c.injectIntl,(0,O.connect)((function(e){return{labels:e.labels.labelsApi.data}})))(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(8),s=n(35),l=n(13),c=n(6),u=p(n(60)),d=p(n(101)),f=p(n(2540));function p(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=t.FORM_ID="importForm",h=o.Layout.Content,v=(0,c.defineMessages)({sectionTitleGeneral:{id:"imports.form.general",defaultMessage:"General Information"},saveImport:{id:"save.import",defaultMessage:"Save"},editImport:{id:"imports.form.edit.title",defaultMessage:"Edit {name}"}}),b=function(e){function t(){m(this,t);var e=g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFormSections=function(){var e=[],t={id:"general",title:v.sectionTitleGeneral,component:r.createElement(f.default,null)};return e.push(t),e},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.onSave,a={formId:y,paths:this.props.breadCrumbPaths,message:v.saveImport,onClose:this.props.onClose},i=this.buildFormSections(),l={items:i.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:y},c=i.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==i.length-1&&r.createElement("hr",null))}));return r.createElement(o.Layout,{className:"edit-layout"},r.createElement(u.default,a),r.createElement(o.Layout,{className:"ant-layout-has-sider"},r.createElement(d.default,l),r.createElement(s.Form,{className:"edit-layout ant-layout",onSubmit:t(n)},r.createElement(h,{id:y,className:"mcs-content-container mcs-form-container"},r.createElement("div",{className:"placement-list-form"},c)))))}}]),t}(r.Component);t.default=(0,i.compose)(l.withRouter,c.injectIntl,(0,s.reduxForm)({form:y,enableReinitialize:!0}))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractDatesFromProps=void 0;var a=n(30),r=n(81);t.extractDatesFromProps=function(e){var t=(0,a.parseSearch)(e,a.DATE_SEARCH_SETTINGS),n=(0,r.formatMcsDate)(t,!0);return{type:"DATES",start_date:n.from,end_date:n.to}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({audienceTitle:{id:"menu.audience.title",defaultMessage:"Audience"},audienceHome:{id:"menu.audience.home",defaultMessage:"Home"},audienceDashboard:{id:"menu.audience.dashboard",defaultMessage:"Dashboard"},audienceSegment:{id:"menu.audience.segments",defaultMessage:"Segments"},audienceFeeds:{id:"menu.audience.feeds",defaultMessage:"Feeds"},audienceSegmentBuilder:{id:"menu.audience.segmentBuilder",defaultMessage:"Segment Builder"},audienceSegmentBuilderV2:{id:"menu.audience.segmentBuilderV2",defaultMessage:"Audience Builder"},audienceMonitoring:{id:"menu.audience.monitoring",defaultMessage:"Monitoring"},campaignTitle:{id:"menu.campaign.title",defaultMessage:"Campaigns"},campaignDisplay:{id:"menu.campaign.display",defaultMessage:"Display"},campaignEmail:{id:"menu.campaign.emails",defaultMessage:"Emails"},campaignGoals:{id:"menu.campaign.goals",defaultMessage:"Goals"},automationTitle:{id:"menu.automation.title",defaultMessage:"Automations"},automationList:{id:"menu.automation.list",defaultMessage:"List"},automationBuilder:{id:"menu.automation.builder",defaultMessage:"Builder"},creativesTitle:{id:"menu.creatives.title",defaultMessage:"Creatives"},creativesDisplay:{id:"menu.creatives.display",defaultMessage:"Display"},creativesEmails:{id:"menu.creatives.emails",defaultMessage:"Emails"},creativesNative:{id:"menu.creatives.native",defaultMessage:"Native"},libraryTitle:{id:"menu.library.title",defaultMessage:"Library"},libraryAttributionModel:{id:"menu.library.AttributionModel",defaultMessage:"Attribution Models"},libraryVisitAnalyzer:{id:"menu.library.VisitAnalyzer",defaultMessage:"Visit Analyzers"},libraryEmailRouter:{id:"menu.library.EmailRouter",defaultMessage:"Email Routers"},libraryRecommenders:{id:"menu.library.Recommenders",defaultMessage:"Recommenders"},libraryCatalog:{id:"menu.library.Catalogs",defaultMessage:"Catalogs"},libraryDealList:{id:"menu.library.DealLst",defaultMessage:"Deal Lists"},libraryAdLayouts:{id:"menu.library.layouts",defaultMessage:"Ad Layouts"},libraryStylesheets:{id:"menu.library.Stylesheets",defaultMessage:"Stylesheets"},libraryAssets:{id:"menu.library.Assets",defaultMessage:"Assets"},libraryExports:{id:"menu.library.Exports",defaultMessage:"Exports"},libraryImports:{id:"menu.library.Imports",defaultMessage:"Imports"},dataStudioTitle:{id:"menu.dataStudio.title",defaultMessage:"Data Studio"},dataStudioQuery:{id:"menu.dataStudio.query",defaultMessage:"Query Tool"},dataStudioFunnel:{id:"menu.dataStudio.funnel",defaultMessage:"Funnel"},dataStudioReport:{id:"menu.dataStudio.report",defaultMessage:"Report"},analyticsTitle:{id:"menu.analytics.title",defaultMessage:"Analytics"},analyticsOverview:{id:"menu.analytics.overview",defaultMessage:"Overview"},datamartSettingsTitle:{id:"menu.datamart.title",defaultMessage:"Datamart"},siteSettingsTitle:{id:"menu.datamart.site",defaultMessage:"Sites"},mobileAppsSettingsTitle:{id:"menu.datamart.mobile_application",defaultMessage:"Mobile Applications"},channelsSettingsTitle:{id:"menu.datamart.channels",defaultMessage:"Channels"},audiencePartitionsSettingsTitle:{id:"menu.datamart.partitions",defaultMessage:"Partitions"},compartmentsSettingsTitle:{id:"menu.datamart.compartments",defaultMessage:"Compartments"},visitAnalyzerSettingsTitle:{id:"menu.datamart.visit_analyzer",defaultMessage:"Visit Analyzers"},mlFunctionSettingsTitle:{id:"menu.datamart.ml_functions",defaultMessage:"ML Functions"},cleaningRulesSettingsTitle:{id:"menu.datamart.cleaningRules",defaultMessage:"Cleaning Rules"},myDatamartSettingsTitle:{id:"menu.datamart.myDatamart",defaultMessage:"Datamarts"},organisationSettingsTitle:{id:"menu.organisation.title",defaultMessage:"Organisation"},usersSettingsTitle:{id:"menu.organisation.users",defaultMessage:"Users"},userRolesSettingsTitle:{id:"menu.organisation.userRoles",defaultMessage:"User Roles"},labelsSettingsTitle:{id:"menu.organisation.labels",defaultMessage:"Labels"},orgSettingsTitle:{id:"menu.organisation.settings",defaultMessage:"Profile"},mlAlgorithmsSettingsTitle:{id:"menu.organisation.ml-algorithms",defaultMessage:"ML Algorithms"},accountSettingsTitle:{id:"menu.account.title",defaultMessage:"My Account"},accountSettingsProfile:{id:"menu.account.profile",defaultMessage:"Profile"},accountSettingsApiToken:{id:"menu.account.api.tokens",defaultMessage:"Api Tokens"},processingsSettingsTitle:{id:"menu.organisation.processings",defaultMessage:"Processing Activities"},campaignSettingsTitle:{id:"menu.campaigns.title",defaultMessage:"Campaigns"},serviceOffersSettingsTitle:{id:"menu.service.offers.title",defaultMessage:"Services"},campaignSettingsAttributionModels:{id:"menu.campaigns.attribution_models",defaultMessage:"Attribution Models"},campaignSettingsEmailRouters:{id:"menu.campaigns.email_routers",defaultMessage:"Email Routers"},campaignSettingsRecommenders:{id:"menu.campaigns.recommenders",defaultMessage:"Recommenders"},subscribedOffersSettingsList:{id:"menu.subscribed.offers.list",defaultMessage:"Subscribed Offers"},myOffersSettingsList:{id:"menu.my.offers.list",defaultMessage:"My Offers"},serviceCatalogSettingsList:{id:"menu.service.catalog.list",defaultMessage:"My Service Catalog"},offersSettingsList:{id:"menu.service.my.offers.list",defaultMessage:"My Offers"},marketplaceTitle:{id:"menu.marketplaceTitle.title",defaultMessage:"Marketplace"},marketplaceOfferCatalog:{id:"menu.marketplaceTitle.offer_catalog",defaultMessage:"Offer catalog"},marketplaceSubsribedOffers:{id:"menu.marketplaceTitle.subscribed_offers",defaultMessage:"Subscribed offers"},backToAppSettings:{id:"menu.organisation.backToApp",defaultMessage:"Back to App"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.marketplaceRoutes=t.marketplaceDefinition=void 0;var a,r=n(2554),o=(a=r)&&a.__esModule?a:{default:a},i=n(185);var s=t.marketplaceDefinition={marketplaceOfferCatalogList:{path:"/marketplace/offercatalog",layout:"main",contentComponent:o.default,requiredFeature:"marketplace-offer_catalog"}};t.marketplaceRoutes=(0,i.generateRoutesFromDefinition)(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({offerCatalogTitle:{id:"marketplace.offercatalog.title",defaultMessage:"Offer catalog"},providerLabel:{id:"marketplace.offercatalog.provider",defaultMessage:"Provider"},nameLabel:{id:"marketplace.offercatalog.name",defaultMessage:"Name"},typeLabel:{id:"marketplace.offercatalog.type",defaultMessage:"Type"},priceLabel:{id:"marketplace.offercatalog.price",defaultMessage:"Price"},quoteLabel:{id:"marketplace.offercatalog.quote",defaultMessage:"Quote"},freeLabel:{id:"marketplace.offercatalog.free",defaultMessage:"Free"},cpmLabel:{id:"marketplace.offercatalog.cpm",defaultMessage:"CPM"},filterLabel:{id:"marketplace.offercatalog.filterByType",defaultMessage:"Filter by type"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(10),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));t.default=function(e){var t=e.organisationId,n=e.logoUrl,o=e.isLoading;return r.createElement("div",{className:"mcs-card-cover"},o?r.createElement(a.Spin,null):r.createElement("img",{src:n||"",alt:t,className:"mcs-cover-image"}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.settingsDefinitions=void 0;var a,r=n(1170),o=n(1165),i=(a=o)&&a.__esModule?a:{default:a},s=n(185);var l={iconType:"users",translation:i.default.accountSettingsTitle,type:"multi",subMenuItems:[Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsAccountProfileList)),{translation:i.default.accountSettingsProfile}),Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsAccountApiTokenList)),{translation:i.default.accountSettingsApiToken})]},c={iconType:"data",translation:i.default.datamartSettingsTitle,type:"multi",subMenuItems:[Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsDatamartAudiencePartitionsList)),{translation:i.default.audiencePartitionsSettingsTitle}),Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsDatamartChannelsList)),{translation:i.default.channelsSettingsTitle}),Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsDatamartCompartments)),{translation:i.default.compartmentsSettingsTitle}),Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsDatamartVisitAnalyzerList)),{translation:i.default.visitAnalyzerSettingsTitle}),Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsDatamartMlFunctionList)),{translation:i.default.mlFunctionSettingsTitle}),Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsDatamartMlAlgorithmList)),{translation:i.default.mlAlgorithmsSettingsTitle}),Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsDatamartCleaningRulesList)),{translation:i.default.cleaningRulesSettingsTitle}),Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsDatamartDatamartList)),{translation:i.default.myDatamartSettingsTitle})]},u={iconType:"settings",translation:i.default.organisationSettingsTitle,type:"multi",subMenuItems:[Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsOrganisationLabelsList)),{translation:i.default.labelsSettingsTitle}),Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsOrganisationProfileList)),{translation:i.default.orgSettingsTitle}),Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsOrganisationUserList)),{translation:i.default.usersSettingsTitle}),Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsOrganisationUserRoleList)),{translation:i.default.userRolesSettingsTitle}),Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsOrganisationProcessingList)),{translation:i.default.processingsSettingsTitle})]},d={iconType:"display",translation:i.default.campaignSettingsTitle,type:"multi",subMenuItems:[Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsCampaignAttributionModelList)),{translation:i.default.campaignSettingsAttributionModels}),Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsCampaignEmailRouterList)),{translation:i.default.campaignSettingsEmailRouters}),Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsCampaignRecommenderList)),{translation:i.default.campaignSettingsRecommenders})]},f={iconType:"file",translation:i.default.serviceOffersSettingsTitle,type:"multi",subMenuItems:[Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsSubscribedOffersList)),{translation:i.default.subscribedOffersSettingsList}),Object.assign(Object.assign({},(0,s.generateMissingdefinitionItemFromRoute)(r.settingsDefinition.settingsMyOffersList)),{translation:i.default.myOffersSettingsList})]};t.settingsDefinitions=[l,u,c,d,f]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.settingsRoutes=t.settingsDefinition=void 0;var a=n(2559),r=n(2562),o=J(n(2564)),i=J(n(2566)),s=J(n(2568)),l=n(2572),c=J(n(2574)),u=J(n(2584)),d=J(n(2590)),f=n(2594),p=J(n(2597)),m=n(2598),g=n(2601),y=n(2604),h=n(2607),v=n(2610),b=n(2613),_=n(185),S=J(n(1013)),E=J(n(2616)),O=J(n(2620)),w=J(n(2621)),M=J(n(851)),P=J(n(2624)),T=J(n(2625)),I=J(n(2627)),A=J(n(852)),C=J(n(2632)),j=J(n(2633)),R=J(n(2654)),N=J(n(2655)),k=J(n(2659)),D=n(2661),F=J(n(2664)),L=J(n(2666)),x=J(n(2667)),G=J(n(2672)),U=J(n(2675)),B=J(n(2679)),q=J(n(1181)),V=n(2686),H=J(n(2689)),Y=J(n(2691)),z=J(n(2695)),W=J(n(2700)),Q=J(n(2704)),K=J(n(2707)),X=J(n(2712));function J(e){return e&&e.__esModule?e:{default:e}}var $=t.settingsDefinition={settingsDatamartSitesCreation:{path:"/settings/datamart/sites/create",layout:"edit",editComponent:u.default,requiredFeature:"datamartSettings-channels",requireDatamart:!0},settingsDatamartSitesEdition:{path:"/settings/datamart/:datamartId/sites/:siteId/edit",layout:"edit",editComponent:u.default,requiredFeature:"datamartSettings-channels",requireDatamart:!0},settingsDatamartMobileAppCreation:{path:"/settings/datamart/mobile_application/create",layout:"edit",editComponent:c.default,requiredFeature:"datamartSettings-channels",requireDatamart:!0},settingsDatamartMobileAppEdition:{path:"/settings/datamart/:datamartId/mobile_application/:mobileApplicationId/edit",layout:"edit",editComponent:c.default,requiredFeature:"datamartSettings-channels",requireDatamart:!0},settingsDatamartChannelsList:{path:"/settings/datamart/channels",layout:"settings",contentComponent:q.default,requiredFeature:"datamartSettings-channels",requireDatamart:!0},settingsDatamartCompartments:{path:"/settings/datamart/compartments",layout:"settings",contentComponent:G.default,requiredFeature:"datamartSettings-compartments",requireDatamart:!0},settingsDatamartCompartmentsCreation:{path:"/settings/datamart/compartments/create",layout:"edit",editComponent:U.default,requiredFeature:"datamartSettings-compartments",requireDatamart:!0},settingsDatamartCompartmentsEdition:{path:"/settings/datamart/:datamartId/compartments/:compartmentId/edit",layout:"edit",editComponent:U.default,requiredFeature:"datamartSettings-compartments",requireDatamart:!0},settingsDatamartAudiencePartitionsList:{path:"/settings/datamart/audience/partitions",layout:"settings",contentComponent:V.AudiencePartitionsPage,requiredFeature:"datamartSettings-audience_partitions",requireDatamart:!0},settingsDatamartAudiencePartitionsEdit:{path:"/settings/datamart/audience/partitions/:partitionId/edit",layout:"edit",editComponent:Y.default,requiredFeature:"datamartSettings-audience_partitions",requireDatamart:!0},settingsDatamartAudiencePartitionsCreate:{path:"/settings/datamart/audience/partitions/create",layout:"edit",editComponent:Y.default,requiredFeature:"datamartSettings-audience_partitions",requireDatamart:!0},settingsDatamartAudiencePartitionsDashboard:{path:"/settings/datamart/audience/partitions/:partitionId",layout:"settings",contentComponent:H.default,requiredFeature:"datamartSettings-audience_partitions"},settingsDatamartCleaningRulesList:{path:"/settings/datamart/cleaning_rules",layout:"settings",contentComponent:z.default,requireDatamart:!0},settingsDatamartUserEventCleaningRulesCreation:{path:"/settings/datamart/cleaning_rules/user_event/create",layout:"edit",editComponent:W.default,requireDatamart:!0},settingsDatamartUserEventCleaningRulesEdition:{path:"/settings/datamart/:datamartId/cleaning_rules/user_event/:cleaningRuleId/edit",layout:"edit",editComponent:W.default,requireDatamart:!0},settingsDatamartUserProfileCleaningRulesCreation:{path:"/settings/datamart/cleaning_rules/user_profile/create",layout:"edit",editComponent:W.default,requireDatamart:!0},settingsDatamartUserProfileCleaningRulesEdition:{path:"/settings/datamart/:datamartId/cleaning_rules/user_profile/:cleaningRuleId/edit",layout:"edit",editComponent:W.default,requireDatamart:!0},settingsDatamartReplicationCreation:{path:"/settings/datamart/datamart_replication/create",layout:"edit",editComponent:B.default,requiredFeature:"datamartSettings-datamart_replication",requireDatamart:!0},settingsDatamartReplicationEdition:{path:"/settings/datamart/:datamartId/datamart_replication/:datamartReplicationId/edit",layout:"edit",editComponent:B.default,requiredFeature:"datamartSettings-datamart_replication",requireDatamart:!0},settingsDatamartAudienceFeatureEdition:{path:"/settings/datamart/:datamartId/audience_feature/:audienceFeatureId/edit",layout:"edit",editComponent:K.default,requiredFeature:"audience-segment_builder_v2",requireDatamart:!0},settingsDatamartAudienceFeatureCreation:{path:"/settings/datamart/:datamartId/audience_feature/create",layout:"edit",editComponent:K.default,requiredFeature:"audience-segment_builder_v2",requireDatamart:!0},settingsDatamartAudienceBuilderEdition:{path:"/settings/datamart/:datamartId/audience_builder/:audienceBuilderId/edit",layout:"edit",editComponent:X.default,requiredFeature:"audience-segment_builder_v2",requireDatamart:!0},settingsDatamartAudienceBuilderCreation:{path:"/settings/datamart/:datamartId/audience_builder/create",layout:"edit",editComponent:X.default,requiredFeature:"audience-segment_builder_v2",requireDatamart:!0},settingsDatamartDatamartList:{path:"/settings/datamart/datamarts",layout:"settings",contentComponent:a.DatamartsListPage,requiredFeature:"datamartSettings-datamarts",requireDatamart:!0},settingsDatamartDatamartView:{path:"/settings/datamart/datamarts/:datamartId",layout:"settings",contentComponent:j.default,requiredFeature:"datamartSettings-datamarts",requireDatamart:!0},settingsDatamartDatamartEdition:{path:"/settings/datamart/datamarts/:datamartId/edit",layout:"edit",editComponent:d.default,requiredFeature:"datamartSettings-datamarts",requireDatamart:!0},settingsDatamartServiceUsageReport:{path:"/settings/datamart/datamarts/:datamartId/service_usage_report",layout:"settings",contentComponent:S.default,requiredFeature:"datamartSettings-service_usage_report",requireDatamart:!0},settingsDatamartSources:{path:"/settings/datamart/datamarts/:datamartId/sources",layout:"settings",contentComponent:C.default,requiredFeature:"datamartSettings-datamarts",requireDatamart:!0},settingsDatamartVisitAnalyzerList:{path:"/settings/datamart/visit_analyzers",layout:"settings",contentComponent:v.VisitAnalyzerContent,requiredFeature:"datamartSettings-visit_analyzers",requireDatamart:!0},settingsDatamartVisitAnalyzerEdition:{path:"/settings/datamart/visit_analyzers/:visitAnalyzerId(\\d+)/edit",layout:"edit",editComponent:b.CreateEditVisitAnalyzer,requiredFeature:"datamartSettings-visit_analyzers",requireDatamart:!0},settingsDatamartVisitAnalyzerCreation:{path:"/settings/datamart/visit_analyzers/create",layout:"edit",editComponent:b.CreateEditVisitAnalyzer,requiredFeature:"datamartSettings-visit_analyzers",requireDatamart:!0},settingsDatamartMlFunctionList:{path:"/settings/datamart/ml_functions",layout:"settings",contentComponent:D.MlFunctionsContent,requiredFeature:"datamartSettings-ml_function",requireDatamart:!0},settingsDatamartMlFunctionEdition:{path:"/settings/datamart/ml_functions/:mlFunctionId(\\d+)/edit",layout:"edit",editComponent:F.default,requiredFeature:"datamartSettings-ml_function",requireDatamart:!0},settingsDatamartMlFunctionCreation:{path:"/settings/datamart/ml_functions/create",layout:"edit",editComponent:F.default,requiredFeature:"datamartSettings-ml_function",requireDatamart:!0},settingsDatamartMlAlgorithmList:{path:"/settings/datamart/ml_algorithms",layout:"settings",contentComponent:R.default,requiredFeature:"datamartSettings-mlAlgorithms"},settingsDatamartMlAlgorithmCreation:{path:"/settings/datamart/ml_algorithms/create",layout:"edit",editComponent:N.default,requiredFeature:"datamartSettings-mlAlgorithms"},settingsDatamartMlAlgorithmEdit:{path:"/settings/datamart/ml_algorithms/:mlAlgorithmId/edit",layout:"edit",editComponent:N.default,requiredFeature:"datamartSettings-mlAlgorithms"},settingsDatamartMlAlgorithmModelsList:{path:"/settings/datamart/ml_algorithms/:mlAlgorithmId/models",layout:"settings",contentComponent:k.default,requiredFeature:"datamartSettings-mlAlgorithms"},settingsOrganisationLabelsList:{path:"/settings/organisation/labels",layout:"settings",contentComponent:r.LabelsListPage,requiredFeature:"organisationSettings-labels"},settingsOrganisationProfileList:{path:"/settings/organisation/profile",layout:"settings",contentComponent:s.default,requiredFeature:"organisationSettings-settings"},settingsOrganisationUserList:{path:"/settings/organisation/users",layout:"settings",contentComponent:o.default,requiredFeature:"organisationSettings-users"},settingsOrganisationUserEdition:{path:"/settings/organisation/users/:userId/edit",layout:"edit",editComponent:E.default,requiredFeature:"organisationSettings-users"},settingsOrganisationUserCreation:{path:"/settings/organisation/users/create",layout:"edit",editComponent:E.default,requiredFeature:"organisationSettings-users"},settingsOrganisationUserRoleList:{path:"/settings/organisation/user_roles",layout:"settings",contentComponent:i.default,requiredFeature:"organisationSettings-user_roles"},settingsOrganisationUserRoleEdition:{path:"/settings/organisation/user_roles/:roleId/user/:userId/edit",layout:"edit",editComponent:Q.default,requiredFeature:"organisationSettings-user_roles"},settingsOrganisationProcessingList:{path:"/settings/organisation/processings",layout:"settings",contentComponent:L.default,requiredFeature:"datamart-user_choices"},settingsOrganisationProcessingEdition:{path:"/settings/organisation/processings/:processingId/edit",layout:"edit",editComponent:x.default,requiredFeature:"datamart-user_choices"},settingsOrganisationProcessingCreation:{path:"/settings/organisation/processings/create",layout:"edit",editComponent:x.default,requiredFeature:"datamart-user_choices"},settingsAccountProfileList:{path:"/settings/account/my_profile",layout:"settings",contentComponent:l.ProfileSettingsPage,requiredFeature:"accountSettings-profile"},settingsAccountApiTokenList:{path:"/settings/account/api_tokens",layout:"settings",contentComponent:O.default,requiredFeature:"accountSettings-api_tokens"},settingsAccountApiTokenEdition:{path:"/settings/account/api_tokens/:apiTokenId/edit",layout:"edit",editComponent:w.default,requiredFeature:"accountSettings-api_tokens"},settingsAccountApiTokenCreation:{path:"/settings/account/api_tokens/create",layout:"edit",editComponent:w.default,requiredFeature:"accountSettings-api_tokens"},settingsCampaignAttributionModelList:{path:"/settings/campaigns/attribution_models",layout:"settings",contentComponent:f.AttributionModelContent,requiredFeature:"campaignsSettings-attribution_models"},settingsCampaignAttributionModelEdition:{path:"/settings/campaigns/attribution_models/:attributionModelId(\\d+)/edit",layout:"edit",editComponent:p.default,requiredFeature:"campaignsSettings-attribution_models"},settingsCampaignAttributionModelCreation:{path:"/settings/campaigns/attribution_models/create",layout:"edit",editComponent:p.default,requiredFeature:"campaignsSettings-attribution_models"},settingsCampaignEmailRouterList:{path:"/settings/campaigns/email_routers",layout:"settings",contentComponent:m.EmailRouterContent,requiredFeature:"campaignsSettings-email_routers"},settingsCampaignEmailRouterEdition:{path:"/settings/campaigns/email_routers/:emailRouterId(\\d+)/edit",layout:"edit",editComponent:g.CreateEditEmailRouter,requiredFeature:"campaignsSettings-email_routers"},settingsCampaignEmailRouterCreation:{path:"/settings/campaigns/email_routers/create",layout:"edit",editComponent:g.CreateEditEmailRouter,requiredFeature:"campaignsSettings-email_routers"},settingsCampaignRecommenderList:{path:"/settings/campaigns/recommenders",layout:"settings",contentComponent:y.RecommenderContent,requiredFeature:"campaignsSettings-recommenders"},settingsCampaignRecommenderEdition:{path:"/settings/campaigns/recommenders/:recommenderId(\\d+)/edit",layout:"edit",editComponent:h.CreateEditRecommender,requiredFeature:"campaignsSettings-recommenders"},settingsCampaignRecommenderCreation:{path:"/settings/campaigns/recommenders/create",layout:"edit",editComponent:h.CreateEditRecommender,requiredFeature:"campaignsSettings-recommenders"},settingsSubscribedOffersList:{path:"/settings/services/subscribed_offers",layout:"settings",contentComponent:M.default,requiredFeature:"servicesSettings-subscribed_offers"},settingsMyOffersList:{path:"/settings/services/my_offers",layout:"settings",contentComponent:P.default,requiredFeature:"servicesSettings-my_offers"},settingsSubscribedOfferServiceItemConditionList:{path:"/settings/services/subscribed_offers/:offerId/service_item_conditions",layout:"settings",contentComponent:T.default,requiredFeature:"servicesSettings-subscribed_offers"},settingsMyOfferServiceItemConditionList:{path:"/settings/services/my_offers/:offerId/service_item_conditions",layout:"settings",contentComponent:I.default,requiredFeature:"servicesSettings-my_offers"},settingsMyOffersCreate:{path:"/settings/services/my_offers/create",layout:"edit",editComponent:A.default,requiredFeature:"servicesSettings-my_offers"},settingsMyOffersEdit:{path:"/settings/services/my_offers/:offerId/edit",layout:"edit",editComponent:A.default,requiredFeature:"servicesSettings-my_offers"}};t.settingsRoutes=(0,_.generateRoutesFromDefinition)($)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(0,n(6).defineMessages)({searchPlaceholder:{id:"settings.organisation.labels.search.placeholder",defaultMessage:"Search Labels"},labelsName:{id:"settings.organisation.labels.name",defaultMessage:"Name"},labelsCreationDate:{id:"settings.organisation.labels.creation_date",defaultMessage:"Creation Date"},newLabel:{id:"settings.organisation.labels.new",defaultMessage:"New Label"},editLabel:{id:"settings.organisation.labels.edit",defaultMessage:"Edit"},archiveLabel:{id:"settings.organisation.labels.archive",defaultMessage:"Archive"},emptyLabels:{id:"settings.organisation.labels.empty",defaultMessage:"There are no Labels set up. Click on 'New Label' to create one."},labelAlreadyExists:{id:"settings.organisation.label.already_exists",defaultMessage:"This Label name is already taken and a Label's name must be unique, please select another one."},saveLabel:{id:"settings.organisation.label.saveLabel",defaultMessage:"Save"},cancelLabel:{id:"settings.organisation.label.cancelLabel",defaultMessage:"Cancel"},addNewLabelTitle:{id:"settings.organisation.label.modal.creation.title",defaultMessage:"Add New Label"},editLabelTitle:{id:"settings.organisation.label.modal.edition.title",defaultMessage:"Edit Label"},archiveModalTitle:{id:"settings.organisation.labels.archiveModal.title",defaultMessage:"Do you want to delete this item ?"}});t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),r=n(6),o=c(n(17)),i=n(68),s=c(n(1171)),l=n(11);function c(e){return e&&e.__esModule?e:{default:e}}t.default=(0,r.injectIntl)((function(e){var t=e.isFetchingLabels,n=e.dataSource,r=e.totalLabels,c=e.noLabelYet,u=e.onFilterChange,d=e.onLabelEdit,f=e.onLabelArchive,p=e.filter,m=e.intl,g={current:p.currentPage,pageSize:p.pageSize,total:r,onChange:function(e){return u({currentPage:e})},onShowSizeChange:function(e,t){return u({pageSize:t,currentPage:1})}},y=[{intlMessage:s.default.labelsName,key:"name",isVisibleByDefault:!0,isHideable:!0},{intlMessage:s.default.labelsCreationDate,key:"creation_ts",isVisibleByDefault:!0,isHideable:!1,render:function(e){return(0,o.default)(e).format("DD/MM/YYYY")}}],h=[{key:"action",actions:function(){return[{intlMessage:s.default.editLabel,callback:d},{intlMessage:s.default.archiveLabel,callback:f}]}}];return c?a.createElement(l.EmptyTableView,{iconType:"full-users",message:m.formatMessage(s.default.emptyLabels)}):a.createElement(i.TableView,{actionsColumnsDefinition:h,columns:y,dataSource:n,loading:t,pagination:g})}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditableLogo=t.Logo=void 0;var a=o(n(2570)),r=o(n(2571));function o(e){return e&&e.__esModule?e:{default:e}}t.Logo=a.default,t.EditableLogo=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=h(n(47)),l=n(8),c=n(61),u=h(n(410)),d=h(n(806)),f=h(n(805)),p=h(n(2578)),m=n(44),g=n(15),y=n(12);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=(0,i.defineMessages)({dropdownAddExisting:{id:"settings.form.activityAnalyzer.addExisting",defaultMessage:"Add Existing"},sectionSubtitleVisitAnalyzer:{id:"settings.form.activityAnalyzer.subtitle",defaultMessage:"Add a Visit Analyzer to your property. A Visit Analyzer is a custom plugin that helps you enhance or modify data before storing it in your DMP."},sectionTitleVisitAnalyzer:{id:"settings.form.activityAnalyzer.title",defaultMessage:"Visit Analyzer"},sectionEmptyVisitAnalyzer:{id:"settings.form.activityAnalyzer.empty",defaultMessage:"There is no Visit Analyzer selected yet!"}}),_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchActivityAnalyzer=function(e){n.cancelablePromise=(0,m.makeCancelable)(Promise.all([n._visitAnalyzerService.getInstanceById(e),n._visitAnalyzerService.getInstanceProperties(e)])),n.cancelablePromise.promise.then((function(e){n.setState({visitAnalyzerData:{visitAnalyzer:e[0].data,properties:e[1].data}})}))},n.updateActivityAnalyzer=function(e){var t=n.props,a=t.fields,r=t.formChange,o=[{key:(0,s.default)(),model:{visit_analyzer_model_id:e[0].id}}];r(a.name,o),n.props.closeNextDrawer()},n.openActivityAnalyzerSelector=function(){var e={selectedVisitAnalyzerIds:n.props.fields.getAll().map((function(e){return e.model.visit_analyzer_model_id})),close:n.props.closeNextDrawer,save:n.updateActivityAnalyzer};n.props.openNextDrawer(p.default,{additionalProps:e})},n.getActivityAnalyzerRecords=function(){var e=n.props.fields,t=n.state.visitAnalyzerData,a=function(e){var n=t.visitAnalyzer&&t.visitAnalyzer.name,a=t.properties.find((function(e){return"name"===e.technical_name})),r=t.properties.find((function(e){return"provider"===e.technical_name}));return n&&a&&r?n+" ("+a.value.value+" - "+r.value.value+")":e.model.visit_analyzer_model_id};return e.map((function(t,n){var r=e.get(n);return o.createElement(f.default,{key:r.key,recordIconType:"optimization",record:r,title:a,onRemove:function(){return e.remove(n)}})}))},n.state={visitAnalyzerData:{properties:[]}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.fields.getAll()[0];e&&this.fetchActivityAnalyzer(e.model.visit_analyzer_model_id)}},{key:"componentDidUpdate",value:function(e){var t=e.fields.getAll()[0],n=this.props.fields.getAll()[0];n&&t!==n&&this.fetchActivityAnalyzer(n.model.visit_analyzer_model_id)}},{key:"componentWillUnmount",value:function(){this.cancelablePromise&&this.cancelablePromise.cancel()}},{key:"render",value:function(){var e=this.props.intl.formatMessage;return o.createElement("div",null,o.createElement(u.default,{dropdownItems:[{id:b.dropdownAddExisting.id,message:b.dropdownAddExisting,onClick:this.openActivityAnalyzerSelector}],subtitle:b.sectionSubtitleVisitAnalyzer,title:b.sectionTitleVisitAnalyzer}),o.createElement(d.default,{emptyOption:{iconType:"optimization",message:e(b.sectionEmptyVisitAnalyzer)}},this.getActivityAnalyzerRecords()))}}]),t}(o.Component);v([(0,g.lazyInject)(y.TYPES.IVisitAnalyzerService)],_.prototype,"_visitAnalyzerService",void 0),t.default=(0,l.compose)(i.injectIntl,c.injectDrawer)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=S(n(0)),i=n(35),s=n(8),l=n(25),c=n(10),u=n(13),d=n(6),f=_(n(60)),p=_(n(2579)),m=_(n(2580)),g=_(n(2581)),y=_(n(2583)),h=S(n(67)),v=n(12),b=n(15);function _(e){return e&&e.__esModule?e:{default:e}}function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=(0,d.defineMessages)({saveEventRules:{id:"settings.form.eventRules.save",defaultMessage:"Save"},error:{id:"settings.form.eventRules.errorType",defaultMessage:"Please specify a known type"}}),w=c.Layout.Content,M=t.FORM_ID="eventRulesForm",P=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={compartments:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;this._datamartService.getUserAccountCompartmentDatamartSelectionResources(this.props.datamartId).then((function(t){e.setState({compartments:t.data})}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.handleSubmit,a=t.breadCrumbPaths,r=t.close,s=t.initialValues,l=t.intl,u={formId:M,paths:a,message:O.saveEventRules,onClose:r};return o.createElement(c.Layout,{className:"edit-layout"},o.createElement(f.default,u),o.createElement(c.Layout,{className:"ant-layout-has-sider"},o.createElement(i.Form,{className:"edit-layout ant-layout",onSubmit:n},o.createElement(w,{id:M,className:"mcs-content-container mcs-form-container"},function(){if(s.model)switch(s.model.type){case"CATALOG_AUTO_MATCH":return o.createElement(p.default,null);case"PROPERTY_TO_ORIGIN_COPY":return o.createElement(y.default,null);case"URL_MATCH":return o.createElement(g.default,null);case"USER_IDENTIFIER_INSERTION":return o.createElement(m.default,{datamartId:e.props.datamartId})}return o.createElement("div",null,l.formatMessage(O.error))}()))))}}]),t}(o.Component);E([(0,b.lazyInject)(v.TYPES.IDatamartService)],P.prototype,"_datamartService",void 0),t.default=(0,s.compose)(d.injectIntl,u.withRouter,(0,i.reduxForm)({form:M,enableReinitialize:!0}),(0,l.connect)((function(e){return{hasDatamarts:h.hasDatamarts(e)}})))(P)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(84),c=(a=l)&&a.__esModule?a:{default:a};function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e){function t(){u(this,t);var e=d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.updateLeftSelect=function(t){var n=e.props.input;n.onChange(Object.assign(Object.assign({},n.value),{leftValue:t.target.value}))},e.updateRightInput=function(t){var n=e.props.input;n.onChange(Object.assign(Object.assign({},n.value),{rightValue:t.target.value}))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.input,n=e.meta,a=e.formItemProps,o=e.helpToolTipProps,l=e.renderFieldAction,u=e.leftFormInput,d=e.rightFormInput,f=e.small,p="success";return n.touched&&n.invalid&&(p="error"),n.touched&&n.warning&&(p="warning"),i.createElement(c.default,r({help:n.touched&&(n.warning||n.error),helpToolTipProps:o,renderFieldAction:l,validateStatus:p,small:f},a),i.createElement("div",{className:"range-filter"},i.createElement("div",{className:"filter-input"},i.createElement(s.Input,r({value:t.value.leftValue,onChange:this.updateLeftSelect},u))),i.createElement("div",{className:"range-filter-separator"},i.createElement("p",{className:"form-split"},"=")),i.createElement("div",{className:"filter-input"},i.createElement(s.Input,r({value:t.value.rightValue,onChange:this.updateRightInput},d)))))}}]),t}(i.Component);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=d(n(49)),l=d(n(63)),c=n(24),u=n(2619);function d(e){return e&&e.__esModule?e:{default:e}}var f=(0,i.defineMessages)({sectionSubtitleGeneral:{id:"settings.organisation.users.edit.generalInfoSection.subtitle",defaultMessage:"Modify your User's role."},sectionTitleGeneral:{id:"settings.organisation.users.edit.roleInfoSection.title",defaultMessage:"Role Information"},labelRoleTitle:{id:"settings.organisation.users.edit.roleInfoSection.label.role",defaultMessage:"Role"}}),p=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage;return r.createElement("div",null,r.createElement(c.FormSection,{subtitle:f.sectionSubtitleGeneral,title:f.sectionTitleGeneral}),r.createElement("div",null,r.createElement(c.FormSelectField,{name:"role",component:c.DefaultSelect,validate:[t],options:u.roleOptions,defaultValueTitle:"None",formItemProps:{label:n(f.labelRoleTitle),required:!0}})))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,s.default,l.default)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=n(10),c=n(33),u=n(13),d=n(6),f=_(n(23)),p=n(11),m=n(847),g=n(851),y=_(n(69)),h=_(n(2626)),v=n(12),b=n(15);function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=l.Layout.Content,O=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchData=function(e,t,a){var r=n.props.offerOwnership,o={first_result:a.page,max_results:a.pageSize},i={first_result:a.page,max_results:a.pageSize,offer_id:t};return a.keywords&&(o.keywords=a.keywords,i.keywords=a.keywords),("subscribed_offer"===r?n._catalogService.getSubscribedServiceItems(e,t,o):n._catalogService.getServiceItems(e,i)).then((function(e){return e.data})).catch((function(e){n.props.notifyError(e)}))},n.onItemClick=function(e){return function(){n.storeItemData(e)}},n.storeItemData=function(e){var t=n.props.offerOwnership;n.setState({serviceItem:e});var a=n.props,r=a.match.params,o=r.organisationId,i=r.offerId,s=a.intl;("subscribed_offer"===t?n._catalogService.getSubscribedServiceItemConditions(o,i,e.id):n._catalogService.getOfferConditions(i)).then((function(e){n.setState({serviceItemCondition:e.data[0],price:s.formatMessage(g.messages.serviceItemPricePlaceholder)})}))},n.getItemTitle=function(e){return e?e.name:void 0},n.renderItem=function(e){var t=e&&n.state.serviceItem&&e.id===n.state.serviceItem.id;return e?i.createElement(l.List.Item,{key:e.id,className:t?"infinite-list-item-selected":"infinite-list-item"},i.createElement(p.Button,{onClick:n.onItemClick(e),style:{textAlign:"left"}},i.createElement(l.List.Item.Meta,{title:n.getItemTitle(e)}))):i.createElement("div",null)},n.state={price:e.intl.formatMessage(g.messages.serviceItemPricePlaceholder)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match.params,a=n.organisationId,r=n.offerId,o=t.offerOwnership;r&&("subscribed_offer"===o?this._catalogService.getSubscribedOffer(a,r):this._catalogService.getMyOffer(a,r)).then((function(t){e.setState({offer:t.data})}))}},{key:"render",value:function(){var e=this.state,t=e.serviceItem,n=e.offer,r=e.serviceItemCondition,o=this.props,s=o.match.params,u=s.organisationId,f=s.offerId,y=o.colors,v=o.intl,b=o.offerOwnership,_=o.intl.formatMessage,S={xKey:"cost",xLabel:_(g.messages.usageCost),yKeys:[{key:"usage_price",message:_(g.messages.usagePrice)}],colors:[y["mcs-primary"]]},O=function(){if(r&&(0,m.isLinearServiceItemConditionsResource)(r)){for(var e=[],t=[0,10,100,1e3,1e4,1e5,1e6,1e7,1e8],n=0;n<t.length;n++){var a=t[n];e.push({usage_price:Math.round(100*(o=a,r&&(0,m.isLinearServiceItemConditionsResource)(r)?r.percent_value*o+r.fixed_value:0))/100,cost:Math.round(Math.log(a)/Math.log(10))})}return e}var o}(),w=O?i.createElement(p.StackedBarPlot,{dataset:O,options:S}):void 0,M=void 0!==w,P="my_offer"===b?i.createElement(c.Link,{to:"/v2/o/"+u+"/settings/services/my_offers/"+f+"/edit"},i.createElement(l.Button,a({},{htmlType:"submit",onClick:function(){return null},type:"primary"},{className:"mcs-primary",style:{float:"right"}}),i.createElement(p.McsIcon,{type:"plus"}),i.createElement(d.FormattedMessage,g.messages.myServiceOffersEdit))):void 0;return i.createElement("div",{className:"ant-layout mcs-service-item-list-page"},i.createElement(E,{className:"mcs-content-container"},i.createElement(l.Row,{className:"mcs-table-container"},i.createElement(l.Breadcrumb,{className:"mcs-breadcrumb",separator:i.createElement(p.McsIcon,{type:"chevron-right"})},i.createElement(l.Breadcrumb.Item,null,i.createElement("span",{style:{lineHeight:"40px"}},i.createElement(c.Link,{to:"/v2/o/"+u+"/settings/services/"+b+"s"},"subscribed_offer"===b?v.formatMessage(g.messages.subscribedOffersTitle):v.formatMessage(g.messages.myOffersTitle)))),i.createElement(l.Breadcrumb.Item,null,i.createElement("span",{style:{lineHeight:"40px"}},n?i.createElement("span",null,n.name):i.createElement("span",null,i.createElement(d.FormattedMessage,g.messages.unknownOffer))),P))),i.createElement(l.Row,{className:"mcs-table-container mcs-settings-card",style:{display:"flex"}},i.createElement(l.Col,{span:6},i.createElement(p.InfiniteList,{fetchData:this.fetchData,renderItem:this.renderItem,storeItemData:this.storeItemData})),i.createElement(l.Col,{span:18,className:"mcs-settings-card-separator"},i.createElement("div",{className:"mcs-card-title service-container-header"},t&&t.name?t.name+" ":void 0,t&&t.type?"("+t.type+")":void 0),i.createElement("div",{className:"service-container"},i.createElement(h.default,{serviceItemCondition:r,serviceItem:t,hasPriceChart:M}),i.createElement("br",null),i.createElement("br",null),w)))))}}]),t}(i.Component);S([(0,b.lazyInject)(v.TYPES.ICatalogService)],O.prototype,"_catalogService",void 0),t.default=(0,s.compose)(u.withRouter,d.injectIntl,f.default,y.default)(O)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(0,n(6).defineMessages)({serviceItemsBreadcrumbTitle:{id:"offer.new.section.service_items.breadcrumb.title",defaultMessage:"Add service item"},serviceItemsSectionSubtitle:{id:"offer.new.section.service_items.subtitle",defaultMessage:"Choose one or several service items."},serviceItemsSectionTitle:{id:"offer.new.section.service_items.title",defaultMessage:"Service Items"},contentSectionServiceItemsEmptyTitle:{id:"offer.new.section.service_items.emptyTitle",defaultMessage:"Click to add a Service Item to your offer"},editServiceItem:{id:"offer.new.section.service_items.edit",defaultMessage:"Edit {serviceItemName}"},saveServiceItem:{id:"message.submit.service_item",defaultMessage:"Save"},serviceItemSelectorColumnName:{id:"serviceItemSelector.column.name",defaultMessage:"Name"},serviceItemSelectorColumnType:{id:"serviceItemSelector.column.type",defaultMessage:"Type"},serviceItemSelectorTitle:{id:"serviceItemSelector.title",defaultMessage:"Add a service item"},serviceItemSelectorSearchPlaceholder:{id:"serviceItemSelector.search.placeholder",defaultMessage:"Search service items"}});t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({compartment_id:{id:"settings.compartments.table.column.compartment_id",defaultMessage:"Compartment ID"},name:{id:"settings.compartments.table.column.name",defaultMessage:"Name"},token:{id:"settings.compartments.table.column.token",defaultMessage:"Token"},default:{id:"settings.compartments.table.column.default",defaultMessage:"Default"},compartments:{id:"settings.compartments",defaultMessage:"User Account Compartment"},editCompartment:{id:"settings.compartments.table.column.edit",defaultMessage:"Edit"},archiveCompartment:{id:"settings.compartments.table.column.archive",defaultMessage:"Archive"},deleteCompartment:{id:"settings.compartments.table.column.delete",defaultMessage:"Delete"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(41),s=n(10),l=n(6),c=n(13),u=M(n(23)),d=n(67),f=n(8),p=n(25),m=n(2639),g=n(15),y=n(12),h=n(33),v=M(n(1182)),b=M(n(2640)),_=n(30),S=n(44),E=n(54),O=M(n(81)),w=n(56);function M(e){return e&&e.__esModule?e:{default:e}}function P(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var T=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},I=s.Layout.Content,A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.computeFilter=function(e,t){if(t){var a=n.state.filter;return{currentPage:a.currentPage,pageSize:a.pageSize,keywords:a.keywords,datamartId:t,types:a.types}}var r=(0,_.parseSearch)(e,n.getSearchSettings());return{currentPage:r.currentPage?r.currentPage:1,pageSize:r.pageSize?r.pageSize:10,keywords:r.keywords?r.keywords:"",datamartId:r.datamartId,types:r.types?r.types:[]}},n.compareFilters=function(e,t){return e.types.every((function(e){return t.types.includes(e)}))&&e.types.length===t.types.length&&e.currentPage===t.currentPage&&e.datamartId===t.datamartId&&e.keywords===t.keywords&&e.pageSize===t.pageSize},n.fetchChannels=function(e,t){var a=n.props.notifyError;n.setState({isFetchingChannels:!0},(function(){var r,o=n._channelService.getChannelsByOrganisation(e,(r=t.types&&1===t.types.length?t.types[0]:void 0,Object.assign(Object.assign({},(0,S.getPaginatedApiParam)(t.currentPage,t.pageSize)),{channel_type:r,keywords:t.keywords,datamart_id:t.datamartId}))).then((function(e){return{channels:e.data,total:e.total?e.total:e.count}})).catch((function(e){a(e);return{channels:[],total:0}})),i=n._datamartService.getDatamarts(e,{allow_administrator:!0,archived:!1}).then((function(e){var t=e.data.map((function(e){return e.id})),a=["sessions","users"],r=new O.default("now-8d"),o=new O.default("now-1d"),i=["channel_id"],s={operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]};return Promise.all(t.map((function(e){return n._datamartUsersAnalyticsService.getAnalytics(e,a,r,o,i,s)}))).then((function(e){return(0,E.flatten)(e.map((function(e){return(0,w.normalizeReportView)(e.data.report_view)})))}))})).catch((function(e){a(e);return[]}));Promise.all([o,i]).then((function(e){var t=e[0],a=e[1],r=t.channels,o=t.total,i=r.map((function(e){var t=a.find((function(t){return t.channel_id&&t.channel_id.toString()===e.id}));return Object.assign(Object.assign({},e),t)}));n.setState({isFetchingChannels:!1,channels:i,totalChannels:o})})).catch((function(e){a(e),n.setState({isFetchingChannels:!1,channels:[],totalChannels:0})}))}))},n.handleEditChannel=function(e){var t=n.props,a=t.match.params.organisationId,r=t.location,o=t.history,i=n.getChannelTypeInUrl(e.type);o.push({pathname:"/v2/o/"+a+"/settings/datamart/"+e.datamart_id+"/"+i+"/"+e.id+"/edit",state:{from:""+r.pathname+r.search}})},n.handleDeleteChannel=function(e){var t=n.props,a=t.match.params.organisationId,r=t.location,l=t.history,c=t.intl.formatMessage,u=t.notifyError;s.Modal.confirm({icon:o.createElement(i.ExclamationCircleOutlined,null),title:c(v.default.deleteChannelModalTitle),okText:c(v.default.deleteChannelModalOk),cancelText:c(v.default.deleteChannelModalCancel),onOk:function(){("SITE"===e.type?n._channelService.deleteSite(e.datamart_id,e.id):n._channelService.deleteMobileApplication(e.datamart_id,e.id)).then((function(e){l.push({pathname:"/v2/o/"+a+"/settings/datamart/channels",state:{from:""+r.pathname+r.search}})})).catch((function(e){u(e)}))},onCancel:function(){}})},n.getChannelTypeInUrl=function(e){return e.toLowerCase()+("SITE"===e?"s":"")},n.buildNewActionElement=function(e,t){var a="/v2/o/"+e+"/settings/datamart/"+n.getChannelTypeInUrl(t)+"/create",r="SITE"===t?v.default.newSite:v.default.newMobileApplication;return o.createElement(h.Link,{key:r.id,to:a},o.createElement(l.FormattedMessage,r))},n.handlePartialFilterChange=function(e){var t=n.props,a=t.location.search,r=t.fixedDatamartOpt,o=n.computeFilter(a,r),i=Object.assign(Object.assign({},o),e);r?n.setState({filter:i}):n.updateLocationSearch(i)},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,_.updateSearch)(o,e,n.getSearchSettings())};a.push(i)},n.state={channels:[],totalChannels:0,isFetchingChannels:!0,noChannelYet:!1,filter:{currentPage:1,pageSize:10,keywords:"",types:[]}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"getSearchSettings",value:function(){return[].concat(P(_.KEYWORD_SEARCH_SETTINGS),P(_.DATAMART_SEARCH_SETTINGS),P(_.PAGINATION_SEARCH_SETTINGS),P(m.TYPE_SEARCH_SETTINGS))}},{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.location.search,a=e.fixedDatamartOpt,r=this.computeFilter(n,a);this.fetchChannels(t,r)}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,a=n.match.params.organisationId,r=n.location.search,o=n.fixedDatamartOpt,i=e.match.params.organisationId,s=e.location.search,l=e.fixedDatamartOpt,c=this.state,u=c.filter,d=c.isFetchingChannels,f=t.filter;if(!(a===i&&(0,_.compareSearches)(r,s)&&this.compareFilters(u,f)&&o===l||d)){var p=this.computeFilter(r,o);this.fetchChannels(a,p)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.location.search,r=t.fixedDatamartOpt,c=this.state,u=c.isFetchingChannels,d=c.totalChannels,f=c.channels,p=c.noChannelYet,m=this.computeFilter(a,r),g=o.createElement(s.Menu,null,o.createElement(s.Menu.Item,null,this.buildNewActionElement(n,"SITE")),o.createElement(s.Menu.Item,null,this.buildNewActionElement(n,"MOBILE_APPLICATION"))),y=[o.createElement(s.Dropdown,{overlay:g,trigger:["click"]},o.createElement(s.Button,{type:"primary"},o.createElement(l.FormattedMessage,v.default.newChannel),o.createElement(i.DownOutlined,null)))],h=[{key:"SITE",value:"Sites"},{key:"MOBILE_APPLICATION",value:"Mobile Applications"}],_=[{displayElement:o.createElement("div",null,o.createElement(l.FormattedMessage,v.default.channelType),o.createElement(i.DownOutlined,null)),selectedItems:h.filter((function(e){return m.types.includes(e.key)})),items:h,singleSelectOnly:!1,getKey:function(e){return e.key},display:function(e){return e.value},handleMenuClick:function(t){var n={currentPage:1,types:t.map((function(e){return e.key}))};e.handlePartialFilterChange(n)}}];return o.createElement("div",{className:"ant-layout"},o.createElement(I,{className:"mcs-content-container"},o.createElement(s.Row,{className:"mcs-table-container"},o.createElement("div",null,o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(l.FormattedMessage,v.default.channels)),o.createElement("span",{className:"mcs-card-button"},y)),o.createElement("hr",{className:"mcs-separator"}),o.createElement(b.default,{dataSource:f,totalChannels:d,isFetchingChannels:u,noChannelYet:p,filter:m,onFilterChange:this.handlePartialFilterChange,onDeleteChannel:this.handleDeleteChannel,onEditChannel:this.handleEditChannel,filtersOptions:_})))))}}]),t}(o.Component);T([(0,g.lazyInject)(y.TYPES.IChannelService)],A.prototype,"_channelService",void 0),T([(0,g.lazyInject)(y.TYPES.IDatamartUsersAnalyticsService)],A.prototype,"_datamartUsersAnalyticsService",void 0),T([(0,g.lazyInject)(y.TYPES.IDatamartService)],A.prototype,"_datamartService",void 0);t.default=(0,f.compose)(c.withRouter,l.injectIntl,u.default,(0,p.connect)((function(e){return{workspace:(0,d.getWorkspace)(e)}})))(A)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(0,n(6).defineMessages)({newChannel:{id:"settings.datamart.channels.new",defaultMessage:"New Channel"},newSite:{id:"settings.datamart.channels.new.site",defaultMessage:"New Site"},newMobileApplication:{id:"settings.datamart.channels.new.mobileApplication",defaultMessage:"New Mobile Application"},datamartFilter:{id:"settings.datamart.channels.datamartFilter",defaultMessage:"Datamart"},channelTypeFilter:{id:"settings.datamart.channels.channelTypeFilter",defaultMessage:"Channel type"},channels:{id:"settings.tab.title.channels",defaultMessage:"Channels"},channelName:{id:"settings.datamart.channels.list.name",defaultMessage:"Name"},channelToken:{id:"settings.datamart.channels.list.token",defaultMessage:"Token"},channelType:{id:"settings.datamart.channels.list.type",defaultMessage:"Type"},channelDatamartId:{id:"settings.datamart.channels.list.datamart.id",defaultMessage:"Datamart Id"},channelDatamartName:{id:"settings.datamart.channels.list.datamart.name",defaultMessage:"Datamart"},channelCreationDate:{id:"settings.datamart.channels.list.creation_date",defaultMessage:"Creation Date"},editChannel:{id:"settings.datamart.channels.list.edit",defaultMessage:"Edit"},deleteChannel:{id:"settings.datamart.channels.list.delete",defaultMessage:"Delete"},deleteChannelModalTitle:{id:"settings.datamart.channel.delete.modal.title",defaultMessage:"You are about to delete a channel from your datamart. This action cannot be undone. Do you want to proceed anyway ?"},deleteChannelModalOk:{id:"settings.datamart.channel.delete.modal.ok",defaultMessage:"Delete Now"},deleteChannelModalCancel:{id:"settings.datamart.channel.delete.modal.cancel",defaultMessage:"Cancel"},emptyChannels:{id:"settings.datamart.channels.list.empty",defaultMessage:"There are no channels of the selected type set up. Click on 'New Channel' to create one."},searchPlaceholder:{id:"settings.datamart.channels.placeholder",defaultMessage:"Search Channels"},lastSevenDaysActivities:{id:"settings.datamart.channels.last.seven.days.activities",defaultMessage:"Activities in the last 7 days"},lastSevenDaysUsers:{id:"settings.datamart.channels.last.seven.days.unique.users",defaultMessage:"User Points in the last 7 days"}});t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DATAMART_REPLICATION_SEARCH_SETTINGS=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(33),s=n(10),l=n(6),c=m(n(206)),u=n(30),d=m(n(2645)),f=n(61),p=m(n(23));function m(e){return e&&e.__esModule?e:{default:e}}function g(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var y=s.Layout.Content,h=(t.DATAMART_REPLICATION_SEARCH_SETTINGS=[].concat(g(u.KEYWORD_SEARCH_SETTINGS),g(u.PAGINATION_SEARCH_SETTINGS)),function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.buildNewActionElement=function(){return r.createElement(s.Button,{key:c.default.newDatamartReplication.id,type:"primary",onClick:function(){var e=n.props,t=e.history,a=e.match.params,r=a.datamartId,o=a.organisationId;t.push({pathname:"/v2/o/"+o+"/settings/datamart/datamart_replication/create",state:{datamartId:r}})}},r.createElement(l.FormattedMessage,c.default.newDatamartReplication))},n.state={datasource:[],total:0,isLoading:!0,noItem:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.isLoadingReplications,n=e.totalReplications,a=e.replications,o=e.noReplication,i=e.onFilterChange,u=e.deleteReplication,f=e.updateReplication,p=e.lastExecutionIsRunning;return r.createElement("div",{className:"ant-layout"},r.createElement(y,{className:"mcs-content-container"},r.createElement(s.Row,{className:"mcs-table-container"},r.createElement("div",null,r.createElement("div",{className:"mcs-card-header mcs-card-title"},r.createElement("span",{className:"mcs-card-title"},r.createElement(l.FormattedMessage,c.default.datamartReplications)),r.createElement("span",{className:"mcs-card-button mcs-replicationNew_button"},this.buildNewActionElement())),r.createElement("hr",{className:"mcs-separator"}),r.createElement(d.default,{dataSource:a,total:n,isLoading:t,noItem:o,onFilterChange:i,deleteReplication:u,updateReplication:f,lastExecutionIsRunning:p})))))}}]),t}(r.Component));t.default=(0,o.compose)(l.injectIntl,i.withRouter,f.injectDrawer,p.default)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(68),l=n(133),c=n(33),u=n(8),d=n(11),f=n(23),p=(a=f)&&a.__esModule?a:{default:a};function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e){function t(){m(this,t);var e=g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.onEditAudienceFeature=function(t){var n=e.props,a=n.match.params,r=a.organisationId,o=a.datamartId;n.history.push({pathname:"/v2/o/"+r+"/settings/datamart/"+o+"/audience_feature/"+t.id+"/edit",state:{from:""+location.pathname+location.search}})},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.intl.formatMessage,a=t.total,r=t.onFilterChange,i=t.noItem,u=t.isLoading,f=t.dataSource,p=t.match.params,m=p.organisationId,g=p.datamartId,y=t.filter,h=t.deleteAudienceFeature,v=t.relatedTable,b={current:y.currentPage,pageSize:y.pageSize,total:a,onChange:function(e,t){return r({currentPage:e,pageSize:t})},onShowSizeChange:function(e,t){return r({pageSize:t,currentPage:1})}},_=[{title:"ID",key:"id",isVisibleByDefault:!0,isHideable:!0,render:function(e){return e}},{intlMessage:l.messages.audienceFeatureName,key:"name",isHideable:!1,render:function(e,t){return o.createElement(c.Link,{to:{pathname:"/v2/o/"+m+"/settings/datamart/"+g+"/audience_feature/"+t.id+"/edit",state:{datamartId:g}}},e)}},{intlMessage:l.messages.audienceFeatureDescription,key:"description",isVisibleByDefault:!0,isHideable:!0,render:function(e){return e}},{intlMessage:l.messages.audienceFeatureObjectTreeExpression,key:"object_tree_expression",isVisibleByDefault:!0,isHideable:!0,render:function(e){return e}}],S=[{key:"action",actions:function(){return[{intlMessage:l.messages.audienceFeatureEdit,callback:e.onEditAudienceFeature},{intlMessage:l.messages.audienceFeatureDelete,callback:h}]}}],E={placeholder:n(l.messages.audienceFeatureSearchPlaceholder),onSearch:function(e){return r({keywords:e})},defaultValue:y.keywords};return i&&!u?o.createElement(d.EmptyTableView,{iconType:"settings",message:n(l.messages.audienceFeatureEmptyList),className:"mcs-table-view-empty mcs-empty-card mcs-audienceFeature_table"}):o.createElement(s.TableViewFilters,{columns:_,actionsColumnsDefinition:S,searchOptions:E,dataSource:f,loading:u,pagination:b,relatedTable:v,className:"mcs-audienceFeature_table"})}}]),t}(o.Component);t.default=(0,u.compose)(i.injectIntl,c.withRouter,p.default)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(35),i=n(13),s=n(6),l=n(8),c=m(n(635)),u=m(n(2657)),d=m(n(60)),f=m(n(101)),p=n(10);function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=t.FORM_ID="mlAlgorithmForm",v=p.Layout.Content,b=function(e){function t(){g(this,t);var e=y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFormSections=function(){var e=[],t={id:"general",title:c.default.sectionTitleGeneral,component:r.createElement(u.default,null)};return e.push(t),e},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.onSave,a={formId:h,paths:this.props.breadCrumbPaths,message:c.default.saveMlAlgorithm,onClose:this.props.onClose},i=this.buildFormSections(),s={items:i.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:h},l=i.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==i.length-1&&r.createElement("hr",null))}));return r.createElement(p.Layout,{className:"edit-layout"},r.createElement(d.default,a),r.createElement(p.Layout,{className:"ant-layout-has-sider"},r.createElement(f.default,s),r.createElement(o.Form,{className:"edit-layout ant-layout",onSubmit:t(n)},r.createElement(v,{id:h,className:"mcs-content-container mcs-form-container"},r.createElement("div",{className:"placement-list-form"},l)))))}}]),t}(r.Component);t.default=(0,l.compose)(i.withRouter,s.injectIntl,(0,o.reduxForm)({form:h,enableReinitialize:!0}))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(0,n(6).defineMessages)({id:{id:"settings.organisation.ml-models.id",defaultMessage:"Id"},name:{id:"settings.organisation.ml-models.name",defaultMessage:"Name"},description:{id:"settings.organisation.ml-models.description",defaultMessage:"Description"},lastUpdatedDate:{id:"settings.organisation.ml-models.last-updated-date",defaultMessage:"Last Updated Date"},status:{id:"settings.organisation.ml-models.status",defaultMessage:"Status"},statusPaused:{id:"settings.organisation.ml-models.status-paused",defaultMessage:"Paused"},statusLive:{id:"settings.organisation.ml-models.status-live",defaultMessage:"Live"},empty:{id:"settings.organisation.ml-models.empty",defaultMessage:"No ML Models"},newMlAlgorithmModel:{id:"settings.organisation.ml-models.new",defaultMessage:"New ML Algorithm Model"},mlAlgorithmModels:{id:"settings.organisation.ml-models.placeholder",defaultMessage:"ML Algorithm Models"},uploadTitle:{id:"settings.organisation.ml-models.upload.title",defaultMessage:"Create your ML Model"},uploadConfirm:{id:"settings.organisation.ml-models.upload.confirm",defaultMessage:"Create ML Model"},uploadMessageNotebook:{id:"settings.organisation.ml-models.upload.message-notebook",defaultMessage:"Put your notebook here"},uploadMessageResult:{id:"settings.organisation.ml-models.upload.message-result",defaultMessage:"Put the notebook result as html here"},uploadMessageModel:{id:"settings.organisation.ml-models.upload.message-model",defaultMessage:"Put your model here"},namePlaceholder:{id:"settings.organisation.ml-models.upload.name.placeholder",defaultMessage:"Name Placeholder"},nameTooltip:{id:"settings.organisation.ml-models.upload.name.tooltip",defaultMessage:"Name tooltip"},modelCreationError:{id:"settings.organisation.ml-models.create.error",defaultMessage:"Error while creating the model"},downloadBinary:{id:"settings.organisation.ml-models.download.binary",defaultMessage:"Download Binary"},downloadResult:{id:"settings.organisation.ml-models.download.result",defaultMessage:"Download Result"},downloadNotebook:{id:"settings.organisation.ml-models.download.notebook",defaultMessage:"Download Notebook"},previewResult:{id:"settings.organisation.ml-models.download.preview-result",defaultMessage:"Preview Result"},updateSuccess:{id:"settings.organisation.ml-models.edit.save.successMessage",defaultMessage:"ML Model successfully saved"},updateError:{id:"settings.organisation.ml-models.edit.list.errorMessage",defaultMessage:"ML Model update failed"},modelsLoadingError:{id:"settings.organisation.ml-models.edit.list.errorLoadingMessage",defaultMessage:"ML Models loading failed"},previewModalTitle:{id:"settings.organisation.ml-models.edit.list.preview-modal-title",defaultMessage:"Notebook's preview"},closeModal:{id:"settings.organisation.ml-models.edit.list.close-modal",defaultMessage:"Close"},createModelNameLabel:{id:"settings.organisation.ml-models.edit.create-model-name-label",defaultMessage:"Name"},modelNameIsRequired:{id:"settings.organisation.ml-models.edit.mode-name-is-required",defaultMessage:"An ML model name is required"}});t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({listTitle:{id:"mlFunction.edit.list.title",defaultMessage:"Ml Function"},listSubTitle:{id:"mlFunction.edit.list.subtitle",defaultMessage:"New Ml Function"},createBreadcrumb:{id:"mlFunction.create.breadcrumb.newtitle",defaultMessage:"New Ml Function"},editBreadcrumb:{id:"mlFunction.create.breadcrumb.editTitle",defaultMessage:"Edit {name}"},labelHostingObjectType:{id:"mlFunction.create.field.hosting_object_type.label",defaultMessage:"Hosting Object Type"},tootltipHostingObjectType:{id:"mlFunction.create.field.hosting_object_type.tooltip",defaultMessage:"The Hosting Object Type is the name of the object on which you want to create the field for your new Ml Function. Typically it is UserPoint."},labelFieldTypeName:{id:"mlFunction.create.field.field_type_name.label",defaultMessage:"Field Type Name"},tootltipFieldTypeName:{id:"mlFunction.create.field.field_type_name.tooltip",defaultMessage:"The Field Type Name is the name of the Node for your new Ml Function."},labelFieldName:{id:"mlFunction.create.field.field_name.label",defaultMessage:"Field Name"},tootltipFieldName:{id:"mlFunction.create.field.field_name.tooltip",defaultMessage:"The Field Name is the name of the field on which you want to attach your new Ml Function."},labelQuery:{id:"mlFunction.create.field.query.label",defaultMessage:"Query"},tootltipQuery:{id:"mlFunction.create.field.query.tooltip",defaultMessage:"The GraphQL Query that will be executed before each call to your Ml Function."}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(33),i=n(41),s=n(8),l=n(6);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f=function(e){function t(){return c(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d(t,e),t}(n(68).TableViewFilters),p=function(e){function t(){c(this,t);var e=u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.getFiltersOptions=function(){var t=e.props,n=t.datamarts,a=t.filter,o=t.onChange;if(n.length>1){var s=n.map((function(e){return{key:e.id,value:e.name||e.token}})).concat([{key:"",value:"All"}]);return[{displayElement:r.createElement("div",null,r.createElement(l.FormattedMessage,{id:"audience.partitions.list.datamartFilter",defaultMessage:"Datamart"})," ",r.createElement(i.DownOutlined,null)),selectedItems:a.datamartId?[s.find((function(e){return e.key===a.datamartId}))]:[s],items:s,singleSelectOnly:!0,getKey:function(e){return e&&e.key?e.key:""},display:function(e){return e.value},handleItemClick:function(e){o({datamartId:e&&e.key?e.key:void 0})}}]}return[]},e}return d(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.audiencePartitions,n=e.fetchingPartitions,a=e.organisationId,i=e.intl,s=e.filter,l=e.onChange,c=e.onEdit,u={placeholder:i.formatMessage(m.searchPlaceholder),onSearch:function(e){return l({keywords:e})},defaultValue:s.keywords},d={current:s.currentPage,pageSize:s.pageSize,total:t&&(t.total||t.count)||0,onChange:function(e){return l({currentPage:e})},onShowSizeChange:function(e,t){return l({currentPage:1,pageSize:t})}},p=[{intlMessage:m.columnName,key:"name",render:function(e,t){return r.createElement(o.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+a+"/settings/datamart/audience/partitions/"+t.id},e)}},{intlMessage:m.columnType,key:"audience_partition_type",isHideable:!1,render:function(e,t){return r.createElement("span",null,t.audience_partition_type)}},{intlMessage:m.columnPartCount,key:"part_count",render:function(e,t){return r.createElement("span",null,t.part_count)}},{intlMessage:m.columnStatus,key:"status",render:function(e,t){return r.createElement("span",null,t.status)}}],g=[{key:"action",actions:function(){return[{intlMessage:m.edit,callback:c}]}}];return r.createElement("div",{className:"mcs-table-container"},r.createElement(f,{columns:p,actionsColumnsDefinition:g,searchOptions:u,dataSource:t?t.data:[],loading:n,pagination:d,filtersOptions:this.getFiltersOptions()}))}}]),t}(r.Component);t.default=(0,s.compose)(l.injectIntl)(p);var m=(0,l.defineMessages)({columnName:{id:"audience.partitions.table.column.name",defaultMessage:"Name"},columnType:{id:"audience.partitions.table.column.type",defaultMessage:"Type"},columnPartCount:{id:"audience.partitions.table.column.part_count",defaultMessage:"Part Count"},columnStatus:{id:"audience.partitions.table.column.status",defaultMessage:"Status"},searchPlaceholder:{id:"audience.partitions.search.placeholder",defaultMessage:"Search Audience Partitions"},edit:{id:"audience.partitions.table.action.edit",defaultMessage:"Edit"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(25),i=n(10),s=n(33),l=n(6),c=n(8),u=n(107),d=n(11),f=n(67);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=(0,l.defineMessages)({AUDIENCE_PARTITIONS:{id:"audience.partitions.list.actionbar.beardCrumbPath.partitions",defaultMessage:"Partitions"}}),y=function(e){function t(){return p(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.defaultDatamart,a=e.intl,o=n(t).id,c=r.createElement(i.Menu,null,r.createElement(i.Menu.Item,{key:"RANDOM_SPLIT"},r.createElement(s.Link,{to:"/v2/o/"+t+"/settings/datamart/audience/partitions/create?datamarts="+o+"&type=RANDOM_SPLIT"},r.createElement(l.FormattedMessage,{id:"audience.partitions.list.actionbar.menu.randomSplit",defaultMessage:"Random Split"})))),f=[{name:a.formatMessage(g.AUDIENCE_PARTITIONS),path:"/v2/o/"+t+"/settings/datamart/audience/partitions"}];return r.createElement(d.Actionbar,{paths:f},r.createElement(u.Dropdown,{overlay:c,trigger:["click"]},r.createElement(i.Button,{className:"mcs-primary",type:"primary"},r.createElement(d.McsIcon,{type:"plus"})," ",r.createElement(l.FormattedMessage,{id:"audience.partitions.list.actionbar.newPartition",defaultMessage:"New Partition"}))))}}]),t}(r.Component);t.default=(0,c.compose)(s.withRouter,l.injectIntl,(0,o.connect)((function(e){return{defaultDatamart:(0,f.getDefaultDatamart)(e)}}),void 0))(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isUserEventCleaningRuleResource=function(e){return"USER_EVENT_CLEANING_RULE"===e.type},t.isUserProfileCleaningRuleResource=function(e){return"USER_PROFILE_CLEANING_RULE"===e.type},t.getNextCleaningRuleStatus=function(e){switch(e){case"DRAFT":return"LIVE";default:return"ARCHIVED"}}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(77),s=n(35),l=n(6),c=n(13),u=n(8),d=y(n(60)),f=y(n(424)),p=y(n(2701)),m=y(n(2703)),g=y(n(101));function y(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=t.FORM_ID="cleaningRuleForm",_=o.Layout.Content,S=function(e){function t(){return h(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.breadCrumbPaths,a=e.close,s=e.goToDatamartSelector,l=e.options,c=e.cleaningRuleType,u=e.change,y={formId:b,paths:n,message:"USER_EVENT_CLEANING_RULE"===c?f.default.saveUserEventCleaningRule:f.default.saveUserProfileCleaningRule,onClose:a},h=[];h.push({id:"action",title:f.default.sectionActionTitle,component:r.createElement(p.default,{cleaningRuleType:c})}),h.push({id:"scope",title:f.default.sectionScopeTitle,component:r.createElement(m.default,{options:l,cleaningRuleType:c,formChange:u})});var v={items:[{sectionId:"datamart",title:f.default.sectionDatamartTitle,onClick:s}].concat(h.map((function(e){return{sectionId:e.id,title:e.title,onClick:void 0}}))),scrollId:b},S=h.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==h.length-1&&r.createElement("hr",null))}));return r.createElement(o.Layout,{className:"edit-layout"},r.createElement(d.default,y),r.createElement(o.Layout,{className:"ant-layout-has-sider"},r.createElement(g.default,v),r.createElement(i.Form,{className:"edit-layout ant-layout",onSubmit:t},r.createElement("button",{type:"submit",style:{display:"none"}}),r.createElement(_,{id:b,className:"mcs-content-container mcs-form-container"},S))))}}]),t}(r.Component);t.default=(0,u.compose)(l.injectIntl,c.withRouter,(0,s.reduxForm)({form:b,enableReinitialize:!0}))(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openCloseMenu=void 0;var a=n(247),r=n(104);t.openCloseMenu=function(e){return(0,a.createAction)(r.MENU_OPEN_CLOSE)(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IocProvider=void 0,t.useInjection=function(e){var t=(0,r.useContext)(i).container;if(!t)throw new Error;return t.get(e)};var a,r=n(0),o=(a=r)&&a.__esModule?a:{default:a};var i=o.default.createContext({container:null});t.IocProvider=function(e){return o.default.createElement(i.Provider,{value:{container:e.container}},e.children)}},,,,,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var a=i(n(0)),r=n(34),o=i(n(1275));function i(e){return e&&e.__esModule?e:{default:e}}(0,r.render)(a.default.createElement(o.default,null),document.getElementById("mcs-react-app"))},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(885);var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(25),i=u(n(1279)),s=u(n(1415)),l=n(1194),c=n(15);function u(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=(0,i.default)(),m=function(e){function t(){return d(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){return r.createElement(o.Provider,{store:p},r.createElement(l.IocProvider,{container:c.container},r.createElement(s.default,null)))}}]),t}(r.Component);t.default=m},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bindDependencies=void 0;var a=n(87),r=d(n(886)),o=d(n(645)),i=n(1280),s=d(n(1309)),l=d(n(1320)),c=d(n(15)),u=n(12);function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){var n=t.map((function(e){return c.default.container.get(e)}));return e.bind.apply(e,[e].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(n)))}t.bindDependencies=f,t.default=f((function(e,t,n,c,u,d){var f=[],p=(0,o.default)({context:{navigatorService:e,authService:t,labelService:n,organisationService:c,tagService:u}});f.push(i.logoutListener),f.push(r.default),f.push(i.apiRequest),f.push(p);var m=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||a.compose,g=d?(0,a.createStore)(s.default,d,m(a.applyMiddleware.apply(void 0,f))):(0,a.createStore)(s.default,m(a.applyMiddleware.apply(void 0,f)));return p.run(l.default),g}),[u.TYPES.INavigatorService,u.TYPES.IAuthService,u.TYPES.ILabelService,u.TYPES.IOrganisationService,u.TYPES.ITagService])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logoutListener=t.apiRequest=void 0;var a=o(n(1281)),r=o(n(1308));function o(e){return e&&e.__esModule?e:{default:e}}t.apiRequest=a.default,t.logoutListener=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CALL_API=void 0;var a,r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=n(46),i=(a=o)&&a.__esModule?a:{default:a};var s=t.CALL_API=Symbol("Call Api");t.default=function(e){return function(t){return function(n){var a=n[s];if(void 0===a)return t(n);var o=a.method,l=a.endpoint,c=a.params,u=a.headers,d=a.body,f=a.types,p=a.authenticated,m=a.adminApi,g=a.localUrl,y=a.others,h=void 0===y?{}:y,v=r(f,3),b=v[0],_=v[1],S=v[2],E=e.dispatch,O={adminApi:m,localUrl:g};return E({type:b,others:h}),i.default.request(o,l,c,u,d,p,O).then((function(e){return E(function(e,t){return{type:e,response:t,authenticated:!0,body:d,others:h}}(S,e))})).catch((function(e){return E(function(e,t){return{type:e,others:h,response:t}}(_,e)),Promise.reject(e)}))}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(261);t.default=function(e){return function(e){return function(t){return"LOGOUT"===t.type&&(a.LocalStorage.removeItem("access_token"),a.LocalStorage.removeItem("refresh_token")),e(t)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(87),r=m(n(1310)),o=m(n(1311)),i=m(n(1313)),s=m(n(1314)),l=m(n(1315)),c=m(n(1316)),u=m(n(1317)),d=m(n(1318)),f=m(n(1319)),p=n(736);function m(e){return e&&e.__esModule?e:{default:e}}var g=Object.assign({},r.default,o.default,i.default,s.default,l.default,c.default,u.default,d.default,f.default,p.drawerReducer);t.default=(0,a.combineReducers)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(35).reducer;t.default={form:a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(104),r={app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{initialized:!1,initializationError:!1},t=arguments[1];switch(t.type){case a.APP_STARTUP.SUCCESS:return Object.assign(Object.assign({},e),{initialized:!0});case a.APP_STARTUP.FAILURE:return Object.assign(Object.assign({},e),{initializationError:!0,error:t.payload});default:return e}}};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="REQUEST",r="SUCCESS",o="FAILURE",i="EXPIRED_PASSWORD",s=(t.createRequestTypes=function(e){return[a,r,o,i].reduce((function(t,n){return Object.assign(Object.assign({},t),(o=e+"_"+n,(r=n)in(a={})?Object.defineProperty(a,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):a[r]=o,a));var a,r,o}),{REQUEST:"",SUCCESS:"",FAILURE:"",EXPIRED_PASSWORD:""})},{isFetching:!1,error:!1,total:0});t.createRequestMetadataReducer=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,n=arguments[1];switch(n.type){case e.REQUEST:return Object.assign(Object.assign({},t),{isFetching:!0});case e.SUCCESS:return Object.assign(Object.assign({},t),{isFetching:!1,total:n.payload.total});case e.FAILURE:case e.EXPIRED_PASSWORD:return Object.assign(Object.assign({},t),{isFetching:!1,error:n.payload});default:return t}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(104),r={theme:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{colors:{}},t=arguments[1];switch(t.type){case a.STORE_THEME_COLOR:return Object.assign(Object.assign({},e),{colors:t.payload});default:return e}}};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(104),r={features:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{organisation:[]},t=arguments[1];switch(t.type){case a.STORE_ORG_FEATURES:return Object.assign(Object.assign({},e),{organisation:t.payload});case a.STORE_FEATURE_FLAG_CLIENT:return Object.assign(Object.assign({},e),{client:t.payload});default:return e}}};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(104);function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.default={notifications:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case a.NOTIFICATIONS_ADD:return[].concat(r(e),[t.payload]);case a.NOTIFICATIONS_REMOVE:return e.filter((function(e){return e.uid!==t.payload.id}));case a.NOTIFICATIONS_RESET:return[];default:return e}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(104),r={hasError:!1,error:{}},o={login:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,t=arguments[1];switch(t.type){case a.LOG_IN.REQUEST:return Object.assign({},e);case a.LOG_IN.FAILURE:case a.LOG_IN.EXPIRED_PASSWORD:return{hasError:!0,error:t.payload};case a.LOG_IN.SUCCESS:return r;default:return e}}};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(104),r={workspace:{datamarts:[]},connectedUser:{workspaces:[]},cookies:{mics_lts:"",mics_uaid:"",mics_vid:""},connectedUserLoaded:!1,isFechingCookies:!0,isFetchingWorkspace:!1,isUploadingLogo:!1},o={session:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,t=arguments[1];switch(t.type){case a.CONNECTED_USER.SUCCESS:return Object.assign(Object.assign({},e),{connectedUserLoaded:!0,connectedUser:Object.assign(Object.assign({},t.payload),{workspaces:t.payload.workspaces})});case a.WORKSPACE.REQUEST:return Object.assign(Object.assign({},e),{isFetchingWorkspace:!0});case a.WORKSPACE.SUCCESS:return Object.assign(Object.assign({},e),{isFetchingWorkspace:!1,workspace:Object.assign({},t.payload)});case a.WORKSPACE.FAILURE:return Object.assign(Object.assign({},e),{isFetchingWorkspace:!1});case a.FETCH_COOKIES.REQUEST:return Object.assign(Object.assign({},e),{isFechingCookies:!0});case a.FETCH_COOKIES.SUCCESS:return Object.assign(Object.assign({},e),{isFechingCookies:!1,cookies:Object.assign({},t.payload.cookies)});case a.FETCH_COOKIES.FAILURE:return Object.assign(Object.assign({},e),{isFechingCookies:!1,cookies:Object.assign({},t.payload)});case a.GET_LOGO.SUCCESS:return Object.assign(Object.assign({},e),{logoUrl:t.payload.logoUrl});case a.PUT_LOGO.REQUEST:return Object.assign(Object.assign({},e),{isUploadingLogo:!0});case a.PUT_LOGO.FAILURE:case a.PUT_LOGO.SUCCESS:return Object.assign(Object.assign({},e),{isUploadingLogo:!1});case a.LOG_OUT:return r;default:return e}}};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(87),r=n(104),o={isFetching:!1,data:[],total:0},i={labels:(0,a.combineReducers)({labelsApi:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments[1];switch(t.type){case r.LABELS_FETCH.REQUEST:return Object.assign(Object.assign({},e),{isFetching:!0});case r.LABELS_FETCH.SUCCESS:return Object.assign(Object.assign(Object.assign({},e),{isFetching:!1}),t.payload);case r.LABELS_FETCH.FAILURE:return Object.assign(Object.assign({},e),{isFetching:!1});case r.LABELS_RESET:return o;default:return e}}})};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(104),r={collapsed:!1,mode:"inline"},o={menu:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,t=arguments[1];switch(t.type){case a.MENU_OPEN_CLOSE:return Object.assign(Object.assign({},e),t.payload);default:return e}}};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=f;var a=n(248),r=n(1321),o=n(1325),i=n(1327),s=n(1328),l=n(1329),c=n(1330),u=regeneratorRuntime.mark(f);function d(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function f(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.all)([].concat(d(r.appSagas),d(i.sessionSagas),d(o.loginSagas),d(l.versionSagas),d(s.labelsSagas),d(c.featuresSagas)));case 2:case"end":return e.stop()}}),u,this)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.appSagas=void 0,n(737);var a=n(248),r=n(1322),o=n(104),i=regeneratorRuntime.mark(l),s=regeneratorRuntime.mark(c);function l(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,a.getContext)("authService");case 2:if(!(e=t.sent).isAuthenticated()&&!e.canAuthenticate()){t.next=6;break}return t.next=6,(0,a.all)([(0,a.take)([o.CONNECTED_USER.SUCCESS,o.LOG_IN.FAILURE,o.CONNECTED_USER.FAILURE])]);case 6:case"end":return t.stop()}}),i,this)}function c(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.call)(l);case 2:return e.next=4,(0,a.put)(r.appStartup.success());case 4:case"end":return e.stop()}}),s,this)}t.appSagas=[(0,a.fork)(c)]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.appStartup=void 0;var a=n(247),r=n(104),o={request:(0,a.createAction)(r.APP_STARTUP.REQUEST),success:(0,a.createAction)(r.APP_STARTUP.SUCCESS),failure:(0,a.createAction)(r.APP_STARTUP.FAILURE)};t.appStartup=o},,,function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.loginSagas=void 0;var a,r=n(645),o=n(248),i=n(1239),s=n(59),l=(a=s)&&a.__esModule?a:{default:a},c=n(104),u=n(738),d=n(322),f=n(898),p=n(67);var m=regeneratorRuntime.mark(v),g=regeneratorRuntime.mark(b),y=regeneratorRuntime.mark(_),h=regeneratorRuntime.mark(S);function v(e){var t,n,a,r,i,s;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,o.getContext)("authService");case 2:return t=c.sent,c.next=5,(0,o.call)(t.createAccessToken,e);case 5:return n=c.sent,a=n.data,r=a.access_token,i=a.expires_in,s=a.refresh_token,c.next=9,(0,o.call)(t.setAccessToken,r);case 9:return c.next=11,(0,o.call)(t.setAccessTokenExpirationDate,i);case 11:if(!s){c.next=19;break}return l.default.debug("Store refresh token "+s),c.next=15,(0,o.call)(t.setRefreshToken,s);case 15:return c.next=17,(0,o.call)(t.setRefreshTokenExpirationDate,i);case 17:return c.next=19,(0,o.call)(t.setIsLogged,!0);case 19:return c.next=21,(0,o.put)(u.logIn.success(r));case 21:return c.abrupt("return",n);case 22:case"end":return c.stop()}}),m,this)}function b(t){var n,a,s,m,y,h,b,_,S,E,O,w=arguments.length>1&&void 0!==arguments[1]&&arguments[1],M=arguments.length>2&&void 0!==arguments[2]&&arguments[2],P=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return regeneratorRuntime.wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,o.getContext)("authService");case 2:return n=g.sent,g.next=5,(0,o.getContext)("tagService");case 5:if(a=g.sent,g.prev=6,s=void 0,!w&&!M){g.next=12;break}return g.next=11,(0,o.call)(n.getRefreshToken);case 11:s=g.sent;case 12:if(w||!M){g.next=21;break}if(!s){g.next=16;break}return g.next=16,(0,o.call)(v,{refreshToken:s});case 16:return g.next=18,(0,o.call)(n.getRefreshToken);case 18:s=g.sent,g.next=44;break;case 21:if(!P){g.next=41;break}return g.prev=22,g.next=25,(0,o.call)(n.createRefreshToken,t);case 25:s=g.sent,g.next=36;break;case 28:if(g.prev=28,g.t0=g.catch(22),"EXPIRED_PASSWORD_ERROR"!==g.t0.error_code){g.next=35;break}return g.next=33,(0,o.put)(u.logIn.expiredPassword(g.t0));case 33:g.next=36;break;case 35:throw g.t0;case 36:if(!s){g.next=39;break}return g.next=39,(0,o.call)(v,{refreshToken:s});case 39:g.next=44;break;case 41:if(w||M){g.next=44;break}return g.next=44,(0,o.put)(c.LOG_OUT);case 44:return m=void 0,g.next=47,(0,o.select)(p.getStoredConnectedUser);case 47:if(!(y=g.sent)||!y.id){g.next=52;break}m=y,g.next=56;break;case 52:if(!s){g.next=56;break}return g.next=55,(0,o.call)(n.getConnectedUser);case 55:m=g.sent;case 56:if(!m){g.next=89;break}return h=Object.assign(Object.assign({},m),{workspaces:m.workspaces.map((function(e){return e.datamarts&&e.datamarts.length&&e.datamarts.forEach((function(e){var t=e;return e.audience_segment_metrics&&e.audience_segment_metrics.length&&(t.audience_segment_metrics=e.audience_segment_metrics.filter((function(e){return"LIVE"===e.status}))),t})),e}))}),g.next=60,(0,o.put)((0,f.setOrgFeature)(e.window.MCS_CONSTANTS.FEATURES));case 60:return b=function(){return new Promise((function(e,t){var n=(0,i.SplitFactory)({core:{authorizationKey:"9o6sgmo2fbk275ao4cugtnd9ch6sb3fstv1d",key:m.id,trafficType:"user"}}).client();n.on(n.Event.SDK_READY,(function(){return e(n)})),n.on(n.Event.SDK_READY_TIMED_OUT,(function(){return e(null)}))}))},g.next=63,(0,o.call)(b);case 63:return _=g.sent,g.next=66,(0,o.put)((0,f.setClientFeature)(_));case 66:return a.addUserAccountProperty(m.id),a.setUserProperties(h),g.next=70,(0,o.put)(d.getConnectedUser.success(h));case 70:window.userId=m.id,window.organisationId=m.workspaces[m.default_workspace].organisation_id;case 72:return S=void 0,S=n.tokenExpiresIn(n.getAccessTokenExpirationDate()),l.default.debug("Will refresh access token in "+S+" ms"),g.next=78,(0,o.call)(r.delay,S);case 78:return g.next=80,(0,o.call)(n.getRefreshToken);case 80:if(E=g.sent,l.default.debug("Authorize user with refresh token "+E),!E){g.next=87;break}return g.next=85,(0,o.call)(v,{refreshToken:E});case 85:O=g.sent,S=O.data.expires_in;case 87:g.next=72;break;case 89:g.next=98;break;case 91:return g.prev=91,g.t1=g.catch(6),l.default.error("Authorize error : ",g.t1),g.next=96,(0,o.call)(n.deleteCredentials);case 96:return g.next=98,(0,o.put)(u.logIn.failure(g.t1));case 98:case"end":return g.stop()}}),g,this,[[6,91],[22,28]])}function _(){var e,t,n,a,r,i,s,l,u;return regeneratorRuntime.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,o.getContext)("authService");case 2:e=d.sent;case 3:return d.next=6,(0,o.call)(e.isAuthenticated);case 6:return t=d.sent,d.next=9,(0,o.call)(e.canAuthenticate);case 9:if(n=d.sent,a=null,r=!1,t||n||!c.LOG_IN.REQUEST){d.next=23;break}return d.next=15,(0,o.take)(c.LOG_IN.REQUEST);case 15:return i=d.sent,s=i.payload,d.next=19,(0,o.call)(e.setRememberMe,!!s.remember);case 19:a={email:s.email,password:s.password},r=!0,d.next=24;break;case 23:!t&&n&&(a={refreshToken:e.getRefreshToken()});case 24:return d.next=26,(0,o.race)({signOutAction:(0,o.take)(c.LOG_OUT),authorizeLoop:(0,o.call)(b,a,t,n,r)});case 26:if(l=d.sent,!(u=l.signOutAction)){d.next=37;break}return window.userId=void 0,d.next=32,(0,o.call)(e.revokeRefreshToken);case 32:return d.next=34,(0,o.call)(e.deleteCredentials);case 34:return d.next=36,(0,o.call)(e.setIsLogged,!1);case 36:u.meta&&u.meta.redirectCb&&u.meta.redirectCb();case 37:d.next=3;break;case 39:case"end":return d.stop()}}),y,this)}function S(){var e,t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=3,(0,o.take)(c.LOG_IN.REQUEST);case 3:return e=n.sent,t=e.meta.redirect,n.next=7,(0,o.all)([(0,o.take)(c.CONNECTED_USER.SUCCESS),(0,o.take)(c.STORE_ORG_FEATURES)]);case 7:t(),n.next=0;break;case 10:case"end":return n.stop()}}),h,this)}t.loginSagas=[(0,o.fork)(S),(0,o.fork)(_)]}).call(this,n(71))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sessionSagas=void 0;var a,r=n(248),o=n(124),i=n(59),s=(a=i)&&a.__esModule?a:{default:a},l=n(104),c=n(322),u=n(589);var d=regeneratorRuntime.mark(b),f=regeneratorRuntime.mark(_),p=regeneratorRuntime.mark(S),m=regeneratorRuntime.mark(E),g=regeneratorRuntime.mark(O),y=regeneratorRuntime.mark(w),h=regeneratorRuntime.mark(M),v=regeneratorRuntime.mark(P);function b(e){var t,n,a,o=e.payload;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.getContext)("organisationService");case 2:return t=e.sent,e.prev=3,n=o,e.next=7,(0,r.call)(t.getWorkspace,n);case 7:return a=e.sent,e.next=10,(0,r.put)(c.getWorkspace.success(a.data));case 10:return e.next=12,(0,r.put)(u.fetchAllLabels.request(n));case 12:e.next=19;break;case 14:return e.prev=14,e.t0=e.catch(3),s.default.error(e.t0),e.next=19,(0,r.put)(c.getWorkspace.failure(e.t0));case 19:case"end":return e.stop()}}),d,this,[[3,14]])}function _(){var e,t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,r.getContext)("organisationService");case 2:return e=n.sent,n.prev=3,n.next=6,(0,r.call)(e.getCookies);case 6:return t=n.sent,n.next=9,(0,r.put)(c.getCookies.success(t.data));case 9:n.next=16;break;case 11:return n.prev=11,n.t0=n.catch(3),s.default.error(n.t0),n.next=16,(0,r.put)(c.getCookies.failure(n.t0));case 16:case"end":return n.stop()}}),f,this,[[3,11]])}function S(e){var t,n,a,o,i,l,u=e.payload;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.getContext)("organisationService");case 2:return t=e.sent,e.prev=3,n=u.organisationId,e.next=7,(0,r.call)(t.getLogo,n);case 7:return a=e.sent,o=URL.createObjectURL(a),e.next=11,(0,r.put)(c.getLogo.success({logoUrl:o}));case 11:e.next=30;break;case 13:return e.prev=13,e.t0=e.catch(3),s.default.error("Cannot get specific logo: ",e.t0),e.prev=16,e.next=19,(0,r.call)(t.getStandardLogo);case 19:return i=e.sent,l=URL.createObjectURL(i),e.next=23,(0,r.put)(c.getLogo.success({logoUrl:l}));case 23:e.next=30;break;case 25:return e.prev=25,e.t1=e.catch(16),s.default.error("Error while getting org logo: ",e.t0),e.next=30,(0,r.put)(c.getLogo.failure(e.t1));case 30:case"end":return e.stop()}}),p,this,[[3,13],[16,25]])}function E(e){var t,n,a,i,l=e.payload;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=l.organisationId,n=l.file,e.next=4,(0,r.getContext)("organisationService");case 4:return a=e.sent,(i=new FormData).append("file",n),e.next=9,(0,r.call)(a.putLogo,t,i);case 9:return e.next=11,(0,r.put)(c.putLogo.success());case 11:return e.next=13,(0,r.put)(c.getLogo.request({organisationId:t}));case 13:e.next=22;break;case 15:return e.prev=15,e.t0=e.catch(0),s.default.error("Error while putting logo: ",e.t0),e.next=20,(0,r.put)(c.putLogo.failure(e.t0));case 20:return e.next=22,(0,r.put)((0,o.addNotification)({type:"error",messageKey:"NOTIFICATION_ERROR_TITLE",descriptionKey:"NOTIFICATION_ERROR_DESCRIPTION"}));case 22:case"end":return e.stop()}}),m,this,[[0,15]])}function O(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.takeEvery)(l.WORKSPACE.REQUEST,b);case 2:case"end":return e.stop()}}),g,this)}function w(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.takeEvery)(l.CONNECTED_USER.SUCCESS,_);case 2:case"end":return e.stop()}}),y,this)}function M(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.takeEvery)(l.GET_LOGO.REQUEST,S);case 2:case"end":return e.stop()}}),h,this)}function P(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.takeEvery)(l.PUT_LOGO.REQUEST,E);case 2:case"end":return e.stop()}}),v,this)}t.sessionSagas=[(0,r.fork)(O),(0,r.fork)(M),(0,r.fork)(P),(0,r.fork)(w)]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.labelsSagas=void 0;var a,r=n(248),o=n(59),i=(a=o)&&a.__esModule?a:{default:a},s=n(589),l=n(104);var c=regeneratorRuntime.mark(d),u=regeneratorRuntime.mark(f);function d(e){var t,n,a,o=e.payload;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.getContext)("labelService");case 2:if(t=e.sent,e.prev=3,n=o.organisationId){e.next=7;break}throw new Error("Payload is invalid");case 7:return e.next=9,(0,r.call)(t.getLabels,n,{limit:1e3});case 9:return a=e.sent,e.next=12,(0,r.put)(s.fetchAllLabels.success(a));case 12:e.next=19;break;case 14:return e.prev=14,e.t0=e.catch(3),i.default.error(e.t0),e.next=19,(0,r.put)(s.fetchAllLabels.failure(e.t0));case 19:case"end":return e.stop()}}),c,this,[[3,14]])}function f(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.takeLatest)(l.LABELS_FETCH.REQUEST,d);case 2:case"end":return e.stop()}}),u,this)}t.labelsSagas=[(0,r.fork)(f)]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.versionSagas=void 0;var a,r=n(645),o=n(248),i=n(124),s=n(59),l=(a=s)&&a.__esModule?a:{default:a};var c=regeneratorRuntime.mark(u);function u(){var e,t,n,a;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,(0,o.getContext)("navigatorService");case 3:return e=s.sent,s.next=6,(0,o.call)(e.getVersion);case 6:t=s.sent,n=t.version;case 8:return s.next=11,(0,o.call)(e.getVersion);case 11:if(a=s.sent,n===a.version){s.next=16;break}return n=a.version,s.next=16,(0,o.put)((0,i.notifyInfo)({newVersion:!0}));case 16:return s.next=18,(0,o.call)(r.delay,1e4);case 18:s.next=8;break;case 20:s.next=25;break;case 22:s.prev=22,s.t0=s.catch(0),l.default.error("Cannot get version: ",s.t0);case 25:case"end":return s.stop()}}),c,this,[[0,22]])}t.versionSagas=[(0,o.fork)(u)]},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.featuresSagas=void 0;var a,r=n(248),o=n(898),i=n(104),s=n(59),l=(a=s)&&a.__esModule?a:{default:a};var c=regeneratorRuntime.mark(f),u=regeneratorRuntime.mark(p),d=regeneratorRuntime.mark(m);function f(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.take)(i.APP_STARTUP.SUCCESS);case 2:case"end":return e.stop()}}),c,this)}function p(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,r.take)([i.APP_STARTUP.FAILURE]);case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),u,this)}function m(){var t,n,a;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,r.race)({success:(0,r.call)(f),failure:(0,r.call)(p)});case 2:if(t=i.sent,t.failure){i.next=10;break}n=e.window.localStorage.getItem("features"),a=e.window.MCS_CONSTANTS.FEATURES;try{a=a.concat(JSON.parse(n))}catch(e){l.default.error(e)}return i.next=10,(0,r.put)((0,o.setOrgFeature)(a));case 10:case"end":return i.stop()}}),d,this)}t.featuresSagas=[(0,r.fork)(m)]}).call(this,n(71))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomActionService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(38),s=n(299);var l=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"scenario_custom_actions"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"getLocalizedPluginLayout",value:function(e){var t=this;return this.getInstanceById(e).then((function(e){var n=e.data;return t._pluginService.findPluginFromVersionId(n.version_id).then((function(e){var a=e.data;return t._pluginService.getLocalizedPluginLayout(a.id,n.version_id)}))}))}}]),t}(((a=s)&&a.__esModule?a:{default:a}).default);t.CustomActionService=c=l([(0,i.injectable)()],c),t.CustomActionService=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudienceFeatureService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(38),s=n(46),l=(a=s)&&a.__esModule?a:{default:a};var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getAudienceFeatures",value:function(e,t){var n="datamarts/"+e+"/audience_features";return(null==t?void 0:t.fake_dataset)?Promise.resolve({status:"ok",data:[{id:"11",name:"Audience Feature 11",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"12",name:"Audience Feature 12",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"21",name:"Audience Feature 21",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"22",name:"Audience Feature 22",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[{field_name:"creation_ts",parameter_name:"creation_ts",path:[""],type:"String"},{field_name:"marital_situation",parameter_name:"marital_situation",path:[""],type:"String"}],audienceFeatureFolderId:"string"},{id:"23",name:"Audience Feature 23",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"31",name:"Audience Feature 31",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"41",name:"Audience Feature 41",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"42",name:"Audience Feature 42",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"43",name:"Audience Feature 43",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"51",name:"Audience Feature 51",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"52",name:"Audience Feature 52",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"61",name:"Audience Feature 61",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"62",name:"Audience Feature 62",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"63",name:"Audience Feature 63",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"71",name:"Audience Feature 71",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"72",name:"Audience Feature 72",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"81",name:"Audience Feature 81",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"91",name:"Audience Feature 91",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"101",name:"Audience Feature 101",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"102",name:"Audience Feature 102",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"111",name:"Audience Feature 111",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"112",name:"Audience Feature 112",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"},{id:"113",name:"Audience Feature 113",datamart_id:"1",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus",token:"string",addressable_object:"string",object_tree_expression:"string",variables:[],audienceFeatureFolderId:"string"}],count:2}):l.default.getRequest(n,t)}},{key:"getAudienceFeature",value:function(e,t){var n="datamarts/"+e+"/audience_features/"+t;return l.default.getRequest(n)}},{key:"createAudienceFeature",value:function(e,t){var n="datamarts/"+e+"/audience_features";return l.default.postRequest(n,t)}},{key:"updateAudienceFeature",value:function(e,t,n){var a="datamarts/"+e+"/audience_features/"+t;return l.default.putRequest(a,n)}},{key:"deleteAudienceFeature",value:function(e,t){var n="datamarts/"+e+"/audience_features/"+t;return l.default.deleteRequest(n)}},{key:"getAudienceFeatureFolders",value:function(e){return Promise.resolve({status:"ok",data:[{id:"1",name:"Demographics",datamart_id:"1",audience_feature_ids:["11","12"],parent_id:null,children_ids:["4","5"]},{id:"2",name:"Intents",datamart_id:"1",audience_feature_ids:["21","22"],parent_id:null,children_ids:["6","7","8"]},{id:"3",name:"Interests",datamart_id:"1",audience_feature_ids:["31","32"],parent_id:null,children_ids:["9","10","11"]},{id:"4",name:"Sub Folder Demographics 1",datamart_id:"1",audience_feature_ids:["41","42","43"],parent_id:"1",children_ids:[]},{id:"5",name:"Sub Folder Demographics 2",datamart_id:"1",audience_feature_ids:["51","52"],parent_id:"1",children_ids:[]},{id:"6",name:"Sub Folder Intents 1",datamart_id:"1",audience_feature_ids:["61","62","63"],parent_id:"2",children_ids:[]},{id:"7",name:"Sub Folder Intents 2",datamart_id:"1",audience_feature_ids:["71","72"],parent_id:"2",children_ids:[]},{id:"8",name:"Sub Folder Intents 3",datamart_id:"1",audience_feature_ids:["81"],parent_id:"2",children_ids:[]},{id:"9",name:"Sub Folder Interests 1",datamart_id:"1",audience_feature_ids:["91"],parent_id:"3",children_ids:[]},{id:"10",name:"Sub Folder Interests 2",datamart_id:"1",audience_feature_ids:["101","102"],parent_id:"3",children_ids:[]},{id:"11",name:"Sub Folder Interests 3",datamart_id:"1",audience_feature_ids:["111","112","113"],parent_id:"3",children_ids:[]}],count:3})}},{key:"createAudienceFeatureFolder",value:function(e,t){var n="datamarts/"+e+"/audience_feature_folders";return l.default.postRequest(n,t)}},{key:"getAudienceFeatureFolder",value:function(e,t){var n="datamarts/"+e+"/audience_feature_folders/"+t;return l.default.getRequest(n)}},{key:"updateAudienceFeatureFolder",value:function(e,t,n){var a="datamarts/"+e+"/audience_feature_folders/"+t;return l.default.putRequest(a,n)}},{key:"deleteAudienceFeatureFolder",value:function(e,t){var n="datamarts/"+e+"/audience_feature_folders/"+t;return l.default.deleteRequest(n)}},{key:"getAudienceFeatureChildFolders",value:function(e,t){var n="datamarts/"+e+"/audience_feature_folders";return l.default.getRequest(n,{parent:t})}}]),e}();t.AudienceFeatureService=u=c([(0,i.injectable)()],u),t.AudienceFeatureService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38),c=n(12),u=n(159);var d=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"createAudienceBuilder",value:function(e,t){var n="datamarts/"+e+"/audience_builders";return s.default.postRequest(n,t)}},{key:"getAudienceBuilders",value:function(e,t){var n="datamarts/"+e+"/audience_builders";return s.default.getRequest(n,t)}},{key:"getAudienceBuilder",value:function(e,t){var n="datamarts/"+e+"/audience_builders/"+t;return s.default.getRequest(n)}},{key:"loadAudienceBuilder",value:function(e,t){var n=this;return this.getAudienceBuilder(e,t).then((function(t){return Promise.all(t.data.demographics_features_ids.map((function(t){return n._audienceFeatureService.getAudienceFeature(e,t).then((function(e){return e.data}))}))).then((function(e){return{audienceBuilder:t.data,audienceFeatureDemographics:e.map((function(e){return(0,u.createFieldArrayModelWithMeta)(e,{name:e.name})}))}}))}))}},{key:"updateAudienceBuilder",value:function(e,t,n){var a="datamarts/"+e+"/audience_builders/"+t;return s.default.putRequest(a,n)}},{key:"deleteAudienceBuilder",value:function(e,t){var n="datamarts/"+e+"/audience_builders/"+t;return s.default.deleteRequest(n)}}]),e}();d([(0,l.inject)(c.TYPES.IAudienceFeatureService)],f.prototype,"_audienceFeatureService",void 0),f=d([(0,l.injectable)()],f),t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommenderService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=l(n(46)),i=l(n(299)),s=n(38);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"recommenders"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"getRecommenders",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="recommenders",a=Object.assign({organisation_id:e},t);return o.default.getRequest(n,a)}},{key:"getRecommenderProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="recommenders/"+e+"/properties";return o.default.getRequest(n,t)}},{key:"deleteRecommender",value:function(e){var t="recommenders/"+e;return o.default.deleteRequest(t)}},{key:"getRecommender",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="recommenders/"+e,a=Object.assign({},t);return o.default.getRequest(n,a)}},{key:"createRecommender",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="recommenders?organisation_id="+e,a=Object.assign({},t);return o.default.postRequest(n,a)}},{key:"updateRecommender",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="recommenders/"+e,a=Object.assign({},t);return o.default.putRequest(n,a)}},{key:"updateRecommenderProperty",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r="recommenders/"+t+"/properties/technical_name="+n;return this._pluginService.handleSaveOfProperties(a,e,"recommenders",t,r)}},{key:"getLocalizedPluginLayout",value:function(e){var t=this;return this.getInstanceById(e).then((function(e){var n=e.data;return t._pluginService.findPluginFromVersionId(n.version_id).then((function(e){var a=e.data;return t._pluginService.getLocalizedPluginLayout(a.id,n.version_id)}))}))}}]),t}(i.default);t.RecommenderService=u=c([(0,s.injectable)()],u),t.RecommenderService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReferenceTableService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getReferenceTable",value:function(e,t,n,a){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/field/index=USER_INDEX/object_tree_field_path="+n+"."+a+"/reference_tables/records")}}]),e}();t.ReferenceTableService=u=c([(0,l.injectable)()],u),t.ReferenceTableService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getDatafileData",value:function(e){var t={uri:e,"cache-bust":Date.now()};return s.default.getRequest("data_file/data",t)}},{key:"createDatafile",value:function(e,t,n,a,r){var o="mics://data_file/tenants/"+e+"/"+t+"/"+n+"/"+a,i="data_file/data?uri="+o+"&name="+a;return s.default.putRequest(i,r).then((function(){return o}))}},{key:"editDataFile",value:function(e,t,n){var a="data_file/data?uri="+t+"&name="+e;return s.default.putRequest(a,n)}}]),e}();u=c([(0,l.injectable)()],u),t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DatamartReplicationService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getDatamartReplications",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="datamarts/"+e+"/replications";return s.default.getRequest(n,t)}},{key:"getDatamartReplication",value:function(e,t){var n="datamarts/"+e+"/replications/"+t;return s.default.getRequest(n)}},{key:"createDatamartReplication",value:function(e,t){var n="datamarts/"+e+"/replications";return s.default.postRequest(n,t)}},{key:"updateDatamartReplication",value:function(e,t,n){var a="datamarts/"+e+"/replications/"+t;return s.default.putRequest(a,n)}},{key:"deleteDatamartReplication",value:function(e,t){var n="datamarts/"+e+"/replications/"+t;return s.default.deleteRequest(n)}},{key:"uploadDatamartReplicationCredentials",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="datamarts/"+e+"/replications/"+t+"/credentials";if(n.fileName&&n.fileContent){var r=new FormData,o=new Blob([n.fileContent],{type:"application/octet-stream"});return r.append("file",o,n.name),s.default.postRequest(a,r)}return Promise.reject()}},{key:"createJobExecution",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="datamarts/"+e+"/replication_job_executions",a=Object.assign({},t);return s.default.postRequest(n,a)}},{key:"getJobExecutions",value:function(e){var t="datamarts/"+e+"/replication_job_executions";return s.default.getRequest(t)}}]),e}();t.DatamartReplicationService=u=c([(0,l.injectable)()],u),t.DatamartReplicationService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TagService=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n(38);var o=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},i=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pushPageView=function(e){window.mics&&window.mics.push&&window.mics.push("PageView",e||{})},this.addUserAccountProperty=function(e){window.mics&&window.mics.addProperty&&window.mics.addProperty("$user_account_id",e)},this.setUserProperties=function(e){window.mics&&window.mics.addProperty&&window.mics.addProperty("$set_user_profile_properties",{$user_account_id:e.id})},this.googleAnalyticsTrack=function(e){if(window){var t=window.dataLayer||[];t.push("set","page",e),t.push("send","pageview")}}};t.TagService=i=o([(0,r.injectable)()],i),t.TagService=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceOfferPageService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(900),s=n(159),l=n(112),c=n(220),u=(a=c)&&a.__esModule?a:{default:a},d=n(12),f=n(38);var p=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"createOrUpdateServiceOffer",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.INITIAL_SERVICE_OFFER_FORM_DATA,r={type:"provided_service_item_conditions"},o=Object.assign({credited_account_id:e},t.offer),s=void 0===t.offer.id?this._catalogService.createServiceOffer(e,o):this._catalogService.getMyOffer(e,t.offer.id);return s.then((function(e){var o=e.data.id;return n._catalogService.getOfferConditions(o).then((function(e){var i=e.data.map((function(e){return e.service_item_id})),s=t.serviceConditionFields.map((function(e){return e.model.service_item_id})),c=s.filter((function(e){return!i.includes(e)})),u=i.filter((function(e){return!s.includes(e)})),d=[];return c.forEach((function(e){d.push((function(){return n._catalogService.createServiceItemCondition(e,r).then((function(e){return n._catalogService.addConditionToOffer(o,e.data.id)}))}))})),u.forEach((function(e){d.push((function(){var t=a.serviceConditionFields.find((function(t){return t.model.service_item_id===e}));if(void 0!==t){var r=t.model.id;return n._catalogService.removeConditionFromOffer(o,r).then((function(t){return n._catalogService.deleteServiceItemCondition(e,r)}))}return Promise.resolve()}))})),(0,l.executeTasksInSequence)(d).then((function(){return o}))}))}))}},{key:"loadOffer",value:function(e,t){var n=this;return this._catalogService.getMyOffer(e,t).then((function(e){return(e.data.automatic_on?Promise.resolve([]):n.fetchServiceConditionFields(t)).then((function(t){return{offer:e.data,serviceConditionFields:t}}))}))}},{key:"fetchServiceConditionFields",value:function(e){var t=this;return this._catalogService.getOfferConditions(e).then((function(e){return Promise.all(e.data.map((function(e){return t._catalogService.findServiceItem(e.service_item_id).then((function(t){return{serviceItem:t.data,serviceItemCondition:e}}))}))).then((function(e){return e.map((function(e){return(0,s.createFieldArrayModelWithMeta)(e.serviceItemCondition,{name:e.serviceItem.name,type:e.serviceItem.type})}))}))}))}},{key:"transformServiceType",value:function(e,t){return"audience_segment"===e?t(u.default.audience_segmentType):"inventory_access_deal_list"===e?t(u.default.inventory_access_deal_listType):"user_account_compartment"===e?t(u.default.user_account_compartmentType):e}}]),e}();p([(0,f.inject)(d.TYPES.ICatalogService)],m.prototype,"_catalogService",void 0),t.ServiceOfferPageService=m=p([(0,f.injectable)()],m),t.ServiceOfferPageService=m},,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CatalogService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(38),s=n(46),l=(a=s)&&a.__esModule?a:{default:a};var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getServices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="subscribed_services/"+e+"/services",a=Object.assign(Object.assign({},t),{root:t.root,parent_category_id:t.parentCategoryId,service_family:t.serviceFamily,service_type:t.serviceType,locale:t.locale,category_type:t.categoryType,category_subtype:t.categorySubtype});return l.default.getRequest(n,a)}},{key:"getCategoryTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="subscribed_services/"+e+"/category_trees",a={service_family:t.serviceFamily,service_type:t.serviceType,locale:t.locale,category_type:t.categoryType,category_subtype:t.categorySubtype};return l.default.getRequest(n,a).then((function(e){return e.data}))}},{key:"getCategory",value:function(e,t){var n="subscribed_services/"+e+"/categories/"+t;return l.default.getRequest(n).then((function(e){return e.data}))}},{key:"getCategories",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="subscribed_services/"+e+"/categories",a={root:t.root,parent_category_id:t.parentCategoryId,service_family:t.serviceFamily,service_type:t.serviceType,locale:t.locale,category_type:t.categoryType,category_subtype:t.categorySubtype};return l.default.getRequest(n,a).then((function(e){return e.data}))}},{key:"getSubscribedServiceItems",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="subscribed_services/"+e+"/offers/"+t+"/service_items";return l.default.getRequest(a,n)}},{key:"getSubscribedServiceItemConditions",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r="subscribed_services/"+e+"/offers/"+t+"/service_items/"+n+"/service_item_conditions";return l.default.getRequest(r,a)}},{key:"getService",value:function(e){return l.default.getRequest("service_items/"+e)}},{key:"getServiceItems",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=void 0===t.type||0===t.type.length?{type:["AUDIENCE_SEGMENT","INVENTORY_ACCESS_DEAL_LIST","USER_ACCOUNT_COMPARTMENT"]}:void 0;return l.default.getRequest("service_items",Object.assign(Object.assign({organisation_id:e},t),n))}},{key:"getSubscribedOffers",value:function(e,t){var n="subscribed_services/"+e+"/offers",a=Object.assign(Object.assign({},t),{service_agreement_id:t.serviceAgreementId});return l.default.getRequest(n,a)}},{key:"getSubscribedOffer",value:function(e,t){var n="subscribed_services/"+e+"/offers/"+t;return l.default.getRequest(n)}},{key:"getAudienceSegmentServices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.getServices(e,Object.assign(Object.assign({},t),{serviceType:["AUDIENCE_DATA.AUDIENCE_SEGMENT"]}))}},{key:"getMyOffers",value:function(e){return l.default.getRequest("service_offers",e)}},{key:"getMyOffer",value:function(e,t){var n="service_offers/"+t+"?organisation_id="+e;return l.default.getRequest(n)}},{key:"getOfferConditions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="service_offers/"+e+"/service_item_conditions";return l.default.getRequest(n,t)}},{key:"createServiceOffer",value:function(e,t){var n="service_offers?organisation_id="+e;return l.default.postRequest(n,Object.assign({},t))}},{key:"findServiceItem",value:function(e){var t="service_items/"+e;return l.default.getRequest(t)}},{key:"createServiceItemCondition",value:function(e,t){var n="service_items/"+e+"/service_item_conditions";return l.default.postRequest(n,t)}},{key:"addConditionToOffer",value:function(e,t){var n="service_offers/"+e+"/service_item_conditions/"+t;return l.default.putRequest(n,{})}},{key:"removeConditionFromOffer",value:function(e,t){var n="service_offers/"+e+"/service_item_conditions/"+t;return l.default.deleteRequest(n)}},{key:"deleteServiceItemCondition",value:function(e,t){var n="service_items/"+e+"/service_item_conditions/"+t;return l.default.deleteRequest(n)}},{key:"findAvailableServiceItems",value:function(){return l.default.getRequest("available_service_items")}},{key:"findAvailableCombinedServiceItemsIds",value:function(e,t){var n="organisations/"+e+"/available_combined_service_items_and_conditions";return l.default.getRequest(n,t)}},{key:"findAvailableServiceProvidersMultiId",value:function(e,t){var n="organisations/"+e+"/available_service_providers?id="+t.join(",");return l.default.getRequest(n)}},{key:"findAvailableServiceOffersMultiId",value:function(e,t){var n="organisations/"+e+"/available_service_offers?service_item_offer_id="+t.join(",");return l.default.getRequest(n)}},{key:"findAvailableServiceConditionsMultiId",value:function(e,t){var n="organisations/"+e+"/available_service_items_conditions?service_item_offer_id="+t.join(",");return l.default.getRequest(n)}},{key:"findAvailableServiceItemsMultiId",value:function(e,t){var n="organisations/"+e+"/available_service_items?offer_id="+t.join(",");return l.default.getRequest(n)}}]),e}();t.CatalogService=u=c([(0,i.injectable)()],u),t.CatalogService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmailRouterService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=l(n(46)),i=l(n(299)),s=n(38);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"email_routers"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"getEmailRouters",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="email_routers",a=Object.assign({organisation_id:e},t);return o.default.getRequest(n,a)}},{key:"getEmailRouter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="email_routers/"+e,a=Object.assign({},t);return o.default.getRequest(n,a)}},{key:"deleteEmailRouter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="email_routers/"+e,a=Object.assign({},t);return o.default.deleteRequest(n,a)}},{key:"getLocalizedPluginLayout",value:function(e){var t=this;return this.getInstanceById(e).then((function(e){var n=e.data;return t._pluginService.findPluginFromVersionId(n.version_id).then((function(e){var a=e.data;return t._pluginService.getLocalizedPluginLayout(a.id,n.version_id)}))}))}}]),t}(i.default);t.EmailRouterService=u=c([(0,s.injectable)()],u),t.EmailRouterService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VisitAnalyzerService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(38),i=s(n(46));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"visit_analyzer_models"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"getVisitAnalyzers",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="visit_analyzer_models",a=Object.assign({organisation_id:e},t);return i.default.getRequest(n,a)}},{key:"deleteVisitAnalyzerProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="visit_analyzer_models/"+e;return i.default.deleteRequest(n,t)}},{key:"getLocalizedPluginLayout",value:function(e){var t=this;return this.getInstanceById(e).then((function(e){var n=e.data;return t._pluginService.findPluginFromVersionId(n.version_id).then((function(e){var a=e.data;return t._pluginService.getLocalizedPluginLayout(a.id,n.version_id)}))}))}}]),t}(s(n(299)).default);t.VisitAnalyzerService=c=l([(0,o.injectable)()],c),t.VisitAnalyzerService=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DisplayCampaignService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getCampaignDisplay",value:function(e){var t="display_campaigns/"+e;return s.default.getRequest(t)}},{key:"getDisplayCampaigns",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="campaigns",r=Object.assign({organisation_id:e,campaign_type:t},n);return s.default.getRequest(a,r)}},{key:"getCampaignDisplayViewDeep",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="display_campaigns/"+e;return s.default.getRequest(n,t)}},{key:"getCampaignName",value:function(e){return this.getCampaignDisplay(e).then((function(e){return e.data.name}))}},{key:"createCampaign",value:function(e){return s.default.postRequest("display_campaigns",Object.assign(Object.assign({},e),{type:"DISPLAY"}))}},{key:"updateCampaign",value:function(e,t){var n="display_campaigns/"+e;return s.default.putRequest(n,Object.assign(Object.assign({},t),{type:"DISPLAY"}))}},{key:"deleteCampaign",value:function(e){var t="display_campaigns/"+e;return s.default.deleteRequest(t)}},{key:"getAdGroup",value:function(e,t){var n="display_campaigns/"+e+"/ad_groups/"+t;return s.default.getRequest(n)}},{key:"getAdGroups",value:function(e){var t="display_campaigns/"+e+"/ad_groups";return s.default.getRequest(t)}},{key:"findAdGroups",value:function(e,t){var n=Object.assign({organisation_id:e},t);return s.default.getRequest("display_campaigns.ad_groups",n)}},{key:"createAdGroup",value:function(e,t){var n="display_campaigns/"+e+"/ad_groups";return s.default.postRequest(n,t)}},{key:"updateAdGroup",value:function(e,t,n){var a="display_campaigns/"+e+"/ad_groups/"+t;return s.default.putRequest(a,n)}},{key:"deleteAdGroup",value:function(e,t){var n="display_campaigns/"+e+"/ad_groups/"+t;return s.default.deleteRequest(n)}},{key:"getAudienceSegments",value:function(e,t){var n="display_campaigns/"+e+"/ad_groups/"+t+"/audience_segments";return s.default.getRequest(n)}},{key:"getAudiences",value:function(e,t){var n="display_campaigns/"+e+"/ad_groups/"+t+"/audience_segments";return s.default.getRequest(n).then((function(e){return e.data.map((function(e){var t=e.audience_segment_id,n=e.exclude,a=e.id,r=(e.technical_name,u(e,["audience_segment_id","exclude","id","technical_name"]));return Object.assign(Object.assign({},r),{id:t,include:!n,modelId:a,toBeRemoved:!1})}))}))}},{key:"createAudienceSegment",value:function(e,t,n){var a="display_campaigns/"+e+"/ad_groups/"+t+"/audience_segments";return s.default.postRequest(a,n)}},{key:"updateAudienceSegment",value:function(e,t,n,a){var r="display_campaigns/"+e+"/ad_groups/"+t+"/audience_segments/"+n;return s.default.putRequest(r,a)}},{key:"deleteAudienceSegment",value:function(e,t,n){var a="display_campaigns/"+e+"/ad_groups/"+t+"/audience_segments/"+n;return s.default.deleteRequest(a)}},{key:"getPublishers",value:function(e){var t="display_campaigns/"+e+"/inventory_sources";return s.default.getRequest(t).then((function(e){return e.data.map((function(e){var t=e.display_network_access_id,n=e.id,a=u(e,["display_network_access_id","id"]);return Object.assign(Object.assign({},a),{display_network_access_id:t,id:t,modelId:n,toBeRemoved:!1})}))}))}},{key:"createPublisher",value:function(e,t){var n="display_campaigns/"+e+"/inventory_sources/";return s.default.postRequest(n,t)}},{key:"deletePublisher",value:function(e,t){var n="display_campaigns/"+e+"/inventory_sources/"+t;return s.default.deleteRequest(n)}},{key:"getAd",value:function(e,t,n){var a="display_campaigns/"+e+"/ad_groups/"+t+"/ads/"+n;return s.default.getRequest(a)}},{key:"getAds",value:function(e,t){var n="display_campaigns/"+e+"/ad_groups/"+t+"/ads";return s.default.getRequest(n)}},{key:"updateAd",value:function(e,t,n,a){var r="display_campaigns/"+t+"/ad_groups/"+n+"/ads/"+e;return s.default.putRequest(r,a)}},{key:"createAd",value:function(e,t,n){var a="display_campaigns/"+e+"/ad_groups/"+t+"/ads";return s.default.postRequest(a,n)}},{key:"deleteAd",value:function(e,t,n){var a="display_campaigns/"+e+"/ad_groups/"+t+"/ads/"+n;return s.default.deleteRequest(a)}},{key:"getGoals",value:function(e){var t="campaigns/"+e+"/goal_selections";return s.default.getRequest(t)}},{key:"createGoal",value:function(e,t){var n="campaigns/"+e+"/goal_selections";return s.default.postRequest(n,t)}},{key:"updateGoal",value:function(e,t,n){var a="campaigns/"+e+"/goal_selections/"+t;return s.default.putRequest(a,n)}},{key:"deleteGoal",value:function(e,t){var n="campaigns/"+e+"/goal_selections/"+t;return s.default.deleteRequest(n)}},{key:"createLocation",value:function(e,t,n){var a="display_campaigns/"+e+"/ad_groups/"+t+"/locations";return s.default.postRequest(a,n)}},{key:"deleteLocation",value:function(e,t,n){var a="display_campaigns/"+e+"/ad_groups/"+t+"/locations/"+n;return s.default.deleteRequest(a)}},{key:"getLocations",value:function(e,t){var n="display_campaigns/"+e+"/ad_groups/"+t+"/locations";return s.default.getRequest(n)}},{key:"updateLocation",value:function(e,t,n,a){var r="display_campaigns/"+e+"/ad_groups/"+t+"/locations/"+n;return s.default.putRequest(r,a)}},{key:"getDealsLists",value:function(e,t){var n="display_campaigns/"+e+"/ad_groups/"+t+"/deal_lists";return s.default.getRequest(n)}},{key:"createDealsList",value:function(e,t,n){var a="display_campaigns/"+e+"/ad_groups/"+t+"/deal_lists";return s.default.postRequest(a,n)}},{key:"updateDealsList",value:function(e,t,n,a){var r="display_campaigns/"+e+"/ad_groups/"+t+"/deal_lists/"+n;return s.default.putRequest(r,a)}},{key:"deleteDealsList",value:function(e,t,n){var a="display_campaigns/"+e+"/ad_groups/"+t+"/deal_lists/"+n;return s.default.deleteRequest(a,{})}},{key:"getAdex",value:function(e,t){var n="display_campaigns/"+e+"/ad_groups/"+t+"/ad_exchanges";return s.default.getRequest(n)}},{key:"createAdex",value:function(e,t,n){var a="display_campaigns/"+e+"/ad_groups/"+t+"/ad_exchanges";return s.default.postRequest(a,n)}},{key:"updateAdex",value:function(e,t,n,a){var r="display_campaigns/"+e+"/ad_groups/"+t+"/ad_exchanges/"+n;return s.default.putRequest(r,a)}},{key:"deleteAdex",value:function(e,t,n){var a="display_campaigns/"+e+"/ad_groups/"+t+"/ad_exchanges/"+n;return s.default.deleteRequest(a,{})}},{key:"getDisplayNetworks",value:function(e,t){var n="display_campaigns/"+e+"/ad_groups/"+t+"/display_networks";return s.default.getRequest(n)}},{key:"getDisplayNetwork",value:function(e,t,n){var a="display_campaigns/"+e+"/ad_groups/"+t+"/display_networks/"+n;return s.default.getRequest(a)}},{key:"createDisplayNetwork",value:function(e,t,n){var a="display_campaigns/"+e+"/ad_groups/"+t+"/display_networks";return s.default.postRequest(a,n)}},{key:"updateDisplayNetwork",value:function(e,t,n,a){var r="display_campaigns/"+e+"/ad_groups/"+t+"/display_networks/"+n;return s.default.putRequest(r,a)}},{key:"deleteDisplayNetwork",value:function(e,t,n){var a="display_campaigns/"+e+"/ad_groups/"+t+"/display_networks/"+n;return s.default.deleteRequest(a,{})}}]),e}();t.DisplayCampaignService=d=c([(0,l.injectable)()],d),t.DisplayCampaignService=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdGroupFormService=void 0;var a,r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(54),l=n(46),c=n(178),u=n(159),d=n(112),f=n(178),p=(a=f)&&a.__esModule?a:{default:a},m=n(38),g=n(12);function y(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var h=function(e,t,n,a){var r,o=arguments.length,s=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,[{key:"loadAdGroup",value:function(e,t,n){return Promise.all([this._displayCampaignService.getAdGroup(e,t).then(l.extractData),this.loadAdGroupDependencies(e,t,n)]).then((function(e){var t=r(e,2),a=t[0],o=t[1];return Object.assign({adGroup:Object.assign(Object.assign({},c.INITIAL_AD_GROUP_FORM_DATA.adGroup),n?(0,s.omit)(a,"id"):a)},o)}))}},{key:"loadAdGroupDependencies",value:function(e,t,n){return Promise.all([this._displayCampaignService.getAudienceSegments(e,t).then(l.extractDataList),this._displayCampaignService.getAds(e,t).then(l.extractDataList),this._displayCampaignService.getLocations(e,t).then(l.extractDataList),this._displayCampaignService.getDealsLists(e,t).then(l.extractDataList),this._displayCampaignService.getAdex(e,t).then(l.extractDataList),this._displayCampaignService.getDisplayNetworks(e,t).then(l.extractDataList)]).then((function(e){var t=r(e,6),a=t[0],o=t[1],i=t[2],l=t[3],c=t[4],d=t[5],f=a.map((function(e){return Object.assign({},(0,u.createFieldArrayModelWithMeta)(n?(0,s.omit)(e,"id"):e,{name:e.name}))})),p=o.map((function(e){return(0,u.createFieldArrayModel)(n?(0,s.omit)(e,"id"):e)})),m=i.map((function(e){return(0,u.createFieldArrayModel)(n?(0,s.omit)(e,"id"):e)})),g=l.map((function(e){var t={data:n?(0,s.omit)(e,"id"):e,type:"DEAL_LIST"};return(0,u.createFieldArrayModelWithMeta)(t,{name:e.name})})),h=c.map((function(e){var t={data:n?(0,s.omit)(e,"id"):e,type:"AD_EXCHANGE"};return(0,u.createFieldArrayModelWithMeta)(t,{name:e.name})})),v=d.map((function(e){var t={data:n?(0,s.omit)(e,"id"):e,type:"DISPLAY_NETWORK"};return(0,u.createFieldArrayModelWithMeta)(t,{name:e.name})}));return{segmentFields:f,adFields:p,locationFields:m,inventoryCatalFields:[].concat(y(v),y(h),y(g))}}))}},{key:"saveAdGroup",value:function(e,t,n){var a=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c.INITIAL_AD_GROUP_FORM_DATA;return(n.adGroup.id?this._displayCampaignService.updateAdGroup(t,n.adGroup.id,n.adGroup):this._displayCampaignService.createAdGroup(t,n.adGroup)).then((function(o){var i=o.data.id,s=[];return s.push.apply(s,y(a.getSegmentTasks(t,i,n.segmentFields,r.segmentFields)).concat(y(a.getAdTasks(e,t,i,n.adFields,r.adFields)),y(a.getLocationTasks(t,i,n.locationFields,r.locationFields)),y(a.getInventoryCatalogTask(t,i,n.inventoryCatalFields,r.inventoryCatalFields)))),(0,d.executeTasksInSequence)(s).then((function(){return i}))}))}},{key:"saveAdGroups",value:function(e,t,n){var a=this,r=[];return t.forEach((function(t){r.push((function(){return a._displayCampaignService.getAdGroup(e,t).then((function(e){return e.data})).then((function(r){var o=n.fields.reduce((function(e,t){var n=t.adGroupProperty;return Object.assign(Object.assign({},e),function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t.adGroupProperty,(0,p.default)(t.action,r[n],t.value)))}),{});return a._displayCampaignService.updateAdGroup(e,t,o)}))}))})),(0,d.executeTasksInSequence)(r)}},{key:"getAdTasks",value:function(e,t,n,a,r){var o=this,i=[];r.forEach((function(e){(0,c.isAdResource)(e.model)&&i.push(e.model.id)}));var s=[];a.forEach((function(e){(0,c.isAdResource)(e.model)&&s.push(e.model.id)}));var l=[];return a.forEach((function(a){if((0,c.isDisplayCreativeFormData)(a.model)){var r=a.model;r=Object.assign(Object.assign({},r),{creative:Object.assign(Object.assign({},r.creative),{subtype:"BANNER"})}),l.push((function(){return o._displayCreativeFormService.saveDisplayCreative(e,r).then((function(e){return o._displayCampaignService.createAd(t,n,{creative_id:e})}))}))}else if(!(0,c.isAdResource)(a.model)){var i=a.model;l.push((function(){return o._displayCampaignService.createAd(t,n,{creative_id:i.creative_id})}))}})),i.filter((function(e){return!s.includes(e)})).forEach((function(e){l.push((function(){return o._displayCampaignService.deleteAd(t,n,e)}))})),l}},{key:"getSegmentTasks",value:function(e,t,n,a){var r=this,o=[];a.forEach((function(e){(0,c.isAudienceSegmentSelectionResource)(e.model)&&o.push(e.model.id)}));var i=[];n.forEach((function(e){(0,c.isAudienceSegmentSelectionResource)(e.model)&&i.push(e.model.id)}));var s=[];return n.forEach((function(n){if((0,c.isAudienceSegmentSelectionResource)(n.model)){var a=n.model.id;s.push((function(){return r._displayCampaignService.updateAudienceSegment(e,t,a,n.model)}))}else s.push((function(){return r._displayCampaignService.createAudienceSegment(e,t,n.model)}))})),o.filter((function(e){return!i.includes(e)})).forEach((function(n){s.push((function(){return r._displayCampaignService.deleteAudienceSegment(e,t,n)}))})),s}},{key:"getLocationTasks",value:function(e,t,n,a){var r=this,o=[];a.forEach((function(e){(0,c.isLocationSelectionResource)(e.model)&&o.push(e.model.id)}));var i=[];n.forEach((function(e){(0,c.isLocationSelectionResource)(e.model)&&i.push(e.model.id)}));var s=[];return n.forEach((function(n){if((0,c.isLocationSelectionResource)(n.model)){var a=n.model.id;s.push((function(){return r._displayCampaignService.updateLocation(e,t,a,n.model)}))}else s.push((function(){return r._displayCampaignService.createLocation(e,t,n.model)}))})),o.filter((function(e){return!i.includes(e)})).forEach((function(n){s.push((function(){return r._displayCampaignService.deleteLocation(e,t,n)}))})),s}},{key:"getInventoryCatalogTask",value:function(e,t,n,a){var r=this,o=[],i=[],s=[];a.forEach((function(e){"DEAL_LIST"===e.model.type&&(0,c.isDealListSelectionResource)(e.model.data)&&o.push(e.model.data.id),"AD_EXCHANGE"===e.model.type&&(0,c.isAdExchangeSelectionResource)(e.model.data)&&i.push(e.model.data.id),"DISPLAY_NETWORK"===e.model.type&&(0,c.isDisplayNetworkSelectionResource)(e.model.data)&&s.push(e.model.data.id)}));var l=[],u=[],d=[];n.forEach((function(e){"DEAL_LIST"===e.model.type&&(0,c.isDealListSelectionResource)(e.model.data)&&l.push(e.model.data.id),"AD_EXCHANGE"===e.model.type&&(0,c.isAdExchangeSelectionResource)(e.model.data)&&u.push(e.model.data.id),"DISPLAY_NETWORK"===e.model.type&&(0,c.isDisplayNetworkSelectionResource)(e.model.data)&&d.push(e.model.data.id)}));var f=[];return n.forEach((function(n){if("DEAL_LIST"===n.model.type){var a=n.model.data;if((0,c.isDealListSelectionResource)(n.model.data)){var o=n.model.data.id;f.push((function(){return r._displayCampaignService.updateDealsList(e,t,o,a)}))}else f.push((function(){return r._displayCampaignService.createDealsList(e,t,a)}))}if("AD_EXCHANGE"===n.model.type){var i=n.model.data;if((0,c.isAdExchangeSelectionResource)(n.model.data)){var s=n.model.data.id;f.push((function(){return r._displayCampaignService.updateAdex(e,t,s,i)}))}else f.push((function(){return r._displayCampaignService.createAdex(e,t,i)}))}if("DISPLAY_NETWORK"===n.model.type){var l=n.model.data;if((0,c.isDisplayNetworkSelectionResource)(n.model.data)){var u=n.model.data.id;f.push((function(){return r._displayCampaignService.updateDisplayNetwork(e,t,u,l)}))}else f.push((function(){return r._displayCampaignService.createDisplayNetwork(e,t,l)}))}})),o.filter((function(e){return!l.includes(e)})).forEach((function(n){f.push((function(){return r._displayCampaignService.deleteDealsList(e,t,n)}))})),i.filter((function(e){return!u.includes(e)})).forEach((function(n){f.push((function(){return r._displayCampaignService.deleteAdex(e,t,n)}))})),s.filter((function(e){return!d.includes(e)})).forEach((function(n){f.push((function(){return r._displayCampaignService.deleteDisplayNetwork(e,t,n)}))})),f}}]),e}();h([(0,m.inject)(g.TYPES.IDisplayCreativeFormService)],v.prototype,"_displayCreativeFormService",void 0),h([(0,m.inject)(g.TYPES.IDisplayCampaignService)],v.prototype,"_displayCampaignService",void 0),t.AdGroupFormService=v=h([(0,m.injectable)()],v),t.AdGroupFormService=v,t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DisplayCreativeFormService=void 0;var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(137),s=n(46),l=n(83),c=n(38),u=n(12);var d=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};function f(e){return(0,l.normalizeArrayOfObject)(e.sort((function(e){return!1===e.writable?-1:1})),"technical_name")}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"initializeFormData",value:function(e,t,n){var a=this;return this._pluginService.getPlugin(e).then((function(r){return a._pluginService.getPluginVersion(e,r.data.current_version_id).then((function(r){var o=r.data;return Promise.all([a._pluginService.getPluginVersionProperties(e,o.id),a._pluginService.getLocalizedPluginLayout(e,o.id)]).then((function(e){var a=e[0].data,r=e[1],i=null!==r?r:void 0,s={subtype:t};return n&&(s.format=n),{creative:s,rendererPlugin:o,properties:f(a),pluginLayout:i,repeatFields:[]}}))}))}))}},{key:"loadFormData",value:function(e){var t=this;return Promise.all([this._creativeService.getDisplayAd(e).then(s.extractData),this._creativeService.getCreativeRendererProperties(e).then(s.extractDataList)]).then((function(e){var n=a(e,2),r=n[0],o=n[1];return Promise.all([t._pluginService.getPluginVersion(r.renderer_plugin_id,r.renderer_version_id).then(s.extractData),t._pluginService.getLocalizedPluginLayout(r.renderer_plugin_id,r.renderer_version_id)]).then((function(e){var t=e[0],n=e[1],a=null!==n?n:void 0;return{creative:r,rendererPlugin:t,properties:f(o),pluginLayout:a,repeatFields:[]}}))}))}},{key:"saveDisplayCreative",value:function(e,t){var n=this,a=t.creative,r=t.rendererPlugin,o=t.properties,s=void 0;if((0,i.isDisplayAdResource)(a))s=this._creativeService.updateDisplayCreative(a.id,a);else{var l=Object.assign({renderer_artifact_id:r.artifact_id,renderer_group_id:r.group_id,editor_artifact_id:"default-editor",editor_group_id:"com.mediarithmics.creative.display",subtype:t.creative.subtype},a);s=this._creativeService.createDisplayCreative(e,l)}return s.then((function(t){var a=t.data.id;return Promise.all(Object.keys(o).filter((function(e){return o[e].writable})).map((function(t){var r=o[t];return n._creativeService.updateDisplayCreativeRendererProperty(e,a,r.technical_name,r)}))).then((function(){return n._creativeService.takeScreenshot(a).then((function(){return a}))}))}))}},{key:"handleSaveMutipleCreatives",value:function(e,t){var n=this,a=t.rendererPlugin,r=t.repeatFields;return Promise.all((r||[]).map((function(o){var i,s={technical_name:"image",value:{file:o.file},property_type:"ASSET",origin:"PLUGIN",writable:!0,deletable:!1},l=Object.assign(Object.assign({},t.properties),{image:s});return(i=o.file,new Promise((function(e,t){var n=URL.createObjectURL(i),a=new Image;a.addEventListener("load",(function(t){e(a.width+"x"+a.height)})),a.src=n}))).then((function(i){var s={creative:Object.assign(Object.assign({},t.creative),{destination_domain:t.creative.destination_domain,name:o.name,format:i}),rendererPlugin:a,properties:l,repeatFields:r};return n.saveDisplayCreative(e,s)}))})))}}]),e}();d([(0,c.inject)(u.TYPES.IPluginService)],p.prototype,"_pluginService",void 0),d([(0,c.inject)(u.TYPES.ICreativeService)],p.prototype,"_creativeService",void 0),t.DisplayCreativeFormService=p=d([(0,c.injectable)()],p),t.DisplayCreativeFormService=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavigatorService=void 0;var a,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(46),i=(a=o)&&a.__esModule?a:{default:a},s=n(38);var l=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},c=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getVersion=function(){return i.default.getRequest("version.json",{},{},{localUrl:!0})},this.isAdBlockOn=function(){return i.default.getRequest("ads.html",{},{},{localUrl:!0})}};t.NavigatorService=c=l([(0,s.injectable)()],c),t.NavigatorService=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeonameService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getGeonames",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fr",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"FR",a="geonames",r={keywords:e,lang:t,country:n};return s.default.getRequest(a,r)}},{key:"getGeoname",value:function(e){var t="geonames/"+e;return s.default.getRequest(t)}}]),e}();t.GeonameService=u=c([(0,l.injectable)()],u),t.GeonameService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsentService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getConsents",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="consents",a=Object.assign({organisation_id:e},t);return s.default.getRequest(n,a)}}]),e}();t.ConsentService=u=c([(0,l.injectable)()],u),t.ConsentService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommunityService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getCommunityPasswordRequirements",value:function(e){var t="communities/technical_name="+e+"/password_requirements";return s.default.getRequest(t,{},{},{authenticated:!1})}},{key:"getCommunityPasswordValidity",value:function(e,t){var n={password:t},a="communities/technical_name="+e+"/password_validity";return s.default.postRequest(a,n,{},{},{authenticated:!1})}},{key:"getCommunityUsers",value:function(e,t){var n="communities/"+e+"/users";return s.default.getRequest(n,t)}}]),e}();t.CommunityService=u=c([(0,l.injectable)()],u),t.CommunityService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserDataService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getProfile",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="user_point_id"!==t.type?"datamarts/"+e+"/user_profiles/"+t.type+"="+t.id:"datamarts/"+e+"/user_profiles/"+t.id,r=Object.assign(Object.assign({},n),{compartment_id:t.compartmentId});return s.default.getRequest(a,r).catch((function(e){if(e&&"Resource Not Found"===e.error)return Promise.resolve(void 0);throw e}))}},{key:"getProfiles",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("user_point_id"!==t.type)return Promise.reject(new Error("Only the 'user_point_id' identifier is currently supported by the backend."));var a="user_point_id"!==t.type?"datamarts/"+e+"/user_points/"+t.type+"="+t.id+"/user_profiles":"datamarts/"+e+"/user_points/"+t.id+"/user_profiles";return s.default.getRequest(a,n).catch((function(e){if(e&&"Resource Not Found"===e.error)return Promise.resolve(void 0);throw e}))}},{key:"getSegments",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=t.compartmentId?"compartment_id="+t.compartmentId+"/":"",r="user_point_id"!==t.type?"user_account_id"===t.type?"datamarts/"+e+"/user_segments/"+a+t.type+"="+t.id:"datamarts/"+e+"/user_segments/"+t.type+"="+t.id:"datamarts/"+e+"/user_segments/"+t.id,o=Object.assign({},n);return s.default.getRequest(r,o).catch((function(e){if(e&&"Resource Not Found"===e.error){return Promise.resolve({data:[],status:"ok",count:0})}throw e}))}},{key:"getIdentifiersEndpoint",value:function(e,t,n,a){switch(e){case"user_point_id":return"datamarts/"+t+"/user_identifiers/"+n;case"user_account_id":return a?"datamarts/"+t+"/user_identifiers/compartment_id="+a+"/"+e+"="+n:"datamarts/"+t+"/user_identifiers/"+e+"="+n;default:return"datamarts/"+t+"/user_identifiers/"+e+"="+n}}},{key:"getIdentifiers",value:function(e,t,n,a,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},i=this.getIdentifiersEndpoint(n,t,a,r),l=Object.assign({},o);return s.default.getRequest(i,l).catch((function(e){if(e&&"Resource Not Found"===e.error){return Promise.resolve({data:[],status:"ok",count:0})}throw e}))}},{key:"getActivities",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=t.compartmentId?"compartment_id="+t.compartmentId+"/":"",r="user_point_id"!==t.type?"user_account_id"===t.type?"datamarts/"+e+"/user_timelines/"+a+t.type+"="+t.id+"/user_activities":"datamarts/"+e+"/user_timelines/"+t.type+"="+t.id+"/user_activities":"datamarts/"+e+"/user_timelines/"+t.id+"/user_activities",o=Object.assign({},n);return s.default.getRequest(r,o).catch((function(e){if(e&&"Resource Not Found"===e.error){return Promise.resolve({data:[],status:"ok",count:0})}throw e}))}},{key:"getChannel",value:function(e,t){var n="channels/"+e;return s.default.getRequest(n,t).catch((function(e){if(e&&"Resource Not Found"===e.error)return Promise.resolve(void 0);throw e}))}},{key:"getUserChoices",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=t.compartmentId?"compartment_id="+t.compartmentId+"/":"",r="user_point_id"!==t.type?"user_account_id"===t.type?"datamarts/"+e+"/user_points/"+a+t.type+"="+t.id+"/user_choices":"datamarts/"+e+"/user_points/"+t.type+"="+t.id+"/user_choices":"datamarts/"+e+"/user_points/"+t.id+"/user_choices",o=Object.assign({},n);return s.default.getRequest(r,o).catch((function(e){if(e&&"Resource Not Found"===e.error){return Promise.resolve({data:[],status:"ok",count:0})}throw e}))}}]),e}();t.UserDataService=u=c([(0,l.injectable)()],u),t.UserDataService=u,t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=l(n(46)),i=l(n(59)),s=n(38);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"getQuery",value:function(e,t){var n="datamarts/"+e+"/queries/"+t;return o.default.getRequest(n)}},{key:"createQuery",value:function(e,t){var n="datamarts/"+e+"/queries";return o.default.postRequest(n,t)}},{key:"updateQuery",value:function(e,t,n){var a="datamarts/"+e+"/queries/"+t;return o.default.putRequest(a,n)}},{key:"runOTQLQuery",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="datamarts/"+e+"/query_executions/otql",r={"Content-Type":""+(n.content_type?n.content_type:"text/plain; charset=utf-8")};return o.default.postRequest(a,t,n,r)}},{key:"runGraphQLQuery",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="datamarts/"+e+"/query_executions/graphql",r={"Content-Type":"text/plain; charset=utf-8"};return o.default.postRequest(a,t,n,r)}},{key:"runJSONOTQLQuery",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="datamarts/"+e+"/query_executions/jsonotql";return o.default.postRequest(a,t,n)}},{key:"runSelectorQLQuery",value:function(e){var t="datamarts/"+e+"/query_executions";return o.default.postRequest(t,{})}},{key:"autocompleteOtqlQuery",value:function(e,t,n,a){var r="datamarts/"+e+"/query_autocomplete/otql";return o.default.postRequest(r,{query:t,position:{row:n,col:a}}).then((function(e){return e.data})).catch((function(){i.default.warn("cannot resolve autocompleters")}))}},{key:"checkOtqlQuery",value:function(e,t){var n={query:t};return o.default.postRequest("datamarts/"+e+"/query_check/otql",n)}},{key:"convertJsonOtql2Otql",value:function(e,t){return o.default.postRequest("datamarts/"+e+"/query_translations/to/otql",t)}},{key:"getWhereClause",value:function(e,t){return o.default.getRequest("datamarts/"+e+"/queries/"+t+"/object_tree_expression")}}]),e}();t.QueryService=u=c([(0,s.injectable)()],u),t.QueryService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutomationFormService=void 0;var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=y(n(54)),s=n(38),l=n(12),c=n(221),u=n(113),d=n(300),f=n(112),p=n(160),m=n(6),g=y(n(17));function y(e){return e&&e.__esModule?e:{default:e}}function h(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var v=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=function(e,t){return function(n,a){t(n,a,e)}},_=(0,m.defineMessages)({undefinedQuery:{id:"automation.builder.undefinedQuery",defaultMessage:"Please define a query for all query nodes."},emptyQuery:{id:"automation.builder.emptyQuery",defaultMessage:"One of the query nodes has an empty query. Please define a non-empty query."}}),S=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ids=[],this.getFeedNodePromise=function(e){if(!e.feed_id)return Promise.resolve(e);var t=function(t){return function(n){var a=n.data.find((function(t){return t.id===e.feed_id}));return a?Object.assign(Object.assign({},a),{type:t}):Promise.reject(void 0)}},a=n.externalFeedService.getFeeds({scenario_id:e.scenario_id}).then(t("EXTERNAL_FEED")).catch((function(a){return n.tagFeedService.getFeeds({scenario_id:e.scenario_id}).then(t("EXTERNAL_FEED")).catch((function(e){return Promise.resolve(void 0)}))})),r=a.then((function(e){return e?("EXTERNAL_FEED"===e.type?n._audienceSegmentService.getAudienceExternalFeedProperties:n._audienceSegmentService.getAudienceTagFeedProperties)(e.audience_segment_id,e.id).then((function(e){return e.data.reduce((function(e,t){var n,a,r,o={deletable:t.deletable,origin:t.origin,technical_name:t.technical_name,writable:t.writable,value:t.value,property_type:t.property_type};return Object.assign(Object.assign({},e),(n={},a=t.technical_name,r=o,a in n?Object.defineProperty(n,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[a]=r,n))}),{})})).catch((function(e){return{}})):{}})),o=a.then((function(e){if(e)return n._pluginService.getLocalizedPluginLayoutFromVersionId(e.version_id).then((function(t){var a=t.plugin,r=t.layout;return r?n._pluginService.getPluginVersionProperties(a.id,e.version_id).then((function(t){return Object.assign(Object.assign({},a),{plugin_layout:r,plugin_preset:void 0,plugin_version_properties:t.data,plugin_type:"EXTERNAL_FEED"===e.type?"AUDIENCE_SEGMENT_EXTERNAL_FEED":"AUDIENCE_SEGMENT_TAG_FEED",disabled:!0})})).catch((function(e){})):void 0}))}));return Promise.all([r,o]).then((function(t){var n=t[0],a=t[1];return n&&a?Object.assign(Object.assign({},e),{formData:{properties:n},strictlyLayoutablePlugin:a}):e}))},this.removeNodeId=function(e){return n.ids=n.ids.filter((function(t){return t!=="n-"+e}))},this.removeEdgeId=function(e){return n.ids=n.ids.filter((function(t){return t!=="e-"+e}))},this.addNodeId=function(e){return n.ids.push("n-"+e)},this.addEdgeId=function(e){return n.ids.push("e-"+e)},this.saveFirstNode=function(e,t,a){return"QUERY_INPUT"===a.node.type?n.saveQueryInputNode(e,t,a):n.saveOrCreateNode(t,a,void 0,void 0,void 0).then((function(e){return e.data}))},this.saveQueryInputNode=function(e,t,a){var r=a.node;return((0,p.isFakeId)(r.query_id)?n._queryService.createQuery(e,r.formData):n._queryService.updateQuery(e,r.query_id,r.formData).then((function(e){return n.removeNodeId(e.data.id),e}))).then((function(e){return n.saveOrCreateNode(t,a,void 0,e.data.id,void 0).then((function(e){return e.data}))}))},this.saveProcessingSelections=function(e,t){var a=t.map((function(t){var a=t.model,r={processing_id:a.id,processing_name:a.name};return n._audienceSegmentService.createProcessingSelectionForAudienceSegment(e,r)}));return Promise.all(a).then((function(t){return e}))},this.iterate=function(e,t,a,r,o){var i=r.map((function(r){return function(){var i=r.node;if((0,u.isScenarioNodeShape)(i)){if((0,u.isDisplayCampaignNode)(i))return n.saveSubDisplayCampaign(e,i.formData,i.initialFormData,i.campaign_id).then((function(i){return n.saveOrCreateNode(a,r,i).then((function(i){return n.saveOrCreateEdges(a,{source_id:o,target_id:i.data.id,edgeResource:r.in_edge}).then((function(){return n.iterate(e,t,a,r.out_edges,i.data.id)}))}))}));if((0,u.isEmailCampaignNode)(i))return n.saveSubEmailCampaign(e,i.formData,i.initialFormData,i.campaign_id).then((function(i){return n.saveOrCreateNode(a,r,{campaign_id:i}).then((function(i){return n.saveOrCreateEdges(a,{source_id:o,target_id:i.data.id,edgeResource:r.in_edge}).then((function(){return n.iterate(e,t,a,r.out_edges,i.data.id)}))}))}));if((0,u.isAddToSegmentNode)(i))return(i.user_list_segment_id?Promise.resolve(i.user_list_segment_id):n.saveAudienceSegment(e,t,i.formData.audienceSegmentName?i.formData.audienceSegmentName:"")).then((function(e){return n.saveProcessingSelections(e,i.formData.processingActivities)})).then((function(s){return n.saveOrCreateNode(a,r,void 0,void 0,s).then((function(s){return n.saveOrCreateEdges(a,{source_id:o,target_id:s.data.id,edgeResource:r.in_edge}).then((function(){var o=r.out_edges;return i.formData.audienceSegmentId&&(0,p.isFakeId)(i.formData.audienceSegmentId)&&(0,u.isAddToSegmentNode)(s.data)&&(o=n.iterateToUpdateDeleteFromSegmentNodes(i.formData.audienceSegmentId,s.data.user_list_segment_id,r.out_edges)),n.iterate(e,t,a,o,s.data.id)}))}))}));if((0,u.isDeleteFromSegmentNode)(i))return n.saveOrCreateNode(a,r,void 0,void 0,i.formData.segmentId).then((function(i){return n.saveOrCreateEdges(a,{source_id:o,target_id:i.data.id,edgeResource:r.in_edge}).then((function(){return n.iterate(e,t,a,r.out_edges,i.data.id)}))}));if((0,u.isQueryInputNode)(i)||(0,u.isIfNode)(i))return(i.query_id?n._queryService.updateQuery(t,i.query_id,i.formData):n._queryService.createQuery(t,i.formData)).then((function(i){return n.saveOrCreateNode(a,r,void 0,i.data.id).then((function(i){return n.saveOrCreateEdges(a,{source_id:o,target_id:i.data.id,edgeResource:r.in_edge}).then((function(){return n.iterate(e,t,a,r.out_edges,i.data.id)}))}))}));if((0,u.isCustomActionNode)(i)&&i.formData&&i.formData.pluginId)return(i.custom_action_id?Promise.resolve(i.custom_action_id):n.saveCustomActionIfNeeded(e,i.formData,i.formData.pluginId)).then((function(i){return n.saveOrCreateNode(a,r,void 0,void 0,void 0,i).then((function(i){return n.saveOrCreateEdges(a,{source_id:o,target_id:i.data.id,edgeResource:r.in_edge}).then((function(){return n.iterate(e,t,a,r.out_edges,i.data.id)}))}))}));if((0,u.isFeedNode)(i)&&i.formData&&i.strictlyLayoutablePlugin)return(!i.feed_id&&i.strictlyLayoutablePlugin.plugin_preset?n.saveFeedIfNeeded(e,t,a,i.formData,i.strictlyLayoutablePlugin,i.strictlyLayoutablePlugin.plugin_preset):Promise.resolve(i.feed_id)).then((function(i){return n.saveOrCreateNode(a,r,void 0,void 0,void 0,void 0,i).then((function(i){return n.saveOrCreateEdges(a,{source_id:o,target_id:i.data.id,edgeResource:r.in_edge}).then((function(){return n.iterate(e,t,a,r.out_edges,i.data.id)}))}))}));if((0,u.isAbnNode)(i)||(0,u.isEndNode)(i)||(0,u.isWaitNode)(i))return n.saveOrCreateNode(a,r).then((function(i){return n.saveOrCreateEdges(a,{source_id:o,target_id:i.data.id,edgeResource:r.in_edge}).then((function(){return n.iterate(e,t,a,r.out_edges,i.data.id)}))}))}return Promise.resolve()}}));return(0,f.executeTasksInSequence)(i)},this.saveOrCreateNode=function(e,t,a,r,o,i,s){var l=t.node,c={},d=void 0;return(0,u.isDisplayCampaignNode)(l)?(c={id:l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0,scenario_id:e,type:l.type,ad_group_id:a?a.ad_group_id:void 0,campaign_id:a?a.campaign_id:void 0},d=l.campaign_id&&!(0,p.isFakeId)(l.campaign_id)?l.campaign_id:void 0):(0,u.isEmailCampaignNode)(l)?(c={id:l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0,scenario_id:e,type:l.type,campaign_id:a?a.campaign_id:void 0},d=l.campaign_id&&!(0,p.isFakeId)(l.campaign_id)?l.campaign_id:void 0):(0,u.isQueryInputNode)(l)?(c={id:l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0,scenario_id:e,type:"QUERY_INPUT",query_id:r,evaluation_mode:l.evaluation_mode,evaluation_period:l.evaluation_period,evaluation_period_unit:l.evaluation_period_unit,ui_creation_mode:l.formData.uiCreationMode},d=l.query_id&&!(0,p.isFakeId)(l.query_id)?l.query_id:void 0):(0,u.isOnSegmentEntryInputNode)(l)?(c={id:l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0,scenario_id:e,type:"ON_SEGMENT_ENTRY_INPUT_NODE",audience_segment_id:l.formData.segmentId},d=l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0):(0,u.isOnSegmentExitInputNode)(l)?(c={id:l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0,scenario_id:e,type:"ON_SEGMENT_EXIT_INPUT_NODE",audience_segment_id:l.formData.segmentId},d=l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0):(0,u.isAddToSegmentNode)(l)?(c={id:l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0,scenario_id:e,type:l.type,user_list_segment_id:o,user_segment_expiration_period:l.formData.ttl.value?g.default.duration(+l.formData.ttl.value,l.formData.ttl.unit).toISOString():void 0},d=l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0):(0,u.isDeleteFromSegmentNode)(l)?(c={id:l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0,scenario_id:e,type:l.type,user_list_segment_id:o},d=l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0):(0,u.isIfNode)(l)?(c={id:l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0,scenario_id:e,query_id:r,type:"IF_NODE"},d=l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0):(0,u.isAbnNode)(l)?(c={id:l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0,scenario_id:e,type:"ABN_NODE"},d=l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0):(0,u.isEndNode)(l)?(c={id:l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0,scenario_id:e,type:"END_NODE"},d=l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0):(0,u.isWaitNode)(l)?(c={id:l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0,scenario_id:e,delay_period:g.default.duration(+l.formData.wait_duration.value,l.formData.wait_duration.unit).toISOString(),time_window_start:l.formData.time_window_start?"T"+l.formData.time_window_start.hours():null,time_window_end:l.formData.time_window_end?"T"+l.formData.time_window_end.hours():null,day_window:l.formData.day_window,type:"WAIT_NODE"},d=l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0):(0,u.isCustomActionNode)(l)?(c={id:l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0,scenarioId:e,custom_action_id:i,type:"CUSTOM_ACTION_NODE"},d=l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0):(0,u.isFeedNode)(l)&&(c={id:l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0,feed_id:s,scenario_id:e,type:"SCENARIO_AUDIENCE_SEGMENT_FEED_NODE"},d=l.id&&!(0,p.isFakeId)(l.id)?l.id:void 0),d?n._scenarioService.updateScenarioNode(e,l.id,c).then((function(e){return n.removeNodeId(e.data.id),e})):n._scenarioService.createScenarioNode(e,Object.assign(Object.assign({},c),{id:void 0}))},this.saveOrCreateEdges=function(e,t){var a=t.edgeResource;return a&&a.id&&!(0,p.isFakeId)(a.id)?n._scenarioService.deleteScenarioEdge(e,a.id).then((function(){return n._scenarioService.createScenarioEdge(e,Object.assign(Object.assign({},i.default.omit(t.edgeResource,["id"])),{source_id:t.source_id,target_id:t.target_id}))})).then((function(){return n.removeEdgeId(a.id),a})):n._scenarioService.createScenarioEdge(e,Object.assign(Object.assign({},i.default.omit(t.edgeResource,["id"])),{scenario_id:e,source_id:t.source_id,target_id:t.target_id})).then((function(e){return n.removeEdgeId(e.data.id),e}))},this.saveSubDisplayCampaign=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.INITIAL_DISPLAY_CAMPAIGN_NODE_FORM_DATA;return t.campaign.technical_name=void 0,a.campaign.technical_name=void 0,n._displayCampaignFormService.saveCampaign(e,t||a,a).then((function(e){return n._displayCampaignService.getAdGroups(e).then((function(t){return{campaign_id:e,ad_group_id:t&&t.data.length?t.data[0].id:void 0}}))}))},this.saveCustomActionIfNeeded=function(e,t,r){return n._pluginService.getPlugin(r).then((function(r){var o=r.data,i={name:t.name,organisation_id:e,group_id:o.group_id,artifact_id:o.artifact_id};return n._customActionService.createPluginInstance(e,i).then((function(r){var o=r.data.id,i=Object.entries(t.properties||{}).map((function(r){var i=a(r,2),s=i[0],l=i[1].value,c=t.pluginVersionProperties?t.pluginVersionProperties.find((function(e){return e.technical_name===s})):void 0,u=Object.assign(Object.assign({},c),{technical_name:s,value:l});return n._customActionService.updatePluginInstanceProperty(e,o,s,u)}));return Promise.all(i).then((function(e){return o}))}))}))},this.saveFeedIfNeeded=function(e,t,a,r,o,i){var s=n._audienceSegmentService.createAudienceSegment(e,{type:"USER_LIST",feed_type:"SCENARIO_FEED",datamart_id:t,name:"automation_feed_autogenerated_scenarioId_"+a}).then((function(e){return e.data.id})),l=Object.values(r.properties),c=s.then((function(e){return("AUDIENCE_SEGMENT_EXTERNAL_FEED"===o.plugin_type?n._audienceSegmentService.createAudienceExternalFeeds:n._audienceSegmentService.createAudienceTagFeeds)(e,{name:i.name,group_id:o.group_id,artifact_id:o.artifact_id,version_id:i.plugin_version_id,created_from:"AUTOMATION",scenario_id:a}).then((function(e){return e.data}))}));return Promise.all([s,c]).then((function(t){var a=t[0],r=t[1],i="AUDIENCE_SEGMENT_EXTERNAL_FEED"===o.plugin_type?n._audienceSegmentService.updateAudienceSegmentExternalFeedProperty:n._audienceSegmentService.updateAudienceSegmentTagFeedProperty;return Promise.all(l.map((function(t){t.writable&&i(e,a,r.id,t.technical_name,t)}))).then((function(e){return r.id}))}))},this.saveAudienceSegment=function(e,t,a){return n._audienceSegmentService.createAudienceSegment(e,{type:"USER_LIST",feed_type:"SCENARIO",datamart_id:t,name:a}).then((function(e){return e.data.id}))},this.saveSubEmailCampaign=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.INITIAL_EMAIL_CAMPAIGN_NODE_FORM_DATA,r=arguments[3];return(r?n._emailCampaignService.updateEmailCampaign(r,i.default.omit(t.campaign,["technical_name"])):n._emailCampaignService.createEmailCampaign(e,i.default.omit(t.campaign,["technical_name"]))).then((function(e){var r=e.data.id,o=[];return o.push.apply(o,h(n._emailCampaignFormService.getRouterTasks(r,t.routerFields,a.routerFields)).concat(h(n._emailCampaignFormService.getBlastTasks(r,t.blastFields,a.blastFields)))),(0,f.executeTasksInSequence)(o).then((function(){return n._emailCampaignService.updateEmailCampaign(r,{id:r,status:"ACTIVE"})})).then((function(){return n._emailCampaignService.getBlasts(r)})).then((function(e){return Promise.all(e.data.map((function(e){return n._emailCampaignService.updateBlast(r,e.id,{id:e.id,status:"SCENARIO_ACTIVATED"})})))})).then((function(){return r}))}))},this._audienceExternalFeedServiceFactory=t("EXTERNAL_FEED"),this._audienceTagFeedServiceFactory=t("TAG_FEED"),this.externalFeedService=this._audienceExternalFeedServiceFactory(""),this.tagFeedService=this._audienceTagFeedServiceFactory("")}return r(e,[{key:"loadInitialAutomationValues",value:function(e){var t=this,n=this._scenarioService.getScenario(e),a=function(n){return t.loadExitCondition(n,e)},r=this._scenarioService.getScenarioStoryline(e),o=this._scenarioService.getScenarioEdges(e);return this._scenarioService.getScenario(e).then((function(i){return Promise.all([n,r,(s=i.data.datamart_id,t.loadScenarioNode(e,s)),o,a(i.data.datamart_id)]).then((function(e){return(0,c.buildAutomationTreeData)(e[1].data,e[2],e[3].data,t._queryService,e[0].data.datamart_id).then((function(t){return{automation:e[0].data,exitCondition:e[4],automationTreeData:t}}))}));var s}))}},{key:"loadExitCondition",value:function(e,t){var n=this;return this._scenarioExitConditionService.getScenarioExitConditions(t).then((function(t){if(t.data.length>0){var a=t.data[0];return n._queryService.getQuery(e,a.query_id).then((function(e){var t=e.data,n=Object.assign({},t);return Object.assign(Object.assign({},a),{formData:n,initialFormData:n})}))}return Promise.resolve(d.INITIAL_AUTOMATION_DATA.exitCondition)})).catch((function(e){return Promise.resolve(d.INITIAL_AUTOMATION_DATA.exitCondition)}))}},{key:"loadScenarioNode",value:function(e,t){var n=this;return this._scenarioService.getScenarioNodes(e).then((function(e){return e.data.forEach((function(e){n.addNodeId(e.id)})),e})).then((function(e){return Promise.all(e.data.map((function(e){var a=Promise.resolve().then((function(){return Object.assign({},e)}));switch(e.type){case"DISPLAY_CAMPAIGN":a=n._displayCampaignFormService.loadCampaign(e.campaign_id).then((function(t){var n={campaign:t.campaign,name:t.campaign.name,goalFields:t.goalFields,adGroupFields:t.adGroupFields};return Object.assign(Object.assign({},e),{formData:n,initialFormData:n})}));break;case"EMAIL_CAMPAIGN":a=n._emailCampaignFormService.loadCampaign(e.campaign_id).then((function(t){var n={name:t.campaign.name,campaign:t.campaign,blastFields:t.blastFields,routerFields:t.routerFields};return Object.assign(Object.assign({},e),{formData:n,initialValuesForm:n})}));break;case"ADD_TO_SEGMENT_NODE":a=n._audienceSegmentFormService.loadSegmentInitialValue(e.user_list_segment_id).then((function(t){var n=t.audienceSegment,a=g.default.duration(e.user_segment_expiration_period),r={audienceSegmentName:n.name,processingActivities:t.processingActivities,ttl:{value:e.user_segment_expiration_period?a._months>0?a._months:a.asDays():void 0,unit:a._months>0?"months":"days"}};return Object.assign(Object.assign({},e),{formData:r,initialValuesForm:r})}));break;case"DELETE_FROM_SEGMENT_NODE":a=n._audienceSegmentService.getSegment(e.user_list_segment_id).then((function(t){var n={audienceSegmentName:t.data.name,segmentId:e.user_list_segment_id};return Object.assign(Object.assign({},e),{formData:n,initialValuesForm:n})}));break;case"ABN_NODE":var r={branch_number:e.branch_number?e.branch_number:2,edges_selection:e.edges_selection};a=Promise.resolve().then((function(){return Object.assign(Object.assign({},e),{formData:r})}));break;case"WAIT_NODE":a=Promise.resolve().then((function(){var t=g.default.duration(e.delay_period),n={wait_duration:{value:t._days>0?t._days:t.asHours(),unit:t._days>0?"days":"hours"},day_window:e.day_window,time_window_start:e.time_window_start?(0,g.default)(e.time_window_start,"HH:mm"):void 0,time_window_end:e.time_window_end?(0,g.default)(e.time_window_end,"HH:mm"):void 0};return Object.assign(Object.assign({},e),{formData:n,initialValuesForm:n})}));break;case"QUERY_INPUT":a=n._queryService.getQuery(t,e.query_id).then((function(t){return Object.assign(Object.assign({},e),{formData:Object.assign(Object.assign({},t.data),{name:name,uiCreationMode:e.ui_creation_mode})})}));break;case"IF_NODE":a=n._queryService.getQuery(t,e.query_id).then((function(t){return Object.assign(Object.assign({},e),{name:"If",formData:Object.assign({},t.data)})}));break;case"END_NODE":case"PLUGIN_NODE":a=Promise.resolve().then((function(){return Object.assign({},e)}));break;case"ON_SEGMENT_ENTRY_INPUT_NODE":case"ON_SEGMENT_EXIT_INPUT_NODE":a=Promise.resolve(Object.assign(Object.assign({},e),{formData:{name:"",datamartId:t,segmentId:e.audience_segment_id},initialFormData:{name:"",datamartId:t,segmentId:e.audience_segment_id}}));break;case"CUSTOM_ACTION_NODE":a=e.custom_action_id?n._customActionService.getInstanceById(e.custom_action_id).then((function(t){var a=t.data,r=n._pluginService.getLocalizedPluginLayoutFromVersionId(a.version_id),o=n._customActionService.getInstanceProperties(a.id).then((function(e){return e.data}));return Promise.all([r,o]).then((function(t){var n=t[0],r=n.plugin,o=n.layout,i=t[1],s={};return i.forEach((function(e){s[e.technical_name]={value:e.value}})),Object.assign(Object.assign({},e),{custom_action_id:a.id,formData:{name:a.name,pluginId:r.id,pluginResource:r,pluginLayout:o,pluginVersionProperties:i,properties:s}})}))})):Promise.resolve(e);break;case"SCENARIO_AUDIENCE_SEGMENT_FEED_NODE":a=n.getFeedNodePromise(e)}return a})))}))}},{key:"saveOrCreateExitCondition",value:function(e,t,n){var a=this,r=n.initialFormData.query_text,o=n.formData.query_text,i=function(){return a._queryService.createQuery(t,n.formData).then((function(t){var n=t.data;a._scenarioExitConditionService.createScenarioExitConditions(e,{type:"EVENT",query_id:n.id})}))};return r&&!o?this._scenarioExitConditionService.deleteScenarioExitConditions(e,n.id):o?r&&r!==o?this._scenarioExitConditionService.deleteScenarioExitConditions(e,n.id).then((function(){return i()})):r?Promise.resolve():i():Promise.resolve()}},{key:"saveOrCreateAutomation",value:function(e,t,n){var a=this,r=t.automation.id;!function e(t){var n;t.node.id&&!(0,p.isFakeId)(t.node.id)&&a.addNodeId(t.node.id),(null===(n=t.in_edge)||void 0===n?void 0:n.id)&&!(0,p.isFakeId)(t.in_edge.id)&&a.addEdgeId(t.in_edge.id),t.out_edges.forEach((function(t){e(t)}))}(n.automationTreeData);return(r?a._scenarioService.updateScenario(r,t.automation):a._scenarioService.createScenario(e,t.automation)).then((function(e){return t.automation.datamart_id?a.saveOrCreateExitCondition(e.data.id,t.automation.datamart_id,t.exitCondition).then((function(){return e})):e})).then((function(n){var r=n.data.id,o=t.automation.datamart_id,i=t.automationTreeData;return o?a.saveFirstNode(o,r,i).then((function(t){return a.iterate(e,o,r,i.out_edges,t.id)})).then((function(){return a.ids.reduce((function(e,t){var r=t.substr(2);return t.startsWith("e-")?e.then((function(){return a._scenarioService.deleteScenarioEdge(n.data.id,r)})):e.then((function(){return a._scenarioService.deleteScenarioNode(n.data.id,r)}))}),Promise.resolve())})).then((function(){return n})):Promise.resolve(n)}))}},{key:"iterateToUpdateDeleteFromSegmentNodes",value:function(e,t,n){var a=this;return n.map((function(n){var r=n.node;return(0,u.isDeleteFromSegmentNode)(r)&&r.formData.segmentId===e?Object.assign(Object.assign({},n),{out_edges:a.iterateToUpdateDeleteFromSegmentNodes(e,t,n.out_edges),node:Object.assign(Object.assign({},r),{formData:Object.assign(Object.assign({},r.formData),{segmentId:t})})}):Object.assign(Object.assign({},n),{out_edges:a.iterateToUpdateDeleteFromSegmentNodes(e,t,n.out_edges)})}))}},{key:"validateAutomationRec",value:function(e){var t=this;return e.reduce((function(e,n){return e.then((function(){return t.validateNode(n).then((function(){return t.validateAutomationRec(n.out_edges)}))}))}),Promise.resolve())}},{key:"validateAutomation",value:function(e){var t=this;return this.validateNode(e).then((function(){return t.validateAutomationRec(e.out_edges)}))}},{key:"validateNode",value:function(e){var t=e.node;if((0,u.isQueryInputNode)(t)||(0,u.isIfNode)(t)){if(!t.formData.query_language)return Promise.reject(_.undefinedQuery);if(!t.formData.query_text||""===t.formData.query_text)return Promise.reject(_.emptyQuery)}return Promise.resolve()}}]),e}();v([(0,s.inject)(l.TYPES.IScenarioService)],S.prototype,"_scenarioService",void 0),v([(0,s.inject)(l.TYPES.IScenarioExitConditionService)],S.prototype,"_scenarioExitConditionService",void 0),v([(0,s.inject)(l.TYPES.IQueryService)],S.prototype,"_queryService",void 0),v([(0,s.inject)(l.TYPES.IDisplayCampaignFormService)],S.prototype,"_displayCampaignFormService",void 0),v([(0,s.inject)(l.TYPES.IDisplayCampaignService)],S.prototype,"_displayCampaignService",void 0),v([(0,s.inject)(l.TYPES.IAudienceSegmentService)],S.prototype,"_audienceSegmentService",void 0),v([(0,s.inject)(l.TYPES.IAudienceSegmentFormService)],S.prototype,"_audienceSegmentFormService",void 0),v([(0,s.inject)(l.TYPES.IEmailCampaignService)],S.prototype,"_emailCampaignService",void 0),v([(0,s.inject)(l.TYPES.IEmailCampaignFormService)],S.prototype,"_emailCampaignFormService",void 0),v([(0,s.inject)(l.TYPES.ICustomActionService)],S.prototype,"_customActionService",void 0),v([(0,s.inject)(l.TYPES.IPluginService)],S.prototype,"_pluginService",void 0),t.AutomationFormService=S=v([(0,s.injectable)(),b(0,(0,s.inject)(l.TYPES.IAudienceSegmentFeedServiceFactory))],S),t.AutomationFormService=S},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudienceFeedFormService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(112),i=n(38),s=n(12);var l=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},c=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"loadTagInitialValue",value:function(e,t){var n=this;return this._audienceSegmentService.getAudienceTagFeed(e,t).then((function(e){return e.data})).then((function(a){return n._audienceSegmentService.getAudienceTagFeedProperties(e,t).then((function(e){return e.data})).then((function(e){return{plugin:a,properties:e}}))}))}},{key:"loadExternalInitialValue",value:function(e,t){var n=this;return this._audienceSegmentService.getAudienceExternalFeed(e,t).then((function(e){return e.data})).then((function(a){return n._audienceSegmentService.getAudienceExternalFeedProperties(e,t).then((function(e){return e.data})).then((function(e){return{plugin:a,properties:e}}))}))}},{key:"saveOrCreateTagFeed",value:function(e,t,n,a){var r=this;if(a)return this._audienceSegmentService.updateAudienceTagFeeds(t,n.plugin.id,n.plugin).then((function(){return d(e,t,n.plugin.id,r._audienceSegmentService.updateAudienceSegmentTagFeedProperty,n.properties)}));var o=n.plugin,i=(o.organisation_id,c(o,["organisation_id"]));return this._audienceSegmentService.createAudienceTagFeeds(t,i).then((function(a){return d(e,t,a.data.id,r._audienceSegmentService.updateAudienceSegmentTagFeedProperty,n.properties)}))}},{key:"saveOrCreateExternalFeed",value:function(e,t,n,a){var r=this;if(a)return this._audienceSegmentService.updateAudienceExternalFeeds(t,n.plugin.id,n.plugin).then((function(){return d(e,t,n.plugin.id,r._audienceSegmentService.updateAudienceSegmentExternalFeedProperty,n.properties)}));var o=n.plugin,i=(o.organisation_id,c(o,["organisation_id"]));return this._audienceSegmentService.createAudienceExternalFeeds(t,i).then((function(a){return d(e,t,a.data.id,r._audienceSegmentService.updateAudienceSegmentExternalFeedProperty,n.properties)}))}}]),e}();l([(0,i.inject)(s.TYPES.IAudienceSegmentService)],u.prototype,"_audienceSegmentService",void 0),t.AudienceFeedFormService=u=l([(0,i.injectable)()],u),t.AudienceFeedFormService=u;var d=function(e,t,n,a,r){var i=[];return r&&r.forEach((function(r){r.writable&&i.push((function(){return a(e,t,n,r.technical_name,r)}))})),(0,o.executeTasksInSequence)(i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OverlapInterval=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(38),i=n(12);var s=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},l=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.interval=0,this.fetchOverlapAnalysis=function(e){var n={hasOverlap:!1,isRunning:!1,isInError:!1,data:null};return t._audienceSegmentService.retrieveOverlap(e,{first_result:0,max_results:1}).then((function(e){return e.data})).then((function(a){if(a.length){var r=a[0];if("PUBLIC_AUDIENCE_SEGMENT"!==r.external_model_name)return Object.assign(Object.assign({},n),{hasOverlap:!1});if("SUCCEEDED"===r.status){var o=r.output_result.result.data_file_uri;return t._dataFileService.getDatafileData(o).then((function(e){return function(e){return new Promise((function(t){var n=new FileReader;n.onload=function(e){var a=n.result;return t(JSON.parse(a))},n.readAsText(e,"UTF-8")}))}(e)})).then((function(n){return t.formatOverlapResponse(n,e)})).then((function(e){return Object.assign(Object.assign({},n),{hasOverlap:!!e,data:e})})).catch((function(){return Object.assign(Object.assign({},n),{isInError:!0})}))}if("FAILED"===r.status||"EXECUTOR_NOT_RESPONDING"===r.status||"LOST"===r.status)return Object.assign(Object.assign({},n),{isInError:!0});if("PENDING"===r.status||"RUNNING"===r.status||"SCHEDULED"===r.status||"WAITING_DEPENDENT_JOB"===r.status)return Object.assign(Object.assign({},n),{isRunning:!0})}return Object.assign(Object.assign({},n),{hasOverlap:!1})}))}}return a(e,[{key:"stopInterval",value:function(){clearTimeout(this.interval)}},{key:"fetchOverlapAnalysisLoop",value:function(e){var t=this;return new Promise((function(n,a){t.interval=window.setInterval((function(){t._audienceSegmentService.retrieveOverlap(e,{first_result:0,max_results:1}).then((function(e){return e.data})).then((function(e){if(e.length){var a=e[0];"PUBLIC_AUDIENCE_SEGMENT"===a.external_model_name?"PENDING"!==a.status&&"RUNNING"!==a.status&&"SCHEDULED"!==a.status&&"WAITING_DEPENDENT_JOB"!==a.status&&(t.stopInterval(),n()):(t.stopInterval(),n())}else t.stopInterval(),n()}))}),2e3)}))}},{key:"createOverlapAnalysis",value:function(e,t,n){var a=this;return this._audienceSegmentService.createOverlap(e,t).then((function(e){return a.fetchOverlapAnalysisLoop(t)}))}},{key:"formatOverlapResponse",value:function(e,t){var n=this,a=e.overlaps.sort((function(e,t){return e.overlap_number>t.overlap_number?-1:1})),r=a.map((function(t){return e.segments.find((function(e){return e.segment_id===t.segment_intersect_with}))||null})),o=[];return r.forEach((function(e){e&&o.push(n._audienceSegmentService.getSegment(e.segment_id.toString()).then((function(e){return e.data})).catch((function(){return Promise.resolve(null)})))})),Promise.all(o).then((function(n){var o=[],i=e.segments.find((function(e){return e.segment_id.toString()===t})).segment_size;return a.forEach((function(e){var t=n.find((function(t){return!!t&&t.id===e.segment_intersect_with.toString()}));if(t){var a=r.find((function(e){return!!e&&e.segment_id.toString()===t.id})),s=a?a.segment_size:1;o.push(Object.assign(Object.assign({},e),{segment_source_id:e.segment_source_id.toString(),segment_source_size:i,segment_intersect_with:{id:e.segment_intersect_with.toString(),name:c(t),segment_size:s}}))}})),{date:e.date,formattedOverlap:o}})).catch((function(){return null}))}}]),e}();s([(0,o.inject)(i.TYPES.IAudienceSegmentService)],l.prototype,"_audienceSegmentService",void 0),s([(0,o.inject)(i.TYPES.IDataFileService)],l.prototype,"_dataFileService",void 0),t.OverlapInterval=l=s([(0,o.injectable)()],l),t.OverlapInterval=l;var c=function(e){var t=e.name;return"USER_ACTIVATION"===e.type&&(e.clickers?t+=" - Clickers":e.exposed&&(t+=" - Exposed")),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudienceSegmentFormService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(17),s=(a=i)&&a.__esModule?a:{default:a},l=n(38),c=n(12),u=n(159);var d=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},f=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.createOrUpdateAudienceSegmentUserList=function(e,n){var a=Object.assign(Object.assign({},n.audienceSegment),{techincal_name:t.fillTechnicalNameForUserPixel(n)});return t._audienceSegmentService.saveSegment(e,a).then((function(e){return void 0!==n.userListFiles&&Promise.all(n.userListFiles.map((function(e){var a=new FormData;return a.append("file",e,e.name),t._audienceSegmentService.importUserListForOneSegment(n.audienceSegment.datamart_id,n.audienceSegment.id,a)}))).then((function(){return e})),e}))},this.createOrUpdateAudienceSegmentUserLookAlike=function(e,n){return t._audienceSegmentService.saveSegment(e,n.audienceSegment)},this.createOrUpdateAudienceSegmentUserQuery=function(e,n,a){return t.createOrUpdateQuery(a,n).then((function(a){var r=Object.assign(Object.assign({},n.audienceSegment),{query_id:a.id});return t._audienceSegmentService.saveSegment(e,r)}))},this.createOrUpdateQuery=function(e,n){var a=n.audienceSegment.datamart_id;return n.query&&n.query.id?t._queryService.updateQuery(a,n.query.id,n.query).then((function(e){return e.data})):t._queryService.createQuery(a,{query_language:e,query_text:n.query.query_text,datamart_id:a}).then((function(e){return e.data}))},this.fillTechnicalNameForUserPixel=function(e){var t=e.audienceSegment.technical_name;return"USER_LIST"!==e.audienceSegment.type||"TAG"!==e.audienceSegment.feed_type||null!=t&&""!==t?t:e.audienceSegment.name+"-"+(0,s.default)().unix()}}return r(e,[{key:"loadSegmentInitialValue",value:function(e){var t=this,n=this._audienceSegmentService.getSegment(e),a=this._audienceSegmentService.getProcessingSelectionsByAudienceSegment(e).then((function(e){var n=e.data;return Promise.all(n.map((function(e){return t._organisationService.getProcessing(e.processing_id).then((function(t){var n=t.data;return{processingSelectionResource:e,processingResource:n}}))})))}));return Promise.all([n,a]).then((function(e){var n=e[0],a=e[1],r=a.map((function(e){return e.processingSelectionResource})),o=a.map((function(e){return(0,u.createFieldArrayModel)(e.processingResource)}));return"USER_QUERY"!==n.data.type&&"USER_LIST"!==n.data.type||!n.data.query_id?{audienceSegment:n.data,initialProcessingSelectionResources:r,processingActivities:o}:t._queryService.getQuery(n.data.datamart_id,n.data.query_id).then((function(e){return e.data})).then((function(e){return{audienceSegment:n.data,query:e,initialProcessingSelectionResources:r,processingActivities:o}}))}))}},{key:"saveOrCreateAudienceSegment",value:function(e,t,n){switch(t.audienceSegment.type){case"USER_LOOKALIKE":return this.createOrUpdateAudienceSegmentUserLookAlike(e,t);case"USER_LIST":return"EDGE"===t.audienceSegment.subtype?this.createOrUpdateAudienceSegmentUserQuery(e,t,n):this.createOrUpdateAudienceSegmentUserList(e,t);case"USER_QUERY":return this.createOrUpdateAudienceSegmentUserQuery(e,t,n);default:return Promise.resolve()}}},{key:"getProcessingSelectionsByAudienceSegment",value:function(e){return this._audienceSegmentService.getProcessingSelectionsByAudienceSegment(e)}},{key:"createProcessingSelectionForAudienceSegment",value:function(e,t){return this._audienceSegmentService.createProcessingSelectionForAudienceSegment(e,t)}},{key:"getAudienceSegmentProcessingSelection",value:function(e,t){return this._audienceSegmentService.getAudienceSegmentProcessingSelection(e,t)}},{key:"deleteAudienceSegmentProcessingSelection",value:function(e,t){return this._audienceSegmentService.deleteAudienceSegmentProcessingSelection(e,t)}}]),e}();d([(0,l.inject)(c.TYPES.IAudienceSegmentService)],f.prototype,"_audienceSegmentService",void 0),d([(0,l.inject)(c.TYPES.IQueryService)],f.prototype,"_queryService",void 0),d([(0,l.inject)(c.TYPES.IOrganisationService)],f.prototype,"_organisationService",void 0),t.AudienceSegmentFormService=f=d([(0,l.injectable)()],f),t.AudienceSegmentFormService=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudiencePartitionsService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getPartitions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="audience_partitions",a=Object.assign({organisation_id:e},t);return s.default.getRequest(n,a)}},{key:"getPartition",value:function(e){var t="audience_partitions/"+e;return s.default.getRequest(t)}},{key:"savePartition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="audience_partitions/"+e;return s.default.putRequest(n,t)}},{key:"publishPartition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="audience_partitions/"+e+"/publish";return s.default.putRequest(n,t)}},{key:"createPartition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="audience_partitions?datamart_id="+t+"&organisation_id="+e;return s.default.postRequest(a,n)}},{key:"archiveAudiencePartition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="audience_partitions/"+e;return s.default.putRequest(n,t)}}]),e}();t.AudiencePartitionsService=u=c([(0,l.injectable)()],u),t.AudiencePartitionsService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=p(n(46)),s=p(n(78)),l=n(83),c=n(56),u=p(n(81)),d=n(38),f=n(12);function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},g=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getSegments=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="audience_segments",a=Object.assign({organisation_id:e},t);return i.default.getRequest(n,a)},this.getSegment=function(e){var t="audience_segments/"+e;return i.default.getRequest(t)},this.updateAudienceSegment=function(e,t){var n="audience_segments/"+e;return i.default.putRequest(n,t)},this.deleteAudienceSegment=function(e){var t="audience_segments/"+e;return i.default.deleteRequest(t)},this.saveSegment=function(e,n){return n.id?t.updateAudienceSegment(n.id,n):t.createAudienceSegment(e,n)},this.createOverlap=function(e,t){var n="datamarts/"+e+"/overlap_analysis",a={first_party_overlap:{source:{type:"segment_overlap",segment_id:t,datamart_id:e},type:"FIRST_PARTY_OVERLAP"}};return i.default.postRequest(n,a)},this.importUserList=function(e,t){var n="datamarts/"+e+"/user_list_imports";return i.default.postRequest(n,t)},this.importUserListForOneSegment=function(e,t,n){var a="datamarts/"+e+"/audience_segments/"+t+"/user_list_imports";return i.default.postRequest(a,n)},this.findUserListImportExecutionsBySegment=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="datamarts/"+e+"/audience_segments/"+t+"/user_list_imports",r=Object.assign({},n);return i.default.getRequest(a,r)},this.retrieveOverlap=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="audience_segments/"+e+"/overlap_analysis",a=Object.assign({audienceSegmentId:e,job_type:"FIRST_PARTY_OVERLAP_ANALYSIS"},t);return i.default.getRequest(n,a)},this.createAudienceSegmentExport=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"TEXT_CSV",a="audience_segments/"+e+"/exports",r={export_user_identifier:t,mime_type:n};return i.default.postRequest(a,r)},this.findAudienceSegmentExportExecutionsBySegment=function(e,t){var n="audience_segments/"+e+"/exports",a=Object.assign({},t);return i.default.getRequest(n,a)},this.getSegmentMetaData=function(e){return s.default.getAudienceSegmentReport(e,new u.default("now"),new u.default("now"),["audience_segment_id"]).then((function(e){return(0,l.normalizeArrayOfObject)((0,c.normalizeReportView)(e.data.report_view),"audience_segment_id")}))},this.getSegmentsWithMetadata=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Promise.all([t.getSegments(e,n),t.getSegmentMetaData(e)]).then((function(e){var t=a(e,2),n=t[0],r=t[1],o=n.data.map((function(e){var t=r[e.id],n=t&&t.user_points?t.user_points:"-",a=t&&t.desktop_cookie_ids?t.desktop_cookie_ids:"-";return Object.assign(Object.assign({},e),{user_points:n,desktop_cookie_ids:a})}));return Object.assign(Object.assign({},n),{data:o})}))},this.createAudienceSegment=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="audience_segments?organisation_id="+e,a=Object.assign({},t);return i.default.postRequest(n,a)},this.getAudienceExternalFeeds=function(e){var t="audience_segments/"+e+"/external_feeds";return i.default.getRequest(t)},this.getAudienceExternalFeed=function(e,t){var n="audience_segments/"+e+"/external_feeds/"+t;return i.default.getRequest(n)},this.createAudienceExternalFeeds=function(e,t){var n="audience_segments/"+e+"/external_feeds";return i.default.postRequest(n,t)},this.updateAudienceExternalFeeds=function(e,t,n){var a="audience_segments/"+e+"/external_feeds/"+t;return i.default.putRequest(a,n)},this.deleteAudienceExternalFeeds=function(e,t){var n="audience_segments/"+e+"/external_feeds/"+t;return i.default.deleteRequest(n)},this.getAudienceExternalFeedProperties=function(e,t){var n="audience_segments/"+e+"/external_feeds/"+t+"/properties";return i.default.getRequest(n)},this.getAudienceTagFeed=function(e,t){var n="audience_segments/"+e+"/tag_feeds/"+t;return i.default.getRequest(n)},this.getAudienceTagFeeds=function(e){var t="audience_segments/"+e+"/tag_feeds";return i.default.getRequest(t)},this.createAudienceTagFeeds=function(e,t){var n="audience_segments/"+e+"/tag_feeds";return i.default.postRequest(n,t)},this.updateAudienceTagFeeds=function(e,t,n){var a="audience_segments/"+e+"/tag_feeds/"+t;return i.default.putRequest(a,n)},this.deleteAudienceTagFeeds=function(e,t){var n="audience_segments/"+e+"/tag_feeds/"+t;return i.default.deleteRequest(n)},this.getAudienceTagFeedProperties=function(e,t){var n="audience_segments/"+e+"/tag_feeds/"+t+"/properties";return i.default.getRequest(n)},this.updateAudienceSegmentExternalFeedProperty=function(e,n,a,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i="audience_segments/"+n+"/external_feeds/"+a+"/properties/technical_name="+r;return t._pluginService.handleSaveOfProperties(o,e,"attribution_models",a,i)},this.updateAudienceSegmentTagFeedProperty=function(e,n,a,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i="audience_segments/"+n+"/tag_feeds/"+a+"/properties/technical_name="+r;return t._pluginService.handleSaveOfProperties(o,e,"attribution_models",a,i)},this.recalibrateAudienceLookAlike=function(e){var t="audience_segment_lookalikes/"+e+"/calibrate";return i.default.postRequest(t,{})}}return r(e,[{key:"getProcessingSelectionsByAudienceSegment",value:function(e){var t="audience_segments/"+e+"/processing_selections";return i.default.getRequest(t)}},{key:"createProcessingSelectionForAudienceSegment",value:function(e,t){var n="audience_segments/"+e+"/processing_selections";return i.default.postRequest(n,t)}},{key:"getAudienceSegmentProcessingSelection",value:function(e,t){var n="audience_segments/"+e+"/processing_selections/"+t;return i.default.getRequest(n)}},{key:"deleteAudienceSegmentProcessingSelection",value:function(e,t){var n="audience_segments/"+e+"/processing_selections/"+t;return i.default.deleteRequest(n)}}]),e}();m([(0,d.inject)(f.TYPES.IPluginService)],g.prototype,"_pluginService",void 0),g=m([(0,d.injectable)()],g),t.default=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DisplayCampaignFormService=void 0;var a,r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(263),l=n(54),c=n(46),u=n(159),d=n(112),f=n(739),p=n(1371),m=(a=p)&&a.__esModule?a:{default:a},g=n(38),y=n(12),h=n(178);function v(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var b=function(e,t,n,a){var r,o=arguments.length,s=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},_=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getExposedClickersTasks=function(e,n,a){return[function(){return t._audienceSegmentService.createAudienceSegment(e,{campaign_id:n,clickers:!1,datamart_id:a,exposed:!0,type:"USER_ACTIVATION"})},function(){return t._audienceSegmentService.createAudienceSegment(e,{campaign_id:n,clickers:!0,datamart_id:a,exposed:!1,type:"USER_ACTIVATION"})}]},this.getGoalTasks=function(e,n,a,r,o){var i=[];r.forEach((function(e){(0,f.isGoalSelectionResource)(e.model)&&i.push(e.model.id)}));var l=[];a.forEach((function(e){(0,f.isGoalSelectionResource)(e.model)&&l.push(e.model.id)}));var c=[];return a.forEach((function(a){if((0,f.isGoalFormData)(a.model)){var r=a.model;c.push((function(){return((0,s.isExistingGoal)(r.goal)?t._goalFormService.loadGoalData(r.goal.id):Promise.resolve(s.INITIAL_GOAL_FORM_DATA)).then((function(a){return t._goalFormService.saveGoal(e,r,a).then((function(e){return t._displayCampaignService.createGoal(n,{goal_id:e.id,goal_selection_type:"CONVERSION",default:!0})}))}))}))}else if(!(0,f.isGoalSelectionResource)(a.model)){var o=a.model;c.push((function(){return t._displayCampaignService.createGoal(n,o)}))}})),i.filter((function(e){return!l.includes(e)})).forEach((function(e){c.push((function(){return t._displayCampaignService.deleteGoal(n,e)}))})),c}}return o(e,[{key:"loadCampaign",value:function(e,t){return Promise.all([this._displayCampaignService.getCampaignDisplay(e).then(c.extractData),this.loadCampaignDependencies(e,t)]).then((function(e){var n=r(e,2),a=n[0],o=n[1];return Object.assign({campaign:t?(0,l.omit)(a,"id"):a},o)}))}},{key:"loadCampaignDependencies",value:function(e,t){var n=this;return Promise.all([this._displayCampaignService.getGoals(e).then(c.extractDataList),this._displayCampaignService.getAdGroups(e).then((function(a){return Promise.all(a.data.map((function(a){return n._adGroupFormService.loadAdGroup(e,a.id,t)})))}))]).then((function(e){var a=r(e,2),o=a[0],i=a[1],s=[],c=[];return o.forEach((function(e){c.push((function(){return n._goalService.getGoal(e.goal_id).then((function(e){return e.data})).then((function(n){s.push(Object.assign({},(0,u.createFieldArrayModelWithMeta)(t?(0,l.omit)(e,"id"):e,{name:e.goal_name,triggerMode:n.new_query_id?"QUERY":"PIXEL"})))}))}))})),(0,d.executeTasksInSequence)(c).then((function(){var e=i.map((function(e){return(0,u.createFieldArrayModel)(t?(0,l.omit)(e,"id"):e)}));return{goalFields:s,adGroupFields:e}}))}))}},{key:"saveCampaign",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.INITIAL_DISPLAY_CAMPAIGN_FORM_DATA,r=arguments[3];return(t.campaign.id?this._displayCampaignService.updateCampaign(t.campaign.id,t.campaign):this._displayCampaignService.createCampaign(Object.assign(Object.assign({},t.campaign),{organisation_id:e})).then((function(t){return r?(0,d.executeTasksInSequence)(n.getExposedClickersTasks(e,t.data.id,r)).then((function(){return t})):t}))).then((function(o){var i=o.data.id,s=[];return s.push.apply(s,v(n.getGoalTasks(e,i,t.goalFields,a.goalFields,r)).concat(v(n.getAdGroupTasks(e,i,t.adGroupFields,a.adGroupFields)))),(0,d.executeTasksInSequence)(s).then((function(){return i}))}))}},{key:"saveCampaigns",value:function(e,t){var n=this,a=[];return e.forEach((function(e){a.push((function(){return n._displayCampaignService.getCampaignDisplay(e).then((function(e){return e.data})).then((function(a){var r=t.fields.reduce((function(e,t){var n=t.campaignProperty;return Object.assign(Object.assign({},e),function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t.campaignProperty,(0,m.default)(t.action,a[n],t.value)))}),{});return n._displayCampaignService.updateCampaign(e,r)}))}))})),(0,d.executeTasksInSequence)(a)}},{key:"getAdGroupTasks",value:function(e,t,n,a){var r=this,o=[];a.forEach((function(e){e.model.adGroup.id&&o.push(e.model.adGroup.id)}));var i=[];n.forEach((function(e){e.model.adGroup.id&&i.push(e.model.adGroup.id)}));var s=[];return n.forEach((function(n){var o=a.find((function(e){return e.key===n.key}));s.push((function(){return r._adGroupFormService.saveAdGroup(e,t,n.model,o?o.model:h.INITIAL_AD_GROUP_FORM_DATA)}))})),o.filter((function(e){return!i.includes(e)})).forEach((function(e){s.push((function(){return r._displayCampaignService.deleteAdGroup(t,e)}))})),s}}]),e}();b([(0,g.inject)(y.TYPES.IAudienceSegmentService)],_.prototype,"_audienceSegmentService",void 0),b([(0,g.inject)(y.TYPES.IGoalFormService)],_.prototype,"_goalFormService",void 0),b([(0,g.inject)(y.TYPES.IDisplayCampaignService)],_.prototype,"_displayCampaignService",void 0),b([(0,g.inject)(y.TYPES.IAdGroupFormService)],_.prototype,"_adGroupFormService",void 0),b([(0,g.inject)(y.TYPES.IGoalService)],_.prototype,"_goalService",void 0),t.DisplayCampaignFormService=_=b([(0,g.injectable)()],_),t.DisplayCampaignFormService=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={equals:function(e,t){return t},increase:function(e,t){return e+e*t*.01},decrease:function(e,t){return e-e*t*.01}};t.default=function(e,t,n){return a[e](t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImportService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(38),s=n(46),l=(a=s)&&a.__esModule?a:{default:a};var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getImportList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="datamarts/"+e+"/document_imports",a=Object.assign({},t);return l.default.getRequest(n,a)}},{key:"getImport",value:function(e,t){var n="datamarts/"+e+"/document_imports/"+t;return l.default.getRequest(n)}},{key:"createImport",value:function(e,t){var n="datamarts/"+e+"/document_imports";return l.default.postRequest(n,t)}},{key:"updateImport",value:function(e,t,n){var a="datamarts/"+e+"/document_imports/"+t;return l.default.putRequest(a,n)}},{key:"deleteImport",value:function(e,t){var n="datamarts/"+e+"/document_imports/"+t;return l.default.deleteRequest(n)}},{key:"createImportExecution",value:function(e,t,n){var a="datamarts/"+e+"/document_imports/"+t+"/executions";return l.default.postRequest(a,n)}},{key:"getImportExecutions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="datamarts/"+e+"/document_imports/"+t+"/executions";return l.default.getRequest(a,n)}},{key:"cancelImportExecution",value:function(e,t,n){var a="datamarts/"+e+"/document_imports/"+t+"/executions/"+n+"/action";return l.default.postRequest(a,{action:"CANCEL"})}}]),e}();t.ImportService=u=c([(0,i.injectable)()],u),t.ImportService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudienceExternalFeedService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(38),i=s(n(46));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},d=function(e){function t(){l(this,t);var e=c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.getFeedsAggregationMetrics=function(e){return i.default.postRequest("audience_segments.external_feeds/aggregates",e)},e.getInstanceById=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="audience_segments/"+e.segmentId+"/external_feeds/"+t,r=Object.assign({},n);return i.default.getRequest(a,r)},e.getInstanceProperties=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="audience_segments/"+e.segmentId+"/external_feeds/"+t+"/properties";return i.default.getRequest(a,n)},e.updatePluginInstance=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="audience_segments/"+e.segmentId+"/external_feeds/"+t,r=Object.assign({},n);return i.default.putRequest(a,r)},e.updatePluginInstanceProperty=function(t,n,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o="audience_segments/"+e.segmentId+"/external_feeds/"+n+"/properties/technical_name="+a;return e._pluginService.handleSaveOfProperties(r,t,"audience_external_feeds",n,o)},e.createPluginInstance=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="audience_segments/"+e.segmentId+"/external_feeds?organisation_id="+t,r=Object.assign({},n);return i.default.postRequest(a,r)},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"getFeeds",value:function(e){return i.default.getRequest("audience_segments.external_feeds",e)}},{key:"getAudienceFeeds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="plugins",a=Object.assign({plugin_type:"AUDIENCE_SEGMENT_EXTERNAL_FEED",organisation_id:e},t);return i.default.getRequest(n,a)}},{key:"deleteAudienceFeed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="audience_segments/"+this.segmentId+"/external_feeds/"+e;return i.default.deleteRequest(n,t)}},{key:"getLocalizedPluginLayout",value:function(e){var t=this;return this.getInstanceById(e).then((function(e){var n=e.data;return t._pluginService.findPluginFromVersionId(n.version_id).then((function(e){var a=e.data;return t._pluginService.getLocalizedPluginLayout(a.id,n.version_id)}))}))}}]),t}(s(n(905)).default);t.AudienceExternalFeedService=d=u([(0,o.injectable)()],d),t.AudienceExternalFeedService=d,t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudienceTagFeedService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=l(n(46)),i=l(n(905)),s=n(38);function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},f=function(e){function t(){c(this,t);var e=u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.getFeedsAggregationMetrics=function(e){return o.default.postRequest("audience_segments.tag_feeds/aggregates",e)},e.getInstanceById=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="audience_segments/"+e.segmentId+"/tag_feeds/"+t,r=Object.assign({},n);return o.default.getRequest(a,r)},e.getInstanceProperties=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="audience_segments/"+e.segmentId+"/tag_feeds/"+t+"/properties";return o.default.getRequest(a,n)},e.updatePluginInstance=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="audience_segments/"+e.segmentId+"/tag_feeds/"+t,r=Object.assign({},n);return o.default.putRequest(a,r)},e.updatePluginInstanceProperty=function(t,n,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o="audience_segments/"+e.segmentId+"/tag_feeds/"+n+"/properties/technical_name="+a;return e._pluginService.handleSaveOfProperties(r,t,e.entityPath,n,o)},e.createPluginInstance=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="audience_segments/"+e.segmentId+"/tag_feeds?organisation_id="+t,r=Object.assign({},n);return o.default.postRequest(a,r)},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"getFeeds",value:function(e){return o.default.getRequest("audience_segments.tag_feeds",e)}},{key:"getAudienceFeeds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="plugins",a=Object.assign({plugin_type:"AUDIENCE_SEGMENT_TAG_FEED",organisation_id:e},t);return o.default.getRequest(n,a)}},{key:"deleteAudienceFeed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="audience_segments/"+this.segmentId+"/tag_feeds/"+e;return o.default.deleteRequest(n,t)}},{key:"getLocalizedPluginLayout",value:function(e){var t=this;return this.getInstanceById(e).then((function(e){var n=e.data;return t._pluginService.findPluginFromVersionId(n.version_id).then((function(e){var a=e.data;return t._pluginService.getLocalizedPluginLayout(a.id,n.version_id)}))}))}}]),t}(i.default);t.AudienceTagFeedService=f=d([(0,s.injectable)()],f),t.AudienceTagFeedService=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DisplayNetworkService=void 0;var a,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(46),i=(a=o)&&a.__esModule?a:{default:a},s=n(38);var l=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},c=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getDisplayNetwork=function(e,t){var n="display_networks/"+e+"?organisation_id="+t;return i.default.getRequest(n)}};t.DisplayNetworkService=c=l([(0,s.injectable)()],c),t.DisplayNetworkService=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DealListService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getDealLists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="deal_lists",a=Object.assign({organisation_id:e},t);return s.default.getRequest(n,a)}},{key:"getDealList",value:function(e,t){var n="deal_lists/"+t;return s.default.getRequest(n,{organisation_id:e})}},{key:"createDealList",value:function(e,t){var n="deal_lists?organisation_id="+e;return s.default.postRequest(n,t)}},{key:"updateDealList",value:function(e,t,n){var a="deal_lists/"+t+"?organisation_id="+e;return s.default.putRequest(a,n)}},{key:"deleteDealList",value:function(e,t){var n="deal_lists/"+t;return s.default.deleteRequest(n,{organisation_id:e})}},{key:"getDeals",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="deals",a=Object.assign({organisation_id:e},t);return s.default.getRequest(n,a)}},{key:"getDeal",value:function(e){var t="deals/"+e;return s.default.getRequest(t)}},{key:"createDeal",value:function(e,t){var n="deals?organisation_id="+e;return s.default.postRequest(n,t)}},{key:"updateDeal",value:function(e,t){var n="deals/"+e;return s.default.putRequest(n,t)}},{key:"deleteDeal",value:function(e){var t="deals/"+e;return s.default.deleteRequest(t)}},{key:"addDealToDealList",value:function(e,t){var n="deal_lists/"+e+"/deal/"+t;return s.default.putRequest(n,{})}},{key:"removeDealToDealList",value:function(e,t){var n="deal_lists/"+e+"/deal/"+t;return s.default.deleteRequest(n,{})}}]),e}();t.DealListService=u=c([(0,l.injectable)()],u),t.DealListService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DealListFormService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(112),i=n(906),s=n(12),l=n(38);function c(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var u=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"saveDealList",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.INITIAL_DEAL_LIST_FORM_DATA,r=arguments[3],s={name:t.name,organisation_id:e};return(r?this._dealsListService.updateDealList(e,r,s):this._dealsListService.createDealList(e,s)).then((function(r){var i=r.data.id,s=[];return s.push.apply(s,c(n.getDealListExpressionTasks(e,i,t.deals,a.deals))),(0,o.executeTasksInSequence)(s).then((function(){return i}))}))}},{key:"hasId",value:function(e){return void 0!==e.id}},{key:"getDealListExpressionTasks",value:function(e,t,n){var a=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=[];r.forEach((function(e){a.hasId(e.model)&&o.push(e.model.id)}));var i=[];n.forEach((function(e){a.hasId(e.model)&&i.push(e.model.id)}));var s=[];return n.forEach((function(n){a.hasId(n.model)||s.push((function(){return a._dealsListService.createDeal(e,Object.assign(Object.assign({},n.model),{organisation_id:e})).then((function(e){return a._dealsListService.addDealToDealList(t,e.data.id)}))}))})),o.filter((function(e){return!i.includes(e)})).forEach((function(e){s.push((function(){return a._dealsListService.removeDealToDealList(t,e).then((function(t){return a._dealsListService.deleteDeal(e)}))}))})),s}}]),e}();u([(0,l.inject)(s.TYPES.IDealListService)],d.prototype,"_dealsListService",void 0),t.DealListFormService=d=u([(0,l.injectable)()],d),t.DealListFormService=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getCompartments",value:function(e){return s.default.getRequest("user_account_compartments/?organisation_id="+e)}},{key:"getCompartment",value:function(e){return s.default.getRequest("user_account_compartments/"+e)}}]),e}();u=c([(0,l.injectable)()],u),t.default=u},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoalFormService=void 0;var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(159),s=n(112),l=n(263),c=n(38),u=n(12);function d(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var f=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"loadGoalData",value:function(e){var t=this;return Promise.all([this._goalService.getGoal(e),this._goalService.getAttributionModels(e)]).then((function(e){var n=a(e,2),r=n[0],o=n[1],s=Object.assign(Object.assign({},l.INITIAL_GOAL_FORM_DATA),{goal:r.data,triggerType:r.data.new_query_id?"QUERY":"PIXEL",attributionModels:o.data.map((function(e){return(0,i.createFieldArrayModelWithMeta)(e,{name:e.attribution_model_name,group_id:e.group_id,artifact_id:e.artifact_id,default:e.default})}))});return r.data.new_query_id?t._queryService.getQuery(r.data.datamart_id,r.data.new_query_id).then((function(e){return e.data})).then((function(e){return s.query=e,s.queryLanguage=e.query_language,s})):s}))}},{key:"saveGoal",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.INITIAL_GOAL_FORM_DATA,r=Promise.resolve(t.goal);if("QUERY"===t.triggerType&&t.query){var o=Object.assign(Object.assign({},t.query),{datamart_id:t.goal.datamart_id,query_language:t.queryLanguage});r=this._queryService.createQuery(t.goal.datamart_id,o).then((function(e){return Object.assign(Object.assign({},t.goal),{new_query_id:e.data.id})}))}return r.then((function(r){return(t.goal&&(0,l.isGoalResource)(t.goal)?n._goalService.updateGoal(t.goal.id,r):n._goalService.createGoal(e,r)).then((function(e){var r=e.data.id,o=[];return o.push.apply(o,d(n.getAttributionModelTasks(r,t.attributionModels,a.attributionModels))),(0,s.executeTasksInSequence)(o).then((function(){return e.data}))}))}))}},{key:"getAttributionModelTasks",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=[];a.forEach((function(e){(0,l.isAttributionSelectionResource)(e.model)&&r.push(e.model.id)}));var o=[];t.forEach((function(e){(0,l.isAttributionSelectionResource)(e.model)&&o.push(e.model.id)}));var i=[];return t.forEach((function(t){if((0,l.isAttributionSelectionResource)(t.model)){var a=t.model;i.push((function(){return n._goalService.updateLinkAttributionModel(e,a.id,Object.assign(Object.assign({},a),{default:t.meta.default}))}))}else{var r=t.model;"DIRECT"===r.attribution_type?i.push((function(){return n._goalService.linkAttributionModelToGoal(e,{attribution_type:"DIRECT",default:t.meta.default})})):i.push((function(){return n._goalService.linkAttributionModelToGoal(e,{attribution_model_id:r.attribution_model_id,attribution_type:"WITH_PROCESSOR",default:t.meta.default})}))}})),r.filter((function(e){return!o.includes(e)})).forEach((function(t){i.push((function(){return n._goalService.deleteAttributionModel(e,t)}))})),i}}]),e}();f([(0,c.inject)(u.TYPES.IQueryService)],p.prototype,"_queryService",void 0),f([(0,c.inject)(u.TYPES.IGoalService)],p.prototype,"_goalService",void 0),t.GoalFormService=p=f([(0,c.injectable)()],p),t.GoalFormService=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExportService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getExports",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="exports";return s.default.getRequest(t,e)}},{key:"deleteExport",value:function(e){var t="exports/"+e;return s.default.deleteRequest(t)}},{key:"getExport",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="exports/"+e;return s.default.getRequest(n,t)}},{key:"getExportExecutions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="exports/"+e+"/executions";return s.default.getRequest(n,t)}},{key:"createExport",value:function(e,t){var n="exports?organisation_id="+e;return s.default.postRequest(n,t)}},{key:"updateExport",value:function(e,t){var n="exports/"+e;return s.default.putRequest(n,t)}},{key:"createExecution",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="exports/"+e+"/executions",a=Object.assign({},t);return s.default.postRequest(n,a)}}]),e}();t.ExportService=u=c([(0,l.injectable)()],u),t.ExportService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UsersService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getUsers",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="users",a=Object.assign({organisation_id:e},t);return s.default.getRequest(n,a)}},{key:"getUsersWithUserRole",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="community/"+e+"/users.user_roles";return s.default.getRequest(n,t)}},{key:"getUser",value:function(e,t){var n="users/"+e+"?organisation_id="+t;return s.default.getRequest(n)}},{key:"createUser",value:function(e,t){var n="users?organisation_id="+e;return s.default.postRequest(n,t)}},{key:"updateUser",value:function(e,t,n){var a="users/"+e+"?organisation_id="+t;return s.default.putRequest(a,n)}},{key:"deleteUser",value:function(e,t){var n="users/"+e+"?organisation_id="+t;return s.default.deleteRequest(n)}}]),e}();t.UsersService=u=c([(0,l.injectable)()],u),t.UsersService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MonitoringService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(590),i=n(54),s=n(38),l=n(12),c=n(590);var u=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"fetchProfileData",value:function(e,t){var n=this,a={type:void 0,profile:{}};return this._userDataService.getProfiles(e.id,t).then((function(e){if(!e)return a;if(1===e.data.length&&void 0===e.data[0].$compartment_id)return{type:"legacy",profile:e.data[0]};return function(e){var t=[],a=new Set,r=!0,o=!1,i=void 0;try{for(var s,l=e[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value;c.$compartment_id&&a.add(c.$compartment_id)}}catch(e){o=!0,i=e}finally{try{!r&&l.return&&l.return()}finally{if(o)throw i}}return a.forEach((function(e){t.push(n._datamartService.getUserAccountCompartment(e).then((function(e){return e.data})))})),Promise.all(t)}(e.data).then((function(t){var n={},a=!0,r=!1,o=void 0;try{for(var i,s=t[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){var l=i.value;n[l.id]=l}}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}var c=Promise.resolve({});return{type:"pionus",profile:e.data.reduce((function(e,t){var a=e,r=t.$compartment_id?t.$compartment_id:"default",o={userAccountId:t.$user_account_id?t.$user_account_id:"anonymous",profile:t};return a[r]?a[r].profiles=a[r].profiles.concat(o):a[r]={compartmentName:n[r].name||n[r].token,profiles:[o]},a}),c)}})).catch((function(e){return a}))})).catch((function(){return a}))}},{key:"fetchSegmentsData",value:function(e,t){return this._userDataService.getSegments(e.id,t).then((function(e){return e.data})).catch((function(e){return[]}))}},{key:"fetchCompartments",value:function(e){return this._datamartService.getUserAccountCompartmentDatamartSelectionResources(e.id).then((function(e){return e.data})).catch((function(e){return[]}))}},{key:"getLastSeen",value:function(e,t){return this._userDataService.getActivities(e.id,t,{live:!0}).then((function(e){var t=e.data.map((function(e){return e.$ts})),n=0;return t.length>0&&(n=Math.max.apply(null,t)),n})).catch((function(e){return 0}))}},{key:"fetchUserAccountsByCompartmentId",value:function(e,t){return this._userDataService.getIdentifiers(e.organisation_id,e.id,t.type,t.id).then((function(e){var t=e.data.filter(c.isUserAccountIdentifier);return(0,i.groupBy)(t,"compartment_id")}))}},{key:"fetchUserAgents",value:function(e,t){return this._userDataService.getIdentifiers(e.organisation_id,e.id,t.type,t.id).then((function(e){return e.data.filter(c.isUserAgentIdentifier)}))}},{key:"fetchUserEmails",value:function(e,t){return this._userDataService.getIdentifiers(e.organisation_id,e.id,t.type,t.id).then((function(e){return e.data.filter(c.isUserEmailIdentifier)}))}},{key:"fetchProcessings",value:function(e){var t=this;return this._organisationService.getOrganisation(e.organisation_id).then((function(e){var n=e.data.community_id;return t._organisationService.getProcessings(n,{first_result:0,max_results:2147483647}).then((function(e){return e.data}))})).catch((function(e){return[]}))}},{key:"fetchUserChoices",value:function(e,t){return this._userDataService.getUserChoices(e.id,t).then((function(e){return e.data})).catch((function(e){return[]}))}},{key:"fetchMonitoringDataByIdentifier",value:function(e,t){return Promise.all([this.fetchCompartments(t),this.getLastSeen(t,e),this.fetchSegmentsData(t,e),this.fetchProfileData(t,e),this.fetchProcessings(t),this.fetchUserChoices(t,e)])}},{key:"fetchMonitoringData",value:function(e,t,n,a,r){var s=this,l={userAgentList:[],userEmailList:[],userAccountsByCompartmentId:{},userAccountCompartments:[],lastSeen:0,userSegmentList:[],userChoices:{userChoices:[],processings:[]},userProfile:{type:void 0,profile:{}},userPointList:[],userIdentifier:{type:"",id:""},isUserFound:!1};return this._userDataService.getIdentifiers(e,t.id,n,a,r).then((function(e){var n=e.data.find(o.isUserPointIdentifier),a=e.data.find(c.isUserAgentIdentifier),r=n?{type:"user_point_id",id:n&&n.user_point_id}:{type:"user_agent_id",id:a?a&&a.vector_id:""};return r.id?s.fetchMonitoringDataByIdentifier(r,t).then((function(t){return{userAgentList:e.data.filter(c.isUserAgentIdentifier),userEmailList:e.data.filter(c.isUserEmailIdentifier),userAccountsByCompartmentId:(0,i.groupBy)(e.data.filter(c.isUserAccountIdentifier),"compartment_id"),userAccountCompartments:t[0],lastSeen:t[1],userSegmentList:t[2],userChoices:{userChoices:t[5],processings:t[4]},userProfile:t[3],userPointList:[],userIdentifier:r,isUserFound:!0}})):Promise.resolve(l)})).catch((function(){var e={id:a,type:n};return s.fetchMonitoringDataByIdentifier(e,t).then((function(t){return t[1]?{userAgentList:[],userEmailList:[],userAccountsByCompartmentId:{},userAccountCompartments:t[0],lastSeen:t[1],userSegmentList:t[2],userChoices:{userChoices:t[5],processings:t[4]},userProfile:t[3],userPointList:[],userIdentifier:e,isUserFound:!0}:l}))}))}}]),e}();u([(0,s.inject)(l.TYPES.IDatamartService)],d.prototype,"_datamartService",void 0),u([(0,s.inject)(l.TYPES.IUserDataService)],d.prototype,"_userDataService",void 0),u([(0,s.inject)(l.TYPES.IOrganisationService)],d.prototype,"_organisationService",void 0),t.MonitoringService=d=u([(0,s.injectable)()],d),t.MonitoringService=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MlAlgorithmService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getMlAlgorithms",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="ml_algorithms",a=Object.assign({organisation_id:e},t);return s.default.getRequest(n,a)}},{key:"getMlAlgorithm",value:function(e){var t="ml_algorithms/"+e;return s.default.getRequest(t)}},{key:"createMlAlgorithm",value:function(e){return s.default.postRequest("ml_algorithms",e)}},{key:"updateMlAlgorithm",value:function(e,t){var n="ml_algorithms/"+e;return s.default.putRequest(n,t)}}]),e}();t.MlAlgorithmService=u=c([(0,l.injectable)()],u),t.MlAlgorithmService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MlAlgorithmModelService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(38),s=n(46),l=(a=s)&&a.__esModule?a:{default:a};var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getMlAlgorithmModels",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="ml_algorithms/"+t+"/models",r=Object.assign({organisation_id:e},n);return l.default.getRequest(a,r)}},{key:"getMlAlgorithmModel",value:function(e,t){var n="ml_algorithms/"+e+"/models/"+t;return l.default.getRequest(n)}},{key:"createMlAlgorithmModel",value:function(e,t){var n="ml_algorithms/"+e+"/models";return l.default.postRequest(n,t)}},{key:"updateMlAlgorithmModel",value:function(e,t,n){var a="ml_algorithms/"+e+"/models/"+t;return l.default.putRequest(a,n)}},{key:"uploadResult",value:function(e,t,n){var a="ml_algorithms/"+e+"/models/"+t+"/result";return l.default.postRequest(a,n)}},{key:"uploadBinary",value:function(e,t,n){var a="ml_algorithms/"+e+"/models/"+t+"/binary";return l.default.postRequest(a,n)}},{key:"uploadNotebook",value:function(e,t,n){var a="ml_algorithms/"+e+"/models/"+t+"/notebook";return l.default.postRequest(a,n)}}]),e}();t.MlAlgorithmModelService=u=c([(0,i.injectable)()],u),t.MlAlgorithmModelService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MlAlgorithmVariableService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(38),s=n(46),l=(a=s)&&a.__esModule?a:{default:a};var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getMlAlgorithmVariables",value:function(e,t,n){var a="ml_algorithms/"+t+"/variables",r=Object.assign({organisation_id:e},n);return l.default.getRequest(a,r)}},{key:"getMlAlgorithmVariable",value:function(e,t){var n="ml_algorithms/"+e+"/variables/"+t;return l.default.getRequest(n)}},{key:"createMlAlgorithmVariable",value:function(e,t){var n="ml_algorithms/"+e+"/variables";return l.default.postRequest(n,t)}},{key:"updateMlAlgorithmVariable",value:function(e,t,n){var a="ml_algorithms/"+e+"/variables/"+t;return l.default.putRequest(a,n)}},{key:"deleteMlAlgorithmVariable",value:function(e,t){var n="ml_algorithms/"+e+"/variables/"+t;return l.default.deleteRequest(n)}}]),e}();t.MlAlgorithmVariableService=u=c([(0,i.injectable)()],u),t.MlAlgorithmVariableService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MlFunctionService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=l(n(46)),i=l(n(299)),s=n(38);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"ml_functions"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"listMlFunctions",value:function(e,t){var n=Object.assign({organisation_id:e},t);return o.default.getRequest("ml_functions",n)}},{key:"getMlFunctions",value:function(e){var t="ml_functions/"+e;return o.default.getRequest(t,{})}},{key:"createMlFunctions",value:function(e){return o.default.postRequest("ml_functions",e)}},{key:"getLocalizedPluginLayout",value:function(e){var t=this;return this.getInstanceById(e).then((function(e){var n=e.data;return t._pluginService.findPluginFromVersionId(n.version_id).then((function(e){var a=e.data;return t._pluginService.getLocalizedPluginLayout(a.id,n.version_id)}))}))}}]),t}(i.default);t.MlFunctionService=u=c([(0,s.injectable)()],u),t.MlFunctionService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ApiTokenService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getApiTokens",value:function(e,t){var n="users/"+e+"/api_tokens",a={organisation_id:t};return s.default.getRequest(n,a)}},{key:"getApiToken",value:function(e,t,n){var a="users/"+t+"/api_tokens/"+e+"?organisation_id="+n;return s.default.getRequest(a)}},{key:"createApiToken",value:function(e,t,n){var a="users/"+e+"/api_tokens?organisation_id="+t;return s.default.postRequest(a,n)}},{key:"updateApiToken",value:function(e,t,n,a){var r="users/"+t+"/api_tokens/"+e+"?organisation_id="+n;return s.default.putRequest(r,a)}},{key:"deleteApiToken",value:function(e,t,n){var a="users/"+t+"/api_tokens/"+e+"?organisation_id="+n;return s.default.deleteRequest(a)}}]),e}();t.ApiTokenService=u=c([(0,l.injectable)()],u),t.ApiTokenService=u,t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getChannels",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="datamarts/"+t+"/channels",r=Object.assign({organisation_id:e},n);return s.default.getRequest(a,r)}},{key:"getChannelsByOrganisation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="channels",a=Object.assign({organisation_id:e},t);return s.default.getRequest(n,a)}},{key:"getChannel",value:function(e,t){var n="datamarts/"+e+"/channels/"+t;return s.default.getRequest(n)}},{key:"updateSite",value:function(e,t,n){var a="datamarts/"+e+"/sites/"+t;return s.default.putRequest(a,n)}},{key:"deleteSite",value:function(e,t){var n="datamarts/"+e+"/sites/"+t;return s.default.deleteRequest(n)}},{key:"updateMobileApplication",value:function(e,t,n){var a="datamarts/"+e+"/mobile_applications/"+t;return s.default.putRequest(a,n)}},{key:"deleteMobileApplication",value:function(e,t){var n="datamarts/"+e+"/mobile_applications/"+t;return s.default.deleteRequest(n)}},{key:"createChannel",value:function(e,t,n){var a="datamarts/"+t+"/channels",r={organisation_id:e},o=Object.assign(Object.assign({},n),{organisation_id:e});return s.default.postRequest(a,o,r)}},{key:"getEventRules",value:function(e,t,n){var a="datamarts/"+e+"/channels/"+t+"/event_rules";return s.default.getRequest(a,{organisation_id:n})}},{key:"createEventRules",value:function(e,t,n){var a="datamarts/"+e+"/channels/"+t+"/event_rules";return s.default.postRequest(a,n)}},{key:"updateEventRules",value:function(e,t,n,a,r){var o="datamarts/"+e+"/channels/"+t+"/event_rules/"+a;return s.default.putRequest(o,r)}},{key:"deleteEventRules",value:function(e,t,n,a){var r="datamarts/"+e+"/channels/"+t+"/event_rules/"+a;return s.default.deleteRequest(r)}},{key:"getAliases",value:function(e,t,n){var a="datamarts/"+e+"/sites/"+t+"/aliases";return s.default.getRequest(a,{organisation_id:n})}},{key:"createAliases",value:function(e,t,n){var a="datamarts/"+e+"/sites/"+t+"/aliases";return s.default.postRequest(a,n)}},{key:"updateAliases",value:function(e,t,n,a,r){return Promise.resolve()}},{key:"deleteAliases",value:function(e,t,n,a){var r="datamarts/"+e+"/sites/"+t+"/aliases/"+a;return s.default.deleteRequest(r)}},{key:"getProcessingSelectionsByChannel",value:function(e){var t="channels/"+e+"/processing_selections";return s.default.getRequest(t)}},{key:"createProcessingSelectionForChannel",value:function(e,t){var n="channels/"+e+"/processing_selections";return s.default.postRequest(n,t)}},{key:"getChannelProcessingSelection",value:function(e,t){var n="channels/"+e+"/processing_selections/"+t;return s.default.getRequest(n)}},{key:"deleteChannelProcessingSelection",value:function(e,t){var n="channels/"+e+"/processing_selections/"+t;return s.default.deleteRequest(n)}}]),e}();t.ChannelService=u=c([(0,l.injectable)()],u),t.ChannelService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SettingsService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"putProfile",value:function(e,t){var n="users/"+t.id+"?organisation_id="+e,a=Object.assign({},t);return s.default.putRequest(n,a)}}]),e}();t.SettingsService=u=c([(0,l.injectable)()],u),t.SettingsService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DashboardService=t.SCENARIOS_SEARCH_SETTINGS=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1240)),i=d(n(59)),s=n(38),l=n(30),c=n(12),u=d(n(47));function d(e){return e&&e.__esModule?e:{default:e}}function f(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var p=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},m=(t.SCENARIOS_SEARCH_SETTINGS=[].concat(f(l.PAGINATION_SEARCH_SETTINGS),f(l.FILTERS_SEARCH_SETTINGS),f(l.KEYWORD_SEARCH_SETTINGS)),function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)},a.readAsText(e)}))}),g=o.array().of(o.object().shape({id:o.string().required(),type:o.string().required(),datamart_id:o.string().required(),name:o.string().required(),components:o.array(o.object().shape({layout:o.object().shape({i:o.string(),x:o.number().required(),y:o.number().required(),w:o.number().required(),h:o.number().required()}),component:o.object().required().shape({id:o.string().required(),component_type:o.string().required().oneOf(["MAP_BAR_CHART","MAP_PIE_CHART","DATE_AGGREGATION_CHART","COUNT","PERCENTAGE","GAUGE_PIE_CHART","MAP_STACKED_BAR_CHART","WORLD_MAP_CHART","COUNT_BAR_CHART","COUNT_PIE_CHART","TOP_INFO_COMPONENT","MAP_RADAR_CHART"]),title:o.string().required(),description:o.string()})}))})),y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"getDashboards",value:function(e,t,n){var a=this,r=h.filter((function(e){return e.datamart_id===t&&e.type===n}));return new Promise((function(o,s){return a._datafileService.getDatafileData("mics://data_file/tenants/"+e+"/dashboards/"+t+"/"+n+".json").then((function(e){return m(e)})).then((function(e){return JSON.parse(e)})).then((function(e){return g.validate(e).then((function(e){if("ValidationError"===e.name)throw new Error(e.message);return e}))})).then((function(e){return o({status:"ok",data:e,count:r.filter((function(e){return e.datamart_id===t})).length})})).catch((function(e){return i.default.debug(e),o({status:"ok",data:r,count:r.filter((function(e){return e.datamart_id===t})).length})}))}))}},{key:"getSegmentDashboards",value:function(e,t,n){var a=this,r=h.filter((function(e){return e.datamart_id===t&&"SEGMENT"===e.type}));return new Promise((function(o,s){return a._datafileService.getDatafileData("mics://data_file/tenants/"+e+"/dashboards/"+t+"/SEGMENT-"+n+".json").then((function(e){return e}),(function(){return a._datafileService.getDatafileData("mics://data_file/tenants/"+e+"/dashboards/"+t+"/SEGMENT.json")})).then((function(e){return m(e)})).then((function(e){return JSON.parse(e)})).then((function(e){return g.validate(e).then((function(e){if("ValidationError"===e.name)throw new Error(e.message);return e}))})).then((function(e){return o({status:"ok",data:e,count:r.filter((function(e){return e.datamart_id===t})).length})})).catch((function(e){return i.default.debug(e),o({status:"ok",data:r,count:r.filter((function(e){return e.datamart_id===t})).length})}))}))}},{key:"getAudienceBuilderDashboards",value:function(e,t,n){var a=this,r=h.filter((function(e){return e.datamart_id===t&&"AUDIENCE_BUILDER"===e.type}));return new Promise((function(o,s){return a._datafileService.getDatafileData("mics://data_file/tenants/"+e+"/dashboards/"+t+"/AUDIENCE_BUILDER-"+n+".json").then((function(e){return e}),(function(){return a._datafileService.getDatafileData("mics://data_file/tenants/"+e+"/dashboards/"+t+"/AUDIENCE_BUILDER.json")})).then((function(e){return m(e)})).then((function(e){return JSON.parse(e)})).then((function(e){return g.validate(e).then((function(e){if("ValidationError"===e.name)throw new Error(e.message);return e}))})).then((function(e){return o({status:"ok",data:e,count:r.filter((function(e){return e.datamart_id===t})).length})})).catch((function(e){return i.default.debug(e),o({status:"ok",data:r,count:r.filter((function(e){return e.datamart_id===t})).length})}))}))}},{key:"getDashboard",value:function(e){var t=h.find((function(t){return t.id===e}));return t?Promise.resolve({status:"ok",data:t}):Promise.reject({status:"error",message:"NOT_FOUND"})}}]),e}();p([(0,s.inject)(c.TYPES.IDataFileService)],y.prototype,"_datafileService",void 0),t.DashboardService=y=p([(0,s.injectable)()],y),t.DashboardService=y;var h=[{datamart_id:"1265",id:"1",name:"Home",type:"HOME",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:0,y:0},component:{id:1,component_type:"PERCENTAGE",query_id:"25344",total_query_id:"25345",title:"Pourcentage de visites reconnues (30j)"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:3,y:0},component:{id:2,component_type:"COUNT",query_id:"25365",title:"Nombre de tickets global"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:6,y:0},component:{id:3,component_type:"COUNT",query_id:"25346",title:"Nombre de contacts CRM"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:9,y:0},component:{id:4,component_type:"COUNT",query_id:"25347",title:"Nombre de UserPoints web"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:5,component_type:"MAP_PIE_CHART",query_id:"25348",title:"Répartition des visites par type de profil matching (30j)",show_legend:!0}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:5,component_type:"COUNT_PIE_CHART",query_ids:["25349","25350","25351"],labels_enabled:!0,plot_labels:["2nd","1st_email_click","1st logged"],title:"Nombre de user par type de profil matching (30j)",show_legend:!1}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",query_ids:["25352","25353","25354","25355","25356"],labels_enabled:!0,plot_labels:["Page View","Basket View","Purchase","Search","Email Click"],title:"Nombre d'évènements web par typologie (30j)",show_legend:!1}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",query_ids:["25357","25358"],labels_enabled:!0,plot_labels:["Contact CRM avec activités","Contact CRM sans activités"],title:"Activité web des contacts CRM ",show_legend:!1}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:7},component:{id:5,component_type:"DATE_AGGREGATION_CHART",query_ids:["25398","25399","25400","25401"],plot_labels:["email clicks","basket view","purchase","search"],title:"Nombre d'évènements web par jour par typologie (30j)",labels_enabled:!0,format:"YYYY/MM/DD"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:10},component:{id:5,component_type:"DATE_AGGREGATION_CHART",query_ids:["25359","25360"],plot_labels:["1st","2nd"],title:"Nombre de visites par jour par type de profil matching (30j)",labels_enabled:!0,format:"YYYY/MM/DD"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:13},component:{id:5,component_type:"DATE_AGGREGATION_CHART",query_ids:["25362"],plot_labels:["tickets"],title:"Nombre de tickets réalisés par les contacts CRM",labels_enabled:!0,format:"YYYY/MM/DD"}}]},{datamart_id:"1365",id:"2",name:"Home",type:"HOME",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:0,y:0},component:{id:1,component_type:"PERCENTAGE",query_id:"27824",total_query_id:"27825",title:"Pourcentage de visites reconnues (30j)"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:3,y:0},component:{id:2,component_type:"COUNT",query_id:"27826",title:"Nombre de tickets global"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:6,y:0},component:{id:3,component_type:"COUNT",query_id:"27827",title:"Nombre de contacts CRM"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:9,y:0},component:{id:4,component_type:"COUNT",query_id:"27828",title:"Nombre de UserPoints web"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:5,component_type:"MAP_PIE_CHART",query_id:"27832",title:"Répartition des visites par type de profil matching (30j)",show_legend:!0}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:5,component_type:"COUNT_PIE_CHART",query_ids:["27833","27834","27835"],labels_enabled:!0,plot_labels:["2nd","1st_email_click","1st logged"],title:"Nombre de user par type de profil matching (30j)",show_legend:!1}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",query_ids:["27836","27837","27838","27839","27840"],labels_enabled:!0,plot_labels:["Page View","Basket View","Purchase","Search","Email Click"],title:"Nombre d'évènements web par typologie (30j)",show_legend:!1}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",query_ids:["27841","27842"],labels_enabled:!0,plot_labels:["Contact CRM avec activités","Contact CRM sans activités"],title:"Activité web des contacts CRM ",show_legend:!1}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:7},component:{id:5,component_type:"DATE_AGGREGATION_CHART",query_ids:["27844","27845","27846","27847"],plot_labels:["email clicks","basket view","purchase","search"],title:"Nombre d'évènements web par jour par typologie (30j)",labels_enabled:!0,format:"YYYY/MM/DD"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:10},component:{id:5,component_type:"DATE_AGGREGATION_CHART",query_ids:["27848","27849"],plot_labels:["1st","2nd"],title:"Nombre de visites par jour par type de profil matching (30j)",labels_enabled:!0,format:"YYYY/MM/DD"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:13},component:{id:5,component_type:"DATE_AGGREGATION_CHART",query_ids:["27850"],plot_labels:["tickets"],title:"Nombre de tickets réalisés par les contacts CRM",labels_enabled:!0,format:"YYYY/MM/DD"}}]},{datamart_id:"1298",id:"3",name:"Home",type:"HOME",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:0,y:0},component:{id:1,component_type:"PERCENTAGE",query_id:"27868",total_query_id:"27870",title:"Pourcentage de visites reconnues (30j)"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:3,y:0},component:{id:2,component_type:"COUNT",query_id:"27873",title:"Nombre de tickets global"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:6,y:0},component:{id:3,component_type:"COUNT",query_id:"27871",title:"Nombre de contacts CRM"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:9,y:0},component:{id:4,component_type:"COUNT",query_id:"27872",title:"Nombre de UserPoints web"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:5,component_type:"MAP_PIE_CHART",query_id:"27874",title:"Répartition des visites par type de profil matching (30j)",show_legend:!0}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:5,component_type:"COUNT_PIE_CHART",query_ids:["27875","27876","27877"],labels_enabled:!0,plot_labels:["2nd","1st_email_click","1st logged"],title:"Nombre de users par type de profil matching (30j)",show_legend:!1}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",query_ids:["27878","27879","27880","27881","27882"],labels_enabled:!0,plot_labels:["Page View","Basket View","Purchase","Search","Email Click"],title:"Nombre d'évènements web par typologie (30j)",show_legend:!1}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",query_ids:["27883","27884"],labels_enabled:!0,plot_labels:["Contact CRM avec activités","Contact CRM sans activités"],title:"Activité web des contacts CRM ",show_legend:!1}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:7},component:{id:5,component_type:"DATE_AGGREGATION_CHART",query_ids:["27890","27891","27892","27894"],plot_labels:["email clicks","basket view","purchase","search"],title:"Nombre d'évènements web par jour par typologie (30j)",labels_enabled:!0,format:"YYYY/MM/DD"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:10},component:{id:5,component_type:"DATE_AGGREGATION_CHART",query_ids:["27885","27886"],plot_labels:["1st","2nd"],title:"Nombre de visites par jour par type de profil matching (30j)",labels_enabled:!0,format:"YYYY/MM/DD"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:13},component:{id:5,component_type:"DATE_AGGREGATION_CHART",query_ids:["27895"],plot_labels:["tickets"],title:"Nombre de tickets réalisés par les contacts CRM",labels_enabled:!0,format:"YYYY/MM/DD"}}]},{id:"4",name:"Home",type:"HOME",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:0,y:0},component:{id:1,component_type:"PERCENTAGE",title:"Pourcentage de visites reconnues (30j)",query_id:"29525",total_query_id:"29521"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:3,y:0},component:{id:2,component_type:"COUNT",title:"Nombre de tickets global",query_id:"29523"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:6,y:0},component:{id:3,component_type:"COUNT",title:"Nombre de contacts CRM",query_id:"29526"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:9,y:0},component:{id:4,component_type:"COUNT",title:"Nombre de UserPoints web",query_id:"29522"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:5,component_type:"MAP_PIE_CHART",title:"Répartition des visites par type de profil matching (30j)",show_legend:!0,query_id:"29524"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["2nd","1st_email_click","1st logged"],title:"Nombre de users par type de profil matching (30j)",show_legend:!1,query_ids:["29529","29532","29531"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Page View","Basket View","Purchase","Search","Email Click"],title:"Nombre d'évènements web par typologie (30j)",show_legend:!1,query_ids:["29527","29528","29530","29533","29534"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Contact CRM avec activités","Contact CRM sans activités"],title:"Activité web des contacts CRM ",show_legend:!1,query_ids:["29535","29537"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:7},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["email clicks","basket view","purchase","search"],title:"Nombre d'évènements web par jour par typologie (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29536","29538","29539","29542"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:10},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["1st","2nd"],title:"Nombre de visites par jour par type de profil matching (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29572","29574"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:13},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["tickets"],title:"Nombre de tickets réalisés par les contacts CRM",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29541"]}}],datamart_id:"1287"},{id:"5",name:"Home",type:"HOME",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:0,y:0},component:{id:1,component_type:"PERCENTAGE",title:"Pourcentage de visites reconnues (30j)",query_id:"29690",total_query_id:"29688"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:3,y:0},component:{id:2,component_type:"COUNT",title:"Nombre de tickets global",query_id:"29696"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:6,y:0},component:{id:3,component_type:"COUNT",title:"Nombre de contacts CRM",query_id:"29691"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:9,y:0},component:{id:4,component_type:"COUNT",title:"Nombre de UserPoints web",query_id:"29692"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:5,component_type:"MAP_PIE_CHART",title:"Répartition des visites par type de profil matching (30j)",show_legend:!0,query_id:"29689"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["2nd","1st_email_click","1st logged"],title:"Nombre de user par type de profil matching (30j)",show_legend:!1,query_ids:["29695","29700","29694"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Page View","Basket View","Purchase","Search","Email Click"],title:"Nombre d'évènements web par typologie (30j)",show_legend:!1,query_ids:["29697","29693","29702","29699","29698"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Contact CRM avec activités","Contact CRM sans activités"],title:"Activité web des contacts CRM ",show_legend:!1,query_ids:["29701","29703"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:7},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["email clicks","basket view","purchase","search"],title:"Nombre d'évènements web par jour par typologie (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29706","29705","29704","29707"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:10},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["1st","2nd"],title:"Nombre de visites par jour par type de profil matching (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29709","29708"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:13},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["tickets"],title:"Nombre de tickets réalisés par les contacts CRM",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29710"]}}],datamart_id:"1277"},{id:"6",name:"Home",type:"HOME",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:0,y:0},component:{id:1,component_type:"PERCENTAGE",title:"Pourcentage de visites reconnues (30j)",query_id:"29714",total_query_id:"29712"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:3,y:0},component:{id:2,component_type:"COUNT",title:"Nombre de tickets global",query_id:"29713"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:6,y:0},component:{id:3,component_type:"COUNT",title:"Nombre de contacts CRM",query_id:"29715"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:9,y:0},component:{id:4,component_type:"COUNT",title:"Nombre de UserPoints web",query_id:"29716"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:5,component_type:"MAP_PIE_CHART",title:"Répartition des visites par type de profil matching (30j)",show_legend:!0,query_id:"29711"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["2nd","1st_email_click","1st logged"],title:"Nombre de user par type de profil matching (30j)",show_legend:!1,query_ids:["29720","29717","29718"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Page View","Basket View","Purchase","Search","Email Click"],title:"Nombre d'évènements web par typologie (30j)",show_legend:!1,query_ids:["29722","29721","29719","29726","29723"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Contact CRM avec activités","Contact CRM sans activités"],title:"Activité web des contacts CRM ",show_legend:!1,query_ids:["29724","29728"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:7},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["email clicks","basket view","purchase","search"],title:"Nombre d'évènements web par jour par typologie (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29725","29727","29729","29731"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:10},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["1st","2nd"],title:"Nombre de visites par jour par type de profil matching (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29732","29730"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:13},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["tickets"],title:"Nombre de tickets réalisés par les contacts CRM",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29733"]}}],datamart_id:"1271"},{id:"7",name:"Home",type:"HOME",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:0,y:0},component:{id:1,component_type:"PERCENTAGE",title:"Pourcentage de visites reconnues (30j)",query_id:"29854",total_query_id:"29852"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:3,y:0},component:{id:2,component_type:"COUNT",title:"Nombre de tickets global",query_id:"29853"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:6,y:0},component:{id:3,component_type:"COUNT",title:"Nombre de contacts CRM",query_id:"29855"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:9,y:0},component:{id:4,component_type:"COUNT",title:"Nombre de UserPoints web",query_id:"29856"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:5,component_type:"MAP_PIE_CHART",title:"Répartition des visites par type de profil matching (30j)",show_legend:!0,query_id:"29857"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["2nd","1st_email_click","1st logged"],title:"Nombre de user par type de profil matching (30j)",show_legend:!1,query_ids:["29861","29858","29862"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Page View","Basket View","Purchase","Search","Email Click"],title:"Nombre d'évènements web par typologie (30j)",show_legend:!1,query_ids:["29859","29863","29860","29865","29866"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Contact CRM avec activités","Contact CRM sans activités"],title:"Activité web des contacts CRM ",show_legend:!1,query_ids:["29864","29868"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:7},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["email clicks","basket view","purchase","search"],title:"Nombre d'évènements web par jour par typologie (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29867","29869","29870","29872"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:10},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["1st","2nd"],title:"Nombre de visites par jour par type de profil matching (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29871","29873"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:13},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["tickets"],title:"Nombre de tickets réalisés par les contacts CRM",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29874"]}}],datamart_id:"1296"},{id:"8",name:"Home",type:"HOME",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:0,y:0},component:{id:1,component_type:"PERCENTAGE",title:"Pourcentage de visites reconnues (30j)",query_id:"29759",total_query_id:"29763"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:3,y:0},component:{id:2,component_type:"COUNT",title:"Nombre de tickets global",query_id:"29758"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:6,y:0},component:{id:3,component_type:"COUNT",title:"Nombre de contacts CRM",query_id:"29761"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:9,y:0},component:{id:4,component_type:"COUNT",title:"Nombre de UserPoints web",query_id:"29760"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:5,component_type:"MAP_PIE_CHART",title:"Répartition des visites par type de profil matching (30j)",show_legend:!0,query_id:"29762"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["2nd","1st_email_click","1st logged"],title:"Nombre de user par type de profil matching (30j)",show_legend:!1,query_ids:["29764","29766","29767"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Page View","Basket View","Purchase","Search","Email Click"],title:"Nombre d'évènements web par typologie (30j)",show_legend:!1,query_ids:["29765","29770","29769","29768","29771"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Contact CRM avec activités","Contact CRM sans activités"],title:"Activité web des contacts CRM ",show_legend:!1,query_ids:["29772","29773"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:7},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["email clicks","basket view","purchase","search"],title:"Nombre d'évènements web par jour par typologie (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29778","29774","29775","29776"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:10},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["1st","2nd"],title:"Nombre de visites par jour par type de profil matching (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29779","29777"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:13},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["tickets"],title:"Nombre de tickets réalisés par les contacts CRM",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29780"]}}],datamart_id:"1291"},{id:"9",name:"Home",type:"HOME",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:0,y:0},component:{id:1,component_type:"PERCENTAGE",title:"Pourcentage de visites reconnues (30j)",query_id:"29782",total_query_id:"29785"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:3,y:0},component:{id:2,component_type:"COUNT",title:"Nombre de tickets global",query_id:"29784"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:6,y:0},component:{id:3,component_type:"COUNT",title:"Nombre de contacts CRM",query_id:"29783"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:9,y:0},component:{id:4,component_type:"COUNT",title:"Nombre de UserPoints web",query_id:"29787"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:5,component_type:"MAP_PIE_CHART",title:"Répartition des visites par type de profil matching (30j)",show_legend:!0,query_id:"29786"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["2nd","1st_email_click","1st logged"],title:"Nombre de user par type de profil matching (30j)",show_legend:!1,query_ids:["29788","29792","29790"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Page View","Basket View","Purchase","Search","Email Click"],title:"Nombre d'évènements web par typologie (30j)",show_legend:!1,query_ids:["29789","29791","29793","29796","29797"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Contact CRM avec activités","Contact CRM sans activités"],title:"Activité web des contacts CRM ",show_legend:!1,query_ids:["29795","29794"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:7},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["email clicks","basket view","purchase","search"],title:"Nombre d'évènements web par jour par typologie (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29799","29798","29800","29804"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:10},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["1st","2nd"],title:"Nombre de visites par jour par type de profil matching (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29801","29803"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:13},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["tickets"],title:"Nombre de tickets réalisés par les contacts CRM",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29802"]}}],datamart_id:"1300"},{id:"10",name:"Home",type:"HOME",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:0,y:0},component:{id:1,component_type:"PERCENTAGE",title:"Pourcentage de visites reconnues (30j)",query_id:"29807",total_query_id:"29805"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:3,y:0},component:{id:2,component_type:"COUNT",title:"Nombre de tickets global",query_id:"29809"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:6,y:0},component:{id:3,component_type:"COUNT",title:"Nombre de contacts CRM",query_id:"29810"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:9,y:0},component:{id:4,component_type:"COUNT",title:"Nombre de UserPoints web",query_id:"29808"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:5,component_type:"MAP_PIE_CHART",title:"Répartition des visites par type de profil matching (30j)",show_legend:!0,query_id:"29806"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["2nd","1st_email_click","1st logged"],title:"Nombre de user par type de profil matching (30j)",show_legend:!1,query_ids:["29813","29816","29814"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Page View","Basket View","Purchase","Search","Email Click"],title:"Nombre d'évènements web par typologie (30j)",show_legend:!1,query_ids:["29811","29812","29815","29818","29821"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Contact CRM avec activités","Contact CRM sans activités"],title:"Activité web des contacts CRM ",show_legend:!1,query_ids:["29817","29820"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:7},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["email clicks","basket view","purchase","search"],title:"Nombre d'évènements web par jour par typologie (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29819","29822","29823","29825"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:10},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["1st","2nd"],title:"Nombre de visites par jour par type de profil matching (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29824","29826"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:13},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["tickets"],title:"Nombre de tickets réalisés par les contacts CRM",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["29827"]}}],datamart_id:"1299"},{id:"11",name:"Home",type:"HOME",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:0,y:0},component:{id:1,component_type:"PERCENTAGE",title:"Pourcentage de visites reconnues (30j)",query_id:"32028",total_query_id:"32025"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:3,y:0},component:{id:2,component_type:"COUNT",title:"Nombre de tickets global",query_id:"32029"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:6,y:0},component:{id:3,component_type:"COUNT",title:"Nombre de contacts CRM",query_id:"32024"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:9,y:0},component:{id:4,component_type:"COUNT",title:"Nombre de UserPoints web",query_id:"32027"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:5,component_type:"MAP_PIE_CHART",title:"Répartition des visites par type de profil matching (30j)",show_legend:!0,query_id:"32026"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["2nd","1st_email_click","1st logged"],title:"Nombre de user par type de profil matching (30j)",show_legend:!1,query_ids:["32031","32030","32032"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Page View","Basket View","Purchase","Search","Email Click"],title:"Nombre d'évènements web par typologie (30j)",show_legend:!1,query_ids:["32033","32036","32035","32037","32034"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Contact CRM avec activités","Contact CRM sans activités"],title:"Activité web des contacts CRM ",show_legend:!1,query_ids:["32038","32039"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:7},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["email clicks","basket view","purchase","search"],title:"Nombre d'évènements web par jour par typologie (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["32043","32042","32040","32041"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:10},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["1st","2nd"],title:"Nombre de visites par jour par type de profil matching (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["32044","32045"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:13},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["tickets"],title:"Nombre de tickets réalisés par les contacts CRM",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["32046"]}}],datamart_id:"1382"},{id:"12",name:"Home",type:"HOME",datamart_id:"1409",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:0,y:0},component:{id:1,component_type:"COUNT",title:"# of UserPoints",query_id:"30905"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:3,y:0},component:{id:1,component_type:"COUNT",title:"# of Page Views (30d)",query_id:"32072"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:6,y:0},component:{id:1,component_type:"COUNT",title:"# of Sessions (30d)",query_id:"32073"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:9,y:0},component:{id:1,component_type:"COUNT",title:"# of Logged In Users (30d)",query_id:"30915"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:1,component_type:"DATE_AGGREGATION_CHART",title:"Active UserPoint Per Day (30d)",plot_labels:["Non Identified UserPoints","Identified UserPoints"],query_ids:["30926","30927"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:1,component_type:"MAP_PIE_CHART",title:"Declarative Gender Repartition",query_id:"30930",show_legend:!0}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:0,y:4},component:{id:1,component_type:"MAP_PIE_CHART",title:"Interests",query_id:"30932",show_legend:!0}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:4,y:4},component:{id:1,component_type:"COUNT_BAR_CHART",title:"Age Repartition",query_ids:["30942","30941","30940","30939","30938"],labels_enabled:!0,show_legend:!1,plot_labels:["18-25","25-35","35-45","45-55","55+"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:8,y:4},component:{id:1,component_type:"MAP_PIE_CHART",title:"Sections Viewed",query_id:"30943",show_legend:!0}}]},{id:"13",name:"Insights",type:"SEGMENT",datamart_id:"1409",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:4,x:0,y:0},component:{id:1,component_type:"COUNT",title:"# of UserPoints",query_id:"30905"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:4,x:4,y:0},component:{id:1,component_type:"COUNT",title:"# of Active UserPoint (30d)",query_id:"30906"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:4,x:8,y:0},component:{id:1,component_type:"COUNT",title:"# of Logged In Users (30d)",query_id:"30915"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:1,component_type:"DATE_AGGREGATION_CHART",title:"Active UserPoint Per Day (30d)",plot_labels:["Non Identified UserPoints","Identified UserPoints"],query_ids:["30926","30927"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:1,component_type:"MAP_PIE_CHART",title:"Declarative Gender Repartition",query_id:"30930",show_legend:!0}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:0,y:4},component:{id:1,component_type:"MAP_PIE_CHART",title:"Interests",query_id:"30932",show_legend:!0}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:4,y:4},component:{id:1,component_type:"COUNT_BAR_CHART",title:"Age Repartition",query_ids:["30942","30941","30940","30939","30938"],labels_enabled:!0,show_legend:!1,plot_labels:["18-25","25-35","35-45","45-55","55+"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:8,y:4},component:{id:1,component_type:"MAP_PIE_CHART",title:"Sections Viewed",query_id:"30943",show_legend:!0}}]},{id:"14",name:"Home",type:"HOME",datamart_id:"1436",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:0,y:0},component:{id:1,component_type:"COUNT",title:"# of UserPoints",query_id:"32693"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:3,y:0},component:{id:1,component_type:"COUNT",title:"# of Transactions (30d)",query_id:"32694"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:6,y:0},component:{id:1,component_type:"COUNT",title:"# of Basket View (30d)",query_id:"32695"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:9,y:0},component:{id:1,component_type:"COUNT",title:"# of Logged In Users (30d)",query_id:"32696"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:1,component_type:"DATE_AGGREGATION_CHART",title:"Active UserPoint Per Day (30d)",plot_labels:["UserPoints"],query_ids:["32697"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:1,component_type:"MAP_PIE_CHART",title:"Declarative Gender Repartition",query_id:"32698",show_legend:!0}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:0,y:4},component:{id:1,component_type:"MAP_PIE_CHART",title:"Interests",query_id:"32699",show_legend:!0}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:4,y:4},component:{id:1,component_type:"COUNT_BAR_CHART",title:"Age Repartition",query_ids:["32704","32705","32706","32707","32708"],labels_enabled:!0,show_legend:!1,plot_labels:["18-25","25-35","35-45","45-55","55+"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:8,y:4},component:{id:1,component_type:"MAP_PIE_CHART",title:"Product Viewed",query_id:"32709",show_legend:!0}}]},{id:"15",name:"Insights",type:"SEGMENT",datamart_id:"1436",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:4,x:0,y:0},component:{id:1,component_type:"COUNT",title:"# of UserPoints",query_id:"32693"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:4,x:4,y:0},component:{id:1,component_type:"COUNT",title:"# of UserPoint With Purchase (30d)",query_id:"32711"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:4,x:8,y:0},component:{id:1,component_type:"COUNT",title:"# of Logged In Users (30d)",query_id:"32696"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:1,component_type:"DATE_AGGREGATION_CHART",title:"Active UserPoint Per Day (30d)",plot_labels:["UserPoint"],query_ids:["32697"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:1,component_type:"MAP_PIE_CHART",title:"Declarative Gender Repartition",query_id:"32698",show_legend:!0}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:0,y:4},component:{id:1,component_type:"MAP_PIE_CHART",title:"Interests",query_id:"32699",show_legend:!0}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:4,y:4},component:{id:1,component_type:"COUNT_BAR_CHART",title:"Age Repartition",query_ids:["32704","32705","32706","32707","32708"],labels_enabled:!0,show_legend:!1,plot_labels:["18-25","25-35","35-45","45-55","55+"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:8,y:4},component:{id:1,component_type:"MAP_PIE_CHART",title:"Product Viewed",query_id:"32709",show_legend:!0}}]},{id:"16",name:"Home",type:"HOME",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:0,y:0},component:{id:1,component_type:"PERCENTAGE",title:"Pourcentage de visites reconnues (30j)",query_id:"33033",total_query_id:"33037"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:3,y:0},component:{id:2,component_type:"COUNT",title:"Nombre de tickets global",query_id:"33032"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:6,y:0},component:{id:3,component_type:"COUNT",title:"Nombre de contacts CRM",query_id:"33034"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:9,y:0},component:{id:4,component_type:"COUNT",title:"Nombre de UserPoints web",query_id:"33036"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:5,component_type:"MAP_PIE_CHART",title:"Répartion des visites par type de profil matching (30j)",show_legend:!0,query_id:"33035"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["2nd","1st_email_click","1st logged"],title:"Nombre de user par type de profil matching (30j)",show_legend:!1,query_ids:["33039","33041","33040"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Page View","Basket View","Purchase","Search","Email Click"],title:"Nombre d'évènements web par typologie (30j)",show_legend:!1,query_ids:["33042","33038","33043","33045","33047"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Contact CRM avec activités","Contact CRM sans activités"],title:"Activité web des contacts CRM ",show_legend:!1,query_ids:["33044","33046"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:7},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["email clicks","basket view","purchase","search"],title:"Nombre d'évènements web par jour par typologie (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["33048","33049","33050","33052"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:10},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["1st","2nd"],title:"Nombre de visites par jour par type de profil matching (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["33053","33051"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:13},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["tickets"],title:"Nombre de tickets réalisés par les contacts CRM",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["33054"]}}],datamart_id:"1433"},{id:"17",name:"Home",type:"HOME",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:0,y:0},component:{id:1,component_type:"PERCENTAGE",title:"Pourcentage de visites reconnues (30j)",query_id:"36419",total_query_id:"36415"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:3,y:0},component:{id:2,component_type:"COUNT",title:"Nombre de tickets global",query_id:"36416"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:6,y:0},component:{id:3,component_type:"COUNT",title:"Nombre de contacts CRM",query_id:"36414"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:9,y:0},component:{id:4,component_type:"COUNT",title:"Nombre de UserPoints web",query_id:"36413"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:5,component_type:"MAP_PIE_CHART",title:"Répartition des visites par type de profil matching (30j)",show_legend:!0,query_id:"36417"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["2nd","1st_email_click","1st logged"],title:"Nombre de users par type de profil matching (30j)",show_legend:!1,query_ids:["36420","36418","36423"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Page View","Basket View","Purchase","Search","Email Click"],title:"Nombre d'évènements web par typologie (30j)",show_legend:!1,query_ids:["36421","36422","36424","36429","36425"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Contact CRM avec activités","Contact CRM sans activités"],title:"Activité web des contacts CRM ",show_legend:!1,query_ids:["36426","36427"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:7},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["email clicks","basket view","purchase","search"],title:"Nombre d'évènements web par jour par typologie (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["36428","36430","36433","36431"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:10},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["1st","2nd"],title:"Nombre de visites par jour par type de profil matching (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["36432","36434"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:13},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["tickets"],title:"Nombre de tickets réalisés par les contacts CRM",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["36435"]}}],datamart_id:"1458"},{id:"18",name:"Home",type:"HOME",components:[{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:0,y:0},component:{id:1,component_type:"PERCENTAGE",title:"Pourcentage de visites reconnues (30j)",query_id:"37756",total_query_id:"37760"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:3,y:0},component:{id:2,component_type:"COUNT",title:"Nombre de tickets global",query_id:"37758"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:6,y:0},component:{id:3,component_type:"COUNT",title:"Nombre de contacts CRM",query_id:"37759"}},{layout:{i:(0,u.default)(),h:1,static:!1,w:3,x:9,y:0},component:{id:4,component_type:"COUNT",title:"Nombre de UserPoints web",query_id:"37757"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:1},component:{id:5,component_type:"MAP_PIE_CHART",title:"Répartition des visites par type de profil matching (30j)",show_legend:!0,query_id:"37761"}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:1},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["2nd","1st_email_click","1st logged"],title:"Nombre de users par type de profil matching (30j)",show_legend:!1,query_ids:["37762","37764","37763"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Page View","Basket View","Purchase","Search","Email Click"],title:"Nombre d'évènements web par typologie (30j)",show_legend:!1,query_ids:["37765","37766","37767","37768","37771"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:4},component:{id:5,component_type:"COUNT_PIE_CHART",labels_enabled:!0,plot_labels:["Contact CRM avec activités","Contact CRM sans activités"],title:"Activité web des contacts CRM ",show_legend:!1,query_ids:["37772","37769"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:7},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["email clicks","basket view","purchase","search"],title:"Nombre d'évènements web par jour par typologie (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["37770","37774","37773","37776"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:10},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["1st","2nd"],title:"Nombre de visites par jour par type de profil matching (30j)",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["37775","37778"]}},{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:13},component:{id:5,component_type:"DATE_AGGREGATION_CHART",plot_labels:["tickets"],title:"Nombre de tickets réalisés par les contacts CRM",labels_enabled:!0,format:"YYYY/MM/DD",query_ids:["37777"]}}],datamart_id:"1309"},{id:"19",name:"Demographics",type:"HOME",datamart_id:"1459",components:[{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"Gender",query_id:"38036",percentage:!0,show_legend:!0,sortKey:"A-Z",labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"Age",query_id:"38037",percentage:!0,show_legend:!0,sortKey:"A-Z",labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:0,y:3},component:{id:1,component_type:"MAP_BAR_CHART",title:"Family Status",query_id:"37670",percentage:!0,show_legend:!0,vertical:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:4,y:3},component:{id:1,component_type:"MAP_BAR_CHART",title:"Family Composition",query_id:"37670",percentage:!0,show_legend:!0,vertical:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:8,y:3},component:{id:1,component_type:"MAP_BAR_CHART",title:"Income",query_id:"37670",percentage:!0,show_legend:!0,vertical:!1,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}}]},{id:"20",name:"Psychographics",type:"HOME",datamart_id:"1459",components:[{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:0},component:{id:1,component_type:"MAP_RADAR_CHART",title:"Top 10 Interests",query_id:"37670",percentage:!0,show_legend:!0,tooltip:{formatter:"{point.y}% ({point.count})"}}}]},{id:"21",name:"Behavioral",type:"HOME",datamart_id:"1459",components:[{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"Purchase Intent by Category",query_id:"37673",shouldCompare:!1,percentage:!0,show_legend:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}}]},{id:"22",name:"Media Touch Points",type:"HOME",datamart_id:"1459",components:[{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"App Categories",query_id:"37670",percentage:!0,show_legend:!0,vertical:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"Top 10 Apps",query_id:"37670",percentage:!0,show_legend:!0,vertical:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}}]},{id:"23",name:"Demographics",type:"SEGMENT",datamart_id:"1459",components:[{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"Gender",query_id:"38036",shouldCompare:!0,percentage:!0,show_legend:!0,sortKey:"A-Z",labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"Age",query_id:"38037",shouldCompare:!0,percentage:!0,show_legend:!0,sortKey:"A-Z",labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:0,y:3},component:{id:1,component_type:"MAP_BAR_CHART",title:"Family Status",query_id:"37670",shouldCompare:!0,percentage:!0,show_legend:!0,vertical:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:4,y:3},component:{id:1,component_type:"MAP_BAR_CHART",title:"Family Composition",query_id:"37670",shouldCompare:!0,percentage:!0,show_legend:!0,vertical:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:8,y:3},component:{id:1,component_type:"MAP_BAR_CHART",title:"Income",query_id:"37670",shouldCompare:!0,percentage:!0,show_legend:!0,vertical:!1,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}}]},{id:"24",name:"Psychographics",type:"SEGMENT",datamart_id:"1459",components:[{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:0},component:{id:1,component_type:"MAP_RADAR_CHART",title:"Top 10 Interests",query_id:"37670",shouldCompare:!0,percentage:!0,show_legend:!0,tooltip:{formatter:"{point.y}% ({point.count})"}}}]},{id:"25",name:"Behavioral",type:"SEGMENT",datamart_id:"1459",components:[{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"Purchase Intent by Category",query_id:"37673",shouldCompare:!0,percentage:!0,show_legend:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}}]},{id:"26",name:"Media Touch Points",type:"SEGMENT",datamart_id:"1459",components:[{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"App Categories",query_id:"37670",shouldCompare:!0,percentage:!0,show_legend:!0,vertical:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"Top 10 Apps",query_id:"37670",shouldCompare:!0,percentage:!0,show_legend:!0,vertical:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}}]},{id:"27",name:"Demographics",type:"HOME",datamart_id:"1466",components:[{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"Gender",query_id:"38689",percentage:!0,show_legend:!0,sortKey:"A-Z",labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"Age",query_id:"38690",percentage:!0,show_legend:!0,sortKey:"A-Z",labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:0,y:3},component:{id:1,component_type:"MAP_BAR_CHART",title:"Family Status",query_id:"38691",percentage:!0,show_legend:!0,vertical:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:4,y:3},component:{id:1,component_type:"MAP_BAR_CHART",title:"Family Composition",query_id:"38692",percentage:!0,show_legend:!0,vertical:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:8,y:3},component:{id:1,component_type:"MAP_BAR_CHART",title:"Income",query_id:"38693",percentage:!0,show_legend:!0,vertical:!1,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}}]},{id:"28",name:"Psychographics",type:"HOME",datamart_id:"1466",components:[{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:0},component:{id:1,component_type:"MAP_RADAR_CHART",title:"Top 10 Interests",query_id:"38694",percentage:!0,show_legend:!0,tooltip:{formatter:"{point.y}% ({point.count})"}}}]},{id:"29",name:"Behavioral",type:"HOME",datamart_id:"1466",components:[{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"Purchase Intent by Category",query_id:"38695",shouldCompare:!1,percentage:!0,show_legend:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}}]},{id:"30",name:"Media Touch Points",type:"HOME",datamart_id:"1466",components:[{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"App Categories",query_id:"38696",percentage:!0,show_legend:!0,vertical:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"Top 10 Apps",query_id:"38697",percentage:!0,show_legend:!0,vertical:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}}]},{id:"31",name:"Demographics",type:"SEGMENT",datamart_id:"1500",components:[{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"Gender",query_id:"38689",shouldCompare:!0,percentage:!0,show_legend:!0,sortKey:"A-Z",labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"Age",query_id:"38690",shouldCompare:!0,percentage:!0,show_legend:!0,sortKey:"A-Z",labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:0,y:3},component:{id:1,component_type:"MAP_BAR_CHART",title:"Family Status",query_id:"38691",shouldCompare:!0,percentage:!0,show_legend:!0,vertical:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:4,y:3},component:{id:1,component_type:"MAP_BAR_CHART",title:"Family Composition",query_id:"38692",shouldCompare:!0,percentage:!0,show_legend:!0,vertical:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:4,x:8,y:3},component:{id:1,component_type:"MAP_BAR_CHART",title:"Income",query_id:"38693",shouldCompare:!0,percentage:!0,show_legend:!0,vertical:!1,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}}]},{id:"32",name:"Psychographics",type:"SEGMENT",datamart_id:"1466",components:[{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:0},component:{id:1,component_type:"MAP_RADAR_CHART",title:"Top 10 Interests",query_id:"38694",shouldCompare:!0,percentage:!0,show_legend:!0,tooltip:{formatter:"{point.y}% ({point.count})"}}}]},{id:"33",name:"Behavioral",type:"SEGMENT",datamart_id:"1466",components:[{layout:{i:(0,u.default)(),h:3,static:!1,w:12,x:0,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"Purchase Intent by Category",query_id:"38695",shouldCompare:!0,percentage:!0,show_legend:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}}]},{id:"34",name:"Media Touch Points",type:"SEGMENT",datamart_id:"1466",components:[{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:0,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"App Categories",query_id:"38696",shouldCompare:!0,percentage:!0,show_legend:!0,vertical:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}},{layout:{i:(0,u.default)(),h:3,static:!1,w:6,x:6,y:0},component:{id:1,component_type:"MAP_BAR_CHART",title:"Top 10 Apps",query_id:"38697",shouldCompare:!0,percentage:!0,show_legend:!0,vertical:!0,labels:{enable:!0,filterValue:0,format:"{point.y}%"},tooltip:{formatter:"{point.y}% ({point.count})"}}}]}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LabelService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getLabels",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="labels",a=Object.assign({organisation_id:e},t);return s.default.getRequest(n,a)}},{key:"updateLabel",value:function(e,t,n){var a="labels/"+e,r={id:e,name:t,organisation_id:n};return s.default.putRequest(a,r)}},{key:"createLabel",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="labels",r=Object.assign({name:e,organisation_id:t},n);return s.default.postRequest(a,r)}},{key:"deleteLabel",value:function(e){var t="labels/"+e;return s.default.deleteRequest(t)}},{key:"pairLabels",value:function(e,t,n){var a="labels/"+e+"/links/"+t+"/"+n;return s.default.postRequest(a,{})}},{key:"unPairLabels",value:function(e,t,n){var a="labels/"+e+"/links/"+t+"/"+n;return s.default.deleteRequest(a,{})}}]),e}();t.LabelService=u=c([(0,l.injectable)()],u),t.LabelService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logoCache={},this.doGetLogo=function(e){var n="organisations/"+e+"/logo";return s.default.getRequest(n,void 0,{Accept:"image/png"}).catch((function(){return t.getStandardLogo()})).then((function(n){return t.logoCache[e]=n,n}))},this.getLogoCache=function(e){return t.logoCache[e]},this.getLogo=function(e){var n=t.logoCache[e];return n?Promise.resolve(n):t.doGetLogo(e)}}return r(e,[{key:"getWorkspace",value:function(e){var t="organisations/"+e+"/workspace";return s.default.getRequest(t)}},{key:"getCookies",value:function(){return s.default.getRequest("my_cookies",{},{},{withCredentials:!0})}},{key:"getStandardLogo",value:function(){return s.default.getRequest("react/src/assets/images/logo.png",void 0,{Accept:"image/png"},{localUrl:!0})}},{key:"putLogo",value:function(e,t){var n="organisations/"+e+"/logo";return s.default.putRequest(n,t)}},{key:"getBillingAccounts",value:function(e){var t="billing_accounts?organisation_id="+e;return s.default.getRequest(t)}},{key:"getOrganisation",value:function(e){var t="organisations/"+e;return s.default.getRequest(t)}},{key:"getOrganisations",value:function(e){var t="organisations?community_id="+e;return s.default.getRequest(t)}},{key:"getProcessings",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="processings",a=Object.assign({community_id:e},t);return s.default.getRequest(n,a)}},{key:"getProcessing",value:function(e){var t="processings/"+e;return s.default.getRequest(t)}},{key:"createProcessing",value:function(e,t){var n=Object.assign(Object.assign({},t),{community_id:e});return s.default.postRequest("processings",n)}},{key:"updateProcessing",value:function(e,t){var n="processings/"+e;return s.default.putRequest(n,t)}},{key:"archiveProcessing",value:function(e,t){var n="processings/"+t,a={archived:!0,community_id:e};return s.default.putRequest(n,a)}},{key:"deleteProcessing",value:function(e,t){var n="processings/"+t,a={community_id:e};return s.default.deleteRequest(n,a)}}]),e}();u=c([(0,l.injectable)()],u),t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DatamartService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getDatamarts",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="datamarts",a=Object.assign({organisation_id:e},t);return s.default.getRequest(n,a)}},{key:"getDatamart",value:function(e){var t="datamarts/"+e;return s.default.getRequest(t)}},{key:"updateDatamart",value:function(e,t){var n="datamarts/"+e;return s.default.putRequest(n,t)}},{key:"createDatamart",value:function(e,t){var n="datamarts?organisation_id="+e;return s.default.postRequest(n,t)}},{key:"getEventRules",value:function(e,t){var n="datamarts/"+e+"/event_rules";return s.default.getRequest(n,{organisation_id:t})}},{key:"createEventRules",value:function(e,t){var n="datamarts/"+e+"/event_rules";return s.default.postRequest(n,t)}},{key:"updateEventRules",value:function(e,t,n){var a="datamarts/"+e+"/event_rules/"+t;return s.default.putRequest(a,n)}},{key:"deleteEventRules",value:function(e,t){var n="datamarts/"+e+"/event_rules/"+t;return s.default.deleteRequest(n)}},{key:"getUserAccountCompartmentDatamartSelectionResources",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="datamarts/"+e+"/compartments";return s.default.getRequest(n,t)}},{key:"getUserAccountCompartmentDatamartSelectionResource",value:function(e,t){var n="datamarts/"+e+"/compartments/"+t;return s.default.getRequest(n)}},{key:"createUserAccountCompartmentDatamartSelectionResource",value:function(e,t){var n="datamarts/"+e+"/compartments";return s.default.postRequest(n,t)}},{key:"updateUserAccountCompartmentDatamartSelectionResource",value:function(e,t,n){var a="datamarts/"+e+"/compartments/"+t;return s.default.putRequest(a,n)}},{key:"getUserAccountCompartment",value:function(e){var t="user_account_compartments/"+e;return s.default.getRequest(t)}},{key:"createUserAccountCompartment",value:function(e){return s.default.postRequest("user_account_compartments",e)}},{key:"updateUserAccountCompartment",value:function(e,t){var n="user_account_compartments/"+e;return s.default.putRequest(n,t)}},{key:"getSources",value:function(e){var t="datamarts/"+e+"/sources";return s.default.getRequest(t)}},{key:"getCleaningRules",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="datamarts/"+e+"/cleaning_rules";return s.default.getRequest(n,t)}},{key:"createCleaningRule",value:function(e,t){var n="datamarts/"+e+"/cleaning_rules";return s.default.postRequest(n,t)}},{key:"getCleaningRule",value:function(e,t,n){var a="datamarts/"+e+"/cleaning_rules/"+t;return s.default.getRequest(a,{type:n})}},{key:"updateCleaningRule",value:function(e,t,n){var a="datamarts/"+e+"/cleaning_rules/"+t;return s.default.putRequest(a,n)}},{key:"deleteCleaningRule",value:function(e,t,n){var a="datamarts/"+e+"/cleaning_rules/"+t;return s.default.deleteRequest(a,{type:n})}},{key:"getContentFilter",value:function(e,t){var n="datamarts/"+e+"/cleaning_rules/"+t+"/content_filter";return s.default.getRequest(n)}},{key:"createContentFilter",value:function(e,t,n){var a="datamarts/"+e+"/cleaning_rules/"+t+"/content_filter";return s.default.postRequest(a,n)}},{key:"updateContentFilter",value:function(e,t,n){var a="datamarts/"+e+"/cleaning_rules/"+t+"/content_filter";return s.default.putRequest(a,n)}},{key:"deleteContentFilter",value:function(e,t){var n="datamarts/"+e+"/cleaning_rules/"+t+"/content_filter";return s.default.deleteRequest(n)}},{key:"getProcessingSelectionsByCompartment",value:function(e,t){var n="datamarts/"+e+"/compartments/"+t+"/processing_selections";return s.default.getRequest(n)}},{key:"createProcessingSelectionForCompartment",value:function(e,t,n){var a="datamarts/"+e+"/compartments/"+t+"/processing_selections";return s.default.postRequest(a,n)}},{key:"getCompartmentProcessingSelection",value:function(e,t,n){var a="datamarts/"+e+"/compartments/"+t+"/processing_selections/"+n;return s.default.getRequest(a)}},{key:"deleteCompartmentProcessingSelection",value:function(e,t,n){var a="datamarts/"+e+"/compartments/"+t+"/processing_selections/"+n;return s.default.deleteRequest(a)}}]),e}();t.DatamartService=u=c([(0,l.injectable)()],u),t.DatamartService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeedsStatsService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38),c=n(591);var u=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getSegmentStats",value:function(e,t){var n=(0,c.buildFeedCardStatsRequestBody)(t);return this.getStats(e,n)}},{key:"getStats",value:function(e,t){var n={organisation_id:e};return s.default.postRequest("reports/feed_report",t,n)}}]),e}();t.FeedsStatsService=d=u([(0,l.injectable)()],d),t.FeedsStatsService=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AssetFileService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=l(n(46)),i=l(n(59)),s=n(38);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"getAssetsFiles",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="asset_files",a=Object.assign({organisation_id:e},t);return o.default.getRequest(n,a)}},{key:"getAssetFile",value:function(e){var t="asset_files/"+e;return o.default.getRequest(t).then((function(e){return e.data})).catch((function(e){return i.default.warn("Cannot retrieve asset file",e),null}))}},{key:"deleteAssetsFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="asset_files/"+e,a=Object.assign({},t);return o.default.deleteRequest(n,a)}},{key:"uploadAssetsFile",value:function(e,t){var n="asset_files?organisation_id="+e;return o.default.postRequest(n,t)}}]),e}();t.AssetFileService=u=c([(0,s.injectable)()],u),t.AssetFileService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreativeService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=c(n(46)),i=c(n(59)),s=n(38),l=n(12);function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"getCreatives",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="creatives",a=Object.assign({organisation_id:e},t);return o.default.getRequest(n,a)}},{key:"getCreative",value:function(e){var t="creatives/"+e;return o.default.getRequest(t)}},{key:"getDisplayAds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.getCreatives(e,Object.assign({type:"DISPLAY_AD"},t))}},{key:"getEmailTemplates",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.getCreatives(e,Object.assign({type:"EMAIL_TEMPLATE"},t))}},{key:"getEmailTemplate",value:function(e){return this.getCreative(e)}},{key:"getDisplayAd",value:function(e){return this.getCreative(e)}},{key:"getCreativeFormats",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="reference_tables/formats",a=Object.assign(Object.assign({},t),{organisation_id:e});return o.default.getRequest(n,a)}},{key:"createDisplayCreative",value:function(e,t){var n=Object.assign(Object.assign({},t),{type:"DISPLAY_AD",organisation_id:e});return o.default.postRequest("display_ads",n)}},{key:"createEmailTemplate",value:function(e,t){var n=Object.assign(Object.assign({},t),{type:"EMAIL_TEMPLATE",organisation_id:e});return o.default.postRequest("email_templates",n)}},{key:"updateDisplayCreative",value:function(e,t){var n="display_ads/"+e;return o.default.putRequest(n,t)}},{key:"updateEmailTemplate",value:function(e,t){var n="email_templates/"+e;return o.default.putRequest(n,t)}},{key:"updateDisplayCreativeRendererProperty",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r="display_ads/"+t+"/renderer_properties/technical_name="+n;return this._pluginService.handleSaveOfProperties(a,e,"display_ads",t,r)}},{key:"updateEmailTemplateProperty",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r="email_templates/"+t+"/renderer_properties/technical_name="+n;return this._pluginService.handleSaveOfProperties(a,e,"email_templates",t,r)}},{key:"getCreativeRendererProperties",value:function(e){var t="display_ads/"+e+"/renderer_properties";return o.default.getRequest(t)}},{key:"getEmailTemplateProperties",value:function(e){var t="email_templates/"+e+"/renderer_properties";return o.default.getRequest(t)}},{key:"getEmailTemplateLocalizedPluginLayout",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US",n="email_templates/"+e+"/properties_layout?locale="+t;return o.default.getRequest(n).catch((function(e){return i.default.warn("Cannot retrieve plugin layout",e),null}))}},{key:"getAuditStatus",value:function(e){var t="display_ads/"+e+"/audits";return o.default.getRequest(t)}},{key:"makeAuditAction",value:function(e,t){var n="display_ads/"+e+"/action";return o.default.postRequest(n,{audit_action:t})}},{key:"takeScreenshot",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n="creatives/"+e+"/screenshots";return o.default.postRequest(n,t)}},{key:"getCreativeScreenshotStatus",value:function(e){var t="creatives/"+e+"/screenshots/last";return o.default.getRequest(t)}},{key:"sendTestBlast",value:function(e,t,n){var a="email_templates/"+e+"/send_test",r={organisation_id:t,email:n};return o.default.postRequest(a,r)}}]),e}();u([(0,s.inject)(l.TYPES.IPluginService)],d.prototype,"_pluginService",void 0),t.CreativeService=d=u([(0,s.injectable)()],d),t.CreativeService=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluginService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=c(n(46)),i=c(n(59)),s=n(38),l=n(12);function c(e){return e&&e.__esModule?e:{default:e}}function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var d=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"getPlugins",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a="plugins";return o.default.getRequest(a,t).then((function(t){return n?t:Promise.all(t.data.reduce((function(t,n){return n.current_version_id?[].concat(u(t),[e.getPluginVersion(n.id,n.current_version_id).then((function(e){return e.data}))]):t}),[])).then((function(e){var n=e.filter((function(e){return!!e.archived}));return Object.assign(Object.assign({},t),{data:t.data.filter((function(e){return!n.find((function(t){return t.id===e.current_version_id}))}))})}))}))}},{key:"getPluginVersions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="plugins/"+e+"/versions";return o.default.getRequest(n,t)}},{key:"getPlugin",value:function(e){var t="plugins/"+e;return o.default.getRequest(t)}},{key:"findPluginFromVersionId",value:function(e){var t="plugins/version/"+e;return o.default.getRequest(t)}},{key:"getPluginVersion",value:function(e,t){var n="plugins/"+e+"/versions/"+t;return o.default.getRequest(n)}},{key:"getPluginVersionProperties",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="plugins/"+e+"/versions/"+t+"/properties";return o.default.getRequest(a,n)}},{key:"getPluginPresets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="plugins.versions.presets";return o.default.getRequest(t,e)}},{key:"createPluginPreset",value:function(e,t,n){var a="plugins/"+e+"/versions/"+t+"/presets";return o.default.postRequest(a,n)}},{key:"deletePluginPreset",value:function(e,t,n,a){var r="plugins/"+e+"/versions/"+t+"/presets/"+n;return o.default.putRequest(r,a)}},{key:"getEngineProperties",value:function(e){var t="plugins/"+e+"/properties";return o.default.getRequest(t).then((function(e){return e.data}))}},{key:"getEngineVersion",value:function(e){var t="plugins/version/"+e;return o.default.getRequest(t).then((function(e){return e.data}))}},{key:"getAdLayouts",value:function(e,t){var n="ad_layouts?organisation_id="+e+"&renderer_version_id="+t;return o.default.getRequest(n)}},{key:"getAdLayoutVersion",value:function(e,t){var n="ad_layouts/"+t+"/versions",a={organisation_id:e,statuses:"DRAFT,PUBLISHED"};return o.default.getRequest(n,a)}},{key:"getStyleSheets",value:function(e){var t="style_sheets?organisation_id="+e;return o.default.getRequest(t)}},{key:"getStyleSheetsVersion",value:function(e,t){var n="style_sheets/"+t+"/versions",a={organisation_id:e,statuses:"DRAFT,PUBLISHED"};return o.default.getRequest(n,a)}},{key:"handleSaveOfProperties",value:function(e,t,n,a,r){if("ASSET"===e.property_type||"ASSET_FILE"===e.property_type||"ASSET_FOLDER"===e.property_type){var i="asset_files?organisation_id="+t;if("ASSET_FOLDER"===e.property_type&&(i="assets?organisation_id="+t+"&asset_type=FOLDER"),e.value&&0===e.value.length)return Promise.resolve();var s=e.value&&e.value.file?e.value.file:null;if(null!==s){var l=new FormData;return l.append("file",s,s.name),o.default.postRequest(i,l).then((function(t){var n=Object.assign({},e);n.value={original_name:t.data.original_name,path:t.data.path,asset_id:t.data.id},o.default.putRequest(r,n)}))}return Promise.resolve()}if("NATIVE_IMAGE"===e.property_type){if(e.value&&0===e.value.length)return Promise.resolve();var c=e.value&&e.value.file?e.value.file:null;if(null!==c){var u=new FormData;return u.append("file",c,c.name),this._assetFileService.uploadAssetsFile(t,u).then((function(t){var n=Object.assign({},e);n.value={original_file_name:t.data.original_name,file_path:t.data.path,asset_id:t.data.id,require_display:!0,height:t.data.height,width:t.data.width,type:1},o.default.putRequest(r,n)}))}return Promise.resolve()}if("DATA_FILE"===e.property_type){var d=new Blob([e.value.fileContent],{type:"application/octet-stream"});if(e.value.uri)return this._dataFileService.editDataFile(e.value.fileName,e.value.uri,d).then((function(){var t=Object.assign({},e);return t.value={uri:e.value.uri,last_modified:null},o.default.putRequest(r,t)}));if(e.value.fileName&&e.value.fileContent)return this._dataFileService.createDatafile(t,n,a,e.value.fileName,d).then((function(t){var n=Object.assign({},e);return n.value={uri:t,last_modified:null},o.default.putRequest(r,n)}));if(!e.value.fileName&&!e.value.fileContent&&!e.value.uri){var f=Object.assign({},e);return f.value={uri:null,last_modified:null},o.default.putRequest(r,f)}return Promise.resolve()}return o.default.putRequest(r,e)}},{key:"getLocalizedPluginLayout",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en-US",a="plugins/"+e+"/versions/"+t+"/properties_layout?locale="+n;return o.default.getRequest(a).then((function(e){return e.data})).catch((function(e){return i.default.warn("Cannot retrieve plugin layout",e),null}))}},{key:"getLocalizedPluginLayoutFromVersionId",value:function(e){var t=this;return this.findPluginFromVersionId(e).then((function(n){return null!==n&&"error"!==n.status&&n.data.current_version_id?t.getLocalizedPluginLayout(n.data.id,e).then((function(e){return{plugin:n.data,layout:e||void 0}})):{plugin:n.data,layout:void 0}}))}}]),e}();d([(0,s.inject)(l.TYPES.IAssetFileService)],f.prototype,"_assetFileService",void 0),d([(0,s.inject)(l.TYPES.IDataFileService)],f.prototype,"_dataFileService",void 0),t.PluginService=f=d([(0,s.injectable)()],f),t.PluginService=f,t.default=f},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttributionModelService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=l(n(46)),i=l(n(299)),s=n(38);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"attribution_models"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"getAttributionModels",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="attribution_models",a=Object.assign({organisation_id:e},t);return o.default.getRequest(n,a)}},{key:"getAttributionModel",value:function(e){var t="attribution_models/"+e;return o.default.getRequest(t)}},{key:"deleteAttributionModel",value:function(e){var t="attribution_models/"+e;return o.default.deleteRequest(t)}},{key:"getLocalizedPluginLayout",value:function(e){var t=this;return this.getInstanceById(e).then((function(e){var n=e.data;return t._pluginService.findPluginFromVersionId(n.attribution_processor_id).then((function(e){var a=e.data;return t._pluginService.getLocalizedPluginLayout(a.id,n.attribution_processor_id)}))}))}}]),t}(i.default);t.AttributionModelService=u=c([(0,s.injectable)()],u),t.AttributionModelService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LibraryCatalogService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getCatalogs",value:function(e){var t="datamarts/"+e+"/catalogs";return s.default.getRequest(t)}},{key:"getCatalog",value:function(e,t){var n="datamarts/"+e+"/catalogs/token="+t;return s.default.getRequest(n)}},{key:"getCatalogMainCategories",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="datamarts/"+e+"/catalogs/token="+t+"/categories";return s.default.getRequest(a,n)}},{key:"getCatalogSubCategories",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r="datamarts/"+e+"/catalogs/token="+t+"/categories/"+n+"/sub_categories";return s.default.getRequest(r,a)}},{key:"getCatalogParentCategories",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r="datamarts/"+e+"/catalogs/token="+t+"/categories/"+n+"/parent_categories";return s.default.getRequest(r,a)}},{key:"getCatalogCategoryItems",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r="datamarts/"+e+"/catalogs/token="+t+"/categories/"+n+"/items";return s.default.getRequest(r,a)}}]),e}();t.LibraryCatalogService=u=c([(0,l.injectable)()],u),t.LibraryCatalogService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceUsageReportService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(78),s=n(46),l=(a=s)&&a.__esModule?a:{default:a},c=n(81),u=n(38);var d=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getServiceUsageProviders",value:function(e,t,n,a,r,o){var s={from:t,to:n},u=(0,c.formatMcsDate)(s,!0),d=(0,i.parseFilter)(o),f={organisation_id:e,start_date:u.from,end_date:u.to,dimension:a,metrics:r||["unit_count"]};return void 0!==d&&(f=Object.assign(Object.assign({},f),{filters:d})),l.default.getRequest("reports/service_usage_provider_report",f)}}]),e}();t.ServiceUsageReportService=f=d([(0,u.injectable)()],f),t.ServiceUsageReportService=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RuntimeSchemaService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getRuntimeSchemas",value:function(e){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas")}},{key:"getRuntimeSchema",value:function(e,t){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t)}},{key:"getRuntimeSchemaText",value:function(e,t){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/text")}},{key:"updateRuntimeSchema",value:function(e,t,n){return s.default.putRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/text",n,{},{"Content-Type":"text/plain"})}},{key:"cloneRuntimeSchema",value:function(e,t){return s.default.postRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/clone",{})}},{key:"validateRuntimeSchema",value:function(e,t){return s.default.postRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/validation",{})}},{key:"publishRuntimeSchema",value:function(e,t){return s.default.postRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/publication",{})}},{key:"getObjectTypes",value:function(e,t){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/object_types")}},{key:"getObjectTypesDeep",value:function(e,t){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/object_types/deep")}},{key:"getObjectType",value:function(e,t,n){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/object_types/"+n)}},{key:"getObjectTypeInfoResources",value:function(e,t){return this.getObjectTypesDeep(e,t).then((function(e){return e.data}))}},{key:"getObjectTypeDirectives",value:function(e,t,n){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/object_types/"+n+"/directives")}},{key:"getObjectTypeDirective",value:function(e,t,n,a){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/object_types/"+n+"/directives/"+a)}},{key:"getObjectTypeDirectiveArguments",value:function(e,t,n,a){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/object_types/"+n+"/directives/"+a+"/arguments")}},{key:"getObjectTypeDirectiveArgument",value:function(e,t,n,a,r){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/object_types/"+n+"/directives/"+a+"/arguments/"+r)}},{key:"getFields",value:function(e,t,n){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/object_types/"+n+"/fields")}},{key:"getField",value:function(e,t,n,a){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/object_types/"+n+"/fields/"+a)}},{key:"getFieldDirectives",value:function(e,t,n,a){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/object_types/"+n+"/fields/"+a+"/directives")}},{key:"getFieldDirective",value:function(e,t,n,a,r){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/object_types/"+n+"/fields/"+a+"/directives/"+r)}},{key:"getFieldDirectiveArguments",value:function(e,t,n,a,r){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/object_types/"+n+"/fields/"+a+"/directives/"+r+"/arguments")}},{key:"getFieldDirectiveArgument",value:function(e,t,n,a,r,o){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/object_types/"+n+"/fields/"+a+"/directives/"+r+"/arguments/"+o)}},{key:"getFieldDecorator",value:function(e,t,n,a){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/schema_decorators/object_name="+n+"/field_name="+a)}},{key:"getSchemaDecorator",value:function(e,t){return s.default.getRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/schema_decorators")}},{key:"createSchemaDecorator",value:function(e,t,n){return s.default.postRequest("datamarts/"+e+"/graphdb_runtime_schemas/"+t+"/schema_decorators",n,{},{"Content-Type":"text/plain"})}}]),e}();t.RuntimeSchemaService=u=c([(0,l.injectable)()],u),t.RuntimeSchemaService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceHistoryService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=c(n(54)),i=n(908),s=c(n(46)),l=n(38);function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"getHistory",value:function(e,t){var n=Object.assign({organisation_id:e},t);return s.default.getRequest("resource_history",n)}},{key:"getResourceHistory",value:function(e,t){return this.getHistory(e,t)}},{key:"getUserHistory",value:function(e,t){return this.getHistory(e,t)}},{key:"getLinkedResourceIdInSelection",value:function(e,t,n,a){var r={resource_type:t,resource_id:n,max_results:15};return this.getResourceHistory(e,r).then((function(e){var t=o.default.flatMap(e.data,(function(e){return e.events.map((function(e){return(0,i.isHistoryLinkEvent)(e)&&e.resource_type===a?e.resource_id:""}))})).filter((function(e){return""!==e}));return t.length>0?t[0]:""}))}}]),e}();t.ResourceHistoryService=d=u([(0,l.injectable)()],d),t.ResourceHistoryService=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoalService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getGoals",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="goals",a=Object.assign({organisation_id:e},t);return t.datamart_id&&(a.datamart_id=t.datamart_id),s.default.getRequest(n,a)}},{key:"getGoal",value:function(e){var t="goals/"+e;return s.default.getRequest(t)}},{key:"updateGoal",value:function(e,t){var n="goals/"+e;return s.default.putRequest(n,t)}},{key:"createGoal",value:function(e,t){var n="goals?organisation_id="+e;return s.default.postRequest(n,t)}},{key:"deleteGoal",value:function(e){var t="goals/"+e;return s.default.deleteRequest(t)}},{key:"linkAttributionModelToGoal",value:function(e,t){var n="goals/"+e+"/attribution_models";return s.default.postRequest(n,t)}},{key:"updateLinkAttributionModel",value:function(e,t,n){var a="goals/"+e+"/attribution_models/"+t;return s.default.putRequest(a,n)}},{key:"getAttributionModels",value:function(e){var t="goals/"+e+"/attribution_models";return s.default.getRequest(t)}},{key:"deleteAttributionModel",value:function(e,t){var n="goals/"+e+"/attribution_models/"+t;return s.default.deleteRequest(n)}}]),e}();t.GoalService=u=c([(0,l.injectable)()],u),t.GoalService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DatamartUsersAnalyticsService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38),c=n(1407);var u=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getAnalytics",value:function(e,t,n,a,r,o,i,l){var u=(0,c.buildDatamartUsersAnalyticsRequestBody)(e,t,n,a,r,o,i,l),d="datamarts/"+e+"/user_activities_analytics";return s.default.postRequest(d,u)}}]),e}();t.DatamartUsersAnalyticsService=d=u([(0,l.injectable)()],d),t.DatamartUsersAnalyticsService=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildDatamartUsersAnalyticsRequestBody=function(e,t,n,a,i,s,l,c){var u=!((0,r.isNowFormat)(n.value)&&(0,r.isNowFormat)(a.value)),d=new o.default(n.value).toMoment().utc(u).startOf("day").format().replace("Z",""),f=new o.default(a.value).toMoment().utc(u).endOf("day").format().replace("Z","");return function(e,t,n,a,r,o,i){var s=[{start_date:e,end_date:t}],l=n.map((function(e){return{name:e}})),c=a.map((function(e){return{expression:e}})),u=r?Object.assign({},r):void 0;if(u&&o){var d=u.filters.find((function(e){return e.expressions[0]===o}));u.operator="AND";var f=u.filters.slice();d||f.push({dimension_name:"segment_id",not:!1,operator:"EXACT",expressions:[o],case_sensitive:!1}),i&&f.push({dimension_name:"segment_id",not:!1,operator:"EXACT",expressions:[i],case_sensitive:!1}),u.filters=f}return{date_ranges:s,dimensions:l,dimension_filter_clauses:u,metrics:c}}(d,f,i||[],t,s,l,c)};var a,r=n(81),o=(a=r)&&a.__esModule?a:{default:a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmailCampaignService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getEmailCampaign",value:function(e){var t="email_campaigns/"+e;return s.default.getRequest(t)}},{key:"getEmailCampaigns",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="campaigns",r=Object.assign({organisation_id:e,campaign_type:t},n);return s.default.getRequest(a,r)}},{key:"deleteEmailCampaign",value:function(e){var t="email_campaigns/"+e;return s.default.deleteRequest(t)}},{key:"createEmailCampaign",value:function(e,t){var n={organisation_id:e},a=Object.assign(Object.assign({},t),{organisation_id:e,type:"EMAIL",editor_version_id:"17"});return s.default.postRequest("email_campaigns",a,n)}},{key:"updateEmailCampaign",value:function(e,t){var n="email_campaigns/"+e;return s.default.putRequest(n,Object.assign(Object.assign({},t),{type:"EMAIL"}))}},{key:"archiveEmailCampaign",value:function(e){return this.updateEmailCampaign(e,{archived:!0})}},{key:"getRouters",value:function(e){var t="email_campaigns/"+e+"/email_routers";return s.default.getRequest(t)}},{key:"getRouter",value:function(e,t){var n="email_campaigns/"+e+"/email_routers/"+t;return s.default.getRequest(n)}},{key:"createRouter",value:function(e,t){var n="email_campaigns/"+e+"/email_routers";return s.default.postRequest(n,t)}},{key:"deleteRouter",value:function(e,t){var n="email_campaigns/"+e+"/email_routers/"+t;return s.default.deleteRequest(n)}},{key:"getBlasts",value:function(e){var t="email_campaigns/"+e+"/email_blasts";return s.default.getRequest(t)}},{key:"getBlast",value:function(e,t){var n="email_campaigns/"+e+"/email_blasts/"+t;return s.default.getRequest(n)}},{key:"createBlast",value:function(e,t){var n="email_campaigns/"+e+"/email_blasts";return s.default.postRequest(n,t)}},{key:"updateBlast",value:function(e,t,n){var a="email_campaigns/"+e+"/email_blasts/"+t;return s.default.putRequest(a,n)}},{key:"deleteBlast",value:function(e,t){var n="email_campaigns/"+e+"/email_blasts/"+t;return s.default.deleteRequest(n)}},{key:"getEmailTemplates",value:function(e,t){var n="email_campaigns/"+e+"/email_blasts/"+t+"/email_templates";return s.default.getRequest(n)}},{key:"createEmailTemplate",value:function(e,t,n){var a="email_campaigns/"+e+"/email_blasts/"+t+"/email_templates";return s.default.postRequest(a,n)}},{key:"deleteEmailTemplate",value:function(e,t,n){var a="email_campaigns/"+e+"/email_blasts/"+t+"/email_templates/"+n;return s.default.deleteRequest(a)}},{key:"getConsents",value:function(e,t){var n="email_campaigns/"+e+"/email_blasts/"+t+"/email_consents";return s.default.getRequest(n)}},{key:"createConsent",value:function(e,t,n){var a="email_campaigns/"+e+"/email_blasts/"+t+"/email_consents";return s.default.postRequest(a,n)}},{key:"deleteConsent",value:function(e,t,n){var a="email_campaigns/"+e+"/email_blasts/"+t+"/email_consents/"+n;return s.default.deleteRequest(a)}},{key:"getSegments",value:function(e,t){var n="email_campaigns/"+e+"/email_blasts/"+t+"/audience_segments";return s.default.getRequest(n)}},{key:"createSegment",value:function(e,t,n){var a="email_campaigns/"+e+"/email_blasts/"+t+"/audience_segments";return s.default.postRequest(a,n)}},{key:"deleteSegment",value:function(e,t,n){var a="email_campaigns/"+e+"/email_blasts/"+t+"/audience_segments/"+n;return s.default.deleteRequest(a)}},{key:"computeSegmentReach",value:function(e,t,n){var a="datamarts/"+e+"/email_blast_query",r={segment_ids:t,provider_technical_names:n};return s.default.getRequest(a,r).then((function(e){return e.count}))}}]),e}();t.EmailCampaignService=u=c([(0,l.injectable)()],u),t.EmailCampaignService=u,t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmailCampaignFormService=void 0;var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(159),s=n(112),l=n(592),c=n(38),u=n(12);function d(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var f=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"loadCampaign",value:function(e){return Promise.all([this._emailCampaignService.getEmailCampaign(e),this.loadCampaignDependencies(e)]).then((function(e){var t=a(e,2),n=t[0],r=t[1];return Object.assign({campaign:n.data},r)}))}},{key:"loadBlast",value:function(e,t){return Promise.all([this._emailCampaignService.getBlast(e,t),this.loadBlastDependencies(e,t)]).then((function(e){var t=a(e,2),n=t[0],r=t[1];return Object.assign({blast:n.data},r)}))}},{key:"loadCampaignDependencies",value:function(e){var t=this;return Promise.all([this._emailCampaignService.getRouters(e).then((function(e){return e.data.map(i.createFieldArrayModel)})),this._emailCampaignService.getBlasts(e).then((function(n){return Promise.all(n.data.map((function(n){return t.loadBlastDependencies(e,n.id).then((function(e){return(0,i.createFieldArrayModel)(Object.assign({blast:n},e))}))})))}))]).then((function(e){var t=a(e,2);return{routerFields:t[0],blastFields:t[1]}}))}},{key:"loadBlastDependencies",value:function(e,t){return Promise.all([this._emailCampaignService.getEmailTemplates(e,t).then((function(e){return e.data.map((function(e){return Object.assign({},(0,i.createFieldArrayModelWithMeta)(e,{name:e.name}))}))})),this._emailCampaignService.getConsents(e,t).then((function(e){return e.data.map(i.createFieldArrayModel)})),this._emailCampaignService.getSegments(e,t).then((function(e){return e.data.map((function(e){return Object.assign({},(0,i.createFieldArrayModelWithMeta)(e,{name:e.name}))}))}))]).then((function(e){var t=a(e,3);return{templateFields:t[0],consentFields:t[1],segmentFields:t[2]}}))}},{key:"saveCampaign",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.INITIAL_EMAIL_CAMPAIGN_FORM_DATA;return(t.campaign&&m(t.campaign)?this._emailCampaignService.updateEmailCampaign(t.campaign.id,t.campaign):this._emailCampaignService.createEmailCampaign(e,t.campaign)).then((function(e){var r=e.data.id,o=[];return o.push.apply(o,d(n.getRouterTasks(r,t.routerFields,a.routerFields)).concat(d(n.getBlastTasks(r,t.blastFields,a.blastFields)))),(0,s.executeTasksInSequence)(o).then((function(){return r}))}))}},{key:"saveBlast",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.INITIAL_EMAIL_BLAST_FORM_DATA;return(t.blast&&m(t.blast)?this._emailCampaignService.updateBlast(e,t.blast.id,t.blast):this._emailCampaignService.createBlast(e,t.blast)).then((function(r){var o=r.data.id,i=[];return i.push.apply(i,d(n.getSegmentTasks(e,o,t.segmentFields,a.segmentFields)).concat(d(n.getConsentTasks(e,o,t.consentFields,a.consentFields)),d(n.getTemplateTasks(e,o,t.templateFields,a.templateFields)))),(0,s.executeTasksInSequence)(i).then((function(){return o}))}))}},{key:"getSegmentTasks",value:function(e,t,n,a){var r=this,o=[];a.forEach((function(e){m(e.model)&&o.push(e.model.id)}));var i=[];n.forEach((function(e){m(e.model)&&i.push(e.model.id)}));var s=[];return n.forEach((function(n){m(n.model)||s.push((function(){return r._emailCampaignService.createSegment(e,t,n.model)}))})),o.filter((function(e){return!i.includes(e)})).forEach((function(n){s.push((function(){return r._emailCampaignService.deleteSegment(e,t,n)}))})),s}},{key:"getTemplateTasks",value:function(e,t,n,a){var r=this,o=[];a.forEach((function(e){m(e.model)&&o.push(e.model.id)}));var i=[];n.forEach((function(e){m(e.model)&&i.push(e.model.id)}));var s=[];return n.forEach((function(n){m(n.model)||s.push((function(){return r._emailCampaignService.createEmailTemplate(e,t,n.model)}))})),o.filter((function(e){return!i.includes(e)})).forEach((function(n){s.push((function(){return r._emailCampaignService.deleteEmailTemplate(e,t,n)}))})),s}},{key:"getConsentTasks",value:function(e,t,n,a){var r=this,o=[];a.forEach((function(e){e.model.id&&o.push(e.model.id)}));var i=[];n.forEach((function(e){e.model.id&&i.push(e.model.id)}));var s=[];return n.forEach((function(n){n.model.id||s.push((function(){return r._emailCampaignService.createConsent(e,t,n.model)}))})),o.filter((function(e){return!i.includes(e)})).forEach((function(n){s.push((function(){return r._emailCampaignService.deleteConsent(e,t,n)}))})),s}},{key:"getRouterTasks",value:function(e,t,n){var a=this,r=[];n.forEach((function(e){e.model.id&&r.push(e.model.id)}));var o=[];t.forEach((function(e){e.model.id&&o.push(e.model.id)}));var i=[];return t.forEach((function(t){t.model.id||i.push((function(){return a._emailCampaignService.createRouter(e,t.model)}))})),r.filter((function(e){return!o.includes(e)})).forEach((function(t){i.push((function(){return a._emailCampaignService.deleteRouter(e,t)}))})),i}},{key:"getBlastTasks",value:function(e,t,n){var a=this,r=[];n.forEach((function(e){m(e.model.blast)&&r.push(e.model.blast.id)}));var o=[];t.forEach((function(e){m(e.model.blast)&&o.push(e.model.blast.id)}));var i=[];return t.forEach((function(t){var r=n.find((function(e){return e.key===t.key}));i.push((function(){return a.saveBlast(e,t.model,r?r.model:void 0)}))})),r.filter((function(e){return!o.includes(e)})).forEach((function(t){i.push((function(){return a._emailCampaignService.deleteBlast(e,t)}))})),i}}]),e}();function m(e){return void 0!==e.id}f([(0,c.inject)(u.TYPES.IEmailCampaignService)],p.prototype,"_emailCampaignService",void 0),t.EmailCampaignFormService=p=f([(0,c.injectable)()],p),t.EmailCampaignFormService=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScenarioExitConditionService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(38),s=n(46),l=(a=s)&&a.__esModule?a:{default:a};var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getScenarioExitConditions",value:function(e){var t="scenarios/"+e+"/exit_conditions";return l.default.getRequest(t)}},{key:"getScenarioExitCondition",value:function(e,t){var n="scenarios/"+e+"/exit_conditions/"+t;return l.default.getRequest(n)}},{key:"createScenarioExitConditions",value:function(e,t){var n="scenarios/"+e+"/exit_conditions";return l.default.postRequest(n,t)}},{key:"deleteScenarioExitConditions",value:function(e,t){var n="scenarios/"+e+"/exit_conditions/"+t;return l.default.deleteRequest(n)}}]),e}();t.ScenarioExitConditionService=u=c([(0,i.injectable)()],u),t.ScenarioExitConditionService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserActivitiesFunnelService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38),c=n(1412);var u=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getUserActivitiesFunnel",value:function(e,t,n,a){var r=(0,c.buildUserActivitiesFunnelRequestBody)(t,n,a),o="datamarts/"+e+"/user_activities_funnel";return s.default.postRequest(o,r)}}]),e}();t.UserActivitiesFunnelService=d=u([(0,l.injectable)()],d),t.UserActivitiesFunnelService=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildUserActivitiesFunnelRequestBody=function(e,t,n){var a=new o.default(t.start_date).toMoment().format("YYYY-MM-DD"),r=new o.default(t.end_date).toMoment().format("YYYY-MM-DD");return{for:e,in:Object.assign(Object.assign({},t),{start_date:a,end_date:r}),number_of_parts_to_split_on:10,limit:n}};var a,r=n(81),o=(a=r)&&a.__esModule?a:{default:a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UsersAnalyticsService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getDimensions",value:function(e,t){var n="datamarts/"+e+"/user_activities_analytics/dimensions?is_available_for_funnel="+t;return s.default.getRequest(n)}}]),e}();t.UsersAnalyticsService=u=c([(0,l.injectable)()],u),t.UsersAnalyticsService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserRolesService=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(46),s=(a=i)&&a.__esModule?a:{default:a},l=n(38);var c=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getUserRoles",value:function(e){var t="users/"+e+"/user_roles";return s.default.getRequest(t)}},{key:"createUserRole",value:function(e,t){var n="users/"+e+"/user_roles";return s.default.postRequest(n,t)}},{key:"deleteUserRole",value:function(e,t){var n="users/"+e+"/user_roles/"+t;return s.default.deleteRequest(n)}}]),e}();t.UserRolesService=u=c([(0,l.injectable)()],u),t.UserRolesService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=f(n(1416)),s=n(10),l=f(n(930)),c=f(n(931)),u=f(n(1484)),d=n(33);function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function g(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(0,o.addLocaleData)([].concat(g(l.default),g(c.default)));var y={number:{USD:{style:"currency",currency:"USD"},EUR:{style:"currency",currency:"EUR"}}},h=function(e){function t(){return p(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){return r.createElement(o.IntlProvider,{formats:y,defaultFormats:y,locale:"en"},r.createElement(s.ConfigProvider,{locale:i.default},r.createElement(d.HashRouter,null,r.createElement(u.default,null))))}}]),t}(r.Component);t.default=h},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(1485),o=(a=r)&&a.__esModule?a:{default:a};t.default=o.default},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=F(n(0)),s=n(8),l=n(25),c=n(33),u=n(6),d=n(13),f=D(n(930)),p=D(n(931)),m=D(n(1487)),g=D(n(932)),y=n(2718),h=n(2720),v=n(2723),b=n(2725),_=D(n(2740)),S=D(n(59)),E=n(2743),O=F(n(738)),w=n(2744),M=F(n(67)),P=D(n(2745)),T=D(n(856)),I=D(n(2752)),A=D(n(2753)),C=n(2754),j=n(15),R=n(12),N=n(2757),k=n(11);function D(e){return e&&e.__esModule?e:{default:e}}function F(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var L=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};(0,u.addLocaleData)(f.default||p.default);var x=function(t){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.state={adBlockOn:!1,error:!1,datamartIds:[]},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,t),r(n,[{key:"componentDidMount",value:function(){var t=this;this._navigatorService.isAdBlockOn().then((function(){for(var n,a,r=e.document.getElementsByClassName("mcs-colors")[0].children,o={},i=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(r)),s=0;s<i.length;s++){var l=i[s];o[l.className]=(n=e.window.getComputedStyle(l)["background-color"],a=void 0,(a=n.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===a.length?"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2):"")}t.props.setColorsStore(o),document.addEventListener("unauthorizedEvent",(function(e){t._authService.deleteCredentials(),t.props.history.push({pathname:"/",state:t.props.location.state})}),!1)})).catch((function(){return t.setState({adBlockOn:!0})}))}},{key:"componentDidCatch",value:function(){this.setState({error:!0})}},{key:"render",value:function(){var e=this,t=this.props,n=t.defaultWorkspaceOrganisationId,r=t.workspaces,o=t.intl.formatMessage,s=t.initialized,l=t.initializationError,u=this.state,d=u.error;if(u.adBlockOn)return i.createElement(k.Error,{message:o(T.default.adBlock)});if(l)return i.createElement(k.Error,{message:o(T.default.generic)});if(d)return i.createElement(k.Error,{message:o(T.default.generic)});if(!s)return i.createElement(k.Loading,{isFullScreen:!1});var f=200,p=this.props.workspaces?Object.keys(this.props.workspaces).length:0;p>20?f=800:p>8&&(f=400);var E="/v2/o/:organisationId(\\d+)",O=r&&n&&r[parseInt(n,0)]&&r[parseInt(n,0)].datamarts&&r[parseInt(n,0)].datamarts.length>0?"/v2/o/"+n+"/audience/segments":"/v2/o/"+n+"/campaigns/display",w=_.default.map((function(e,t){return S.default.trace("Available route : "+E+e.path),i.createElement(y.AuthenticatedRoute,{key:0,exact:!0,path:""+E+e.path,render:function(t){var n="main"===e.layout?{contentComponent:e.contentComponent,actionBarComponent:e.actionBarComponent}:"edit"===e.layout?{editComponent:e.editComponent}:{contentComponent:e.contentComponent},r=e.datalayer;return i.createElement(m.default,{datalayer:r},i.createElement(N.Notifications,null),i.createElement("div",{className:"drawer-wrapper"},i.createElement(I.default,null)),i.createElement(g.default,a({layout:e.layout,organisationSelector:P.default,showOrgSelector:p>0,orgSelectorSize:f},n,t)),i.createElement("div",{id:"mcs-edit-modal"}))},errorRender:function(t){var n="main"===e.layout||"settings"===e.layout?{contentComponent:A.default}:{editComponent:A.default},r=e.datalayer;return i.createElement(m.default,{datalayer:r},i.createElement(N.Notifications,null),i.createElement("div",{className:"drawer-wrapper"},i.createElement(I.default,null)),i.createElement(g.default,a({layout:e.layout,organisationSelector:P.default,showOrgSelector:p>0,orgSelectorSize:f},n,t)),i.createElement("div",{id:"mcs-edit-modal"}))},requiredFeatures:e.requiredFeature,requireDatamart:e.requireDatamart})}));return i.createElement(c.Switch,null,i.createElement(c.Route,{exact:!0,path:"/set-password",component:b.SetPassword}),i.createElement(c.Route,{exact:!0,path:"/",render:function(t){var n=t.match,a="/login";return e._authService.isAuthenticated()&&(a=O),S.default.debug("Redirect from "+n.url+"  to "+a),i.createElement(c.Redirect,{to:{pathname:a,state:e.props.location.state}})}}),w,i.createElement(c.Route,{exact:!0,path:"/login",render:function(){return e._authService.isAuthenticated()||e._authService.canAuthenticate()?i.createElement(c.Redirect,{to:O}):(e.props.logOut(),i.createElement(v.Login,null))}}),i.createElement(c.Route,{exact:!0,path:"/logout",render:function(){return e.props.logOut(void 0,{redirectCb:function(){e.props.history.push({pathname:"/"})}}),null}}),i.createElement(c.Route,{exact:!0,path:"/:communityToken/change-password",component:C.CommunityChangePassword}),i.createElement(c.Route,{exact:!0,path:"/:communityToken/set-password",component:C.CommunityChangePassword}),i.createElement(c.Route,{exact:!0,path:"/v2/forgot_password",component:h.ForgotPassword}),i.createElement(c.Route,{render:function(){return i.createElement(k.Error,{message:o(T.default.notFound)})}}))}}]),n}(i.Component);L([(0,j.lazyInject)(R.TYPES.INavigatorService)],x.prototype,"_navigatorService",void 0),L([(0,j.lazyInject)(R.TYPES.IAuthService)],x.prototype,"_authService",void 0);var G={logOut:O.logOut,setColorsStore:w.setColorsStore};t.default=(0,s.compose)(u.injectIntl,d.withRouter,(0,l.connect)((function(e){return{initialized:(0,E.isAppInitialized)(e),initializationError:e.app.initializationError,workspaces:M.getWorkspaces(e),defaultWorkspaceOrganisationId:M.getDefaultWorkspaceOrganisationId(e)}}),G))(x)}).call(this,n(71))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(8),l=n(15),c=n(12);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},p=function(e){function t(){u(this,t);var e=d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFinalDatalayer=function(e,t,n){return Object.assign(Object.assign({},n),{organisation_id:e,path:t})},e.pushEvent=function(t){e._tagService.pushPageView(t)},e.googleAnalyticsTrack=function(t){e._tagService.googleAnalyticsTrack(t)},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.datalayer,n=e.match.params.organisationId,a=e.location.pathname;this.pushEvent(this.buildFinalDatalayer(n,a,t)),this.googleAnalyticsTrack(a)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.datalayer,a=t.match.params.organisationId,r=t.location.pathname,o=e.datalayer,i=e.match.params.organisationId,s=e.location.pathname;n===o&&s===r&&a===i||(this.pushEvent(this.buildFinalDatalayer(a,r,n)),this.googleAnalyticsTrack(r))}},{key:"render",value:function(){var e=this.props.children;return o.createElement("div",null,e)}}]),t}(o.Component);f([(0,l.lazyInject)(c.TYPES.ITagService)],p.prototype,"_tagService",void 0),t.default=(0,s.compose)(i.withRouter)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SettingLayout=t.MainLayout=t.LayoutManager=t.EditLayout=void 0;var a=s(n(1489)),r=s(n(932)),o=s(n(1996)),i=s(n(2717));function s(e){return e&&e.__esModule?e:{default:e}}t.EditLayout=a.default,t.LayoutManager=r.default,t.MainLayout=o.default,t.SettingLayout=i.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),r=n(10),o=n(750);t.default=function(e){var t=e.editComponent;return a.createElement(r.Layout,{id:"mcs-full-page",className:"mcs-fullscreen"},a.createElement(o.NavigatorHeader,null),a.createElement(t,null))}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=y(n(0)),o=n(25),i=n(33),s=n(6),l=n(41),c=n(10),u=n(107),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(67)),f=y(n(1993)),p=n(8),m=n(65),g=n(11);function y(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=c.Layout.Header,_=function(t){function n(){return h(this,n),v(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,t),a(n,[{key:"render",value:function(){var t=this.props,n=t.match.params.organisationId,a=t.workspace,o=t.userEmail,d=t.isSetting,p=t.menu,m=a(n).organisation_name,y=r.default.createElement(c.Menu,null,r.default.createElement(c.Menu.Item,{key:"email",disabled:!0},o),r.default.createElement(c.Menu.Divider,null),r.default.createElement(c.Menu.Item,{key:"account"},r.default.createElement(i.Link,{to:{pathname:"/v2/o/"+n+"/settings/account/my_profile"}},r.default.createElement(s.FormattedMessage,f.default.account))),r.default.createElement(c.Menu.Item,{key:"logout"},r.default.createElement(i.Link,{to:"/logout"},r.default.createElement(s.FormattedMessage,{id:"components.header.logOut",defaultMessage:"Log out"}))));return r.default.createElement(b,{className:"mcs-header"},r.default.createElement("div",{className:"mcs-header-title"},r.default.createElement("span",{className:"left-component"},d&&p?r.default.createElement("span",{className:"launcher"},r.default.createElement(u.Dropdown,{overlay:p,trigger:["click"]},r.default.createElement("a",null,r.default.createElement(l.AppstoreFilled,{className:"menu-icon"})))):null,r.default.createElement(i.Link,{to:"/v2/o/"+n+"/campaigns/display",className:"organisation-name"},m)),"prod"===e.env.API_ENV?r.default.createElement(c.Alert,{className:"mcs-header-title-alert",message:"You are using production API environment !",type:"error",showIcon:!0}):null),r.default.createElement("div",{className:"mcs-header-actions"},r.default.createElement(i.Link,{className:"mcs-header-actions-settings",to:"/v2/o/"+n+"/settings/organisation/labels"},r.default.createElement(g.McsIcon,{type:"options",className:"menu-icon"})),r.default.createElement("div",{className:"mcs-header-actions-account"},r.default.createElement(u.Dropdown,{overlay:y,trigger:["click"],placement:"bottomRight"},r.default.createElement("a",null,r.default.createElement(g.McsIcon,{type:"user",className:"menu-icon"}))))))}}]),n}(r.default.Component);t.default=(0,p.compose)(i.withRouter,m.injectDatamart,(0,o.connect)((function(e){return{workspace:d.getWorkspace(e),userEmail:e.session.connectedUser.email}})))(_)}).call(this,n(136))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(84),c=(a=l)&&a.__esModule?a:{default:a};var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onChange=function(e){n.props.input.onChange(e),n.setState({checked:e})},n.state={checked:!!e.input.checked&&e.input.checked},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.meta,n=e.formItemProps,a=e.inputProps,o=e.helpToolTipProps,l=e.input,u=e.small,d="success";return t.touched&&t.invalid&&(d="error"),t.touched&&t.warning&&(d="warning"),i.createElement(c.default,r({help:t.touched&&(t.warning||t.error),helpToolTipProps:o,validateStatus:d,small:u},n),i.createElement(s.Checkbox,r({},l,a,{defaultChecked:this.state.checked})))}}]),t}(i.Component);u.defaultprops={formItemProps:{},inputProps:{},helpToolTipProps:{}},t.default=u},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10);var i=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};t.default=function(e){var t=e.input,n=t.onChange,s=t.value,l=e.children,c=i(e,["input","children"]),u=!!s;return r.createElement(o.Checkbox,a({},c,{checked:u,onChange:function(){return n(!u)}}),l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),r=n(10),o=n(24);var i=r.Checkbox.Group;t.default=function(e){var t=e.options,n=e.input,r=e.disabled,s=e.className,l=""===n.value?[]:e.valueAsString&&!Array.isArray(n.value)?n.value.split(","):n.value,c="success";return e.meta.touched&&e.meta.invalid&&(c="error"),e.meta.touched&&e.meta.warning&&(c="warning"),a.createElement(o.FormFieldWrapper,{help:e.meta.touched&&(e.meta.warning||e.meta.error),validateStatus:c},a.createElement(i,{options:t,defaultValue:l,disabled:r,onChange:function(t){return e.valueAsString&&Array.isArray(t)?n.onChange(t.join(",")):n.onChange(t)},className:s}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(54),s=c(n(17)),l=c(n(84));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){var t="success";e.meta.touched&&e.meta.invalid&&(t="error"),e.meta.touched&&e.meta.warning&&(t="warning");var n=e.input.value;""===n?n=void 0:(e.unixTimestamp||e.isoDate)&&(n=(0,s.default)(n));return r.createElement(l.default,a({help:e.meta.touched&&(e.meta.warning||e.meta.error),helpToolTipProps:e.helpToolTipProps,validateStatus:t,small:e.small},e.formItemProps),r.createElement(o.DatePicker,a({allowClear:!1},(0,i.omit)(e.input,["onBlur","onFocus"]),{value:n,onChange:function(t,n){return e.unixTimestamp?e.input.onChange(t&&parseInt(t.format("x"),0)):e.isoDate?e.input.onChange(n):e.input.onChange(t)},disabled:e.disabled},e.datePickerProps)))};u.defaultProps={formItemProps:{},datePickerProps:{},helpToolTipProps:{title:""}},t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(975),l=(a=s)&&a.__esModule?a:{default:a};var c=i.Radio.Group;t.default=function(e){var t=e.elementClassName,n=e.groupClassName,a=e.elements,s=e.input,u=e.disabled,d=e.radioButton,f=a.map((function(e){return d?o.createElement(i.Radio.Button,{key:e.id,value:e.value},e.title):o.createElement(l.default,{className:t,key:e.id,name:e.value,title:e.title,value:e.value})}));return o.createElement(c,r({},s,{className:n,onChange:function(e){return s.onChange(e.target.value)},value:s.value,disabled:u}),f)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10);var i=function(e){return r.createElement(o.Switch,a({},e.input,{className:e.className}))};i.defaultProps={className:"mcs-table-switch"},t.default=i},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(41),s=n(10),l=n(6),c=n(24);var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),a=void 0;return e.input.value&&e.input.value.asset_id&&(a={uid:e.input.value.asset_id,name:e.input.value.original_file_name,size:0,type:""}),n.state={file:a},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.input,r=t.meta,l=t.formItemProps,u=t.inputProps,d=t.helpToolTipProps,f=t.disabled,p=t.small,m=this.state.file,g="success";r.touched&&r.invalid&&(g="error"),r.touched&&r.warning&&(g="warning");var y={action:"/",beforeUpload:function(e){return!1},onChange:function(t){u&&u.disabled||(e.setState({file:t.file}),n.onChange(Object.assign(Object.assign({},n.value),{file:t.file})))},onRemove:function(t){u&&u.disabled||(e.setState({file:void 0}),n.onChange(void 0))}},h=m?[m]:[];return o.createElement(c.FormFieldWrapper,a({help:r.touched&&(r.warning||r.error),helpToolTipProps:d,validateStatus:g,small:p},l),o.createElement(s.Upload,a({fileList:h},u,y,{disabled:f}),o.createElement(s.Button,{onClick:this.props.noUploadModal,disabled:f},o.createElement(i.UploadOutlined,null)," ",this.props.buttonText)))}}]),t}(o.Component);t.default=(0,l.injectIntl)(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(84),l=(a=s)&&a.__esModule?a:{default:a};var c=function(e){var t="success";return e.meta.touched&&e.meta.invalid&&(t="error"),e.meta.touched&&e.meta.warning&&(t="warning"),o.createElement(l.default,r({help:e.meta.touched&&(e.meta.warning||e.meta.error),helpToolTipProps:e.helpToolTipProps,validateStatus:t,small:e.small},e.formItemProps),o.createElement(i.Input.TextArea,r({id:e.input.name},e.input,e.inputProps)))};c.defaultProps={formItemProps:{},inputProps:{},helpToolTipProps:{title:""}},t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(84),l=(a=s)&&a.__esModule?a:{default:a};t.default=function(e){var t="success";return e.meta.touched&&e.meta.invalid&&(t="error"),e.meta.touched&&e.meta.warning&&(t="warning"),o.createElement(l.default,r({help:e.meta.touched&&(e.meta.warning||e.meta.error),helpToolTipProps:e.helpToolTipProps,validateStatus:t,small:e.small},e.formItemProps),o.createElement(i.InputNumber,r({id:e.input.name},e.input,e.inputNumberProps)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(84),c=(a=l)&&a.__esModule?a:{default:a};function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e){function t(){u(this,t);var e=d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.onChange=function(t){e.props.input.onChange(t),e.setState({checked:t})},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.meta,n=e.formItemProps,a=e.inputProps,o=e.helpToolTipProps,l=e.input,u=e.small,d="success";return t.touched&&t.invalid&&(d="error"),t.touched&&t.warning&&(d="warning"),i.createElement(c.default,r({help:t.touched&&(t.warning||t.error),helpToolTipProps:o,validateStatus:d,small:u},n),i.createElement(s.Slider,r({},l,a)))}}]),t}(i.Component);f.defaultprops={formItemProps:{},inputProps:{},helpToolTipProps:{}},t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=s(n(270));n(613),n(1728);var i=s(n(84));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t="success";e.meta.touched&&e.meta.invalid&&(t="error"),e.meta.touched&&e.meta.warning&&(t="warning");return r.createElement(i.default,a({help:e.meta.touched&&(e.meta.warning||e.meta.error),helpToolTipProps:e.helpToolTipProps,validateStatus:t,small:e.small},e.formItemProps,{className:"mcs-formFieldWrapper_codeEdit"}),r.createElement(o.default,a({value:e.input.value},e.inputProps,{theme:"github",name:e.input.name,onBlur:function(){return e.input.onBlur(void 0)},onFocus:function(){return e.input.onFocus(void 0)},width:"100%",onChange:e.input.onChange,readOnly:e.disabled,showPrintMargin:!1})))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(6);function s(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=o.Upload.Dragger,d=function(e){function t(){return l(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e,t,n=this,a=this.props,i=a.intl.formatMessage,l=a.uploadTitle,c=a.uploadMessage,d=a.maxFileSize,f=a.uploadError;return r.createElement(u,(e=n.props,t=e.input,{name:"file",multiple:!0,action:"/",accept:e.fileMasks,beforeUpload:function(e,n){!function(e){e.size<d||o.message.error(e.name+" "+i(f),2)}(e);var a=[].concat(s(t.value),s(function(e){return e.filter((function(e){return e.size<d}))}(n)));return t.onChange(a),!1},fileList:t.value,onRemove:function(e){t.onChange(t.value.filter((function(t){return t.uid!==e.uid})))}}),r.createElement("p",{className:"ant-upload-text"},i(l)),r.createElement("p",{className:"ant-upload-hint"},i(c)))}}]),t}(r.Component);t.default=(0,i.injectIntl)(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(84),c=(a=l)&&a.__esModule?a:{default:a};function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e){function t(){return u(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){var e="success";return this.props.meta.touched&&this.props.meta.invalid&&(e="error"),this.props.meta.touched&&this.props.meta.warning&&(e="warning"),i.createElement(c.default,r({help:this.props.meta.touched&&(this.props.meta.warning||this.props.meta.error),helpToolTipProps:this.props.helpToolTipProps,validateStatus:e,small:this.props.small},this.props.formItemProps),i.createElement(s.Rate,this.props.inputProps))}}]),t}(i.Component);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),r=n(10),o=n(24);t.default=function(e){var t=e.timeFormat,n=e.disabled,i=e.className,s=e.allowClear,l=e.minuteStep,c=e.input,u="success";return e.meta.invalid&&(u="error"),e.meta.warning&&(u="warning"),a.createElement(o.FormFieldWrapper,{help:e.meta.touched&&(e.meta.warning||e.meta.error),validateStatus:u},a.createElement(r.TimePicker,{disabled:n,format:t,allowClear:s,minuteStep:l,className:i,value:c.value,onChange:c.onChange}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(0,n(6).defineMessages)({account:{id:"header.account",defaultMessage:"Account"},settingOrganisation:{id:"header.settings.organisation",defaultMessage:"Organisation Settings"},settingDatamart:{id:"header.settings.datamart",defaultMessage:"Datamart Settings"}});t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(8),o=n(25),i=n(33),s=n(59),l=(a=s)&&a.__esModule?a:{default:a},c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(67));var u=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};t.default=(0,r.compose)(i.withRouter,(0,o.connect)((function(e){return{getWorkspace:c.getWorkspace(e)}})),(0,r.mapProps)((function(e){var t=e.getWorkspace,n=u(e,["getWorkspace"]),a=t(n.match.params.organisationId);return a||l.default.error("No datamart found for organisationId ",n.match.params.organisationId),Object.assign({workspace:a},n)})))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(225),s=(a=i)&&a.__esModule?a:{default:a},l=n(271);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=function(e){function t(){return c(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.language,n=e.value;return o.createElement("div",null,o.createElement(s.default,{language:t,style:l.docco},n)," ")}}]),t}(o.Component);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=v(n(0)),o=n(6),i=n(33),s=n(41),l=n(10),c=n(25),u=n(790),d=n(614),f=n(750),p=n(1006),m=n(1173),g=v(n(1193)),y=n(8),h=n(11);function v(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var b=l.Layout.Content,_=l.Layout.Sider,S=(0,o.defineMessages)({switchOrg:{id:"navigator.layout.mainLayout.sideMenu.switchOrg.label",defaultMessage:"Switch Org."},collapse:{id:"navigator.layout.mainLayout.sideMenu.collapse",defaultMessage:"Collapse"}}),E=l.Layout,O=d.Col,w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onCollapse=function(e){(0,n.props.openCloseMenu)({collapsed:e,mode:e?"vertical":"inline"});var t=new Event("redraw");window.dispatchEvent(t)},n.onMenuItemClick=function(){!0===n.props.collapsed&&n.onCollapse(!1)},n.renderTrigger=function(){var e=function(){n.onCollapse(!n.props.collapsed)},t=function(e){return function(){switch(e){case"left":return n.setState({leftColumnSize:20,rightColumnSize:4});case"right":return n.setState({leftColumnSize:4,rightColumnSize:20});default:return n.setState({leftColumnSize:12,rightColumnSize:12})}}};return n.props.showOrgSelector?r.createElement(d.Row,null,r.createElement(O,{span:n.state.leftColumnSize,className:"left",onMouseEnter:t("left"),onMouseLeave:t()},r.createElement(h.Button,{onClick:function(){n.setState({isSelectorOpen:!n.state.isSelectorOpen})},style:{width:"100%"}},r.createElement(r.Fragment,null,r.createElement(s.BarsOutlined,null)," ",n.state.leftColumnSize>12&&!n.props.collapsed&&r.createElement(o.FormattedMessage,S.switchOrg)))),r.createElement(O,{span:n.state.rightColumnSize,className:"right",onMouseEnter:t("right"),onMouseLeave:t()},r.createElement(h.Button,{onClick:e,style:{width:"100%"}},n.props.collapsed?r.createElement(s.RightOutlined,null):r.createElement(r.Fragment,null,r.createElement(s.LeftOutlined,null)," ",n.state.rightColumnSize>12&&r.createElement(o.FormattedMessage,S.collapse))))):r.createElement(d.Row,null,r.createElement(d.Col,{span:24,className:"all"},r.createElement(h.Button,{onClick:e,style:{width:"100%"},onMouseEnter:t("right"),onMouseLeave:t()},n.props.collapsed?r.createElement(s.RightOutlined,null):r.createElement("span",null,r.createElement(s.LeftOutlined,null)," ",r.createElement("span",{className:n.state.rightColumnSize>12?"visible":"hidden"},r.createElement(o.FormattedMessage,S.collapse))))))},n.state={isSelectorOpen:!1,leftColumnSize:12,rightColumnSize:12},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.contentComponent,a=t.actionBarComponent,o=t.organisationSelector,i=t.collapsed,s=t.mode,c=t.orgSelectorSize;return r.createElement("div",{id:"mcs-full-page",className:"mcs-fullscreen"},r.createElement(u.push,{pageWrapId:"mcs-main-layout",outerContainerId:"mcs-full-page",isOpen:this.state.isSelectorOpen,onStateChange:function(t){return e.setState({isSelectorOpen:t.isOpen})},width:c},this.state.isSelectorOpen&&r.createElement(o,{size:c,onItemClick:function(){return e.setState({isSelectorOpen:!1})}})),r.createElement(E,{id:"mcs-main-layout",className:"mcs-fullscreen"},r.createElement(_,{collapsible:!0,collapsed:i,trigger:this.renderTrigger()},r.createElement(m.Logo,{mode:s}),r.createElement(p.NavigatorMenu,{mode:s,onMenuItemClick:this.onMenuItemClick,className:"mcs-mainLayout-menu"})),r.createElement(l.Layout,null,r.createElement(f.NavigatorHeader,null),a?r.createElement(a,null):null,a?r.createElement("div",{className:"ant-layout"},r.createElement(b,{className:"mcs-content-container"},r.createElement(n,null))):r.createElement(n,null))))}}]),t}(r.Component);w.defaultProps={actionBarComponent:null,collapsed:!1,mode:"inline"};var M={openCloseMenu:g.openCloseMenu};t.default=(0,y.compose)(i.withRouter,(0,c.connect)((function(e){return{collapsed:e.menu.collapsed,mode:e.menu.mode}}),M))(w)},,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(25),i=n(33),s=n(10),l=n(6),c=n(67),u=n(2014),d=n(8),f=n(73),p=n(11);function m(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var g=s.Menu.SubMenu,y="/v2/o/:organisationId(\\d+)",h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.checkInitialState=function(e){var t=u.menuDefinitions.filter((function(e){return"multi"===e.type&&e.subMenuItems&&e.subMenuItems.length>0})).find((function(t){return"multi"===t.type&&t.subMenuItems.reduce((function(t,n){return!!(0,i.matchPath)(e,{path:""+y+n.path,exact:!1,strict:!1})||t}),!1)}));t&&n.setState({inlineOpenKeys:[t.iconType]})},n.onOpenChange=function(e){var t=n.state;if("inline"===n.props.mode){var a=e.find((function(e){return!(t.inlineOpenKeys.indexOf(e)>-1)})),r=[];a&&(r=[a]),n.setState({inlineOpenKeys:r})}else n.setState({vecticalOpenKeys:e})},n.onClick=function(e){u.menuDefinitions.find((function(t){return t.iconType===e.key}))&&n.setState({inlineOpenKeys:[]})},n.getAvailableItems=function(){var e=n.props.hasFeature;return u.menuDefinitions.reduce((function(t,n){if(function(t){return"simple"===t.type?e(t.requiredFeature,t.requireDatamart):t.subMenuItems.reduce((function(t,n){return e(n.requiredFeature,n.requireDatamart)?e(n.requiredFeature,n.requireDatamart):t}),!1)}(n)){if("multi"===n.type){var a=(n.subMenuItems||[]).filter((function(t){return e(t.requiredFeature,t.requireDatamart)}));return[].concat(m(t),[Object.assign(Object.assign({},n),{subMenuItems:a})])}return[].concat(m(t),[Object.assign({},n)])}return t}),[])},n.buildItems=function(){var e=n.props,t=e.match.params.organisationId,a=e.defaultDatamart,o="/v2/o/"+t;return n.getAvailableItems().map((function(e){if("multi"===e.type){return r.createElement(g,{key:e.iconType,onTitleClick:function(){n.setState({inlineOpenKeys:[e.iconType]}),n.props.onMenuItemClick()},title:r.createElement("span",null,r.createElement(p.McsIcon,{type:e.iconType}),r.createElement("span",{className:"nav-text"},r.createElement(l.FormattedMessage,e.translation))),className:"mcs-sideBar-subMenu_"+e.translation.id},e.subMenuItems.map((function(e){var n=""+o+e.path;return e.legacyPath&&(n=e.requireDatamart?"/o"+t+"d"+a(t).id+e.path:"/"+t+e.path),r.createElement(s.Menu.Item,{key:e.path,className:"mcs-sideBar-subMenuItem_"+e.translation.id},r.createElement(i.Link,{to:n},r.createElement(l.FormattedMessage,e.translation)))})))}return r.createElement(s.Menu.Item,{key:e.iconType},r.createElement(i.Link,{to:""+o+e.path},r.createElement(p.McsIcon,{type:e.iconType}),r.createElement("span",{className:"nav-text"},r.createElement(l.FormattedMessage,e.translation))))}))},n.getAllKeysWithPath=function(){return n.getAvailableItems().reduce((function(e,t){var n=void 0;return"multi"===t.type?(n=t.subMenuItems.reduce((function(e,n){return[].concat(m(e),[{key:n.path,path:n.path,mainKey:t.iconType}])}),[]),[].concat(m(e),m(n))):[].concat(m(e),[{key:t.iconType,path:t.path,mainKey:t.iconType}])}),[])},n.state={inlineOpenKeys:[],vecticalOpenKeys:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.location.pathname;this.checkInitialState(e)}},{key:"componentDidUpdate",value:function(e){var t=e.location.pathname,n=this.props.location.pathname;n!==t&&this.checkInitialState(n)}},{key:"render",value:function(){var e,t=this,n=this.props,a=n.mode,o=n.location.pathname;return r.createElement(s.Menu,{mode:a,selectedKeys:(e=t.getAllKeysWithPath().find((function(e){return!!(0,i.matchPath)(o,{path:""+y+e.path})})),e?[e.key]:[]),openKeys:"inline"===a?t.state.inlineOpenKeys:t.state.vecticalOpenKeys,onOpenChange:this.onOpenChange,onClick:this.onClick,className:this.props.className},this.buildItems())}}]),t}(r.Component);t.default=(0,d.compose)(i.withRouter,f.injectFeatures,(0,o.connect)((function(e){return{defaultDatamart:(0,c.getDefaultDatamart)(e)}}),{}))(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.menuDefinitions=void 0;var a,r=n(1007),o=n(1096),i=n(1115),s=n(1136),l=n(1146),c=n(1149),u=n(185),d=n(1165),f=(a=d)&&a.__esModule?a:{default:a},p=n(1166);var m={iconType:"users",translation:f.default.audienceTitle,type:"multi",subMenuItems:[Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(i.audienceDefinition.audienceHome)),{translation:f.default.audienceHome}),Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(i.audienceDefinition.audienceSegmentList)),{translation:f.default.audienceSegment}),Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(i.audienceDefinition.audienceFeedOverview)),{translation:f.default.audienceFeeds}),Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(i.audienceDefinition.audienceSegmentBuilder)),{translation:f.default.audienceSegmentBuilder}),Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(i.audienceDefinition.audienceSegmentBuilderV2)),{translation:f.default.audienceSegmentBuilderV2}),Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(i.audienceDefinition.audienceTimelineHome)),{translation:f.default.audienceMonitoring})]},g={iconType:"display",translation:f.default.campaignTitle,type:"multi",subMenuItems:[Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(r.campaignsDefinition.campaignDisplayList)),{translation:f.default.campaignDisplay}),Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(r.campaignsDefinition.campaignEmailList)),{translation:f.default.campaignEmail}),Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(r.campaignsDefinition.campaignGoalList)),{translation:f.default.campaignGoals})]},y={iconType:"automation",translation:f.default.automationTitle,type:"multi",subMenuItems:[Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(o.automationDefinition.automationsList)),{translation:f.default.automationList}),Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(o.automationDefinition.automationBuilder)),{translation:f.default.automationBuilder})]},h={iconType:"creative",translation:f.default.creativesTitle,type:"multi",subMenuItems:[Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(s.creativesDefinition.creativeDisplayList)),{translation:f.default.creativesDisplay}),Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(s.creativesDefinition.creativeNativeList)),{translation:f.default.creativesNative}),Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(s.creativesDefinition.creativeEmailList)),{translation:f.default.creativesEmails})]},v={iconType:"library",translation:f.default.libraryTitle,type:"multi",subMenuItems:[{path:"/library/adlayouts",requiredFeature:"library.ad_layouts",translation:f.default.libraryAdLayouts,legacyPath:!0},{requiredFeature:"library.stylesheets",path:"/library/stylesheets",translation:f.default.libraryStylesheets,legacyPath:!0},Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(l.libraryDefinition.libraryDealList)),{translation:f.default.libraryDealList}),Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(l.libraryDefinition.libraryAssetList)),{translation:f.default.libraryAssets})]},b={iconType:"data",translation:f.default.dataStudioTitle,type:"multi",subMenuItems:[Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(c.datastudioDefinition.datastudioQueryTool)),{translation:f.default.dataStudioQuery}),Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(c.datastudioDefinition.datastudioFunnel)),{translation:f.default.dataStudioFunnel}),Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(c.datastudioDefinition.datastudioReport)),{translation:f.default.dataStudioReport}),Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(c.datastudioDefinition.datastudioExportList)),{translation:f.default.libraryExports}),Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(c.datastudioDefinition.datastudioImportList)),{translation:f.default.libraryImports})]},_={iconType:"warning",translation:f.default.marketplaceTitle,type:"multi",subMenuItems:[Object.assign(Object.assign({},(0,u.generateMissingdefinitionItemFromRoute)(p.marketplaceDefinition.marketplaceOfferCatalogList)),{translation:f.default.marketplaceOfferCatalog})]};t.menuDefinitions=[m,g,y,h,v,b,_]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DisplayCampaignsPage=t.DisplayCampaignsTable=t.DisplayCampaignsActionbar=void 0;var a=i(n(1008)),r=i(n(1016)),o=i(n(2033));function i(e){return e&&e.__esModule?e:{default:e}}t.DisplayCampaignsActionbar=a.default,t.DisplayCampaignsTable=r.default,t.DisplayCampaignsPage=o.default},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({from:{id:"date.from",defaultMessage:"From"},to:{id:"date.to",defaultMessage:"To"},hour:{id:"date.hour",defaultMessage:"Hour"},day:{id:"date.day",defaultMessage:"Day"},month:{id:"date.month",defaultMessage:"Month"},year:{id:"date.year",defaultMessage:"Year"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(41),s=n(10),l=f(n(47)),c=f(n(335)),u=f(n(798)),d=n(11);function f(e){return e&&e.__esModule?e:{default:e}}var p=s.Input.Search,m=d.MultiSelect,g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getHideableColumns=function(){var e=n.props.columns;return e?e.filter((function(e){return e.isHideable})):[]},n.changeColumnVisibility=function(e){n.setState({visibilitySelectedColumns:e})},n.state={visibilitySelectedColumns:n.props.columns.filter((function(e){return e.isHideable&&e.isVisibleByDefault})).map((function(e){return{key:e.key,value:e.key}}))},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.searchOptions,n=e.dateRangePickerOptions,r=e.filtersOptions,f=e.columnsVisibilityOptions,g=e.labelsOptions,y=e.treeSelectFilter,h=e.relatedTable,v=t?o.createElement(p,a({className:"mcs-search-input"},t)):null,b=n?o.createElement(d.McsDateRangePicker,{values:n.values,format:n.format,onChange:n.onChange}):null,_=r?r.map((function(e){return o.createElement(d.MultiSelect,a({},e,{key:(0,l.default)(),buttonClass:"mcs-table-filters-item"}))})):null,S=function(e){return e.key},E=f.isEnabled?o.createElement(m,{displayElement:o.createElement(i.LayoutOutlined,null),items:this.getHideableColumns(),getKey:S,display:S,selectedItems:this.state.visibilitySelectedColumns,handleMenuClick:this.changeColumnVisibility,buttonClass:"mcs-table-filters-item"}):null;return o.createElement("div",null,o.createElement(s.Row,{className:"mcs-table-header"},o.createElement(s.Col,{span:6},v),o.createElement(s.Col,{span:18,className:"text-right"},b,y?y():null,_,E)),g?o.createElement(s.Row,{className:"mcs-table-labels"},o.createElement(u.default,g)):null,!!h&&h,o.createElement(s.Row,{className:"mcs-table-body"},o.createElement(s.Col,{span:24},o.createElement(c.default,a({},this.props,{visibilitySelectedColumns:this.state.visibilitySelectedColumns})))))}}]),t}(o.Component);g.defaultProps={columnsVisibilityOptions:{isEnabled:!1}},t.default=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(10),s=n(11);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=function(e){function t(){return l(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.rowSelection,n=e.pagination,a=r.createElement("span",null);t&&t.selectedRowKeys&&n&&(a=t.allRowsAreSelected||t.selectedRowKeys.length===n.total?r.createElement("div",null,r.createElement(o.FormattedMessage,{id:"components.tableview.selectionNotifier.allRowsSelected",defaultMessage:"All the {paginationTotal} items of this list have been selected. ",values:{paginationTotal:n.total}}),r.createElement(s.Button,{onClick:t.unselectAllItemIds,className:"selected-rows-btn"},r.createElement(o.FormattedMessage,{id:"components.tableview.selectionNotifier.unselectAll",defaultMessage:"Click here to unselect all the items."}))):t.selectedRowKeys.length===n.pageSize?r.createElement("div",null,r.createElement(o.FormattedMessage,{id:"components.tableview.selectionNotifier.allPageRowsSelected",defaultMessage:"You have selected {paginationPageSize} items. ",values:{paginationPageSize:n.pageSize}}),r.createElement(s.Button,{onClick:function(){t&&t.selectAllItemIds&&t.selectAllItemIds()},className:"selected-rows-btn"},r.createElement(o.FormattedMessage,{id:"components.tableview.selectionNotifier.selectAll",defaultMessage:"Click here to select all the items."}))):r.createElement("div",null,r.createElement(o.FormattedMessage,{id:"components.tableview.selectionNotifier.selectedRows",defaultMessage:"You have selected {selectedRowKeysLength}\n              { selectedRowKeysLength, plural, zero {item} one {item} other {items} }.",values:{selectedRowKeysLength:t.selectedRowKeys.length}})));var l=r.createElement(i.Alert,{message:a,type:"warning",className:"selected-rows-alert"}),c=!!(t&&t.selectedRowKeys&&n&&0!==t.selectedRowKeys.length);return t&&t.selectedRowKeys?r.createElement(s.Slide,{toShow:c,content:l}):null}}]),t}(r.Component);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=l(n(60)),s=l(n(101));function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},f=function(e){function t(){return c(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.scrollId,n=e.items,a=e.children,l=d(e,["scrollId","items","children"]),c=n&&n.length&&r.createElement(s.default,{items:n,scrollId:t||l.formId});return r.createElement(o.Layout,{className:"edit-layout"},r.createElement(i.default,l),r.createElement(o.Layout,null,c,r.createElement(o.Layout,null,a)))}}]),t}(r.Component);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(799);var o=((a=r)&&a.__esModule?a:{default:a}).default;t.default=o},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(6),l=n(24),c=n(11),u=n(60),d=(a=u)&&a.__esModule?a:{default:a},f=n(51);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=(0,s.defineMessages)({title:{id:"audience.partitions.selector.title",defaultMessage:"Partitions"},subTitle:{id:"audience.partitions.selector.subtitle",defaultMessage:"Choose your partition"},noName:{id:"audience.partitions.selector.noName",defaultMessage:"No name"}}),y=function(e){function t(){return p(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.partitions,n=e.isLoading,a=e.onSelect,r=e.actionbarProps,u=e.intl;return n?o.createElement(f.Loading,{isFullScreen:!0}):o.createElement(i.Layout,null,o.createElement(d.default,r),o.createElement(i.Layout.Content,{className:"mcs-content-container mcs-form-container text-center"},o.createElement(l.FormTitle,{title:g.title,subtitle:g.subTitle}),o.createElement(i.Row,{className:"mcs-selector_container"},o.createElement(i.Row,{className:"menu"},0===t.length?o.createElement(s.FormattedMessage,{id:"audience.segments.experimentation.form.noPartition",defaultMessage:"You need a partition to create a Experimentation, please contact your support to create one."}):t.map((function(e){var t=e.name||u.formatMessage(g.noName);return o.createElement(c.MenuList,{key:e.id,title:t+" (Type: "+e.type+", Count: "+e.part_count+")",select:function(){return a(e)}})}))))))}}]),t}(o.Component);t.default=(0,s.injectIntl)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n(2029),n(613);var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=f(n(270)),l=n(15),c=n(12),u=f(n(1014)),d=n(2031);function f(e){return e&&e.__esModule?e:{default:e}}var p=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.aceEditor=null,n.findCompleters=function(e,t,a){return n._queryService.autocompleteOtqlQuery(n.props.datamartId,e,t,a)},n.onChange=function(e,t){var a=n.aceEditor.editor;n.props.onChange&&n.props.onChange(e,t),n.debouncing&&window.clearTimeout(n.debouncing),n.debouncing=setTimeout((function(){n._queryService.checkOtqlQuery(n.props.datamartId,e).then((function(e){return e.data})).then((function(e){if("error"===e.status){var t={row:e.error.position.row-1,column:e.error.position.col-1,text:e.error.message,type:"error"};a.getSession().setAnnotations([t]),n.setState({annotations:[t]})}else n.setState({annotations:[]})})).catch((function(){return n.setState({annotations:[]})}))}),1e3)},n.buildCustomCompleters=function(){return{identifierRegexps:[/[\@a-zA-Z_0-9]/],getCompletions:function(e,t,a,r,o){n.findCompleters(e.getValue(),a.row+1,a.column+1).then((function(e){var t=e?e.map((function(e){return{name:e.field_name,value:e.field_name,meta:e.type}})):[];o(null,[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t),[{name:"SELECT",value:"SELECT",score:3,meta:"keyword"},{name:"FROM",value:"FROM",score:3,meta:"keyword"},{name:"WHERE",value:"WHERE",score:3,meta:"keyword"},{name:"LIMIT",value:"LIMIT",score:3,meta:"keyword"}]))}))}}},n.state={annotations:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){if((0,d.defineAce)(),this.aceEditor&&this.aceEditor.editor){this.aceEditor.editor.completers=[this.buildCustomCompleters()];var e=new u.default;this.aceEditor.editor.getSession().setMode(e)}}},{key:"render",value:function(){var e=this;return(0,d.defineAce)(),i.createElement("div",null,i.createElement(s.default,a({},this.props,{onChange:this.onChange,annotations:this.state.annotations,mode:"otql",theme:"otql",ref:function(t){return e.aceEditor=t},width:"100%",setOptions:{showGutter:!0}})))}}]),t}(i.Component);t.default=m,p([(0,l.lazyInject)(c.TYPES.IQueryService)],m.prototype,"_queryService",void 0)},,,function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.defineAce=function(){for(var t=e.document.getElementsByClassName("mcs-colors")[0].children,n={},a=0;a<t.length;a+=1){var r=t[a];n[r.className]=e.window.getComputedStyle(r)["background-color"]}var o=n["mcs-success"]?n["mcs-success"]:"#00ab67",i=n["mcs-info"]?n["mcs-info"]:"#00a1df",s=n["mcs-highlight"]?n["mcs-highlight"]:"#862F2F",l=n["mcs-warning"]?n["mcs-warning"]:"#862F2F",c=i,u=o,d=i,f=l,p=s,m=i,g=o;ace.define("ace/theme/otql",["require","exports","module","ace/lib/dom"],(function(e,t,n){t.isDark=!1,t.cssClass="ace-otql",t.cssText="        .ace-otql .ace_gutter {        background: #e8e8e8;        color: #AAA;        }        .ace-otql  {        background: #fff;        color: #000;        }        .ace-otql .ace_keyword {        font-weight: bold;        color: "+d+";        }        .ace-otql .ace_keyword.ace_operator {        font-weight: bold;        color: "+f+";        }        .ace-otql .ace_string {        color:  #D14;        }        .ace-otql .ace_variable.ace_class {        color: "+u+";        }        .ace-otql .ace_constant.ace_numeric {        color: #099        }        .ace-otql .ace_constant.ace_buildin {        color: "+c+";        }        .ace-otql .ace_support.ace_function {        color: "+p+";        }        .ace-otql .ace_comment {        color: #998;        font-style: italic;        }        .ace-otql .ace_variable.ace_language  {        color: "+m+";        }        .ace-otql .ace_paren {        font-weight: bold;        }        .ace-otql .ace_boolean {        font-weight: bold;        }        .ace-otql .ace_string.ace_regexp {        color: #009926;        font-weight: normal;        }        .ace-otql .ace_variable.ace_instance {        color: "+g+';        }        .ace-otql .ace_constant.ace_language {        font-weight: bold;        }        .ace-otql .ace_cursor {        color: black;        }        .ace-otql.ace_focus .ace_marker-layer .ace_active-line {        background: rgb(255, 255, 204);        }        .ace-otql .ace_marker-layer .ace_active-line {        background: rgb(245, 245, 245);        }        .ace-otql .ace_marker-layer .ace_selection {        background: rgb(181, 213, 255);        }        .ace-otql.ace_multiselect .ace_selection.ace_start {        box-shadow: 0 0 3px 0px white;        }        .ace-otql.ace_nobold .ace_line > span {        font-weight: normal !important;        }        .ace-otql .ace_marker-layer .ace_step {        background: rgb(252, 255, 0);        }        .ace-otql .ace_marker-layer .ace_stack {        background: rgb(164, 229, 101);        }        .ace-otql .ace_marker-layer .ace_bracket {        margin: -1px 0 0 -1px;        border: 1px solid rgb(192, 192, 192);        }        .ace-otql .ace_gutter-active-line {        background-color : rgba(0, 0, 0, 0.07);        }        .ace-otql .ace_marker-layer .ace_selected-word {        background: rgb(250, 250, 255);        border: 1px solid rgb(200, 200, 250);        }        .ace-otql .ace_invisible {        color: #BFBFBF        }        .ace-otql .ace_print-margin {        width: 1px;        background: #e8e8e8;        }        .ace-otql .ace_indent-guide {        background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;        }',e("../lib/dom").importCssString(t.cssText,t.cssClass)}))}}).call(this,n(71))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({filterByLabel:{id:"campaign.display.filterbylabel",defaultMessage:"Filter By Label"},pauseCampaigns:{id:"display.campaigns.pause",defaultMessage:"Pause"},activateCampaigns:{id:"display.campaigns.activate",defaultMessage:"Activate"},archiveCampaignsModalTitle:{id:"display.campaigns.archive.title",defaultMessage:"Archive Campaigns"},archiveCampaignsModalMessage:{id:"display.campaigns.archive",defaultMessage:"Are you sure to archive all the selected campaigns ?"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(13),l=n(10),c=n(8),u=n(25),d=T(n(1008)),f=T(n(1016)),p=n(61),m=T(n(2034)),g=n(30),y=n(800),h=n(152),v=T(n(23)),b=n(112),_=n(12),S=n(15),E=n(44),O=n(83),w=T(n(78)),M=n(56),P=n(41);function T(e){return e&&e.__esModule?e:{default:e}}var I=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},A=l.Layout.Content,C=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._isMounted=!1,n.loadDisplayCampaignsDataSource=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n.setState({isLoadingCampaigns:!0,isLoadingStats:!0});var r="DISPLAY",o=Object.assign({archived:t.statuses.includes("ARCHIVED")},(0,E.getPaginatedApiParam)(t.currentPage,t.pageSize));t.label_id.length&&(o.label_id=t.label_id);var i=t.statuses.filter((function(e){return"ARCHIVED"!==e}));t.keywords&&(o.keywords=t.keywords),i.length>0&&(o.status=i),n._displayCampaignService.getDisplayCampaigns(e,r,o).then((function(r){var o=r.data,i=(0,O.normalizeArrayOfObject)(o,"id");n.setState({dataSource:Object.keys(i).map((function(e){return Object.assign({},i[e])})),isLoadingCampaigns:!1,totalCampaigns:r.total||0,hasCampaigns:!a||0!==r.count}),w.default.getDisplayCampaignPerformanceReport(e,t.from,t.to,["campaign_id"]).then((function(e){var t=(0,O.normalizeArrayOfObject)((0,M.normalizeReportView)(e.data.report_view),"campaign_id");n.setState({isLoadingStats:!1,dataSource:Object.keys(i).map((function(e){return Object.assign(Object.assign({},t[e]),i[e])}))})})).catch((function(e){n.setState({isLoadingStats:!1}),n.props.notifyError(e,{intlMessage:h.messages.fetchReportError})}))}))},n.showModal=function(){n.setState({visible:!0})},n.getAllCampaignsIds=function(){var e=n.props,t=e.match.params.organisationId,a=e.notifyError,r={max_results:n.state.totalCampaigns,automated:!1,archived:!1};return n._displayCampaignService.getDisplayCampaigns(t,"DISPLAY",r).then((function(e){return e.data.map((function(e){return e.id}))})).catch((function(e){a(e)}))},n.redirectAndNotify=function(){var e=n.props,t=e.location,a=t.search,r=t.pathname,o=t.state,i=e.history,s=e.intl,c=e.match.params.organisationId,u=n.state.dataSource,d=(0,g.parseSearch)(a,y.DISPLAY_SEARCH_SETTINGS);if(1===u.length&&1!==d.currentPage){var f=Object.assign(Object.assign({},d),{currentPage:d.currentPage-1});n.loadDisplayCampaignsDataSource(c,d),i.replace({pathname:r,search:(0,g.updateSearch)(a,f),state:o})}else n.loadDisplayCampaignsDataSource(c,d);n.setState({visible:!1,selectedRowKeys:[]}),l.message.success(s.formatMessage(h.messages.campaignsArchived))},n.archiveCampaigns=function(e){n.setState({isArchiving:!0});var t=[];e.forEach((function(e){t.push((function(){return n._displayCampaignService.updateCampaign(e,{status:"PAUSED",archived:!0,type:"DISPLAY"})}))})),(0,b.executeTasksInSequence)(t).then((function(){n.redirectAndNotify(),n.setState({isArchiving:!1})})).catch((function(e){n.props.notifyError(e),n.setState({isArchiving:!1})}))},n.archiveCampaign=function(e){var t=n.props,a=t.match.params.organisationId,r=t.location,i=r.pathname,s=r.state,c=r.search,u=t.history,d=t.intl,f=n.state.dataSource,p=(0,g.parseSearch)(c,y.DISPLAY_SEARCH_SETTINGS),m=function(){n.loadDisplayCampaignsDataSource(a,p)};l.Modal.confirm({title:d.formatMessage(h.messages.confirmArchiveModalTitle),content:d.formatMessage(h.messages.confirmArchiveModalContent),icon:o.createElement(P.ExclamationCircleOutlined,null),okText:d.formatMessage(h.messages.confirmArchiveModalOk),cancelText:d.formatMessage(h.messages.confirmArchiveModalCancel),onOk:function(){return n._displayCampaignService.deleteCampaign(e.id).then((function(){if(1===f.length&&1!==p.currentPage){var e=Object.assign(Object.assign({},p),{currentPage:p.currentPage-1});m(),u.replace({pathname:i,search:(0,g.updateSearch)(c,e),state:s})}else m()}))},onCancel:function(){}})},n.handleOk=function(){var e=n.state,t=e.selectedRowKeys;return e.allRowsAreSelected?n.getAllCampaignsIds().then((function(e){n.archiveCampaigns(e)})):n.archiveCampaigns(t)},n.handleCancel=function(){n.setState({visible:!1})},n.makeEditAction=function(e,t){var a=n.props,r=a.notifyError,o=a.intl;return n._displayCampaignFormService.saveCampaigns(e,t).then((function(){n.props.closeNextDrawer(),n.setState({selectedRowKeys:[]}),l.message.success(o.formatMessage(h.messages.campaignsSaved))})).catch((function(e){n.props.closeNextDrawer(),n.setState({selectedRowKeys:[]}),r(e)}))},n.editCampaigns=function(e){var t=n.state,a=t.selectedRowKeys;return t.allRowsAreSelected?n.getAllCampaignsIds().then((function(t){n.makeEditAction(t,e)})):n.makeEditAction(a,e)},n.openEditCampaignsDrawer=function(){var e=n.state.allRowsAreSelected,t={close:n.props.closeNextDrawer,onSave:n.editCampaigns};t.selectedRowKeys=e?void 0:n.state.selectedRowKeys;var a={additionalProps:t};n.props.openNextDrawer(m.default,a)},n.updateCampaignStatus=function(e,t,a,r,i){n.setState({isUpdatingStatuses:!0});var s=n.props,c=s.notifySuccess,u=s.notifyError,d=s.removeNotification,f=Object.assign({},t),p=Object.assign({},i);return n._displayCampaignService.updateCampaign(e,f).then((function(t){if(a){c({uid:e,message:a.title,description:a.body,btn:o.createElement(l.Button,{type:"primary",size:"small",onClick:function(){n._displayCampaignService.updateCampaign(e,p).then((function(){d(e)}))}},o.createElement("span",null,"Undo"))})}return n.setState({isUpdatingStatuses:!1,selectedRowKeys:[]}),null})).catch((function(e){u(e),n.setState({isUpdatingStatuses:!1,selectedRowKeys:[]})}))},n.onSelectChange=function(e){n.setState({selectedRowKeys:e})},n.selectAllItemIds=function(){n.setState({allRowsAreSelected:!0})},n.unselectAllItemIds=function(){n.setState({selectedRowKeys:[],allRowsAreSelected:!1})},n.unsetAllItemsSelectedFlag=function(){n.setState({allRowsAreSelected:!1})},n.handleStatusAction=function(e){var t=n.props,a=t.match.params.organisationId,r=t.location.search,o=n.state,i=o.allRowsAreSelected,s=o.selectedRowKeys,l=o.totalCampaigns;n.setState({isUpdatingStatuses:!0});var c=[];if(i){var u={max_results:l,archived:!1},d=[];n._displayCampaignService.getDisplayCampaigns(a,"DISPLAY",u).then((function(e){e.data.forEach((function(e,t){d.push(e.id)})),c=d}))}else s&&(c=s);var f=[];c.forEach((function(t){f.push((function(){return n.updateCampaignStatus(t,{status:e})}))})),(0,b.executeTasksInSequence)(f).then((function(){n.setState({isUpdatingStatuses:!1},(function(){var e=(0,g.parseSearch)(r,y.DISPLAY_SEARCH_SETTINGS);n.loadDisplayCampaignsDataSource(a,e)}))})).catch((function(e){n.setState({isUpdatingStatuses:!1}),n.props.notifyError(e)}))},n.state={selectedRowKeys:[],allRowsAreSelected:!1,visible:!1,isUpdatingStatuses:!1,isArchiving:!1,isLoadingCampaigns:!1,isLoadingStats:!1,dataSource:[],totalCampaigns:0,hasCampaigns:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.history,n=e.location,a=n.search,r=n.pathname,o=e.match.params.organisationId;if(this._isMounted=!0,(0,g.isSearchValid)(a,y.DISPLAY_SEARCH_SETTINGS)){var i=(0,g.parseSearch)(a,y.DISPLAY_SEARCH_SETTINGS);this.loadDisplayCampaignsDataSource(o,i,!0)}else t.replace({pathname:r,search:(0,g.buildDefaultSearch)(a,y.DISPLAY_SEARCH_SETTINGS),state:{reloadDataSource:!0}})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.location,a=n.pathname,r=n.search,o=t.match.params.organisationId,i=t.history,s=e.location.search,l=e.match.params.organisationId;if(!(0,g.compareSearches)(r,s)||o!==l)if((0,g.isSearchValid)(r,y.DISPLAY_SEARCH_SETTINGS)){var c=(0,g.parseSearch)(r,y.DISPLAY_SEARCH_SETTINGS);this.loadDisplayCampaignsDataSource(o,c)}else i.replace({pathname:a,search:(0,g.buildDefaultSearch)(r,y.DISPLAY_SEARCH_SETTINGS),state:{reloadDataSource:o!==l}})}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this.props.labels,t=this.state,n=t.selectedRowKeys,a=t.isUpdatingStatuses,r=t.allRowsAreSelected,i=t.dataSource,s=t.hasCampaigns,l=t.isLoadingCampaigns,c=t.isLoadingStats,u=t.totalCampaigns,p={selectedRowKeys:n,allRowsAreSelected:r,onChange:this.onSelectChange,selectAllItemIds:this.selectAllItemIds,unselectAllItemIds:this.unselectAllItemIds,onSelectAll:this.unsetAllItemsSelectedFlag,onSelect:this.unsetAllItemsSelectedFlag},m={archiveCampaigns:this.showModal,visible:this.state.visible,handleOk:this.handleOk,handleCancel:this.handleCancel,openEditCampaignsDrawer:this.openEditCampaignsDrawer,isArchiving:this.state.isArchiving,handleStatusAction:this.handleStatusAction};return o.createElement("div",{className:"ant-layout"},o.createElement(d.default,{rowSelection:p,multiEditProps:m}),o.createElement("div",{className:"ant-layout"},o.createElement(A,{className:"mcs-content-container"},o.createElement(f.default,{dataSource:i,archiveCampaign:this.archiveCampaign,rowSelection:p,hasCampaigns:s,isFetchingCampaigns:l,isFetchingStats:c,totalCampaigns:u,isUpdatingStatuses:a,labels:e}))))}}]),t}(o.Component);I([(0,S.lazyInject)(_.TYPES.IDisplayCampaignFormService)],C.prototype,"_displayCampaignFormService",void 0),I([(0,S.lazyInject)(_.TYPES.IDisplayCampaignService)],C.prototype,"_displayCampaignService",void 0);t.default=(0,c.compose)(s.withRouter,i.injectIntl,p.injectDrawer,(0,u.connect)((function(e){return{labels:e.labels.labelsApi.data}}),void 0),v.default)(C)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(35),l=n(6),c=n(8),u=v(n(2035)),d=v(n(60)),f=v(n(95)),p=n(24),m=v(n(23)),g=n(15),y=n(12),h=n(11);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_="editCampaignsForm",S=(0,l.defineMessages)({allCampaignsNames:{id:"display.campaigns.multiEdit.allCampaignsSelected",defaultMessage:"You have selected all the campaigns."},oldCampaignsNames:{id:"display.campaigns.multiEdit.oldCampaignsSelected",defaultMessage:"It is not recommended to edit these campaigns because they are deprecated :"}}),E=s.FieldArray,O=i.Layout.Content,w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchData=function(e){var t=[];Promise.all(e.map((function(e){return n._displayCampaignService.getCampaignDisplay(e).then((function(e){return e.data})).then((function(e){return"V2014_06"===e.model_version&&t.push(e.name),e.name||""}))}))).then((function(e){n.setState({campaignNames:e,v2014CampaignNames:t})}))},n.save=function(e){n.setState({loading:!0}),n.props.onSave(e).then((function(){n.setState({loading:!1})})).catch((function(e){n.props.notifyError(e),n.setState({loading:!1})}))},n.state={campaignNames:[],loading:!1,v2014CampaignNames:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.selectedRowKeys,n=e.intl;t?this.fetchData(t):this.setState({campaignNames:[n.formatMessage(S.allCampaignsNames)]})}},{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.close,a=e.intl.formatMessage,r=this.state,c=r.loading,m=r.campaignNames,g=r.v2014CampaignNames,y={formId:_,paths:[{name:a(f.default.editCampaigns)}],message:f.default.saveCampaigns,onClose:n};return c?o.createElement(h.Loading,{isFullScreen:!0}):o.createElement(i.Layout,{className:"edit-layout"},o.createElement(d.default,y),o.createElement(i.Layout,{className:"ant-layout-has-sider"},o.createElement(s.Form,{className:"edit-layout ant-layout edit-campaigns-form",onSubmit:t(this.save)},o.createElement(O,{id:_,className:"mcs-content-container mcs-form-container"},o.createElement(p.FormSection,{subtitle:f.default.multiEditSubtitle,title:f.default.multiEditTitle}),o.createElement(i.Row,{style:{marginBottom:"1em"}},m.map((function(e,t){return o.createElement(i.Tag,{key:t},e)}))),o.createElement(i.Row,{style:{marginBottom:"3em"}},g.length>0&&o.createElement("div",null,o.createElement("br",null),o.createElement(l.FormattedMessage,S.oldCampaignsNames),o.createElement("br",null),g.map((function(e,t){return o.createElement(i.Tag,{key:t},e)})))),o.createElement(i.Row,null,o.createElement(E,{name:"fields",component:u.default,rerenderOnEveryChange:!0}))))))}}]),t}(o.Component);b([(0,g.lazyInject)(y.TYPES.IDisplayCampaignService)],w.prototype,"_displayCampaignService",void 0),t.default=(0,c.compose)((0,s.reduxForm)({form:_,enableReinitialize:!0}),l.injectIntl,m.default)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(8),l=n(6),c=n(24),u=n(49),d=(a=u)&&a.__esModule?a:{default:a},f=n(11);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=["total_impression_capping","per_day_impression_capping","total_budget","max_budget_per_period"],y=function(e){function t(){p(this,t);var e=m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.getAvailableOptions=function(){var t=e.props,n=t.fields,a=t.intl,r=n.getAll()?n.getAll().map((function(e){return e.campaignProperty})):[];return g.map((function(e){return{title:a.formatMessage(h[e]),value:e,disabled:r.includes(e)}}))},e.attachToDOM=function(e){return function(t){return document.getElementById(e)}},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.props.fields.push({campaignProperty:this.getAvailableOptions()[0].value,action:"equals"})}},{key:"render",value:function(){var e=this,t=this.props,n=t.fields,a=t.fieldValidators,r=a.isRequired,s=a.isValidInteger,l=a.isNotZero,u=a.isValidFloat,d=t.intl,p=[{title:d.formatMessage(v.equals),value:"equals"},{title:d.formatMessage(v.increase),value:"increase"},{title:d.formatMessage(v.decrease),value:"decrease"}];return o.createElement("div",{style:{width:"70%",margin:"auto"}},o.createElement(i.Row,{style:{display:"block"}},n.map((function(t,a){var d=[];switch(n.get(a).campaignProperty){case"total_impression_capping":case"per_day_impression_capping":d=[r,s];break;case"total_budget":case"max_budget_per_period":d=[r,u,l]}return o.createElement(i.Row,{key:a,gutter:16},o.createElement(i.Col,{className:"gutter-row",span:7},o.createElement(c.FormSelectField,{name:t+".campaignProperty",component:c.DefaultSelect,options:e.getAvailableOptions(),formItemProps:{label:"Field",labelCol:{span:4},wrapperCol:{span:20}}})),o.createElement(i.Col,{className:"gutter-row",span:7},o.createElement(c.FormSelectField,{name:t+".action",component:c.DefaultSelect,formItemProps:{label:"Action",labelCol:{span:4},wrapperCol:{span:20}},options:p})),o.createElement(i.Col,{className:"gutter-row",span:7},o.createElement(c.FormInputField,{name:t+".value",component:c.FormInput,validate:d,formItemProps:{label:"Value",labelCol:{span:4},wrapperCol:{span:20}},inputProps:{}})),o.createElement(i.Col,{className:"gutter-row",span:3},o.createElement(i.Button,{className:"delete-fieldarray",onClick:function(){return n.remove(a)}},o.createElement(f.McsIcon,{type:"close"}))))}))),n.getAll()&&n.getAll().length<=g.length-1&&o.createElement(i.Row,{style:{display:"block"}},o.createElement("div",{onClick:function(){var t=e.getAvailableOptions().filter((function(e){return!e.disabled}));n.push({campaignProperty:t[0].value,action:"equals"})}},o.createElement(i.Col,{span:22,offset:1,className:"gutter-row add-field-button"},o.createElement("p",null,o.createElement(f.McsIcon,{type:"plus"}),"Add Field")))))}}]),t}(o.Component);t.default=(0,s.compose)(l.injectIntl,d.default)(y);var h=(0,l.defineMessages)({total_impression_capping:{id:"display.campaigns.multiEdit.option.totalImpressionCapping",defaultMessage:"Total Impression Capping"},per_day_impression_capping:{id:"display.campaigns.multiEdit.option.dailyImpressionCapping",defaultMessage:"Daily Impression Capping"},total_budget:{id:"display.campaigns.multiEdit.option.totalBudget",defaultMessage:"Total Budget"},max_budget_per_period:{id:"display.campaigns.multiEdit.option.budgetSplit",defaultMessage:"Budget Split"}}),v=(0,l.defineMessages)({equals:{id:"display.campaigns.multiEdit.option.equals",defaultMessage:"="},increase:{id:"display.campaigns.multiEdit.option.increase",defaultMessage:"Increase %"},decrease:{id:"display.campaigns.multiEdit.option.decrease",defaultMessage:"Decrease %"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdGroupPage=t.DisplayCampaignPage=void 0;var a=o(n(2037)),r=o(n(2063));function o(e){return e&&e.__esModule?e:{default:e}}t.DisplayCampaignPage=a.default,t.AdGroupPage=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(8),l=m(n(23)),c=m(n(2038)),u=m(n(2059)),d=n(51),f=n(15),p=n(12);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchAllData=function(e){return n._displayCampaignService.getCampaignDisplayViewDeep(e,{view:"deep"}).then((function(e){n.setState({campaign:e.data,loading:!1})})).catch((function(e){return n.props.notifyError(e)}))},n.state={loading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params.campaignId;this.fetchAllData(e)}},{key:"componentDidUpdate",value:function(e){var t=this.props.match.params.campaignId;t!==e.match.params.campaignId&&this.fetchAllData(t)}},{key:"render",value:function(){if(this.state.loading||!this.state.campaign)return o.createElement(d.Loading,{isFullScreen:!0});switch(this.state.campaign.subtype){case"PROGRAMMATIC":case"TRACKING":return o.createElement(c.default,null);case"AD_SERVING":return o.createElement(u.default,{campaign:this.state.campaign})}}}]),t}(o.Component);g([(0,f.lazyInject)(p.TYPES.IDisplayCampaignService)],y.prototype,"_displayCampaignService",void 0),t.default=(0,s.compose)(i.withRouter,l.default)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(33),s=n(8),l=n(10),c=n(181),u=S(n(2039)),d=S(n(78)),f=n(83),p=n(56),m=n(44),g=S(n(59)),y=n(30),h=S(n(23)),v=n(803),b=n(15),_=n(12);function S(e){return e&&e.__esModule?e:{default:e}}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.cancelablePromises=[],n.fetchAllData=function(e,t,a){var r=a.to.toMoment().unix()-a.from.toMoment().unix()>172800?["day"]:["day,hour_of_day"],o=(0,m.makeCancelable)(d.default.getSingleDisplayDeliveryReport(e,t,a.from,a.to,r)),i=(0,m.makeCancelable)(d.default.getSingleDisplayDeliveryReport(e,t,a.from,a.to,void 0,["cpa","cpm","ctr","cpc","impressions_cost"])),s=(0,m.makeCancelable)(d.default.getAdGroupDeliveryReport(e,"campaign_id",t,a.from,a.to,void 0)),l=(0,m.makeCancelable)(d.default.getAdDeliveryReport(e,"campaign_id",t,a.from,a.to,void 0)),c=(0,m.makeCancelable)(d.default.getMediaDeliveryReport(e,"campaign_id",t,a.from,a.to,void 0,void 0,{sort:"-clicks",limit:30}));n.cancelablePromises.push(o,c,l,s,i,i),n.setState((function(e){var t=Object.assign({},e);return t.campaign.data.isLoading=!0,t.adGroups.data.isLoading=!0,t.ads.data.isLoading=!0,t.campaign.performance.isLoading=!0,t.campaign.mediaPerformance.isLoading=!0,t.campaign.overallPerformance.isLoading=!0,t.adGroups.performance.isLoading=!0,t.ads.performance.isLoading=!0,t.goals.isLoading=!0,t})),n._displayCampaignService.getCampaignDisplayViewDeep(t,{view:"deep"}).then((function(e){var t=e.data,a=t.ad_groups,r=O(t,["ad_groups"]),o=a.map((function(e){e.ads;return O(e,["ads"])})),i=a.map((function(e){return{ad_group_id:e.id,campaign_id:r.id}})),s=[],l=[];a.forEach((function(e){e.ads.forEach((function(t){s.push(t),l.push({ad_id:t.id,ad_group_id:e.id,campaign_id:r.id})}))})),n.setState((function(e){var t=Object.assign({},e);return t.campaign.data.isLoading=!1,t.adGroups.data.isLoading=!1,t.ads.data.isLoading=!1,t.campaign.data.items=[r],t.adGroups.data.items=(0,f.normalizeArrayOfObject)(o,"id"),t.adGroups.data.adGroupCampaign=(0,f.normalizeArrayOfObject)(i,"ad_group_id"),t.ads.data.items=(0,f.normalizeArrayOfObject)(s,"id"),t.ads.data.adAdGroup=(0,f.normalizeArrayOfObject)(l,"ad_id"),t}))})),n._displayCampaignService.getGoals(t).then((function(e){return e.data})).then((function(e){var t=e.map((function(e){return n._goalService.getAttributionModels(e.goal_id).then((function(t){return Object.assign(Object.assign({},e),{attribution:t.data})}))}));return Promise.all(t)})).then((function(e){n.setState({goals:{items:e,isLoading:!1,isArchiving:!1,isUpdating:!1}})})),o.promise.then((function(e){n.updateStateOnPerf("campaign","performance","items",(0,p.normalizeReportView)(e.data.report_view))})).catch((function(e){return n.catchCancellablePromises(e,"campaign","performance")})),s.promise.then((function(e){n.updateStateOnPerf("adGroups","performance","items",n.formatReportView(e.data.report_view,"sub_campaign_id"))})).catch((function(e){return n.catchCancellablePromises(e,"adGroups","performance")})),l.promise.then((function(e){n.updateStateOnPerf("ads","performance","items",n.formatReportView(e.data.report_view,"message_id"))})).catch((function(e){return n.catchCancellablePromises(e,"ads","performance")})),c.promise.then((function(e){var t=Object.assign({},e.data.report_view);t.rows=e.data.report_view.rows.splice(0,30),n.updateStateOnPerf("campaign","mediaPerformance","items",(0,p.normalizeReportView)(t))})).catch((function(e){return n.catchCancellablePromises(e,"campaign","mediaPerformance")})),i.promise.then((function(e){n.updateStateOnPerf("campaign","overallPerformance","items",(0,p.normalizeReportView)(e.data.report_view))})).catch((function(e){return n.catchCancellablePromises(e,"campaign","overallPerformance")}))},n.catchCancellablePromises=function(e,t,a){e.isCanceled||(g.default.error(e),n.setState((function(e){var n=Object.assign({},e);return n[t][a].isLoading=!1,n[t][a].hasFetched=!0,n[t][a].error=!0,n})))},n.updateAd=function(e,t,a,r,i){var s=n.props,c=s.notifySuccess,u=s.notifyError,d=s.removeNotification,f=n.state.ads.data.adAdGroup&&n.state.ads.data.adAdGroup[e],p=f?f.campaign_id:void 0,m=f?f.ad_group_id:void 0;return p&&m?n._displayCampaignService.updateAd(e,p,m,t).then((function(t){if(n.setState((function(n){var a=Object.assign({},n);return a.ads.data.items[e].status=t.data.status,a})),(r||i)&&a){var s=Math.random().toString();r&&c({uid:s,message:r.title,description:r.body,btn:o.createElement(l.Button,{type:"primary",size:"small",onClick:function(){n.updateAd(e,a).then((function(){d(s)}))}},o.createElement("span",null,"Undo"))})}return null})).catch((function(e){var t=i?{message:i.title,description:i.body}:void 0;throw u(e,t),e})):Promise.resolve()},n.updateAdGroup=function(e,t,a,r,i){var s=n.props,c=s.notifySuccess,u=s.notifyError,d=s.removeNotification,f=n.state.adGroups.data.adGroupCampaign,p=f&&f[e]?f[e].campaign_id:void 0;return p?n._displayCampaignService.updateAdGroup(p,e,t).then((function(t){if(n.setState((function(n){var a=Object.assign({},n);return a.adGroups.data.items[e]=t.data,a})),(a||r)&&i){a&&c({uid:parseInt(e,0),message:a.title,description:a.body,btn:o.createElement(l.Button,{type:"primary",size:"small",onClick:function(){n.updateAdGroup(e,i).then((function(){d(e)}))}},o.createElement("span",null,"Undo"))})}return null})).catch((function(e){var t=r?{message:r.title,description:r.body}:void 0;throw u(e,t),e})):Promise.resolve()},n.updateCampaign=function(e,t,a){var r=n.props.notifyError;return n._displayCampaignService.updateCampaign(e,t).then((function(){return n._displayCampaignService.getCampaignDisplayViewDeep(e)})).then((function(e){n.setState((function(t){var n=Object.assign({},t);return n.campaign.data.items=[e.data],n}))})).catch((function(e){var t=a?{message:a.title,description:a.body}:void 0;r(e,t)}))},n.state=v.initialPageState,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.history,n=e.location,a=n.search,r=n.pathname,o=e.match.params,i=o.organisationId,s=o.campaignId;if((0,y.isSearchValid)(a,c.DISPLAY_DASHBOARD_SEARCH_SETTINGS)){var l=(0,y.parseSearch)(a,c.DISPLAY_DASHBOARD_SEARCH_SETTINGS);this.fetchAllData(i,s,l)}else t.replace({pathname:r,search:(0,y.buildDefaultSearch)(a,c.DISPLAY_DASHBOARD_SEARCH_SETTINGS)})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.location,a=n.pathname,r=n.search,o=t.match.params,i=o.campaignId,s=o.organisationId,l=t.history,u=e.location.search,d=e.match.params.campaignId;if(!(0,y.compareSearches)(r,u)||i!==d)if((0,y.isSearchValid)(r,c.DISPLAY_DASHBOARD_SEARCH_SETTINGS)){var f=(0,y.parseSearch)(r,c.DISPLAY_DASHBOARD_SEARCH_SETTINGS);this.fetchAllData(s,i,f)}else l.replace({pathname:a,search:(0,y.buildDefaultSearch)(r,c.DISPLAY_DASHBOARD_SEARCH_SETTINGS)})}},{key:"componentWillUnmount",value:function(){this.cancelablePromises.forEach((function(e){return e.cancel()}))}},{key:"formatReportView",value:function(e,t){var n=(0,p.normalizeReportView)(e);return(0,f.normalizeArrayOfObject)(n,t)}},{key:"updateStateOnPerf",value:function(e,t,n,a){this.setState((function(r){var o=Object.assign({},r);return o[e][t].isLoading=!1,o[e][t].hasFetched=!0,o[e][t][n]=a,o}))}},{key:"render",value:function(){var e=this.state,t=e.campaign,n=e.adGroups,a=e.ads,r=e.goals,i={media:{items:t.mediaPerformance.items,isLoading:t.mediaPerformance.isLoading,isUpdating:!1,isArchiving:!1},overall:{items:t.overallPerformance.items,isLoading:t.overallPerformance.isLoading,isUpdating:!1,isArchiving:!1},campaign:{items:t.performance.items,isLoading:t.performance.isLoading,isUpdating:!1,isArchiving:!1}};return o.createElement(u.default,{updateAd:this.updateAd,updateAdGroup:this.updateAdGroup,updateCampaign:this.updateCampaign,campaign:t.data.items[0],adGroups:n,ads:a,dashboardPerformance:i,goals:r.items})}}]),t}(o.Component);E([(0,b.lazyInject)(_.TYPES.IDisplayCampaignService)],w.prototype,"_displayCampaignService",void 0),E([(0,b.lazyInject)(_.TYPES.IGoalService)],w.prototype,"_goalService",void 0),t.default=(0,s.compose)(i.withRouter,h.default)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(13),s=n(10),l=n(8),c=v(n(338)),u=v(n(1018)),d=v(n(2048)),f=v(n(114)),p=n(61),m=v(n(802)),g=v(n(2053)),y=n(340),h=n(83);function v(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var S=s.Layout.Content,E=function(e){function t(){return b(this,t),_(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.campaign,n=e.ads,a=e.adGroups,o=e.updateAd,i=e.updateAdGroup,l=e.updateCampaign,p=e.dashboardPerformance,v=e.goals,b=e.intl.formatMessage,_=e.match.params,E=_.organisationId,O=_.campaignId;return r.createElement("div",{className:"ant-layout"},r.createElement(d.default,{campaign:t,updateCampaign:l,isFetchingStats:p.campaign.isLoading&&a.performance.isLoading&&n.performance.isLoading&&p.media.isLoading}),r.createElement("div",{className:"ant-layout"},r.createElement(S,{className:"mcs-content-container"},r.createElement(c.default,{campaign:t}),t&&"V2014_06"===t.model_version?r.createElement(s.Alert,{className:"m-b-20",message:b(f.default.editionNotAllowed),type:"warning"}):null,r.createElement(y.Labels,{labellableId:O,organisationId:E,labellableType:"DISPLAY_CAMPAIGN"}),r.createElement(u.default,{isFetchingCampaignStat:p.campaign.isLoading,campaignStat:p.campaign.items,mediaStat:p.media.items,isFetchingMediaStat:p.media.isLoading,isFetchingOverallStat:p.overall.isLoading,overallStat:p.overall.items,goals:v}),r.createElement(g.default,{title:b(f.default.adGroups),isFetching:a.data.isLoading,isFetchingStat:a.performance.isLoading,dataSet:(0,h.formatListView)(a.data,a.performance),updateAdGroup:i,campaign:t}),r.createElement(m.default,{title:b(f.default.creatives),isFetching:n.data.isLoading,isFetchingStat:n.performance.isLoading,dataSet:(0,h.formatListView)(n.data,n.performance),updateAd:o}))))}}]),t}(r.Component);t.default=(0,l.compose)(o.injectIntl,i.withRouter,p.injectDrawer)(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(152);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){function t(){return i(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.status;return r.createElement("div",{className:"campaign-status-indicator"},r.createElement("div",{className:e.toLowerCase()}),r.createElement("span",{className:"divider"},"|"),r.createElement("div",{className:"status-value"},function(e){return(0,o.formatDisplayCampaignProperty)("status",e).formattedValue}(e)))}}]),t}(r.Component);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(33),s=n(10),l=n(6),c=n(415),u=b(n(2044)),d=n(181),f=b(n(114)),p=n(30),m=n(56),g=b(n(81)),y=b(n(69)),h=b(n(801)),v=n(11);function b(e){return e&&e.__esModule?e:{default:e}}var _=c.LegendChartWithModal,S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={key1:"impressions",key2:"clicks"},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"createLegend",value:function(){var e=this.props.intl.formatMessage;return[{key:"impressions",domain:e(f.default.impressions)},{key:"clicks",domain:e(f.default.clicks)},{key:"ctr",domain:e(f.default.ctr)},{key:"impressions_cost",domain:e(f.default.impressions_cost)},{key:"cpm",domain:e(f.default.cpm)},{key:"cpc",domain:e(f.default.cpc)}]}},{key:"updateLocationSearch",value:function(e){var t=this.props,n=t.history,a=t.location,r=a.search,o={pathname:a.pathname,search:(0,p.updateSearch)(r,e,d.DISPLAY_DASHBOARD_SEARCH_SETTINGS)};n.push(o)}},{key:"renderDatePicker",value:function(){var e=this,t=this.props.history.location.search,n=(0,p.parseSearch)(t,d.DISPLAY_DASHBOARD_SEARCH_SETTINGS),a={from:n.from,to:n.to};return r.createElement(v.McsDateRangePicker,{values:a,onChange:function(t){return e.updateLocationSearch({from:t.from,to:t.to})}})}},{key:"renderStackedAreaCharts",value:function(){var e=this,t=this.props,n=t.dataSource,a=t.isFetchingCampaignStat,o=t.isFetchingOverallStat,i=t.overallStat,s=t.colors,l=this.state,c=l.key1,u=l.key2,d={xKey:"day",yKeys:[{key:c,message:f.default[c]},{key:u,message:f.default[u]}],colors:[s["mcs-warning"],s["mcs-info"]],isDraggable:!0,onDragEnd:function(t){e.updateLocationSearch({from:new g.default(t[0]),to:new g.default(t[1])})}},p=[{name:"CPA",value:!o&&i&&i.length?(0,m.formatMetric)(i[0].cpa,"0,0[.]00","","€"):void 0},{name:"CPC",value:!o&&i&&i.length?(0,m.formatMetric)(i[0].cpc,"0,0[.]00","","€"):void 0},{name:"CTR",value:!o&&i&&i.length?(0,m.formatMetric)(parseFloat(i[0].ctr)/100,"0.000 %"):void 0},{name:"CPM",value:!o&&i&&i.length?(0,m.formatMetric)(i[0].cpm,"0,0[.]00","","€"):void 0},{name:"Spent",value:!o&&i&&i.length?(0,m.formatMetric)(i[0].impressions_cost,"0,0[.]00","","€"):void 0}];return a||o?r.createElement(v.LoadingChart,null):r.createElement("div",{style:{display:"flex"}},r.createElement("div",{style:{float:"left"}},r.createElement(v.MetricsColumn,{metrics:p,isLoading:o||o})),n&&r.createElement(h.default,{dataset:n,options:d,style:{flex:"1"}}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.dataSource,a=t.isFetchingCampaignStat,o=t.renderCampaignProgress,i=t.colors,l=t.intl.formatMessage,c=this.state,d=c.key1,p=c.key2,m=[{key:d,domain:l(f.default[d]),color:i["mcs-warning"]},{key:p,domain:l(f.default[p]),color:i["mcs-info"]}],g=this.createLegend();return r.createElement("div",null,o?r.createElement(u.default,null):null,o?r.createElement("hr",null):null,r.createElement(s.Row,{className:"mcs-chart-header"},r.createElement(s.Col,{span:12},n&&0===n.length&&!a?r.createElement("div",null):r.createElement(_,{identifier:"chartLegend",options:m,legends:g,onLegendChange:function(t,n){return e.setState({key1:t,key2:n})}})),r.createElement(s.Col,{span:12},r.createElement("span",{className:"mcs-card-button"},this.renderDatePicker()))),n&&0===n.length&&!a?r.createElement(v.EmptyChart,{title:l(f.default.noStatAvailable),icon:"warning"}):r.createElement(s.Row,{gutter:20},r.createElement(s.Col,{span:24},this.renderStackedAreaCharts())))}}]),t}(r.Component);t.default=(0,o.compose)(i.withRouter,l.injectIntl,y.default)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));t.default=function(e){var t=e.options;return a.createElement("div",{className:"mcs-legend-container"},t.map((function(e){return a.createElement("div",{key:e.domain,className:"wrapper"},a.createElement("div",{style:{backgroundColor:e.color},className:"mcs-line"}),a.createElement("span",{className:"mcs-legend"},e.domain))})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(11);var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={key1:"",key2:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props.options,n=function(){var n=e.props.legends,a={display:"block",height:"30px",lineHeight:"30px"};e.setState({key1:t[0].key,key2:t[1].key});return r.createElement(o.Row,null,r.createElement(o.Col,{span:12},r.createElement(o.Radio.Group,{defaultValue:t[0].key,onChange:function(t){e.setState((function(e){return Object.assign(Object.assign({},e),{key1:t.target.value})}))}},n.map((function(e){return r.createElement(o.Radio,{key:e.key,style:a,value:e.key},e.domain)})))),r.createElement(o.Col,{span:12},r.createElement(o.Radio.Group,{defaultValue:t[1].key,onChange:function(t){e.setState((function(e){return Object.assign(Object.assign({},e),{key2:t.target.value})}))}},n.map((function(e){return r.createElement(o.Radio,{key:e.key,style:a,value:e.key},e.domain)})))))};return r.createElement("div",{className:"mcs-legend-container"},t.map((function(e){return r.createElement("div",{key:e.domain,style:{float:"left"}},r.createElement("div",{style:{backgroundColor:e.color,marginLeft:"10px",width:"30px",height:"4px",borderRadius:"5px",marginTop:"18px",float:"left"}}),r.createElement("span",{style:{float:"right",lineHeight:"40px",marginLeft:"5px"}},e.domain))})),r.createElement("div",{style:{float:"left",marginLeft:"10px",borderLeft:"1px solid #f0f0f0",height:"40px",lineHeight:"40px"}},r.createElement("button",{className:"mcs-invisible-button",onClick:function(){return t=e,a=e.props.onLegendChange,void o.Modal.confirm({title:"Do you Want to delete these items?",content:n(),onOk:function(){a(t.state.key1,t.state.key2)},onCancel:function(){}});var t,a}},r.createElement(i.McsIcon,{style:{marginLeft:"10px",color:"#d0d0d0"},type:"pen"}))))}}]),t}(r.Component);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(13),l=n(10),c=n(8),u=y(n(81)),d=y(n(59)),f=y(n(2045)),p=y(n(114)),m=n(15),g=n(12);function y(e){return e&&e.__esModule?e:{default:e}}var h=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchAll=function(e){n.setState((function(e){var t=Object.assign({},e);return t.isLoading=!0,t}),(function(){n._displayCampaignService.getCampaignDisplay(e).then((function(e){n.setState((function(t){var n=Object.assign({},t);return n.campaign=e.data,n.isLoading=!1,n}))})).catch((function(e){d.default.error(e),n.setState({isLoading:!1,error:!0})}))}))},n.state={isLoading:!1,error:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params.campaignId;this.fetchAll(e)}},{key:"componentDidUpdate",value:function(e){var t=this.props.match.params,n=t.organisationId,a=t.campaignId,r=e.match.params,o=r.organisationId;r.campaignId!==a&&o!==n&&this.fetchAll(a)}},{key:"render",value:function(){var e=this.state,t=e.campaign,n=e.isLoading,a=this.props.intl.formatMessage,r=new u.default("now"),i="";switch(t&&t.max_budget_period){case"DAY":r=new u.default("now"),i=a(p.default.dailyBudgetConsumption);break;case"WEEK":r=new u.default("now-7d"),i=a(p.default.weeklyBudgetConsumption);break;case"MONTH":r=new u.default("now-30d"),i=a(p.default.monthlyBudgetConsumption);break;default:r=new u.default("now"),i=a(p.default.dailyBudgetConsumption)}var s=new u.default("now"),c=new u.default(1325376e6),d=t&&t.total_budget||1,m=t&&t.max_budget_per_period||1,g=a(p.default.totalBudgetConsumption);return t&&t.id&&t.organisation_id&&t.max_budget_period?o.createElement(l.Row,{gutter:100},o.createElement(l.Col,{span:12},o.createElement(f.default,{formattedMessage:g,loading:n,id:t&&t.id,organisationId:t.organisation_id,objectType:"campaign",totalBudget:d,from:c,to:s})),o.createElement(l.Col,{span:12},o.createElement(f.default,{formattedMessage:i,loading:n,id:t.id,organisationId:t.organisation_id,objectType:"campaign",totalBudget:m,from:r,to:s}))):o.createElement(l.Row,{gutter:100},o.createElement(l.Col,{span:12},o.createElement("div",{className:"mcs-progress-wrapper"},o.createElement("i",{className:"mcs-table-cell-loading",style:{width:"100%"}}))),o.createElement(l.Col,{span:12},o.createElement("div",{className:"mcs-progress-wrapper"},o.createElement("i",{className:"mcs-table-cell-loading",style:{width:"100%"}}))))}}]),t}(o.Component);h([(0,m.lazyInject)(g.TYPES.IDisplayCampaignService)],v.prototype,"_displayCampaignService",void 0),t.default=(0,c.compose)(i.injectIntl,s.withRouter)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(56),i=c(n(78)),s=n(11),l=c(n(59));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchAll=function(e,t,a,r,o){n.setState((function(e){var t=Object.assign({},e);return t.isLoading=!0,t}),(function(){i.default.getSingleDisplayDeliveryReport(e,t,r,o,void 0,["impressions_cost"]).then((function(e){n.setState((function(t){var n=Object.assign({},t);return n.consumedBudget=e.data&&e.data.report_view&&e.data.report_view.rows&&e.data.report_view.rows[0]?e.data.report_view.rows[0][1]:0,n.isLoading=!1,n}))})).catch((function(e){l.default.error(e),n.setState({isLoading:!1})}))}))},n.state={isLoading:!1,consumedBudget:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.id,n=e.organisationId,a=e.objectType,r=e.from,o=e.to;this.fetchAll(n,t,a,r,o)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.id,a=t.organisationId,r=t.objectType,o=t.from,i=t.to,s=e.id,l=e.organisationId,c=e.objectType,u=e.from,d=e.to;n===s&&a===l&&r===c&&o.toMoment().isSame(u.toMoment())&&i.toMoment().isSame(d.toMoment())||this.fetchAll(a,n,r,o,i)}},{key:"render",value:function(){var e,t=this.state,n=t.consumedBudget,a=t.isLoading,i=this.props,l=i.totalBudget,c=i.loading,u=n/l*100,d=i.formattedMessage+" "+(e=u,(0,o.formatMetric)(e/100,"0.00%"));return c||a?r.createElement("div",{className:"mcs-progress-wrapper"},r.createElement("i",{className:"mcs-table-cell-loading"})):r.createElement(s.Progress,{percent:u,label:d})}}]),t}(r.Component);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(6),c=n(10),u=n(114),d=(a=u)&&a.__esModule?a:{default:a},f=n(68),p=n(56),m=n(181),g=n(30),y=n(11);function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=function(e){function t(){return h(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"updateLocationSearch",value:function(e){var t=this.props,n=t.history,a=t.location,r=a.search,o={pathname:a.pathname,search:(0,g.updateSearch)(r,e,m.DISPLAY_DASHBOARD_SEARCH_SETTINGS)};n.push(o)}},{key:"renderDatePicker",value:function(){var e=this,t=this.props.history.location.search,n=(0,g.parseSearch)(t,m.DISPLAY_DASHBOARD_SEARCH_SETTINGS),a={rangeType:n.rangeType,lookbackWindow:n.lookbackWindow,from:n.from,to:n.to};return o.createElement(y.McsDateRangePicker,{values:a,onChange:function(t){return e.updateLocationSearch({from:t.from,to:t.to})}})}},{key:"render",value:function(){var e=this.props,t=e.isFetchingMediaStat,n=e.dataSet,a=e.intl.formatMessage,r=function(e,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(t)return o.createElement("i",{className:"mcs-table-cell-loading"});var r="EUR"===a?"€ ":"";return(0,p.formatMetric)(e,n,r)},i=function(e,t,n){return"-"===e[n]?-1:"-"===t[n]?1:parseFloat(e[n])-parseFloat(t[n])},s=[{intlMessage:d.default.displayNetworkName,key:"display_network_name",isHideable:!1,render:function(e){return e?o.createElement("span",null,e):o.createElement("span",null,a(d.default.displayNetworkNameUncategorized))}},{intlMessage:d.default.name,key:"media_id",isHideable:!1,render:function(e){return o.createElement("span",null,e)}},{intlMessage:d.default.format,key:"format",isHideable:!1,render:function(e){return o.createElement("span",null,e)}},{intlMessage:d.default.impressions,key:"impressions",isVisibleByDefault:!0,isHideable:!0,render:function(e){return r(e,"0,0")},sorter:function(e,t){return i(e,t,"impressions")}},{intlMessage:d.default.clicks,key:"clicks",isVisibleByDefault:!0,isHideable:!0,render:function(e){return r(e,"0,0")},sorter:function(e,t){return i(e,t,"clicks")}},{intlMessage:d.default.cpm,key:"cpm",isVisibleByDefault:!0,isHideable:!0,render:function(e){return r(e,"0,0.00","EUR")},sorter:function(e,t){return i(e,t,"cpm")}},{intlMessage:d.default.ctr,key:"ctr",isVisibleByDefault:!0,isHideable:!0,render:function(e){return r(parseFloat(e)/100,"0.000 %")},sorter:function(e,t){return i(e,t,"ctr")}},{intlMessage:d.default.cpc,key:"cpc",isVisibleByDefault:!0,isHideable:!0,render:function(e){return r(e,"0,0.00","EUR")},sorter:function(e,t){return i(e,t,"cpc")}},{intlMessage:d.default.impressions_cost,key:"impressions_cost",isVisibleByDefault:!0,isHideable:!0,render:function(e){return r(e,"0,0.00","EUR")},sorter:function(e,t){return i(e,t,"impressions_cost")}}];return o.createElement(c.Row,null,o.createElement(c.Col,{span:24},o.createElement("div",{className:"mcs-card-button"},this.renderDatePicker())),o.createElement(c.Col,{span:24},o.createElement(f.TableView,{columns:s,dataSource:n,loading:t})))}}]),t}(o.Component);t.default=(0,i.compose)(l.injectIntl,s.withRouter)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(13),i=n(41),s=n(10),l=n(6),c=n(8),u=n(107),d=n(415),f=n(181),p=_(n(114)),m=n(30),g=n(56),y=_(n(78)),h=_(n(59)),v=_(n(69)),b=n(11);function _(e){return e&&e.__esModule?e:{default:e}}var S=d.LegendChart,E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getSetAttribution=function(e,t){var a=null;return void 0!==e.selectedAttributionModel?a=e.selectedAttributionModel.id:void 0===e.selectedAttributionModel&&t.attribution.length&&(n.setState({selectedAttributionModel:t.attribution[0]}),a=t.attribution[0].id),a},n.getPerformanceForGoalAndAttribution=function(e,t,a,r,o,i){var s=["campaign_id=="+t,"goal_id=="+a.goal_id];return r&&s.push("attribution_model_id=="+r),n.setState({isFetchingPerformance:!0},(function(){y.default.getConversionAttributionPerformance(e,o,i,s,["day"],void 0).then((function(e){return(0,g.normalizeReportView)(e.data.report_view)})).then((function(e){n.setState({performance:e,isFetchingPerformance:!1,hasData:!!e.length,hasFetchedPerformance:!0,error:!1})})).catch((function(e){h.default.error(e),n.setState({isFetchingPerformance:!1,hasData:!1,hasFetchedPerformance:!0,error:!0})}))}))},n.renderAttributionSelect=function(){var e=n.props,t=e.goal,a=e.match.params,o=a.campaignId,l=a.organisationId,c=e.location.search,d=r.createElement(s.Menu,{onClick:function(e){var a=(0,m.parseSearch)(c,f.DISPLAY_DASHBOARD_SEARCH_SETTINGS);n.setState((function(r){var i=t.attribution.find((function(t){return t.id===e.key}));return n.getPerformanceForGoalAndAttribution(l,o,t,i.id,a.from,a.to),{selectedAttributionModel:i}}))}},t.attribution.map((function(e){return n.state.selectedAttributionModel&&e.id!==n.state.selectedAttributionModel.id?r.createElement(s.Menu.Item,{key:e.id},e.attribution_model_name):null})));return r.createElement(u.Dropdown,{overlay:d,trigger:["click"]},r.createElement(s.Button,{style:{marginRight:8}},r.createElement("span",null,n.state.selectedAttributionModel&&n.state.selectedAttributionModel.attribution_model_name)," ",r.createElement(i.DownOutlined,null)))},n.state={performance:[],isFetchingPerformance:!1,hasFetchedPerformance:!1,hasData:!0,error:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"updateLocationSearch",value:function(e){var t=this.props,n=t.history,a=t.location,r=a.search,o={pathname:a.pathname,search:(0,m.updateSearch)(r,e,f.DISPLAY_DASHBOARD_SEARCH_SETTINGS)};n.push(o)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.goal,n=e.history,a=e.location,r=a.search,o=a.pathname,i=e.match.params,s=i.campaignId,l=i.organisationId;if((0,m.isSearchValid)(r,f.DISPLAY_DASHBOARD_SEARCH_SETTINGS)){var c=(0,m.parseSearch)(r,f.DISPLAY_DASHBOARD_SEARCH_SETTINGS),u=this.getSetAttribution(this.state,t);this.getPerformanceForGoalAndAttribution(l,s,t,u,c.from,c.to)}else n.replace({pathname:o,search:(0,m.buildDefaultSearch)(r,f.DISPLAY_DASHBOARD_SEARCH_SETTINGS)})}},{key:"componentWillUpdate",value:function(e,t){var n=e.goal,a=e.location,r=a.search,o=a.pathname,i=e.match.params,s=i.campaignId,l=i.organisationId,c=this.props,u=c.goal,d=c.history,p=c.location.search,g=c.match.params,y=g.campaignId,h=g.organisationId,v=this.state.selectedAttributionModel,b=t.selectedAttributionModel;if(!(0,m.compareSearches)(p,r)||y!==s||h!==l||u!==n||v!==b)if((0,m.isSearchValid)(r,f.DISPLAY_DASHBOARD_SEARCH_SETTINGS)){var _=(0,m.parseSearch)(r,f.DISPLAY_DASHBOARD_SEARCH_SETTINGS),S=b?b.id:null;this.getPerformanceForGoalAndAttribution(l,s,n,S,_.from,_.to)}else d.replace({pathname:o,search:(0,m.buildDefaultSearch)(r,f.DISPLAY_DASHBOARD_SEARCH_SETTINGS)})}},{key:"renderDatePicker",value:function(){var e=this,t=this.props.history.location.search,n=(0,m.parseSearch)(t,f.DISPLAY_DASHBOARD_SEARCH_SETTINGS),a={from:n.from,to:n.to};return r.createElement(b.McsDateRangePicker,{values:a,onChange:function(t){return e.updateLocationSearch({from:t.from,to:t.to})}})}},{key:"renderStackedAreaCharts",value:function(){var e=this.props,t=e.colors,n=e.intl.formatMessage,a=this.state,o=a.performance,i=a.isFetchingPerformance,s={xKey:"day",yKeys:[{key:"weighted_conversions",message:n(p.default.weightedConversion)}],colors:[t["mcs-success"]],isDraggable:!1};return i||0===o.length?r.createElement(b.LoadingChart,null):r.createElement(b.StackedAreaPlot,{dataset:o,options:s})}},{key:"render",value:function(){var e=this.props,t=e.colors,n=e.intl.formatMessage,a=this.state,o=a.hasFetchedPerformance,i=a.hasData,l=a.isFetchingPerformance,c=[{color:t["mcs-success"],domain:n(p.default.weightedConversion)}];return r.createElement("div",null,r.createElement(s.Row,{className:"mcs-chart-header"},r.createElement(s.Col,{span:12},i&&l?r.createElement("div",null):r.createElement(S,{identifier:"chartLegend",options:c})),r.createElement(s.Col,{span:12},r.createElement("span",{className:"mcs-card-button"},this.renderAttributionSelect(),this.renderDatePicker()))),!i&&o?r.createElement(b.EmptyChart,{title:n(p.default.noGoalStatAvailable),icon:"warning"}):r.createElement(s.Row,null,r.createElement(s.Col,{span:24},this.renderStackedAreaCharts())))}}]),t}(r.Component);t.default=(0,c.compose)(l.injectIntl,o.withRouter,v.default)(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(41),s=n(10),l=n(13),c=n(107),u=n(6),d=n(8),f=I(n(114)),p=I(n(309)),m=n(11),g=I(n(142)),y=I(n(78)),h=I(n(59)),v=n(30),b=n(56),_=n(181),S=n(83),E=n(61),O=I(n(273)),w=n(152),M=I(n(182)),P=n(15),T=n(12);function I(e){return e&&e.__esModule?e:{default:e}}var A=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},C=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},j=function(e,t){var n=(0,b.normalizeReportView)(e);return(0,S.normalizeArrayOfObject)(n,t)},R=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleRunExport=function(e){var t=n.props,a=t.match.params,r=a.organisationId,o=a.campaignId,i=t.intl.formatMessage;n.setState({exportIsRunning:!0});var l=(0,v.parseSearch)(n.props.location.search,_.DISPLAY_DASHBOARD_SEARCH_SETTINGS),c=s.message.loading(i(f.default.exportInProgress),0);n.fetchAllExportData(r,o,l).then((function(e){e.mediaData.map((function(e){e.display_network_name=e.display_network_name||i(f.default.displayNetworkNameUncategorized),e.cpa=e.cpa||0,e.cpc=e.cpc||0,e.cpm=e.cpm||0,e.ctr=e.ctr||0})),g.default.exportDisplayCampaignDashboard(r,e.displayData,e.overallDisplayData,e.mediaData,e.adGroupData.items,e.adData.items,e.goalData,l,i),n.setState({exportIsRunning:!1}),c()})).catch((function(e){h.default.error(e),n.setState({exportIsRunning:!1}),c()}))},n.exportIsRunningModal=function(e){var t=n.props.intl.formatMessage;s.Modal.warning({title:t(p.default.exportIsRunningTitle),content:t(p.default.exportIsRunningMessage),icon:o.createElement(i.ExclamationCircleOutlined,null),okText:t(p.default.confirm),onOk:function(){}})},n.editCampaign=function(){var e=n.props,t=e.location,a=e.history,r=e.match.params,o=r.organisationId,i=r.campaignId,l=e.campaign,c=e.intl;if("V2014_06"===l.model_version)s.message.info(c.formatMessage(f.default.editionNotAllowed));else{var u="/v2/o/"+o+"/campaigns/display/"+i+"/edit";a.push({pathname:u,state:{from:""+t.pathname+t.search}})}},n.buildActionElement=function(){var e=n.props,t=e.campaign,a=e.updateCampaign,r=function(e){return function(){return t?a(t.id,{status:e,type:"DISPLAY"}):null}},i=o.createElement(s.Button,{className:"mcs-primary",type:"primary",onClick:r("ACTIVE")},o.createElement(m.McsIcon,{type:"play"}),o.createElement(u.FormattedMessage,f.default.activateCampaign)),l=o.createElement(s.Button,{className:"mcs-primary",type:"primary",onClick:r("PAUSED")},o.createElement(m.McsIcon,{type:"pause"}),o.createElement(u.FormattedMessage,f.default.pauseCampaign));return t&&!t.id?null:!t||"PAUSED"!==t.status&&"PENDING"!==t.status?l:i},n.duplicateCampaign=function(){var e=n.props,t=e.location,a=e.history,r=e.match.params,o=r.organisationId,i=r.campaignId,s="/v2/o/"+o+"/campaigns/display/create";a.push({pathname:s,state:{from:""+t.pathname+t.search,campaignId:i}})},n.fetchAllExportData=function(e,t,a){var r=a.to.toMoment().unix()-a.from.toMoment().unix()>172800?["day"]:["day,hour_of_day"],o=["impressions","clicks","cpm","ctr","cpc","impressions_cost","cpa"];return Promise.all([y.default.getMediaDeliveryReport(e,"campaign_id",t,a.from,a.to,void 0,o,{sort:"-clicks"}),y.default.getAdDeliveryReport(e,"campaign_id",t,a.from,a.to,void 0,o),y.default.getAdGroupDeliveryReport(e,"campaign_id",t,a.from,a.to,void 0,o),y.default.getSingleDisplayDeliveryReport(e,t,a.from,a.to,r,o),n._displayCampaignService.getGoals(t).then((function(e){var t=e.data.map((function(e){return n._goalService.getAttributionModels(e.goal_id).then((function(t){return Object.assign(Object.assign({},e),{attribution:t.data})}))}));return Promise.all(t)})).then((function(n){return Promise.all(n.map((function(n){var r=[];return n.attribution.forEach((function(o){var i=["campaign_id=="+t,"goal_id=="+n.goal_id,"attribution_model_id=="+o.id],s=y.default.getConversionAttributionPerformance(e,a.from,a.to,i,["day"],void 0).then((function(e){return(0,b.normalizeReportView)(e.data.report_view)})).then((function(e){return Object.assign(Object.assign({},o),{perf:e})}));r.push(s)})),Promise.all(r).then((function(e){return Object.assign(Object.assign({},n),{attribution:e})}))})))})),n._displayCampaignService.getCampaignDisplayViewDeep(t,{view:"deep"})]).then((function(e){var t=(0,b.normalizeReportView)(e[0].data.report_view),n=j(e[1].data.report_view,"message_id"),a=j(e[2].data.report_view,"sub_campaign_id"),r=(0,b.normalizeReportView)(e[3].data.report_view),o=e[4],i=e[5].data,s=i.ad_groups,l=C(i,["ad_groups"]),c=s.map((function(e){e.ads;return C(e,["ads"])})),u=[],d=[];i.ad_groups.forEach((function(e){e.ads.forEach((function(t){u.push(t),d.push({ad_id:t.id,ad_group_id:e.id,campaign_id:l.id})}))}));var f=function(e,t){return e?Object.keys(e).map((function(n){return Object.assign(Object.assign({},t[n]),e[n])})):[]},p=(0,S.normalizeArrayOfObject)(c,"id");return{mediaData:t,adData:{items:f((0,S.normalizeArrayOfObject)(u,"id"),n)},adGroupData:{items:f(p,a)},overallDisplayData:r,displayData:l,goalData:o}}))},n.buildMenu=function(){var e=n.props,t=e.campaign,a=e.archiveCampaign,r=e.intl.formatMessage;return o.createElement(s.Menu,{onClick:function(e){var l,c=n.props,d=c.match.params,f=d.organisationId,m=d.campaignId,g=c.history;switch(e.key){case"ARCHIVED":return l=t.id,void s.Modal.confirm({title:r(p.default.archiveCampaignConfirm),content:r(p.default.archiveCampaignMessage),icon:o.createElement(i.ExclamationCircleOutlined,null),okText:r(p.default.confirm),cancelText:r(p.default.cancel),onOk:function(){return a(l)}});case"DUPLICATE":return n.duplicateCampaign();case"HISTORY":return n.props.openNextDrawer(O.default,{additionalProps:{resourceType:"CAMPAIGN",resourceId:m,handleClose:function(){return n.props.closeNextDrawer()},formatProperty:w.formatDisplayCampaignProperty,resourceLinkHelper:{AD_GROUP:{direction:"CHILD",getType:function(){return o.createElement(u.FormattedMessage,M.default.adGroupResourceType)},getName:function(e){return n._displayCampaignService.getAdGroup(m,e).then((function(t){return t.data.name||e}))},goToResource:function(e){g.push("/v2/o/"+f+"/campaigns/display/"+m+"/adgroups/"+e)}},GOAL_SELECTION:{direction:"CHILD",getType:function(){return o.createElement(u.FormattedMessage,M.default.goalResourceType)},getName:function(e){return n._resourceHistoryService.getLinkedResourceIdInSelection(f,"GOAL_SELECTION",e,"GOAL").then((function(e){return n._goalService.getGoal(e).then((function(e){return e.data.name}))}))},goToResource:function(e){n._resourceHistoryService.getLinkedResourceIdInSelection(f,"GOAL_SELECTION",e,"GOAL").then((function(e){g.push("/v2/o/"+f+"/campaigns/goals/"+e)}))}}}},size:"small"});default:return function(){h.default.error("onclick error")}}}},o.createElement(s.Menu.Item,{key:"HISTORY"},o.createElement(u.FormattedMessage,f.default.history)),t&&"V2014_06"===t.model_version?null:o.createElement(s.Menu.Item,{key:"DUPLICATE"},o.createElement(u.FormattedMessage,f.default.duplicate)),o.createElement(s.Menu.Item,{key:"ARCHIVED"},o.createElement(u.FormattedMessage,f.default.archiveCampaign)))},n.state={exportIsRunning:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.intl.formatMessage,a=e.campaign,r=this.state.exportIsRunning,l=this.buildActionElement(),d=this.buildMenu(),p=[{name:n(f.default.display),path:"/v2/o/"+t+"/campaigns/display"},{name:a&&a.name||""}];return o.createElement(m.Actionbar,{paths:p},l,o.createElement(s.Button,{onClick:r?this.exportIsRunningModal:this.handleRunExport},o.createElement(m.McsIcon,{type:"download"}),o.createElement(u.FormattedMessage,{id:"display.campaign.actionbar.exportButton",defaultMessage:"Export"})),a&&"V2014_06"!==a.model_version&&o.createElement(s.Button,{onClick:this.editCampaign},o.createElement(m.McsIcon,{type:"pen"}),o.createElement(u.FormattedMessage,f.default.editCampaign)),o.createElement(c.Dropdown,{overlay:d,trigger:["click"]},o.createElement(s.Button,null,o.createElement(i.EllipsisOutlined,null))))}}]),t}(o.Component);A([(0,P.lazyInject)(T.TYPES.IDisplayCampaignService)],R.prototype,"_displayCampaignService",void 0),A([(0,P.lazyInject)(T.TYPES.IResourceHistoryService)],R.prototype,"_resourceHistoryService",void 0),A([(0,P.lazyInject)(T.TYPES.IGoalService)],R.prototype,"_goalService",void 0),t.default=(0,d.compose)(l.withRouter,u.injectIntl,E.injectDrawer)(R)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(41),s=n(10),l=b(n(54)),c=b(n(17)),u=n(6),d=b(n(182)),f=n(8),p=n(13),m=b(n(2050)),g=b(n(23)),y=n(15),h=n(12),v=n(11);function b(e){return e&&e.__esModule?e:{default:e}}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.groupByDate=function(e,t){return l.default.groupBy(e,(function(e){return(0,c.default)(e[t]).format("YYYY-MM-DD")}))},n.groupByTime=function(e,t){return l.default.groupBy(e,(function(e){return(0,c.default)(e[t]).format("YYYY-MM-DD HH:mm:ss")}))},n.fetchEvents=function(e,t,a){var r=n.state,o=r.nextTime,i=r.eventCountOnOldestTime,s=o?{resource_type:t,resource_id:a,max_results:10+i,to:o}:{resource_type:t,resource_id:a,max_results:10};n.setState((function(e){return{events:Object.assign(Object.assign({},e.events),{isLoading:!0})}}),(function(){return n._resourceHistoryService.getResourceHistory(e,s).then((function(t){0===t.count?n.setState({events:{isLoading:!1,hasItems:!1,items:[],byDay:{},byTime:{}},eventCountOnOldestTime:0}):n._resourceHistoryService.getResourceHistory(e,Object.assign(Object.assign({},s),{max_results:s.max_results+1})).then((function(e){n.setState((function(a){var r=a.events.items.concat(t.data.slice(i).map((function(e){return e.events})).reduce((function(e,t){return e.concat(t)}),[])),o={events:Object.assign(Object.assign({},a.events),{isLoading:!1,hasItems:t.count!==e.count,items:r,byDay:n.groupByDate(r,"timestamp"),byTime:n.groupByTime(r,"timestamp")}),nextTime:t.count!==e.count&&t.data&&t.data[t.data.length-1]?(0,c.default)(t.data[t.data.length-1].events[t.data[t.data.length-1].events.length-1].timestamp).format("x"):void 0,eventCountOnOldestTime:0};return o.eventCountOnOldestTime=o.events.byTime[Object.keys(o.events.byTime)[Object.keys(o.events.byTime).length-1]].length,o}))}))})).catch((function(e){n.setState((function(e){return{events:{isLoading:!1,hasItems:!1,items:[],byDay:{},byTime:{}},eventCountOnOldestTime:0}})),n.props.notifyError(e)}))}))},n.fetchNewEvents=function(e){var t=n.props,a=t.match.params.organisationId,r=t.resourceType,o=t.resourceId;e.preventDefault(),n.fetchEvents(a,r,o)},n.renderPendingTimeline=function(e){return e.hasItems?e.isLoading?o.createElement(s.Spin,{size:"small"}):o.createElement("button",{className:"mcs-card-inner-action",onClick:n.fetchNewEvents},o.createElement(u.FormattedMessage,d.default.seeMore)):o.createElement("div",{className:"mcs-title"},0===e.items.length?o.createElement(u.FormattedMessage,d.default.noHistory):o.createElement(u.FormattedMessage,d.default.noEventsLeft))},n.renderDate=function(e){var t=n.props.intl.formatMessage;switch(e){case(0,c.default)().format("YYYY-MM-DD"):return t(d.default.today);case(0,c.default)().subtract(1,"days").format("YYYY-MM-DD"):return t(d.default.yesterday);default:return e}},n.state={events:{isLoading:!1,hasItems:!1,items:[],byDay:{},byTime:{}},eventCountOnOldestTime:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.resourceType,a=e.resourceId;this.fetchEvents(t,n,a)}},{key:"render",value:function(){var e=this,t=this.state.events,n=this.props,a=n.formatProperty,r=n.resourceType,l=n.resourceLinkHelper,c=Object.keys(t.byDay);return t.isLoading&&!t.hasItems?o.createElement(s.Col,{span:24,className:"text-center"},o.createElement(s.Spin,null)):o.createElement(s.Timeline,{pending:this.renderPendingTimeline(t),pendingDot:o.createElement(v.McsIcon,{type:"status",className:"mcs-timeline-last-dot"})},c.map((function(n){var c=t.byDay[n],u=e.groupByTime(c,"timestamp"),d=e.renderDate(n);return o.createElement("div",{className:"mcs-timeline",key:n},o.createElement(s.Timeline.Item,{dot:o.createElement(i.FlagOutlined,{className:"mcs-timeline-dot"})},o.createElement("div",{className:"mcs-title"},d)),0!==c.length&&Object.keys(u).map((function(e){return o.createElement(s.Timeline.Item,{key:n+"_"+e,dot:o.createElement(v.McsIcon,{type:"status",className:"mcs-timeline-dot"})},o.createElement(m.default,{resourceType:r,events:u[e],formatProperty:a,resourceLinkHelper:l}))})))})))}}]),t}(o.Component);_([(0,y.lazyInject)(h.TYPES.IResourceHistoryService)],S.prototype,"_resourceHistoryService",void 0),t.default=(0,f.compose)(p.withRouter,u.injectIntl,g.default)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=g(n(54)),s=g(n(17)),l=n(908),c=n(6),u=n(13),d=n(41),f=n(10),p=n(11),m=g(n(182));function g(e){return e&&e.__esModule?e:{default:e}}function y(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.generateResourceIdentifier=function(e){return e.resource_type+e.resource_id},n.renderField=function(e){var t=n.props.formatProperty,a=i.default.snakeCase(e);return r.createElement("span",{className:"name"}," ",t(a).message?r.createElement(c.FormattedMessage,t(a).message):e," ")},n.renderValue=function(e,t){var a=n.props.formatProperty,o=i.default.snakeCase(e);return t?r.createElement("span",{className:"value"},a(o,t).formattedValue||t):r.createElement("span",{className:"empty-value"},r.createElement(c.FormattedMessage,m.default.noValue))},n.renderMultiEdit=function(e,t){return e.map((function(e){return(0,l.isHistoryUpdateEvent)(e)?r.createElement("div",{className:"mcs-fields-list-item"},t?r.createElement(c.FormattedMessage,Object.assign(Object.assign({},m.default.initialFieldValue),{values:{field:n.renderField(e.field_changed),newValue:n.renderValue(e.field_changed,e.new_value)}})):r.createElement(c.FormattedMessage,Object.assign(Object.assign({},m.default.fieldInMultiEditList),{values:{field:n.renderField(e.field_changed),oldValue:n.renderValue(e.field_changed,e.old_value),newValue:n.renderValue(e.field_changed,e.new_value)}}))):(0,l.isHistoryLinkEvent)(e)&&r.createElement("div",{className:"mcs-fields-list-item"},n.renderLinkEventInMultiEdit(e,!1))}))},n.renderLinkEventInMultiEdit=function(e,t){var a=n.props.resourceLinkHelper,o=n.state.resourceNames,i=a&&a[e.resource_type];if(i){var s=function(){i.goToResource(e.resource_id)};if(void 0===n.state.resourceNames[n.generateResourceIdentifier(e)]&&i.getName(e.resource_id).then((function(t){n.setState((function(a){return a.resourceNames[n.generateResourceIdentifier(e)]=t,a}))})).catch((function(t){n.setState((function(t){return t.resourceNames[n.generateResourceIdentifier(e)]=r.createElement(c.FormattedMessage,m.default.deleted),t}))})),t)return r.createElement(c.FormattedMessage,Object.assign(Object.assign({},m.default.parentLink),{values:{parentType:r.createElement("span",{className:"name"},i.getType()),parentName:r.createElement("span",{className:"value cursor-pointer",onClick:s},o[n.generateResourceIdentifier(e)])}}));var u=(0,l.isHistoryCreateLinkEvent)(e)?"CHILD"===i.direction?m.default.childAddedMultiEditList:m.default.parentAddedMultiEditList:"CHILD"===i.direction?m.default.childRemovedMultiEditList:m.default.parentRemovedMultiEditList;return r.createElement("div",{className:"mcs-fields-list-item"},r.createElement(c.FormattedMessage,Object.assign(Object.assign({},u),{values:{linkedResource:r.createElement("span",{className:"name"},i.getType()),value:r.createElement("span",{className:"value cursor-pointer",onClick:s},o[n.generateResourceIdentifier(e)])}})))}},n.renderUniqueLinkEvent=function(e){var t=n.props,a=t.formatProperty,o=t.resourceLinkHelper,i=n.state.resourceNames,s=o&&o[e.resource_type];if(s){var u=(0,l.isHistoryCreateLinkEvent)(e)?m.default.resourceCreateLinkChild:m.default.resourceDeleteLinkChild,d=(0,l.isHistoryCreateLinkEvent)(e)?m.default.resourceCreateLinkParent:m.default.resourceDeleteLinkParent,f=function(){s.goToResource(e.resource_id)};return"CHILD"===s.direction?r.createElement(c.FormattedMessage,Object.assign(Object.assign({},u),{values:{userName:e.user_identification.user_name,resourceType:r.createElement("span",{className:"name"},s.getType()),resourceName:r.createElement("span",{className:"value cursor-pointer",onClick:f},i[n.generateResourceIdentifier(e)])}})):r.createElement(c.FormattedMessage,Object.assign(Object.assign({},d),{values:{userName:e.user_identification.user_name,childResourceType:r.createElement("span",{className:"name"},r.createElement(c.FormattedMessage,a("history_resource_type").message||m.default.defaultResourceType)),parentResourceType:r.createElement("span",{className:"name"},s.getType()),parentResourceName:r.createElement("span",{className:"value cursor-pointer",onClick:f},i[n.generateResourceIdentifier(e)])}}))}},n.findCreateEventIndex=function(e){return e.findIndex((function(e){return(0,l.isHistoryCreateEvent)(e)}))},n.findCreateParentLinkEventIndex=function(e){var t=n.props.resourceLinkHelper;return e.findIndex((function(e){var n=(0,l.isHistoryCreateLinkEvent)(e)&&t&&t[e.resource_type];return!!n&&"PARENT"===n.direction}))},n.state={showMore:!1,resourceNames:{}},n.props.events.forEach((function(e){(0,l.isHistoryLinkEvent)(e)&&(n.state.resourceNames[n.generateResourceIdentifier(e)]=r.createElement(c.FormattedMessage,m.default.fetchingData))})),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.events,a=t.resourceLinkHelper;n.forEach((function(t){if((0,l.isHistoryLinkEvent)(t)){var n=a&&a[t.resource_type];n&&n.getName(t.resource_id).then((function(n){e.setState((function(a){return a.resourceNames[e.generateResourceIdentifier(t)]=n,a}))})).catch((function(n){e.setState((function(n){return n.resourceNames[e.generateResourceIdentifier(t)]=r.createElement(c.FormattedMessage,m.default.deleted),n}))}))}}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.events,a=t.formatProperty,o=this.state.showMore,i=this.findCreateParentLinkEventIndex(n),u=n[i];return r.createElement(p.Card,null,r.createElement(f.Row,{className:"section"},n.length>1?r.createElement(f.Row,null,r.createElement("div",{style:{float:"left"},className:"mcs-fields-list-item"},this.findCreateEventIndex(n)>-1?r.createElement(c.FormattedMessage,Object.assign(Object.assign({},m.default.resourceCreated),{values:{userName:n[0].user_identification.user_name,resourceType:r.createElement("span",{className:"name"},r.createElement(c.FormattedMessage,a("history_resource_type").message||m.default.defaultResourceType)),parentLink:u?this.renderLinkEventInMultiEdit(u,!0):""}})):r.createElement(c.FormattedMessage,Object.assign(Object.assign({},m.default.severalFieldsEdited),{values:{userName:n[0].user_identification.user_name}}))),r.createElement("div",{className:"section-cta"},r.createElement(p.Button,{onClick:function(){e.setState({showMore:!e.state.showMore})},className:"mcs-card-inner-action"},o?r.createElement(c.FormattedMessage,m.default.reduceEvents):r.createElement(c.FormattedMessage,m.default.expandEvents))),o&&r.createElement("div",{className:"mcs-fields-list"},this.renderMultiEdit(i>-1?[].concat(y(n.slice(0,i)),y(n.slice(i+1))):n,this.findCreateEventIndex(n)>-1))):r.createElement("div",null,n.map((function(t){return(0,l.isHistoryCreateEvent)(t)?r.createElement("div",{className:"mcs-fields-list-item"},r.createElement(c.FormattedMessage,Object.assign(Object.assign({},m.default.resourceCreated),{values:{userName:t.user_identification.user_name,resourceType:r.createElement("span",{className:"name"},r.createElement(c.FormattedMessage,a("history_resource_type").message||m.default.defaultResourceType)),parentLink:""}}))):(0,l.isHistoryUpdateEvent)(t)?r.createElement("div",{className:"mcs-fields-list-item"},r.createElement(c.FormattedMessage,Object.assign(Object.assign({},m.default.singleFieldEdited),{values:{userName:t.user_identification.user_name,field:e.renderField(t.field_changed),oldValue:e.renderValue(t.field_changed,t.old_value),newValue:e.renderValue(t.field_changed,t.new_value)}}))):(0,l.isHistoryDeleteEvent)(t)?r.createElement("div",{className:"mcs-fields-list-item"},r.createElement(c.FormattedMessage,Object.assign(Object.assign({},m.default.resourceDeleted),{values:{userName:t.user_identification.user_name,resourceType:r.createElement("span",{className:"name"},r.createElement(c.FormattedMessage,a("history_resource_type").message||m.default.defaultResourceType))}}))):(0,l.isHistoryLinkEvent)(t)&&r.createElement("div",{className:"mcs-fields-list-item"},e.renderUniqueLinkEvent(t))})))),r.createElement(f.Row,{style:{padding:"15px 0px 0px",fontWeight:"bold"},className:"timed-footer text-left"},r.createElement("span",null,r.createElement(d.ClockCircleOutlined,{style:{paddingRight:"5px"}}),r.createElement(c.FormattedMessage,Object.assign(Object.assign({},m.default.date),{values:{day:(0,s.default)(n[0].timestamp).format("Do"),month:(0,s.default)(n[0].timestamp).format("MMMM"),time:(0,s.default)(n[0].timestamp).format("HH:mm:ss")}})))))}}]),t}(r.Component);t.default=(0,o.compose)(c.injectIntl,u.withRouter)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceTimelineActionBar=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(11),s=n(182),l=(a=s)&&a.__esModule?a:{default:a},c=n(6),u=n(87);function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=t.ResourceTimelineActionBar=function(e){function t(){return d(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.handleClose,n=e.formatProperty,a=e.intl.formatMessage;return o.createElement(i.Actionbar,{edition:!0,paths:[{name:a(n("history_title").message)||a(l.default.defaultTitle)}]},o.createElement(i.McsIcon,{type:"close",className:"close-icon",onClick:t}))}}]),t}(o.Component);t.default=(0,u.compose)(c.injectIntl)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(33),l=n(10),c=n(8),u=n(68),d=n(56),f=n(11),p=n(114),m=(a=p)&&a.__esModule?a:{default:a},g=n(107),y=n(41);var h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.editCampaign=function(e){var t=n.props,a=t.match.params.organisationId,r=t.history,o=t.location,i="/v2/o/"+a+"/creatives/display/edit/"+e.creative_id;r.push({pathname:i,state:{from:""+o.pathname+o.search}})},n.archiveAd=function(e){var t=n.props.intl.formatMessage;l.Modal.confirm({title:t(m.default.creativeModalConfirmArchivedTitle),content:t(m.default.creativeModalConfirmArchivedContent),icon:o.createElement(y.ExclamationCircleOutlined,null),okText:t(m.default.creativeModalConfirmArchivedOk),cancelText:t(m.default.cancelText),onOk:function(){},onCancel:function(){}})},n.state={pageSize:10},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.location,r=t.history,s=t.isFetching,c=t.isFetchingStat,p=t.dataSet,y=t.intl.formatMessage,h=t.rowSelection,v=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(c)return o.createElement("i",{className:"mcs-table-cell-loading"});var a="EUR"===n?"€ ":"";return(0,d.formatMetric)(e,t,a)},b=function(e,t,n){return void 0===e[n]&&void 0===t[n]?0:void 0===e[n]?-t[n]:void 0===t[n]?e[n]:e[n]-t[n]},_=[{key:"creative_audit_status",isHideable:!1,render:function(e){return o.createElement(g.Popover,{content:"AUDIT_PASSED"===e?o.createElement(i.FormattedMessage,{id:"display.campaign.adtable.ad.auditpassed.msg",defaultMessage:"Audit successful"}):o.createElement(i.FormattedMessage,{id:"display.campaign.adtable.ad.noaudit.msg",defaultMessage:"You need to pass the Audit first"})},o.createElement(f.McsIcon,{className:"AUDIT_PASSED"===e?"font-success":"font-error",type:"AUDIT_PASSED"===e?"check":"close"}))},width:10},{intlMessage:m.default.status,key:"status",isHideable:!1,render:function(t,n){return o.createElement("span",null,o.createElement(l.Switch,{className:"mcs-table-switch",checked:"ACTIVE"===t,onChange:function(t){!function(t,n){var a=e.props.updateAd,r=n?"ACTIVE":"PAUSED",o=n?"PAUSED":"ACTIVE",i=n?{title:y(m.default.notificationSuccess),body:y(m.default.notificationAdActivationSuccess,{name:t.name})}:{title:y(m.default.notificationSuccess),body:y(m.default.notificationAdPauseSuccess,{name:t.name})},s=n?{title:y(m.default.notificationError),body:y(m.default.notificationAdActivationError,{name:t.name})}:{title:y(m.default.notificationError),body:y(m.default.notificationAdPauseError,{name:t.name})};a(t.id,{status:r},{status:o},i,s)}(n,t)},checkedChildren:o.createElement(f.McsIcon,{style:{verticalAlign:"middle"},type:"play"}),unCheckedChildren:o.createElement(f.McsIcon,{style:{verticalAlign:"middle"},type:"pause"})}))}},{key:"image",isVisibleByDefault:!0,isHideable:!0,render:function(e,t){return o.createElement("div",{style:{display:"flex",alignItems:"center",alignContent:"center",justifyContent:"center",minWidth:"100px",minHeight:"100px"}},o.createElement("img",{src:"https://ads.mediarithmics.com/ads/screenshot?rid="+t.creative_id,alt:t.name,style:{maxHeight:100,maxWidth:100}}))}},{intlMessage:m.default.name,key:"name",isHideable:!1,render:function(e,t){return o.createElement(f.Button,{onClick:function(){r.push({pathname:"/v2/o/"+n+"/creatives/display/edit/"+t.creative_id,state:{from:""+a.pathname+a.search}})}},o.createElement("a",null,e))}},{intlMessage:m.default.impressions,key:"impressions",isVisibleByDefault:!0,isHideable:!0,render:function(e){return v(e,"0,0")},sorter:function(e,t){return b(e,t,"impressions")}},{intlMessage:m.default.clicks,key:"clicks",isVisibleByDefault:!0,isHideable:!0,render:function(e){return v(e,"0,0")},sorter:function(e,t){return b(e,t,"clicks")}},{intlMessage:m.default.cpm,key:"cpm",isVisibleByDefault:!0,isHideable:!0,render:function(e){return v(e,"0,0.00","EUR")},sorter:function(e,t){return b(e,t,"cpm")}},{intlMessage:m.default.ctr,key:"ctr",isVisibleByDefault:!0,isHideable:!0,render:function(e){return v(parseFloat(e)/100,"0.000 %")},sorter:function(e,t){return b(e,t,"ctr")}},{intlMessage:m.default.cpc,key:"cpc",isVisibleByDefault:!0,isHideable:!0,render:function(e){return v(e,"0,0.00","EUR")},sorter:function(e,t){return b(e,t,"cpc")}},{intlMessage:m.default.impressions_cost,key:"impressions_cost",isVisibleByDefault:!0,isHideable:!0,render:function(e){return v(e,"0,0.00","EUR")},sorter:function(e,t){return b(e,t,"impressions_cost")}}],S=[{key:"action",actions:function(){return[{intlMessage:m.default.editCampaign,callback:e.editCampaign},{intlMessage:m.default.archiveCampaign,callback:e.archiveAd}]}}],E={pageSize:this.state.pageSize,total:this.props.dataSet?this.props.dataSet.length:0,onShowSizeChange:function(t,n){return e.setState({pageSize:n})},onChange:function(e){h&&h.unselectAllItemIds&&h.allRowsAreSelected&&h.unselectAllItemIds()}};return o.createElement(u.TableView,{columns:_,actionsColumnsDefinition:S,dataSource:p,loading:s,pagination:E,rowSelection:h})}}]),t}(o.Component);t.default=(0,c.compose)(i.injectIntl,s.withRouter)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(10),l=n(13),c=n(6),u=n(107),d=E(n(114)),f=n(11),p=E(n(2054)),m=n(30),g=n(181),y=n(61),h=E(n(2055)),v=n(112),b=E(n(23)),_=n(15),S=n(12);function E(e){return e&&e.__esModule?e:{default:e}}var O=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},w=(0,c.defineMessages)({setStatus:{id:"display.campaigns.dashboard.adGroupCard.status.setStatusTo",defaultMessage:"Set status to"},activeAll:{id:"display.campaigns.dashboard.adGroupCard.status.activeAll",defaultMessage:"Active"},pauseAll:{id:"display.campaigns.dashboard.adGroupCard.status.pauseAll",defaultMessage:"Paused"},archiveSuccess:{id:"display.campaigns.dashboard.adGroupCard.archive.successMsg",defaultMessage:"Ad Groups successfully archived"},saveSuccess:{id:"display.campaigns.dashboard.adGroupCard.save.successMsg",defaultMessage:"Ad Groups successfully saved"}}),M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.archiveAdGroups=function(){n.setState({visible:!0})},n.handleOk=function(){var e=n.props.intl;n.setState({visible:!1,selectedRowKeys:[]}),s.message.success(e.formatMessage(w.archiveSuccess))},n.handleCancel=function(){n.setState({visible:!1})},n.closeDrawerAndNotify=function(){var e=n.props.intl;n.setState({selectedRowKeys:[]}),n.props.closeNextDrawer(),s.message.success(e.formatMessage(w.saveSuccess))},n.openEditAdGroupsDrawer=function(){var e=n.state.allRowsAreSelected,t={close:n.props.closeNextDrawer,onSave:n.saveAdGroups};t.selectedRowKeys=e?void 0:n.state.selectedRowKeys;var a={additionalProps:t};n.props.openNextDrawer(h.default,a)},n.makeEditAction=function(e,t){var a=n.props.match.params.campaignId;return n._adGroupFormService.saveAdGroups(a,e,t).then((function(e){return n.closeDrawerAndNotify(),e})).catch((function(e){throw n.props.notifyError(e),e}))},n.saveAdGroups=function(e){var t=n.props.dataSet,a=n.state,r=a.selectedRowKeys;if(a.allRowsAreSelected&&t){var o=t.map((function(e){return e.id}));return n.makeEditAction(o,e)}return n.makeEditAction(r,e)},n.onSelectChange=function(e){n.setState({selectedRowKeys:e})},n.selectAllItemIds=function(){n.setState({allRowsAreSelected:!0})},n.unselectAllItemIds=function(){n.setState({selectedRowKeys:[],allRowsAreSelected:!1})},n.unsetAllItemsSelectedFlag=function(){n.setState({allRowsAreSelected:!1})},n.handleStatusAction=function(e){var t=n.state,a=t.allRowsAreSelected,r=t.selectedRowKeys,o=n.props,i=o.dataSet,s=o.updateAdGroup;n.setState({isUpdatingStatuses:!0});var l=[];l=a&&i?i.map((function(e){return e.id})):r;var c=[];l.forEach((function(t){c.push((function(){return s(t,{status:e})}))})),(0,v.executeTasksInSequence)(c).then((function(){n.setState({selectedRowKeys:[],allRowsAreSelected:!1,isUpdatingStatuses:!1})})).catch((function(e){n.props.notifyError(e)}))},n.buildMenu=function(){return o.createElement(s.Menu,{onClick:function(e){switch(e.key){case"pause":return n.handleStatusAction("PAUSED");case"activate":return n.handleStatusAction("ACTIVE")}}},o.createElement(s.Menu.Item,{key:"pause"},o.createElement(c.FormattedMessage,w.pauseAll)),o.createElement(s.Menu.Item,{key:"activate"},o.createElement(c.FormattedMessage,w.activeAll)))},n.state={selectedRowKeys:[],visible:!1,allRowsAreSelected:!1,isArchiving:!1,isUpdatingStatuses:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"updateLocationSearch",value:function(e){var t=this.props,n=t.history,a=t.location,r=a.search,o={pathname:a.pathname,search:(0,m.updateSearch)(r,e,g.DISPLAY_DASHBOARD_SEARCH_SETTINGS)};n.push(o)}},{key:"renderDatePicker",value:function(){var e=this,t=this.props.location.search,n=(0,m.parseSearch)(t,g.DISPLAY_DASHBOARD_SEARCH_SETTINGS),a={from:n.from,to:n.to};return o.createElement(f.McsDateRangePicker,{values:a,onChange:function(t){return e.updateLocationSearch({from:t.from,to:t.to})}})}},{key:"render",value:function(){var e=this,t=this.props,n=t.history,a=t.match.params,r=a.campaignId,i=a.organisationId,l=t.updateAdGroup,m=t.title,g=t.isFetching,y=t.isFetchingStat,h=t.dataSet,v=t.campaign,b=this.state,_=b.selectedRowKeys,S=b.allRowsAreSelected,E=b.isUpdatingStatuses,O=!!(_&&_.length>0),M=o.createElement("span",null,v&&"V2014_06"!==v.model_version&&o.createElement(s.Button,{className:"m-r-10",type:"primary",onClick:function(){n.push({pathname:"/v2/o/"+i+"/campaigns/display/"+r+"/adgroups/create",state:{from:""+location.pathname+location.search}})}},o.createElement(c.FormattedMessage,d.default.newAdGroups)),this.renderDatePicker(),o.createElement(f.Slide,{toShow:O,horizontal:!0,content:o.createElement(s.Button,{className:"m-r-10 button-slider button-glow",onClick:this.archiveAdGroups},o.createElement(f.McsIcon,{type:"delete"}),o.createElement(c.FormattedMessage,d.default.archiveAdGroup))}),O?o.createElement(s.Modal,{title:o.createElement(c.FormattedMessage,d.default.archiveAdGroupsModalTitle),visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel},o.createElement("p",null,o.createElement(c.FormattedMessage,d.default.archiveAdGroupsModalMessage))):null,v&&"V2014_06"!==v.model_version?o.createElement(f.Slide,{toShow:O,horizontal:!0,content:o.createElement(s.Button,{className:"m-r-10 button-slider button-glow",onClick:this.openEditAdGroupsDrawer},o.createElement(f.McsIcon,{type:"pen"}),o.createElement(c.FormattedMessage,d.default.editAdGroup))}):null,o.createElement(f.Slide,{toShow:O,horizontal:!0,content:o.createElement(u.Dropdown,{overlay:e.buildMenu(),trigger:["click"]},o.createElement(s.Button,{className:"button-glow"},o.createElement(f.McsIcon,{type:"chevron"}),o.createElement(c.FormattedMessage,w.setStatus)))})),P={selectedRowKeys:_,allRowsAreSelected:S,selectAllItemIds:this.selectAllItemIds,unselectAllItemIds:this.unselectAllItemIds,onChange:this.onSelectChange,onSelect:this.unsetAllItemsSelectedFlag,onSelectAll:this.unsetAllItemsSelectedFlag};return o.createElement(f.Card,{title:m,buttons:M},o.createElement("hr",null),o.createElement(p.default,{isFetching:g||E,isFetchingStat:y,dataSet:h,updateAdGroup:l,rowSelection:P,campaign:v}))}}]),t}(o.Component);O([(0,_.lazyInject)(S.TYPES.IAdGroupFormService)],M.prototype,"_adGroupFormService",void 0),t.default=(0,i.compose)(c.injectIntl,l.withRouter,y.injectDrawer,b.default)(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(33),l=n(10),c=n(8),u=n(114),d=(a=u)&&a.__esModule?a:{default:a},f=n(68),p=n(56),m=n(11);var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.editCampaign=function(e){var t=n.props,a=t.match.params,r=a.campaignId,o=a.organisationId,i=t.history,s=t.location;i.push({pathname:"/v2/o/"+o+"/campaigns/display/"+r+"/adgroups/edit/"+e.id,state:{from:""+s.pathname+s.search}})},n.duplicateCampaign=function(e){var t=n.props,a=t.match.params,r=a.campaignId,o=a.organisationId,i=t.history,s=t.location;i.push({pathname:"/v2/o/"+o+"/campaigns/display/"+r+"/adgroups/create",state:{from:""+s.pathname+s.search,adGroupId:e.id}})},n.archiveAdGroup=function(){},n.state={pageSize:10},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.campaignId,a=t.isFetching,r=t.isFetchingStat,i=t.history,s=t.dataSet,c=t.rowSelection,u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(r)return o.createElement("i",{className:"mcs-table-cell-loading"});var a="EUR"===n?"€ ":"";return(0,p.formatMetric)(e,t,a)},g=[{intlMessage:d.default.status,key:"status",isHideable:!1,render:function(t,n){return o.createElement("span",null,o.createElement(l.Switch,{className:"mcs-table-switch",checked:"ACTIVE"===t,onChange:function(t){!function(t,n){var a=e.props,r=a.updateAdGroup,o=a.intl.formatMessage,i=n?"ACTIVE":"PAUSED",s=n?"PAUSED":"ACTIVE",l=n?{title:o(d.default.notificationSuccess),body:o(d.default.notificationAdGroupActivationSuccess,{name:t.name})}:{title:o(d.default.notificationSuccess),body:o(d.default.notificationAdGroupPauseSuccess,{name:t.name})},c=n?{title:o(d.default.notificationError),body:o(d.default.notificationAdGroupActivationError,{name:t.name})}:{title:o(d.default.notificationError),body:o(d.default.notificationAdGroupPauseError,{name:t.name})};r(t.id,{status:i},l,c,{status:s})}(n,t)},checkedChildren:o.createElement(m.McsIcon,{style:{verticalAlign:"middle"},type:"play"}),unCheckedChildren:o.createElement(m.McsIcon,{style:{verticalAlign:"middle"},type:"pause"})}))}},{intlMessage:d.default.name,key:"name",isHideable:!1,render:function(e,t){return o.createElement(m.Button,{onClick:function(){i.push({pathname:n+"/adgroups/"+t.id,state:{from:""+location.pathname+location.search}})}},o.createElement("a",null,e))}},{intlMessage:d.default.impressions,key:"impressions",isVisibleByDefault:!0,isHideable:!0,render:function(e){return u(e,"0,0")}},{intlMessage:d.default.clicks,key:"clicks",isVisibleByDefault:!0,isHideable:!0,render:function(e){return u(e,"0,0")}},{intlMessage:d.default.cpm,key:"cpm",isVisibleByDefault:!0,isHideable:!0,render:function(e){return u(e,"0,0.00","EUR")}},{intlMessage:d.default.ctr,key:"ctr",isVisibleByDefault:!0,isHideable:!0,render:function(e){return u(parseFloat(e)/100,"0.000 %")}},{intlMessage:d.default.cpc,key:"cpc",isVisibleByDefault:!0,isHideable:!0,render:function(e){return u(e,"0,0.00","EUR")}},{intlMessage:d.default.impressions_cost,key:"impressions_cost",isVisibleByDefault:!0,isHideable:!0,render:function(e){return u(e,"0,0.00","EUR")}}],y=[];this.props.campaign&&"V2014_06"!==this.props.campaign.model_version&&y.push({intlMessage:d.default.editCampaign,callback:this.editCampaign},{intlMessage:d.default.duplicate,callback:this.duplicateCampaign});var h=[{key:"action",actions:function(){return y}}],v={pageSize:this.state.pageSize,total:this.props.dataSet?this.props.dataSet.length:0,onShowSizeChange:function(t,n){return e.setState({pageSize:n})},onChange:function(e){c&&c.unselectAllItemIds&&c.allRowsAreSelected&&c.unselectAllItemIds()}};return o.createElement(f.TableView,{columns:g,actionsColumnsDefinition:h,dataSource:s,loading:a,rowSelection:c,pagination:v})}}]),t}(o.Component);t.default=(0,c.compose)(i.injectIntl,s.withRouter)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(35),l=n(13),c=n(6),u=n(8),d=b(n(2056)),f=b(n(60)),p=b(n(95)),m=n(24),g=b(n(23)),y=n(15),h=n(12),v=n(11);function b(e){return e&&e.__esModule?e:{default:e}}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S="editAdGroupsForm",E=(0,c.defineMessages)({allAdGroupsNames:{id:"edit.campaign.all.adgroups.names",defaultMessage:"You have selected all the ad groups."},dateError:{id:"edit.adgroups.startDate.after.endDate",defaultMessage:"Warning : Start date is after end date !"}}),O=s.FieldArray,w=i.Layout.Content,M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchData=function(e){var t=n.props.match.params.campaignId;Promise.all(e.map((function(e){return n._displayCampaignService.getAdGroup(t,e).then((function(e){return e.data})).then((function(e){return e.name||""}))}))).then((function(e){n.setState({adGroupNames:e})}))},n.save=function(e){var t=n.props.intl,a=e.fields.filter((function(e){return"start_date"===e.adGroupProperty}))[0],r=e.fields.filter((function(e){return"end_date"===e.adGroupProperty}))[0];return a&&r&&a.value>r.value?i.message.warning(t.formatMessage(E.dateError)):(n.setState({loading:!0}),n.props.onSave(e).catch((function(e){n.setState({loading:!1})})))},n.state={adGroupNames:[],loading:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.selectedRowKeys,n=e.intl;t?this.fetchData(t):this.setState({adGroupNames:[n.formatMessage(E.allAdGroupsNames)]})}},{key:"componentDidUdpate",value:function(e){var t=this.props,n=t.selectedRowKeys,a=t.intl,r=e.selectedRowKeys,o=this.state.adGroupNames;n&&r&&n!==r?this.fetchData(n):1===o.length&&o[0]===a.formatMessage(E.allAdGroupsNames)||this.setState({adGroupNames:[a.formatMessage(E.allAdGroupsNames)]})}},{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.close,a=e.intl.formatMessage,r={formId:S,paths:[{name:a(p.default.editAdGroups)}],message:p.default.saveAdGroup,onClose:n};return this.state.loading?o.createElement(v.Loading,{isFullScreen:!0}):o.createElement(i.Layout,{className:"edit-layout"},o.createElement(f.default,r),o.createElement(i.Layout,{className:"ant-layout-has-sider"},o.createElement(s.Form,{className:"edit-layout ant-layout edit-adgroups-form",onSubmit:t(this.save)},o.createElement(w,{id:S,className:"mcs-content-container mcs-form-container"},o.createElement(m.FormSection,{subtitle:{id:"editAdGroups.subtitle",defaultMessage:"In this section you will be able to edit ad groups you just selected : "},title:p.default.multiEditAdGroupsTitle}),o.createElement(i.Row,{style:{marginBottom:"3em"}},this.state.adGroupNames.map((function(e,t){return o.createElement(i.Tag,{key:t},e)}))),o.createElement("div",{className:"ant-col-4 content"}),o.createElement("div",{className:"ant-col-16 content"},o.createElement(O,{name:"fields",component:d.default,rerenderOnEveryChange:!0}))))))}}]),t}(o.Component);_([(0,y.lazyInject)(h.TYPES.IDisplayCampaignService)],M.prototype,"_displayCampaignService",void 0),t.default=(0,u.compose)((0,s.reduxForm)({form:S,enableReinitialize:!0}),c.injectIntl,l.withRouter,g.default)(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(8),l=n(6),c=n(24),u=n(49),d=(a=u)&&a.__esModule?a:{default:a},f=n(11);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=["total_budget","max_bid_price","max_budget_per_period","start_date","end_date"],y=function(e){function t(){p(this,t);var e=m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.getAvailableOptions=function(){var t=e.props,n=t.fields,a=t.intl,r=n.getAll()?n.getAll().map((function(e){return e.adGroupProperty})):[];return g.map((function(e){return{title:a.formatMessage(h[e]),value:e,disabled:r.includes(e)}}))},e.attachToDOM=function(e){return function(t){return document.getElementById(e)}},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.props.fields.push({adGroupProperty:this.getAvailableOptions()[0].value,action:"equals"})}},{key:"render",value:function(){var e=this,t=this.props,n=t.fields,a=t.fieldValidators,r=a.isRequired,s=a.isValidInteger,l=a.isNotZero,u=a.isValidFloat,d=t.intl,p=[{title:d.formatMessage(v.equals),value:"equals"},{title:d.formatMessage(v.increase),value:"increase"},{title:d.formatMessage(v.decrease),value:"decrease"}];return o.createElement("div",null,o.createElement(i.Row,null,n.map((function(t,a){var d="start_date"===n.get(a).adGroupProperty||"end_date"===n.get(a).adGroupProperty,m=[];switch(n.get(a).adGroupProperty){case"max_bid_price":m=[r,s];break;case"total_budget":case"max_budget_per_period":m=[r,u,l];break;case"start_date":m=[r]}return o.createElement(i.Row,{key:a,gutter:16},o.createElement(i.Col,{className:"gutter-row",span:7},o.createElement(c.FormSelectField,{name:t+".adGroupProperty",component:c.DefaultSelect,options:e.getAvailableOptions(),formItemProps:{label:"Field",labelCol:{span:4},wrapperCol:{span:20}}})),o.createElement(i.Col,{className:"gutter-row",span:7},o.createElement(c.FormSelectField,{name:t+".action",component:c.DefaultSelect,formItemProps:{label:"Action",labelCol:{span:4},wrapperCol:{span:20}},options:d?[p[0]]:p})),o.createElement(i.Col,{className:"gutter-row",span:7},d?o.createElement(c.FormDatePickerField,{name:t+".value",component:c.FormDatePicker,validate:m,unixTimestamp:!0,formItemProps:{label:"Value",labelCol:{span:4},wrapperCol:{span:20}},datePickerProps:{style:{width:"100%"}}}):o.createElement(c.FormInputField,{name:t+".value",component:c.FormInput,validate:m,formItemProps:{label:"Value",labelCol:{span:4},wrapperCol:{span:20}},inputProps:{}})),o.createElement(i.Col,{className:"gutter-row",span:3},o.createElement(i.Button,{className:"delete-fieldarray",onClick:function(){return n.remove(a)}},o.createElement(f.McsIcon,{type:"close"}))))}))),n.getAll()&&n.getAll().length<=g.length-1&&o.createElement(i.Row,null,o.createElement("div",{onClick:function(){var t=e.getAvailableOptions().filter((function(e){return!e.disabled}));n.push({adGroupProperty:t[0].value,action:"equals"})}},o.createElement(i.Col,{span:22,offset:1,className:"gutter-row add-field-button"},o.createElement("p",null,o.createElement(f.McsIcon,{type:"plus"}),"Add Field")))))}}]),t}(o.Component);t.default=(0,s.compose)(l.injectIntl,d.default)(y);var h=(0,l.defineMessages)({max_bid_price:{id:"display.campaigns.edit.adgroup.multiEdit.option.maxBidPrice",defaultMessage:"Max Bid Price"},total_budget:{id:"display.campaigns.edit.adgroup.multiEdit.option.totalBudget",defaultMessage:"Total Budget"},max_budget_per_period:{id:"display.campaigns.edit.adgroup.multiEdit.option.budgetSplit",defaultMessage:"Budget Split"},start_date:{id:"display.campaigns.edit.adgroup.multiEdit.option.startDate",defaultMessage:"Start Date"},end_date:{id:"display.campaigns.edit.adgroup.multiEdit.option.endDate",defaultMessage:"End Date"}}),v=(0,l.defineMessages)({equals:{id:"display.campaigns.edit.adgroup.multiEdit.option.equals",defaultMessage:"="},increase:{id:"display.campaigns.edit.adgroup.multiEdit.option.increase",defaultMessage:"Increase %"},decrease:{id:"display.campaigns.edit.adgroup.multiEdit.option.decrease",defaultMessage:"Decrease %"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(25),s=d(n(798)),l=d(n(2058)),c=n(15),u=n(12);function d(e){return e&&e.__esModule?e:{default:e}}function f(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var p=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchLabbellableLables=function(e,t,a){n._labelService.getLabels(e,{labelable_id:t,labelable_type:a}).then((function(e){return e.data})).then((function(e){return n.setState({labels:e})}))},n.onChange=function(e){if(e.length>n.state.labels.length){var t=e.map((function(e){return n.state.labels.find((function(t){return e.id===t.id}))?null:e})).filter((function(e){return e&&e.id}))[0];t&&(n._labelService.pairLabels(t.id,n.props.labellableType,n.props.labellableId),n.setState({labels:[].concat(f(n.state.labels),[t])}))}if(e.length<n.state.labels.length){var a=n.state.labels.map((function(t){return e.find((function(e){return e.id===t.id}))?null:t})).filter((function(e){return e&&e.id}))[0];a&&(n._labelService.unPairLabels(a.id,n.props.labellableType,n.props.labellableId),n.setState({labels:e}))}},n.state={labels:[],inputVisible:!1,inputValue:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.organisationId,n=e.labellableId,a=e.labellableType;this.fetchLabbellableLables(t,n,a)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.organisationId,a=t.labellableId,r=t.labellableType,o=e.organisationId,i=e.labellableId,s=e.labellableType;a===i&&n===o&&r===s||this.fetchLabbellableLables(n,a,r)}},{key:"render",value:function(){var e=this.state.labels,t=this.props.orgLabels;return o.createElement(s.default,{labels:t,selectedLabels:e,onChange:this.onChange,buttonMessage:l.default.labelButton})}}]),t}(o.Component);p([(0,c.lazyInject)(u.TYPES.ILabelService)],m.prototype,"_labelService",void 0),t.default=(0,i.connect)((function(e){return{orgLabels:e.labels.labelsApi.data}}))(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({labelButton:{id:"labels.button",defaultMessage:"Label"},labelNoResults:{id:"labels.no_results",defaultMessage:"No Results"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(340),l=S(n(338)),c=S(n(2060)),u=n(13),d=n(8),f=S(n(2062)),p=n(181),m=n(30),g=S(n(114)),y=n(6),h=S(n(23)),v=n(1020),b=n(15),_=n(12);function S(e){return e&&e.__esModule?e:{default:e}}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var w=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=i.Layout.Content,P=function(e){function t(){E(this,t);var e=O(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.archiveCampaign=function(t){var n=e.props,a=n.history,r=n.match.params.organisationId;return e._displayCampaignService.updateCampaign(t,{archived:!0}).then((function(){a.push({pathname:"/v2/o/"+r+"/campaigns/display"})})).catch((function(t){e.props.notifyError(t)}))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.history,n=e.location,a=n.search,r=n.pathname;(0,m.isSearchValid)(a,p.DISPLAY_DASHBOARD_SEARCH_SETTINGS)||t.replace({pathname:r,search:(0,m.buildDefaultSearch)(a,p.DISPLAY_DASHBOARD_SEARCH_SETTINGS)})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.location,a=n.pathname,r=n.search,o=t.history,i=e.location.search;(0,m.compareSearches)(r,i)||(0,m.isSearchValid)(r,p.DISPLAY_DASHBOARD_SEARCH_SETTINGS)||o.replace({pathname:a,search:(0,m.buildDefaultSearch)(r,p.DISPLAY_DASHBOARD_SEARCH_SETTINGS)})}},{key:"render",value:function(){var e=this.props,t=e.campaign,n=e.match.params.organisationId,a=(0,v.flatten)(t.ad_groups.map((function(e){return e.ads.map((function(t){return o.createElement(f.default,{key:t.id,ad:t,adGroupId:e.id})}))})));return o.createElement("div",{className:"ant-layout"},o.createElement(c.default,{campaign:t,archiveCampaign:this.archiveCampaign}),o.createElement("div",{className:"ant-layout"},o.createElement(M,{className:"mcs-content-container"},o.createElement(l.default,{campaign:t,showStatus:!1}),o.createElement(s.Labels,{labellableId:t.id,organisationId:n,labellableType:"DISPLAY_CAMPAIGN"}),a,0===a.length&&o.createElement(i.Row,null,o.createElement(i.Col,{span:24,className:"mcs-table-view-empty",style:{marginTop:200}},o.createElement(y.FormattedMessage,g.default.emptyAds))))))}}]),t}(o.Component);w([(0,b.lazyInject)(_.TYPES.IDisplayCampaignService)],P.prototype,"_displayCampaignService",void 0),t.default=(0,d.compose)(u.withRouter,h.default)(P)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(11),s=n(10),l=n(41),c=n(6),u=E(n(114)),d=n(13),f=n(8),p=E(n(59)),m=E(n(309)),g=n(2061),y=n(61),h=E(n(273)),v=n(152),b=E(n(182)),_=n(15),S=n(12);function E(e){return e&&e.__esModule?e:{default:e}}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var M=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},P=function(e){function t(){O(this,t);var e=w(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.getSnippet=function(t){var n=e.props,a=n.campaign,r=n.intl.formatMessage,o=n.match.params.organisationId,i=[];a.ad_groups.forEach((function(e){return e.ads.forEach((function(e){return i.push(e)}))})),(0,g.generateCsvData)(o,a,t.key,i,r)},e.editCampaign=function(){var t=e.props,n=t.location,a=t.history,r=t.match.params,o=r.organisationId,i=r.campaignId,l=t.campaign,c=t.intl;if(l&&"V2014_06"===l.model_version)s.message.info(c.formatMessage(u.default.editionNotAllowed));else{var d="/v2/o/"+o+"/campaigns/display/"+i+"/edit";a.push({pathname:d,state:{from:""+n.pathname+n.search}})}},e.buildMenu=function(){var t=e.props,n=t.campaign,a=t.archiveCampaign,r=t.intl.formatMessage;return o.createElement(s.Menu,{onClick:function(t){var i,u=e.props,d=u.match.params,f=d.organisationId,g=d.campaignId,y=u.history;switch(t.key){case"ARCHIVED":return n?(i=n.id,void s.Modal.confirm({title:r(m.default.archiveCampaignConfirm),content:r(m.default.archiveCampaignMessage),icon:o.createElement(l.ExclamationCircleOutlined,null),okText:r(m.default.confirm),cancelText:r(m.default.cancel),onOk:function(){return a(i)}})):null;case"DUPLICATE":return e.duplicateCampaign();case"HISTORY":return e.props.openNextDrawer(h.default,{size:"small",additionalProps:{resourceType:"CAMPAIGN",resourceId:g,handleClose:function(){return e.props.closeNextDrawer()},formatProperty:v.formatDisplayCampaignProperty,resourceLinkHelper:{AD_GROUP:{direction:"CHILD",getType:function(){return o.createElement(c.FormattedMessage,b.default.adGroupResourceType)},getName:function(t){return e._displayCampaignService.getAdGroup(g,t).then((function(e){return e.data.name||t}))},goToResource:function(e){y.push("/v2/o/"+f+"/campaigns/display/"+g+"/adgroups/"+e)}}}}});default:return function(){p.default.error("onclick error")}}}},o.createElement(s.Menu.Item,{key:"HISTORY"},o.createElement(c.FormattedMessage,u.default.history)),n&&"V2014_06"===n.model_version?null:o.createElement(s.Menu.Item,{key:"DUPLICATE"},o.createElement(c.FormattedMessage,u.default.duplicate)),o.createElement(s.Menu.Item,{key:"ARCHIVED"},o.createElement(c.FormattedMessage,u.default.archiveCampaign)))},e.duplicateCampaign=function(){var t=e.props,n=t.location,a=t.history,r=t.match.params,o=r.organisationId,i=r.campaignId,s="/v2/o/"+o+"/campaigns/display/create";a.push({pathname:s,state:{from:""+n.pathname+n.search,campaignId:i}})},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.intl.formatMessage,a=e.campaign,r=this.buildMenu(),d=[{name:n(u.default.display),path:"/v2/o/"+t+"/campaigns/display"},{name:a&&a.name?a.name:""}],f=o.createElement(s.Menu,{onClick:this.getSnippet},o.createElement(s.Menu.Item,{key:"GOOGLE_DFP"},o.createElement(c.FormattedMessage,u.default.googleDfp)),o.createElement(s.Menu.Item,{key:"GOOGLE_DBM"},o.createElement(c.FormattedMessage,u.default.googleDbm)),o.createElement(s.Menu.Item,{key:"APX"},o.createElement(c.FormattedMessage,u.default.apx)),o.createElement(s.Menu.Item,{key:"SMART"},o.createElement(c.FormattedMessage,u.default.smartAdServer)),o.createElement(s.Menu.Item,{key:"NONE"},o.createElement(c.FormattedMessage,u.default.none)));return o.createElement(i.Actionbar,{paths:d},o.createElement(s.Dropdown,{overlay:f,trigger:["click"]},o.createElement(s.Button,{className:"mcs-primary",type:"primary"},o.createElement(i.McsIcon,{type:"download"}),o.createElement(c.FormattedMessage,u.default.adServingDownload))),a&&"V2014_06"===a.model_version?null:o.createElement(s.Button,{onClick:this.editCampaign},o.createElement(i.McsIcon,{type:"pen"}),o.createElement(c.FormattedMessage,u.default.editCampaign)),o.createElement(s.Dropdown,{overlay:r,trigger:["click"]},o.createElement(s.Button,null,o.createElement(l.EllipsisOutlined,null))))}}]),t}(o.Component);M([(0,_.lazyInject)(S.TYPES.IDisplayCampaignService)],P.prototype,"_displayCampaignService",void 0),t.default=(0,f.compose)(d.withRouter,c.injectIntl,y.injectDrawer)(P)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateCsvData=function(e,t,n,a,o){var l=a.map((function(e){var a=(0,r.split)(e.format,"x"),o=t.ad_groups.find((function(t){return!!t.ads.find((function(t){return t.id===e.id}))})).id;return{creative_name:e.name,snippet_code:s(e.creative_id,Number(a[0]),Number(a[1]),n,t.id,o)}}));i.default.exportCreativeAdServingSnippet(e,t.name,l,o)};var a,r=n(54),o=n(142),i=(a=o)&&a.__esModule?a:{default:a};function s(e,t,n,a,r,o){return'<iframe src="https://ads.mediarithmics.com/ads/render?ctx=LIVE&rid='+e+"&clktr="+function(e){switch(e){case"GOOGLE_DFP":return"%%CLICK_URL_ESC%%";case"GOOGLE_DBM":case"APX":return"${CLICK_URL_ENC}";case"SMART":return"[countgo]";default:return"/*INSERT HERE YOUR CLICK TRACKING URL*/"}}(a)+"&cid="+r+"&gid="+o+'" width="'+t+'" height="'+n+'" frameborder="0" scrolling="no"></iframe>'}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(11),s=n(8),l=n(13),c=n(30),u=n(181),d=_(n(114)),f=n(6),p=_(n(81)),m=_(n(69)),g=n(415),y=_(n(78)),h=n(44),v=n(56),b=_(n(801));function _(e){return e&&e.__esModule?e:{default:e}}var S=g.LegendChart,E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.cancelablePromises=[],n.filterValueForCampaign=function(e,t){return e.filter((function(e){return e.campaign_id===t}))},n.fetchData=function(e,t,a,r,o){var i=n.props.adGroupId,s=r.toMoment().unix()-a.toMoment().unix()>172800?["day","campaign_id"]:["day,hour_of_day","campaign_id"],l=(0,h.makeCancelable)(y.default.getAdDeliveryReport(e,"creative_id",t,a,r,s,void 0,{campaign_id:o,ad_group_id:i}));n.cancelablePromises.push(l),n.setState({loading:!0}),l.promise.then((function(e){return n.filterValueForCampaign((0,v.normalizeReportView)(e.data.report_view),o)})).then((function(e){var t=e;n.setState({loading:!1,dataSource:t})}))},n.state={dataSource:[],loading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.ad,n=e.match.params,a=n.organisationId,r=n.campaignId,o=e.location.search,i=(0,c.parseSearch)(o,u.DISPLAY_DASHBOARD_SEARCH_SETTINGS);this.fetchData(a,t.creative_id,i.from,i.to,r)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.ad,a=t.match.params,r=a.organisationId,o=a.campaignId,i=t.location.search,s=e.ad,l=e.match.params,d=l.organisationId,f=l.campaignId,p=e.location.search;if(n.id!==s.id||r!==d||!(0,c.compareSearches)(i,p)||o!==f){var m=(0,c.parseSearch)(i,u.DISPLAY_DASHBOARD_SEARCH_SETTINGS);this.fetchData(r,n.creative_id,m.from,m.to,o)}}},{key:"updateLocationSearch",value:function(e){var t=this.props,n=t.history,a=t.location,r=a.search,o={pathname:a.pathname,search:(0,c.updateSearch)(r,e,u.DISPLAY_DASHBOARD_SEARCH_SETTINGS)};n.push(o)}},{key:"renderDatePicker",value:function(){var e=this,t=this.props.location.search,n=(0,c.parseSearch)(t,u.DISPLAY_DASHBOARD_SEARCH_SETTINGS),a={from:n.from,to:n.to};return r.createElement(i.McsDateRangePicker,{values:a,onChange:function(t){return e.updateLocationSearch({from:t.from,to:t.to})}})}},{key:"createLegend",value:function(){var e=this.props.intl.formatMessage;return[{key:"impressions",domain:e(d.default.impressions)},{key:"clicks",domain:e(d.default.clicks)}]}},{key:"renderChart",value:function(){var e=this,t=this.props.colors,n=this.state.dataSource,a={xKey:"day",yKeys:[{key:"clicks",message:d.default.clicks},{key:"impressions",message:d.default.impressions}],colors:[t["mcs-warning"],t["mcs-info"]],isDraggable:!0,onDragEnd:function(t){e.updateLocationSearch({from:new p.default(t[0]),to:new p.default(t[1])})}};return r.createElement("div",{style:{display:"flex"}},r.createElement(b.default,{dataset:n,options:a,style:{flex:"1"}}))}},{key:"render",value:function(){var e=this.props,t=e.ad,n=e.intl.formatMessage,a=e.colors,s=this.state,l=s.dataSource,c=s.loading,u=t.name,f=[{key:"clicks",domain:n(d.default.clicks),color:a["mcs-warning"]},{key:"impressions",domain:n(d.default.impressions),color:a["mcs-info"]}],p=this.createLegend();return r.createElement(i.Card,{title:u,buttons:r.createElement("span",null,this.renderDatePicker())},r.createElement("hr",null),r.createElement(o.Row,{className:"mcs-chart-header"},r.createElement(o.Col,{span:12},l&&0===l.length&&c?r.createElement("div",null):r.createElement(S,{identifier:"chartLegend-"+t.id,options:f,legends:p}))),c?r.createElement(i.LoadingChart,null):null,l.length||c?null:r.createElement(i.EmptyChart,{title:n(d.default.noStatAvailable),icon:"warning"}),l.length&&!c?this.renderChart():null)}}]),t}(r.Component);t.default=(0,s.compose)(l.withRouter,f.injectIntl,m.default)(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=P(n(0)),i=n(33),s=n(8),l=n(25),c=n(6),u=n(10),d=n(181),f=M(n(114)),p=M(n(2064)),m=M(n(78)),g=n(83),y=n(44),h=M(n(59)),v=n(56),b=n(30),_=P(n(124)),S=M(n(23)),E=n(803),O=n(15),w=n(12);function M(e){return e&&e.__esModule?e:{default:e}}function P(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var T=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},I=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.cancelablePromises=[],n.catchCancellablePromises=function(e,t,a){e.isCanceled||(h.default.error(e),n.setState((function(e){var n=Object.assign({},e);return n[t][a].isLoading=!1,n[t][a].error=!0,n[t][a].hasFetched=!0,n})))},n.updateAdGroup=n.updateAdGroup.bind(n),n.updateAd=n.updateAd.bind(n),n.state=E.initialAdGroupPageState,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.history,n=e.location,a=n.search,r=n.pathname,o=e.match.params,i=o.organisationId,s=o.campaignId,l=o.adGroupId;if((0,b.isSearchValid)(a,d.DISPLAY_DASHBOARD_SEARCH_SETTINGS)){var c=(0,b.parseSearch)(a,d.DISPLAY_DASHBOARD_SEARCH_SETTINGS);this.fetchAllData(i,s,l,c)}else t.replace({pathname:r,search:(0,b.buildDefaultSearch)(a,d.DISPLAY_DASHBOARD_SEARCH_SETTINGS)})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.location,a=n.pathname,r=n.search,o=t.match.params,i=o.organisationId,s=o.campaignId,l=o.adGroupId,c=t.history,u=e.location.search,f=e.match.params,p=f.campaignId,m=f.organisationId,g=f.adGroupId;if(!(0,b.compareSearches)(r,u)||s!==p||l!==g||i!==m)if((0,b.isSearchValid)(r,d.DISPLAY_DASHBOARD_SEARCH_SETTINGS)){var y=(0,b.parseSearch)(r,d.DISPLAY_DASHBOARD_SEARCH_SETTINGS);this.fetchAllData(i,s,l,y)}else c.replace({pathname:a,search:(0,b.buildDefaultSearch)(r,d.DISPLAY_DASHBOARD_SEARCH_SETTINGS)})}},{key:"componentWillUnmount",value:function(){this.cancelablePromises.forEach((function(e){return e.cancel()}))}},{key:"formatReportView",value:function(e,t){var n=(0,v.normalizeReportView)(e);return(0,g.normalizeArrayOfObject)(n,t)}},{key:"fetchAllData",value:function(e,t,n,a){var r=this,o=a.to.toMoment().unix()-a.from.toMoment().unix()>172800?["day"]:["day,hour_of_day"],i=(0,y.makeCancelable)(m.default.getAdGroupDeliveryReport(e,"ad_group_id",n,a.from,a.to,o)),s=(0,y.makeCancelable)(m.default.getAdDeliveryReport(e,"ad_group_id",n,a.from,a.to,void 0)),l=(0,y.makeCancelable)(m.default.getMediaDeliveryReport(e,"ad_group_id",n,a.from,a.to,void 0,void 0,{sort:"clicks",limit:30})),c=(0,y.makeCancelable)(m.default.getAdGroupDeliveryReport(e,"ad_group_id",n,a.from,a.to,void 0,["cpa","cpm","ctr","cpc","impressions_cost"]));this.cancelablePromises.push(i,s,l,c),this.setState((function(e){var t=Object.assign({},e);return t.campaign.data.isLoading=!0,t.adGroups.data.isLoading=!0,t.ads.data.isLoading=!0,t.adGroups.mediaPerformance.isLoading=!0,t.adGroups.performance.isLoading=!0,t.adGroups.overallPerformance.isLoading=!0,t.ads.performance.isLoading=!0,t})),r._displayCampaignService.getCampaignDisplayViewDeep(t,{view:"deep"}).then((function(e){var t=e.data,a=t.ad_groups,o=I(t,["ad_groups"]),i=a.filter((function(e){return e.id===n}))[0],s=i.ads,l=I(i,["ads"]);r.setState((function(e){var t=Object.assign({},e);return t.campaign.data.isLoading=!1,t.adGroups.data.isLoading=!1,t.ads.data.isLoading=!1,t.campaign.data.items=[o],t.adGroups.data.items=[l],t.ads.data.items=(0,g.normalizeArrayOfObject)(s,"id"),t}))})),c.promise.then((function(e){r.updateStateOnPerf("adGroups","overallPerformance","items",(0,v.normalizeReportView)(e.data.report_view))})).catch((function(e){return r.catchCancellablePromises(e,"adGroups","overallPerformance")})),i.promise.then((function(e){r.updateStateOnPerf("adGroups","performance","items",(0,v.normalizeReportView)(e.data.report_view))})).catch((function(e){return r.catchCancellablePromises(e,"adGroups","performance")})),s.promise.then((function(e){r.updateStateOnPerf("ads","performance","items",r.formatReportView(e.data.report_view,"message_id"))})).catch((function(e){return r.catchCancellablePromises(e,"ads","performance")})),l.promise.then((function(e){var t=Object.assign({},e.data.report_view);t.rows=t.rows.splice(0,30),r.updateStateOnPerf("adGroups","mediaPerformance","items",(0,v.normalizeReportView)(t))})).catch((function(e){return r.catchCancellablePromises(e,"adGroups","mediaPerformance")}))}},{key:"updateStateOnPerf",value:function(e,t,n,a){this.setState((function(r){var o=Object.assign({},r);return o[e][t].isLoading=!1,o[e][t].hasFetched=!0,o[e][t][n]=a,o}))}},{key:"updateAdGroup",value:function(e,t){var n=this,a=this.state.campaign.data.items,r=a&&a[0]?a[0].id:void 0;return r?this._displayCampaignService.updateAdGroup(r,e,t).then((function(e){n.setState((function(t){var n=Object.assign({},t);return n.adGroups.data.items=[e.data],n}))})).catch((function(e){n.props.notifyError(e)})):Promise.resolve()}},{key:"updateAd",value:function(e,t,n,a,r){var i=this,s=this.props,l=s.intl.formatMessage,c=s.notifySuccess,d=s.notifyError,p=s.removeNotification,m=this.state,g=m.campaign,y=m.adGroups;return this.setState((function(n){var a=Object.assign({},n);return t.status&&(a.ads.data.items[e].status=t.status),a})),g.data.items[0].id&&y.data.items&&y.data.items[0].id?this._displayCampaignService.updateAd(e,g.data.items[0].id,y.data.items[0].id,t).then((function(t){if(i.setState((function(n){var a=Object.assign({},n);return a.ads.data.items[e].status=t.data.status,a})),a&&r&&n){var s=Math.random();c({uid:s,message:a.title,description:a.body,btn:o.createElement(u.Button,{type:"primary",size:"small",onClick:function(){i.updateAd(e,n).then((function(){p(s.toString())}))}},o.createElement("span",null,l(f.default.undo)))})}return null})).catch((function(t){d(t,{message:f.default.notificationError,description:f.default.notificationErrorGeneric}),i.setState((function(t){var a=Object.assign({},t);return n&&n.status&&(a.ads.data.items[e].status=n.status),a}))})):Promise.resolve()}},{key:"render",value:function(){var e=this.state,t=e.campaign,n=e.adGroups,a=e.ads,r={media:n.mediaPerformance,adGroups:n.performance,overallPerformance:n.overallPerformance};return o.createElement(p.default,{updateAd:this.updateAd,updateAdGroup:this.updateAdGroup,campaign:t,adGroups:n,ads:a,dashboardPerformance:r})}}]),t}(o.Component);T([(0,O.lazyInject)(w.TYPES.IDisplayCampaignService)],A.prototype,"_displayCampaignService",void 0),t.default=(0,s.compose)(c.injectIntl,i.withRouter,S.default,(0,l.connect)(void 0,{notifyError:_.notifyError,notifySuccess:_.notifySuccess,removeNotification:_.removeNotification}))(A)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(33),s=n(10),l=n(8),c=g(n(338)),u=g(n(802)),d=g(n(2065)),f=g(n(2066)),p=g(n(114)),m=n(83);function g(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=s.Layout.Content,b=function(e){function t(){y(this,t);var e=h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.archiveAdGroup=function(){},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.adGroups,a=e.ads,l=e.campaign,g=e.updateAdGroup,y=e.dashboardPerformance,h=e.updateAd,b=e.intl,_=r.createElement("span",null,r.createElement(i.Link,{to:"/v2/o/"+t+"/creatives/display/create"},r.createElement(s.Button,{className:"m-r-10",type:"primary"},r.createElement(o.FormattedMessage,p.default.newCreatives))));return r.createElement("div",{className:"ant-layout"},r.createElement(f.default,{adGroup:n.data.items[0],displayCampaign:l.data.items[0],updateAdGroup:g,archiveAdGroup:this.archiveAdGroup}),r.createElement(v,{className:"mcs-content-container"},r.createElement(c.default,{campaign:n.data.items&&n.data.items[0]?n.data.items[0]:void 0}),l.data.items&&l.data.items[0]&&"V2014_06"===l.data.items[0].model_version?r.createElement(s.Alert,{className:"m-b-20",message:b.formatMessage(p.default.editionNotAllowed),type:"warning"}):null,r.createElement(d.default,{isFetchingMediaStat:y.media.isLoading,mediaStat:y.media.items,adGroupStat:y.adGroups.items,isFetchingAdGroupStat:y.adGroups.isLoading,isFetchingOverallStat:y.overallPerformance.isLoading,overallStat:y.overallPerformance.items}),r.createElement(u.default,{title:b.formatMessage(p.default.creatives),dataSet:(0,m.formatListView)(a.data,a.performance),isFetching:a.data.isLoading,isFetchingStat:a.performance.isLoading,updateAd:h,additionalButtons:_})))}}]),t}(r.Component);t.default=(0,l.compose)(i.withRouter,o.injectIntl)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(33),l=n(6),c=n(11),u=n(1019),d=n(114),f=(a=d)&&a.__esModule?a:{default:a};function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=function(e){function t(){return p(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.intl,n=e.isFetchingAdGroupStat,a=e.adGroupStat,r=e.isFetchingMediaStat,i=e.mediaStat,s=e.isFetchingOverallStat,l=e.overallStat,d=[{title:t.formatMessage(f.default.dashboardOverview),display:o.createElement(u.DisplayStackedAreaChart,{isFetchingCampaignStat:n,dataSource:a,isFetchingOverallStat:s,overallStat:l})},{title:t.formatMessage(f.default.dashboardTopSites),display:o.createElement(u.MediaPerformanceTable,{isFetchingMediaStat:r,dataSet:i})}];return o.createElement(c.Card,null,o.createElement(c.McsTabs,{items:d}))}}]),t}(o.Component);t.default=(0,i.compose)(l.injectIntl,s.withRouter)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(41),s=n(10),l=n(33),c=n(6),u=n(8),d=n(107),f=n(11),p=S(n(114)),m=n(61),g=S(n(273)),y=n(152),h=S(n(182)),v=n(137),b=n(12),_=n(15);function S(e){return e&&e.__esModule?e:{default:e}}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var w=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=function(e){function t(){E(this,t);var e=O(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildActionElement=function(){var t=e.props,n=t.adGroup,a=t.updateAdGroup,r=function(e){return n&&a(n.id,{status:e})},i=o.createElement(s.Button,{className:"mcs-primary",type:"primary",onClick:function(){r("ACTIVE")}},o.createElement(f.McsIcon,{type:"play"}),o.createElement(c.FormattedMessage,p.default.activateAdGroup)),l=o.createElement(s.Button,{className:"mcs-primary",type:"primary",onClick:function(){r("PAUSED")}},o.createElement(f.McsIcon,{type:"pause"}),o.createElement(c.FormattedMessage,p.default.pauseAdGroup));return n&&n.id?"PAUSED"===n.status||"PENDING"===n.status?i:l:null},e.duplicateAdGroup=function(){var t=e.props,n=t.location,a=t.history,r=t.match.params,o=r.organisationId,i=r.campaignId,s=r.adGroupId,l="/v2/o/"+o+"/campaigns/display/"+i+"/adgroups/create";a.push({pathname:l,state:{from:""+n.pathname+n.search,adGroupId:s}})},e.buildMenu=function(){var t=e.props,n=t.adGroup,a=t.archiveAdGroup,r=t.intl,l=t.displayCampaign;return o.createElement(s.Menu,{onClick:function(t){var l=e.props,u=l.match.params,d=u.organisationId,f=u.adGroupId,m=l.history;switch(t.key){case"ARCHIVED":return n&&(n.id,void s.Modal.confirm({title:r.formatMessage(p.default.archiveAdGroupModalTitle),content:r.formatMessage(p.default.archiveAdGroupModalMessage),icon:o.createElement(i.ExclamationCircleOutlined,null),okText:r.formatMessage(p.default.creativeModalConfirmArchivedOk),cancelText:r.formatMessage(p.default.cancelText),onOk:function(){return a()},onCancel:function(){}}));case"DUPLICATE":return e.duplicateAdGroup();case"HISTORY":return e.props.openNextDrawer(g.default,{additionalProps:{resourceType:"AD_GROUP",resourceId:f,handleClose:function(){return e.props.closeNextDrawer()},formatProperty:y.formatAdGroupProperty,resourceLinkHelper:{DISPLAY_CAMPAIGN:{direction:"PARENT",getType:function(){return o.createElement(c.FormattedMessage,h.default.displayCampaignResourceType)},getName:function(t){return e._displayCampaignService.getCampaignName(t)},goToResource:function(e){m.push("/v2/o/"+d+"/campaigns/display/"+e)}},CAMPAIGN:{direction:"PARENT",getType:function(){return o.createElement(c.FormattedMessage,h.default.displayCampaignResourceType)},getName:function(t){return e._displayCampaignService.getCampaignName(t)},goToResource:function(e){m.push("/v2/o/"+d+"/campaigns/display/"+e)}},AUDIENCE_SEGMENT_SELECTION:{direction:"CHILD",getType:function(){return o.createElement(c.FormattedMessage,h.default.segmentResourceType)},getName:function(t){return e._resourceHistoryService.getLinkedResourceIdInSelection(d,"AUDIENCE_SEGMENT_SELECTION",t,"AUDIENCE_SEGMENT").then((function(t){return e._audienceSegmentService.getSegment(t).then((function(e){return e.data.name}))}))},goToResource:function(t){return e._resourceHistoryService.getLinkedResourceIdInSelection(d,"AUDIENCE_SEGMENT_SELECTION",t,"AUDIENCE_SEGMENT").then((function(e){m.push("/v2/o/"+d+"/audience/segments/"+e)}))}},DISPLAY_NETWORK_SELECTION:{direction:"CHILD",getType:function(){return o.createElement(c.FormattedMessage,h.default.displayNetworkResourceType)},getName:function(t){return e._resourceHistoryService.getLinkedResourceIdInSelection(d,"DISPLAY_NETWORK_SELECTION",t,"DISPLAY_NETWORK").then((function(t){return e._displayNetworkService.getDisplayNetwork(t,d).then((function(e){return e.data.name}))}))},goToResource:function(e){}},AD:{direction:"CHILD",getType:function(){return o.createElement(c.FormattedMessage,h.default.creativeResourceType)},getName:function(t){return e._resourceHistoryService.getLinkedResourceIdInSelection(d,"AD",t,"CREATIVE").then((function(t){return e._creativeService.getCreative(t).then((function(e){return e.data.name}))}))},goToResource:function(t){return e._resourceHistoryService.getLinkedResourceIdInSelection(d,"AD",t,"CREATIVE").then((function(t){return e._creativeService.getCreative(t).then((function(e){return(0,v.creativeIsDisplayAdResource)(e.data)?"NATIVE"===e.data.subtype?m.push("/v2/o/"+d+"/creatives/native/edit/"+e.data.id):m.push("/v2/o/"+d+"/creatives/display/edit/"+e.data.id):m.push("/v2/o/"+d+"/creatives/email/edit/"+e.data.id)}))}))}},DEAL_LIST_SELECTION:{direction:"CHILD",getType:function(){return o.createElement(c.FormattedMessage,h.default.dealListResourceType)},getName:function(t){return e._resourceHistoryService.getLinkedResourceIdInSelection(d,"DEAL_LIST_SELECTION",t,"DEAL_LIST").then((function(t){return e._dealsListService.getDealList(d,t).then((function(e){return e.data.name}))}))},goToResource:function(t){return e._resourceHistoryService.getLinkedResourceIdInSelection(d,"DEAL_LIST_SELECTION",t,"DEAL_LIST").then((function(e){m.push("/v2/o/"+d+"/library/deallist/"+e+"/edit")}))}},AD_EXCHANGE_SELECTION:{direction:"CHILD",getType:function(){return o.createElement(c.FormattedMessage,h.default.adExchangeResourceType)},getName:function(t){return e._resourceHistoryService.getLinkedResourceIdInSelection(d,"AD_EXCHANGE_SELECTION",t,"AD_EXCHANGE").then((function(t){return e._catalogService.getServices(d,{serviceType:["DISPLAY_CAMPAIGN.INVENTORY_ACCESS"]}).then((function(e){var n=e.data.filter((function(e){return"inventory_access_ad_exchange"===e.type})).find((function(e){return e.ad_exchange_id===t}));return void 0!==n?n.name:r.formatMessage(h.default.deleted)}))}))},goToResource:function(e){}},GEO_TARGETING_SELECTION:{direction:"CHILD",getType:function(){return"Location"},getName:function(t){return e._resourceHistoryService.getLinkedResourceIdInSelection(d,"GEO_TARGETING_SELECTION",t,"GEONAME").then((function(t){return e._geonameService.getGeoname(t).then((function(e){return e.data.name}))}))},goToResource:function(e){}}}},size:"small"});default:return function(){}}}},o.createElement(s.Menu.Item,{key:"HISTORY"},o.createElement(c.FormattedMessage,p.default.history)),l&&"V2014_06"!==l.model_version?o.createElement(s.Menu.Item,{key:"DUPLICATE"},o.createElement(c.FormattedMessage,p.default.duplicate)):null,o.createElement(s.Menu.Item,{key:"ARCHIVED"},o.createElement(c.FormattedMessage,p.default.archiveAdGroup)))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.adGroup,n=e.displayCampaign,a=e.intl.formatMessage,r=e.match.params,u=r.organisationId,m=r.campaignId,g=r.adGroupId,y=e.location,h=this.buildActionElement(),v=this.buildMenu(),b=[{name:a(p.default.display),path:"/v2/o/"+u+"/campaigns/display",key:a(p.default.display)},{name:n?n.name:"",path:"/v2/o/"+u+"/campaigns/display/"+m,key:n&&n.id},{name:t?t.name||t.id:"",key:t?t.id:""}];return o.createElement(f.Actionbar,{paths:b},h,n&&"V2014_06"!==n.model_version?o.createElement(l.Link,{to:{pathname:"/v2/o/"+u+"/campaigns/display/"+m+"/adgroups/edit/"+g,state:{from:""+y.pathname+y.search}}},o.createElement(s.Button,null,o.createElement(f.McsIcon,{type:"pen"}),o.createElement(c.FormattedMessage,p.default.editAdGroup))):null,o.createElement(d.Dropdown,{overlay:v,trigger:["click"]},o.createElement(s.Button,null,o.createElement(i.EllipsisOutlined,null))))}}]),t}(o.Component);w([(0,_.lazyInject)(b.TYPES.IDisplayNetworkService)],M.prototype,"_displayNetworkService",void 0),w([(0,_.lazyInject)(b.TYPES.IAudienceSegmentService)],M.prototype,"_audienceSegmentService",void 0),w([(0,_.lazyInject)(b.TYPES.IDealListService)],M.prototype,"_dealsListService",void 0),w([(0,_.lazyInject)(b.TYPES.ICreativeService)],M.prototype,"_creativeService",void 0),w([(0,_.lazyInject)(b.TYPES.IDisplayCampaignService)],M.prototype,"_displayCampaignService",void 0),w([(0,_.lazyInject)(b.TYPES.IGeonameService)],M.prototype,"_geonameService",void 0),w([(0,_.lazyInject)(b.TYPES.ICatalogService)],M.prototype,"_catalogService",void 0),w([(0,_.lazyInject)(b.TYPES.IResourceHistoryService)],M.prototype,"_resourceHistoryService",void 0),t.default=(0,u.compose)(c.injectIntl,l.withRouter,m.injectDrawer)(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditAdGroupPage=void 0;var a,r=n(2068),o=(a=r)&&a.__esModule?a:{default:a};t.EditAdGroupPage=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=E(n(0)),s=n(8),l=n(25),c=n(13),u=n(10),d=n(6),f=n(61),p=E(n(204)),m=n(178),g=S(n(95)),y=S(n(804)),h=S(n(23)),v=n(15),b=n(12),_=n(11);function S(e){return e&&e.__esModule?e:{default:e}}function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var O=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onSubmitFail=function(){var e=n.props.intl;u.message.error(e.formatMessage(g.default.errorFormMessage))},n.save=function(e){var t=n.props,a=t.match.params,r=a.organisationId,o=a.campaignId,i=t.notifyError,s=t.history,l=t.intl,c=n.state.adGroupFormData,d=u.message.loading(l.formatMessage(g.default.savingInProgress),0);return n.setState({loading:!0}),n._adGroupFormService.saveAdGroup(r,o,e,c).then((function(e){d();var t="/v2/o/"+r+"/campaigns/display/"+o+"/adgroups/"+e;s.push(t)})).catch((function(e){d(),i(e),n.setState({loading:!1})}))},n.onClose=function(){var e=n.props,t=e.history,a=e.match.params,r=a.adGroupId,o=a.campaignId,i=a.organisationId,s=r?"/v2/o/"+i+"/campaigns/display/"+o+"/adgroups/"+r:"/v2/o/"+i+"/campaigns/display/"+o;return t.push(s)},n.state={loading:!0,adGroupFormData:m.INITIAL_AD_GROUP_FORM_DATA},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match.params,r=n.campaignId,o=n.adGroupId,i=t.location,s=i.state&&i.state.adGroupId,l=o||s;Promise.all([this._displayCampaignService.getCampaignDisplay(r),l?this._adGroupFormService.loadAdGroup(r,l,!!s):Promise.resolve(null)]).then((function(t){var n=a(t,2),r=n[0],o=n[1];e.setState((function(e){var t=Object.assign(Object.assign({},e),{campaign:r.data,loading:!1});return o&&(t.adGroupFormData=o),t}))})).catch((function(t){e.setState({loading:!1}),e.props.notifyError(t)}))}},{key:"render",value:function(){var e=this.props,t=e.match.params,n=t.organisationId,a=t.campaignId,r=t.adGroupId,o=e.intl.formatMessage,s=this.state,l=s.loading,c=s.campaign,u=s.adGroupFormData;if(l)return i.createElement(_.Loading,{isFullScreen:!0});var d=c?c.name:a,f=r?o(g.default.breadcrumbTitle3,{name:u.adGroup&&u.adGroup.name?u.adGroup.name:r}):o(g.default.breadcrumbTitle2),p=[{name:o(g.default.breadcrumbTitle1),path:"/v2/o/"+n+"/campaigns/display"},{name:d,path:"/v2/o/"+n+"/campaigns/display/"+a},{name:f}];return i.createElement(y.default,{initialValues:u,onSubmit:this.save,close:this.onClose,breadCrumbPaths:p,onSubmitFail:this.onSubmitFail})}}]),t}(i.Component);O([(0,v.lazyInject)(b.TYPES.IDisplayCampaignService)],w.prototype,"_displayCampaignService",void 0),O([(0,v.lazyInject)(b.TYPES.IAdGroupFormService)],w.prototype,"_adGroupFormService",void 0);t.default=(0,s.compose)(c.withRouter,d.injectIntl,f.injectDrawer,h.default,(0,l.connect)((function(e){return{hasFeature:p.hasFeature(e)}}),void 0))(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(25),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(204));var o=function(e){var t=e.featureName,n=e.enabledComponent,a=e.disabledComponent;return(0,e.hasFeature)(t)?n:a};o.defaultProps={disabledComponent:null},t.default=(0,a.connect)((function(e){return{hasFeature:r.hasFeature(e)}}))(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeneralFormSection=void 0;var a,r=n(2071),o=(a=r)&&a.__esModule?a:{default:a};t.GeneralFormSection=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(8),s=m(n(95)),l=m(n(49)),c=m(n(63)),u=n(24),d=n(11),f=m(n(784)),p=n(152);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldNormalizer.normalizeInteger,n=e.fieldValidators,a=n.isRequired,o=n.isNotZero,i=n.isValidFloat,l=n.isValidInteger,c=e.intl.formatMessage;return r.createElement("div",null,r.createElement(u.FormSection,{subtitle:s.default.sectionSubtitleGeneral,title:s.default.sectionTitleGeneral}),r.createElement("div",null,r.createElement(u.FormInputField,{name:"adGroup.name",component:u.FormInput,validate:[a],formItemProps:{label:c((0,p.formatAdGroupProperty)("name").message),required:!0},inputProps:{placeholder:c(s.default.contentSectionGeneralRow1Placeholder)},helpToolTipProps:{title:c(s.default.contentSectionGeneralRow1Tooltip)}}),r.createElement(u.FormInputField,{name:"adGroup.total_budget",component:u.FormInput,validate:[i,o],formItemProps:{label:c((0,p.formatAdGroupProperty)("total_budget").message)},inputProps:{suffix:r.createElement("span",null,"€"),placeholder:c(s.default.contentSectionGeneralRow3Placeholder)},helpToolTipProps:{title:c(s.default.contentSectionGeneralRow3Tooltip)}}),r.createElement(u.FormInputField,{name:"adGroup.max_budget_per_period",component:u.FormInput,validate:[i,o],formItemProps:{label:c((0,p.formatAdGroupProperty)("max_budget_per_period").message)},inputProps:{suffix:r.createElement("span",null,"€"),addonAfter:r.createElement(u.FormAddonSelectField,{name:"adGroup.max_budget_period",component:u.AddonSelect,options:[{value:"DAY",title:"DAY",children:(0,p.formatAdGroupProperty)("max_budget_period","DAY").formattedValue},{value:"WEEK",title:"WEEK",children:(0,p.formatAdGroupProperty)("max_budget_period","WEEK").formattedValue},{value:"MONTH",title:"MONTH",children:(0,p.formatAdGroupProperty)("max_budget_period","MONTH").formattedValue}]}),placeholder:c(s.default.contentSectionGeneralRow2Placeholder),style:{width:"100%"}},helpToolTipProps:{title:c(s.default.contentSectionGeneralRow2Tooltip)}}),r.createElement(u.FormDateRangePickerField,{name:"adGroup",component:f.default,startDateFieldName:"start_date",endDateFieldName:"end_date",unixTimestamp:!0,allowPastDate:!1,formItemProps:{label:c((0,p.formatAdGroupProperty)("duration").message)},startDatePickerProps:{style:{width:"100%"}},endDatePickerProps:{style:{width:"100%"}},helpToolTipProps:{placement:"right",title:c(s.default.contentSectionGeneralRow4Tooltip)}}),r.createElement(u.FormInputField,{name:"adGroup.max_bid_price",component:u.FormInput,validate:[i,o],formItemProps:{label:c((0,p.formatAdGroupProperty)("max_bid_price").message)},inputProps:{suffix:r.createElement("span",null,"€"),placeholder:c(s.default.contentSectionGeneralRow5Placeholder)},helpToolTipProps:{title:c(s.default.contentSectionGeneralRow5Tooltip)}})),r.createElement("div",null,r.createElement(d.Button,{className:"optional-section-title clickable-on-hover",onClick:this.toggleAdvancedSection},r.createElement(d.McsIcon,{type:"settings"}),r.createElement("span",{className:"step-title"},c(s.default.contentSectionGeneralAdvancedPartTitle)),r.createElement(d.McsIcon,{type:"chevron"})),r.createElement("div",{className:this.state.displayAdvancedSection?"optional-section-content":"hide-section"},r.createElement(u.FormAlertInputField,{name:"adGroup.technical_name",component:u.FormAlertInput,formItemProps:{label:c((0,p.formatAdGroupProperty)("technical_name").message)},inputProps:{placeholder:c(s.default.contentSectionGeneralRow8Placeholder)},helpToolTipProps:{title:c(s.default.contentSectionGeneralRow8Tooltip)},iconType:"warning",type:"warning",message:c(s.default.warningOnTokenEdition)}),r.createElement(u.FormInputField,{name:"adGroup.total_impression_capping",component:u.FormInput,normalize:t,validate:[l],formItemProps:{label:c((0,p.formatAdGroupProperty)("total_impression_capping").message)},inputProps:{placeholder:c(s.default.contentSectionGeneralRow6Placeholder)},helpToolTipProps:{title:c(s.default.contentSectionGeneralRow6Tooltip)}}),r.createElement(u.FormInputField,{name:"adGroup.per_day_impression_capping",component:u.FormInput,normalize:t,validate:[l],formItemProps:{label:c((0,p.formatAdGroupProperty)("per_day_impression_capping").message)},inputProps:{placeholder:c(s.default.contentSectionGeneralRow7Placeholder)},helpToolTipProps:{title:c(s.default.contentSectionGeneralRow7Tooltip)}}))))}}]),t}(r.Component);t.default=(0,i.compose)(o.injectIntl,l.default,c.default)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SummaryFormSection=void 0;var a,r=n(2073),o=(a=r)&&a.__esModule?a:{default:a};t.SummaryFormSection=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(25),i=n(8),s=n(6),l=n(10),c=n(35),u=n(24),d=n(178),f=y(n(95)),p=y(n(2074)),m=y(n(2076)),g=y(n(2077));function y(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=function(e){return e.children?r.createElement("div",{className:"section sectionPaddingTop"},r.createElement(l.Row,{className:"textPadding"},r.createElement(l.Col,{span:16},e.children))):null},_=function(e){function t(){return h(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.adGroupFormData;return r.createElement("div",null,r.createElement(u.FormSection,{title:f.default.sectionTitleSummary,subtitle:f.default.sectionSubtitleSummary}),r.createElement(l.Row,{className:"ad-group-summary-section"},r.createElement(l.Col,{span:16,className:"content"},r.createElement(b,null,r.createElement(g.default,null)),r.createElement(b,null,r.createElement(p.default,null)),r.createElement(b,null,r.createElement(m.default,null)),r.createElement(b,null,r.createElement(s.FormattedMessage,{id:"display.campaign.edit.adGroup.summaryFormSection.creative",defaultMessage:"You have { creativeCountLabeled } \n                  { creativeCount , plural, \n                    zero {creative} one {creative} other {creatives} }\n                  attached to your ad group",values:{creativeCountLabeled:r.createElement("span",{className:"info-color"},e.adFields.length),creativeCount:e.adFields.length}})))))}}]),t}(r.Component),S=function(e){return(0,c.getFormValues)(d.AD_GROUP_FORM_NAME)(e)};t.default=(0,i.compose)((0,o.connect)((function(e){return{adGroupFormData:S(e)}})))(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(178),s=n(35),l=n(8),c=n(6),u=n(25),d=n(999),f=(a=d)&&a.__esModule?a:{default:a},p=n(2075);function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e){function t(){return m(this,t),g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props.segmentFields,t=e.filter((function(e){return!e.model.exclude})).map((function(e){return e.meta.name})),n=e.filter((function(e){return e.model.exclude})).map((function(e){return e.meta.name})),a=null;return 0===t.length&&0===n.length?a=o.createElement(c.FormattedMessage,{id:"display.campaign.edit.adGroup.summarySection.noSegment",defaultMessage:"Your ads will target everyone"}):t.length>0&&0===n.length?a=o.createElement("div",null,o.createElement(c.FormattedMessage,{id:"display.campaign.edit.adGroup.summarySection.includeOnly",defaultMessage:"Your ads will target the following {segmentCount, plural , one {segment} other {segments} }",values:{segmentCount:t.length}}),o.createElement("p",{className:"info-color"},(0,p.printStringArray)(t))):0===t.length&&n.length>0?a=o.createElement("div",{className:"error-color"},o.createElement(c.FormattedMessage,{id:"display.campaign.edit.adGroup.summarySection.excludeOnly",defaultMessage:"Please target at least one segment"})):t.length>0&&n.length>0&&(a=o.createElement("div",null,o.createElement(c.FormattedMessage,{id:"display.campaign.edit.adGroup.summarySection.include",defaultMessage:"Your ads will target the following {segmentCount, plural , one {segment} other {segments} }",values:{segmentCount:t.length}}),o.createElement("p",{className:"info-color"},(0,p.printStringArray)(t)),o.createElement("br",null),o.createElement(c.FormattedMessage,{id:"display.campaign.edit.adGroup.summarySection.exclude",defaultMessage:"Your ads will no target the following {segmentCount, plural , one {segment} other {segments} }",values:{segmentCount:n.length}}),o.createElement("p",{className:"info-color"},(0,p.printStringArray)(n)))),o.createElement(f.default,null,a)}}]),t}(o.Component),h=function(e){return(0,s.getFormValues)(i.AD_GROUP_FORM_NAME)(e)};t.default=(0,l.compose)(c.injectIntl,(0,u.connect)((function(e){return{segmentFields:h(e).segmentFields}})))(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printStringArray=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(t,n,a){return t+(a>0&&a<e.length?",":"")+" "+n}),"")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(178),l=n(35),c=n(8),u=n(6),d=n(25),f=n(620),p=(a=f)&&a.__esModule?a:{default:a},m=n(15),g=n(12);function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=function(e){function t(){return y(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"printGeonames",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(n,a){var r=a===t.length-1;return i.createElement("span",{key:n},i.createElement(p.default,{id:n,fetchingMethod:e._geonameService.getGeoname,renderMethod:function(e){return i.createElement("span",null,e.name)}}),r?"":", ")}))}},{key:"render",value:function(){var e=this.props.locationFields,t=e.filter((function(e){return!e.model.exclude})).map((function(e){return e.model.geoname_id})),n=e.filter((function(e){return e.model.exclude})).map((function(e){return e.model.geoname_id})),a=null;return 0===t.length&&0===n.length?a=i.createElement(u.FormattedMessage,{id:"display.campaign.edit.adGroup.locationSummary.noLocaton",defaultMessage:"Your ad group is not restricted on a particular location"}):t.length>0&&0===n.length?a=i.createElement("div",null,i.createElement(u.FormattedMessage,{id:"display.campaign.edit.adGroup.locationSummary.includeOnly",defaultMessage:"Your ad group is restrited to the following {locationCount, plural , one {location} other {locations} }",values:{locationCount:t.length}}),i.createElement("p",{className:"info-color"},this.printGeonames(t))):0===t.length&&n.length>0?a=i.createElement("div",null,i.createElement(u.FormattedMessage,{id:"display.campaign.edit.adGroup.locationSummary.excludeonly",defaultMessage:"Your ad group will run everywhere except on the following {locationCount, plural , one {location} other {locations} }",values:{locationCount:n.length}}),i.createElement("p",{className:"info-color"},this.printGeonames(n))):t.length>0&&n.length>0&&(a=i.createElement("div",null,i.createElement(u.FormattedMessage,{id:"display.campaign.edit.adGroup.locationSummary.include",defaultMessage:"Your ad group is restrited to the following {locationCount, plural , one {location} other {locations} }",values:{locationCount:t.length}}),i.createElement("p",{className:"info-color"},this.printGeonames(t)),i.createElement("br",null),i.createElement(u.FormattedMessage,{id:"display.campaign.edit.adGroup.locationSummary.exclude",defaultMessage:"Except"}),i.createElement("p",{className:"info-color"},this.printGeonames(n)))),i.createElement("div",null,a)}}]),t}(i.Component);v([(0,m.lazyInject)(g.TYPES.IGeonameService)],b.prototype,"_geonameService",void 0);var _=function(e){return(0,l.getFormValues)(s.AD_GROUP_FORM_NAME)(e)};t.default=(0,c.compose)(u.injectIntl,(0,d.connect)((function(e){return{locationFields:_(e).locationFields}})))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(178),i=n(35),s=n(8),l=n(6),c=n(25),u=n(412);function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=function(e){function t(){return d(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.adGroup,n=e.intl;return r.createElement("div",null,r.createElement(l.FormattedMessage,{id:"display.campaign.edit.adGroup.generalSettingSummary.scheduleDate",defaultMessage:"Your ad group will run from \n          the { startDate } to the { endDate }",values:{startDate:r.createElement("span",{className:"info-color"},(0,u.formatUnixTimestamp)(t.start_date)),endDate:r.createElement("span",{className:"info-color"},(0,u.formatUnixTimestamp)(t.end_date))}}),r.createElement("br",null),r.createElement(l.FormattedMessage,{id:"display.campaign.edit.adGroup.generalSettingSummary.bugetPeriod",defaultMessage:"Your ad group will run with a { budgetPeriod } budget of { budgetAmount }",values:{budgetPeriod:r.createElement("span",{className:"info-color"},n.formatMessage(g[t.max_budget_period||"DAY"])),budgetAmount:r.createElement("span",{className:"info-color"},t.max_budget_per_period?n.formatNumber(t.max_budget_per_period,{style:"currency",currency:"EUR",currencyDisplay:"symbol"}):"--")}}))}}]),t}(r.Component),m=function(e){return(0,i.getFormValues)(o.AD_GROUP_FORM_NAME)(e)};t.default=(0,s.compose)(l.injectIntl,(0,c.connect)((function(e){return{adGroup:m(e).adGroup}})))(p);var g=(0,l.defineMessages)({DAY:{id:"adgroup-budget-period-day",defaultMessage:"DAILY"},WEEK:{id:"adgroup-budget-period-week",defaultMessage:"WEEKLY"},MONTH:{id:"adgroup-budget-period-month",defaultMessage:"MONTHLY"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(6),l=n(24),c=g(n(95)),u=g(n(2079)),d=g(n(2080)),f=g(n(620)),p=n(15),m=n(12);function g(e){return e&&e.__esModule?e:{default:e}}var y=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},h=i.Modal.confirm,v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleDisplayLocationTargetingSection=function(){n.setState({locationTargetingDisplayed:!n.state.locationTargetingDisplayed})},n.handleCheckbox=function(){var e=n.props,t=e.intl.formatMessage,a=e.fields,r=e.formChange;a.length>0?h({cancelText:t(c.default.cancel),content:t(c.default.notificationWarning),maskClosable:!0,okText:t(c.default.ok),onOk:function(){r(a.name,[])}}):0===a.length?n.setState({locationTargetingDisplayed:!n.state.locationTargetingDisplayed}):n.toggleDisplayLocationTargetingSection()},n.addLocationField=function(e){var t=n.props,a=t.fields,r=t.formChange,s=t.intl.formatMessage,l=a.getAll(),u=!1,d=!1,p=[];if(l.forEach((function(t){t.model.country===e.model.country&&("00"===t.model.admin1||t.model.admin1===e.model.admin1&&e.model.admin2&&!t.model.admin2)&&(u=!0,t.model.exclude&&(d=!0))})),!d&&u&&(e.model.exclude=!0),l.forEach((function(t){t.model.country===e.model.country&&("00"===e.model.admin1||e.model.admin1===t.model.admin1&&null===e.model.admin2)&&(e.model.exclude?p.push(t.key):t.model.exclude||p.push(t.key))})),d)i.Modal.warning({title:s(c.default.contentSectionLocationModal1Title),content:s(c.default.contentSectionLocationModal1)});else if(p.length){var m=l.reduce((function(e,t){return p.includes(t.key)?[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e),[t.model.geoname_id]):e}),[]),g=function(e){return o.createElement("div",null,e.name)},y=o.createElement("div",null,o.createElement("div",null,s(c.default.contentSectionLocationModal2)),o.createElement("br",null),m.map((function(e){return o.createElement(f.default,{key:e,id:e,renderMethod:g,fetchingMethod:n._geonameService.getGeoname})})));i.Modal.confirm({title:s(c.default.contentSectionLocationModal2Title),content:y,onOk:function(){var t=l.filter((function(e){return!p.includes(e.key)}));r(a.name,t.concat([e]))}})}else a.push(e)},n.state={locationTargetingDisplayed:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.fields,n=e.fields,a=this.state.locationTargetingDisplayed;0===t.length&&t.length!==n.length&&!1!==a&&this.setState({locationTargetingDisplayed:!1})}},{key:"render",value:function(){var e=this.props,t=e.fields,n=e.intl.formatMessage,a=e.disabled,r=this.state.locationTargetingDisplayed||t.length>0,f=t.getAll(),p=f.map((function(e){return e.model.geoname_id})),m=f.length>0?"top":"middle";return o.createElement("div",{className:"locationTargeting"},o.createElement(l.FormSection,{subtitle:c.default.sectionSubtitleLocation,title:c.default.sectionTitleLocationTargeting}),o.createElement(i.Checkbox,{checked:r,className:"field-label checkbox-location-section",onChange:this.handleCheckbox,disabled:!!a},o.createElement(s.FormattedMessage,{id:"display.campaign.edit.adGroup.locationTargetingSection.checkboxMessage",defaultMessage:"I want to target a specific location"})),o.createElement("div",{className:r?"":"hide-section"},o.createElement(l.FormFieldWrapper,{label:o.createElement(s.FormattedMessage,{id:"display.campaign.edit.adGroup.locationTargetingSection.label",defaultMessage:"Location"}),rowProps:{align:m},helpToolTipProps:{title:n(c.default.contentSectionLocationTooltipMessage)},small:this.props.small},o.createElement(u.default,{locationFields:f,onClickOnRemove:function(e,n){return t.remove(n)},disabled:a}),o.createElement(d.default,{onGeonameSelect:this.addLocationField,hiddenGeonameIds:p,disabled:a}))))}}]),t}(o.Component);y([(0,p.lazyInject)(m.TYPES.IGeonameService)],v.prototype,"_geonameService",void 0),t.default=(0,s.injectIntl)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(11),c=n(620),u=(a=c)&&a.__esModule?a:{default:a},d=n(15),f=n(12);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},y=function(e){function t(){return p(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.locationFields,a=t.onClickOnRemove,r=t.disabled;return i.createElement("div",null,i.createElement(s.Row,{align:"middle",justify:"space-between",className:0!==n.length?"search-result-box":"hide-section"},n.map((function(t,n){var o=t.model.exclude?"close-big":"check";return i.createElement("div",{className:"search-result-box-item",key:t.key},i.createElement(l.McsIcon,{type:o}),i.createElement(u.default,{key:t.key,id:t.model.geoname_id,renderMethod:function(e){return i.createElement("span",null,e.name)},fetchingMethod:e._geonameService.getGeoname}),i.createElement(l.Button,{className:"close-button",onClick:function(){return r?void 0:a(t,n)},disabled:!!r},i.createElement(l.McsIcon,{type:"close"})))}))))}}]),t}(i.Component);y.defaultProps={locationFields:[]},g([(0,d.lazyInject)(f.TYPES.IGeonameService)],y.prototype,"_geonameService",void 0),t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=g(n(0)),i=n(6),s=m(n(47)),l=g(n(10)),c=m(n(95)),u=n(107),d=n(15),f=n(12),p=n(11);function m(e){return e&&e.__esModule?e:{default:e}}function g(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var y=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},h=l.Input.Group,v=l.Select.Option,b=l.Spin,_=[{name:"Albania",code:"AL"},{name:"Armenia",code:"AM"},{name:"Austria",code:"AT"},{name:"Belarus",code:"BY"},{name:"Belgium",code:"BE"},{name:"Bosnia and Herzegovina",code:"BA"},{name:"Bulgaria",code:"BG"},{name:"Canada",code:"CA"},{name:"Cyprus",code:"CY"},{name:"Czech Republic",code:"CZ"},{name:"Denmark",code:"DK"},{name:"Estonia",code:"EE"},{name:"Finland",code:"FI"},{name:"France",code:"FR"},{name:"Georgia",code:"GE"},{name:"Germany",code:"DE"},{name:"Greece",code:"GR"},{name:"Guernsey",code:"GG"},{name:"Holy See (Vatican City State)",code:"VA"},{name:"Hungary",code:"HU"},{name:"Iceland",code:"IS"},{name:"Ireland",code:"IE"},{name:"Italy",code:"IT"},{name:"Latvia",code:"LV"},{name:"Liechtenstein",code:"LI"},{name:"Lithuania",code:"LT"},{name:"Luxembourg",code:"LU"},{name:"Malta",code:"MT"},{name:"Monaco",code:"MC"},{name:"Netherlands",code:"NL"},{name:"Norway",code:"NO"},{name:"Poland",code:"PL"},{name:"Portugal",code:"PT"},{name:"Romania",code:"RO"},{name:"Serbia and Montenegro",code:"CS"},{name:"Slovakia",code:"SK"},{name:"Slovenia",code:"SI"},{name:"Spain",code:"ES"},{name:"Sweden",code:"SE"},{name:"Switzerland",code:"CH"},{name:"Ukraine",code:"UA"},{name:"United Kingdom",code:"GB"},{name:"United States",code:"US"}],S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.randomId=(0,s.default)(),n.handleIncOrExcChange=function(e){n.setState({incOrExc:e})},n.handleCountryChange=function(e){n.setState({country:e})},n.fetchGeonames=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=n.props.hiddenGeonameIds,a=n.state.country,r=void 0,o=_.find((function(e){return e.name===a}));r=o?o.code:"FR",n.setState({fetchingGeonames:!0}),n._geonameService.getGeonames(e,"fr",r).then((function(e){return e.data})).then((function(a){var r=a.filter((function(n){return(n.name.indexOf(e.charAt(0).toUpperCase()+e.slice(1))>=0||n.name.indexOf(e)>=0)&&!t.includes(n.id)}));n.setState({fetchingGeonames:!1,listOfGeonamesToDisplay:r})}))},n.handleChange=function(e){var t=n.props.onGeonameSelect,a=n.state.listOfGeonamesToDisplay.find((function(t){return t.id===e[0]}));a&&t&&t({key:(0,s.default)(),model:{geoname_id:a.id,type:"GEONAME",country:a.country_iso,admin1:a.admin1,admin2:a.admin2,exclude:"EXC"===n.state.incOrExc}});n.setState({listOfGeonamesToDisplay:[]})},n.state={fetchingGeonames:!1,listOfGeonamesToDisplay:[],incOrExc:"INC",country:"France"},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.state,t=e.fetchingGeonames,n=e.listOfGeonamesToDisplay,a=this.props,r=a.intl.formatMessage,s=a.disabled;return o.createElement(h,{compact:!0},o.createElement("div",{className:"small-select"},o.createElement(u.Select,{defaultValue:"INC",disabled:!!s,onChange:this.handleIncOrExcChange},o.createElement(v,{value:"INC",title:r(c.default.contentSectionLocationOption1)},o.createElement(p.McsIcon,{type:"check"}),o.createElement(i.FormattedMessage,{id:"display.campaign.edit.adGroup.locationTargetingSection.include",defaultMessage:"Include"})),o.createElement(v,{value:"EXC",title:r(c.default.contentSectionLocationOption2)},o.createElement(p.McsIcon,{type:"close-big"}),o.createElement(i.FormattedMessage,{id:"display.campaign.edit.adGroup.locationTargetingSection.exclude",defaultMessage:"Exclude"})))),o.createElement("div",{className:"small-select small-select-right"},o.createElement(u.Select,{showSearch:!0,defaultValue:"France",onChange:this.handleCountryChange,disabled:!!s},_.map((function(e){return o.createElement(v,{key:e.name,value:e.name},e.name)})))),o.createElement("div",{className:"big-select"},o.createElement(u.Select,{mode:"multiple",value:[],placeholder:r(c.default.contentSectionLocationInputPlaceholder),notFoundContent:t?o.createElement(b,{size:"small"}):null,filterOption:!1,onSearch:this.fetchGeonames,onChange:this.handleChange,disabled:!!s},n.map((function(e){return o.createElement(v,{key:e.id,value:e.id},e.name)})))))}}]),t}(o.Component);y([(0,d.lazyInject)(f.TYPES.IGeonameService)],S.prototype,"_geonameService",void 0),t.default=(0,i.injectIntl)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(10),s=S(n(47)),l=n(13),c=n(8),u=n(24),d=S(n(1021)),f=S(n(2082)),p=n(183),m=S(n(78)),g=n(83),y=n(56),h=S(n(95)),v=S(n(81)),b=S(n(977)),_=n(61);function S(e){return e&&e.__esModule?e:{default:e}}var E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateSegments=function(e){var t=n.props,a=t.fields,r=t.formChange,o=a.getAll().map((function(e){return e.model.audience_segment_id})),i=a.getAll(),l=e.filter((function(e){return!o.includes(e.id)})).map((function(e){return{key:(0,s.default)(),model:{audience_segment_id:e.id,exclude:!1},meta:{name:e.name}}}));r(a.name,i.concat(l)),n.props.closeNextDrawer()},n.openAudienceSegmentSelector=function(e){return function(){var t={selectedSegmentIds:[],close:n.props.closeNextDrawer,save:n.updateSegments},a={selectedSegmentIds:[],close:n.props.closeNextDrawer,save:n.updateServices};if("first_party"===e){var r={additionalProps:t};n.props.openNextDrawer(d.default,r)}if("second_party"===e){var o={additionalProps:a};n.props.openNextDrawer(f.default,o)}}},n.updateServices=function(e){var t=n.props,a=t.fields,r=t.formChange,o=a.getAll().map((function(e){return e.model.audience_segment_id})),i=a.getAll(),l=e.filter((function(e){return!o.includes(e.segment_id)})).map((function(e){return{key:(0,s.default)(),model:{audience_segment_id:e.segment_id,exclude:!1},meta:{name:e.name}}}));r(a.name,i.concat(l)),n.props.closeNextDrawer()},n.getSegmentRecords=function(){var e=n.props.fields,t=n.state,a=t.fetchingReport,o=t.reportBySegmentId,s=function(e){return e.meta.name},l=function(e){var t=e.model.audience_segment_id;if(a)return r.createElement(i.Spin,{size:"small"});var n=o&&o[t];return n?r.createElement("span",null,r.createElement("span",{className:"m-r-20"},"Cookies:"," ",n.desktop_cookie_ids?(0,y.formatMetric)(n.desktop_cookie_ids,"0,00"):"-"),r.createElement("span",null,"User Points:"," ",n.user_points?(0,y.formatMetric)(n.user_points,"0,00"):"-")):null};return e.map((function(t,n){var a=e.get(n);return r.createElement(p.RecordElement,{key:a.key,recordIconType:"users",record:a,title:s,additionalData:l,additionalActionButtons:function(e){return r.createElement("span",null,r.createElement(u.FormSwitchField,{name:t+".model.exclude",component:b.default,invert:!0,className:"mcs-table-switch m-r-10"}),e.model.exclude?"Exclude":"Target")},onRemove:function(){return e.remove(n)}})}))},n.state={reportBySegmentId:{},fetchingReport:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.organisationId;this.setState({fetchingReport:!0}),m.default.getAudienceSegmentReport(t,new v.default("now"),new v.default("now"),["audience_segment_id"],void 0).then((function(t){e.setState({fetchingReport:!1,reportBySegmentId:(0,g.normalizeArrayOfObject)((0,y.normalizeReportView)(t.data.report_view),"audience_segment_id")})}))}},{key:"render",value:function(){var e=this.props.intl.formatMessage;return r.createElement("div",null,r.createElement(u.FormSection,{dropdownItems:[{id:h.default.dropdownAddOwn.id,message:h.default.dropdownAddOwn,onClick:this.openAudienceSegmentSelector("first_party")},{id:h.default.dropdownAddShared.id,message:h.default.dropdownAddShared,onClick:this.openAudienceSegmentSelector("second_party")}],subtitle:h.default.sectionSubtitleAudience,title:h.default.sectionTitleAudience}),r.createElement(p.RelatedRecords,{emptyOption:{iconType:"users",message:e(h.default.contentSectionAudienceEmptyTitle)}},this.getSegmentRecords()))}}]),t}(r.Component);t.default=(0,c.compose)(l.withRouter,o.injectIntl,_.injectDrawer)(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(6),l=n(8),c=n(13),u=n(272),d=(a=u)&&a.__esModule?a:{default:a},f=n(65),p=n(44),m=n(12),g=n(15);function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=d.default,_=(0,s.defineMessages)({segmentSelectorTitle:{id:"shared-segment-selector-title",defaultMessage:"Add an audience"},segmentSelectorSearchPlaceholder:{id:"shared-segment-selector-search-placeholder",defaultMessage:"Search audience"},segmentSelectorColumnName:{id:"shared-segment-selector-column-name",defaultMessage:"Name"},segmentSelectorColumnUserPoints:{id:"shared-segment-selector-column-userPoints",defaultMessage:"User Points"},segmentSelectorColumnCookieIds:{id:"shared-segment-selector.column-cookieIds",defaultMessage:"Desktop Cookie Ids"}}),S=function(e){function t(){y(this,t);var e=h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.saveSegments=function(t,n){e.props.save(n)},e.fetchSegments=function(t){var n=e.props.match.params.organisationId,a=Object.assign({},(0,p.getPaginatedApiParam)(t.currentPage,t.pageSize));return t.keywords&&(a.keywords=t.keywords),e._catalogService.getAudienceSegmentServices(n,a)},e.fetchSegment=function(t){return e._catalogService.getService(t)},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.selectedSegmentIds,n=e.close,a=e.intl.formatMessage,r=[{intlMessage:_.segmentSelectorColumnName,key:"name",render:function(e,t){return i.createElement("span",null,t.name)}}];return i.createElement(b,{actionBarTitle:a(_.segmentSelectorTitle),displayFiltering:!0,searchPlaceholder:a(_.segmentSelectorSearchPlaceholder),selectedIds:t,defaultSelectedKey:"segment_id",fetchDataList:this.fetchSegments,fetchData:this.fetchSegment,columnsDefinitions:r,save:this.saveSegments,close:n,displayDatamartSelector:!1})}}]),t}(i.Component);v([(0,g.lazyInject)(m.TYPES.ICatalogService)],S.prototype,"_catalogService",void 0),t.default=(0,l.compose)(c.withRouter,s.injectIntl,f.injectDatamart)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=y(n(47)),i=n(6),s=n(614),l=n(8),c=y(n(2084)),u=y(n(410)),d=y(n(95)),f=y(n(2085)),p=y(n(2086)),m=n(11),g=y(n(2087));function y(e){return e&&e.__esModule?e:{default:e}}function h(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getSelectedSegment=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];n.props.fields.getAll().forEach((function(e){e.model.exclude===a&&r.push(e.model.audience_segment_id)}));var o=e.map((function(e){return e.segment_id})),i=t.map((function(e){return e.id})),s=o.concat(i);return r.filter((function(e){return s.includes(e)}))},n.markAsDeleted=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t){var a=n.props.fields;a.getAll().some((function(n,r){return n.model.audience_segment_id===t&&n.model.exclude===e&&(a.remove(r),!0)}))}},n.addSegment=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=n.props.fields,r={audience_segment_id:e,exclude:t};a.push({key:(0,o.default)(),model:r,meta:{name:e}})},n.toggleSelected=function(e){n.props.fields.getAll().find((function(t){return t.model.audience_segment_id===e}))?n.markAsDeleted()(e):n.addSegment(e)},n.handleChange=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(r){var i=n.props,s=i.fields,l=i.formChange,c=s.getAll()||[],u=[],d=n.getSelectedSegment(_(e),t,a),f=c.filter((function(e){return!d.includes(e.model.audience_segment_id)||e.model.exclude!==a}));u.push.apply(u,h(f)),r.forEach((function(e){c.find((function(t){return t.model.audience_segment_id===e&&t.model.exclude===a}))||u.push({key:(0,o.default)(),model:{audience_segment_id:e,exclude:a},meta:{name:e}})})),c.filter((function(e){return e.model.exclude===a})).forEach((function(e){r.includes(e.model.audience_segment_id)&&u.push(Object.assign({},e))})),l(s.name,u)}},n.buildTreeDataFromOwnSegments=function(e){return{value:"own-datamart-segments",label:(0,n.props.intl.formatMessage)(f.default.mySegmentCategory),isLeaf:!1,children:e.map((function(e){return{value:e.id,label:e.name,isLeaf:!0}}))}},n.toogleShowExclude=function(){n.setState((function(e){return{showExclude:!e.showExclude}}))},n.state={showExclude:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl,n=e.fields,a=e.audienceCategoryTree,o=e.genderServiceItems,l=e.ageServiceItems,c=e.audienceSegments,y=o.data.map(b),v=l.data.map(b),S=a.data.map((function(e){return function e(t,n){var a=(t.children||[]).map((function(t){var a={value:t.node.id,label:t.node.name,isLeaf:!1};return e(t,n.concat(a))})),r=(t.services||[]).map((function(e){return{value:e.segment_id,label:e.name,parentLabel:t.node.name,ancestors:n,isLeaf:!0}}));return{value:t.node.id,label:t.node.name,isLeaf:!1,children:[].concat(h(a),h(r))}}(e,[{value:e.node.id,label:e.node.name,isLeaf:!1}])})).concat(c.data.length>0?this.buildTreeDataFromOwnSegments(c.data):[]),E=n.getAll().find((function(e){return!!e.model.exclude}))||this.state.showExclude;return r.createElement("div",{className:"audience-catalog"},r.createElement(u.default,{subtitle:d.default.sectionSubtitleAudience,title:d.default.sectionTitleAudience}),r.createElement(s.Row,null,r.createElement(s.Row,{className:"audience-selection-notice"},r.createElement(s.Col,{span:15,offset:4},r.createElement(i.FormattedMessage,f.default.genderNotice))),r.createElement(p.default,{label:t.formatMessage(f.default.genderLabel),placeholder:t.formatMessage(f.default.selectPlaceholder),datasource:y,loading:o.loading,tooltipProps:{title:t.formatMessage(f.default.genderTooltip)},value:this.getSelectedSegment(o.data),handleClickOnRemove:this.markAsDeleted(),handleClickOnItem:this.toggleSelected}),r.createElement(s.Row,{className:"audience-selection-notice"},r.createElement(s.Col,{span:10,offset:4},r.createElement(i.FormattedMessage,f.default.ageNotice))),r.createElement(p.default,{label:t.formatMessage(f.default.ageLabel),placeholder:t.formatMessage(f.default.selectPlaceholder),datasource:v,loading:l.loading,tooltipProps:{title:t.formatMessage(f.default.ageTooltip)},value:this.getSelectedSegment(l.data),handleClickOnRemove:this.markAsDeleted(),handleClickOnItem:this.toggleSelected}),r.createElement(s.Row,{className:"audience-selection-notice"},r.createElement(s.Col,{span:10,offset:4},r.createElement(i.FormattedMessage,f.default.detailedTargetingNotice))),r.createElement(g.default,{label:t.formatMessage(f.default.detailedTargetingLabel),placeholder:t.formatMessage(f.default.selectPlaceholder),dataSource:S,loading:a.loading||c.loading,tooltipProps:{title:t.formatMessage(f.default.detailedTargetingTooltip)},value:this.getSelectedSegment(_(a.data),c.data),handleClickOnRemove:this.markAsDeleted(),handleOnChange:this.handleChange(a.data,c.data)}),r.createElement("div",{className:E?"":"hide-section"},r.createElement(s.Row,{className:"audience-selection-notice"},r.createElement(s.Col,{span:15,offset:4},r.createElement(i.FormattedMessage,f.default.detailedTargetingExclusionNotice))),r.createElement(g.default,{label:t.formatMessage(f.default.detailedTargetingExclusionLabel),placeholder:t.formatMessage(f.default.selectPlaceholder),dataSource:S,loading:a.loading||c.loading,tooltipProps:{title:t.formatMessage(f.default.detailedTargetingExclusionTooltip)},value:this.getSelectedSegment(_(a.data),c.data,!0),handleClickOnRemove:this.markAsDeleted(!0),handleOnChange:this.handleChange(a.data,c.data,!0)})),r.createElement(s.Row,{className:E?"hide-section":""},r.createElement(s.Col,{span:3,offset:14},r.createElement(m.Button,{onClick:this.toogleShowExclude,className:"action-button"},r.createElement(i.FormattedMessage,f.default.excludeLinkMsg))))))}}]),t}(r.Component);function b(e){return{key:e.segment_id,label:e.name}}function _(e){return e.reduce((function(e,t){return[].concat(h(e),h(function e(t){return t.children.reduce((function(t,n){return[].concat(h(t),h(e(n)))}),t.services||[])}(t)))}),[])}t.default=(0,l.compose)(i.injectIntl,c.default)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),c=n(8),u=n(13),d=n(998),f=(a=d)&&a.__esModule?a:{default:a},p=n(12),m=n(15);var g=function(e,t,n,a){var r,o=arguments.length,i=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":s(Reflect))&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(i=(o<3?r(i):o>3?r(t,n,i):r(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i},y=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};t.default=(0,c.compose)(u.withRouter,f.default,(function(e){var t=function(t){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.fetchDetailedTargetingData=function(){var e=t.props.match.params.organisationId;t.setState((function(e){return{audienceCategoryTree:Object.assign(Object.assign({},e.audienceCategoryTree),{loading:!0})}})),t._catalogService.getCategoryTree(e,{serviceType:["AUDIENCE_DATA.AUDIENCE_SEGMENT"]}).then((function(n){return Promise.all(n.map((function(n){return function n(a){var r=t._catalogService.getServices(e,{parentCategoryId:a.node.id}),i=Promise.all(a.children.filter((function(e){return"AUDIENCE.AGE"!==e.node.category_subtype&&"AUDIENCE.GENDER"!==e.node.category_subtype})).map(n));return Promise.all([r,i]).then((function(e){var t=o(e,2),n=t[0],r=t[1];return{node:a.node,children:r,services:n.data}}))}(n)})))})).then((function(e){t.setState((function(t){return{audienceCategoryTree:{data:1===e.length?e[0].children:e,loading:!1}}}))}))},t.fetchGenderServiceItems=function(){var e=t.props.match.params.organisationId;t.setState((function(e){return{genderServiceItems:Object.assign(Object.assign({},e.genderServiceItems),{loading:!0})}})),t._catalogService.getAudienceSegmentServices(e,{categorySubtype:["AUDIENCE.GENDER"]}).then((function(e){return e.data})).then((function(e){t.setState((function(t){return{genderServiceItems:{data:e,loading:!1}}}))}))},t.fetchAgeServiceItems=function(){var e=t.props.match.params.organisationId;t.setState((function(e){return{ageServiceItems:Object.assign(Object.assign({},e.ageServiceItems),{loading:!0})}})),t._catalogService.getAudienceSegmentServices(e,{categorySubtype:["AUDIENCE.AGE"]}).then((function(e){return e.data})).then((function(e){t.setState((function(t){return{ageServiceItems:{data:e,loading:!1}}}))}))},t.fetchOwnDatamartSegments=function(){var e=t.props,n=e.match.params.organisationId,a=e.datamart;t.setState((function(e){return{audienceSegments:Object.assign(Object.assign({},e.audienceSegments),{loading:!0})}})),t._audienceSegmentService.getSegments(n,{max_results:500,datamart_id:a.id}).then((function(e){return e.data})).then((function(e){t.setState((function(t){return{audienceSegments:{data:e,loading:!1}}}))}))},t.state={audienceCategoryTree:{data:[],loading:!1},genderServiceItems:{data:[],loading:!1},ageServiceItems:{data:[],loading:!1},audienceSegments:{data:[],loading:!1}},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,t),i(n,[{key:"componentDidMount",value:function(){this.fetchDetailedTargetingData(),this.fetchGenderServiceItems(),this.fetchAgeServiceItems(),this.fetchOwnDatamartSegments()}},{key:"render",value:function(){var t=this.props,n=(t.datamart,t.history,t.location,t.match,y(t,["datamart","history","location","match"]));return l.createElement(e,r({},n,this.state))}}]),n}(l.Component);return g([(0,m.lazyInject)(p.TYPES.IAudienceSegmentService)],t.prototype,"_audienceSegmentService",void 0),g([(0,m.lazyInject)(p.TYPES.ICatalogService)],t.prototype,"_catalogService",void 0),t}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({selectPlaceholder:{id:"audience.catalog.select.placeholder",defaultMessage:"Browse Audience..."},genderLabel:{id:"audience.catalog.gender.label",defaultMessage:"Gender"},genderNotice:{id:"audience.catalog.gender.notice",defaultMessage:"INCLUDE people who match at least ONE of the following"},genderTooltip:{id:"audience.catalog.gender.tooltip",defaultMessage:"Lorem ipsum"},ageLabel:{id:"audience.catalog.age.label",defaultMessage:"Age"},ageNotice:{id:"audience.catalog.age.notice",defaultMessage:"INCLUDE people who match at least ONE of the following"},ageTooltip:{id:"audience.catalog.age.tooltip",defaultMessage:"Lorem ipsum"},detailedTargetingLabel:{id:"audience.catalog.detailed-targeting.label",defaultMessage:"Detailed Targeting"},detailedTargetingNotice:{id:"audience.catalog.detailed-targeting.notice",defaultMessage:"INCLUDE people who match at least ONE of the following"},detailedTargetingTooltip:{id:"audience.catalog.detailed-targeting.tooltip",defaultMessage:"Lorem ipsum"},detailedTargetingExclusionLabel:{id:"audience.catalog.detailed-targeting-exclusion.label",defaultMessage:"Exclude"},detailedTargetingExclusionNotice:{id:"audience.catalog.detailed-targeting-exclusion.notice",defaultMessage:"EXCLUDE people who match at least ONE of the following"},detailedTargetingExclusionTooltip:{id:"audience.catalog.detailed-targeting-exclusion.tooltip",defaultMessage:"Lorem ipsum"},excludeLinkMsg:{id:"audience.catalog.exclude-people.link.label",defaultMessage:"Exclude People"},mySegmentCategory:{id:"audience.catalog.my-segment-category.label",defaultMessage:"My Segment"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(11),s=n(84),l=(a=s)&&a.__esModule?a:{default:a};t.default=function(e){var t=e.label,n=e.placeholder,a=e.datasource,s=e.loading,c=e.tooltipProps,u=e.value,d=e.handleClickOnRemove,f=e.handleClickOnItem,p=e.small,m=s?r.createElement("div",{className:"text-center"},r.createElement(o.Spin,{size:"small"})):u.map((function(e){var t=a.find((function(t){return t.key===e}));return r.createElement("div",{key:e,className:"audience-service-item"},t?t.label:"",r.createElement(i.Button,{className:"remove-button",onClick:function(){d(e)}},r.createElement(i.McsIcon,{type:"close"})))})),g=u.length>0?"top":"middle";return r.createElement(l.default,{label:t,rowProps:{align:g},helpToolTipProps:c,small:p},r.createElement(o.Col,{span:24},r.createElement("div",{className:u.length||s?"selected-audience-services-container":""},m),r.createElement(i.SearchAndMultiSelect,{onClick:f,placeholder:n,datasource:a,value:u})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(54),s=n(11),l=u(n(84)),c=u(n(47));function u(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.id=(0,c.default)(),n.initTreeLeaves=function(e){var t={};!function e(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];n.forEach((function(n){n.children&&n.children.length&&e(n.children,a.concat([n])),t[n.value]={treeData:n,ancestors:a}}))}(e),n.setState({treeLeavesCache:t})},n.getTreeData=function(){return n.props.dataSource.map((function e(t){return{key:t.value,title:t.label,children:t.children?t.children.map(e):void 0,disabled:t.disabled,disableCheckbox:t.disableCheckbox}}))},n.state={treeLeavesCache:{}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.dataSource;this.initTreeLeaves(e)}},{key:"componentDidUpdate",value:function(e){var t=e.dataSource,n=this.props.dataSource;n.length!==t.length&&this.initTreeLeaves(n)}},{key:"render",value:function(){var e=this,t=this.props,n=t.value,a=t.handleClickOnRemove,c=t.handleOnChange,u=t.label,d=t.tooltipProps,f=t.small,p=t.loading,m=t.disabled,g=t.placeholder,y=this.state.treeLeavesCache,h=this.getTreeData(),v=[];Object.keys(y).forEach((function(e){if(n.includes(e)){var t=y[e];v.push({key:e,label:t.treeData.label,category:t.ancestors.reduce((function(e,t){return(e?e+" > ":"")+t.label}),"")})}}));var b=(0,i.groupBy)(v,"category"),_=[];Object.keys(b).forEach((function(e){_.push(r.createElement("div",{key:e,className:"audience-service-item as-category"},e)),b[e].forEach((function(e){_.push(r.createElement("div",{key:e.key,className:"audience-service-subitem"},e.label,r.createElement(s.Button,{disabled:m,className:"remove-button",onClick:function(){a(e.key)}},r.createElement(s.McsIcon,{type:"close"}))))}))}));var S=n.length>0?"top":"middle";return r.createElement(l.default,{label:u,rowProps:{align:S},helpToolTipProps:d,small:f,className:"mcs-treeSelectWithList"},r.createElement(o.Col,{span:24},r.createElement("div",{className:n.length||p?"selected-audience-services-container":""},p?r.createElement("div",{className:"text-center"},r.createElement(o.Spin,{size:"small"})):_),r.createElement("div",{id:this.id,className:"mcs-treeSelectWithList_container"},r.createElement(o.TreeSelect,{treeData:h,value:n,placeholder:g,onChange:c,treeCheckable:!0,maxTagCount:0,getPopupContainer:function(){return document.getElementById(e.id)},maxTagPlaceholder:function(){return g},dropdownStyle:{maxHeight:"200px",overflowY:"auto"}}))))}}]),t}(r.Component);t.default=d},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditCampaignPage=void 0;var a,r=n(2092),o=(a=r)&&a.__esModule?a:{default:a};t.EditCampaignPage=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=O(n(0)),i=n(8),s=n(25),l=n(13),c=n(10),u=n(6),d=O(n(204)),f=n(739),p=E(n(95)),m=E(n(1026)),g=E(n(23)),y=n(65),h=E(n(2223)),v=E(n(2224)),b=n(12),_=n(15),S=n(11);function E(e){return e&&e.__esModule?e:{default:e}}function O(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var w=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onSubmitFail=function(){var e=n.props.intl;c.message.error(e.formatMessage(p.default.errorFormMessage))},n.save=function(e){var t=n.props,a=t.match.params.organisationId,r=t.notifyError,o=t.history,i=t.intl,s=t.datamart,l=n.state.displayCampaignFormData,u=c.message.loading(i.formatMessage(p.default.savingInProgress),0);return n.setState({loading:!0}),n._displayCampaignFormService.saveCampaign(a,e,l,s&&s.id).then((function(e){u();var t="/v2/o/"+a+"/campaigns/display/"+e;o.push(t)})).catch((function(e){u(),r(e),n.setState({loading:!1})}))},n.onClose=function(){var e=n.props,t=e.history,a=e.location,r=e.match.params,o=r.campaignId,i=r.organisationId,s=o?"/v2/o/"+i+"/campaigns/display/"+o:"/v2/o/"+i+"/campaigns/display";return a.state&&a.state.from?t.push(a.state.from):t.push(s)},n.state={loading:!0,displayCampaignFormData:f.INITIAL_DISPLAY_CAMPAIGN_FORM_DATA},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match.params.campaignId,a=t.location,r=a.state&&a.state.campaignId,o=n||r;o?this._displayCampaignFormService.loadCampaign(o,!!r).then((function(t){e.setState({loading:!1,displayCampaignFormData:t})})).catch((function(t){e.setState({loading:!1}),e.props.notifyError(t)})):this.setState({loading:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.intl.formatMessage,r=this.state,i=r.loading,s=r.displayCampaignFormData;if(i)return o.createElement(S.Loading,{isFullScreen:!0});var l=s.campaign&&s.campaign.name?a(p.default.breadcrumbTitle3,{name:s.campaign.name}):a(p.default.createCampaingTitle),c=[{name:a(p.default.breadcrumbTitle1),path:"/v2/o/"+n+"/campaigns/display"},{name:l}];if(!s.campaign.subtype)return o.createElement(h.default,{onSelect:function(t){return e.setState({displayCampaignFormData:Object.assign(Object.assign({},s),{campaign:Object.assign(Object.assign({},s.campaign),{subtype:t})})})},close:this.onClose});switch(s.campaign.subtype){case"PROGRAMMATIC":return o.createElement(m.default,{initialValues:s,onSubmit:this.save,close:this.onClose,breadCrumbPaths:c,onSubmitFail:this.onSubmitFail});case"AD_SERVING":return o.createElement(v.default,{initialValues:s,onSubmit:this.save,close:this.onClose,breadCrumbPaths:c,onSubmitFail:this.onSubmitFail});case"TRACKING":return"This feature is not supported yet!"}}}]),t}(o.Component);w([(0,_.lazyInject)(b.TYPES.IDisplayCampaignFormService)],M.prototype,"_displayCampaignFormService",void 0),t.default=(0,i.compose)(l.withRouter,u.injectIntl,y.injectDatamart,(0,s.connect)((function(e){return{hasFeature:d.hasFeature(e)}})),g.default)(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(6),l=n(8),c=n(13),u=n(272),d=(a=u)&&a.__esModule?a:{default:a},f=n(44),p=n(15),m=n(12);function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},v=d.default,b=(0,s.defineMessages)({goalSelectorTitle:{id:"goal-selector-title",defaultMessage:"Add a goal"},goalSelectorSearchPlaceholder:{id:"goal-selector-search-placeholder",defaultMessage:"Search goals"},goalSelectorColumnName:{id:"goal-selector-column-name",defaultMessage:"Name"}}),_=function(e){function t(){g(this,t);var e=y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.saveGoals=function(t,n){e.props.save(n)},e.fetchGoals=function(t){var n=e.props.match.params.organisationId,a=Object.assign({},(0,f.getPaginatedApiParam)(t.currentPage,t.pageSize));return t.keywords&&(a.keywords=t.keywords),e._goalService.getGoals(n,a)},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.selectedGoalIds,a=t.close,r=t.intl.formatMessage,o=[{intlMessage:b.goalSelectorColumnName,key:"name",render:function(e,t){return i.createElement("span",null,t.name)}}];return i.createElement(v,{actionBarTitle:r(b.goalSelectorTitle),displayFiltering:!0,searchPlaceholder:r(b.goalSelectorSearchPlaceholder),selectedIds:n,fetchDataList:this.fetchGoals,fetchData:function(t){return e._goalService.getGoal(t)},columnsDefinitions:o,save:this.saveGoals,close:a})}}]),t}(i.Component);h([(0,p.lazyInject)(m.TYPES.IGoalService)],_.prototype,"_goalService",void 0),t.default=(0,l.compose)(c.withRouter,s.injectIntl)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttributionModelFormSection=t.TriggerFormSection=t.ConversionValueFormSection=t.GeneralFormSection=t.AttributionFormSection=void 0;var a=l(n(2095)),r=l(n(2096)),o=l(n(2097)),i=l(n(2098)),s=l(n(2219));function l(e){return e&&e.__esModule?e:{default:e}}t.AttributionFormSection=a.default,t.GeneralFormSection=r.default,t.ConversionValueFormSection=o.default,t.TriggerFormSection=i.default,t.AttributionModelFormSection=s.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=n(24),l=f(n(49)),c=f(n(63)),u=f(n(308)),d=f(n(811));function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=function(e){function t(){return p(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldNormalizer.normalizeInteger,n=e.fieldValidators,a=n.isRequired,o=n.isValidInteger,i=e.intl.formatMessage;return r.createElement("div",null,r.createElement(s.FormSection,{subtitle:d.default.sectionSubtitle2,title:d.default.sectionTitle2}),r.createElement("div",null,r.createElement(s.FormInputField,{name:"lookbackWindow.postClick",component:u.default,normalize:t,validate:[a,o],formItemProps:{label:i(d.default.contentSection2Row1Label),required:!0},inputProps:{placeholder:i(d.default.contentSection2Row1Placeholder)},helpToolTipProps:{title:i(d.default.contentSection2Row1Tooltip)}})),r.createElement("div",null,r.createElement(s.FormInputField,{name:"lookbackWindow.postView",component:u.default,normalize:t,validate:[a,o],formItemProps:{label:i(d.default.contentSection2Row2Label),required:!0},inputProps:{placeholder:i(d.default.contentSection2Row2Placeholder)},helpToolTipProps:{title:i(d.default.contentSection2Row2Tooltip)}})))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,l.default,c.default)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=n(11),l=n(24),c=f(n(49)),u=f(n(308)),d=f(n(811));function f(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage;return r.createElement("div",null,r.createElement(l.FormSection,{subtitle:d.default.sectionSubtitle1,title:d.default.sectionTitle1}),r.createElement("div",null,r.createElement(l.FormInputField,{name:"goal.name",component:u.default,validate:[t],formItemProps:{label:n(d.default.contentSectionGeneralRow1Label),required:!0},inputProps:{placeholder:n(d.default.contentSectionGeneralRow1Placeholder)},helpToolTipProps:{title:n(d.default.contentSectionGeneralRow1Tooltip)}})),r.createElement("div",null,r.createElement(s.Button,{className:"optional-section-title",onClick:this.toggleAdvancedSection},r.createElement(s.McsIcon,{type:"settings"}),r.createElement("span",{className:"step-title"},n(d.default.contentSectionGeneralAdvancedPartTitle)),r.createElement(s.McsIcon,{type:"chevron"})),r.createElement("div",{className:this.state.displayAdvancedSection?"optional-section-content":"hide-section"},r.createElement(l.FormInputField,{name:"goal.technical_name",component:u.default,formItemProps:{label:n(d.default.contentSectionGeneralAdvancedPartRow1Label)},inputProps:{placeholder:n(d.default.contentSectionGeneralAdvancedPartRow1Placeholder)},helpToolTipProps:{title:n(d.default.contentSectionGeneralAdvancedPartRow1Tooltip)}}))))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,c.default)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=n(10),l=n(24),c=p(n(49)),u=p(n(308)),d=n(13),f=p(n(993));function p(e){return e&&e.__esModule?e:{default:e}}var m=(0,i.defineMessages)({sectionSubtitle1:{id:"goalEditor.section.subtitle1",defaultMessage:"Give your Goal a conversion value."},sectionTitle1:{id:"goalEditor.section.subtitle2",defaultMessage:"Conversion Value"},defaultGoalValueLabel:{id:"goalEditor.default.value.label",defaultMessage:"Default Value"},defaultGoalValuePlaceholder:{id:"goalEditor.default.value.placeholder",defaultMessage:"Ex: 500"},defaultGoalValueTooltip:{id:"goalEditor.default.value.tooltip",defaultMessage:"Give a conversion a value so that you can track your value creation directly in the goal dashboard."}}),g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isDefaultGoalValue=n.props.initialValues&&n.props.initialValues.goal&&n.props.initialValues.goal.default_goal_value&&0!==n.props.initialValues.goal.default_goal_value,n.toggleConversionValueSection=function(){n.setState({displayConversionValueSection:!n.state.displayConversionValueSection}),n.props.formChange("goal.default_goal_value",0)},n.state={displayConversionValueSection:!!n.isDefaultGoalValue},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.fieldValidators.isValidDouble;return r.createElement("div",null,r.createElement(l.FormSection,{subtitle:m.sectionSubtitle1,title:m.sectionTitle1}),r.createElement(s.Checkbox,{checked:this.state.displayConversionValueSection,onChange:this.toggleConversionValueSection},r.createElement(i.FormattedMessage,{id:"goal.edit.conversionValueSection.checkbox-message",defaultMessage:"Add a conversion value"})),r.createElement("div",{className:this.state.displayConversionValueSection?"optional-section-content":"hide-section"},r.createElement(l.FormInputField,{name:"goal.default_goal_value",component:u.default,validate:[n],formItemProps:{label:t(m.defaultGoalValueLabel)},inputProps:{placeholder:t(m.defaultGoalValuePlaceholder),addonAfter:r.createElement(l.FormAddonSelectField,{name:"goal.goal_value_currency",component:f.default,options:[{title:"EUR",value:"EUR"}]})},helpToolTipProps:{title:t(m.defaultGoalValueTooltip)}})))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,d.withRouter,c.default)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=n(10),l=n(24),c=h(n(49)),u=h(n(812)),d=n(35),f=n(263),p=h(n(787)),m=n(810),g=n(25),y=h(n(1030));function h(e){return e&&e.__esModule?e:{default:e}}var v=d.Field,b=d.Field,_=(0,i.defineMessages)({sectionSubtitle1:{id:"goalEditor.section.trigger.subtitle1",defaultMessage:"Conversion tracking through a trigger"},sectionTitle1:{id:"goalEditor.section.trigger.subtitle2",defaultMessage:"Trigger"},triggerPixelHelpTooltip:{id:"goalEditor.section.trigger.pixel.modal.title",defaultMessage:"Pixel for goal. Use this pixel url tracking to capture a conversion goal."},audienceSegmentSectionQueryTitle:{id:"edit.goal.form.section.query.title",defaultMessage:"User Query"},audienceSegmentCreationUserQueryFieldHelper:{id:"edit.goal.form.section.general.field.query.helper",defaultMessage:'Start your query with "SELECT \\{ id \\} FROM UserPoint WHERE" and add your conditions after the WHERE clause.'},newGoalPixelSection:{id:"edit.goal.form.section.pixel.newGoal",defaultMessage:"Please save your goal to generate your pixel code."},goalAlreadyHasQueryTrigger:{id:"edit.goal.form.section.pixel.goal.has.query.trigger",defaultMessage:"You can't trigger via pixel because your goal already has a trigger via query."},configureDatamartToken:{id:"edit.goal.form.section.pixel.configureDatamartToken",defaultMessage:"The datamart token needs to be configured on the datamart."},noMoreSupported:{id:"edit.goal.legacyComponent.noMoreSupported",defaultMessage:"The query language related to this datamart is no more supported. Please select another datamart or create a new resource based on another datamart."}}),S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderQueryField=function(){var e=n.props,t=e.datamart,a=e.intl,o=r.createElement(b,{name:"query.query_text",component:u.default,formItemProps:{label:a.formatMessage(_.audienceSegmentSectionQueryTitle)},helpToolTipProps:{title:a.formatMessage(_.audienceSegmentCreationUserQueryFieldHelper)},datamartId:t.id}),i=r.createElement(v,{name:"query.query_text",component:y.default,inputProps:{datamartId:t.id,isTrigger:!0,context:"GOALS",queryHasChanged:n.hasQueryChanged()}}),l=r.createElement(s.Alert,{message:a.formatMessage(_.noMoreSupported),type:"warning"});switch(n.props.formValues.queryLanguage){case"SELECTORQL":return l;case"OTQL":return o;case"JSON_OTQL":return i}},n.hasQueryChanged=function(){var e=n.props,t=e.formValues,a=e.initialValues;return t.query&&a.query&&t.query.query_text!==a.query.query_text||t.query&&!!t.query.query_text&&!a.query},n.displayPixelSection=function(){var e=n.props,t=e.intl.formatMessage,a=e.datamart;return r.createElement("div",null,(0,f.isExistingGoal)(n.props.formValues.goal)?a.token?r.createElement(p.default,{language:"html",codeSnippet:'<img style="display:none" src="https://events.mediarithmics.com/v1/touches/pixel?$ev=$conversion&$dat_token='+a.token+"&$goal_id="+n.props.formValues.goal.id+'" />',copyToClipboard:!0,helpToolTipProps:{title:t(_.triggerPixelHelpTooltip)}}):r.createElement(s.Alert,{message:t(_.configureDatamartToken),type:"warning"}):r.createElement(s.Alert,{message:t(_.newGoalPixelSection),type:"warning"}))},n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e="PIXEL"===this.props.formValues.triggerType;return r.createElement("div",null,r.createElement(l.FormSection,{subtitle:_.sectionSubtitle1,title:_.sectionTitle1}),r.createElement(s.Row,null,r.createElement(s.Col,{span:24},e?this.displayPixelSection():this.renderQueryField())))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,c.default,(0,g.connect)((function(e){return{formValues:(0,d.getFormValues)(m.FORM_ID)(e)}})))(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(8),s=n(10),l=n(61),c=m(n(813)),u=n(820),d=n(11),f=n(227),p=m(n(1075));function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=function(e){function t(){g(this,t);var e=y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.openEditor=function(){var t=e.props,n=t.intl,a=t.value,i=t.segmentEditor,l=t.audienceBuilder,u=function(e,t,a){return r.createElement(d.Actionbar,{edition:!0,paths:[{name:n.formatMessage({id:"jsonql.querytool.query.edit",defaultMessage:"Edit Your Query"})}]},r.createElement(s.Button,{disabled:!a,className:"mcs-primary",type:"primary",onClick:e},r.createElement(o.FormattedMessage,{id:"queryTool.jsonql.querytool.query.edit.update",defaultMessage:"Update"})),r.createElement(d.McsIcon,{type:"close",className:"close-icon",style:{cursor:"pointer"},onClick:t}))};if("AUDIENCE_BUILDER"===i){return l&&e.props.openNextDrawer(p.default,{additionalProps:{renderActionBar:function(t,n){return u((function(){e.props.onChange&&e.props.onChange(JSON.stringify((0,f.formatQuery)(t))),e.props.closeNextDrawer()}),(function(){return e.props.closeNextDrawer()}),t)},initialValues:a?(0,f.formatQuery)(JSON.parse(a)):void 0,audienceBuilder:l}})}e.props.openNextDrawer(c.default,{additionalProps:{datamartId:e.props.datamartId,renderActionBar:function(t,n){return u((function(){e.props.onChange&&e.props.onChange(JSON.stringify(t)),e.props.closeNextDrawer()}),(function(){return e.props.closeNextDrawer()}),t)},editionLayout:!0,queryDocument:a?JSON.parse(a):void 0,isTrigger:e.props.isTrigger,isEdge:e.props.isEdge}})},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.context,n=e.queryHasChanged,a=e.intl;return"AUTOMATION_BUILDER"===t?r.createElement("div",{onClick:this.openEditor,className:"boolean-menu-item"},this.props.intl.formatMessage({id:"jsonql.button.query.edit",defaultMessage:"Edit Query"})):r.createElement("div",{className:"text-center m-t-20"},n&&r.createElement(s.Alert,{message:r.createElement("div",null,r.createElement(d.McsIcon,{type:"warning"}),a.formatMessage(u.messages.queryHasChanged)),type:"warning"}),r.createElement("br",null),r.createElement(s.Button,{onClick:this.openEditor},this.props.intl.formatMessage({id:"jsonql.button.query.edit",defaultMessage:"Edit Query"})))}}]),t}(r.Component);t.default=(0,i.compose)(o.injectIntl,l.injectDrawer)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(89),i=n(1031),s=n(1053),l=n(1055),c=n(1065),u=n(1057),d=n(2166),f=_(n(2167)),p=n(127),m=_(n(2168)),g=n(10),y=_(n(821)),h=n(419),v=_(n(1071)),b=n(11);function _(e){return e&&e.__esModule?e:{default:e}}function S(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.engine=new p.MicsDiagramEngine,n.isDragging=!1,n.lockInteraction=function(e){n.setState({locked:e})},n.keyboardOnlyLock=function(e){n.setState({keyboardOnlyLock:e})},n.getTreeNodeOperations=function(){return{deleteNode:n.deleteNode,addNode:n.addNode,updateNode:n.updateNode,copyNode:n.copyNode,cutNode:n.cutNode,updateLayout:function(){return n.engine.repaintCanvas()},addNewGroupAsRoot:n.addNewGroupAsRoot}},n.cutNode=function(e,t,a){n.copyNode(e,t,a),n.deleteNode(e)},n.copyNode=function(e,t,a){var r=n.props.query;if(r){var o=n.getObjectTreeExpressionFromNodePath(e,r);n.engine.setCopying(o,t,a)}},n.getObjectTreeExpressionFromNodePath=function(e,t){if(0===e.length)return t;if("FIELD"===t.type)return t;if(1===e.length)return t.expressions[e[0]];var a,r=(a=e,Array.isArray(a)?a:Array.from(a)),o=r[0],i=r.slice(1);return n.getObjectTreeExpressionFromNodePath(i,t.expressions[o])},n.addNode=function(e,t){var a=n.props,r=a.updateQuery,o=a.query;r(new p.AddOperation(e,t).execute(o))},n.updateNode=function(e,t){var a=n.props,r=a.updateQuery,o=a.query;r(new p.UpdateOperation(e,t).execute(o))},n.deleteNode=function(e){var t=n.props,a=t.updateQuery,r=t.query;a(new p.DeleteOperation(e).execute(r))},n.addNewGroupAsRoot=function(){var e=n.props,t=e.updateQuery,a=e.query;t({type:"GROUP",boolean_operator:"OR",expressions:a?[a]:[]})},n.handleKeyDown=function(e){n.state.keyboardOnlyLock||n.setState((function(t){return{keydown:t.keydown.find((function(t){return t===e.key}))?t.keydown:[].concat(S(n.state.keydown),[e.key])}}),(function(){n.state.keydown.includes("f")&&1===n.state.keydown.length&&n.engine.zoomToFit(),n.state.keydown.includes("r")&&1===n.state.keydown.length&&(n.engine.getDiagramModel().setZoomLevel(100),n.engine.getDiagramModel().setOffset(0,0)),n.state.keydown.includes("Control")&&n.state.keydown.includes("z")&&n.props.undoRedo.enableUndo&&n.props.undoRedo.handleUndo(),n.state.keydown.includes("Control")&&(n.state.keydown.includes("z")||n.state.keydown.includes("Z"))&&n.state.keydown.includes("Shift")&&n.props.undoRedo.enableRedo&&n.props.undoRedo.handleRedo(),n.state.keydown.includes("Control")&&(n.state.keydown.includes("y")||n.state.keydown.includes("Y")&&n.props.undoRedo.enableRedo)&&n.props.undoRedo.handleRedo()}))},n.handleKeyUp=function(e){n.setState((function(t){return{keydown:t.keydown.filter((function(t){return t!==e.key}))}}))},n.getRootNodePosition=function(){var e=n.props.hideCounterAndTimeline;return{x:p.ROOT_NODE_POSITION.x,y:e?p.ROOT_NODE_POSITION.x:p.ROOT_NODE_POSITION.y}};var a=e.objectTypes[0]?e.objectTypes[0].runtime_schema_id:"";return n.engine.registerNodeFactory(new i.BooleanOperatorNodeFactory(n.getTreeNodeOperations(),n.lockInteraction)),n.engine.registerNodeFactory(new u.PlusNodeFactory(n.getTreeNodeOperations(),n.props.objectTypes,n.lockInteraction,n.props.datamartId,a)),n.engine.registerNodeFactory(new c.ObjectNodeFactory(n.getTreeNodeOperations(),n.props.objectTypes,n.lockInteraction,n.props.datamartId)),n.engine.registerNodeFactory(new s.FieldNodeFactory(n.getTreeNodeOperations(),n.props.objectTypes,n.lockInteraction,n.keyboardOnlyLock,n.props.datamartId)),n.engine.registerLinkFactory(new l.SimpleLinkFactory),n.engine.registerPortFactory(new d.SimplePortFactory),n.state={keydown:[],locked:!1,viewSchema:!0,keyboardOnlyLock:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp)}},{key:"componentWillMount",value:function(){var e=this.props.objectTypes,t=new o.DiagramModel;t.setLocked(!0);var n=new u.PlusNodeModel;n.root=!0;var a=this.getRootNodePosition();n.x=a.x,n.y=a.y,this.buildModelTree(this.props.query,n,e,t),this.engine.setDiagramModel(t)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.query,a=t.objectTypes;if(n!==e.query){var r=new o.DiagramModel;r.setLocked(this.engine.getDiagramModel().locked),r.setZoomLevel(this.engine.getDiagramModel().getZoomLevel()),r.setOffsetX(this.engine.getDiagramModel().getOffsetX()),r.setOffsetY(this.engine.getDiagramModel().getOffsetY());var i=new u.PlusNodeModel;i.root=!0;var s=this.getRootNodePosition();i.x=s.x,i.y=s.y,this.buildModelTree(n,i,a,r),this.engine.setDiagramModel(r),this.forceUpdate()}}},{key:"buildModelTree",value:function(e,t,n,a){var r=n.find((function(e){return"UserPoint"===e.name}));if(t.objectTypeInfo=r,a.addNode(t),e){var o=(0,p.buildNodeModelBTree)(e,r,n);(0,p.setUniqueModelId)(o),(0,p.computeNodeExtras)(o),(0,p.layout)(o,(0,p.applyTranslation)(this.getRootNodePosition(),p.MIN_X,(t.getSize().height+2*(t.getSize().borderWidth||0))/2-(o.node.getSize().height+2*(o.node.getSize().borderWidth||0))/2)),a.addLink((0,p.createLink)(t.ports.right,o.node.ports.left)),(0,p.toNodeList)(o).forEach((function(e){return a.addNode(e)})),(0,p.buildLinkList)(o).forEach((function(e){return a.addLink(e)})),this.nodeBTreeCache=o}}},{key:"render",value:function(){var e=this,t=this.props,n=t.queryResult,a=t.staleQueryResult,i=t.runQuery,s=t.query,l=t.datamartId,c=t.organisationId,u=t.hideCounterAndTimeline,d=this.state.viewSchema;return r.createElement("div",{className:"query-builder "+(this.props.edition?"edition-mode":""),ref:this.div},r.createElement(m.default,{queryResults:[n],staleQueryResult:a,onRefresh:i,datamartId:l,organisationId:c,query:s,editionLayout:this.props.edition,hideCounterAndTimeline:u}),r.createElement(g.Col,{span:d?18:24,className:"diagram"},r.createElement(o.DiagramWidget,{diagramEngine:this.engine,allowCanvasZoom:!this.state.locked,allowCanvasTranslation:!this.state.locked,inverseZoom:!0}),r.createElement(f.default,{undoRedo:this.props.undoRedo}),r.createElement("div",{className:"button-helpers top"},r.createElement(b.Button,{onClick:function(){return e.setState({viewSchema:!d})},className:"helper"},r.createElement(b.McsIcon,{type:"chevron-right",style:d?{}:{transform:"rotate(180deg)",transition:"all 0.5ms ease"}})))),r.createElement(g.Col,{span:d?6:24,className:"schema-visualizer"},r.createElement(h.JSONQLBuilderContext.Consumer,null,(function(e){var t=e.schema;return r.createElement(y.default,{schema:t})}))),r.createElement("div",{id:"popoverId"}))}}]),t}(r.Component);t.default=(0,v.default)(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(89),i=l(n(1032)),s=l(n(1052));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"boolean-operator-node"));return a.treeNodeOperations=e,a.lockGlobalInteraction=n,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"generateReactWidget",value:function(e,t){return t.extras.collapsed?r.createElement("div",null):r.createElement(i.default,{node:t,diagramEngine:e,treeNodeOperations:this.treeNodeOperations,lockGlobalInteraction:this.lockGlobalInteraction})}},{key:"getNewInstance",value:function(e){return new s.default}}]),t}(o.AbstractNodeFactory);t.default=c},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(89),i=c(n(1054)),s=c(n(1068)),l=n(419);function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n,a,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"field-node"));return i.treeNodeOperations=e,i.objectTypes=n,i.lockGlobalInteraction=a,i.keyboardOnlyLock=r,i.datamartId=o,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"generateReactWidget",value:function(e,t){var n=this;return t.extras.collapsed?r.createElement("div",null):r.createElement(l.JSONQLBuilderContext.Consumer,null,(function(a){var o=a.runFieldProposal,s=a.isEdge;return r.createElement(i.default,{node:t,diagramEngine:e,treeNodeOperations:n.treeNodeOperations,objectTypes:n.objectTypes,lockGlobalInteraction:n.lockGlobalInteraction,keyboardOnlyLock:n.keyboardOnlyLock,datamartId:n.datamartId,runFieldProposal:o,isEdge:s})}))}},{key:"getNewInstance",value:function(e){return new s.default}}]),t}(o.AbstractNodeFactory);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(163),s=d(n(2159)),l=d(n(2160)),c=n(127),u=d(n(17));function d(e){return e&&e.__esModule?e:{default:e}}var f=(0,o.defineMessages)({EQ:{id:"fieldnoderenderer.fieldCondition.condition.EQ",defaultMessage:"equals"},NOT_EQ:{id:"fieldnoderenderer.fieldCondition.condition.NOT_EQ",defaultMessage:"does not equal"},MATCHES:{id:"fieldnoderenderer.fieldCondition.condition.MATCHES",defaultMessage:"matches"},DOES_NOT_MATCH:{id:"fieldnoderenderer.fieldCondition.condition.DOES_NOT_MATCH",defaultMessage:"does not match"},STARTS_WITH:{id:"fieldnoderenderer.fieldCondition.condition.STARTS_WITH",defaultMessage:"starts with"},DOES_NOT_START_WITH:{id:"fieldnoderenderer.fieldCondition.condition.DOES_NOT_START_WITH",defaultMessage:"does not start with"},CONTAINS:{id:"fieldnoderenderer.fieldCondition.condition.CONTAINS",defaultMessage:"contains"},DOES_NOT_CONTAIN:{id:"fieldnoderenderer.fieldCondition.condition.DOES_NOT_CONTAIN",defaultMessage:"does not contain"},BEFORE:{id:"fieldnoderenderer.fieldCondition.condition.BEFORE",defaultMessage:"before"},BEFORE_OR_EQUAL:{id:"fieldnoderenderer.fieldCondition.condition.BEFORE_OR_EQUAL",defaultMessage:"before or equal"},AFTER:{id:"fieldnoderenderer.fieldCondition.condition.AFTER",defaultMessage:"after"},AFTER_OR_EQUAL:{id:"fieldnoderenderer.fieldCondition.condition.AFTER_OR_EQUAL",defaultMessage:"after or equal"},EQUAL:{id:"fieldnoderenderer.fieldCondition.condition.EQUAL",defaultMessage:"equals"},NOT_EQUAL:{id:"fieldnoderenderer.fieldCondition.condition.NOT_EQUAL",defaultMessage:"does not equal"},LT:{id:"fieldnoderenderer.fieldCondition.condition.LT",defaultMessage:"is less than"},LTE:{id:"fieldnoderenderer.fieldCondition.condition.LTE",defaultMessage:"is less than or equals to"},GT:{id:"fieldnoderenderer.fieldCondition.condition.GT",defaultMessage:"is greater than"},GTE:{id:"fieldnoderenderer.fieldCondition.condition.GTE",defaultMessage:"is greater than or equals"}}),p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderDateValue=function(e){return e.reduce((function(e,t,n){return e+(0!==n?", ":"")+("string"==typeof(a=t)&&a.includes("now")?a:(0,u.default)(a).format("YYYY-MM-DD"));var a}),"")},n.renderStringValues=function(e){return e.reduce((function(e,t,n){return e+(0!==n?", ":"")+t}),"")},n.renderBooleanValues=function(e){return e.reduce((function(e,t,n){return e+(0!==n?", ":"")+("true"===t?"true":"false")}),"")},n.renderReferenceTable=function(e,t,a){var o=n.props.datamartId,c=function(e){return n.setState({objectName:e?""+(n.state.objectName?n.state.objectName+", "+e.name:e.name):n.state.objectName})};if("CORE_OBJECT"===t){if("COMPARTMENTS"===a)return r.createElement("span",{title:n.state.objectName},e.reduce((function(t,n,a){return t.push(r.createElement(s.default,{userAccountCompartmentId:n,key:n,onLoad:c})),a!==e.length-1&&t.push(", "),t}),[]));if("SEGMENTS"===a)return r.createElement("span",{title:n.state.objectName},e.reduce((function(t,n,a){return t.push(r.createElement(i.SegmentNameDisplay,{audienceSegmentId:n,key:n,onLoad:c})),a!==e.length-1&&t.push(", "),t}),[]));if("CHANNELS"===a)return r.createElement("span",{title:n.state.objectName},e.reduce((function(t,n,a){return t.push(r.createElement(l.default,{datamartId:o,channelId:n,key:n,onLoad:c})),a!==e.length-1&&t.push(", "),t}),[]))}return n.renderStringValues(e)},n.renderValues=function(e){var t=n.props.node,a=t.objectTypeInfo.fields.find((function(e){return e.name===t.fieldNode.field})),o=(0,c.getCoreReferenceTypeAndModel)(a.directives);if(o)return n.renderReferenceTable(e.values,o.type,o.modelType);switch(e.type){case"BOOLEAN":return r.createElement("span",{title:n.renderBooleanValues(e.values)},n.renderBooleanValues(e.values));case"TIME":return r.createElement("span",{title:n.renderDateValue(e.values)},n.renderDateValue(e.values));case"NUMERIC":case"STRING":case"ENUM":default:return r.createElement("span",{title:n.renderStringValues(e.values)},n.renderStringValues(e.values))}return""},n.state={objectName:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.node,t=e.fieldNode.comparison?e.fieldNode.comparison.operator:null,n=e.objectTypeInfo.fields.find((function(t){return t.name===e.fieldNode.field})),a=n&&n.decorator&&!1===n.decorator.hidden&&n.decorator.label?n.decorator.label:e.fieldNode.field;return r.createElement("div",{className:"comparison"},r.createElement("div",{style:{color:e.getColor()},className:"fieldname"},a),r.createElement("div",null,r.createElement("span",{className:"operator"},t?r.createElement(o.FormattedMessage,f[t]):null)," ",e.fieldNode.comparison&&e.fieldNode.comparison.values?this.renderValues(e.fieldNode.comparison):null))}}]),t}(r.Component);t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(15),s=n(12);var l=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchUserAccountCompartment=function(e){return n.setState({loading:!0}),n._compartmentService.getCompartment(e).then((function(e){return e.data})).then((function(e){return n.setState({loading:!1,compartment:e},(function(){return n.props.onLoad&&n.props.onLoad(e)}))})).catch((function(){return n.setState({loading:!1})}))},n.state={loading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.userAccountCompartmentId;this.fetchUserAccountCompartment(e)}},{key:"componentDidUpdate",value:function(e){var t=this.props.userAccountCompartmentId;e.userAccountCompartmentId!==t&&this.fetchUserAccountCompartment(t)}},{key:"render",value:function(){return this.state.loading?o.createElement("span",null):this.state.compartment?o.createElement("span",null,this.state.compartment.name?this.state.compartment.name:this.state.compartment.token?this.state.compartment.token:this.state.compartment.id):o.createElement("span",null,this.props.userAccountCompartmentId)}}]),t}(o.Component);t.default=c,l([(0,i.lazyInject)(s.TYPES.ICompartmentService)],c.prototype,"_compartmentService",void 0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(15),s=n(12);var l=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchChannel=function(e,t){return n.setState({loading:!0}),n._channelService.getChannel(e,t).then((function(e){return e.data})).then((function(e){return n.setState({loading:!1,channel:e},(function(){return n.props.onLoad&&n.props.onLoad(e)}))})).catch((function(){return n.setState({loading:!1})}))},n.state={loading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.channelId,n=e.datamartId;this.fetchChannel(n,t)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.channelId,a=t.datamartId,r=e.channelId,o=e.datamartId;n===r&&a===o||this.fetchChannel(a,n)}},{key:"render",value:function(){return this.state.loading?o.createElement("span",null):this.state.channel?o.createElement("span",null,this.state.channel.name):o.createElement("span",null,this.props.channelId)}}]),t}(o.Component);t.default=c,l([(0,i.lazyInject)(s.TYPES.IChannelService)],c.prototype,"_channelService",void 0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(89),i=l(n(1056)),s=l(n(819));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"simple"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"generateReactWidget",value:function(e,t){return r.createElement(i.default,{link:t,diagramEngine:e})}},{key:"getNewInstance",value:function(e){return new s.default}}]),t}(o.AbstractLinkFactory);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(89),i=c(n(1058)),s=c(n(1064)),l=n(419);function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n,a,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"plus-node"));return i.treeNodeOperations=e,i.objectTypes=n,i.lockGlobalInteraction=a,i.datamartId=r,i.runtimeSchemaId=o,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"generateReactWidget",value:function(e,t){var n=this;return t.extras.collapsed?r.createElement("div",null):r.createElement(l.JSONQLBuilderContext.Consumer,null,(function(a){var o=a.query,s=a.schema,l=a.isTrigger,c=a.isEdge;return r.createElement(i.default,{node:t,diagramEngine:e,treeNodeOperations:n.treeNodeOperations,objectTypes:n.objectTypes,lockGlobalInteraction:n.lockGlobalInteraction,query:o,schema:s,isTrigger:l,isEdge:c,datamartId:n.datamartId,runtimeSchemaId:n.runtimeSchemaId})}))}},{key:"getNewInstance",value:function(e){return new s.default}}]),t}(o.AbstractNodeFactory);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=h(n(54)),s=n(24),l=h(n(63)),c=h(n(49)),u=n(8),d=h(n(418)),f=n(35),p=n(25),m=n(342),g=n(820),y=n(127);function h(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var _=function(e){function t(){v(this,t);var e=b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildOptions=function(){return e.props.objectTypeFields.map((function(e){return{title:e.decorator&&!1===e.decorator.hidden?e.decorator.label:e.name,value:e.name}}))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"triggerModeFrequency",value:function(e,t){return"UserPoint"!==e.name||!i.default.flatMap(t.directives,(function(e){return e.arguments.map((function(e){return Object.values(y.typesTrigger).includes(e.value.replace(/[^a-zA-Z]+/g,""))}))})).reduce((function(e,t){return e||t}),!1)}},{key:"render",value:function(){var e=this.props,t=e.fieldValidators,n=t.isRequired,a=t.isValidInteger,i=e.intl.formatMessage,l=e.formValues,c=e.onSelect,u=e.isTrigger,f=e.objectType,p=e.selectedObjectType,m=!u||p&&this.triggerModeFrequency(f,p),y=!!(l.objectNodeForm.field&&f.fields.find((function(e){return l.objectNodeForm.field===e.name})).field_type.startsWith("[")&&m),h=l.frequency.enabled;return r.createElement("div",null,r.createElement(s.FormSection,{subtitle:d.default.objectNodeSubTitle,title:d.default.objectNodeTitle}),r.createElement("div",null,r.createElement(s.FormSelectField,{name:"objectNodeForm.field",component:s.DefaultSelect,validate:[n],options:this.buildOptions(),formItemProps:{label:i(d.default.objectNodeFieldLabel),required:!0},helpToolTipProps:{title:i(d.default.objectNodeFieldTooltip)},selectProps:{onSelect:c},small:!0})),y&&r.createElement(s.FormCheckboxField,{name:"frequency.enabled",component:s.FormCheckbox,className:"field-label m-b-20"},r.createElement(o.FormattedMessage,{id:"queryTool.queryDocument.objectNode.frequency.enabled",defaultMessage:"I want to add a frequency"})),h?r.createElement("div",null,r.createElement(s.FormInputField,{name:"frequency.value",component:s.FormInput,validate:[a],formItemProps:{label:i(d.default.objectNodeMinScoreLabel)},inputProps:{placeholder:i(d.default.objectNodeMinScorePlaceholder),type:"number",addonBefore:r.createElement(s.FormAddonSelectField,{name:"frequency.mode",component:s.AddonSelect,options:[{value:"AT_LEAST",title:i(g.frequencyModeMessageMap.AT_LEAST)},{value:"AT_MOST",title:i(g.frequencyModeMessageMap.AT_MOST)}]}),addonAfter:r.createElement(o.FormattedMessage,{id:"queryTool.queryDocument.objectNode.freqency.time",defaultMessage:"times"})},helpToolTipProps:{title:i(d.default.objectNodeMinScoreTooltip)},small:!0})):null)}}]),t}(r.Component);t.default=(0,u.compose)(o.injectIntl,c.default,l.default,(0,p.connect)((function(e){return{formValues:(0,f.getFormValues)(m.FORM_ID)(e)}})))(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(89),i=c(n(1066)),s=c(n(1067)),l=n(419);function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n,a,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"object-node"));return o.treeNodeOperations=e,o.objectTypes=n,o.lockGlobalInteraction=a,o.datamartId=r,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"generateReactWidget",value:function(e,t){var n=this;return t.extras.collapsed?r.createElement("div",null):r.createElement(l.JSONQLBuilderContext.Consumer,null,(function(a){var o=a.query,s=a.schema,l=a.isTrigger,c=a.isEdge;return r.createElement(i.default,{node:t,diagramEngine:e,treeNodeOperations:n.treeNodeOperations,objectTypes:n.objectTypes,lockGlobalInteraction:n.lockGlobalInteraction,query:o,schema:s,isTrigger:l,isEdge:c,datamartId:n.datamartId})}))}},{key:"getNewInstance",value:function(e){return new s.default}}]),t}(o.AbstractNodeFactory);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(77),l=n(35),c=n(6),u=n(13),d=n(8),f=n(311),p=(a=f)&&a.__esModule?a:{default:a};function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e){function t(){m(this,t);var e=g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.getQueryableFields=function(){var t=e.props,n=t.objectTypes,a=t.objectType,r=t.isEdge;return a.fields.filter((function(e){return!n.find((function(t){var n=e.field_type.match(/\w+/);return!(!n||n[0]!==t.name)}))&&e.directives.find((function(e){return"TreeIndex"===e.name}))&&(!r||e.directives.find((function(e){return"EdgeAvailability"===e.name})))}))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.change,a=e.objectType,r=e.idToAttachDropDowns,l=e.datamartId,c=e.runtimeSchemaId,u=e.treeNodePath,d=e.runFieldProposal,f=e.isEdge;return o.createElement(s.Form,{className:"edit-layout ant-layout",onSubmit:t,layout:"vertical"},o.createElement(p.default,{availableFields:this.getQueryableFields(),formChange:n,objectType:a,name:"fieldNodeForm",idToAttachDropDowns:r,datamartId:l,runtimeSchemaId:c,formName:this.props.form,treeNodePath:u,runFieldProposal:d,isEdge:f}),o.createElement(i.Button,{type:"primary",className:"mcs-primary",htmlType:"submit"},"Submit"))}}]),t}(o.Component);t.default=(0,d.compose)(c.injectIntl,u.withRouter,(0,l.reduxForm)({enableReinitialize:!0}))(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimplePortModel=t.SimplePortFactory=void 0;var a=o(n(1069)),r=o(n(274));function o(e){return e&&e.__esModule?e:{default:e}}t.SimplePortFactory=a.default,t.SimplePortModel=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(51),i=n(11),s=n(41);var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={viewHelp:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props.undoRedo,n=t.enableRedo,a=t.enableUndo,l=t.handleRedo,c=t.handleUndo,u=this.state.viewHelp,d=function(){return e.setState({viewHelp:!e.state.viewHelp})};return r.createElement("div",{style:{position:"relative",height:0}},r.createElement("div",{className:"button-helpers bottom"},r.createElement(i.Button,{disabled:!a,onClick:c,className:"helper"},r.createElement(s.ArrowLeftOutlined,null)),r.createElement(i.Button,{disabled:!n,onClick:l,className:"helper"},r.createElement(s.ArrowRightOutlined,null)),r.createElement(i.Button,{onClick:d,className:"helper"},r.createElement(i.McsIcon,{type:"question"}))),u&&r.createElement(o.WindowBodyPortal,null,r.createElement("div",{className:"overview-modal"},r.createElement("div",{onClick:d,className:"overlay"}),r.createElement("div",{className:"mcs-modal"},r.createElement("div",{className:"keyboard-line"},r.createElement("span",{className:"keyboard-control"},"f")," ",r.createElement("span",{className:"keyboard-about"},"zoom to fit")),r.createElement("div",{className:"keyboard-line"},r.createElement("span",{className:"keyboard-control"},"r")," ",r.createElement("span",{className:"keyboard-about"},"reset zoom")),r.createElement("div",{className:"keyboard-line"},r.createElement("span",{className:"keyboard-control"},"ctrl")," ",r.createElement("span",{className:"keyboard-about"},"+")," ",r.createElement("span",{className:"keyboard-control"},"z")," ",r.createElement("span",{className:"keyboard-about"},"undo")),r.createElement("div",{className:"keyboard-line"},r.createElement("span",{className:"keyboard-control"},"ctrl")," ",r.createElement("span",{className:"keyboard-about"},"+")," ",r.createElement("span",{className:"keyboard-control"},"shift")," ",r.createElement("span",{className:"keyboard-about"},"+")," ",r.createElement("span",{className:"keyboard-control"},"z")," ",r.createElement("span",{className:"keyboard-about"},"redo"))))))}}]),t}(r.Component);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=s(n(2169)),i=s(n(1070));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=function(e){function t(){l(this,t);var e=c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.generateWidth=function(){var t=e.props.queryResults;return 1===t.length?"100%":t.length>1&&t.length<6?100/t.length+"%":"20%"},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.queryResults,a=t.staleQueryResult,s=t.onRefresh,l=t.organisationId,c=t.editionLayout,u=t.hideCounterAndTimeline;if(0===n.length)return null;var d=c?{}:{position:"relative",height:0},f=!u&&r.createElement(i.default,{stale:a,datamartId:this.props.datamartId,query:this.props.query,organisationId:l});return r.createElement("div",{style:d},r.createElement("div",{style:{position:"absolute",padding:"0px 40px",left:0,zIndex:1e4,display:"inline-block",width:n.length<=5?20*n.length+"%":"100%",cursor:"auto"}},n.map((function(t,n){var i=t.otqlResult?t.otqlResult.rows[0].count:void 0,l=t.error||(t.otqlResult?t.otqlResult.timed_out:void 0);return r.createElement(o.default,{key:n,name:"UserPoint",value:i,loading:t.loading,stale:a,width:e.generateWidth(),onRefresh:s,error:l,hideValue:u})})),f))}}]),t}(r.Component);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(41),i=n(56),s=n(11);var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hover:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.name,a=t.value,l=t.loading,c=t.error,u=t.stale,d=t.onRefresh,f=t.width,p=function(t){return function(){return e.setState({hover:"enter"===t})}},m=!t.hideValue&&r.createElement(r.Fragment,null,r.createElement("div",{className:"view-value"},l?r.createElement("i",{className:"mcs-table-cell-loading",style:{maxWidth:"100%"}}):(0,i.formatMetric)(a,"0,0")),l&&r.createElement("div",{className:"refresh-overlay",onClick:d}),l&&r.createElement("div",{className:"refresh-text"},r.createElement(o.LoadingOutlined,null)),(u||this.state.hover)&&!l&&r.createElement("div",{className:"refresh-overlay",onClick:d}),(u||this.state.hover)&&!l&&r.createElement("div",{className:"refresh-text",onClick:d},r.createElement(s.McsIcon,{type:"refresh"})),c&&!l&&r.createElement("div",{className:"refresh-overlay error",onClick:d}),c&&!l&&r.createElement("div",{className:"refresh-text error",onClick:d},r.createElement(s.McsIcon,{type:"refresh"})));return r.createElement("div",{className:"m-t-20",style:{float:"left",width:f,padding:"0 8px",position:"relative"},onMouseEnter:p("enter"),onMouseLeave:p("leave")},r.createElement("div",{className:"mcs-card no-margin-bottom result-view"},r.createElement("div",{className:"view-name"},n),m))}}]),t}(r.Component);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(226),s=n(127),l=n(10),c=n(47),u=(a=c)&&a.__esModule?a:{default:a},d=n(11);function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m={beginDrag:function(e){return"field"===e.type?{name:e.item.name,objectSource:e.item.closestParentType,type:e.type,path:e.item.path,item:e.item,fieldType:(0,s.extractFieldType)(e.item)}:{name:e.item.name,objectSource:e.item.closestParentType,schemaType:e.schemaType,type:e.type,path:e.item.path,item:e.item}}},g=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.isDragging,a=e.connectDragSource,r=e.type,i=t.name;t.decorator&&!1===t.decorator.hidden&&(i=t.decorator.label);var s="object"===r?t.schemaType:t.field_type,c=o.createElement("span",{className:"field-type"},s," ",o.createElement(d.McsIcon,{type:"dots"}));if(t.decorator&&!1===t.decorator.hidden&&t.decorator.help_text){var f=t.decorator.help_text+" - "+s,p=(0,u.default)();c=o.createElement("span",{className:"field-type",id:p},o.createElement(l.Tooltip,{placement:"left",title:f,getPopupContainer:function(){return document.getElementById(p)}},o.createElement(d.McsIcon,{type:"question"})))}return a&&a(o.createElement("div",{className:"field-node-item "+(n?"dragging":"")},o.createElement("div",null,i," ",c)))}}]),t}(o.Component);t.default=(0,i.DragSource)((function(e){return e.type}),m,(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(47),l=(a=s)&&a.__esModule?a:{default:a},c=n(11);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e){function t(){return u(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.type,a=t.name,r="object"===n?t.schemaType:t.field_type,s=o.createElement("span",{className:"field-type"},r," ",o.createElement(c.McsIcon,{type:"dots"}));if(t.decorator&&!1===t.decorator.hidden&&t.decorator.help_text){var u=t.decorator.help_text+" - "+r,d=(0,l.default)();s=o.createElement("span",{className:"field-type",id:d},o.createElement(i.Tooltip,{placement:"left",title:u,getPopupContainer:function(){return document.getElementById(d)}},o.createElement(c.McsIcon,{type:"question"})))}return o.createElement("div",{className:"field-node-item"},o.createElement("div",null,a," ",s))}}]),t}(o.Component);t.default=f},,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAudienceBuilderGroupNode=function(e){return"GROUP"===e.type},t.isAudienceBuilderParametricPredicateNode=function(e){return"PARAMETRIC_PREDICATE"===e.type}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(6),l=n(227),c=n(8),u=n(15),d=n(12),f=h(n(23)),p=n(11),m=h(n(823)),g=h(n(153)),y=h(n(1070));function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.loadData=function(e,t,a){n.setState({isDashboardLoading:!0}),n._dashboardService.getAudienceBuilderDashboards(e,t,a,{}).then((function(e){n.setState({dashboards:"ok"===e.status?e.data:[]})})).catch((function(e){n.props.notifyError(e)})).finally((function(){n.setState({isDashboardLoading:!1})}))},n.state={dashboards:[],isDashboardLoading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.organisationId,n=e.datamartId,a=e.audienceBuilderId;this.loadData(t,n,a)}},{key:"render",value:function(){var e=this.props,t=e.intl,n=e.totalAudience,a=e.isQueryRunning,r=e.queryDocument,s=e.datamartId,c=e.organisationId,u=this.state,d=u.isDashboardLoading,f=u.dashboards;return o.createElement("div",{className:"mcs-audienceBuilder_liveDashboard"},a?o.createElement(p.Loading,{isFullScreen:!0}):n||0===n?o.createElement(o.Fragment,null,o.createElement(g.default,{className:"mcs-audienceBuilder_totalAudience"},o.createElement(i.Statistic,{title:t.formatMessage(l.messages.selectedAudience),value:n}),o.createElement("div",{className:"mcs-audienceBuilder_timelineSelector"},o.createElement(y.default,{stale:!1,datamartId:s,query:null==r?void 0:r.where,organisationId:c}))),d||!r?o.createElement(p.Loading,{className:"m-t-20",isFullScreen:!0}):f.map((function(e){return o.createElement(m.default,{key:e.id,layout:e.components,datamartId:e.datamart_id,source:r})}))):o.createElement(g.default,{className:"mcs-audienceBuilder_totalAudience"},o.createElement(i.Statistic,{title:t.formatMessage(l.messages.selectedAudience)})))}}]),t}(o.Component);v([(0,u.lazyInject)(d.TYPES.IDashboardService)],b.prototype,"_dashboardService",void 0),t.default=(0,c.compose)(s.injectIntl,f.default)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=v(n(54)),i=n(824),s=v(n(2198)),l=v(n(2199)),c=v(n(2200)),u=v(n(2201)),d=v(n(2202)),f=v(n(2203)),p=v(n(2207)),m=v(n(2208)),g=v(n(2209)),y=v(n(2210)),h=v(n(2211));function v(e){return e&&e.__esModule?e:{default:e}}var b=(0,i.WidthProvider)(i.Responsive),_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.generateComponent=function(e,t){var a=n.props,o=a.source,i=a.datamartId,v=n.computeHeight(t.h);switch(e.component_type){case"COUNT":return r.createElement(s.default,{source:o,datamartId:i,title:e.title,queryId:e.query_id});case"PERCENTAGE":return r.createElement(m.default,{source:o,datamartId:i,title:e.title,queryId:e.query_id,totalQueryId:e.total_query_id});case"MAP_PIE_CHART":return r.createElement(l.default,{source:o,title:e.title,queryId:e.query_id,data:e.data,datamartId:i,labelsEnabled:e.show_legend,height:v});case"MAP_BAR_CHART":return r.createElement(c.default,{source:o,datamartId:i,queryId:e.query_id,title:e.title,labelsEnabled:e.labels_enabled,shouldCompare:e.shouldCompare,percentage:e.percentage,vertical:e.vertical,sortKey:e.sortKey,data:e.data,labels:e.labels,tooltip:e.tooltip});case"MAP_RADAR_CHART":return r.createElement(h.default,{source:o,datamartId:i,queryId:e.query_id,title:e.title,labelsEnabled:e.labels_enabled,shouldCompare:e.shouldCompare,percentage:e.percentage,vertical:e.vertical,sortKey:e.sortKey,labels:e.labels,data:e.data,tooltip:e.tooltip});case"DATE_AGGREGATION_CHART":return r.createElement(u.default,{source:o,title:e.title,queryIds:e.query_ids,plotLabels:e.plot_labels,datamartId:i,height:v,format:e.format});case"GAUGE_PIE_CHART":return r.createElement(d.default,{datamartId:i,title:e.title,queryIds:e.query_ids,height:v});case"WORLD_MAP_CHART":return r.createElement(f.default,{title:e.title,datamartId:i,queryId:e.query_id,height:v});case"COUNT_BAR_CHART":return r.createElement(p.default,{title:e.title,queryIds:e.query_ids,datamartId:i,labelsEnabled:!0,height:v,plotLabels:e.plot_labels});case"COUNT_PIE_CHART":return r.createElement(g.default,{datamartId:i,height:v,labelsEnabled:e.labels_enabled,plotLabels:e.plot_labels,queryIds:e.query_ids,title:e.title});case"TOP_INFO_COMPONENT":return r.createElement(y.default,{datamartId:i,title:e.title,queryId:e.query_id,source:o});default:return null}},n.computeHeight=function(e){return 150*e+(e>1?5*e:0)-51},n.state={currentBreakpoint:"lg",compactType:"vertical",mounted:!1},n.onBreakpointChange=n.onBreakpointChange.bind(n),n.onLayoutChange=n.onLayoutChange.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"generateDOM",value:function(){var e=this;return o.default.map(this.props.layout,(function(t,n){var a=t.component,o=t.layout;return r.createElement("div",{key:n.toString(),className:o.static?"static":"",style:{backgroundColor:"#fff"}},e.generateComponent(a,o))}))}},{key:"onBreakpointChange",value:function(e){this.setState({currentBreakpoint:e})}},{key:"onLayoutChange",value:function(e,t){this.props.onLayoutChange(e,t),window.dispatchEvent(new Event("resize"))}},{key:"render",value:function(){var e=this.props.layout.map((function(e,t){return Object.assign(Object.assign({},e.layout),{i:t.toString()})}));return r.createElement(b,{cols:{lg:12,md:12,sm:12,xs:12,xxs:12},layouts:{lg:e},onBreakpointChange:this.onBreakpointChange,measureBeforeMount:!1,useCSSTransforms:this.state.mounted,compactType:this.state.compactType,preventCollision:!this.state.compactType,isDraggable:!1,isResizable:!1},this.generateDOM())}}]),t}(r.Component);t.default=_},,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=p(n(54)),s=n(138),l=n(56),c=n(15),u=n(12),d=p(n(153)),f=n(205);function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchData=function(e,t,a){return n.setState({error:!1,loading:!0}),n._queryService.getQuery(t,e).then((function(e){return e.data})).then((function(e){return(0,f.getFormattedQuery)(t,n._queryService,e,a)})).then((function(e){var a=e.query_text;return n._queryService.runOTQLQuery(t,a,{use_cache:!0}).then((function(e){return e.data})).then((function(e){if((0,s.isCountResult)(e.rows))return n.setState({queryResult:e.rows[0].count,loading:!1}),Promise.resolve();var t=new Error("wrong query type");return Promise.reject(t)}))})).catch((function(){n.setState({error:!0,loading:!1})}))},n.state={error:!1,loading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.source,n=e.datamartId,a=e.queryId;this.fetchData(a,n,t)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.source,a=t.queryId,r=t.datamartId,o=e.source,s=e.queryId,l=e.datamartId;i.default.isEqual(o,n)&&a===s&&r===l||this.fetchData(a,r,n)}},{key:"render",value:function(){return o.createElement(d.default,null,o.createElement("div",{className:"dashboard-counter"},o.createElement("div",{className:"count-title"},this.state.loading?o.createElement("i",{className:"mcs-table-cell-loading",style:{maxWidth:"40%"}}):this.props.title),o.createElement("div",{className:"count-result"},this.state.loading?o.createElement("i",{className:"mcs-table-cell-loading-large",style:{maxWidth:"100%"}}):(0,l.formatMetric)(this.state.queryResult,"0,0"))))}}]),t}(o.Component);t.default=g,m([(0,c.lazyInject)(u.TYPES.IQueryService)],g.prototype,"_queryService",void 0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=v(n(47)),s=v(n(54)),l=n(138),c=v(n(69)),u=n(8),d=n(6),f=v(n(275)),p=n(15),m=n(12),g=v(n(153)),y=n(205),h=n(11);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.identifier=(0,i.default)(),n.formatOtqlQueryResult=function(e){return e&&(0,l.isAggregateResult)(e.rows)&&!(0,l.isCountResult)(e.rows)?n.setState({queryResult:n.formatData(e.rows),loading:!1}):n.setState({error:!0,loading:!1})},n.formatData=function(e){var t=function(e){var t=n.state.colors;return e<t.length?e:e-Math.floor(e/t.length)*t.length};return e.length&&e[0].aggregations.buckets.length&&e[0].aggregations.buckets[0].buckets.length?e[0].aggregations.buckets[0].buckets.map((function(e,a){return{key:e.key,value:e.count,color:n.state.colors[t(a)]}})):[]},n.fetchData=function(e,t,a){return n.setState({error:!1,loading:!0}),n._queryService.getQuery(t,e).then((function(e){return e.data})).then((function(e){return(0,y.getFormattedQuery)(t,n._queryService,e,a)})).then((function(e){var a=e.query_text;return n._queryService.runOTQLQuery(t,a,{use_cache:!0}).then((function(e){return e.data})).then((function(e){if((0,l.isAggregateResult)(e.rows)&&!(0,l.isCountResult)(e.rows))return n.setState({queryResult:n.formatData(e.rows),loading:!1}),Promise.resolve();var t=new Error("wrong query type");return Promise.reject(t)}))})).catch((function(){n.setState({error:!0,loading:!1})}))},n.generateOptions=function(){return{innerRadius:!0,isHalf:!1,text:{text:"",value:""},colors:n.state.colors,showTooltip:!0,height:300,showLabels:n.props.labelsEnabled}};var a=e.colors,r=[a["mcs-warning"],a["mcs-info"],a["mcs-highlight"],a["mcs-success"],a["mcs-primary"],a["mcs-error"]];return n.state={error:!1,loading:!0,colors:r},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.source,n=e.queryId,a=e.datamartId,r=e.data;r?this.formatOtqlQueryResult(r):this.fetchData(n,a,t)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.source,a=t.queryId,r=t.datamartId,o=t.data,i=e.source,l=e.queryId,c=e.datamartId,u=e.data;s.default.isEqual(i,n)&&a===l&&r===c&&s.default.isEqual(o,u)||(o?this.formatOtqlQueryResult(o):this.fetchData(a,r,n))}},{key:"render",value:function(){var e=this,t=this.props,n=t.intl,a=t.height,r=this.generateOptions();return o.createElement(g.default,{title:this.props.title},e.state.loading?o.createElement(h.LoadingChart,null):e.state.error?o.createElement(h.EmptyChart,{title:n.formatMessage(f.default.error),icon:"close-big"}):e.state.queryResult&&0===e.state.queryResult.length||!e.state.queryResult?o.createElement(h.EmptyChart,{title:n.formatMessage(f.default.noData),icon:"warning"}):o.createElement(h.PiePlot,{dataset:e.state.queryResult,options:r,height:a}))}}]),t}(o.Component);b([(0,p.lazyInject)(m.TYPES.IQueryService)],_.prototype,"_queryService",void 0),t.default=(0,u.compose)(c.default,d.injectIntl)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=b(n(54)),l=b(n(47)),c=n(138),u=b(n(69)),d=n(8),f=n(6),p=b(n(275)),m=n(15),g=n(12),y=b(n(153)),h=n(205),v=n(11);function b(e){return e&&e.__esModule?e:{default:e}}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E="yKey",O=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.identifier=(0,l.default)(),n.formatOtqlQueryResult=function(e){return e&&(0,c.isAggregateResult)(e.rows)&&!(0,c.isCountResult)(e.rows)?n.setState({queryResult:n.formatData(e.rows,E),loading:!1}):n.setState({error:!0,loading:!1})},n.formatData=function(e,t){var a=n.props.percentage;if(e.length&&e[0].aggregations.buckets.length&&e[0].aggregations.buckets[0].buckets.length){var r=a?e[0].aggregations.buckets[0].buckets.reduce((function(e,t){return e+t.count}),0):void 0;return e[0].aggregations.buckets[0].buckets.map((function(e,n){var a;return _(a={},t+"-count",e.count),_(a,t,r?Math.round(e.count/r*1e4)/100:e.count),_(a,"xKey",e.key),a}))}return[]},n.mergeData=function(e,t,n,a){return e.map((function(e){return e.xKey})).concat(n.map((function(e){return e.xKey}))).filter((function(e,t,n){return n.indexOf(e)===t})).map((function(r){var o;return _(o={},a,n.find((function(e){return e.xKey===r}))&&n.find((function(e){return e.xKey===r}))[a]?n.find((function(e){return e.xKey===r}))[a]:0),_(o,t,e.find((function(e){return e.xKey===r}))&&e.find((function(e){return e.xKey===r}))[t]?e.find((function(e){return e.xKey===r}))[t]:0),_(o,"xKey",r),o}))},n.fetchData=function(e,t,r,o){n.setState({error:!1,loading:!0});var i=r?n._queryService.getQuery(t,e).then((function(e){return e.data})).then((function(e){return(0,h.getFormattedQuery)(t,n._queryService,e)})):Promise.resolve();return Promise.all([n._queryService.getQuery(t,e).then((function(e){return e.data})).then((function(e){return(0,h.getFormattedQuery)(t,n._queryService,e,o)})),i]).then((function(e){var r,o=a(e,2),i=o[0],s=o[1];return Promise.all([n._queryService.runOTQLQuery(t,i.query_text,{use_cache:!0}).then((function(e){return e.data})),(r=s,r?n._queryService.runOTQLQuery(t,r.query_text,{use_cache:!0}).then((function(e){return e.data})):Promise.resolve())]).then((function(e){var t=a(e,2),r=t[0],o=t[1];if(r&&!o&&(0,c.isAggregateResult)(r.rows)&&!(0,c.isCountResult)(r.rows))return n.setState({queryResult:n.formatData(r.rows,E),loading:!1}),Promise.resolve();if(r&&o&&(0,c.isAggregateResult)(r.rows)&&!(0,c.isCountResult)(r.rows)&&(0,c.isAggregateResult)(o.rows)&&!(0,c.isCountResult)(o.rows))return n.setState({queryResult:n.mergeData(n.formatData(r.rows,E),E,n.formatData(o.rows,"comparedYKey"),"comparedYKey"),loading:!1}),Promise.resolve();var i=new Error("wrong query type");return Promise.reject(i)})).catch((function(){return n.setState({error:!0,loading:!1})}))})).catch((function(){return n.setState({error:!0,loading:!1})}))};var r=e.colors,o=[r["mcs-warning"],r["mcs-info"],r["mcs-highlight"],r["mcs-success"],r["mcs-normal"],r["mcs-primary"],r["mcs-error"]];return n.state={error:!1,loading:!0,colors:o},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.source,n=e.queryId,a=e.datamartId,r=e.shouldCompare,o=e.data;o?this.formatOtqlQueryResult(o):this.fetchData(n,a,r,t)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.source,a=t.queryId,r=t.datamartId,o=t.shouldCompare,i=t.data,l=e.source,c=e.queryId,u=e.datamartId,d=e.data;s.default.isEqual(l,n)&&a===c&&r===u&&s.default.isEqual(i,d)||(i?this.formatOtqlQueryResult(i):this.fetchData(a,r,o,n))}},{key:"render",value:function(){var e=this,t=this.props,n=t.title,a=t.colors,r=t.intl,o=t.shouldCompare,s=t.vertical,l=t.sortKey,c=t.labels,u=t.tooltip,d={xKey:"xKey",yKeys:[{key:E,message:""}].concat(o?[{key:"comparedYKey",message:""}]:[]),colors:[a["mcs-info"]].concat(o?[a["mcs-normal"]]:[]),labelsEnabled:this.props.labelsEnabled,vertical:s,sort:l,labels:c,tooltip:u};return i.createElement(y.default,{title:n},e.state.loading?i.createElement(v.LoadingChart,null):e.state.error?i.createElement(v.EmptyChart,{title:r.formatMessage(p.default.error),icon:"close-big"}):e.state.queryResult&&0===e.state.queryResult.length||!e.state.queryResult?i.createElement(v.EmptyChart,{title:r.formatMessage(p.default.noData),icon:"warning"}):e.state.queryResult&&e.state.queryResult.length&&i.createElement(v.StackedBarPlot,{dataset:e.state.queryResult,options:d}))}}]),t}(i.Component);S([(0,m.lazyInject)(g.TYPES.IQueryService)],O.prototype,"_queryService",void 0),t.default=(0,d.compose)(u.default,f.injectIntl)(O)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=v(n(47)),s=n(138),l=v(n(69)),c=v(n(17)),u=n(8),d=n(6),f=v(n(275)),p=n(15),m=n(12),g=v(n(153)),y=n(205),h=n(11);function v(e){return e&&e.__esModule?e:{default:e}}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.identifier=(0,i.default)(),n.formatDataQuery=function(e,t){var a=n.props.format;return e.length&&e[0].aggregations.buckets.length&&e[0].aggregations.buckets[0].buckets.length?e[0].aggregations.buckets[0].buckets.map((function(e,n){var r;return b(r={},t,e.count),b(r,"xKey",a?(0,c.default)(e.key).format(a):e.key),r})):[]},n.groupQueryResult=function(e,t){return t.reduce((function(e,t,n){return e.concat(t)}),[]).reduce((function(t,n,a){var r=t.findIndex((function(t){return t[e]===n[e]}));return r>-1?(t[r]=Object.assign(Object.assign({},t[r]),n),t):(t.push(n),t)}),[])},n.fetchData=function(e,t,a){return n.setState({error:!1,loading:!0}),Promise.all(e.map((function(e,r){return n.fetchQuery(e,t,r,a)}))).then((function(e){n.setState({loading:!1,queryResult:n.groupQueryResult("xKey",e)})})).catch((function(){n.setState({error:!0,loading:!1})}))},n.fetchQuery=function(e,t,a,r){return n._queryService.getQuery(t,e).then((function(e){return e.data})).then((function(e){return(0,y.getFormattedQuery)(t,n._queryService,e,r)})).then((function(e){return n._queryService.runOTQLQuery(t,e.query_text,{use_cache:!0}).then((function(e){return e.data})).then((function(e){if((0,s.isAggregateResult)(e.rows)&&!(0,s.isCountResult)(e.rows))return Promise.resolve(n.formatDataQuery(e.rows,n.props.plotLabels[a]?n.props.plotLabels[a]:a.toString()));throw new Error("wrong query type")}))}))},n.generateOptions=function(){return{innerRadius:!0,isHalf:!1,text:{},colors:n.state.colors,showTooltip:!0}};var a=e.colors,r=[a["mcs-error"],a["mcs-highlight"],a["mcs-info"],a["mcs-normal"],a["mcs-primary"],a["mcs-success"],a["mcs-warning"]];return n.state={error:!1,loading:!0,colors:r},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.source,n=e.queryIds,a=e.datamartId;this.fetchData(n,a,t)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.source,a=t.queryIds,r=t.datamartId,o=e.source,i=e.queryIds,s=e.datamartId;n===o&&a===i&&r===s||this.fetchData(a,r,n)}},{key:"render",value:function(){var e,t=this,n=this.props,a=n.title,r=n.colors,i=n.intl,s=n.plotLabels,l=n.queryIds,c=n.height,u={xKey:"xKey",yKeys:l.map((function(e,t){return{key:s[t]?s[t]:t.toString(),message:s[t]?s[t]:t.toString()}})),colors:(e=Object.keys(r).filter((function(e){return"mcs-normal"!==e})),l.map((function(t,n){return r[e[n%(e.length-1)]]})))};return o.createElement(g.default,{title:a},o.createElement("hr",null),t.state.loading?o.createElement(h.LoadingChart,null):t.state.error?o.createElement(h.EmptyChart,{title:i.formatMessage(f.default.error),icon:"close-big"}):t.state.queryResult&&0===t.state.queryResult.length?o.createElement(h.EmptyChart,{title:i.formatMessage(f.default.noData),icon:"warning"}):t.state.queryResult&&t.state.queryResult.length&&o.createElement(h.StackedBarPlot,{dataset:t.state.queryResult,options:u,height:c}))}}]),t}(o.Component);_([(0,p.lazyInject)(m.TYPES.IQueryService)],S.prototype,"_queryService",void 0),t.default=(0,u.compose)(l.default,d.injectIntl)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=y(n(47)),s=n(138),l=y(n(69)),c=n(8),u=n(6),d=y(n(275)),f=n(15),p=n(12),m=y(n(153)),g=n(11);function y(e){return e&&e.__esModule?e:{default:e}}var h=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.identifier=(0,i.default)(),n.formatData=function(e,t){return[{color:n.state.colors[1],key:"Male",value:e[0].count},{color:"#eaeaea",key:"Female",value:t[0].count}]},n.fetchData=function(e,t){n.setState({error:!1,loading:!0});var a=e.map((function(e){return n._queryService.getQuery(t,e)}));return Promise.all(a).then((function(e){return e.map((function(e){return e.data}))})).then((function(e){var a=e.map((function(e){return n._queryService.runOTQLQuery(t,e.query_text,{use_cache:!0})}));return Promise.all(a).then((function(e){return e.map((function(e){return e.data}))})).then((function(e){if(!(0,s.isAggregateResult)(e[0].rows)&&(0,s.isCountResult)(e[0].rows)&&!(0,s.isAggregateResult)(e[1].rows)&&(0,s.isCountResult)(e[1].rows))return n.setState({queryResult:n.formatData(e[0].rows,e[1].rows),loading:!1,totalNumber1:e[1].rows[0].count,totalNumber2:e[0].rows[0].count}),Promise.resolve();var t=new Error("wrong query type");return Promise.reject(t)}))})).catch((function(){n.setState({error:!0,loading:!1})}))},n.generateOptions=function(e,t){return{innerRadius:!0,isHalf:!1,text:t&&e?{value:e-t>0?(e/(e+t)*100).toFixed(2)+"% Female":(t/(e+t)*100).toFixed(2)+"% Male",text:""}:{},colors:n.state.colors,showTooltip:!0,height:300}};var a=e.colors,r=[a["mcs-warning"],a["mcs-info"],a["mcs-highlight"],a["mcs-success"],a["mcs-primary"],a["mcs-error"]];return n.state={error:!1,loading:!0,colors:r},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.queryIds,n=e.datamartId;this.fetchData(t,n)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.queryIds,a=t.datamartId,r=e.queryIds,o=e.datamartId;n===r&&a===o||this.fetchData(n,a)}},{key:"render",value:function(){var e=this,t=this.props,n=t.intl,a=t.height,r=this.state,i=r.totalNumber1,s=r.totalNumber2,l=this.generateOptions(i,s);return o.createElement(m.default,{title:this.props.title},e.state.loading?o.createElement(g.LoadingChart,null):e.state.error?o.createElement(g.EmptyChart,{title:n.formatMessage(d.default.error),icon:"close-big"}):e.state.queryResult&&0===e.state.queryResult.length||!e.state.queryResult?o.createElement(g.EmptyChart,{title:n.formatMessage(d.default.noData),icon:"warning"}):o.createElement(g.PiePlot,{dataset:e.state.queryResult,options:l,height:a}))}}]),t}(o.Component);h([(0,f.lazyInject)(p.TYPES.IQueryService)],v.prototype,"_queryService",void 0),t.default=(0,c.compose)(l.default,u.injectIntl)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(15),s=n(12),l=f(n(153)),c=f(n(2204)),u=n(138),d=n(2206);function f(e){return e&&e.__esModule?e:{default:e}}var p=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.formatData=function(e){return e.length&&e[0].aggregations.buckets.length&&e[0].aggregations.buckets[0].buckets.length?e[0].aggregations.buckets[0].buckets.map((function(e,t){var n=d.mapData2.find((function(t){return t.code===e.key}));return{code3:n?n.code3:"",name:"country name",value:e.count,code:e.key}})):[]},n.fetchData=function(e,t){return n.setState({error:!1}),n._queryService.getQuery(t,e).then((function(e){return e.data})).then((function(e){return n._queryService.runOTQLQuery(t,e.query_text,{use_cache:!0}).then((function(e){return e.data})).then((function(e){if((0,u.isAggregateResult)(e.rows)&&!(0,u.isCountResult)(e.rows))return n.setState({mapData:n.formatData(e.rows),loading:!1}),Promise.resolve();var t=new Error("wrong query type");return Promise.reject(t)}))})).catch((function(){n.setState({error:!1,loading:!1})}))},n.generateChart=function(){var e=n.state,t=e.loading,a=e.mapData,r=n.props.height;if(!t&&a)return o.createElement(c.default,{dataset:a,height:r})},n.state={error:!1,loading:!0,mapData:d.mapData2},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.queryId,n=e.datamartId;this.fetchData(t,n)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.queryId,a=t.datamartId,r=e.queryId,o=e.datamartId;n===r&&a===o||this.fetchData(n,a)}},{key:"render",value:function(){return o.createElement(l.default,{title:this.props.title},o.createElement("div",{style:{width:"100%"}},this.generateChart()))}}]),t}(o.Component);t.default=m,p([(0,i.lazyInject)(s.TYPES.IQueryService)],m.prototype,"_queryService",void 0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=d(n(0)),o=d(n(827)),i=n(6),s=n(8),l=d(n(47)),c=d(n(2205)),u=d(n(59));function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.generateMap=function(e){var t=n.props.height;o.default.createElement("link",{},void 0,document.getElementsByTagName("head")[0]),o.default.theme={colors:["#003056"],chart:{backgroundColor:"#ffffff",style:{fontFamily:"sans-serif",height:t},plotBorderColor:"#606063"},title:{style:{color:"#E0E0E3",textTransform:"uppercase",fontSize:"20px"}},subtitle:{style:{color:"#E0E0E3",textTransform:"uppercase"}},xAxis:{gridLineColor:"#707073",labels:{style:{color:"#E0E0E3"}},lineColor:"#707073",minorGridLineColor:"#505053",tickColor:"#707073",title:{style:{color:"#A0A0A3"}}},yAxis:{gridLineColor:"#707073",labels:{style:{color:"#E0E0E3"}},lineColor:"#707073",minorGridLineColor:"#505053",tickColor:"#707073",tickWidth:1,title:{style:{color:"#A0A0A3"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.85)",style:{color:"#F0F0F0"}},legend:{itemStyle:{color:"rgba(0, 0, 0, 0.65)"}}},o.default.setOptions(o.default.theme),o.default.mapChart(n.cuid,{chart:{map:"custom/world"},title:{text:""},colorAxis:{dataClasses:[{color:"rgba(0,48,86,0.05)",to:1e3},{color:"rgba(0,48,86,0.2)",from:1e3,to:5e3},{color:"rgba(0,48,86,0.4",from:5e3,to:1e4},{color:"rgba(0,48,86,0.5)",from:1e4,to:15e3},{color:"rgba(0,48,86,0.6)",from:15e3,to:2e4},{color:"rgba(0,48,86,0.8)",from:2e4,to:25e3},{color:"rgba(0,48,86,1)",from:25e3}]},mapNavigation:{enabled:!0,buttonOptions:{verticalAlign:"bottom"}},series:[{data:e,mapData:o.default.maps["custom/world"],joinBy:["iso-a3","code3"],name:"Population density",type:"map"}]})},n.cuid=(0,l.default)(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidCatch",value:function(){u.default.info(c.default)}},{key:"componentDidMount",value:function(){var e=this.props.dataset;this.generateMap(e)}},{key:"render",value:function(){return r.default.createElement("div",{id:this.cuid})}}]),t}(r.default.Component);t.default=(0,s.compose)(i.injectIntl)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(827),o=(a=r)&&a.__esModule?a:{default:a};t.default=o.default.maps["custom/world"]={title:"World, Miller projection, medium resolution",version:"1.1.2",type:"FeatureCollection",copyright:"Copyright (c) 2015 Highsoft AS, Based on data from Natural Earth",copyrightShort:"Natural Earth",copyrightUrl:"http://www.naturalearthdata.com",crs:{type:"name",properties:{name:"urn:ogc:def:crs:EPSG:54003"}},"hc-transform":{default:{crs:"+proj=mill +lat_0=0 +lon_0=0 +x_0=0 +y_0=0 +R_A +datum=WGS84 +units=m +no_defs",scale:172182781654e-16,jsonres:15.5,jsonmarginX:-999,jsonmarginY:9851,xoffset:-19495356.3693,yoffset:12635908.1982}},features:[{type:"Feature",id:"FO",properties:{"hc-group":"admin0","hc-middle-x":.48,"hc-middle-y":.54,"hc-key":"fo","hc-a2":"FO",name:"Faroe Islands",labelrank:"6","country-abbrev":"Faeroe Is.",subregion:"Northern Europe","region-wb":"Europe & Central Asia","iso-a3":"FRO","iso-a2":"FO","woe-id":"23424816",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[3991,8611],[4005,8598],[4004,8594],[3989,8605],[3991,8611]]]}},{type:"Feature",id:"UM",properties:{"hc-group":"admin0","hc-middle-x":.57,"hc-middle-y":.58,"hc-key":"um","hc-a2":"UM",name:"United States Minor Outlying Islands",labelrank:"5","country-abbrev":"U.S. MOI",subregion:"Seven seas (open ocean)","region-wb":"East Asia & Pacific","iso-a3":"UMI","iso-a2":"UM","woe-id":"28289407",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[-605,6652],[-606,6652],[-606,6652],[-606,6652],[-605,6652]]]}},{type:"Feature",id:"US",properties:{"hc-group":"admin0","hc-middle-x":.68,"hc-middle-y":.68,"hc-key":"us","hc-a2":"US",name:"United States of America",labelrank:"2","country-abbrev":"U.S.A.",subregion:"Northern America","region-wb":"North America","iso-a3":"USA","iso-a2":"US","woe-id":"23424977",continent:"North America"},geometry:{type:"MultiPolygon",coordinates:[[[[556,8034],[559,8032],[549,8036],[550,8040],[556,8034]]],[[[558,8043],[561,8042],[558,8039],[553,8040],[558,8043]]],[[[265,8289],[268,8289],[267,8283],[263,8288],[265,8289]]],[[[263,8300],[267,8295],[264,8292],[261,8294],[263,8300]]],[[[255,8300],[267,8279],[253,8290],[251,8302],[255,8300]]],[[[306,8298],[305,8293],[298,8293],[300,8304],[306,8298]]],[[[249,8306],[250,8302],[245,8301],[244,8305],[249,8306]]],[[[292,8310],[298,8305],[294,8298],[291,8308],[292,8310]]],[[[238,8311],[244,8313],[244,8308],[238,8304],[238,8311]]],[[[249,8311],[248,8310],[244,8314],[249,8314],[249,8311]]],[[[232,8330],[237,8337],[249,8340],[245,8335],[232,8330]]],[[[272,8342],[284,8338],[278,8330],[268,8336],[272,8342]]],[[[268,8353],[268,8346],[255,8348],[259,8353],[268,8353]]],[[[282,8349],[285,8339],[276,8346],[276,8355],[282,8349]]],[[[261,8368],[271,8358],[264,8355],[259,8356],[261,8368]]],[[[234,8379],[258,8373],[253,8353],[237,8353],[234,8379]]],[[[181,8386],[179,8377],[173,8376],[177,8383],[181,8386]]],[[[158,8420],[155,8412],[152,8416],[154,8423],[158,8420]]],[[[1578,8023],[1574,8018],[1559,8010],[1556,8013],[1578,8023]]],[[[1623,7918],[1621,7909],[1614,7899],[1610,7903],[1623,7918]]],[[[1667,7934],[1667,7928],[1663,7927],[1665,7933],[1667,7934]]],[[[1724,7944],[1726,7939],[1717,7939],[1721,7943],[1724,7944]]],[[[224,8331],[215,8369],[227,8371],[236,8359],[224,8331]]],[[[-726,8256],[-740,8233],[-777,8227],[-811,8206],[-792,8230],[-757,8230],[-757,8246],[-726,8256]]],[[[193,8378],[186,8400],[202,8387],[208,8341],[193,8378]]],[[[183,8412],[177,8392],[156,8412],[174,8431],[183,8412]]],[[[199,8431],[221,8424],[229,8389],[214,8393],[199,8431]]],[[[-826,8660],[-803,8657],[-834,8641],[-862,8661],[-896,8667],[-850,8675],[-826,8660]]],[[[553,8054],[551,8053],[551,8054],[553,8054]]],[[[1261,7281],[1260,7293],[1252,7296],[1228,7335],[1206,7373],[1202,7375],[1200,7378],[1167,7387],[1143,7358],[1102,7380],[1091,7409],[1043,7449],[993,7449],[993,7434],[908,7434],[797,7472],[799,7479],[728,7473],[722,7492],[686,7523],[648,7524],[624,7541],[571,7629],[568,7651],[532,7689],[528,7720],[512,7742],[522,7777],[507,7826],[520,7864],[527,7925],[507,8030],[563,8020],[563,8024],[573,8014],[562,8025],[562,8026],[566,8031],[562,8027],[561,8054],[1379,8054],[1455,8037],[1491,8018],[1546,8016],[1503,7997],[1471,7971],[1510,7975],[1520,7963],[1574,7988],[1575,7986],[1575,7988],[1591,7997],[1601,7995],[1583,7981],[1612,7961],[1683,7971],[1697,7959],[1708,7961],[1708,7954],[1689,7936],[1622,7938],[1592,7889],[1612,7898],[1595,7842],[1598,7806],[1614,7783],[1632,7792],[1645,7831],[1636,7855],[1644,7893],[1694,7935],[1726,7918],[1730,7880],[1715,7868],[1750,7865],[1758,7833],[1755,7820],[1751,7816],[1746,7820],[1739,7807],[1727,7787],[1756,7775],[1780,7780],[1855,7817],[1862,7830],[1858,7836],[1858,7842],[1927,7844],[1955,7886],[1970,7900],[1987,7905],[1987,7905],[2082,7905],[2118,7937],[2126,7968],[2149,7996],[2192,7982],[2192,7933],[2196,7927],[2203,7927],[2202,7914],[2210,7911],[2216,7898],[2179,7882],[2181,7881],[2174,7874],[2173,7879],[2173,7879],[2164,7875],[2168,7876],[2168,7870],[2163,7871],[2161,7874],[2155,7872],[2110,7843],[2108,7787],[2041,7770],[2006,7747],[2005,7718],[1959,7656],[1937,7700],[1941,7654],[1934,7620],[1948,7620],[1956,7577],[1933,7542],[1915,7545],[1890,7517],[1854,7495],[1795,7447],[1786,7414],[1814,7342],[1829,7289],[1819,7237],[1797,7235],[1766,7277],[1746,7323],[1752,7355],[1710,7394],[1682,7378],[1650,7401],[1567,7404],[1544,7395],[1558,7358],[1533,7373],[1514,7361],[1485,7382],[1464,7376],[1411,7380],[1340,7337],[1309,7290],[1321,7262],[1289,7265],[1261,7281]]],[[[247,8324],[243,8322],[239,8327],[247,8327],[248,8327],[252,8348],[288,8301],[287,8280],[261,8307],[246,8319],[247,8324]]],[[[-425,7092],[-433,7100],[-433,7100],[-426,7097],[-425,7092],[-425,7092],[-425,7092]]],[[[-425,7092],[-390,7060],[-422,7047],[-425,7092],[-425,7092],[-425,7092]]],[[[308,8292],[307,8287],[302,8290],[308,8292],[308,8292],[308,8292]]],[[[217,8430],[220,8427],[210,8429],[210,8433],[205,8435],[148,8429],[100,8466],[54,8486],[-34,8511],[-77,8513],[-132,8528],[-131,8544],[-185,8544],[-179,8506],[-229,8506],[-240,8492],[-304,8469],[-282,8489],[-303,8495],[-289,8538],[-261,8553],[-264,8566],[-317,8528],[-328,8503],[-369,8479],[-346,8459],[-377,8422],[-432,8396],[-465,8356],[-478,8363],[-510,8328],[-540,8328],[-589,8308],[-615,8286],[-687,8268],[-679,8288],[-643,8297],[-585,8332],[-551,8327],[-555,8346],[-513,8369],[-478,8400],[-458,8457],[-516,8437],[-555,8465],[-597,8443],[-595,8484],[-613,8511],[-651,8497],[-693,8522],[-709,8506],[-741,8500],[-765,8515],[-713,8520],[-680,8544],[-726,8574],[-715,8598],[-667,8655],[-644,8644],[-615,8663],[-568,8678],[-587,8710],[-579,8735],[-637,8709],[-728,8718],[-784,8772],[-702,8808],[-655,8816],[-653,8790],[-599,8787],[-594,8837],[-655,8842],[-667,8867],[-741,8904],[-729,8932],[-673,8934],[-637,8959],[-638,8973],[-601,9009],[-570,9009],[-534,9034],[-486,9036],[-450,9061],[-399,9052],[-370,9033],[-317,9037],[-306,9015],[-225,9020],[-162,9e3],[-87,8990],[-49,8997],[19,8972],[20,8520],[74,8510],[120,8473],[126,8458],[158,8488],[183,8497],[199,8475],[245,8436],[292,8359],[346,8330],[346,8304],[346,8304],[319,8284],[320,8322],[316,8323],[310,8332],[305,8326],[295,8329],[287,8349],[254,8380],[220,8428],[217,8430]]],[[[-373,8372],[-390,8391],[-344,8421],[-318,8446],[-311,8403],[-356,8377],[-413,8325],[-373,8372]]],[[[-433,7100],[-479,7115],[-446,7112],[-433,7100],[-433,7100]]],[[[308,8292],[309,8295],[309,8292],[308,8292],[308,8292],[308,8292]]]]}},{type:"Feature",id:"JP",properties:{"hc-group":"admin0","hc-middle-x":.52,"hc-middle-y":.66,"hc-key":"jp","hc-a2":"JP",name:"Japan",labelrank:"2","country-abbrev":"Japan",subregion:"Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"JPN","iso-a2":"JP","woe-id":"23424856",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[8389,7914],[8390,7917],[8398,7911],[8394,7909],[8389,7914]]],[[[8149,7526],[8129,7515],[8097,7520],[8140,7570],[8197,7578],[8232,7572],[8278,7641],[8269,7618],[8307,7629],[8314,7654],[8342,7662],[8359,7703],[8352,7721],[8369,7771],[8380,7756],[8400,7767],[8419,7706],[8391,7670],[8390,7636],[8375,7598],[8384,7580],[8357,7553],[8353,7573],[8306,7546],[8256,7542],[8267,7531],[8239,7508],[8212,7518],[8222,7544],[8172,7539],[8149,7527],[8166,7521],[8186,7539],[8200,7532],[8186,7497],[8173,7507],[8138,7480],[8130,7504],[8149,7526]]],[[[8044,7495],[8037,7525],[8057,7499],[8076,7517],[8113,7508],[8122,7487],[8101,7435],[8068,7431],[8067,7482],[8044,7495]]],[[[8380,7790],[8365,7775],[8355,7820],[8373,7846],[8401,7845],[8416,7924],[8472,7874],[8509,7860],[8522,7839],[8483,7831],[8455,7794],[8413,7818],[8367,7806],[8380,7790]]]]}},{type:"Feature",id:"SC",properties:{"hc-group":"admin0","hc-middle-x":.58,"hc-middle-y":.41,"hc-key":"sc","hc-a2":"SC",name:"Seychelles",labelrank:"6","country-abbrev":"Syc.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"SYC","iso-a2":"SC","woe-id":"23424941",continent:"Seven seas (open ocean)"},geometry:{type:"Polygon",coordinates:[[[5849,6344],[5852,6341],[5851,6337],[5843,6348],[5849,6344]]]}},{type:"Feature",id:"IN",properties:{"hc-group":"admin0","hc-middle-x":.34,"hc-middle-y":.43,"hc-key":"in","hc-a2":"IN",name:"India",labelrank:"2","country-abbrev":"India",subregion:"Southern Asia","region-wb":"South Asia","iso-a3":"IND","iso-a2":"IN","woe-id":"23424848",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[6818,7133],[6820,7134],[6820,7126],[6817,7128],[6818,7133]]],[[[6819,7322],[6840,7326],[6842,7305],[6869,7285],[6937,7293],[6923,7319],[6953,7324],[7012,7369],[7032,7360],[7057,7370],[7092,7333],[7074,7306],[7024,7278],[7023,7255],[6996,7195],[6973,7200],[6969,7150],[6951,7137],[6939,7192],[6922,7167],[6909,7188],[6949,7229],[6935,7237],[6886,7236],[6870,7262],[6829,7277],[6818,7260],[6843,7237],[6816,7220],[6837,7209],[6832,7189],[6847,7142],[6823,7124],[6820,7141],[6792,7124],[6767,7075],[6740,7073],[6699,7023],[6646,6986],[6647,6972],[6586,6945],[6580,6925],[6588,6875],[6574,6835],[6574,6783],[6504,6717],[6476,6742],[6454,6807],[6424,6859],[6410,6911],[6384,6956],[6360,7072],[6367,7093],[6351,7149],[6344,7113],[6310,7098],[6291,7105],[6258,7137],[6287,7155],[6241,7174],[6227,7195],[6247,7208],[6280,7205],[6313,7222],[6265,7289],[6295,7328],[6337,7325],[6368,7360],[6381,7388],[6416,7427],[6415,7446],[6438,7461],[6400,7495],[6393,7534],[6410,7548],[6453,7539],[6490,7559],[6513,7572],[6527,7544],[6546,7534],[6542,7507],[6563,7480],[6530,7473],[6541,7434],[6608,7397],[6589,7383],[6579,7353],[6660,7310],[6714,7305],[6751,7281],[6795,7274],[6820,7286],[6819,7322]]]]}},{type:"Feature",id:"FR",properties:{"hc-group":"admin0","hc-middle-x":.28,"hc-middle-y":.04,"hc-key":"fr","hc-a2":"FR",name:"France",labelrank:"2","country-abbrev":"Fr.",subregion:"Western Europe","region-wb":"Europe & Central Asia","iso-a3":"FRA","iso-a2":"FR","woe-id":"-90",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[2537,7972],[2531,7971],[2530,7983],[2533,7975],[2537,7972]]],[[[4485,7820],[4477,7774],[4465,7781],[4462,7817],[4485,7820]]],[[[9164,5848],[9155,5806],[9109,5833],[9082,5858],[9076,5879],[9141,5830],[9164,5848]]],[[[6256,4904],[6297,4899],[6285,4876],[6245,4876],[6256,4904]]],[[[2331,7017],[2334,7019],[2334,7016],[2331,7017]]],[[[4427,7861],[4426,7860],[4425,7859],[4424,7860],[4423,7858],[4385,7835],[4321,7852],[4294,7830],[4298,7812],[4279,7808],[4263,7812],[4262,7812],[4262,7812],[4255,7814],[4255,7818],[4246,7818],[4203,7821],[4151,7846],[4160,7853],[4173,7943],[4145,7980],[4120,7997],[4065,8019],[4064,8038],[4112,8049],[4124,8036],[4163,8041],[4147,8082],[4197,8065],[4210,8081],[4250,8101],[4251,8127],[4279,8135],[4327,8092],[4376,8075],[4381,8071],[4392,8072],[4447,8053],[4429,8001],[4386,7963],[4389,7952],[4391,7955],[4393,7956],[4405,7957],[4405,7947],[4412,7939],[4400,7909],[4427,7861]]],[[[2596,6636],[2603,6648],[2632,6639],[2670,6598],[2632,6543],[2583,6547],[2601,6581],[2587,6623],[2596,6636]]]]}},{type:"Feature",id:"FM",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.52,"hc-key":"fm","hc-a2":"FM",name:"Federated States of Micronesia",labelrank:"6","country-abbrev":"F.S.M.",subregion:"Micronesia","region-wb":"East Asia & Pacific","iso-a3":"FSM","iso-a2":"FM","woe-id":"23424815",continent:"Oceania"},geometry:{type:"Polygon",coordinates:[[[8899,6684],[8902,6683],[8902,6679],[8899,6679],[8899,6684]]]}},{type:"Feature",id:"CN",properties:{"hc-group":"admin0","hc-middle-x":.41,"hc-middle-y":.56,"hc-key":"cn","hc-a2":"CN",name:"China",labelrank:"2","country-abbrev":"China",subregion:"Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"CHN","iso-a2":"CN","woe-id":"23424781",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[7429,7050],[7456,7076],[7488,7081],[7498,7067],[7481,7036],[7459,7021],[7429,7031],[7429,7050]]],[[[6842,7305],[6840,7326],[6819,7322],[6773,7330],[6756,7323],[6729,7336],[6699,7367],[6683,7364],[6640,7401],[6608,7397],[6541,7434],[6530,7473],[6563,7480],[6542,7507],[6546,7534],[6527,7544],[6513,7572],[6500,7571],[6482,7577],[6459,7605],[6416,7624],[6411,7627],[6426,7631],[6423,7675],[6395,7677],[6389,7707],[6399,7728],[6446,7748],[6450,7736],[6482,7759],[6521,7763],[6529,7774],[6584,7803],[6602,7838],[6581,7906],[6646,7924],[6668,7986],[6719,7972],[6741,7981],[6750,8032],[6795,8058],[6801,8059],[6810,8061],[6814,8039],[6847,8016],[6885,8003],[6906,7963],[6901,7912],[6979,7903],[7034,7879],[7064,7822],[7220,7815],[7232,7803],[7282,7788],[7326,7787],[7372,7807],[7453,7813],[7526,7857],[7511,7885],[7528,7908],[7575,7895],[7603,7919],[7637,7921],[7664,7953],[7714,7968],[7756,7963],[7762,7975],[7722,8015],[7698,8015],[7696,8015],[7691,8008],[7642,8005],[7632,8021],[7667,8086],[7699,8074],[7742,8093],[7740,8107],[7768,8158],[7788,8176],[7766,8201],[7790,8222],[7862,8234],[7935,8210],[8005,8075],[8043,8071],[8086,8027],[8093,8004],[8135,8005],[8192,8031],[8204,8005],[8185,7988],[8178,7951],[8146,7907],[8138,7916],[8121,7913],[8090,7899],[8099,7870],[8091,7827],[8078,7815],[8057,7831],[8053,7812],[8004,7796],[8007,7774],[7962,7785],[7943,7758],[7895,7730],[7838,7706],[7799,7682],[7804,7705],[7833,7744],[7800,7758],[7778,7733],[7751,7722],[7736,7698],[7699,7695],[7708,7662],[7731,7662],[7749,7627],[7787,7651],[7812,7637],[7845,7637],[7787,7604],[7742,7557],[7773,7532],[7791,7478],[7819,7454],[7824,7420],[7794,7408],[7836,7385],[7812,7368],[7814,7337],[7794,7326],[7749,7262],[7758,7244],[7731,7235],[7661,7167],[7610,7163],[7593,7144],[7576,7170],[7574,7142],[7489,7118],[7466,7084],[7461,7122],[7422,7134],[7409,7122],[7366,7149],[7372,7161],[7329,7180],[7289,7154],[7245,7162],[7234,7150],[7217,7146],[7222,7111],[7206,7124],[7177,7120],[7170,7139],[7146,7143],[7157,7171],[7138,7175],[7130,7203],[7101,7195],[7103,7234],[7133,7260],[7132,7313],[7098,7343],[7092,7333],[7057,7370],[7032,7360],[7012,7369],[6953,7324],[6923,7319],[6882,7338],[6842,7305]]]]}},{type:"Feature",id:"PT",properties:{"hc-group":"admin0","hc-middle-x":.46,"hc-middle-y":.5,"hc-key":"pt","hc-a2":"PT",name:"Portugal",labelrank:"2","country-abbrev":"Port.",subregion:"Southern Europe","region-wb":"Europe & Central Asia","iso-a3":"PRT","iso-a2":"PT","woe-id":"23424925",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[3984,7629],[3937,7624],[3944,7663],[3922,7681],[3946,7754],[3944,7795],[4009,7795],[4020,7781],[3998,7762],[3997,7692],[3984,7629]]]}},{type:"Feature",id:"SW",properties:{"hc-group":"admin0","hc-middle-x":.86,"hc-middle-y":.57,"hc-key":"sw","hc-a2":"SW",name:"Serranilla Bank",labelrank:"5","country-abbrev":"S.B.",subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"-99","iso-a2":"SW","woe-id":"-99",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[1870,6950],[1870,6950],[1870,6950],[1870,6950]]]}},{type:"Feature",id:"SH",properties:{"hc-group":"admin0","hc-middle-x":.54,"hc-middle-y":.51,"hc-key":"sh","hc-a2":"SH",name:"Scarborough Reef",labelrank:"6","country-abbrev":"S.R.",subregion:"South-Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"-99","iso-a2":"SH","woe-id":"-99",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[7699,6929],[7698,6929],[7698,6929],[7698,6929],[7699,6929]]]}},{type:"Feature",id:"BR",properties:{"hc-group":"admin0","hc-middle-x":.54,"hc-middle-y":.34,"hc-key":"br","hc-a2":"BR",name:"Brazil",labelrank:"2","country-abbrev":"Brazil",subregion:"South America","region-wb":"Latin America & Caribbean","iso-a3":"BRA","iso-a2":"BR","woe-id":"23424768",continent:"South America"},geometry:{type:"MultiPolygon",coordinates:[[[[2729,6474],[2767,6471],[2755,6436],[2702,6426],[2696,6461],[2729,6474]]],[[[2615,5450],[2627,5475],[2626,5480],[2554,5539],[2542,5531],[2517,5563],[2494,5561],[2549,5623],[2606,5658],[2604,5706],[2584,5708],[2584,5709],[2583,5712],[2594,5736],[2594,5755],[2559,5759],[2553,5800],[2530,5817],[2483,5817],[2488,5852],[2478,5876],[2496,5937],[2471,5965],[2469,5993],[2419,5995],[2409,6069],[2369,6077],[2332,6104],[2293,6110],[2263,6149],[2262,6192],[2226,6186],[2177,6154],[2139,6155],[2108,6153],[2111,6200],[2091,6185],[2061,6183],[2007,6256],[2034,6290],[2040,6327],[2103,6356],[2128,6354],[2143,6437],[2125,6474],[2131,6529],[2181,6529],[2206,6540],[2219,6515],[2258,6498],[2301,6525],[2324,6550],[2303,6552],[2286,6596],[2377,6604],[2401,6632],[2424,6629],[2437,6595],[2423,6558],[2431,6534],[2459,6514],[2509,6538],[2528,6536],[2543,6553],[2583,6547],[2632,6543],[2670,6598],[2688,6593],[2700,6543],[2723,6528],[2725,6479],[2679,6465],[2701,6426],[2743,6421],[2788,6463],[2869,6439],[2879,6399],[2908,6412],[2969,6393],[3017,6395],[3062,6370],[3101,6334],[3149,6327],[3171,6267],[3156,6207],[3109,6160],[3075,6104],[3048,6086],[3051,6007],[3043,5952],[3028,5936],[3026,5900],[2985,5834],[2988,5821],[2956,5790],[2888,5790],[2811,5749],[2785,5728],[2761,5693],[2767,5650],[2757,5614],[2726,5585],[2711,5552],[2684,5560],[2677,5531],[2654,5510],[2642,5465],[2620,5444],[2615,5447],[2615,5450]]]]}},{type:"Feature",id:"KI",properties:{"hc-group":"admin0","hc-middle-x":.28,"hc-middle-y":.65,"hc-key":"ki","hc-a2":"KI",name:"Kiribati",labelrank:"6","country-abbrev":"Kir.",subregion:"Micronesia","region-wb":"East Asia & Pacific","iso-a3":"KIR","iso-a2":"KI","woe-id":"23424867",continent:"Oceania"},geometry:{type:"Polygon",coordinates:[[[-468,6538],[-465,6533],[-460,6529],[-467,6531],[-468,6538]]]}},{type:"Feature",id:"PH",properties:{"hc-group":"admin0","hc-middle-x":.4,"hc-middle-y":.19,"hc-key":"ph","hc-a2":"PH",name:"Philippines",labelrank:"2","country-abbrev":"Phil.",subregion:"South-Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"PHL","iso-a2":"PH","woe-id":"23424934",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[7894,6825],[7915,6827],[7892,6850],[7919,6851],[7934,6808],[7915,6812],[7907,6784],[7894,6825]]],[[[7758,6817],[7762,6844],[7775,6837],[7758,6817],[7758,6817]]],[[[7753,6809],[7752,6810],[7758,6817],[7758,6817],[7758,6816],[7753,6809],[7753,6809]]],[[[7823,6787],[7825,6841],[7859,6818],[7853,6800],[7886,6812],[7884,6786],[7855,6746],[7836,6770],[7842,6795],[7823,6787]]],[[[7891,6697],[7867,6709],[7840,6706],[7823,6668],[7827,6707],[7866,6736],[7880,6720],[7907,6747],[7929,6745],[7929,6776],[7953,6740],[7962,6694],[7951,6678],[7937,6696],[7925,6676],[7925,6643],[7891,6661],[7891,6697]]],[[[7896,6884],[7885,6826],[7867,6840],[7859,6878],[7840,6893],[7842,6869],[7816,6893],[7801,6877],[7817,6862],[7802,6841],[7776,6880],[7796,6881],[7767,6918],[7760,6966],[7777,6959],[7775,7002],[7801,7048],[7798,7035],[7834,7023],[7840,6987],[7831,6962],[7812,6952],[7817,6900],[7839,6905],[7896,6884]]],[[[7753,6809],[7757,6790],[7686,6729],[7752,6809],[7753,6809]]]]}},{type:"Feature",id:"MX",properties:{"hc-group":"admin0","hc-middle-x":.51,"hc-middle-y":.49,"hc-key":"mx","hc-a2":"MX",name:"Mexico",labelrank:"2","country-abbrev":"Mex.",subregion:"Central America","region-wb":"Latin America & Caribbean","iso-a3":"MEX","iso-a2":"MX","woe-id":"23424900",continent:"North America"},geometry:{type:"MultiPolygon",coordinates:[[[[1630,7094],[1622,7084],[1622,7088],[1624,7093],[1630,7094]]],[[[1038,7129],[1042,7127],[1052,7116],[1044,7121],[1038,7129]]],[[[881,7216],[885,7216],[889,7212],[889,7210],[881,7216]]],[[[875,7231],[874,7226],[871,7225],[874,7232],[875,7231]]],[[[786,7330],[784,7328],[781,7330],[786,7338],[786,7330]]],[[[696,7356],[694,7355],[692,7363],[695,7361],[696,7356]]],[[[864,7349],[866,7364],[874,7359],[871,7350],[864,7349]]],[[[836,7376],[845,7368],[847,7358],[833,7372],[836,7376]]],[[[1200,7378],[1199,7374],[1206,7373],[1228,7335],[1252,7296],[1259,7288],[1261,7281],[1289,7265],[1321,7262],[1306,7216],[1300,7155],[1321,7096],[1361,7038],[1401,7020],[1478,7034],[1505,7051],[1523,7108],[1589,7126],[1630,7115],[1609,7083],[1597,7023],[1583,7030],[1567,7012],[1558,7009],[1504,7009],[1491,6992],[1522,6966],[1482,6956],[1466,6911],[1417,6957],[1389,6967],[1339,6944],[1273,6971],[1205,6993],[1183,7012],[1133,7025],[1088,7056],[1067,7089],[1083,7121],[1064,7158],[989,7239],[956,7256],[956,7286],[923,7307],[876,7358],[847,7417],[849,7428],[804,7448],[801,7397],[832,7368],[924,7228],[922,7208],[946,7205],[956,7176],[943,7165],[930,7186],[876,7228],[873,7264],[834,7285],[790,7321],[816,7325],[820,7341],[771,7383],[760,7417],[728,7473],[799,7479],[797,7472],[908,7434],[993,7434],[993,7449],[1043,7449],[1091,7409],[1102,7380],[1143,7358],[1167,7387],[1200,7378]],[[1309,7246],[1303,7231],[1306,7218],[1313,7245],[1309,7246]]]]}},{type:"Feature",id:"ES",properties:{"hc-group":"admin0","hc-middle-x":.76,"hc-middle-y":.27,"hc-key":"es","hc-a2":"ES",name:"Spain",labelrank:"2","country-abbrev":"Sp.",subregion:"Southern Europe","region-wb":"Europe & Central Asia","iso-a3":"ESP","iso-a2":"ES","woe-id":"23424950",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[3748,7322],[3716,7331],[3697,7330],[3726,7345],[3748,7322]]],[[[4117,7566],[4118,7565],[4117,7564],[4116,7566],[4117,7566]]],[[[4044,7586],[4046,7586],[4045,7584],[4044,7585],[4044,7586]]],[[[4045,7594],[4021,7599],[4011,7621],[3984,7629],[3997,7692],[3998,7762],[4020,7781],[4009,7795],[3944,7795],[3930,7838],[3969,7860],[3988,7852],[4098,7851],[4151,7846],[4203,7821],[4246,7818],[4249,7812],[4255,7814],[4262,7812],[4262,7813],[4262,7814],[4263,7812],[4263,7812],[4279,7808],[4298,7812],[4300,7795],[4265,7771],[4233,7763],[4194,7709],[4211,7683],[4189,7669],[4183,7644],[4154,7635],[4143,7615],[4072,7613],[4046,7594],[4045,7594]]]]}},{type:"Feature",id:"BU",properties:{"hc-group":"admin0","hc-middle-x":.49,"hc-middle-y":.73,"hc-key":"bu","hc-a2":"BU",name:"Bajo Nuevo Bank (Petrel Is.)",labelrank:"8","country-abbrev":null,subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"-99","iso-a2":"BU","woe-id":"-99",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[1830,6948],[1830,6948],[1830,6948],[1830,6948],[1830,6948]]]}},{type:"Feature",id:"MV",properties:{"hc-group":"admin0","hc-middle-x":.57,"hc-middle-y":.53,"hc-key":"mv","hc-a2":"MV",name:"Maldives",labelrank:"5","country-abbrev":"Mald.",subregion:"Southern Asia","region-wb":"South Asia","iso-a3":"MDV","iso-a2":"MV","woe-id":"23424899",continent:"Seven seas (open ocean)"},geometry:{type:"Polygon",coordinates:[[[6382,6647],[6390,6636],[6380,6637],[6384,6642],[6382,6647]]]}},{type:"Feature",id:"SP",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.5,"hc-key":"sp","hc-a2":"SP",name:"Spratly Islands",labelrank:"6","country-abbrev":"Spratly Is.",subregion:"South-Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"SPI","iso-a2":"SP","woe-id":"23424921",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[7642,6799],[7641,6799],[7641,6799],[7642,6799],[7642,6799]]]}},{type:"Feature",id:"GB",properties:{"hc-group":"admin0","hc-middle-x":.69,"hc-middle-y":.09,"hc-key":"gb","hc-a2":"GB",name:"United Kingdom",labelrank:"2","country-abbrev":"U.K.",subregion:"Northern Europe","region-wb":"Europe & Central Asia","iso-a3":"GBR","iso-a2":"GB","woe-id":"-90",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[4108,8458],[4110,8454],[4106,8453],[4102,8457],[4108,8458]]],[[[4112,8469],[4111,8462],[4116,8461],[4104,8463],[4112,8469]]],[[[4118,8472],[4113,8477],[4125,8471],[4121,8468],[4118,8472]]],[[[4173,8521],[4166,8500],[4165,8515],[4155,8520],[4173,8521]]],[[[4176,8534],[4182,8533],[4169,8530],[4171,8539],[4176,8534]]],[[[4181,8542],[4179,8536],[4175,8537],[4176,8542],[4181,8542]]],[[[1789,7055],[1792,7057],[1798,7055],[1792,7054],[1789,7055]]],[[[2080,7131],[2072,7131],[2072,7133],[2077,7133],[2080,7131]]],[[[2065,7134],[2063,7131],[2058,7131],[2062,7132],[2065,7134]]],[[[3994,8404],[3993,8427],[4018,8441],[4015,8421],[3994,8404]]],[[[2433,4774],[2454,4816],[2486,4811],[2491,4798],[2433,4774]]],[[[5210,7554],[5209,7553],[5207,7555],[5206,7555],[5206,7555],[5206,7554],[5204,7554],[5204,7555],[5205,7555],[5203,7556],[5206,7556],[5210,7558],[5210,7557],[5207,7557],[5210,7554]],[[5205,7555],[5206,7556],[5205,7556],[5205,7555]]],[[[4046,7594],[4045,7593],[4045,7594],[4046,7594]]],[[[5184,7543],[5181,7544],[5176,7544],[5178,7545],[5184,7543]]],[[[3989,8295],[4018,8305],[4040,8278],[4018,8256],[3987,8256],[3961,8270],[3989,8295]]],[[[4024,8390],[4056,8446],[4114,8447],[4083,8416],[4100,8407],[4147,8405],[4152,8396],[4110,8337],[4156,8317],[4168,8277],[4202,8256],[4214,8215],[4204,8207],[4254,8201],[4251,8174],[4225,8151],[4244,8137],[4212,8122],[4102,8117],[4043,8100],[4081,8140],[4113,8140],[4074,8163],[4046,8166],[4079,8182],[4080,8220],[4109,8227],[4119,8259],[4096,8272],[4103,8288],[4073,8289],[4075,8268],[4052,8286],[4067,8313],[4036,8351],[4008,8361],[4032,8367],[4003,8396],[4024,8390]]]]}},{type:"Feature",id:"GR",properties:{"hc-group":"admin0","hc-middle-x":.3,"hc-middle-y":.43,"hc-key":"gr","hc-a2":"GR",name:"Greece",labelrank:"3","country-abbrev":"Greece",subregion:"Southern Europe","region-wb":"Europe & Central Asia","iso-a3":"GRC","iso-a2":"GR","woe-id":"23424833",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[4984,7560],[4938,7553],[4902,7565],[4922,7573],[4984,7560]]],[[[5023,7596],[5041,7604],[5037,7593],[5028,7585],[5023,7596]]],[[[5011,7610],[5003,7612],[5010,7619],[5009,7615],[5011,7610]]],[[[5002,7626],[5006,7623],[5003,7621],[5004,7624],[5002,7626]]],[[[4952,7622],[4962,7630],[4963,7623],[4957,7611],[4952,7622]]],[[[4985,7644],[4977,7640],[4975,7641],[4978,7645],[4985,7644]]],[[[5004,7649],[5007,7647],[4999,7645],[4993,7649],[5004,7649]]],[[[4978,7677],[4980,7667],[4975,7669],[4971,7677],[4978,7677]]],[[[4959,7727],[4953,7726],[4959,7743],[4966,7743],[4959,7727]]],[[[4828,7750],[4831,7753],[4828,7750],[4826,7753],[4826,7754],[4828,7756],[4831,7756],[4854,7765],[4884,7773],[4931,7781],[4953,7770],[4985,7786],[4994,7775],[4977,7752],[4947,7761],[4907,7750],[4928,7732],[4876,7743],[4874,7728],[4958,7637],[4915,7667],[4918,7646],[4893,7656],[4878,7642],[4892,7604],[4853,7613],[4838,7665],[4798,7715],[4809,7720],[4828,7750]]],[[[4989,7700],[4994,7693],[4988,7690],[4971,7698],[4986,7702],[4988,7702],[4989,7700]]]]}},{type:"Feature",id:"AS",properties:{"hc-group":"admin0","hc-middle-x":.56,"hc-middle-y":.57,"hc-key":"as","hc-a2":"AS",name:"American Samoa",labelrank:"4","country-abbrev":"Am. Samoa",subregion:"Polynesia","region-wb":"East Asia & Pacific","iso-a3":"ASM","iso-a2":"AS","woe-id":"23424746",continent:"Oceania"},geometry:{type:"Polygon",coordinates:[[[-859,6056],[-861,6055],[-863,6052],[-866,6054],[-859,6056]]]}},{type:"Feature",id:"DK",properties:{"hc-group":"admin0","hc-middle-x":.35,"hc-middle-y":.49,"hc-key":"dk","hc-a2":"DK",name:"Denmark",labelrank:"4","country-abbrev":"Den.",subregion:"Northern Europe","region-wb":"Europe & Central Asia","iso-a3":"DNK","iso-a2":"DK","woe-id":"23424796",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[4538,8291],[4553,8278],[4544,8277],[4531,8283],[4538,8291]]],[[[4511,8288],[4516,8286],[4512,8286],[4506,8292],[4511,8288]]],[[[4576,8293],[4566,8288],[4565,8292],[4570,8294],[4576,8293]]],[[[4495,8296],[4502,8291],[4500,8287],[4494,8289],[4495,8296]]],[[[4526,8290],[4523,8282],[4520,8286],[4529,8299],[4526,8290]]],[[[4578,8322],[4559,8280],[4533,8320],[4567,8339],[4578,8322]]],[[[4484,8285],[4466,8289],[4461,8288],[4445,8357],[4495,8381],[4519,8408],[4509,8372],[4529,8353],[4516,8338],[4525,8302],[4488,8310],[4484,8285]]]]}},{type:"Feature",id:"GL",properties:{"hc-group":"admin0","hc-middle-x":.55,"hc-middle-y":.43,"hc-key":"gl","hc-a2":"GL",name:"Greenland",labelrank:"3","country-abbrev":"Grlnd.",subregion:"Northern America","region-wb":"Europe & Central Asia","iso-a3":"GRL","iso-a2":"GL","woe-id":"23424828",continent:"North America"},geometry:{type:"MultiPolygon",coordinates:[[[[2633,8910],[2635,8908],[2628,8905],[2624,8909],[2633,8910]]],[[[2656,8923],[2628,8916],[2630,8920],[2642,8923],[2656,8923]]],[[[2582,9011],[2574,9011],[2571,9017],[2578,9015],[2582,9011]]],[[[2616,9047],[2602,9051],[2613,9062],[2620,9051],[2616,9047]]],[[[2570,9117],[2557,9108],[2553,9113],[2571,9121],[2570,9117]]],[[[2552,9143],[2545,9137],[2535,9139],[2543,9143],[2552,9143]]],[[[2572,9145],[2556,9131],[2554,9142],[2564,9145],[2572,9145]]],[[[2544,9188],[2558,9180],[2554,9179],[2539,9188],[2544,9188]]],[[[2534,9206],[2543,9205],[2524,9203],[2524,9209],[2534,9206]]],[[[2528,9242],[2510,9242],[2496,9242],[2521,9246],[2528,9242]]],[[[2139,9366],[2126,9367],[2127,9369],[2140,9370],[2139,9366]]],[[[2061,9422],[2086,9417],[2076,9414],[2052,9419],[2061,9422]]],[[[2100,9424],[2119,9418],[2095,9418],[2088,9423],[2100,9424]]],[[[3690,9588],[3655,9569],[3628,9580],[3678,9596],[3690,9588]]],[[[2218,9636],[2228,9632],[2222,9631],[2218,9632],[2218,9636]]],[[[2683,9729],[2658,9730],[2626,9738],[2637,9753],[2683,9729]]],[[[2610,8952],[2619,8961],[2572,8975],[2577,9002],[2623,9002],[2661,8980],[2657,8963],[2610,8952]]],[[[2631,8765],[2626,8765],[2626,8768],[2627,8768],[2624,8771],[2612,8811],[2652,8832],[2603,8840],[2627,8897],[2686,8916],[2696,8975],[2677,8989],[2606,9011],[2584,9029],[2647,9028],[2701,9008],[2677,9040],[2647,9058],[2641,9054],[2628,9056],[2632,9066],[2636,9065],[2631,9068],[2667,9078],[2637,9080],[2624,9074],[2617,9080],[2629,9081],[2633,9081],[2599,9084],[2603,9068],[2563,9065],[2545,9082],[2553,9091],[2548,9094],[2555,9096],[2557,9095],[2575,9114],[2584,9146],[2568,9153],[2570,9153],[2556,9159],[2555,9158],[2552,9159],[2564,9178],[2541,9192],[2552,9207],[2530,9217],[2538,9235],[2510,9267],[2478,9276],[2463,9295],[2469,9316],[2398,9342],[2320,9355],[2304,9341],[2239,9349],[2231,9329],[2173,9337],[2137,9356],[2186,9374],[2115,9382],[2087,9394],[2100,9406],[2175,9418],[2222,9417],[2237,9433],[2150,9423],[2141,9438],[2088,9443],[2041,9468],[2050,9491],[2146,9510],[2185,9528],[2246,9530],[2279,9557],[2274,9591],[2214,9594],[2202,9613],[2271,9643],[2281,9658],[2335,9675],[2378,9663],[2400,9695],[2380,9712],[2465,9738],[2588,9757],[2615,9738],[2608,9698],[2633,9733],[2679,9723],[2736,9726],[2703,9741],[2687,9767],[2750,9763],[2839,9733],[2864,9715],[2891,9719],[2870,9733],[2876,9737],[2813,9756],[2770,9788],[2788,9777],[2829,9779],[2885,9759],[2877,9738],[2906,9760],[2846,9787],[2988,9787],[2850,9794],[2814,9801],[2838,9810],[2865,9802],[2879,9816],[2954,9821],[3022,9818],[3052,9816],[3056,9835],[3114,9844],[3240,9851],[3294,9849],[3443,9826],[3430,9819],[3292,9814],[3167,9796],[3259,9803],[3311,9813],[3391,9808],[3456,9816],[3478,9796],[3532,9789],[3571,9776],[3538,9755],[3318,9740],[3231,9719],[3264,9718],[3380,9734],[3473,9729],[3471,9714],[3423,9702],[3421,9689],[3499,9712],[3516,9732],[3569,9736],[3573,9695],[3518,9653],[3552,9660],[3651,9717],[3698,9699],[3735,9718],[3791,9716],[3847,9704],[3866,9691],[3808,9660],[3772,9658],[3780,9644],[3746,9634],[3698,9635],[3735,9618],[3716,9605],[3647,9598],[3600,9582],[3634,9570],[3623,9548],[3641,9533],[3613,9524],[3628,9503],[3597,9514],[3572,9475],[3569,9450],[3634,9453],[3630,9441],[3674,9435],[3630,9427],[3586,9435],[3597,9418],[3660,9407],[3648,9365],[3653,9329],[3637,9361],[3647,9379],[3595,9391],[3559,9373],[3560,9348],[3612,9348],[3630,9296],[3689,9274],[3657,9271],[3629,9229],[3573,9218],[3594,9181],[3565,9184],[3542,9170],[3492,9190],[3428,9169],[3444,9165],[3441,9166],[3478,9180],[3514,9160],[3554,9151],[3554,9138],[3524,9143],[3553,9127],[3532,9126],[3545,9106],[3481,9133],[3477,9146],[3501,9146],[3476,9150],[3457,9159],[3441,9150],[3476,9123],[3536,9094],[3520,9084],[3557,9059],[3567,9020],[3511,9014],[3484,9049],[3437,9076],[3445,9055],[3375,9038],[3366,9011],[3394,9014],[3371,9014],[3383,9030],[3452,9049],[3453,9026],[3427,9015],[3407,9015],[3376,8996],[3394,8990],[3453,9013],[3505,8997],[3540,8997],[3514,8972],[3489,8966],[3424,8922],[3372,8915],[3332,8897],[3254,8889],[3215,8864],[3216,8851],[3176,8805],[3124,8778],[3080,8766],[3076,8798],[3061,8771],[3013,8760],[3032,8753],[3009,8738],[2992,8708],[3002,8677],[2953,8623],[2939,8546],[2915,8528],[2921,8504],[2888,8501],[2857,8515],[2855,8534],[2781,8544],[2749,8569],[2741,8603],[2711,8619],[2716,8640],[2679,8665],[2683,8709],[2658,8696],[2660,8737],[2631,8765]]]]}},{type:"Feature",id:"GU",properties:{"hc-group":"admin0","hc-middle-x":.45,"hc-middle-y":.44,"hc-key":"gu","hc-a2":"GU",name:"Guam",labelrank:"6","country-abbrev":"Guam",subregion:"Micronesia","region-wb":"East Asia & Pacific","iso-a3":"GUM","iso-a2":"GU","woe-id":"23424832",continent:"Oceania"},geometry:{type:"Polygon",coordinates:[[[8501,6877],[8498,6871],[8496,6877],[8503,6884],[8501,6877]]]}},{type:"Feature",id:"MP",properties:{"hc-group":"admin0","hc-middle-x":.45,"hc-middle-y":.49,"hc-key":"mp","hc-a2":"MP",name:"Northern Mariana Islands",labelrank:"6","country-abbrev":"N.M.I.",subregion:"Micronesia","region-wb":"East Asia & Pacific","iso-a3":"MNP","iso-a2":"MP","woe-id":"23424788",continent:"Oceania"},geometry:{type:"Polygon",coordinates:[[[8526,6925],[8528,6930],[8531,6932],[8529,6927],[8526,6925]]]}},{type:"Feature",id:"PR",properties:{"hc-group":"admin0","hc-middle-x":.48,"hc-middle-y":.65,"hc-key":"pr","hc-a2":"PR",name:"Puerto Rico",labelrank:"5","country-abbrev":"P.R.",subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"PRI","iso-a2":"PR","woe-id":"23424935",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[2267,7024],[2239,7013],[2212,7014],[2213,7031],[2267,7024]]]}},{type:"Feature",id:"VI",properties:{"hc-group":"admin0","hc-middle-x":.48,"hc-middle-y":.19,"hc-key":"vi","hc-a2":"VI",name:"United States Virgin Islands",labelrank:"6","country-abbrev":"V.I. (U.S.)",subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"VIR","iso-a2":"VI","woe-id":"23424985",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[2283,7008],[2288,7008],[2278,7005],[2279,7008],[2283,7008]]]}},{type:"Feature",id:"CA",properties:{"hc-group":"admin0","hc-middle-x":.29,"hc-middle-y":.64,"hc-key":"ca","hc-a2":"CA",name:"Canada",labelrank:"2","country-abbrev":"Can.",subregion:"Northern America","region-wb":"North America","iso-a3":"CAN","iso-a2":"CA","woe-id":"23424775",continent:"North America"},geometry:{type:"MultiPolygon",coordinates:[[[[1713,9425],[1665,9428],[1680,9462],[1643,9470],[1608,9466],[1608,9487],[1634,9510],[1674,9517],[1735,9510],[1777,9514],[1703,9520],[1681,9564],[1638,9573],[1639,9612],[1717,9607],[1765,9581],[1781,9562],[1787,9587],[1735,9612],[1889,9631],[1831,9632],[1931,9652],[1841,9647],[1743,9627],[1715,9642],[1699,9625],[1630,9631],[1649,9658],[1614,9633],[1551,9650],[1631,9659],[1637,9668],[1538,9660],[1523,9671],[1581,9700],[1519,9685],[1545,9704],[1475,9704],[1503,9719],[1590,9738],[1689,9729],[1630,9740],[1671,9751],[1659,9764],[1742,9752],[1829,9728],[1749,9758],[1768,9779],[1812,9771],[1783,9788],[1833,9786],[1825,9799],[1915,9793],[1945,9807],[2002,9803],[2013,9793],[2038,9809],[2136,9812],[2138,9803],[2235,9795],[2168,9776],[2203,9778],[2284,9797],[2337,9767],[2377,9766],[2384,9744],[2294,9710],[2264,9713],[2226,9694],[2125,9670],[2289,9698],[2178,9642],[2107,9600],[2083,9572],[2026,9575],[2032,9559],[1951,9546],[1907,9553],[1909,9541],[1994,9538],[1993,9525],[1945,9531],[1892,9527],[1955,9522],[1989,9509],[1984,9496],[1934,9493],[1975,9482],[1961,9465],[1901,9446],[1881,9418],[1807,9415],[1859,9401],[1848,9390],[1892,9392],[1896,9373],[1852,9352],[1863,9324],[1837,9325],[1849,9351],[1798,9340],[1807,9358],[1714,9361],[1699,9351],[1610,9360],[1531,9362],[1516,9376],[1584,9403],[1602,9416],[1587,9445],[1616,9451],[1653,9439],[1658,9421],[1713,9425]],[[1713,9425],[1714,9425],[1714,9425],[1714,9425],[1714,9425],[1714,9425],[1729,9427],[1747,9459],[1714,9425],[1714,9425],[1714,9425],[1714,9425],[1713,9425]]],[[[1858,7836],[1858,7833],[1862,7830],[1790,7820],[1752,7798],[1739,7807],[1758,7809],[1751,7816],[1755,7820],[1758,7833],[1778,7845],[1791,7914],[1827,7886],[1838,7897],[1808,7939],[1708,7954],[1708,7961],[1697,7959],[1686,8013],[1656,8016],[1639,8046],[1591,8054],[1546,8016],[1491,8018],[1455,8037],[1379,8054],[561,8054],[555,8058],[553,8054],[551,8054],[545,8069],[502,8091],[506,8102],[499,8104],[501,8103],[504,8100],[499,8097],[497,8104],[488,8106],[489,8108],[486,8110],[485,8107],[476,8108],[474,8109],[464,8111],[472,8108],[471,8108],[468,8109],[472,8107],[474,8108],[480,8106],[485,8099],[485,8098],[490,8093],[490,8093],[508,8069],[539,8044],[537,8052],[544,8047],[553,8046],[540,8044],[545,8040],[537,8028],[504,8038],[448,8070],[445,8079],[446,8079],[443,8087],[443,8087],[442,8091],[411,8096],[393,8123],[409,8127],[448,8116],[450,8117],[447,8118],[456,8118],[459,8122],[456,8125],[447,8118],[412,8138],[406,8174],[401,8161],[398,8166],[401,8173],[406,8174],[406,8175],[407,8175],[409,8178],[406,8178],[405,8179],[408,8179],[407,8183],[405,8181],[402,8201],[387,8216],[379,8197],[370,8211],[371,8215],[366,8216],[366,8220],[371,8223],[371,8217],[373,8223],[384,8218],[380,8222],[387,8253],[374,8237],[381,8240],[379,8235],[373,8232],[372,8234],[366,8227],[332,8264],[346,8293],[346,8304],[346,8330],[292,8359],[245,8436],[199,8475],[183,8497],[158,8488],[126,8458],[120,8473],[74,8510],[20,8520],[19,8972],[75,8965],[132,8936],[172,8933],[173,8954],[234,8964],[250,8959],[335,9e3],[361,8992],[287,8966],[261,8941],[310,8969],[318,8952],[336,8974],[431,9004],[446,8976],[481,8955],[509,8996],[512,8957],[549,8964],[555,8982],[600,8978],[635,8959],[701,8939],[762,8928],[763,8938],[815,8916],[820,8899],[792,8901],[776,8883],[825,8871],[894,8872],[929,8885],[965,8875],[975,8854],[999,8850],[1012,8813],[1023,8842],[999,8872],[1069,8919],[1010,8895],[975,8901],[991,8919],[1064,8932],[1078,8905],[1103,8888],[1137,8887],[1191,8870],[1215,8879],[1285,8876],[1309,8866],[1275,8905],[1318,8911],[1331,8888],[1358,8902],[1341,8860],[1375,8831],[1371,8890],[1389,8888],[1427,8930],[1396,8925],[1405,8962],[1349,8984],[1339,9009],[1342,9061],[1378,9097],[1396,9099],[1380,9098],[1381,9125],[1363,9145],[1363,9192],[1377,9214],[1424,9223],[1466,9213],[1527,9207],[1478,9147],[1462,9139],[1410,9143],[1430,9125],[1411,9101],[1398,9100],[1438,9070],[1443,9037],[1487,8999],[1448,8975],[1480,8964],[1520,8932],[1525,8899],[1543,8940],[1565,8950],[1594,8924],[1580,8901],[1607,8842],[1655,8889],[1662,8924],[1690,8940],[1667,8953],[1666,8979],[1701,8983],[1715,8980],[1715,8982],[1725,8979],[1723,8978],[1752,8972],[1790,8948],[1776,8934],[1792,8919],[1751,8910],[1793,8859],[1785,8836],[1730,8804],[1700,8835],[1720,8796],[1674,8800],[1668,8815],[1628,8808],[1656,8794],[1611,8754],[1595,8754],[1542,8784],[1562,8753],[1621,8749],[1593,8699],[1561,8687],[1534,8698],[1528,8674],[1504,8670],[1505,8669],[1514,8666],[1512,8664],[1511,8666],[1505,8669],[1514,8645],[1453,8618],[1404,8545],[1390,8504],[1401,8450],[1439,8451],[1460,8395],[1454,8374],[1503,8387],[1566,8370],[1605,8336],[1693,8303],[1761,8295],[1767,8244],[1762,8210],[1837,8137],[1874,8185],[1860,8212],[1855,8257],[1837,8278],[1896,8304],[1928,8336],[1934,8367],[1917,8417],[1872,8446],[1910,8497],[1884,8545],[1903,8573],[1885,8610],[1905,8624],[1985,8603],[2018,8619],[2077,8581],[2073,8567],[2145,8542],[2132,8530],[2143,8458],[2163,8459],[2196,8424],[2251,8456],[2259,8494],[2279,8522],[2293,8517],[2299,8495],[2302,8500],[2305,8496],[2301,8493],[2299,8495],[2303,8480],[2323,8475],[2336,8445],[2383,8381],[2366,8360],[2429,8297],[2504,8272],[2482,8261],[2509,8241],[2548,8229],[2554,8180],[2513,8148],[2465,8139],[2429,8106],[2372,8097],[2354,8104],[2232,8103],[2205,8067],[2155,8046],[2129,8008],[2086,7969],[2038,7949],[1987,7905],[1970,7900],[1955,7886],[1860,7863],[1837,7844],[1858,7842],[1858,7838],[1858,7836]],[[456,8113],[455,8114],[454,8114],[456,8113]],[[544,8070],[543,8075],[540,8074],[540,8071],[544,8070]],[[424,8181],[428,8188],[413,8181],[409,8169],[424,8181]],[[1315,8873],[1309,8871],[1310,8867],[1315,8870],[1315,8873]],[[466,8061],[471,8060],[471,8063],[469,8063],[466,8061]],[[463,8065],[462,8069],[458,8069],[458,8065],[463,8065]]],[[[2286,8678],[2286,8639],[2268,8632],[2229,8643],[2201,8663],[2198,8647],[2247,8606],[2237,8590],[2170,8608],[2139,8627],[2076,8651],[2080,8670],[2048,8683],[2024,8719],[1988,8708],[1954,8719],[1928,8699],[1894,8707],[1885,8735],[1906,8760],[1956,8748],[2002,8763],[2024,8760],[1994,8794],[2039,8823],[2062,8850],[2038,8899],[2013,8904],[1964,8939],[1930,8922],[1930,8939],[1961,8950],[1899,8982],[1899,9001],[1861,9008],[1866,8984],[1778,8998],[1766,8979],[1644,8997],[1572,9016],[1546,9050],[1612,9042],[1590,9056],[1539,9063],[1530,9095],[1546,9144],[1564,9172],[1599,9197],[1631,9204],[1678,9202],[1631,9145],[1640,9100],[1686,9060],[1667,9114],[1696,9106],[1661,9135],[1676,9169],[1746,9198],[1785,9197],[1822,9141],[1805,9098],[1835,9128],[1862,9100],[1876,9132],[1901,9142],[1972,9127],[1970,9106],[2001,9104],[2e3,9085],[2036,9059],[2053,9080],[2094,9059],[2066,9049],[2064,9043],[2072,9048],[2082,9041],[2103,9051],[2091,9022],[2129,9038],[2175,9022],[2212,8976],[2191,8974],[2194,8971],[2188,8967],[2194,8966],[2201,8970],[2207,8967],[2198,8965],[2209,8962],[2222,8945],[2194,8940],[2183,8927],[2180,8928],[2174,8928],[2182,8926],[2175,8917],[2219,8908],[2228,8897],[2231,8899],[2238,8899],[2237,8895],[2228,8896],[2237,8885],[2276,8889],[2307,8851],[2310,8851],[2317,8853],[2324,8851],[2323,8851],[2334,8850],[2324,8830],[2364,8838],[2380,8805],[2348,8798],[2346,8770],[2315,8760],[2319,8733],[2288,8742],[2220,8813],[2190,8809],[2212,8787],[2187,8765],[2258,8726],[2254,8713],[2286,8689],[2286,8685],[2286,8685],[2287,8680],[2292,8674],[2286,8678]],[[2063,9038],[2061,9032],[2070,9036],[2065,9034],[2063,9038]],[[2187,8974],[2164,8972],[2177,8969],[2187,8974]]],[[[2096,7974],[2093,7974],[2100,7980],[2101,7977],[2096,7974]]],[[[533,8059],[538,8053],[544,8051],[538,8052],[533,8059]]],[[[2301,8091],[2368,8068],[2357,8057],[2317,8069],[2301,8091]]],[[[495,8094],[493,8097],[495,8100],[498,8096],[495,8094]]],[[[409,8150],[403,8151],[401,8156],[405,8160],[409,8150]]],[[[1857,8175],[1850,8170],[1841,8168],[1841,8172],[1857,8175]]],[[[316,8175],[314,8174],[313,8171],[313,8177],[316,8175]]],[[[399,8172],[397,8175],[398,8179],[401,8179],[399,8172]]],[[[397,8181],[396,8177],[390,8177],[392,8181],[397,8181]]],[[[385,8190],[387,8184],[385,8182],[383,8189],[385,8190]]],[[[390,8195],[391,8191],[390,8189],[384,8195],[390,8195]]],[[[297,8200],[302,8200],[303,8197],[299,8195],[297,8200]]],[[[394,8186],[392,8196],[394,8203],[397,8191],[394,8186]]],[[[366,8203],[377,8196],[378,8191],[372,8194],[366,8203]]],[[[398,8196],[397,8198],[396,8202],[400,8203],[398,8196]]],[[[359,8213],[360,8209],[357,8209],[354,8216],[359,8213]]],[[[363,8217],[367,8211],[364,8211],[361,8219],[363,8217]]],[[[1788,8220],[1797,8219],[1809,8199],[1769,8212],[1788,8220]]],[[[1834,8218],[1836,8216],[1832,8215],[1833,8218],[1834,8218]]],[[[378,8225],[372,8224],[371,8226],[376,8233],[378,8225]]],[[[329,8230],[331,8237],[350,8227],[348,8218],[329,8230]]],[[[343,8235],[336,8236],[334,8239],[340,8242],[343,8235]]],[[[353,8238],[366,8226],[359,8220],[337,8245],[353,8238]]],[[[327,8256],[336,8254],[339,8250],[328,8243],[327,8256]]],[[[314,8276],[324,8276],[326,8266],[318,8270],[314,8276]]],[[[1852,8288],[1842,8285],[1840,8286],[1859,8290],[1852,8288]]],[[[333,8283],[332,8285],[341,8294],[338,8286],[333,8283]]],[[[1861,8337],[1867,8352],[1869,8353],[1869,8342],[1861,8337]]],[[[1843,8360],[1842,8352],[1831,8342],[1841,8352],[1843,8360]]],[[[1834,8370],[1832,8369],[1834,8374],[1838,8369],[1834,8370]]],[[[2200,8432],[2196,8433],[2197,8436],[2199,8437],[2200,8432]]],[[[2155,8463],[2146,8461],[2146,8468],[2153,8468],[2155,8463]]],[[[1818,8492],[1823,8494],[1825,8492],[1822,8490],[1818,8492]]],[[[1830,8501],[1833,8500],[1829,8496],[1825,8495],[1830,8501]]],[[[2284,8532],[2292,8519],[2283,8523],[2280,8528],[2284,8532]]],[[[2184,8533],[2191,8527],[2187,8519],[2174,8520],[2184,8533]]],[[[1883,8544],[1879,8541],[1869,8538],[1871,8541],[1883,8544]]],[[[2281,8579],[2279,8566],[2261,8578],[2274,8583],[2281,8579]]],[[[2252,8589],[2255,8585],[2247,8587],[2252,8591],[2252,8589]]],[[[1449,8594],[1442,8589],[1438,8593],[1443,8593],[1449,8594]]],[[[2273,8593],[2280,8586],[2271,8587],[2267,8591],[2273,8593]]],[[[1847,8614],[1850,8596],[1837,8578],[1824,8603],[1847,8614]]],[[[1463,8614],[1464,8616],[1470,8615],[1467,8613],[1463,8614]]],[[[2284,8621],[2293,8621],[2287,8613],[2277,8616],[2284,8621]]],[[[1894,8622],[1887,8624],[1901,8624],[1897,8621],[1894,8622]]],[[[2278,8622],[2272,8621],[2274,8624],[2278,8624],[2278,8622]]],[[[1995,8630],[2007,8628],[2009,8625],[1997,8626],[1995,8630]]],[[[2103,8635],[2121,8624],[2105,8622],[2090,8637],[2103,8635]]],[[[1767,8641],[1772,8629],[1737,8605],[1714,8619],[1732,8640],[1767,8641]]],[[[2222,8640],[2222,8639],[2213,8647],[2218,8646],[2222,8640]]],[[[1877,8666],[1899,8663],[1902,8651],[1891,8647],[1877,8666]]],[[[2300,8671],[2296,8665],[2297,8658],[2290,8672],[2300,8671]]],[[[1914,8674],[1932,8665],[1919,8662],[1906,8671],[1914,8674]]],[[[2297,8678],[2295,8679],[2295,8682],[2300,8681],[2297,8678]]],[[[1903,8691],[1897,8687],[1890,8688],[1891,8690],[1903,8691]]],[[[2277,8700],[2275,8699],[2274,8705],[2278,8702],[2277,8700]]],[[[2022,8713],[2021,8705],[2018,8705],[2017,8715],[2022,8713]]],[[[2266,8724],[2269,8720],[2255,8714],[2261,8722],[2266,8724]]],[[[2351,8774],[2357,8774],[2360,8769],[2350,8770],[2351,8774]]],[[[1732,8779],[1726,8777],[1725,8780],[1730,8780],[1732,8779]]],[[[1679,8789],[1689,8780],[1691,8765],[1678,8775],[1679,8789]]],[[[1701,8792],[1719,8784],[1729,8768],[1707,8775],[1701,8792]]],[[[1737,8802],[1744,8800],[1741,8796],[1732,8800],[1737,8802]]],[[[2352,8845],[2353,8844],[2340,8837],[2345,8845],[2352,8845]]],[[[1017,8840],[1013,8840],[1010,8844],[1011,8846],[1017,8840]]],[[[1002,8856],[1e3,8852],[995,8857],[1002,8860],[1002,8856]]],[[[987,8864],[990,8864],[988,8859],[984,8863],[987,8864]]],[[[2311,8862],[2304,8863],[2306,8869],[2311,8864],[2311,8862]]],[[[1001,8864],[995,8864],[996,8870],[999,8869],[1001,8864]]],[[[843,8882],[837,8883],[852,8884],[852,8882],[843,8882]]],[[[997,8881],[992,8881],[993,8884],[996,8885],[997,8881]]],[[[964,8886],[973,8884],[971,8880],[965,8883],[964,8886]]],[[[959,8889],[960,8886],[955,8889],[955,8892],[959,8889]]],[[[944,8895],[952,8898],[942,8891],[932,8889],[944,8895]]],[[[2e3,8891],[2025,8885],[2025,8875],[1996,8875],[2e3,8891]]],[[[1641,8883],[1634,8873],[1624,8883],[1631,8902],[1641,8883]]],[[[890,8898],[887,8898],[889,8902],[894,8903],[890,8898]]],[[[1961,8903],[1974,8899],[1976,8864],[1952,8849],[1919,8848],[1909,8872],[1928,8900],[1961,8903]]],[[[1859,8896],[1854,8898],[1855,8904],[1865,8901],[1859,8896]]],[[[1767,8905],[1771,8904],[1768,8902],[1763,8905],[1767,8905]]],[[[2003,8899],[1996,8909],[2001,8909],[2005,8904],[2003,8899]]],[[[917,8916],[917,8914],[919,8912],[907,8911],[917,8916]]],[[[1102,8907],[1086,8915],[1097,8916],[1104,8913],[1102,8907]]],[[[1872,8919],[1870,8911],[1860,8911],[1869,8917],[1872,8919]]],[[[1993,8916],[1985,8915],[1981,8919],[1984,8921],[1993,8916]]],[[[1981,8915],[1984,8904],[1966,8913],[1971,8924],[1981,8915]]],[[[1184,8927],[1182,8916],[1167,8922],[1176,8929],[1184,8927]]],[[[1232,8934],[1224,8924],[1218,8926],[1218,8938],[1232,8934]]],[[[1236,8935],[1230,8938],[1232,8946],[1235,8943],[1236,8935]]],[[[166,8945],[168,8943],[161,8944],[162,8948],[166,8945]]],[[[1187,8943],[1188,8950],[1191,8949],[1190,8944],[1187,8943]]],[[[1516,8957],[1520,8950],[1516,8949],[1513,8957],[1516,8957]]],[[[1876,8959],[1876,8950],[1864,8933],[1847,8934],[1876,8959]]],[[[181,8968],[186,8972],[180,8962],[173,8964],[181,8968]]],[[[1779,8961],[1785,8959],[1786,8956],[1774,8960],[1779,8961]]],[[[1528,8959],[1523,8951],[1518,8955],[1523,8961],[1528,8959]]],[[[1918,8960],[1929,8958],[1914,8944],[1907,8952],[1918,8960]]],[[[1199,8967],[1208,8963],[1201,8958],[1198,8962],[1199,8967]]],[[[1336,8968],[1351,8968],[1351,8957],[1339,8963],[1336,8968]]],[[[1365,8970],[1373,8966],[1364,8955],[1363,8967],[1365,8970]]],[[[83,8969],[76,8966],[71,8969],[76,8972],[83,8969]]],[[[1890,8974],[1874,8964],[1864,8965],[1881,8977],[1890,8974]]],[[[1840,8981],[1844,8971],[1807,8973],[1823,8980],[1840,8981]]],[[[1756,8978],[1754,8977],[1746,8979],[1751,8982],[1756,8978]]],[[[1479,8982],[1481,8985],[1489,8981],[1487,8976],[1479,8982]]],[[[1315,8986],[1312,8986],[1311,8988],[1315,8988],[1315,8986]]],[[[1622,8997],[1634,8997],[1629,8989],[1611,8996],[1622,8997]]],[[[890,9007],[877,9007],[872,9011],[884,9008],[890,9007]]],[[[748,9020],[758,9020],[744,9016],[738,9020],[748,9020]]],[[[735,9020],[725,9020],[723,9021],[725,9023],[735,9020]]],[[[403,9024],[398,9023],[395,9020],[398,9026],[403,9024]]],[[[1216,9028],[1222,9027],[1230,9016],[1217,9020],[1216,9028]]],[[[2033,9068],[2043,9069],[2038,9062],[2030,9064],[2033,9068]]],[[[2046,9075],[2038,9075],[2040,9080],[2045,9081],[2046,9075]]],[[[1100,9174],[1080,9147],[1043,9179],[1041,9196],[1083,9199],[1100,9174]]],[[[1106,9352],[1117,9374],[1155,9352],[1166,9333],[1127,9326],[1106,9352]]],[[[1524,9434],[1544,9415],[1530,9407],[1498,9420],[1524,9434]]],[[[1088,9420],[1104,9404],[1081,9404],[1056,9441],[1088,9420]]],[[[1664,8007],[1660,8006],[1654,8006],[1656,8009],[1664,8007]]],[[[1600,8048],[1604,8045],[1593,8045],[1594,8049],[1600,8048]]],[[[1763,7943],[1772,7941],[1776,7924],[1734,7937],[1763,7943]]],[[[1732,7940],[1731,7937],[1726,7938],[1728,7941],[1732,7940]]],[[[1710,7953],[1718,7950],[1713,7944],[1709,7949],[1710,7953]]],[[[1938,7875],[1934,7873],[1936,7876],[1943,7877],[1938,7875]]],[[[1366,9443],[1437,9441],[1429,9423],[1355,9424],[1366,9443]]],[[[2430,7942],[2394,7922],[2378,7943],[2406,7980],[2411,7952],[2430,7942]]],[[[2364,7988],[2365,7958],[2348,7940],[2327,7957],[2361,7959],[2364,7988]]],[[[277,8210],[270,8217],[293,8221],[295,8199],[277,8210]]],[[[257,8259],[297,8258],[287,8221],[261,8230],[257,8259]]],[[[1844,8337],[1829,8330],[1851,8362],[1858,8352],[1844,8337]]],[[[1395,9317],[1429,9288],[1426,9252],[1382,9254],[1337,9272],[1349,9299],[1395,9317]]],[[[957,9478],[905,9483],[849,9475],[844,9483],[927,9507],[955,9496],[957,9478]]],[[[1358,9489],[1390,9481],[1388,9465],[1330,9444],[1302,9460],[1284,9490],[1291,9511],[1350,9498],[1358,9489]]],[[[2210,7911],[2202,7914],[2203,7927],[2195,7929],[2192,7933],[2192,7982],[2149,7996],[2126,7968],[2118,7937],[2082,7905],[1987,7905],[2022,7920],[2033,7943],[2111,7979],[2155,8025],[2239,8062],[2276,8063],[2298,8050],[2295,8032],[2262,8016],[2230,8020],[2256,8004],[2290,8010],[2271,7986],[2302,7943],[2350,7927],[2367,7937],[2394,7917],[2333,7893],[2308,7894],[2257,7848],[2239,7871],[2245,7889],[2279,7910],[2289,7938],[2249,7913],[2210,7911]]],[[[2018,7927],[2024,7931],[2021,7924],[2020,7921],[2009,7921],[2015,7925],[2012,7925],[2016,7930],[2021,7930],[2018,7927]]],[[[518,8075],[504,8083],[514,8081],[518,8075],[518,8075],[518,8075]]],[[[629,9322],[617,9345],[604,9327],[571,9328],[559,9347],[597,9359],[678,9417],[749,9430],[780,9414],[754,9406],[765,9375],[730,9364],[718,9338],[684,9302],[660,9308],[712,9340],[710,9380],[687,9377],[670,9338],[629,9322]]],[[[2606,8006],[2634,8020],[2643,7998],[2633,7971],[2596,7976],[2607,7995],[2574,7990],[2550,7973],[2552,8004],[2449,8e3],[2441,8012],[2462,8038],[2521,8144],[2553,8130],[2521,8094],[2558,8090],[2552,8069],[2599,8083],[2618,8064],[2604,8038],[2629,8033],[2606,8006]]],[[[1663,8674],[1617,8670],[1645,8694],[1639,8718],[1654,8775],[1667,8783],[1687,8748],[1694,8761],[1761,8726],[1784,8700],[1824,8681],[1800,8664],[1725,8695],[1722,8679],[1673,8648],[1663,8674]]],[[[1295,8985],[1330,8964],[1360,8932],[1379,8931],[1340,8910],[1312,8914],[1248,8940],[1284,8957],[1295,8985]]],[[[1118,9032],[1191,8997],[1210,8979],[1165,8981],[1152,8958],[1175,8964],[1181,8940],[1135,8927],[1046,8948],[1043,8964],[1019,8939],[971,8925],[843,8910],[830,8948],[762,8954],[719,8990],[733,8998],[815,9008],[894,9005],[875,9018],[821,9029],[760,9020],[715,9023],[691,9046],[758,9065],[767,9075],[697,9065],[700,9081],[671,9079],[670,9095],[698,9112],[685,9123],[721,9151],[804,9178],[822,9164],[829,9134],[850,9157],[903,9140],[890,9116],[922,9133],[946,9128],[919,9156],[937,9155],[980,9131],[1007,9079],[1021,9094],[1006,9107],[996,9142],[999,9187],[1024,9167],[1044,9168],[1077,9144],[1079,9125],[1107,9076],[1100,9049],[1118,9032]]],[[[1885,9194],[1941,9161],[1939,9145],[1830,9148],[1807,9172],[1804,9199],[1885,9194]]],[[[1340,9095],[1291,9080],[1274,9059],[1217,9110],[1182,9118],[1155,9145],[1179,9161],[1198,9140],[1223,9141],[1230,9163],[1188,9184],[1204,9198],[1291,9219],[1302,9241],[1296,9210],[1318,9205],[1321,9178],[1285,9158],[1318,9154],[1331,9167],[1346,9123],[1340,9095]]],[[[596,9246],[638,9229],[700,9230],[736,9218],[782,9183],[668,9135],[638,9108],[624,9071],[551,9049],[522,9083],[467,9098],[499,9159],[531,9200],[502,9234],[596,9246]]],[[[1227,9273],[1215,9298],[1242,9311],[1158,9302],[1138,9317],[1171,9332],[1183,9360],[1242,9329],[1202,9368],[1208,9378],[1306,9362],[1313,9300],[1295,9274],[1227,9273]]],[[[938,9326],[960,9339],[928,9351],[976,9386],[984,9335],[1027,9326],[1040,9336],[1073,9326],[1073,9306],[1130,9283],[1100,9275],[1068,9293],[1058,9276],[987,9267],[975,9276],[890,9242],[830,9239],[808,9254],[857,9271],[887,9271],[912,9287],[822,9276],[820,9294],[792,9270],[717,9284],[764,9354],[794,9364],[795,9380],[808,9377],[822,9344],[851,9349],[896,9323],[902,9303],[972,9302],[974,9314],[938,9326]]],[[[1848,9265],[1825,9250],[1777,9240],[1726,9247],[1603,9240],[1567,9252],[1535,9244],[1473,9259],[1459,9285],[1470,9325],[1440,9355],[1412,9348],[1360,9357],[1331,9393],[1362,9399],[1423,9389],[1442,9371],[1490,9375],[1552,9344],[1528,9336],[1587,9303],[1652,9304],[1719,9322],[1797,9319],[1840,9300],[1841,9283],[1817,9274],[1848,9265]]],[[[933,9426],[877,9415],[845,9427],[833,9446],[816,9439],[788,9455],[811,9463],[843,9452],[918,9464],[949,9456],[933,9426]]],[[[1126,9547],[1165,9524],[1187,9528],[1249,9496],[1240,9486],[1266,9450],[1200,9447],[1205,9471],[1154,9471],[1155,9482],[1104,9475],[1087,9490],[1131,9490],[1115,9522],[1071,9525],[1076,9545],[1126,9547]]],[[[1511,9629],[1553,9627],[1562,9603],[1579,9620],[1601,9618],[1623,9584],[1617,9561],[1665,9561],[1684,9542],[1637,9527],[1563,9469],[1474,9471],[1406,9521],[1437,9534],[1477,9534],[1456,9553],[1417,9540],[1362,9550],[1334,9600],[1389,9593],[1338,9609],[1354,9630],[1379,9632],[1370,9645],[1389,9663],[1439,9666],[1403,9677],[1436,9685],[1480,9670],[1511,9629]]],[[[518,8075],[519,8073],[519,8072],[518,8075],[518,8075],[518,8075]]]]}},{type:"Feature",id:"ST",properties:{"hc-group":"admin0","hc-middle-x":.55,"hc-middle-y":.5,"hc-key":"st","hc-a2":"ST",name:"Sao Tome and Principe",labelrank:"6","country-abbrev":"S.T.P.",subregion:"Middle Africa","region-wb":"Sub-Saharan Africa","iso-a3":"STP","iso-a2":"ST","woe-id":"23424966",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4400,6481],[4396,6485],[4401,6491],[4405,6487],[4400,6481]]]}},{type:"Feature",id:"CV",properties:{"hc-group":"admin0","hc-middle-x":.56,"hc-middle-y":.5,"hc-key":"cv","hc-a2":"CV",name:"Cape Verde",labelrank:"4","country-abbrev":"C.Vd.",subregion:"Western Africa","region-wb":"Sub-Saharan Africa","iso-a3":"CPV","iso-a2":"CV","woe-id":"23424794",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[3499,6934],[3506,6928],[3507,6922],[3499,6925],[3499,6934]]]}},{type:"Feature",id:"DM",properties:{"hc-group":"admin0","hc-middle-x":.54,"hc-middle-y":.47,"hc-key":"dm","hc-a2":"DM",name:"Dominica",labelrank:"6","country-abbrev":"D'inca",subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"DMA","iso-a2":"DM","woe-id":"23424798",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[2382,6942],[2386,6936],[2383,6930],[2380,6939],[2382,6942]]]}},{type:"Feature",id:"NL",properties:{"hc-group":"admin0","hc-middle-x":.99,"hc-middle-y":.01,"hc-key":"nl","hc-a2":"NL",name:"Netherlands",labelrank:"5","country-abbrev":"Neth.",subregion:"Western Europe","region-wb":"Europe & Central Asia","iso-a3":"NLD","iso-a2":"NL","woe-id":"-90",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[4369,8229],[4359,8225],[4360,8227],[4372,8230],[4369,8229]]],[[[2334,7016],[2331,7016],[2331,7017],[2334,7016]]],[[[4303,8146],[4315,8146],[4329,8146],[4317,8140],[4303,8146]]],[[[4417,8221],[4412,8180],[4393,8164],[4382,8122],[4353,8150],[4330,8146],[4318,8156],[4355,8209],[4396,8234],[4417,8221]]]]}},{type:"Feature",id:"JM",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.52,"hc-key":"jm","hc-a2":"JM",name:"Jamaica",labelrank:"4","country-abbrev":"Jam.",subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"JAM","iso-a2":"JM","woe-id":"23424858",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[1906,7029],[1943,7013],[1913,7006],[1878,7023],[1906,7029]]]}},{type:"Feature",id:"WS",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.54,"hc-key":"ws","hc-a2":"WS",name:"Samoa",labelrank:"4","country-abbrev":"Samoa",subregion:"Polynesia","region-wb":"East Asia & Pacific","iso-a3":"WSM","iso-a2":"WS","woe-id":"23424992",continent:"Oceania"},geometry:{type:"Polygon",coordinates:[[[-909,6078],[-907,6069],[-916,6069],[-924,6078],[-909,6078]]]}},{type:"Feature",id:"OM",properties:{"hc-group":"admin0","hc-middle-x":.88,"hc-middle-y":.44,"hc-key":"om","hc-a2":"OM",name:"Oman",labelrank:"4","country-abbrev":"Oman",subregion:"Western Asia","region-wb":"Middle East & North Africa","iso-a3":"OMN","iso-a2":"OM","woe-id":"23424898",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[5874,7239],[5873,7238],[5873,7241],[5876,7241],[5874,7239]]],[[[5868,7265],[5877,7275],[5874,7251],[5870,7253],[5868,7265]]],[[[5747,7045],[5836,7076],[5855,7137],[5842,7160],[5860,7228],[5877,7231],[5900,7199],[5948,7186],[5979,7145],[5916,7068],[5920,7047],[5885,7033],[5876,7013],[5849,7010],[5837,6985],[5780,6974],[5769,6994],[5747,7045]]]]}},{type:"Feature",id:"VC",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.5,"hc-key":"vc","hc-a2":"VC",name:"Saint Vincent and the Grenadines",labelrank:"6","country-abbrev":"St.V.G.",subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"VCT","iso-a2":"VC","woe-id":"23424981",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[2388,6865],[2385,6871],[2389,6875],[2390,6870],[2388,6865]]]}},{type:"Feature",id:"TR",properties:{"hc-group":"admin0","hc-middle-x":.34,"hc-middle-y":.49,"hc-key":"tr","hc-a2":"TR",name:"Turkey",labelrank:"2","country-abbrev":"Tur.",subregion:"Western Asia","region-wb":"Europe & Central Asia","iso-a3":"TUR","iso-a2":"TR","woe-id":"23424969",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[4974,7732],[4969,7730],[4966,7731],[4973,7735],[4974,7732]]],[[[5035,7796],[5068,7769],[5021,7761],[5011,7748],[4977,7752],[4994,7775],[4985,7786],[5007,7799],[5035,7796]]],[[[5534,7714],[5510,7704],[5516,7656],[5532,7628],[5472,7635],[5461,7627],[5457,7634],[5384,7614],[5338,7620],[5291,7617],[5270,7586],[5272,7620],[5252,7608],[5229,7615],[5177,7590],[5154,7607],[5115,7619],[5106,7597],[5085,7593],[5044,7625],[5011,7635],[5012,7657],[4983,7666],[5007,7687],[4989,7700],[4986,7702],[4979,7707],[4997,7740],[5069,7741],[5071,7770],[5131,7764],[5193,7797],[5271,7787],[5318,7762],[5374,7765],[5395,7758],[5436,7779],[5474,7782],[5493,7765],[5500,7730],[5533,7716],[5534,7714]]]]}},{type:"Feature",id:"BD",properties:{"hc-group":"admin0","hc-middle-x":.85,"hc-middle-y":.61,"hc-key":"bd","hc-a2":"BD",name:"Bangladesh",labelrank:"3","country-abbrev":"Bang.",subregion:"Southern Asia","region-wb":"South Asia","iso-a3":"BGD","iso-a2":"BD","woe-id":"23424759",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[6942,7109],[6918,7163],[6880,7132],[6847,7142],[6832,7189],[6837,7209],[6816,7220],[6843,7237],[6818,7260],[6829,7277],[6870,7262],[6886,7236],[6935,7237],[6949,7229],[6909,7188],[6922,7167],[6939,7192],[6951,7137],[6953,7116],[6942,7109]]]}},{type:"Feature",id:"LC",properties:{"hc-group":"admin0","hc-middle-x":.52,"hc-middle-y":.47,"hc-key":"lc","hc-a2":"LC",name:"Saint Lucia",labelrank:"6","country-abbrev":"S.L.",subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"LCA","iso-a2":"LC","woe-id":"23424951",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[2395,6886],[2391,6890],[2396,6897],[2397,6893],[2395,6886]]]}},{type:"Feature",id:"NR",properties:{"hc-group":"admin0","hc-middle-x":.53,"hc-middle-y":.5,"hc-key":"nr","hc-a2":"NR",name:"Nauru",labelrank:"6","country-abbrev":"Nauru",subregion:"Micronesia","region-wb":"East Asia & Pacific","iso-a3":"NRU","iso-a2":"NR","woe-id":"23424912",continent:"Oceania"},geometry:{type:"Polygon",coordinates:[[[9158,6463],[9157,6463],[9157,6464],[9159,6464],[9158,6463]]]}},{type:"Feature",id:"NO",properties:{"hc-group":"admin0","hc-middle-x":.1,"hc-middle-y":.93,"hc-key":"no","hc-a2":"NO",name:"Norway",labelrank:"3","country-abbrev":"Nor.",subregion:"Northern Europe","region-wb":"Europe & Central Asia","iso-a3":"NOR","iso-a2":"NO","woe-id":"-90",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[4821,8997],[4815,8993],[4809,8996],[4815,9003],[4821,8997]]],[[[4797,8992],[4790,8995],[4784,9004],[4802,8997],[4797,8992]]],[[[4877,9011],[4887,9004],[4870,9006],[4871,9011],[4877,9011]]],[[[4901,9024],[4906,9016],[4890,9006],[4882,9013],[4901,9024]]],[[[4911,9029],[4920,9024],[4909,9019],[4905,9028],[4911,9029]]],[[[4898,9036],[4889,9022],[4861,9017],[4873,9029],[4898,9036]]],[[[4918,9045],[4919,9040],[4914,9042],[4915,9046],[4918,9045]]],[[[4966,9053],[4974,9045],[4962,9041],[4955,9047],[4966,9053]]],[[[4841,9496],[4865,9475],[4829,9471],[4803,9490],[4841,9496]]],[[[4998,9499],[4989,9504],[4994,9510],[5e3,9504],[4998,9499]]],[[[5066,9517],[5038,9511],[5030,9512],[5047,9521],[5066,9517]]],[[[4804,9531],[4822,9526],[4810,9523],[4799,9526],[4804,9531]]],[[[4802,9547],[4789,9545],[4786,9549],[4789,9550],[4802,9547]]],[[[5202,9605],[5178,9599],[5142,9595],[5139,9598],[5202,9605]]],[[[4928,9617],[4921,9616],[4921,9620],[4923,9621],[4928,9617]]],[[[4921,9625],[4925,9623],[4923,9622],[4917,9623],[4921,9625]]],[[[4797,9623],[4793,9624],[4796,9627],[4801,9625],[4797,9623]]],[[[4837,9638],[4831,9635],[4828,9638],[4834,9639],[4837,9638]]],[[[4821,9634],[4821,9638],[4813,9643],[4826,9639],[4821,9634]]],[[[4748,8967],[4767,8968],[4802,8988],[4813,8979],[4815,8980],[4817,8980],[4818,8983],[4823,8988],[4820,8990],[4826,8992],[4827,8992],[4845,9007],[4847,9007],[4847,9006],[4849,9005],[4850,9007],[4886,9002],[4934,9033],[4973,9037],[4948,9018],[4950,8995],[4996,9042],[4991,9010],[5022,9050],[5094,9029],[5126,9006],[5099,8995],[5057,9e3],[5119,8981],[5093,8957],[5063,8940],[5075,8962],[5032,8995],[4976,8974],[4965,8932],[4942,8915],[4914,8929],[4869,8923],[4847,8952],[4816,8940],[4797,8905],[4743,8914],[4735,8885],[4718,8892],[4683,8857],[4691,8839],[4635,8792],[4635,8753],[4609,8718],[4618,8690],[4580,8688],[4560,8656],[4569,8610],[4565,8584],[4586,8568],[4568,8551],[4575,8512],[4556,8501],[4543,8462],[4515,8473],[4456,8430],[4429,8420],[4398,8424],[4359,8468],[4372,8509],[4342,8554],[4363,8576],[4347,8589],[4369,8612],[4411,8630],[4409,8639],[4464,8659],[4435,8662],[4465,8681],[4504,8658],[4544,8680],[4498,8667],[4487,8679],[4537,8729],[4562,8742],[4566,8761],[4607,8833],[4667,8874],[4643,8878],[4692,8898],[4682,8907],[4716,8924],[4703,8941],[4719,8966],[4748,8967],[4769,8982],[4768,8999],[4781,8983],[4748,8967]],[[5095,8982],[5091,8986],[5086,8978],[5097,8981],[5095,8982]]],[[[4948,9363],[4949,9366],[4963,9376],[4948,9363],[4948,9363],[4948,9363]]],[[[4630,8922],[4662,8932],[4682,8955],[4696,8923],[4668,8902],[4602,8890],[4605,8899],[4657,8910],[4630,8922]]],[[[4893,9411],[4874,9424],[4825,9422],[4847,9452],[4824,9463],[4886,9474],[4905,9449],[4929,9446],[4893,9411]]],[[[4669,9570],[4695,9593],[4764,9552],[4766,9533],[4843,9513],[4768,9488],[4744,9425],[4730,9424],[4703,9367],[4631,9407],[4617,9428],[4702,9450],[4611,9443],[4607,9461],[4650,9465],[4673,9480],[4644,9505],[4641,9483],[4590,9471],[4561,9497],[4565,9471],[4533,9487],[4515,9516],[4540,9521],[4522,9560],[4531,9569],[4564,9568],[4613,9582],[4616,9559],[4636,9577],[4658,9563],[4689,9517],[4669,9570]]],[[[4909,9611],[5e3,9602],[5010,9580],[4975,9557],[4918,9535],[4884,9538],[4883,9551],[4822,9548],[4787,9564],[4852,9570],[4854,9578],[4761,9571],[4763,9592],[4732,9599],[4742,9610],[4778,9596],[4809,9619],[4824,9604],[4852,9608],[4868,9590],[4879,9624],[4887,9601],[4909,9611]]],[[[4948,9363],[4946,9359],[4947,9363],[4948,9363],[4948,9363],[4948,9363]]]]}},{type:"Feature",id:"KN",properties:{"hc-group":"admin0","hc-middle-x":.57,"hc-middle-y":.49,"hc-key":"kn","hc-a2":"KN",name:"Saint Kitts and Nevis",labelrank:"6","country-abbrev":"St.K.N.",subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"KNA","iso-a2":"KN","woe-id":"23424940",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[2346,6991],[2339,6996],[2340,6997],[2343,6995],[2346,6991]]]}},{type:"Feature",id:"BH",properties:{"hc-group":"admin0","hc-middle-x":.45,"hc-middle-y":.5,"hc-key":"bh","hc-a2":"BH",name:"Bahrain",labelrank:"4","country-abbrev":"Bahr.",subregion:"Western Asia","region-wb":"Middle East & North Africa","iso-a3":"BHR","iso-a2":"BH","woe-id":"23424753",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[5702,7271],[5706,7269],[5705,7256],[5701,7263],[5702,7271]]]}},{type:"Feature",id:"TO",properties:{"hc-group":"admin0","hc-middle-x":.54,"hc-middle-y":.34,"hc-key":"to","hc-a2":"TO",name:"Tonga",labelrank:"4","country-abbrev":"Tongo",subregion:"Polynesia","region-wb":"East Asia & Pacific","iso-a3":"TON","iso-a2":"TO","woe-id":"23424964",continent:"Oceania"},geometry:{type:"Polygon",coordinates:[[[-987,5842],[-988,5840],[-999,5845],[-992,5847],[-987,5842]]]}},{type:"Feature",id:"FI",properties:{"hc-group":"admin0","hc-middle-x":.63,"hc-middle-y":.54,"hc-key":"fi","hc-a2":"FI",name:"Finland",labelrank:"3","country-abbrev":"Fin.",subregion:"Northern Europe","region-wb":"Europe & Central Asia","iso-a3":"FIN","iso-a2":"FI","woe-id":"23424812",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[4816,8512],[4815,8507],[4806,8505],[4810,8509],[4816,8512]]],[[[4803,8510],[4806,8512],[4803,8505],[4798,8508],[4803,8510]]],[[[4808,8518],[4799,8510],[4785,8518],[4800,8522],[4808,8518]]],[[[4844,8516],[4844,8514],[4855,8514],[4842,8511],[4844,8516]]],[[[4870,8506],[4870,8515],[4882,8511],[4872,8501],[4870,8506]]],[[[4836,8532],[4837,8528],[4836,8523],[4835,8528],[4836,8532]]],[[[4835,8657],[4838,8652],[4834,8650],[4830,8654],[4835,8657]]],[[[4942,8741],[4935,8736],[4933,8739],[4936,8741],[4942,8741]]],[[[4851,8526],[4845,8528],[4834,8596],[4842,8652],[4868,8658],[4939,8731],[4954,8729],[4955,8762],[4921,8778],[4906,8808],[4916,8826],[4899,8860],[4906,8885],[4816,8940],[4847,8952],[4869,8923],[4914,8929],[4942,8915],[4965,8932],[4976,8974],[5032,8995],[5075,8962],[5063,8940],[5048,8914],[5055,8897],[5095,8871],[5067,8828],[5091,8792],[5082,8737],[5111,8691],[5094,8678],[5141,8638],[5131,8620],[5071,8562],[5029,8531],[4909,8505],[4869,8520],[4871,8521],[4866,8521],[4866,8521],[4854,8525],[4857,8523],[4856,8520],[4851,8524],[4851,8526]]]]}},{type:"Feature",id:"ID",properties:{"hc-group":"admin0","hc-middle-x":.38,"hc-middle-y":.41,"hc-key":"id","hc-a2":"ID",name:"Indonesia",labelrank:"2","country-abbrev":"Indo.",subregion:"South-Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"IDN","iso-a2":"ID","woe-id":"23424846",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[8188,6311],[8203,6311],[8186,6274],[8184,6299],[8156,6320],[8188,6311]]],[[[7394,6396],[7365,6387],[7343,6415],[7351,6432],[7368,6393],[7394,6396]]],[[[7693,6231],[7736,6235],[7737,6224],[7676,6209],[7642,6218],[7658,6236],[7693,6231]]],[[[8007,6546],[8003,6517],[8028,6486],[8001,6493],[7995,6439],[7976,6470],[7993,6473],[7985,6514],[8007,6546]]],[[[7885,6203],[7891,6198],[7897,6207],[7902,6208],[7911,6214],[7912,6206],[7915,6198],[7897,6179],[7868,6172],[7885,6203]]],[[[7703,6601],[7696,6596],[7697,6601],[7703,6601]]],[[[8388,6402],[8388,6275],[8388,6210],[8360,6240],[8289,6230],[8299,6253],[8325,6262],[8294,6324],[8238,6346],[8216,6347],[8170,6376],[8148,6358],[8127,6400],[8181,6408],[8142,6411],[8087,6439],[8070,6476],[8099,6455],[8142,6468],[8180,6457],[8185,6415],[8210,6380],[8248,6403],[8246,6430],[8295,6435],[8355,6409],[8388,6402]]],[[[7779,6174],[7734,6196],[7755,6202],[7771,6234],[7833,6224],[7852,6236],[7936,6242],[7886,6226],[7878,6234],[7818,6216],[7763,6218],[7789,6183],[7779,6174]]],[[[7419,6248],[7365,6260],[7335,6278],[7351,6305],[7419,6294],[7427,6279],[7483,6274],[7496,6290],[7530,6275],[7624,6277],[7624,6218],[7565,6234],[7548,6229],[7490,6237],[7450,6251],[7419,6248]]],[[[8007,6388],[7965,6365],[7943,6380],[7942,6408],[7946,6387],[7976,6380],[8002,6393],[8048,6397],[8079,6386],[8086,6365],[8007,6388]]],[[[7849,6311],[7824,6317],[7851,6347],[7809,6341],[7813,6358],[7778,6383],[7775,6316],[7746,6321],[7754,6351],[7730,6401],[7746,6421],[7766,6500],[7792,6519],[7814,6510],[7882,6503],[7917,6531],[7898,6492],[7774,6491],[7765,6473],[7785,6438],[7815,6465],[7866,6460],[7862,6427],[7846,6446],[7811,6422],[7839,6386],[7855,6349],[7849,6311]]],[[[7693,6601],[7687,6576],[7709,6546],[7702,6535],[7736,6509],[7698,6501],[7689,6463],[7663,6436],[7664,6414],[7646,6373],[7606,6356],[7594,6380],[7558,6385],[7522,6375],[7519,6397],[7476,6390],[7466,6446],[7452,6441],[7434,6503],[7458,6540],[7485,6504],[7557,6525],[7602,6521],[7631,6568],[7642,6608],[7693,6601]]],[[[7120,6602],[7164,6572],[7200,6534],[7221,6541],[7283,6486],[7272,6457],[7301,6448],[7311,6409],[7338,6408],[7352,6382],[7345,6312],[7312,6304],[7219,6384],[7196,6415],[7181,6455],[7152,6486],[7124,6478],[7149,6426],[7139,6429],[7121,6478],[7145,6496],[7128,6536],[7092,6539],[7110,6508],[7103,6496],[7087,6540],[7065,6548],[7092,6543],[7100,6563],[7036,6621],[7032,6650],[7065,6633],[7097,6634],[7120,6602]]]]}},{type:"Feature",id:"MU",properties:{"hc-group":"admin0","hc-middle-x":.63,"hc-middle-y":.58,"hc-key":"mu","hc-a2":"MU",name:"Mauritius",labelrank:"5","country-abbrev":"Mus.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"MUS","iso-a2":"MU","woe-id":"23424894",continent:"Seven seas (open ocean)"},geometry:{type:"Polygon",coordinates:[[[5917,5878],[5916,5867],[5907,5866],[5911,5880],[5917,5878]]]}},{type:"Feature",id:"SE",properties:{"hc-group":"admin0","hc-middle-x":.4,"hc-middle-y":.48,"hc-key":"se","hc-a2":"SE",name:"Sweden",labelrank:"3","country-abbrev":"Swe.",subregion:"Northern Europe","region-wb":"Europe & Central Asia","iso-a3":"SWE","iso-a2":"SE","woe-id":"23424954",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[4749,8461],[4749,8461],[4749,8466],[4753,8466],[4749,8461]]],[[[4864,8758],[4864,8764],[4868,8762],[4868,8758],[4864,8758]]],[[[4921,8778],[4853,8764],[4831,8722],[4845,8711],[4821,8684],[4769,8651],[4733,8619],[4712,8569],[4718,8540],[4736,8533],[4770,8495],[4751,8469],[4701,8445],[4691,8414],[4700,8372],[4711,8391],[4741,8387],[4760,8415],[4759,8386],[4710,8386],[4693,8344],[4640,8340],[4625,8309],[4589,8309],[4571,8373],[4546,8417],[4550,8417],[4552,8421],[4545,8421],[4546,8418],[4537,8434],[4543,8462],[4556,8501],[4575,8512],[4568,8551],[4586,8568],[4565,8584],[4569,8610],[4560,8656],[4580,8688],[4618,8690],[4609,8718],[4635,8753],[4635,8792],[4691,8839],[4683,8857],[4718,8892],[4735,8885],[4743,8914],[4797,8905],[4816,8940],[4906,8885],[4899,8860],[4916,8826],[4906,8808],[4921,8778]],[[4554,8430],[4543,8426],[4546,8423],[4554,8424],[4554,8430]]]]}},{type:"Feature",id:"TT",properties:{"hc-group":"admin0","hc-middle-x":.46,"hc-middle-y":.44,"hc-key":"tt","hc-a2":"TT",name:"Trinidad and Tobago",labelrank:"5","country-abbrev":"Tr.T.",subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"TTO","iso-a2":"TT","woe-id":"23424958",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[2396,6799],[2394,6779],[2380,6783],[2374,6796],[2396,6799]]]}},{type:"Feature",id:"MY",properties:{"hc-group":"admin0","hc-middle-x":.9,"hc-middle-y":.26,"hc-key":"my","hc-a2":"MY",name:"Malaysia",labelrank:"3","country-abbrev":"Malay.",subregion:"South-Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"MYS","iso-a2":"MY","woe-id":"23424901",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[7181,6640],[7180,6634],[7177,6634],[7177,6640],[7181,6640]]],[[[7703,6601],[7697,6601],[7698,6602],[7693,6601],[7642,6608],[7631,6568],[7602,6521],[7557,6525],[7485,6504],[7458,6540],[7498,6525],[7508,6550],[7510,6549],[7510,6554],[7511,6558],[7558,6572],[7587,6614],[7606,6597],[7616,6623],[7617,6624],[7618,6621],[7627,6606],[7621,6623],[7650,6660],[7685,6675],[7743,6632],[7710,6623],[7722,6607],[7701,6603],[7703,6601]]],[[[7175,6669],[7204,6663],[7205,6645],[7233,6663],[7274,6620],[7274,6565],[7299,6519],[7272,6524],[7210,6563],[7193,6593],[7175,6669]]]]}},{type:"Feature",id:"PA",properties:{"hc-group":"admin0","hc-middle-x":.22,"hc-middle-y":.5,"hc-key":"pa","hc-a2":"PA",name:"Panama",labelrank:"4","country-abbrev":"Pan.",subregion:"Central America","region-wb":"Latin America & Caribbean","iso-a3":"PAN","iso-a2":"PA","woe-id":"23424924",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[1892,6692],[1873,6732],[1843,6744],[1816,6717],[1829,6699],[1776,6692],[1778,6721],[1744,6716],[1739,6725],[1740,6725],[1740,6725],[1740,6726],[1740,6726],[1754,6762],[1768,6743],[1798,6739],[1841,6763],[1876,6757],[1908,6735],[1914,6713],[1892,6692]]]}},{type:"Feature",id:"PW",properties:{"hc-group":"admin0","hc-middle-x":.38,"hc-middle-y":.44,"hc-key":"pw","hc-a2":"PW",name:"Palau",labelrank:"6","country-abbrev":"Palau",subregion:"Micronesia","region-wb":"East Asia & Pacific","iso-a3":"PLW","iso-a2":"PW","woe-id":"23424927",continent:"Oceania"},geometry:{type:"Polygon",coordinates:[[[8196,6695],[8195,6699],[8197,6703],[8200,6703],[8196,6695]]]}},{type:"Feature",id:"TV",properties:{"hc-group":"admin0","hc-middle-x":.25,"hc-middle-y":.5,"hc-key":"tv","hc-a2":"TV",name:"Tuvalu",labelrank:"6","country-abbrev":"Tuv.",subregion:"Polynesia","region-wb":"East Asia & Pacific","iso-a3":"TUV","iso-a2":"TV","woe-id":"23424970",continent:"Oceania"},geometry:{type:"Polygon",coordinates:[[[9522,6227],[9522,6227],[9522,6229],[9522,6227],[9522,6227]]]}},{type:"Feature",id:"MH",properties:{"hc-group":"admin0","hc-middle-x":.49,"hc-middle-y":.6,"hc-key":"mh","hc-a2":"MH",name:"Marshall Islands",labelrank:"6","country-abbrev":"M. Is.",subregion:"Micronesia","region-wb":"East Asia & Pacific","iso-a3":"MHL","iso-a2":"MH","woe-id":"23424932",continent:"Oceania"},geometry:{type:"Polygon",coordinates:[[[9280,6690],[9285,6688],[9286,6687],[9285,6688],[9280,6690]]]}},{type:"Feature",id:"CL",properties:{"hc-group":"admin0","hc-middle-x":.51,"hc-middle-y":.9,"hc-key":"cl","hc-a2":"CL",name:"Chile",labelrank:"2","country-abbrev":"Chile",subregion:"South America","region-wb":"Latin America & Caribbean","iso-a3":"CHL","iso-a2":"CL","woe-id":"23424782",continent:"South America"},geometry:{type:"MultiPolygon",coordinates:[[[[2028,4732],[2063,4714],[2042,4700],[2014,4729],[2028,4732]]],[[[1977,4948],[1993,4916],[1994,4867],[1960,4879],[1981,4893],[1959,4908],[1961,4938],[1977,4948]]],[[[2022,5147],[2016,5111],[1985,5101],[2001,5124],[2006,5163],[2022,5147]]],[[[2167,4761],[2167,4674],[2165,4674],[2167,4673],[2167,4670],[2128,4674],[2110,4657],[2088,4695],[2113,4723],[2117,4693],[2157,4688],[2125,4702],[2114,4746],[2144,4768],[2167,4761]]],[[[2115,5932],[2128,5935],[2141,5957],[2157,5913],[2173,5898],[2163,5868],[2180,5842],[2189,5794],[2210,5794],[2206,5757],[2169,5733],[2177,5666],[2162,5659],[2137,5618],[2109,5516],[2133,5456],[2115,5397],[2115,5366],[2096,5352],[2091,5311],[2101,5277],[2085,5269],[2069,5206],[2075,5158],[2063,5125],[2077,5092],[2066,5062],[2088,5042],[2070,4970],[2051,4944],[2059,4928],[2020,4882],[2032,4835],[2058,4839],[2054,4804],[2070,4787],[2128,4786],[2173,4772],[2152,4778],[2105,4757],[2096,4714],[2032,4737],[2038,4753],[2004,4758],[1996,4781],[2017,4777],[2012,4815],[1976,4834],[2e3,4847],[1996,4918],[1986,4952],[2e3,4987],[1966,4992],[1995,5037],[2008,5015],[2031,5042],[2026,5058],[1996,5060],[2012,5097],[2020,5062],[2053,5159],[2039,5179],[2015,5170],[2010,5197],[2030,5249],[2018,5310],[2031,5329],[2048,5383],[2060,5398],[2085,5489],[2078,5559],[2088,5569],[2081,5601],[2100,5643],[2113,5714],[2109,5785],[2125,5837],[2115,5932]]],[[[2209,4666],[2230,4654],[2168,4659],[2214,4627],[2192,4628],[2162,4657],[2133,4648],[2129,4663],[2202,4668],[2207,4668],[2209,4666]]]]}},{type:"Feature",id:"TH",properties:{"hc-group":"admin0","hc-middle-x":.25,"hc-middle-y":.49,"hc-key":"th","hc-a2":"TH",name:"Thailand",labelrank:"3","country-abbrev":"Thai.",subregion:"South-Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"THA","iso-a2":"TH","woe-id":"23424960",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[7239,6839],[7241,6837],[7244,6834],[7240,6833],[7239,6839]]],[[[7233,6663],[7205,6645],[7204,6663],[7175,6669],[7151,6704],[7118,6732],[7134,6785],[7161,6829],[7146,6886],[7119,6918],[7137,6959],[7095,7030],[7113,7070],[7128,7066],[7175,7086],[7186,7062],[7209,7061],[7205,6999],[7233,7022],[7249,7010],[7272,7029],[7290,7025],[7315,6996],[7313,6970],[7338,6946],[7325,6904],[7280,6907],[7241,6881],[7258,6824],[7226,6854],[7201,6852],[7200,6878],[7173,6876],[7172,6840],[7151,6793],[7149,6752],[7167,6753],[7185,6690],[7218,6681],[7233,6663]]]]}},{type:"Feature",id:"GD",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.5,"hc-key":"gd","hc-a2":"GD",name:"Grenada",labelrank:"6","country-abbrev":"Gren.",subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"GRD","iso-a2":"GD","woe-id":"23424826",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[2375,6835],[2372,6835],[2372,6839],[2376,6841],[2375,6835]]]}},{type:"Feature",id:"EE",properties:{"hc-group":"admin0","hc-middle-x":.35,"hc-middle-y":.41,"hc-key":"ee","hc-a2":"EE",name:"Estonia",labelrank:"6","country-abbrev":"Est.",subregion:"Northern Europe","region-wb":"Europe & Central Asia","iso-a3":"EST","iso-a2":"EE","woe-id":"23424805",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[4876,8444],[4887,8435],[4863,8425],[4852,8441],[4876,8444]]],[[[4897,8446],[4893,8442],[4888,8445],[4892,8448],[4897,8446]]],[[[4893,8464],[4897,8464],[4898,8461],[4891,8461],[4893,8464]]],[[[4878,8463],[4888,8455],[4872,8449],[4858,8459],[4878,8463]]],[[[5026,8462],[5004,8453],[5024,8419],[5021,8411],[5016,8399],[4990,8398],[4954,8422],[4925,8413],[4902,8443],[4901,8472],[4975,8490],[5035,8483],[5038,8482],[5040,8478],[5038,8477],[5035,8477],[5035,8477],[5037,8476],[5037,8476],[5038,8476],[5037,8476],[5034,8476],[5030,8469],[5026,8462]]]]}},{type:"Feature",id:"AG",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.48,"hc-key":"ag","hc-a2":"AG",name:"Antigua and Barbuda",labelrank:"6","country-abbrev":"Ant.B.",subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"ATG","iso-a2":"AG","woe-id":"23424737",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[2371,6989],[2373,6986],[2369,6985],[2367,6988],[2371,6989]]]}},{type:"Feature",id:"TW",properties:{"hc-group":"admin0","hc-middle-x":.49,"hc-middle-y":.41,"hc-key":"tw","hc-a2":"TW",name:"Taiwan",labelrank:"3","country-abbrev":"Taiwan",subregion:"Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"TWN","iso-a2":"TW","woe-id":"23424971",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[7752,7185],[7768,7185],[7797,7233],[7821,7235],[7807,7173],[7790,7136],[7752,7185]]]}},{type:"Feature",id:"BB",properties:{"hc-group":"admin0","hc-middle-x":.31,"hc-middle-y":.56,"hc-key":"bb","hc-a2":"BB",name:"Barbados",labelrank:"5","country-abbrev":"Barb.",subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"BRB","iso-a2":"BB","woe-id":"23424754",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[2438,6866],[2434,6868],[2435,6874],[2440,6869],[2438,6866]]]}},{type:"Feature",id:"IT",properties:{"hc-group":"admin0","hc-middle-x":.79,"hc-middle-y":.71,"hc-key":"it","hc-a2":"IT",name:"Italy",labelrank:"2","country-abbrev":"Italy",subregion:"Southern Europe","region-wb":"Europe & Central Asia","iso-a3":"ITA","iso-a2":"IT","woe-id":"23424853",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[4571,7654],[4668,7666],[4655,7649],[4652,7611],[4634,7616],[4571,7654]]],[[[4484,7768],[4496,7744],[4488,7697],[4454,7690],[4456,7736],[4448,7757],[4484,7768]]],[[[4427,7861],[4400,7909],[4412,7939],[4444,7951],[4466,7944],[4500,7955],[4514,7974],[4566,7982],[4572,7967],[4611,7961],[4601,7952],[4611,7927],[4596,7933],[4565,7916],[4572,7876],[4608,7851],[4622,7818],[4654,7794],[4680,7795],[4677,7778],[4738,7749],[4753,7731],[4710,7744],[4694,7715],[4713,7705],[4681,7655],[4685,7684],[4668,7729],[4611,7770],[4591,7769],[4536,7815],[4504,7869],[4464,7884],[4427,7861]],[[4574,7793],[4574,7793],[4574,7793],[4574,7793],[4574,7793]],[[4574,7865],[4574,7868],[4573,7867],[4572,7866],[4574,7865]]]]}},{type:"Feature",id:"MT",properties:{"hc-group":"admin0","hc-middle-x":.49,"hc-middle-y":.53,"hc-key":"mt","hc-a2":"MT",name:"Malta",labelrank:"5","country-abbrev":"Malta",subregion:"Southern Europe","region-wb":"Middle East & North Africa","iso-a3":"MLT","iso-a2":"MT","woe-id":"23424897",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4628,7589],[4635,7586],[4635,7582],[4631,7584],[4628,7589]]]}},{type:"Feature",id:"VU",properties:{"hc-group":"admin0","hc-middle-x":.6,"hc-middle-y":.53,"hc-key":"vu","hc-a2":"VU",name:"Vanuatu",labelrank:"4","country-abbrev":"Van.",subregion:"Melanesia","region-wb":"East Asia & Pacific","iso-a3":"VUT","iso-a2":"VU","woe-id":"23424907",continent:"Oceania"},geometry:{type:"Polygon",coordinates:[[[9172,6054],[9194,6034],[9205,5976],[9178,5988],[9154,6029],[9172,6054]]]}},{type:"Feature",id:"SG",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.57,"hc-key":"sg","hc-a2":"SG",name:"Singapore",labelrank:"6","country-abbrev":"Sing.",subregion:"South-Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"SGP","iso-a2":"SG","woe-id":"23424948",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[7286,6521],[7290,6519],[7286,6516],[7280,6517],[7286,6521]]]}},{type:"Feature",id:"CY",properties:{"hc-group":"admin0","hc-middle-x":.39,"hc-middle-y":.51,"hc-key":"cy","hc-a2":"CY",name:"Cyprus",labelrank:"5","country-abbrev":"Cyp.",subregion:"Western Asia","region-wb":"Europe & Central Asia","iso-a3":"CYP","iso-a2":"CY","woe-id":"-90",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[5205,7555],[5205,7556],[5206,7556],[5205,7555]]],[[[5214,7557],[5216,7554],[5210,7554],[5207,7557],[5210,7557],[5213,7557],[5214,7557]]],[[[5206,7555],[5206,7555],[5207,7555],[5207,7554],[5206,7555]]],[[[5204,7554],[5201,7549],[5184,7543],[5178,7545],[5176,7544],[5162,7557],[5171,7561],[5172,7560],[5173,7562],[5174,7561],[5175,7561],[5175,7561],[5175,7561],[5175,7561],[5175,7561],[5196,7561],[5204,7555],[5204,7554]]]]}},{type:"Feature",id:"LK",properties:{"hc-group":"admin0","hc-middle-x":.62,"hc-middle-y":.91,"hc-key":"lk","hc-a2":"LK",name:"Sri Lanka",labelrank:"3","country-abbrev":"Sri L.",subregion:"Southern Asia","region-wb":"South Asia","iso-a3":"LKA","iso-a2":"LK","woe-id":"23424778",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[6576,6765],[6600,6755],[6632,6703],[6631,6674],[6596,6654],[6581,6660],[6572,6717],[6584,6759],[6576,6765]]]}},{type:"Feature",id:"KM",properties:{"hc-group":"admin0","hc-middle-x":.41,"hc-middle-y":.51,"hc-key":"km","hc-a2":"KM",name:"Comoros",labelrank:"6","country-abbrev":"Com.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"COM","iso-a2":"KM","woe-id":"23424786",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5494,6125],[5487,6131],[5488,6142],[5492,6141],[5494,6125]]]}},{type:"Feature",id:"FJ",properties:{"hc-group":"admin0","hc-middle-x":.44,"hc-middle-y":.33,"hc-key":"fj","hc-a2":"FJ",name:"Fiji",labelrank:"6","country-abbrev":"Fiji",subregion:"Melanesia","region-wb":"East Asia & Pacific","iso-a3":"FJI","iso-a2":"FJ","woe-id":"23424813",continent:"Oceania"},geometry:{type:"Polygon",coordinates:[[[9460,5963],[9494,5962],[9495,5978],[9543,5996],[9494,5959],[9507,5951],[9500,5915],[9490,5934],[9467,5939],[9460,5963]]]}},{type:"Feature",id:"RU",properties:{"hc-group":"admin0","hc-middle-x":.57,"hc-middle-y":.56,"hc-key":"ru","hc-a2":"RU",name:"Russia",labelrank:"2","country-abbrev":"Rus.",subregion:"Eastern Europe","region-wb":"Europe & Central Asia","iso-a3":"RUS","iso-a2":"RU","woe-id":"23424936",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[8620,7917],[8587,7905],[8565,7884],[8519,7862],[8540,7887],[8614,7923],[8620,7917]]],[[[5691,8936],[5646,8924],[5637,8953],[5666,8965],[5693,8952],[5691,8936]]],[[[5965,9010],[5999,8987],[5972,8976],[5942,8995],[5965,9010]]],[[[6315,9176],[6331,9169],[6278,9157],[6280,9178],[6315,9176]]],[[[7568,9234],[7551,9218],[7512,9233],[7528,9245],[7568,9234]]],[[[5900,9603],[5857,9597],[5866,9613],[5939,9622],[5950,9582],[5900,9603]]],[[[5825,9623],[5819,9605],[5766,9602],[5774,9618],[5819,9609],[5825,9623]]],[[[5870,9665],[5945,9662],[5893,9635],[5861,9633],[5807,9645],[5870,9665]]],[[[6124,9673],[6147,9654],[6077,9637],[6060,9648],[6104,9658],[6124,9673]]],[[[5922,9709],[5937,9692],[5916,9668],[5861,9672],[5922,9709]]],[[[5391,7846],[5361,7874],[5289,7912],[5317,7918],[5327,7959],[5370,7979],[5338,7983],[5356,8011],[5384,8010],[5382,8045],[5395,8064],[5367,8087],[5315,8109],[5262,8106],[5245,8140],[5218,8142],[5225,8161],[5207,8185],[5147,8175],[5131,8212],[5175,8229],[5146,8243],[5121,8317],[5039,8340],[5024,8370],[5016,8399],[5021,8411],[5024,8419],[5030,8439],[5026,8462],[5030,8469],[5033,8474],[5037,8476],[5037,8476],[5035,8477],[5035,8477],[5035,8477],[5037,8476],[5040,8478],[5038,8482],[5035,8483],[5037,8497],[5090,8514],[5029,8531],[5071,8562],[5131,8620],[5141,8638],[5094,8678],[5111,8691],[5082,8737],[5091,8792],[5067,8828],[5095,8871],[5055,8897],[5048,8914],[5063,8940],[5093,8957],[5119,8981],[5155,8989],[5187,8976],[5154,8968],[5271,8947],[5422,8870],[5431,8846],[5404,8806],[5372,8793],[5330,8791],[5199,8822],[5161,8842],[5242,8773],[5227,8755],[5241,8731],[5264,8746],[5302,8746],[5378,8716],[5404,8728],[5386,8767],[5431,8789],[5468,8824],[5515,8780],[5524,8820],[5504,8845],[5517,8900],[5490,8918],[5567,8909],[5591,8879],[5550,8873],[5538,8852],[5564,8831],[5620,8836],[5629,8869],[5652,8873],[5723,8912],[5790,8934],[5806,8904],[5827,8896],[5866,8921],[5905,8916],[5951,8938],[5975,8904],[6011,8945],[5989,8968],[6007,8983],[6107,8967],[6153,8943],[6199,8929],[6230,8904],[6255,8935],[6236,8937],[6223,8964],[6186,8969],[6202,9029],[6176,9027],[6190,9061],[6236,9090],[6251,9138],[6269,9149],[6328,9151],[6366,9139],[6367,9115],[6336,9074],[6361,9051],[6354,9006],[6358,8935],[6389,8913],[6375,8873],[6358,8867],[6328,8819],[6292,8803],[6343,8798],[6385,8827],[6422,8871],[6414,8922],[6471,8938],[6499,8913],[6493,8875],[6522,8899],[6509,8932],[6445,8952],[6393,8949],[6386,8977],[6409,9019],[6371,9068],[6386,9090],[6428,9105],[6421,9150],[6448,9187],[6481,9183],[6445,9141],[6451,9113],[6436,9067],[6512,9052],[6527,9059],[6469,9075],[6459,9094],[6487,9102],[6506,9090],[6515,9116],[6553,9161],[6560,9121],[6630,9083],[6675,9084],[6646,9060],[6663,9044],[6673,9007],[6690,9016],[6671,9058],[6685,9079],[6643,9115],[6599,9130],[6588,9167],[6594,9189],[6788,9206],[6780,9224],[6737,9257],[6785,9249],[6777,9269],[6809,9274],[6873,9307],[6980,9323],[6962,9336],[7011,9336],[7047,9351],[7033,9373],[7059,9393],[7066,9353],[7049,9341],[7067,9325],[7108,9332],[7138,9364],[7197,9366],[7207,9400],[7268,9436],[7313,9439],[7346,9430],[7326,9407],[7393,9388],[7362,9364],[7404,9365],[7407,9378],[7502,9378],[7543,9370],[7546,9346],[7568,9345],[7578,9308],[7544,9323],[7575,9289],[7467,9233],[7411,9192],[7384,9191],[7360,9167],[7401,9165],[7495,9195],[7457,9196],[7469,9214],[7539,9196],[7561,9206],[7571,9185],[7629,9196],[7719,9189],[7716,9172],[7772,9155],[7853,9150],[7870,9168],[7862,9188],[7901,9208],[7905,9196],[7955,9179],[7974,9187],[8045,9157],[8030,9104],[7998,9123],[8055,9053],[8088,9032],[8108,9038],[8137,9093],[8170,9068],[8195,9065],[8239,9079],[8270,9074],[8322,9080],[8360,9070],[8335,9109],[8345,9127],[8405,9143],[8519,9131],[8564,9117],[8534,9111],[8541,9090],[8572,9118],[8644,9108],[8657,9095],[8626,9083],[8700,9063],[8721,9038],[8764,9037],[8832,9050],[8908,9043],[8943,9027],[8955,9004],[8943,8985],[8984,8961],[9072,8979],[9096,8968],[9158,8964],[9197,8992],[9232,8984],[9225,8968],[9192,8975],[9201,8950],[9238,8927],[9278,8941],[9267,8997],[9413,8983],[9467,8971],[9580,8925],[9584,8914],[9685,8870],[9711,8813],[9723,8834],[9791,8834],[9851,8793],[9826,8768],[9778,8763],[9764,8722],[9776,8709],[9742,8703],[9702,8728],[9668,8738],[9667,8757],[9635,8767],[9589,8762],[9555,8796],[9567,8768],[9556,8744],[9493,8721],[9439,8731],[9486,8700],[9495,8707],[9534,8629],[9519,8610],[9488,8621],[9448,8619],[9352,8576],[9308,8545],[9266,8526],[9261,8505],[9227,8532],[9158,8520],[9133,8499],[9142,8528],[9095,8497],[9060,8508],[9046,8484],[9064,8458],[9090,8456],[9056,8438],[9043,8461],[9011,8423],[9051,8406],[9035,8366],[9052,8342],[9016,8339],[9005,8318],[9016,8287],[8954,8259],[8941,8221],[8912,8207],[8886,8153],[8827,8100],[8811,8101],[8856,8131],[8837,8208],[8820,8304],[8835,8366],[8877,8410],[8923,8437],[8948,8468],[9008,8515],[9010,8525],[9072,8567],[9075,8609],[9107,8615],[9089,8628],[9049,8621],[9040,8587],[8957,8532],[8946,8548],[8962,8594],[8877,8587],[8802,8523],[8776,8485],[8810,8470],[8755,8473],[8696,8456],[8678,8483],[8643,8496],[8619,8473],[8474,8481],[8435,8472],[8385,8435],[8373,8412],[8319,8375],[8287,8339],[8217,8288],[8256,8276],[8261,8291],[8303,8293],[8279,8254],[8297,8235],[8321,8264],[8353,8263],[8401,8217],[8372,8113],[8375,8076],[8364,8034],[8337,8008],[8302,7950],[8237,7883],[8214,7850],[8156,7821],[8116,7844],[8083,7807],[8081,7811],[8078,7815],[8091,7827],[8099,7870],[8090,7899],[8121,7913],[8132,7887],[8146,7907],[8178,7951],[8185,7988],[8204,8005],[8192,8031],[8135,8005],[8093,8004],[8086,8027],[8043,8071],[8005,8075],[7935,8210],[7862,8234],[7790,8222],[7766,8201],[7788,8176],[7768,8158],[7740,8107],[7742,8093],[7699,8074],[7667,8086],[7628,8089],[7596,8104],[7559,8077],[7490,8060],[7425,8067],[7407,8090],[7330,8111],[7280,8098],[7239,8117],[7237,8144],[7139,8176],[7106,8132],[7121,8113],[7093,8083],[7011,8094],[7001,8115],[6945,8127],[6810,8061],[6801,8059],[6795,8058],[6774,8077],[6734,8077],[6680,8131],[6621,8121],[6598,8144],[6577,8124],[6515,8222],[6475,8250],[6479,8269],[6407,8235],[6385,8249],[6316,8256],[6306,8305],[6230,8300],[6227,8291],[6139,8266],[6014,8247],[6020,8222],[6045,8216],[6005,8198],[6015,8184],[5989,8167],[6028,8148],[6025,8123],[5983,8125],[5978,8114],[5943,8133],[5881,8134],[5856,8113],[5821,8126],[5787,8152],[5705,8157],[5648,8115],[5641,8085],[5615,8110],[5596,8086],[5600,8062],[5583,8032],[5602,8009],[5630,8008],[5665,7954],[5617,7931],[5591,7892],[5617,7860],[5612,7833],[5646,7791],[5621,7768],[5582,7793],[5534,7823],[5508,7816],[5475,7838],[5391,7846]]],[[[9599,9071],[9621,9058],[9607,9047],[9546,9044],[9510,9034],[9513,9057],[9553,9077],[9599,9071]]],[[[8377,9210],[8419,9208],[8460,9187],[8453,9166],[8373,9183],[8377,9210]]],[[[6937,9577],[6908,9593],[6985,9585],[6953,9568],[6937,9577]]],[[[5596,9641],[5637,9647],[5572,9620],[5542,9634],[5596,9641]]],[[[5995,9655],[6034,9667],[6052,9644],[6016,9618],[5975,9619],[5961,9635],[5995,9655]]],[[[4790,8269],[4810,8280],[4786,8270],[4786,8270],[4795,8288],[4825,8304],[4827,8304],[4814,8290],[4835,8303],[4881,8288],[4880,8266],[4878,8266],[4790,8269]]],[[[7022,9596],[7001,9593],[6984,9590],[6920,9610],[6957,9625],[6965,9659],[7046,9679],[7111,9638],[7088,9634],[7088,9606],[7033,9597],[7100,9602],[7123,9582],[7148,9593],[7170,9569],[7154,9511],[7105,9510],[7077,9522],[7024,9525],[6986,9559],[7022,9596]]],[[[8455,8069],[8434,8017],[8459,7961],[8432,7965],[8421,7938],[8413,7964],[8424,8015],[8417,8049],[8426,8138],[8409,8161],[8411,8226],[8442,8239],[8434,8264],[8456,8217],[8461,8152],[8486,8064],[8455,8069]]],[[[5879,9169],[5847,9116],[5869,9059],[5914,9030],[5900,9017],[5849,9031],[5841,9020],[5786,9037],[5794,9055],[5774,9065],[5778,9046],[5733,9076],[5731,9096],[5759,9104],[5780,9161],[5834,9180],[5879,9169]]],[[[8571,9292],[8608,9297],[8629,9288],[8681,9280],[8673,9266],[8601,9260],[8539,9286],[8548,9307],[8571,9292]]],[[[8399,9343],[8434,9324],[8476,9322],[8518,9303],[8477,9274],[8433,9294],[8437,9278],[8468,9268],[8429,9262],[8413,9272],[8329,9252],[8296,9263],[8266,9294],[8241,9299],[8224,9294],[8230,9324],[8269,9309],[8282,9329],[8326,9346],[8388,9309],[8399,9343]]],[[[6210,9395],[6246,9386],[6250,9367],[6197,9339],[6025,9292],[5959,9239],[5931,9247],[5933,9224],[5888,9170],[5837,9181],[5814,9174],[5796,9199],[5830,9212],[5852,9252],[5897,9296],[5931,9307],[5947,9326],[6017,9337],[6017,9349],[6055,9344],[6104,9352],[6210,9395]]],[[[7197,9509],[7203,9532],[7240,9552],[7265,9544],[7257,9526],[7285,9533],[7322,9512],[7352,9475],[7326,9488],[7282,9474],[7207,9470],[7173,9455],[7150,9460],[7197,9509]]],[[[5588,9611],[5677,9634],[5658,9643],[5699,9660],[5738,9636],[5680,9624],[5695,9590],[5674,9601],[5588,9611]]]]}},{type:"Feature",id:"VA",properties:{"hc-group":"admin0","hc-middle-x":.61,"hc-middle-y":.44,"hc-key":"va","hc-a2":"VA",name:"Vatican",labelrank:"6","country-abbrev":"Vat.",subregion:"Southern Europe","region-wb":"Europe & Central Asia","iso-a3":"VAT","iso-a2":"VA","woe-id":"23424986",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4574,7793],[4574,7793],[4574,7793],[4574,7793],[4574,7793]]]}},{type:"Feature",id:"SM",properties:{"hc-group":"admin0","hc-middle-x":.48,"hc-middle-y":.42,"hc-key":"sm","hc-a2":"SM",name:"San Marino",labelrank:"6","country-abbrev":"S.M.",subregion:"Southern Europe","region-wb":"Europe & Central Asia","iso-a3":"SMR","iso-a2":"SM","woe-id":"23424947",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4574,7865],[4572,7866],[4573,7867],[4574,7868],[4574,7865]]]}},{type:"Feature",id:"KZ",properties:{"hc-group":"admin0","hc-middle-x":.57,"hc-middle-y":.46,"hc-key":"kz","hc-a2":"KZ",name:"Kazakhstan",labelrank:"3","country-abbrev":"Kaz.",subregion:"Central Asia","region-wb":"Europe & Central Asia","iso-a3":"KAZ","iso-a2":"KZ","woe-id":"-90",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[5991,7941],[5960,7930],[5968,7910],[5947,7922],[5952,7928],[5943,7925],[5865,7905],[5865,7773],[5851,7770],[5812,7808],[5792,7800],[5792,7800],[5792,7800],[5792,7800],[5780,7795],[5780,7795],[5780,7795],[5780,7795],[5760,7788],[5768,7823],[5745,7826],[5697,7892],[5729,7917],[5763,7920],[5779,7942],[5779,7975],[5750,7972],[5724,7983],[5665,7954],[5630,8008],[5602,8009],[5583,8032],[5600,8062],[5596,8086],[5615,8110],[5641,8085],[5648,8115],[5705,8157],[5787,8152],[5821,8126],[5856,8113],[5881,8134],[5943,8133],[5978,8114],[5983,8125],[6025,8123],[6028,8148],[5989,8167],[6015,8184],[6005,8198],[6045,8216],[6020,8222],[6014,8247],[6139,8266],[6227,8291],[6230,8300],[6306,8305],[6316,8256],[6385,8249],[6407,8235],[6479,8269],[6475,8250],[6515,8222],[6577,8124],[6598,8144],[6621,8121],[6680,8131],[6734,8077],[6774,8077],[6795,8058],[6750,8032],[6741,7981],[6719,7972],[6668,7986],[6646,7924],[6581,7906],[6602,7838],[6584,7803],[6531,7828],[6435,7827],[6405,7842],[6385,7812],[6336,7826],[6309,7805],[6253,7774],[6240,7747],[6220,7768],[6183,7768],[6178,7796],[6163,7797],[6157,7828],[6131,7858],[6045,7850],[6015,7882],[5986,7899],[5977,7930],[5996,7939],[5991,7941]],[[5995,7942],[5997,7942],[5997,7940],[6021,7950],[5995,7942]]],[[[5693,7900],[5687,7903],[5689,7907],[5698,7908],[5693,7900]]]]}},{type:"Feature",id:"AZ",properties:{"hc-group":"admin0","hc-middle-x":.83,"hc-middle-y":.51,"hc-key":"az","hc-a2":"AZ",name:"Azerbaijan",labelrank:"5","country-abbrev":"Aze.",subregion:"Western Asia","region-wb":"Europe & Central Asia","iso-a3":"AZE","iso-a2":"AZ","woe-id":"23424741",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[5540,7763],[5539,7762],[5538,7764],[5540,7764],[5540,7763]]],[[[5546,7760],[5545,7760],[5545,7761],[5545,7761],[5546,7760]]],[[[5554,7747],[5554,7749],[5556,7749],[5555,7747],[5554,7747]]],[[[5534,7714],[5533,7716],[5563,7710],[5573,7687],[5552,7692],[5534,7714]]],[[[5582,7793],[5621,7768],[5646,7791],[5676,7748],[5654,7672],[5629,7685],[5627,7716],[5584,7687],[5558,7727],[5568,7734],[5539,7771],[5584,7763],[5582,7793]]]]}},{type:"Feature",id:"TJ",properties:{"hc-group":"admin0","hc-middle-x":.28,"hc-middle-y":.56,"hc-key":"tj","hc-a2":"TJ",name:"Tajikistan",labelrank:"4","country-abbrev":"Tjk.",subregion:"Central Asia","region-wb":"Europe & Central Asia","iso-a3":"TJK","iso-a2":"TJ","woe-id":"23424961",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[6300,7759],[6300,7759],[6298,7762],[6299,7761],[6300,7759]]],[[[6300,7721],[6302,7720],[6299,7718],[6296,7722],[6300,7721]]],[[[6389,7707],[6395,7677],[6423,7675],[6426,7631],[6379,7639],[6329,7613],[6329,7653],[6299,7669],[6285,7641],[6259,7626],[6215,7629],[6232,7665],[6225,7691],[6203,7699],[6235,7710],[6264,7754],[6295,7762],[6310,7734],[6280,7734],[6261,7709],[6325,7713],[6348,7698],[6389,7707]]]]}},{type:"Feature",id:"LS",properties:{"hc-group":"admin0","hc-middle-x":.52,"hc-middle-y":.45,"hc-key":"ls","hc-a2":"LS",name:"Lesotho",labelrank:"6","country-abbrev":"Les.",subregion:"Southern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"LSO","iso-a2":"LS","woe-id":"23424880",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5040,5608],[5054,5613],[5078,5588],[5037,5545],[5006,5579],[5040,5608]]]}},{type:"Feature",id:"UZ",properties:{"hc-group":"admin0","hc-middle-x":.46,"hc-middle-y":.53,"hc-key":"uz","hc-a2":"UZ",name:"Uzbekistan",labelrank:"3","country-abbrev":"Uzb.",subregion:"Central Asia","region-wb":"Europe & Central Asia","iso-a3":"UZB","iso-a2":"UZ","woe-id":"23424980",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[6333,7723],[6332,7723],[6331,7724],[6334,7726],[6333,7723]]],[[[6316,7728],[6317,7722],[6312,7722],[6310,7729],[6316,7728]]],[[[5968,7910],[5961,7895],[5982,7876],[5986,7899],[6015,7882],[6045,7850],[6131,7858],[6157,7828],[6163,7797],[6178,7796],[6183,7768],[6220,7768],[6240,7747],[6253,7774],[6309,7805],[6286,7782],[6323,7766],[6333,7777],[6374,7754],[6331,7731],[6310,7734],[6295,7762],[6264,7754],[6235,7710],[6203,7699],[6225,7691],[6232,7665],[6215,7629],[6200,7629],[6178,7635],[6179,7658],[6151,7665],[6057,7726],[6043,7761],[5987,7775],[5981,7807],[5943,7825],[5915,7802],[5908,7809],[5898,7794],[5896,7770],[5865,7773],[5865,7905],[5943,7925],[5934,7884],[5947,7922],[5968,7910]],[[6300,7759],[6299,7761],[6298,7762],[6300,7759],[6300,7759]]]]}},{type:"Feature",id:"MA",properties:{"hc-group":"admin0","hc-middle-x":.6,"hc-middle-y":.21,"hc-key":"ma","hc-a2":"MA",name:"Morocco",labelrank:"3","country-abbrev":"Mor.",subregion:"Northern Africa","region-wb":"Middle East & North Africa","iso-a3":"MAR","iso-a2":"MA","woe-id":"23424893",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4117,7564],[4118,7565],[4119,7560],[4138,7558],[4151,7547],[4154,7497],[4173,7473],[4167,7459],[4129,7460],[4095,7444],[4096,7414],[4033,7378],[3977,7371],[3946,7348],[3946,7316],[3943,7298],[3915,7290],[3866,7291],[3847,7264],[3835,7226],[3788,7182],[3782,7148],[3764,7121],[3699,7120],[3740,7201],[3762,7222],[3774,7267],[3800,7285],[3820,7324],[3863,7337],[3890,7358],[3919,7404],[3912,7436],[3929,7475],[3951,7498],[4002,7523],[4028,7582],[4044,7586],[4044,7585],[4045,7584],[4074,7560],[4116,7566],[4117,7566],[4117,7564]]]}},{type:"Feature",id:"CO",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.54,"hc-key":"co","hc-a2":"CO",name:"Colombia",labelrank:"2","country-abbrev":"Col.",subregion:"South America","region-wb":"Latin America & Caribbean","iso-a3":"COL","iso-a2":"CO","woe-id":"23424787",continent:"South America"},geometry:{type:"Polygon",coordinates:[[[1865,6521],[1868,6543],[1894,6559],[1916,6592],[1909,6611],[1909,6673],[1892,6692],[1914,6713],[1908,6735],[1920,6731],[1960,6758],[1963,6791],[2005,6815],[2029,6813],[2082,6847],[2087,6830],[2068,6824],[2040,6787],[2037,6753],[2056,6726],[2064,6688],[2123,6685],[2143,6659],[2201,6662],[2190,6612],[2207,6580],[2191,6564],[2210,6549],[2219,6515],[2206,6540],[2181,6529],[2131,6529],[2125,6474],[2143,6437],[2128,6354],[2105,6367],[2125,6399],[2096,6414],[2056,6406],[2032,6413],[2019,6442],[1970,6476],[1940,6492],[1905,6498],[1865,6521]]]}},{type:"Feature",id:"TL",properties:{"hc-group":"admin0","hc-middle-x":.65,"hc-middle-y":.36,"hc-key":"tl","hc-a2":"TL",name:"East Timor",labelrank:"5","country-abbrev":"T.L.",subregion:"South-Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"TLS","iso-a2":"TL","woe-id":"23424968",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[7885,6203],[7890,6206],[7897,6207],[7891,6198],[7885,6203]]],[[[7911,6214],[7918,6224],[7972,6233],[7957,6214],[7915,6198],[7912,6206],[7911,6214]]]]}},{type:"Feature",id:"TZ",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.5,"hc-key":"tz","hc-a2":"TZ",name:"United Republic of Tanzania",labelrank:"3","country-abbrev":"Tanz.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"TZA","iso-a2":"TZ","woe-id":"23424973",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5242,6136],[5241,6138],[5240,6141],[5240,6141],[5236,6143],[5235,6145],[5235,6145],[5234,6146],[5227,6185],[5222,6192],[5219,6195],[5219,6195],[5216,6197],[5215,6197],[5215,6198],[5211,6196],[5210,6191],[5195,6195],[5181,6201],[5153,6211],[5129,6225],[5093,6304],[5084,6347],[5118,6383],[5111,6408],[5119,6432],[5108,6447],[5119,6449],[5147,6449],[5147,6448],[5148,6449],[5149,6449],[5151,6407],[5189,6405],[5215,6448],[5321,6389],[5325,6371],[5367,6341],[5387,6324],[5371,6310],[5378,6289],[5372,6221],[5404,6169],[5316,6132],[5242,6136]]]}},{type:"Feature",id:"AR",properties:{"hc-group":"admin0","hc-middle-x":.46,"hc-middle-y":.27,"hc-key":"ar","hc-a2":"AR",name:"Argentina",labelrank:"2","country-abbrev":"Arg.",subregion:"South America","region-wb":"Latin America & Caribbean","iso-a3":"ARG","iso-a2":"AR","woe-id":"23424747",continent:"South America"},geometry:{type:"MultiPolygon",coordinates:[[[[2167,4673],[2169,4670],[2167,4670],[2167,4673]]],[[[2584,5708],[2604,5706],[2606,5658],[2549,5623],[2494,5561],[2477,5505],[2477,5487],[2466,5426],[2509,5387],[2501,5373],[2522,5338],[2495,5295],[2451,5277],[2398,5267],[2362,5269],[2354,5201],[2310,5191],[2278,5207],[2273,5163],[2287,5146],[2312,5158],[2316,5134],[2292,5143],[2292,5126],[2265,5101],[2257,5052],[2239,5053],[2206,5030],[2197,5010],[2222,4978],[2246,4976],[2246,4939],[2199,4902],[2189,4865],[2160,4852],[2151,4826],[2173,4772],[2128,4786],[2070,4787],[2054,4804],[2058,4839],[2032,4835],[2020,4882],[2059,4928],[2051,4944],[2070,4970],[2088,5042],[2066,5062],[2077,5092],[2063,5125],[2075,5158],[2069,5206],[2085,5269],[2101,5277],[2091,5311],[2096,5352],[2115,5366],[2115,5397],[2133,5456],[2109,5516],[2137,5618],[2162,5659],[2177,5666],[2169,5733],[2206,5757],[2210,5794],[2238,5826],[2287,5813],[2295,5792],[2307,5819],[2345,5812],[2394,5763],[2422,5757],[2496,5712],[2465,5653],[2549,5649],[2578,5674],[2584,5708]]],[[[2167,4674],[2167,4761],[2173,4734],[2207,4704],[2250,4679],[2287,4669],[2229,4663],[2209,4666],[2202,4668],[2167,4674]]]]}},{type:"Feature",id:"SA",properties:{"hc-group":"admin0","hc-middle-x":.45,"hc-middle-y":.53,"hc-key":"sa","hc-a2":"SA",name:"Saudi Arabia",labelrank:"2","country-abbrev":"Saud.",subregion:"Western Asia","region-wb":"Middle East & North Africa","iso-a3":"SAU","iso-a2":"SA","woe-id":"23424938",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[5641,7344],[5655,7313],[5692,7284],[5692,7255],[5712,7224],[5717,7218],[5724,7220],[5726,7210],[5734,7208],[5764,7167],[5842,7160],[5855,7137],[5836,7076],[5747,7045],[5662,7034],[5633,7020],[5611,6987],[5544,6998],[5485,6995],[5474,6966],[5427,7036],[5419,7061],[5381,7090],[5364,7117],[5364,7155],[5345,7193],[5318,7209],[5309,7237],[5249,7328],[5230,7330],[5241,7370],[5274,7365],[5331,7407],[5301,7439],[5366,7460],[5404,7453],[5453,7426],[5530,7365],[5585,7362],[5612,7358],[5641,7344]]]}},{type:"Feature",id:"PK",properties:{"hc-group":"admin0","hc-middle-x":.34,"hc-middle-y":.64,"hc-key":"pk","hc-a2":"PK",name:"Pakistan",labelrank:"2","country-abbrev":"Pak.",subregion:"Southern Asia","region-wb":"South Asia","iso-a3":"PAK","iso-a2":"PK","woe-id":"23424922",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[6416,7624],[6459,7605],[6482,7577],[6490,7559],[6453,7539],[6410,7548],[6393,7534],[6400,7495],[6438,7461],[6415,7446],[6416,7427],[6381,7388],[6368,7360],[6337,7325],[6295,7328],[6265,7289],[6313,7222],[6280,7205],[6247,7208],[6227,7195],[6203,7202],[6173,7246],[6088,7238],[6032,7238],[6039,7270],[6076,7283],[6067,7334],[6041,7344],[6010,7386],[6058,7372],[6106,7371],[6168,7385],[6173,7421],[6226,7450],[6261,7454],[6268,7491],[6290,7499],[6281,7523],[6313,7524],[6330,7562],[6316,7590],[6357,7617],[6416,7624]]]}},{type:"Feature",id:"YE",properties:{"hc-group":"admin0","hc-middle-x":.39,"hc-middle-y":.75,"hc-key":"ye","hc-a2":"YE",name:"Yemen",labelrank:"3","country-abbrev":"Yem.",subregion:"Western Asia","region-wb":"Middle East & North Africa","iso-a3":"YEM","iso-a2":"YE","woe-id":"23425002",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[5747,7045],[5769,6994],[5780,6974],[5754,6943],[5675,6916],[5649,6895],[5629,6896],[5590,6877],[5564,6875],[5508,6852],[5494,6859],[5472,6941],[5474,6966],[5485,6995],[5544,6998],[5611,6987],[5633,7020],[5662,7034],[5747,7045]]]}},{type:"Feature",id:"AE",properties:{"hc-group":"admin0","hc-middle-x":.59,"hc-middle-y":.65,"hc-key":"ae","hc-a2":"AE",name:"United Arab Emirates",labelrank:"4","country-abbrev":"U.A.E.",subregion:"Western Asia","region-wb":"Middle East & North Africa","iso-a3":"ARE","iso-a2":"AE","woe-id":"23424738",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[5874,7251],[5877,7248],[5877,7231],[5860,7228],[5842,7160],[5764,7167],[5734,7208],[5810,7205],[5868,7265],[5870,7253],[5874,7251]],[[5874,7239],[5876,7241],[5873,7241],[5873,7238],[5874,7239]]]}},{type:"Feature",id:"KE",properties:{"hc-group":"admin0","hc-middle-x":.87,"hc-middle-y":.7,"hc-key":"ke","hc-a2":"KE",name:"Kenya",labelrank:"2","country-abbrev":"Ken.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"KEN","iso-a2":"KE","woe-id":"23424863",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5367,6341],[5325,6371],[5321,6389],[5215,6448],[5220,6471],[5213,6486],[5242,6527],[5240,6552],[5212,6603],[5255,6627],[5270,6615],[5297,6609],[5335,6585],[5377,6579],[5414,6605],[5447,6596],[5420,6562],[5420,6453],[5437,6429],[5396,6397],[5367,6341]]]}},{type:"Feature",id:"PE",properties:{"hc-group":"admin0","hc-middle-x":.69,"hc-middle-y":.71,"hc-key":"pe","hc-a2":"PE",name:"Peru",labelrank:"2","country-abbrev":"Peru",subregion:"South America","region-wb":"Latin America & Caribbean","iso-a3":"PER","iso-a2":"PE","woe-id":"23424919",continent:"South America"},geometry:{type:"Polygon",coordinates:[[[1970,6476],[2019,6442],[2032,6413],[2056,6406],[2096,6414],[2125,6399],[2105,6367],[2128,6354],[2103,6356],[2040,6327],[2034,6290],[2007,6256],[2061,6183],[2091,6185],[2111,6200],[2108,6153],[2139,6155],[2166,6108],[2153,6073],[2160,6058],[2145,6017],[2126,6008],[2153,5996],[2155,5997],[2157,5996],[2153,5988],[2155,5986],[2137,5964],[2141,5957],[2128,5935],[2115,5932],[2082,5964],[1973,6022],[1940,6061],[1942,6083],[1900,6144],[1860,6236],[1831,6278],[1797,6299],[1793,6354],[1820,6379],[1815,6358],[1858,6331],[1879,6379],[1928,6403],[1961,6433],[1970,6476]]]}},{type:"Feature",id:"DO",properties:{"hc-group":"admin0","hc-middle-x":.46,"hc-middle-y":.38,"hc-key":"do","hc-a2":"DO",name:"Dominican Republic",labelrank:"5","country-abbrev":"Dom. Rep.",subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"DOM","iso-a2":"DO","woe-id":"23424800",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[2070,7030],[2070,7030],[2069,7031],[2069,7031],[2067,7033],[2076,7038],[2075,7067],[2097,7074],[2128,7066],[2138,7048],[2175,7035],[2159,7028],[2106,7028],[2085,7003],[2074,7016],[2076,7025],[2070,7030]]]}},{type:"Feature",id:"HT",properties:{"hc-group":"admin0","hc-middle-x":.82,"hc-middle-y":.96,"hc-key":"ht","hc-a2":"HT",name:"Haiti",labelrank:"5","country-abbrev":"Haiti",subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"HTI","iso-a2":"HT","woe-id":"23424839",continent:"North America"},geometry:{type:"MultiPolygon",coordinates:[[[[2070,7030],[2069,7031],[2069,7031],[2069,7031],[2070,7030]]],[[[2075,7067],[2076,7038],[2067,7033],[2068,7030],[2070,7030],[2076,7025],[2074,7016],[2028,7023],[2011,7016],[2e3,7036],[2046,7028],[2046,7059],[2025,7070],[2075,7067]]]]}},{type:"Feature",id:"PG",properties:{"hc-group":"admin0","hc-middle-x":.14,"hc-middle-y":.5,"hc-key":"pg","hc-a2":"PG",name:"Papua New Guinea",labelrank:"2","country-abbrev":"P.N.G.",subregion:"Melanesia","region-wb":"East Asia & Pacific","iso-a3":"PNG","iso-a2":"PG","woe-id":"23424926",continent:"Oceania"},geometry:{type:"MultiPolygon",coordinates:[[[[8388,6210],[8388,6275],[8388,6402],[8478,6367],[8493,6366],[8531,6335],[8530,6317],[8580,6303],[8592,6281],[8565,6279],[8572,6258],[8600,6241],[8632,6198],[8684,6195],[8676,6166],[8595,6178],[8568,6199],[8539,6240],[8470,6255],[8460,6214],[8437,6203],[8388,6210]]],[[[8654,6406],[8646,6432],[8662,6408],[8716,6383],[8749,6353],[8741,6336],[8723,6373],[8654,6406]]],[[[8645,6292],[8598,6309],[8685,6319],[8703,6332],[8701,6355],[8727,6351],[8719,6320],[8669,6294],[8645,6292]]]]}},{type:"Feature",id:"AO",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.67,"hc-key":"ao","hc-a2":"AO",name:"Angola",labelrank:"3","country-abbrev":"Ang.",subregion:"Middle Africa","region-wb":"Sub-Saharan Africa","iso-a3":"AGO","iso-a2":"AO","woe-id":"23424745",continent:"Africa"},geometry:{type:"MultiPolygon",coordinates:[[[[4566,6309],[4567,6317],[4560,6331],[4583,6349],[4592,6342],[4573,6330],[4566,6309]]],[[[4898,5953],[4821,5941],[4761,5950],[4752,5961],[4618,5960],[4595,5974],[4553,5965],[4553,6009],[4575,6081],[4609,6116],[4613,6163],[4590,6210],[4601,6232],[4568,6298],[4595,6306],[4697,6304],[4708,6263],[4726,6239],[4778,6242],[4783,6272],[4850,6264],[4851,6201],[4862,6185],[4864,6146],[4915,6157],[4916,6093],[4856,6093],[4856,5998],[4898,5953]]]]}},{type:"Feature",id:"KH",properties:{"hc-group":"admin0","hc-middle-x":.84,"hc-middle-y":.49,"hc-key":"kh","hc-a2":"KH",name:"Cambodia",labelrank:"3","country-abbrev":"Camb.",subregion:"South-Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"KHM","iso-a2":"KH","woe-id":"23424776",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[7395,6915],[7395,6844],[7342,6805],[7304,6787],[7279,6789],[7258,6824],[7241,6881],[7280,6907],[7325,6904],[7374,6904],[7395,6915]]]}},{type:"Feature",id:"VN",properties:{"hc-group":"admin0","hc-middle-x":.59,"hc-middle-y":.89,"hc-key":"vn","hc-a2":"VN",name:"Vietnam",labelrank:"2","country-abbrev":"Viet.",subregion:"South-Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"VNM","iso-a2":"VN","woe-id":"23424984",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[7304,6787],[7342,6805],[7395,6844],[7395,6915],[7399,6932],[7365,6984],[7311,7039],[7286,7055],[7319,7079],[7292,7106],[7264,7103],[7260,7125],[7234,7150],[7245,7162],[7289,7154],[7329,7180],[7372,7161],[7366,7149],[7409,7122],[7377,7105],[7350,7076],[7338,7046],[7368,6999],[7432,6936],[7452,6861],[7439,6815],[7387,6786],[7371,6790],[7364,6761],[7313,6739],[7314,6781],[7304,6787]]]}},{type:"Feature",id:"MZ",properties:{"hc-group":"admin0","hc-middle-x":.83,"hc-middle-y":.28,"hc-key":"mz","hc-a2":"MZ",name:"Mozambique",labelrank:"3","country-abbrev":"Moz.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"MOZ","iso-a2":"MZ","woe-id":"23424902",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5238,6078],[5234,6118],[5242,6136],[5316,6132],[5404,6169],[5416,6039],[5388,5991],[5305,5946],[5239,5885],[5233,5868],[5258,5816],[5246,5739],[5205,5723],[5169,5696],[5180,5668],[5164,5667],[5157,5668],[5155,5685],[5152,5696],[5153,5744],[5133,5807],[5166,5841],[5184,5880],[5176,5898],[5185,5932],[5182,5982],[5106,6014],[5101,6034],[5189,6063],[5202,6045],[5223,6052],[5220,6006],[5247,5987],[5266,6002],[5268,6044],[5238,6078]]]}},{type:"Feature",id:"CR",properties:{"hc-group":"admin0","hc-middle-x":.55,"hc-middle-y":.31,"hc-key":"cr","hc-a2":"CR",name:"Costa Rica",labelrank:"5","country-abbrev":"C.R.",subregion:"Central America","region-wb":"Latin America & Caribbean","iso-a3":"CRI","iso-a2":"CR","woe-id":"23424791",continent:"North America"},geometry:{type:"MultiPolygon",coordinates:[[[[1722,6802],[1727,6789],[1754,6762],[1740,6726],[1740,6726],[1736,6734],[1656,6785],[1661,6807],[1701,6804],[1722,6802]]],[[[1744,6716],[1739,6725],[1740,6725],[1740,6725],[1744,6716]]]]}},{type:"Feature",id:"BJ",properties:{"hc-group":"admin0","hc-middle-x":.57,"hc-middle-y":.49,"hc-key":"bj","hc-a2":"BJ",name:"Benin",labelrank:"5","country-abbrev":"Benin",subregion:"Western Africa","region-wb":"Sub-Saharan Africa","iso-a3":"BEN","iso-a2":"BJ","woe-id":"23424764",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4311,6825],[4318,6792],[4286,6746],[4284,6667],[4260,6664],[4252,6662],[4252,6746],[4231,6804],[4247,6818],[4275,6831],[4288,6846],[4311,6825]]]}},{type:"Feature",id:"NG",properties:{"hc-group":"admin0","hc-middle-x":.36,"hc-middle-y":.33,"hc-key":"ng","hc-a2":"NG",name:"Nigeria",labelrank:"2","country-abbrev":"Nigeria",subregion:"Western Africa","region-wb":"Sub-Saharan Africa","iso-a3":"NGA","iso-a2":"NG","woe-id":"23424908",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4284,6667],[4286,6746],[4318,6792],[4311,6825],[4326,6878],[4368,6891],[4410,6864],[4436,6874],[4490,6859],[4504,6872],[4543,6875],[4574,6866],[4608,6885],[4621,6866],[4639,6839],[4567,6725],[4540,6669],[4518,6689],[4466,6651],[4459,6621],[4388,6605],[4370,6615],[4335,6666],[4284,6667]]]}},{type:"Feature",id:"IR",properties:{"hc-group":"admin0","hc-middle-x":.58,"hc-middle-y":.51,"hc-key":"ir","hc-a2":"IR",name:"Iran",labelrank:"2","country-abbrev":"Iran",subregion:"Southern Asia","region-wb":"Middle East & North Africa","iso-a3":"IRN","iso-a2":"IR","woe-id":"23424851",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[5532,7628],[5516,7656],[5510,7704],[5534,7714],[5552,7692],[5573,7687],[5580,7689],[5584,7687],[5627,7716],[5629,7685],[5654,7672],[5659,7648],[5694,7636],[5720,7614],[5744,7609],[5807,7617],[5804,7634],[5849,7660],[5902,7666],[5906,7656],[5949,7646],[5995,7610],[6020,7608],[6022,7576],[6001,7491],[6009,7439],[6035,7435],[6038,7418],[6010,7386],[6041,7344],[6067,7334],[6076,7283],[6039,7270],[6032,7238],[5982,7242],[5905,7256],[5896,7290],[5876,7301],[5830,7279],[5729,7324],[5690,7397],[5657,7404],[5644,7390],[5619,7423],[5623,7448],[5611,7469],[5577,7487],[5551,7521],[5579,7582],[5549,7589],[5532,7628]]]}},{type:"Feature",id:"SV",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.55,"hc-key":"sv","hc-a2":"SV",name:"El Salvador",labelrank:"6","country-abbrev":"El. S.",subregion:"Central America","region-wb":"Latin America & Caribbean","iso-a3":"SLV","iso-a2":"SV","woe-id":"23424807",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[1598,6876],[1569,6871],[1530,6886],[1530,6889],[1552,6907],[1601,6889],[1598,6876]]]}},{type:"Feature",id:"SL",properties:{"hc-group":"admin0","hc-middle-x":.48,"hc-middle-y":.48,"hc-key":"sl","hc-a2":"SL",name:"Sierra Leone",labelrank:"4","country-abbrev":"S.L.",subregion:"Western Africa","region-wb":"Sub-Saharan Africa","iso-a3":"SLE","iso-a2":"SL","woe-id":"23424946",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[3863,6683],[3820,6702],[3809,6746],[3833,6770],[3870,6774],[3899,6729],[3889,6708],[3863,6683]]]}},{type:"Feature",id:"GW",properties:{"hc-group":"admin0","hc-middle-x":.55,"hc-middle-y":.49,"hc-key":"gw","hc-a2":"GW",name:"Guinea Bissau",labelrank:"6","country-abbrev":"GnB.",subregion:"Western Africa","region-wb":"Sub-Saharan Africa","iso-a3":"GNB","iso-a2":"GW","woe-id":"23424929",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[3758,6803],[3732,6811],[3708,6844],[3753,6854],[3797,6854],[3797,6825],[3767,6819],[3758,6803]]]}},{type:"Feature",id:"HR",properties:{"hc-group":"admin0","hc-middle-x":.35,"hc-middle-y":.59,"hc-key":"hr","hc-a2":"HR",name:"Croatia",labelrank:"6","country-abbrev":"Cro.",subregion:"Southern Europe","region-wb":"Europe & Central Asia","iso-a3":"HRV","iso-a2":"HR","woe-id":"23424843",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[4753,7811],[4732,7826],[4728,7828],[4734,7826],[4751,7816],[4751,7814],[4753,7811]]],[[[4607,7923],[4659,7921],[4668,7949],[4694,7960],[4719,7940],[4765,7939],[4769,7910],[4768,7900],[4706,7915],[4672,7911],[4685,7876],[4726,7830],[4699,7837],[4645,7875],[4645,7908],[4619,7898],[4607,7923]]]]}},{type:"Feature",id:"BZ",properties:{"hc-group":"admin0","hc-middle-x":.53,"hc-middle-y":.5,"hc-key":"bz","hc-a2":"BZ",name:"Belize",labelrank:"6","country-abbrev":"Belize",subregion:"Central America","region-wb":"Latin America & Caribbean","iso-a3":"BLZ","iso-a2":"BZ","woe-id":"23424760",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[1558,7009],[1567,7012],[1583,7030],[1586,6984],[1565,6951],[1556,6951],[1558,7009]]]}},{type:"Feature",id:"ZA",properties:{"hc-group":"admin0","hc-middle-x":.36,"hc-middle-y":.7,"hc-key":"za","hc-a2":"ZA",name:"South Africa",labelrank:"2","country-abbrev":"S.Af.",subregion:"Southern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"ZAF","iso-a2":"ZA","woe-id":"23424942",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5157,5668],[5164,5667],[5180,5668],[5165,5613],[5129,5581],[5106,5539],[5061,5492],[5008,5451],[4942,5430],[4874,5436],[4854,5424],[4787,5410],[4753,5441],[4733,5474],[4746,5480],[4744,5511],[4717,5555],[4693,5613],[4711,5630],[4720,5608],[4771,5600],[4797,5617],[4797,5734],[4822,5690],[4818,5666],[4847,5667],[4878,5695],[4887,5716],[4941,5700],[4963,5706],[4972,5734],[5e3,5749],[5006,5769],[5041,5799],[5075,5814],[5104,5809],[5133,5807],[5153,5744],[5152,5696],[5137,5702],[5118,5682],[5128,5656],[5157,5668]],[[5040,5608],[5006,5579],[5037,5545],[5078,5588],[5054,5613],[5040,5608]]]}},{type:"Feature",id:"CF",properties:{"hc-group":"admin0","hc-middle-x":.47,"hc-middle-y":.46,"hc-key":"cf","hc-a2":"CF",name:"Central African Republic",labelrank:"4","country-abbrev":"C.A.R.",subregion:"Middle Africa","region-wb":"Sub-Saharan Africa","iso-a3":"CAF","iso-a2":"CF","woe-id":"23424792",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4882,6802],[4906,6770],[4901,6738],[4921,6735],[4956,6696],[4987,6675],[4988,6658],[5018,6628],[4963,6637],[4872,6602],[4815,6609],[4789,6630],[4754,6606],[4757,6581],[4722,6588],[4696,6581],[4685,6545],[4682,6562],[4654,6590],[4631,6657],[4663,6701],[4702,6702],[4756,6716],[4771,6745],[4810,6749],[4870,6804],[4882,6802]]]}},{type:"Feature",id:"SD",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.38,"hc-key":"sd","hc-a2":"SD",name:"Sudan",labelrank:"3","country-abbrev":"Sudan",subregion:"Northern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"SDN","iso-a2":"SD","woe-id":"-90",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4921,6735],[4901,6738],[4906,6770],[4882,6802],[4863,6856],[4859,6887],[4873,6898],[4889,6945],[4916,6946],[4916,7061],[4916,7076],[4945,7076],[4945,7138],[5131,7138],[5299,7138],[5310,7102],[5318,7037],[5350,7015],[5302,6987],[5285,6928],[5288,6902],[5276,6855],[5263,6854],[5238,6796],[5230,6801],[5215,6758],[5189,6800],[5190,6840],[5156,6834],[5166,6806],[5131,6768],[5095,6783],[5060,6754],[4992,6760],[4970,6787],[4948,6783],[4921,6735]]]}},{type:"Feature",id:"CD",properties:{"hc-group":"admin0","hc-middle-x":.58,"hc-middle-y":.42,"hc-key":"cd","hc-a2":"CD",name:"Democratic Republic of the Congo",labelrank:"2","country-abbrev":"D.R.C.",subregion:"Middle Africa","region-wb":"Sub-Saharan Africa","iso-a3":"COD","iso-a2":"CD","woe-id":"23424780",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5071,6380],[5067,6329],[5079,6281],[5111,6236],[5061,6228],[5045,6210],[5050,6201],[5056,6189],[5046,6140],[5066,6112],[5088,6119],[5088,6081],[5070,6080],[5011,6136],[4996,6123],[4956,6134],[4955,6147],[4925,6142],[4915,6157],[4864,6146],[4862,6185],[4851,6201],[4850,6264],[4783,6272],[4778,6242],[4726,6239],[4708,6263],[4697,6304],[4595,6306],[4573,6300],[4566,6309],[4573,6330],[4592,6342],[4631,6353],[4644,6337],[4685,6381],[4686,6416],[4731,6463],[4740,6542],[4757,6581],[4754,6606],[4789,6630],[4815,6609],[4872,6602],[4963,6637],[5018,6628],[5046,6605],[5088,6613],[5119,6582],[5115,6551],[5132,6543],[5109,6523],[5108,6515],[5093,6503],[5085,6476],[5074,6464],[5084,6465],[5081,6452],[5082,6438],[5075,6434],[5071,6429],[5063,6421],[5061,6406],[5061,6400],[5065,6398],[5072,6389],[5071,6380]]]}},{type:"Feature",id:"KW",properties:{"hc-group":"admin0","hc-middle-x":.61,"hc-middle-y":.4,"hc-key":"kw","hc-a2":"KW",name:"Kuwait",labelrank:"6","country-abbrev":"Kwt.",subregion:"Western Asia","region-wb":"Middle East & North Africa","iso-a3":"KWT","iso-a2":"KW","woe-id":"23424870",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[5641,7344],[5612,7358],[5585,7362],[5602,7390],[5627,7391],[5631,7370],[5641,7344]]]}},{type:"Feature",id:"DE",properties:{"hc-group":"admin0","hc-middle-x":.52,"hc-middle-y":.34,"hc-key":"de","hc-a2":"DE",name:"Germany",labelrank:"2","country-abbrev":"Ger.",subregion:"Western Europe","region-wb":"Europe & Central Asia","iso-a3":"DEU","iso-a2":"DE","woe-id":"23424829",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[4477,8004],[4477,8003],[4477,8003],[4477,8004]]],[[[4461,8288],[4466,8289],[4484,8285],[4544,8248],[4575,8271],[4609,8275],[4620,8254],[4626,8249],[4625,8248],[4625,8247],[4621,8251],[4627,8239],[4623,8205],[4639,8194],[4644,8126],[4575,8108],[4571,8083],[4614,8045],[4582,8021],[4591,7997],[4565,8005],[4530,7993],[4492,7999],[4473,8009],[4477,8004],[4455,8001],[4429,8001],[4447,8053],[4392,8072],[4397,8085],[4386,8097],[4393,8105],[4382,8122],[4393,8164],[4412,8180],[4417,8221],[4422,8240],[4458,8233],[4471,8247],[4461,8288]]]]}},{type:"Feature",id:"BE",properties:{"hc-group":"admin0","hc-middle-x":.54,"hc-middle-y":.4,"hc-key":"be","hc-a2":"BE",name:"Belgium",labelrank:"2","country-abbrev":"Belg.",subregion:"Western Europe","region-wb":"Europe & Central Asia","iso-a3":"BEL","iso-a2":"BE","woe-id":"23424757",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4382,8122],[4393,8105],[4386,8097],[4374,8088],[4376,8075],[4327,8092],[4279,8135],[4297,8145],[4303,8146],[4317,8140],[4329,8146],[4331,8144],[4330,8146],[4353,8150],[4382,8122]]]}},{type:"Feature",id:"IE",properties:{"hc-group":"admin0","hc-middle-x":.45,"hc-middle-y":.48,"hc-key":"ie","hc-a2":"IE",name:"Ireland",labelrank:"3","country-abbrev":"Ire.",subregion:"Northern Europe","region-wb":"Europe & Central Asia","iso-a3":"IRL","iso-a2":"IE","woe-id":"23424803",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[3989,8295],[3961,8270],[3987,8256],[4018,8256],[4026,8209],[4015,8179],[3979,8174],[3946,8154],[3913,8149],[3895,8167],[3939,8222],[3907,8226],[3912,8265],[3948,8262],[3958,8299],[3989,8295]]]}},{type:"Feature",id:"KP",properties:{"hc-group":"admin0","hc-middle-x":.32,"hc-middle-y":.63,"hc-key":"kp","hc-a2":"KP",name:"North Korea",labelrank:"3","country-abbrev":"N.K.",subregion:"Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"PRK","iso-a2":"KP","woe-id":"23424865",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[8083,7807],[8051,7781],[8053,7755],[7988,7717],[7986,7697],[8013,7678],[7978,7667],[7963,7651],[7931,7658],[7924,7646],[7907,7675],[7927,7702],[7895,7730],[7943,7758],[7962,7785],[8007,7774],[8004,7796],[8053,7812],[8057,7831],[8078,7815],[8081,7811],[8083,7807]]]}},{type:"Feature",id:"KR",properties:{"hc-group":"admin0","hc-middle-x":.54,"hc-middle-y":.5,"hc-key":"kr","hc-a2":"KR",name:"South Korea",labelrank:"2","country-abbrev":"S.K.",subregion:"Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"KOR","iso-a2":"KR","woe-id":"23424868",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[7963,7651],[7978,7667],[8013,7678],[8042,7632],[8046,7573],[8021,7546],[8004,7553],[7987,7536],[7955,7542],[7963,7651]]]}},{type:"Feature",id:"GY",properties:{"hc-group":"admin0","hc-middle-x":.26,"hc-middle-y":.07,"hc-key":"gy","hc-a2":"GY",name:"Guyana",labelrank:"4","country-abbrev":"Guy.",subregion:"South America","region-wb":"Latin America & Caribbean","iso-a3":"GUY","iso-a2":"GY","woe-id":"23424836",continent:"South America"},geometry:{type:"Polygon",coordinates:[[[2423,6732],[2450,6715],[2507,6658],[2505,6641],[2481,6602],[2528,6536],[2509,6538],[2459,6514],[2431,6534],[2423,6558],[2437,6595],[2424,6629],[2401,6632],[2382,6653],[2387,6672],[2415,6689],[2408,6709],[2423,6732]]]}},{type:"Feature",id:"HN",properties:{"hc-group":"admin0","hc-middle-x":.71,"hc-middle-y":.09,"hc-key":"hn","hc-a2":"HN",name:"Honduras",labelrank:"5","country-abbrev":"Hond.",subregion:"Central America","region-wb":"Latin America & Caribbean","iso-a3":"HND","iso-a2":"HN","woe-id":"23424841",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[1586,6946],[1654,6955],[1702,6949],[1737,6924],[1688,6919],[1660,6893],[1630,6887],[1613,6864],[1607,6873],[1598,6876],[1601,6889],[1552,6907],[1558,6926],[1586,6946]]]}},{type:"Feature",id:"MM",properties:{"hc-group":"admin0","hc-middle-x":.17,"hc-middle-y":.49,"hc-key":"mm","hc-a2":"MM",name:"Myanmar",labelrank:"3","country-abbrev":"Myan.",subregion:"South-Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"MMR","iso-a2":"MM","woe-id":"23424763",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[6942,7109],[6953,7116],[6951,7137],[6969,7150],[6973,7200],[6996,7195],[7023,7255],[7024,7278],[7074,7306],[7092,7333],[7098,7343],[7132,7313],[7133,7260],[7103,7234],[7101,7195],[7130,7203],[7138,7175],[7157,7171],[7146,7143],[7170,7139],[7177,7120],[7206,7124],[7193,7117],[7175,7086],[7128,7066],[7113,7070],[7095,7030],[7137,6959],[7119,6918],[7146,6886],[7161,6829],[7134,6785],[7129,6870],[7106,6921],[7102,6963],[7088,6985],[7036,6946],[7e3,6955],[7012,7001],[6993,7058],[6965,7077],[6942,7109]]]}},{type:"Feature",id:"GA",properties:{"hc-group":"admin0","hc-middle-x":.36,"hc-middle-y":.65,"hc-key":"ga","hc-a2":"GA",name:"Gabon",labelrank:"4","country-abbrev":"Gabon",subregion:"Middle Africa","region-wb":"Sub-Saharan Africa","iso-a3":"GAB","iso-a2":"GA","woe-id":"23424822",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4495,6508],[4540,6508],[4540,6543],[4541,6547],[4599,6542],[4597,6515],[4633,6506],[4614,6473],[4634,6461],[4622,6405],[4573,6423],[4547,6410],[4555,6369],[4534,6363],[4479,6425],[4462,6461],[4479,6467],[4480,6495],[4495,6508]]]}},{type:"Feature",id:"GQ",properties:{"hc-group":"admin0","hc-middle-x":.53,"hc-middle-y":.55,"hc-key":"gq","hc-a2":"GQ",name:"Equatorial Guinea",labelrank:"4","country-abbrev":"Eq. G.",subregion:"Middle Africa","region-wb":"Sub-Saharan Africa","iso-a3":"GNQ","iso-a2":"GQ","woe-id":"23424804",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4540,6543],[4540,6508],[4495,6508],[4481,6514],[4495,6548],[4500,6543],[4540,6543]]]}},{type:"Feature",id:"NI",properties:{"hc-group":"admin0","hc-middle-x":.84,"hc-middle-y":.5,"hc-key":"ni","hc-a2":"NI",name:"Nicaragua",labelrank:"5","country-abbrev":"Nic.",subregion:"Central America","region-wb":"Latin America & Caribbean","iso-a3":"NIC","iso-a2":"NI","woe-id":"23424915",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[1661,6807],[1603,6860],[1613,6864],[1630,6887],[1660,6893],[1688,6919],[1737,6924],[1715,6816],[1722,6802],[1701,6804],[1661,6807]]]}},{type:"Feature",id:"LV",properties:{"hc-group":"admin0","hc-middle-x":.05,"hc-middle-y":.36,"hc-key":"lv","hc-a2":"LV",name:"Latvia",labelrank:"5","country-abbrev":"Lat.",subregion:"Northern Europe","region-wb":"Europe & Central Asia","iso-a3":"LVA","iso-a2":"LV","woe-id":"23424874",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[5016,8399],[5024,8370],[5039,8340],[5023,8325],[4993,8320],[4942,8353],[4929,8345],[4860,8352],[4829,8337],[4829,8370],[4849,8401],[4875,8408],[4907,8375],[4927,8386],[4925,8413],[4954,8422],[4990,8398],[5016,8399]]]}},{type:"Feature",id:"UG",properties:{"hc-group":"admin0","hc-middle-x":.16,"hc-middle-y":.56,"hc-key":"ug","hc-a2":"UG",name:"Uganda",labelrank:"3","country-abbrev":"Uga.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"UGA","iso-a2":"UG","woe-id":"23424974",continent:"Africa"},geometry:{type:"MultiPolygon",coordinates:[[[[5148,6449],[5148,6450],[5149,6449],[5148,6449]]],[[[5082,6438],[5081,6452],[5084,6465],[5091,6474],[5085,6476],[5093,6503],[5108,6515],[5136,6535],[5132,6543],[5115,6551],[5119,6582],[5198,6589],[5212,6603],[5240,6552],[5242,6527],[5213,6486],[5171,6483],[5147,6449],[5119,6449],[5108,6447],[5092,6435],[5082,6438]]]]}},{type:"Feature",id:"MW",properties:{"hc-group":"admin0","hc-middle-x":.16,"hc-middle-y":.29,"hc-key":"mw","hc-a2":"MW",name:"Malawi",labelrank:"6","country-abbrev":"Mal.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"MWI","iso-a2":"MW","woe-id":"23424889",continent:"Africa"},geometry:{type:"MultiPolygon",coordinates:[[[[5240,6141],[5240,6141],[5240,6141],[5240,6141]]],[[[5235,6145],[5235,6146],[5234,6146],[5235,6145],[5235,6145]]],[[[5222,6192],[5219,6195],[5219,6195],[5222,6192]]],[[[5216,6197],[5215,6198],[5215,6197],[5216,6197]]],[[[5181,6201],[5195,6195],[5210,6191],[5223,6133],[5222,6082],[5238,6078],[5268,6044],[5266,6002],[5247,5987],[5220,6006],[5223,6052],[5202,6045],[5189,6063],[5178,6072],[5194,6107],[5190,6157],[5203,6166],[5181,6201]]]]}},{type:"Feature",id:"AM",properties:{"hc-group":"admin0","hc-middle-x":.1,"hc-middle-y":.12,"hc-key":"am","hc-a2":"AM",name:"Armenia",labelrank:"6","country-abbrev":"Arm.",subregion:"Western Asia","region-wb":"Europe & Central Asia","iso-a3":"ARM","iso-a2":"AM","woe-id":"23424743",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[5584,7687],[5580,7689],[5573,7687],[5563,7710],[5533,7716],[5500,7730],[5493,7765],[5515,7769],[5539,7771],[5568,7734],[5558,7727],[5584,7687]],[[5540,7763],[5540,7764],[5538,7764],[5539,7762],[5540,7763]],[[5546,7760],[5545,7761],[5545,7761],[5545,7760],[5546,7760]],[[5554,7747],[5555,7747],[5556,7749],[5554,7749],[5554,7747]]]}},{type:"Feature",id:"SX",properties:{"hc-group":"admin0","hc-middle-x":.76,"hc-middle-y":.53,"hc-key":"sx","hc-a2":"SX",name:"Somaliland",labelrank:"5","country-abbrev":"Solnd.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"-99","iso-a2":"SX","woe-id":"-99",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5487,6819],[5518,6788],[5562,6801],[5582,6795],[5611,6810],[5656,6812],[5656,6758],[5628,6715],[5598,6715],[5510,6744],[5470,6793],[5478,6804],[5487,6819]]]}},{type:"Feature",id:"TM",properties:{"hc-group":"admin0","hc-middle-x":.4,"hc-middle-y":.42,"hc-key":"tm","hc-a2":"TM",name:"Turkmenistan",labelrank:"4","country-abbrev":"Turkm.",subregion:"Central Asia","region-wb":"Europe & Central Asia","iso-a3":"TKM","iso-a2":"TM","woe-id":"23424972",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[5898,7794],[5921,7785],[5915,7802],[5943,7825],[5981,7807],[5987,7775],[6043,7761],[6057,7726],[6151,7665],[6179,7658],[6178,7635],[6156,7642],[6126,7626],[6117,7598],[6052,7560],[6022,7576],[6020,7608],[5995,7610],[5949,7646],[5906,7656],[5902,7666],[5849,7660],[5804,7634],[5806,7688],[5794,7724],[5769,7728],[5775,7760],[5798,7748],[5828,7765],[5803,7799],[5792,7800],[5792,7800],[5812,7808],[5851,7770],[5865,7773],[5896,7770],[5898,7794]]],[[[5780,7795],[5782,7800],[5792,7800],[5792,7800],[5780,7795],[5780,7795],[5780,7795]]],[[[5780,7795],[5771,7775],[5760,7788],[5780,7795],[5780,7795],[5780,7795]]]]}},{type:"Feature",id:"ZM",properties:{"hc-group":"admin0","hc-middle-x":.36,"hc-middle-y":.58,"hc-key":"zm","hc-a2":"ZM",name:"Zambia",labelrank:"3","country-abbrev":"Zambia",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"ZMB","iso-a2":"ZM","woe-id":"23425003",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5050,6201],[5069,6222],[5061,6228],[5111,6236],[5125,6219],[5129,6225],[5153,6211],[5181,6201],[5203,6166],[5190,6157],[5194,6107],[5178,6072],[5189,6063],[5101,6034],[5106,6014],[5060,6001],[5058,5987],[5038,5977],[5022,5969],[5006,5944],[4996,5940],[4954,5949],[4923,5958],[4898,5953],[4856,5998],[4856,6093],[4916,6093],[4915,6157],[4925,6142],[4955,6147],[4956,6134],[4996,6123],[5011,6136],[5070,6080],[5088,6081],[5088,6119],[5066,6112],[5046,6140],[5056,6189],[5050,6201]]]}},{type:"Feature",id:"NC",properties:{"hc-group":"admin0","hc-middle-x":.56,"hc-middle-y":.71,"hc-key":"nc","hc-a2":"NC",name:"Northern Cyprus",labelrank:"6","country-abbrev":"N. Cy.",subregion:"Western Asia","region-wb":"Europe & Central Asia","iso-a3":"-99","iso-a2":"NC","woe-id":"-90",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[5210,7558],[5206,7556],[5203,7556],[5196,7562],[5175,7561],[5175,7561],[5175,7561],[5175,7561],[5175,7561],[5175,7561],[5231,7579],[5213,7557],[5210,7558]]],[[[5171,7561],[5173,7562],[5172,7561],[5171,7561]]]]}},{type:"Feature",id:"MR",properties:{"hc-group":"admin0","hc-middle-x":.61,"hc-middle-y":.63,"hc-key":"mr","hc-a2":"MR",name:"Mauritania",labelrank:"3","country-abbrev":"Mrt.",subregion:"Western Africa","region-wb":"Sub-Saharan Africa","iso-a3":"MRT","iso-a2":"MR","woe-id":"23424896",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[3946,7304],[4040,7245],[4061,7231],[4008,7231],[4040,6939],[3886,6937],[3856,6941],[3840,6917],[3779,6974],[3719,6968],[3713,6949],[3728,7014],[3714,7058],[3723,7083],[3698,7100],[3701,7117],[3818,7117],[3818,7170],[3847,7183],[3847,7263],[3946,7263],[3946,7304]]]}},{type:"Feature",id:"DZ",properties:{"hc-group":"admin0","hc-middle-x":.63,"hc-middle-y":.5,"hc-key":"dz","hc-a2":"DZ",name:"Algeria",labelrank:"3","country-abbrev":"Alg.",subregion:"Northern Africa","region-wb":"Middle East & North Africa","iso-a3":"DZA","iso-a2":"DZ","woe-id":"23424740",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4061,7231],[4040,7245],[3946,7304],[3946,7316],[3946,7348],[3977,7371],[4033,7378],[4096,7414],[4095,7444],[4129,7460],[4167,7459],[4173,7473],[4154,7497],[4151,7547],[4138,7558],[4235,7605],[4291,7616],[4346,7619],[4359,7611],[4423,7626],[4459,7621],[4452,7604],[4448,7543],[4426,7518],[4451,7473],[4472,7458],[4486,7398],[4496,7363],[4496,7279],[4483,7267],[4502,7227],[4546,7209],[4559,7185],[4426,7103],[4376,7059],[4329,7050],[4296,7050],[4299,7070],[4260,7083],[4238,7110],[4061,7231]]]}},{type:"Feature",id:"LT",properties:{"hc-group":"admin0","hc-middle-x":.27,"hc-middle-y":.06,"hc-key":"lt","hc-a2":"LT",name:"Lithuania",labelrank:"5","country-abbrev":"Lith.",subregion:"Northern Europe","region-wb":"Europe & Central Asia","iso-a3":"LTU","iso-a2":"LT","woe-id":"23424875",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[4835,8303],[4832,8321],[4829,8337],[4860,8352],[4929,8345],[4942,8353],[4993,8320],[4998,8305],[4972,8290],[4960,8264],[4927,8247],[4901,8249],[4900,8258],[4880,8266],[4881,8288],[4835,8303]]],[[[4825,8304],[4830,8313],[4827,8304],[4825,8304]]]]}},{type:"Feature",id:"ET",properties:{"hc-group":"admin0","hc-middle-x":.45,"hc-middle-y":.58,"hc-key":"et","hc-a2":"ET",name:"Ethiopia",labelrank:"2","country-abbrev":"Eth.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"ETH","iso-a2":"ET","woe-id":"23424808",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5444,6813],[5441,6810],[5444,6807],[5449,6802],[5478,6804],[5470,6793],[5510,6744],[5598,6715],[5628,6715],[5538,6624],[5509,6625],[5447,6596],[5414,6605],[5377,6579],[5335,6585],[5297,6609],[5270,6615],[5235,6675],[5205,6705],[5185,6709],[5190,6729],[5211,6728],[5215,6758],[5230,6801],[5238,6796],[5263,6854],[5276,6855],[5288,6902],[5328,6921],[5416,6897],[5462,6848],[5443,6820],[5444,6813]]]}},{type:"Feature",id:"ER",properties:{"hc-group":"admin0","hc-middle-x":.29,"hc-middle-y":.05,"hc-key":"er","hc-a2":"ER",name:"Eritrea",labelrank:"4","country-abbrev":"Erit.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"ERI","iso-a2":"ER","woe-id":"23424806",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5462,6848],[5416,6897],[5328,6921],[5288,6902],[5285,6928],[5302,6987],[5350,7015],[5382,6928],[5426,6913],[5484,6855],[5471,6845],[5462,6848]]]}},{type:"Feature",id:"GH",properties:{"hc-group":"admin0","hc-middle-x":.13,"hc-middle-y":.77,"hc-key":"gh","hc-a2":"GH",name:"Ghana",labelrank:"3","country-abbrev":"Ghana",subregion:"Western Africa","region-wb":"Sub-Saharan Africa","iso-a3":"GHA","iso-a2":"GH","woe-id":"23424824",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4239,6659],[4142,6618],[4111,6629],[4112,6629],[4116,6629],[4120,6631],[4108,6681],[4130,6721],[4124,6759],[4122,6804],[4199,6808],[4215,6781],[4219,6681],[4239,6659]]]}},{type:"Feature",id:"SI",properties:{"hc-group":"admin0","hc-middle-x":.52,"hc-middle-y":.57,"hc-key":"si","hc-a2":"SI",name:"Slovenia",labelrank:"6","country-abbrev":"Slo.",subregion:"Southern Europe","region-wb":"Europe & Central Asia","iso-a3":"SVN","iso-a2":"SI","woe-id":"23424945",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4607,7923],[4607,7925],[4611,7927],[4601,7952],[4611,7961],[4635,7956],[4682,7974],[4687,7974],[4694,7960],[4668,7949],[4659,7921],[4607,7923]]]}},{type:"Feature",id:"GT",properties:{"hc-group":"admin0","hc-middle-x":.44,"hc-middle-y":.87,"hc-key":"gt","hc-a2":"GT",name:"Guatemala",labelrank:"3","country-abbrev":"Guat.",subregion:"Central America","region-wb":"Latin America & Caribbean","iso-a3":"GTM","iso-a2":"GT","woe-id":"23424834",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[1565,6951],[1574,6947],[1586,6946],[1558,6926],[1552,6907],[1530,6889],[1530,6886],[1494,6893],[1466,6911],[1482,6956],[1522,6966],[1491,6992],[1504,7009],[1558,7009],[1556,6951],[1565,6951]]]}},{type:"Feature",id:"BA",properties:{"hc-group":"admin0","hc-middle-x":.45,"hc-middle-y":.48,"hc-key":"ba","hc-a2":"BA",name:"Bosnia and Herzegovina",labelrank:"5","country-abbrev":"B.H.",subregion:"Southern Europe","region-wb":"Europe & Central Asia","iso-a3":"BIH","iso-a2":"BA","woe-id":"23424761",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4728,7828],[4725,7830],[4726,7830],[4685,7876],[4672,7911],[4706,7915],[4768,7900],[4779,7901],[4774,7851],[4752,7832],[4751,7816],[4734,7826],[4728,7828]]]}},{type:"Feature",id:"JO",properties:{"hc-group":"admin0","hc-middle-x":.45,"hc-middle-y":.85,"hc-key":"jo","hc-a2":"JO",name:"Jordan",labelrank:"4","country-abbrev":"Jord.",subregion:"Western Asia","region-wb":"Middle East & North Africa","iso-a3":"JOR","iso-a2":"JO","woe-id":"23424860",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[5255,7426],[5258,7429],[5255,7431],[5254,7432],[5255,7434],[5259,7434],[5259,7448],[5259,7477],[5265,7480],[5296,7466],[5355,7501],[5363,7472],[5366,7460],[5301,7439],[5331,7407],[5274,7365],[5241,7370],[5243,7376],[5241,7377],[5247,7405],[5255,7426]]]}},{type:"Feature",id:"SY",properties:{"hc-group":"admin0","hc-middle-x":.25,"hc-middle-y":.54,"hc-key":"sy","hc-a2":"SY",name:"Syria",labelrank:"3","country-abbrev":"Syria",subregion:"Western Asia","region-wb":"Middle East & North Africa","iso-a3":"SYR","iso-a2":"SY","woe-id":"23424956",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[5355,7501],[5296,7466],[5265,7480],[5269,7487],[5267,7502],[5290,7529],[5271,7544],[5270,7569],[5270,7586],[5291,7617],[5338,7620],[5384,7614],[5457,7634],[5461,7627],[5432,7606],[5427,7548],[5412,7533],[5355,7501]]]}},{type:"Feature",id:"MC",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.67,"hc-key":"mc","hc-a2":"MC",name:"Monaco",labelrank:"6","country-abbrev":"Mco.",subregion:"Western Europe","region-wb":"Europe & Central Asia","iso-a3":"MCO","iso-a2":"MC","woe-id":"23424892",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4425,7859],[4424,7858],[4423,7858],[4424,7860],[4425,7859]]]}},{type:"Feature",id:"AL",properties:{"hc-group":"admin0","hc-middle-x":.39,"hc-middle-y":.49,"hc-key":"al","hc-a2":"AL",name:"Albania",labelrank:"6","country-abbrev":"Alb.",subregion:"Southern Europe","region-wb":"Europe & Central Asia","iso-a3":"ALB","iso-a2":"AL","woe-id":"23424742",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[4826,7757],[4826,7757],[4825,7758],[4826,7757]]],[[[4779,7800],[4779,7805],[4780,7808],[4789,7820],[4799,7816],[4812,7804],[4814,7792],[4811,7781],[4816,7764],[4817,7758],[4819,7758],[4822,7758],[4825,7758],[4825,7757],[4826,7756],[4826,7756],[4824,7753],[4826,7754],[4826,7753],[4828,7750],[4827,7750],[4828,7750],[4809,7720],[4798,7715],[4777,7749],[4779,7791],[4778,7795],[4779,7800]]],[[[4779,7807],[4779,7807],[4779,7806],[4779,7807]]]]}},{type:"Feature",id:"UY",properties:{"hc-group":"admin0","hc-middle-x":.81,"hc-middle-y":.63,"hc-key":"uy","hc-a2":"UY",name:"Uruguay",labelrank:"4","country-abbrev":"Ury.",subregion:"South America","region-wb":"Latin America & Caribbean","iso-a3":"URY","iso-a2":"UY","woe-id":"23424979",continent:"South America"},geometry:{type:"Polygon",coordinates:[[[2626,5480],[2612,5465],[2615,5450],[2615,5447],[2620,5444],[2608,5422],[2573,5404],[2537,5404],[2487,5420],[2471,5437],[2477,5487],[2477,5505],[2494,5561],[2517,5563],[2542,5531],[2554,5539],[2626,5480]]]}},{type:"Feature",id:"CNM",properties:{"hc-group":"admin0","hc-middle-x":.39,"hc-middle-y":.11,"hc-key":"cnm","hc-a2":"CN",name:"Cyprus No Mans Area",labelrank:"9","country-abbrev":null,subregion:"Western Asia","region-wb":"Europe & Central Asia","iso-a3":"-99","iso-a2":null,"woe-id":"-99",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[5213,7557],[5214,7557],[5213,7557],[5210,7557],[5210,7558],[5213,7557]]],[[[5171,7561],[5171,7561],[5172,7561],[5173,7562],[5173,7562],[5172,7560],[5171,7561]]],[[[5175,7561],[5174,7561],[5175,7561],[5175,7561],[5175,7561],[5175,7561]]],[[[5203,7556],[5205,7555],[5204,7555],[5196,7561],[5175,7561],[5175,7561],[5196,7562],[5203,7556]]]]}},{type:"Feature",id:"MN",properties:{"hc-group":"admin0","hc-middle-x":.49,"hc-middle-y":.53,"hc-key":"mn","hc-a2":"MN",name:"Mongolia",labelrank:"3","country-abbrev":"Mong.",subregion:"Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"MNG","iso-a2":"MN","woe-id":"23424887",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[7691,8008],[7702,8011],[7698,8015],[7722,8015],[7762,7975],[7756,7963],[7714,7968],[7664,7953],[7637,7921],[7603,7919],[7575,7895],[7528,7908],[7511,7885],[7526,7857],[7453,7813],[7372,7807],[7326,7787],[7282,7788],[7232,7803],[7220,7815],[7064,7822],[7034,7879],[6979,7903],[6901,7912],[6906,7963],[6885,8003],[6847,8016],[6814,8039],[6810,8061],[6945,8127],[7001,8115],[7011,8094],[7093,8083],[7121,8113],[7106,8132],[7139,8176],[7237,8144],[7239,8117],[7280,8098],[7330,8111],[7407,8090],[7425,8067],[7490,8060],[7559,8077],[7596,8104],[7628,8089],[7667,8086],[7632,8021],[7642,8005],[7691,8008]]]}},{type:"Feature",id:"RW",properties:{"hc-group":"admin0","hc-middle-x":.48,"hc-middle-y":.56,"hc-key":"rw","hc-a2":"RW",name:"Rwanda",labelrank:"3","country-abbrev":"Rwa.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"RWA","iso-a2":"RW","woe-id":"23424937",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5065,6398],[5061,6400],[5061,6406],[5075,6419],[5071,6429],[5075,6434],[5082,6438],[5092,6435],[5108,6447],[5119,6432],[5111,6408],[5091,6400],[5065,6398]]]}},{type:"Feature",id:"SO",properties:{"hc-group":"admin0","hc-middle-x":.39,"hc-middle-y":.74,"hc-key":"so","hc-a2":"SO",name:"Somalia",labelrank:"6","country-abbrev":"Som.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"SOM","iso-a2":"SO","woe-id":"-90",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5447,6596],[5509,6625],[5538,6624],[5628,6715],[5656,6758],[5656,6812],[5726,6829],[5713,6758],[5627,6610],[5570,6551],[5494,6497],[5437,6429],[5420,6453],[5420,6562],[5447,6596]]]}},{type:"Feature",id:"BO",properties:{"hc-group":"admin0","hc-middle-x":.48,"hc-middle-y":.59,"hc-key":"bo","hc-a2":"BO",name:"Bolivia",labelrank:"3","country-abbrev":"Bolivia",subregion:"South America","region-wb":"Latin America & Caribbean","iso-a3":"BOL","iso-a2":"BO","woe-id":"23424762",continent:"South America"},geometry:{type:"MultiPolygon",coordinates:[[[[2153,5996],[2153,6001],[2157,5996],[2155,5997],[2153,5996]]],[[[2141,5957],[2137,5964],[2155,5986],[2169,5993],[2145,6017],[2160,6058],[2153,6073],[2166,6108],[2139,6155],[2177,6154],[2226,6186],[2262,6192],[2263,6149],[2293,6110],[2332,6104],[2369,6077],[2409,6069],[2419,5995],[2469,5993],[2471,5965],[2496,5937],[2478,5876],[2450,5903],[2371,5892],[2356,5864],[2345,5812],[2307,5819],[2295,5792],[2287,5813],[2238,5826],[2210,5794],[2189,5794],[2180,5842],[2163,5868],[2173,5898],[2157,5913],[2141,5957]]]]}},{type:"Feature",id:"CM",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.81,"hc-key":"cm","hc-a2":"CM",name:"Cameroon",labelrank:"3","country-abbrev":"Cam.",subregion:"Middle Africa","region-wb":"Sub-Saharan Africa","iso-a3":"CMR","iso-a2":"CM","woe-id":"23424785",continent:"Africa"},geometry:{type:"MultiPolygon",coordinates:[[[[4599,6542],[4541,6547],[4540,6543],[4500,6543],[4495,6548],[4490,6593],[4459,6621],[4466,6651],[4518,6689],[4540,6669],[4567,6725],[4639,6839],[4621,6866],[4629,6866],[4627,6861],[4634,6863],[4653,6820],[4651,6798],[4669,6774],[4625,6774],[4618,6764],[4655,6729],[4663,6701],[4631,6657],[4654,6590],[4682,6562],[4685,6545],[4684,6530],[4636,6544],[4599,6542]]],[[[4631,6866],[4631,6866],[4630,6866],[4631,6866]]]]}},{type:"Feature",id:"CG",properties:{"hc-group":"admin0","hc-middle-x":.15,"hc-middle-y":.78,"hc-key":"cg","hc-a2":"CG",name:"Republic of Congo",labelrank:"4","country-abbrev":"Rep. Congo",subregion:"Middle Africa","region-wb":"Sub-Saharan Africa","iso-a3":"COG","iso-a2":"CG","woe-id":"23424779",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4599,6542],[4636,6544],[4684,6530],[4685,6545],[4696,6581],[4722,6588],[4757,6581],[4740,6542],[4731,6463],[4686,6416],[4685,6381],[4644,6337],[4631,6353],[4592,6342],[4583,6349],[4560,6331],[4554,6344],[4534,6363],[4555,6369],[4547,6410],[4573,6423],[4622,6405],[4634,6461],[4614,6473],[4633,6506],[4597,6515],[4599,6542]]]}},{type:"Feature",id:"EH",properties:{"hc-group":"admin0","hc-middle-x":.41,"hc-middle-y":.71,"hc-key":"eh","hc-a2":"EH",name:"Western Sahara",labelrank:"7","country-abbrev":"W. Sah.",subregion:"Northern Africa","region-wb":"Middle East & North Africa","iso-a3":"ESH","iso-a2":"EH","woe-id":"23424990",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[3698,7100],[3696,7103],[3699,7120],[3764,7121],[3782,7148],[3788,7182],[3835,7226],[3847,7264],[3866,7291],[3915,7290],[3943,7298],[3946,7316],[3946,7304],[3946,7263],[3847,7263],[3847,7183],[3818,7170],[3818,7117],[3701,7117],[3698,7100]]]}},{type:"Feature",id:"RS",properties:{"hc-group":"admin0","hc-middle-x":.42,"hc-middle-y":.52,"hc-key":"rs","hc-a2":"RS",name:"Republic of Serbia",labelrank:"5","country-abbrev":"Serb.",subregion:"Southern Europe","region-wb":"Europe & Central Asia","iso-a3":"SRB","iso-a2":"RS","woe-id":"-90",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4774,7851],[4779,7901],[4768,7900],[4769,7910],[4765,7939],[4784,7948],[4805,7946],[4842,7910],[4839,7897],[4877,7877],[4867,7861],[4885,7836],[4867,7808],[4855,7808],[4844,7805],[4850,7820],[4820,7842],[4808,7826],[4786,7839],[4774,7851]]]}},{type:"Feature",id:"ME",properties:{"hc-group":"admin0","hc-middle-x":.42,"hc-middle-y":.47,"hc-key":"me","hc-a2":"ME",name:"Montenegro",labelrank:"6","country-abbrev":"Mont.",subregion:"Southern Europe","region-wb":"Europe & Central Asia","iso-a3":"MNE","iso-a2":"ME","woe-id":"20069817",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4774,7851],[4786,7839],[4808,7826],[4798,7822],[4799,7816],[4789,7820],[4780,7808],[4779,7807],[4779,7806],[4772,7806],[4779,7800],[4778,7795],[4779,7791],[4761,7806],[4753,7811],[4751,7814],[4751,7816],[4752,7832],[4774,7851]]]}},{type:"Feature",id:"TG",properties:{"hc-group":"admin0","hc-middle-x":.76,"hc-middle-y":.81,"hc-key":"tg","hc-a2":"TG",name:"Togo",labelrank:"6","country-abbrev":"Togo",subregion:"Western Africa","region-wb":"Sub-Saharan Africa","iso-a3":"TGO","iso-a2":"TG","woe-id":"23424965",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4231,6804],[4252,6746],[4252,6662],[4246,6661],[4239,6659],[4219,6681],[4215,6781],[4199,6808],[4218,6804],[4231,6804]]]}},{type:"Feature",id:"LA",properties:{"hc-group":"admin0","hc-middle-x":.88,"hc-middle-y":.79,"hc-key":"la","hc-a2":"LA",name:"Laos",labelrank:"4","country-abbrev":"Laos",subregion:"South-Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"LAO","iso-a2":"LA","woe-id":"23424872",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[7395,6915],[7374,6904],[7325,6904],[7338,6946],[7313,6970],[7315,6996],[7290,7025],[7272,7029],[7249,7010],[7233,7022],[7205,6999],[7209,7061],[7186,7062],[7175,7086],[7193,7117],[7206,7124],[7222,7111],[7217,7146],[7234,7150],[7260,7125],[7264,7103],[7292,7106],[7319,7079],[7286,7055],[7311,7039],[7365,6984],[7399,6932],[7395,6915]]]}},{type:"Feature",id:"AF",properties:{"hc-group":"admin0","hc-middle-x":.37,"hc-middle-y":.52,"hc-key":"af","hc-a2":"AF",name:"Afghanistan",labelrank:"3","country-abbrev":"Afg.",subregion:"Southern Asia","region-wb":"South Asia","iso-a3":"AFG","iso-a2":"AF","woe-id":"23424739",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[6426,7631],[6411,7627],[6416,7624],[6357,7617],[6316,7590],[6330,7562],[6313,7524],[6281,7523],[6290,7499],[6268,7491],[6261,7454],[6226,7450],[6173,7421],[6168,7385],[6106,7371],[6058,7372],[6010,7386],[6038,7418],[6035,7435],[6009,7439],[6001,7491],[6022,7576],[6052,7560],[6117,7598],[6126,7626],[6156,7642],[6178,7635],[6200,7629],[6215,7629],[6259,7626],[6285,7641],[6299,7669],[6329,7653],[6329,7613],[6379,7639],[6426,7631]]]}},{type:"Feature",id:"UA",properties:{"hc-group":"admin0","hc-middle-x":.7,"hc-middle-y":.46,"hc-key":"ua","hc-a2":"UA",name:"Ukraine",labelrank:"3","country-abbrev":"Ukr.",subregion:"Eastern Europe","region-wb":"Europe & Central Asia","iso-a3":"UKR","iso-a2":"UA","woe-id":"23424976",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4861,8032],[4866,8042],[4873,8057],[4876,8075],[4919,8114],[4905,8152],[4928,8166],[4969,8168],[5013,8155],[5074,8146],[5110,8154],[5122,8174],[5147,8175],[5207,8185],[5225,8161],[5218,8142],[5245,8140],[5262,8106],[5315,8109],[5367,8087],[5395,8064],[5382,8045],[5384,8010],[5356,8011],[5338,7983],[5269,7966],[5237,7948],[5260,7909],[5212,7882],[5179,7928],[5206,7939],[5146,7950],[5163,7959],[5129,7965],[5089,7927],[5084,7913],[5059,7914],[5041,7922],[5063,7958],[5097,7955],[5068,7999],[5072,8011],[5028,8033],[4994,8026],[4954,8013],[4883,8014],[4875,8020],[4861,8032]],[[5098,7955],[5107,7945],[5109,7947],[5100,7956],[5098,7955]],[[5213,7945],[5242,7929],[5237,7943],[5218,7952],[5213,7945]]]}},{type:"Feature",id:"SK",properties:{"hc-group":"admin0","hc-middle-x":.21,"hc-middle-y":.52,"hc-key":"sk","hc-a2":"SK",name:"Slovakia",labelrank:"6","country-abbrev":"Svk.",subregion:"Eastern Europe","region-wb":"Europe & Central Asia","iso-a3":"SVK","iso-a2":"SK","woe-id":"23424877",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4873,8057],[4866,8042],[4861,8032],[4812,8036],[4795,8021],[4733,8007],[4713,8017],[4704,8030],[4707,8039],[4741,8058],[4763,8074],[4852,8069],[4873,8057]]]}},{type:"Feature",id:"JK",properties:{"hc-group":"admin0","hc-middle-x":.4,"hc-middle-y":.63,"hc-key":"jk","hc-a2":"JK",name:"Siachen Glacier",labelrank:"5","country-abbrev":"Siachen",subregion:"Southern Asia","region-wb":"South Asia","iso-a3":"-99","iso-a2":"JK","woe-id":"23424928",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[6513,7572],[6490,7559],[6482,7577],[6500,7571],[6513,7572]]]}},{type:"Feature",id:"BG",properties:{"hc-group":"admin0","hc-middle-x":.76,"hc-middle-y":.51,"hc-key":"bg","hc-a2":"BG",name:"Bulgaria",labelrank:"4","country-abbrev":"Bulg.",subregion:"Eastern Europe","region-wb":"Europe & Central Asia","iso-a3":"BGR","iso-a2":"BG","woe-id":"23424771",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[5052,7859],[5026,7812],[5035,7796],[5007,7799],[4985,7786],[4953,7770],[4931,7781],[4884,7773],[4887,7787],[4867,7808],[4885,7836],[4867,7861],[4877,7877],[4896,7864],[4957,7856],[5006,7875],[5052,7859]]]}},{type:"Feature",id:"QA",properties:{"hc-group":"admin0","hc-middle-x":.36,"hc-middle-y":.46,"hc-key":"qa","hc-a2":"QA",name:"Qatar",labelrank:"5","country-abbrev":"Qatar",subregion:"Western Asia","region-wb":"Middle East & North Africa","iso-a3":"QAT","iso-a2":"QA","woe-id":"23424930",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[5712,7224],[5710,7247],[5735,7259],[5724,7220],[5717,7218],[5712,7224]]]}},{type:"Feature",id:"LI",properties:{"hc-group":"admin0","hc-middle-x":.61,"hc-middle-y":.53,"hc-key":"li","hc-a2":"LI",name:"Liechtenstein",labelrank:"6","country-abbrev":"Liech.",subregion:"Western Europe","region-wb":"Europe & Central Asia","iso-a3":"LIE","iso-a2":"LI","woe-id":"23424879",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4487,7989],[4489,7983],[4488,7981],[4485,7981],[4487,7989]]]}},{type:"Feature",id:"AT",properties:{"hc-group":"admin0","hc-middle-x":.52,"hc-middle-y":.62,"hc-key":"at","hc-a2":"AT",name:"Austria",labelrank:"4","country-abbrev":"Aust.",subregion:"Western Europe","region-wb":"Europe & Central Asia","iso-a3":"AUT","iso-a2":"AT","woe-id":"23424750",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4488,7981],[4489,7983],[4487,7989],[4490,7994],[4488,7998],[4491,7997],[4492,7999],[4530,7993],[4565,8005],[4591,7997],[4582,8021],[4614,8045],[4640,8039],[4648,8053],[4707,8039],[4704,8030],[4713,8017],[4696,8007],[4682,7974],[4635,7956],[4611,7961],[4572,7967],[4566,7982],[4514,7974],[4504,7973],[4488,7981]]]}},{type:"Feature",id:"SZ",properties:{"hc-group":"admin0","hc-middle-x":.51,"hc-middle-y":.45,"hc-key":"sz","hc-a2":"SZ",name:"Swaziland",labelrank:"4","country-abbrev":"Swz.",subregion:"Southern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"SWZ","iso-a2":"SZ","woe-id":"23424993",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5152,5696],[5155,5685],[5157,5668],[5128,5656],[5118,5682],[5137,5702],[5152,5696]]]}},{type:"Feature",id:"HU",properties:{"hc-group":"admin0","hc-middle-x":.27,"hc-middle-y":.61,"hc-key":"hu","hc-a2":"HU",name:"Hungary",labelrank:"5","country-abbrev":"Hun.",subregion:"Eastern Europe","region-wb":"Europe & Central Asia","iso-a3":"HUN","iso-a2":"HU","woe-id":"23424844",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4861,8032],[4875,8020],[4883,8014],[4857,7997],[4831,7952],[4805,7946],[4784,7948],[4765,7939],[4719,7940],[4694,7960],[4687,7974],[4682,7974],[4696,8007],[4713,8017],[4733,8007],[4795,8021],[4812,8036],[4861,8032]]]}},{type:"Feature",id:"RO",properties:{"hc-group":"admin0","hc-middle-x":.67,"hc-middle-y":.5,"hc-key":"ro","hc-a2":"RO",name:"Romania",labelrank:"3","country-abbrev":"Rom.",subregion:"Eastern Europe","region-wb":"Europe & Central Asia","iso-a3":"ROU","iso-a2":"RO","woe-id":"23424933",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4877,7877],[4839,7897],[4842,7910],[4805,7946],[4831,7952],[4857,7997],[4883,8014],[4954,8013],[4994,8026],[5005,8023],[5042,7965],[5041,7922],[5059,7914],[5084,7913],[5054,7880],[5052,7859],[5006,7875],[4957,7856],[4896,7864],[4877,7877]]]}},{type:"Feature",id:"NE",properties:{"hc-group":"admin0","hc-middle-x":.64,"hc-middle-y":.53,"hc-key":"ne","hc-a2":"NE",name:"Niger",labelrank:"3","country-abbrev":"Niger",subregion:"Western Africa","region-wb":"Sub-Saharan Africa","iso-a3":"NER","iso-a2":"NE","woe-id":"23424906",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4311,6825],[4288,6846],[4275,6831],[4269,6852],[4233,6865],[4210,6922],[4243,6933],[4308,6935],[4328,6967],[4329,7050],[4376,7059],[4426,7103],[4559,7185],[4604,7175],[4626,7157],[4649,7169],[4655,7122],[4678,7087],[4671,7073],[4663,6982],[4603,6906],[4608,6885],[4574,6866],[4543,6875],[4504,6872],[4490,6859],[4436,6874],[4410,6864],[4368,6891],[4326,6878],[4311,6825]]]}},{type:"Feature",id:"LU",properties:{"hc-group":"admin0","hc-middle-x":.48,"hc-middle-y":.6,"hc-key":"lu","hc-a2":"LU",name:"Luxembourg",labelrank:"6","country-abbrev":"Lux.",subregion:"Western Europe","region-wb":"Europe & Central Asia","iso-a3":"LUX","iso-a2":"LU","woe-id":"23424881",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4392,8072],[4381,8071],[4376,8075],[4374,8088],[4386,8097],[4397,8085],[4392,8072]]]}},{type:"Feature",id:"AD",properties:{"hc-group":"admin0","hc-middle-x":.58,"hc-middle-y":.28,"hc-key":"ad","hc-a2":"AD",name:"Andorra",labelrank:"6","country-abbrev":"And.",subregion:"Southern Europe","region-wb":"Europe & Central Asia","iso-a3":"AND","iso-a2":"AD","woe-id":"23424744",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4246,7818],[4255,7818],[4255,7814],[4249,7812],[4246,7818]]]}},{type:"Feature",id:"CI",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.48,"hc-key":"ci","hc-a2":"CI",name:"Ivory Coast",labelrank:"3","country-abbrev":"I.C.",subregion:"Western Africa","region-wb":"Sub-Saharan Africa","iso-a3":"CIV","iso-a2":"CI","woe-id":"23424854",continent:"Africa"},geometry:{type:"MultiPolygon",coordinates:[[[[4124,6759],[4130,6721],[4108,6681],[4120,6631],[4030,6627],[3980,6607],[3982,6650],[3948,6670],[3952,6702],[3971,6757],[3967,6779],[4019,6782],[4040,6787],[4065,6765],[4109,6772],[4124,6759]]],[[[4111,6629],[4107,6630],[4112,6629],[4111,6629]]]]}},{type:"Feature",id:"LR",properties:{"hc-group":"admin0","hc-middle-x":.96,"hc-middle-y":.75,"hc-key":"lr","hc-a2":"LR",name:"Liberia",labelrank:"4","country-abbrev":"Liberia",subregion:"Western Africa","region-wb":"Sub-Saharan Africa","iso-a3":"LBR","iso-a2":"LR","woe-id":"23424876",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[3952,6702],[3948,6670],[3982,6650],[3980,6607],[3929,6631],[3863,6683],[3889,6708],[3899,6729],[3922,6725],[3933,6691],[3952,6702]]]}},{type:"Feature",id:"BN",properties:{"hc-group":"admin0","hc-middle-x":.32,"hc-middle-y":.34,"hc-key":"bn","hc-a2":"BN",name:"Brunei",labelrank:"6","country-abbrev":"Brunei",subregion:"South-Eastern Asia","region-wb":"East Asia & Pacific","iso-a3":"BRN","iso-a2":"BN","woe-id":"23424773",continent:"Asia"},geometry:{type:"MultiPolygon",coordinates:[[[[7618,6621],[7621,6622],[7621,6623],[7627,6606],[7618,6621]]],[[[7587,6614],[7603,6617],[7616,6623],[7606,6597],[7587,6614]]]]}},{type:"Feature",id:"IQ",properties:{"hc-group":"admin0","hc-middle-x":.46,"hc-middle-y":.44,"hc-key":"iq","hc-a2":"IQ",name:"Iraq",labelrank:"3","country-abbrev":"Iraq",subregion:"Western Asia","region-wb":"Middle East & North Africa","iso-a3":"IRQ","iso-a2":"IQ","woe-id":"23424855",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[5644,7390],[5632,7392],[5627,7391],[5602,7390],[5585,7362],[5530,7365],[5453,7426],[5404,7453],[5366,7460],[5363,7472],[5355,7501],[5412,7533],[5427,7548],[5432,7606],[5461,7627],[5472,7635],[5532,7628],[5549,7589],[5579,7582],[5551,7521],[5577,7487],[5611,7469],[5623,7448],[5619,7423],[5644,7390]]]}},{type:"Feature",id:"GE",properties:{"hc-group":"admin0","hc-middle-x":.99,"hc-middle-y":.82,"hc-key":"ge","hc-a2":"GE",name:"Georgia",labelrank:"5","country-abbrev":"Geo.",subregion:"Western Asia","region-wb":"Europe & Central Asia","iso-a3":"GEO","iso-a2":"GE","woe-id":"23424823",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[5539,7771],[5515,7769],[5493,7765],[5474,7782],[5436,7779],[5436,7819],[5391,7846],[5475,7838],[5508,7816],[5534,7823],[5582,7793],[5584,7763],[5539,7771]]]}},{type:"Feature",id:"GM",properties:{"hc-group":"admin0","hc-middle-x":.51,"hc-middle-y":.51,"hc-key":"gm","hc-a2":"GM",name:"Gambia",labelrank:"6","country-abbrev":"Gambia",subregion:"Western Africa","region-wb":"Sub-Saharan Africa","iso-a3":"GMB","iso-a2":"GM","woe-id":"23424821",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[3707,6866],[3705,6874],[3713,6882],[3762,6888],[3734,6869],[3707,6866]]]}},{type:"Feature",id:"CH",properties:{"hc-group":"admin0","hc-middle-x":.12,"hc-middle-y":.55,"hc-key":"ch","hc-a2":"CH",name:"Switzerland",labelrank:"4","country-abbrev":"Switz.",subregion:"Western Europe","region-wb":"Europe & Central Asia","iso-a3":"CHE","iso-a2":"CH","woe-id":"23424957",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4477,8004],[4477,8004],[4477,8003],[4477,8003],[4486,7997],[4488,7998],[4490,7994],[4487,7989],[4485,7981],[4488,7981],[4504,7973],[4514,7974],[4500,7955],[4466,7944],[4444,7951],[4412,7939],[4405,7947],[4405,7957],[4400,7961],[4393,7956],[4389,7952],[4386,7963],[4429,8001],[4455,8001],[4477,8004]]]}},{type:"Feature",id:"TD",properties:{"hc-group":"admin0","hc-middle-x":.47,"hc-middle-y":.63,"hc-key":"td","hc-a2":"TD",name:"Chad",labelrank:"3","country-abbrev":"Chad",subregion:"Middle Africa","region-wb":"Sub-Saharan Africa","iso-a3":"TCD","iso-a2":"TD","woe-id":"23424777",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4634,6863],[4642,6866],[4631,6866],[4630,6866],[4628,6868],[4629,6866],[4621,6866],[4608,6885],[4603,6906],[4663,6982],[4671,7073],[4678,7087],[4655,7122],[4649,7169],[4678,7183],[4916,7061],[4916,6946],[4889,6945],[4873,6898],[4859,6887],[4863,6856],[4882,6802],[4870,6804],[4810,6749],[4771,6745],[4756,6716],[4702,6702],[4663,6701],[4655,6729],[4618,6764],[4625,6774],[4669,6774],[4651,6798],[4653,6820],[4634,6863]]]}},{type:"Feature",id:"KV",properties:{"hc-group":"admin0","hc-middle-x":.49,"hc-middle-y":.52,"hc-key":"kv","hc-a2":"KV",name:"Kosovo",labelrank:"6","country-abbrev":"Kos.",subregion:"Southern Europe","region-wb":"Europe & Central Asia","iso-a3":"-99","iso-a2":"KV","woe-id":"-90",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4814,7792],[4812,7804],[4799,7816],[4798,7822],[4808,7826],[4820,7842],[4850,7820],[4844,7805],[4830,7804],[4814,7792]]]}},{type:"Feature",id:"LB",properties:{"hc-group":"admin0","hc-middle-x":.39,"hc-middle-y":.57,"hc-key":"lb","hc-a2":"LB",name:"Lebanon",labelrank:"5","country-abbrev":"Leb.",subregion:"Western Asia","region-wb":"Middle East & North Africa","iso-a3":"LBN","iso-a2":"LB","woe-id":"23424873",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[5246,7492],[5260,7519],[5271,7544],[5290,7529],[5267,7502],[5257,7492],[5246,7492]]]}},{type:"Feature",id:"DJ",properties:{"hc-group":"admin0","hc-middle-x":.56,"hc-middle-y":.55,"hc-key":"dj","hc-a2":"DJ",name:"Djibouti",labelrank:"5","country-abbrev":"Dji.",subregion:"Eastern Africa","region-wb":"Middle East & North Africa","iso-a3":"DJI","iso-a2":"DJ","woe-id":"23424797",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5478,6804],[5449,6802],[5444,6807],[5447,6810],[5444,6813],[5443,6820],[5462,6848],[5471,6845],[5484,6855],[5490,6834],[5487,6819],[5478,6804]]]}},{type:"Feature",id:"BI",properties:{"hc-group":"admin0","hc-middle-x":.57,"hc-middle-y":.47,"hc-key":"bi","hc-a2":"BI",name:"Burundi",labelrank:"6","country-abbrev":"Bur.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"BDI","iso-a2":"BI","woe-id":"23424774",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5084,6347],[5076,6364],[5071,6380],[5072,6389],[5065,6398],[5091,6400],[5111,6408],[5118,6383],[5084,6347]]]}},{type:"Feature",id:"SR",properties:{"hc-group":"admin0","hc-middle-x":.91,"hc-middle-y":.09,"hc-key":"sr","hc-a2":"SR",name:"Suriname",labelrank:"4","country-abbrev":"Sur.",subregion:"South America","region-wb":"Latin America & Caribbean","iso-a3":"SUR","iso-a2":"SR","woe-id":"23424913",continent:"South America"},geometry:{type:"Polygon",coordinates:[[[2583,6547],[2543,6553],[2528,6536],[2481,6602],[2505,6641],[2514,6656],[2601,6651],[2596,6636],[2587,6623],[2601,6581],[2583,6547]]]}},{type:"Feature",id:"IL",properties:{"hc-group":"admin0","hc-middle-x":.68,"hc-middle-y":.1,"hc-key":"il","hc-a2":"IL",name:"Israel",labelrank:"4","country-abbrev":"Isr.",subregion:"Western Asia","region-wb":"Middle East & North Africa","iso-a3":"ISR","iso-a2":"IL","woe-id":"23424852",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[5219,7433],[5238,7465],[5246,7492],[5257,7492],[5267,7502],[5269,7487],[5265,7480],[5259,7477],[5259,7448],[5254,7440],[5255,7434],[5254,7432],[5255,7431],[5253,7429],[5255,7426],[5247,7405],[5241,7377],[5240,7374],[5239,7374],[5237,7382],[5219,7433]]]}},{type:"Feature",id:"ML",properties:{"hc-group":"admin0","hc-middle-x":.59,"hc-middle-y":.38,"hc-key":"ml","hc-a2":"ML",name:"Mali",labelrank:"3","country-abbrev":"Mali",subregion:"Western Africa","region-wb":"Sub-Saharan Africa","iso-a3":"MLI","iso-a2":"ML","woe-id":"23424891",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4040,6787],[4019,6782],[3967,6779],[3955,6815],[3931,6848],[3886,6831],[3866,6846],[3845,6885],[3840,6917],[3856,6941],[3886,6937],[4040,6939],[4008,7231],[4061,7231],[4238,7110],[4260,7083],[4299,7070],[4296,7050],[4329,7050],[4328,6967],[4308,6935],[4243,6933],[4210,6922],[4183,6927],[4141,6899],[4120,6895],[4099,6869],[4083,6876],[4069,6839],[4051,6832],[4040,6787]]]}},{type:"Feature",id:"SN",properties:{"hc-group":"admin0","hc-middle-x":.2,"hc-middle-y":.55,"hc-key":"sn","hc-a2":"SN",name:"Senegal",labelrank:"3","country-abbrev":"Sen.",subregion:"Western Africa","region-wb":"Sub-Saharan Africa","iso-a3":"SEN","iso-a2":"SN","woe-id":"23424943",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[3708,6844],[3705,6859],[3707,6866],[3734,6869],[3762,6888],[3713,6882],[3695,6922],[3713,6949],[3719,6968],[3779,6974],[3840,6917],[3845,6885],[3866,6846],[3837,6843],[3797,6854],[3753,6854],[3708,6844]]]}},{type:"Feature",id:"GN",properties:{"hc-group":"admin0","hc-middle-x":.24,"hc-middle-y":.51,"hc-key":"gn","hc-a2":"GN",name:"Guinea",labelrank:"3","country-abbrev":"Gin.",subregion:"Western Africa","region-wb":"Sub-Saharan Africa","iso-a3":"GIN","iso-a2":"GN","woe-id":"23424835",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[3866,6846],[3886,6831],[3931,6848],[3955,6815],[3967,6779],[3971,6757],[3952,6702],[3933,6691],[3922,6725],[3899,6729],[3870,6774],[3833,6770],[3809,6746],[3793,6770],[3758,6803],[3767,6819],[3797,6825],[3797,6854],[3837,6843],[3866,6846]]]}},{type:"Feature",id:"ZW",properties:{"hc-group":"admin0","hc-middle-x":.81,"hc-middle-y":.42,"hc-key":"zw","hc-a2":"ZW",name:"Zimbabwe",labelrank:"3","country-abbrev":"Zimb.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"ZWE","iso-a2":"ZW","woe-id":"23425004",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4954,5949],[4996,5940],[5006,5944],[5038,5977],[5038,5977],[5058,5987],[5060,6001],[5106,6014],[5182,5982],[5185,5932],[5176,5898],[5184,5880],[5166,5841],[5133,5807],[5104,5809],[5075,5814],[5036,5833],[5026,5865],[4979,5896],[4954,5949]]]}},{type:"Feature",id:"PL",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.48,"hc-key":"pl","hc-a2":"PL",name:"Poland",labelrank:"3","country-abbrev":"Pol.",subregion:"Eastern Europe","region-wb":"Europe & Central Asia","iso-a3":"POL","iso-a2":"PL","woe-id":"23424923",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4786,8270],[4779,8263],[4790,8269],[4878,8266],[4880,8266],[4900,8258],[4901,8249],[4912,8198],[4891,8183],[4905,8152],[4919,8114],[4876,8075],[4873,8057],[4852,8069],[4763,8074],[4755,8089],[4691,8116],[4644,8126],[4639,8194],[4623,8205],[4627,8239],[4638,8245],[4625,8247],[4625,8248],[4626,8249],[4683,8263],[4696,8274],[4748,8286],[4756,8269],[4786,8270],[4786,8270]]]}},{type:"Feature",id:"MK",properties:{"hc-group":"admin0","hc-middle-x":.49,"hc-middle-y":.44,"hc-key":"mk","hc-a2":"MK",name:"Macedonia",labelrank:"6","country-abbrev":"Mkd.",subregion:"Southern Europe","region-wb":"Europe & Central Asia","iso-a3":"MKD","iso-a2":"MK","woe-id":"23424890",continent:"Europe"},geometry:{type:"MultiPolygon",coordinates:[[[[4826,7756],[4826,7756],[4826,7756],[4826,7756]]],[[[4867,7808],[4887,7787],[4884,7773],[4854,7765],[4831,7756],[4826,7762],[4826,7757],[4825,7758],[4825,7758],[4822,7758],[4819,7758],[4822,7765],[4816,7764],[4811,7781],[4814,7792],[4830,7804],[4844,7805],[4855,7808],[4867,7808]]]]}},{type:"Feature",id:"PY",properties:{"hc-group":"admin0","hc-middle-x":.35,"hc-middle-y":.36,"hc-key":"py","hc-a2":"PY",name:"Paraguay",labelrank:"4","country-abbrev":"Para.",subregion:"South America","region-wb":"Latin America & Caribbean","iso-a3":"PRY","iso-a2":"PY","woe-id":"23424917",continent:"South America"},geometry:{type:"Polygon",coordinates:[[[2594,5755],[2590,5743],[2583,5712],[2584,5709],[2584,5708],[2578,5674],[2549,5649],[2465,5653],[2496,5712],[2422,5757],[2394,5763],[2345,5812],[2356,5864],[2371,5892],[2450,5903],[2478,5876],[2488,5852],[2483,5817],[2530,5817],[2553,5800],[2559,5759],[2594,5755]]]}},{type:"Feature",id:"BY",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.5,"hc-key":"by","hc-a2":"BY",name:"Belarus",labelrank:"4","country-abbrev":"Bela.",subregion:"Eastern Europe","region-wb":"Europe & Central Asia","iso-a3":"BLR","iso-a2":"BY","woe-id":"23424765",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4905,8152],[4891,8183],[4912,8198],[4901,8249],[4927,8247],[4960,8264],[4972,8290],[4998,8305],[4993,8320],[5023,8325],[5039,8340],[5121,8317],[5146,8243],[5175,8229],[5131,8212],[5147,8175],[5122,8174],[5110,8154],[5074,8146],[5013,8155],[4969,8168],[4928,8166],[4905,8152]]]}},{type:"Feature",id:"CZ",properties:{"hc-group":"admin0","hc-middle-x":.49,"hc-middle-y":.56,"hc-key":"cz","hc-a2":"CZ",name:"Czech Republic",labelrank:"5","country-abbrev":"Cz. Rep.",subregion:"Eastern Europe","region-wb":"Europe & Central Asia","iso-a3":"CZE","iso-a2":"CZ","woe-id":"23424810",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[4763,8074],[4741,8058],[4707,8039],[4648,8053],[4640,8039],[4614,8045],[4571,8083],[4575,8108],[4644,8126],[4691,8116],[4755,8089],[4763,8074]]]}},{type:"Feature",id:"BF",properties:{"hc-group":"admin0","hc-middle-x":.45,"hc-middle-y":.54,"hc-key":"bf","hc-a2":"BF",name:"Burkina Faso",labelrank:"3","country-abbrev":"B.F.",subregion:"Western Africa","region-wb":"Sub-Saharan Africa","iso-a3":"BFA","iso-a2":"BF","woe-id":"23424978",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4231,6804],[4218,6804],[4199,6808],[4122,6804],[4124,6759],[4109,6772],[4065,6765],[4040,6787],[4051,6832],[4069,6839],[4083,6876],[4099,6869],[4120,6895],[4141,6899],[4183,6927],[4210,6922],[4233,6865],[4269,6852],[4275,6831],[4247,6818],[4231,6804]]]}},{type:"Feature",id:"NA",properties:{"hc-group":"admin0","hc-middle-x":.33,"hc-middle-y":.37,"hc-key":"na","hc-a2":"NA",name:"Namibia",labelrank:"3","country-abbrev":"Nam.",subregion:"Southern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"NAM","iso-a2":"NA","woe-id":"23424987",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4898,5953],[4923,5958],[4954,5949],[4904,5928],[4895,5942],[4826,5933],[4827,5821],[4797,5819],[4797,5734],[4797,5617],[4771,5600],[4720,5608],[4711,5630],[4693,5613],[4658,5652],[4637,5740],[4631,5811],[4602,5855],[4577,5909],[4561,5927],[4553,5965],[4595,5974],[4618,5960],[4752,5961],[4761,5950],[4821,5941],[4898,5953]]]}},{type:"Feature",id:"LY",properties:{"hc-group":"admin0","hc-middle-x":.51,"hc-middle-y":.38,"hc-key":"ly","hc-a2":"LY",name:"Libya",labelrank:"3","country-abbrev":"Libya",subregion:"Northern Africa","region-wb":"Middle East & North Africa","iso-a3":"LBY","iso-a2":"LY","woe-id":"23424882",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4649,7169],[4626,7157],[4604,7175],[4559,7185],[4546,7209],[4502,7227],[4483,7267],[4496,7279],[4496,7363],[4486,7398],[4509,7421],[4504,7437],[4547,7471],[4545,7495],[4570,7483],[4600,7486],[4655,7469],[4680,7432],[4719,7426],[4770,7399],[4790,7407],[4795,7448],[4814,7474],[4846,7487],[4890,7477],[4889,7467],[4945,7455],[4950,7445],[4937,7397],[4945,7364],[4945,7138],[4945,7076],[4916,7076],[4916,7061],[4678,7183],[4649,7169]]]}},{type:"Feature",id:"TN",properties:{"hc-group":"admin0","hc-middle-x":.53,"hc-middle-y":.03,"hc-key":"tn","hc-a2":"TN",name:"Tunisia",labelrank:"3","country-abbrev":"Tun.",subregion:"Northern Africa","region-wb":"Middle East & North Africa","iso-a3":"TUN","iso-a2":"TN","woe-id":"23424967",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4545,7495],[4547,7471],[4504,7437],[4509,7421],[4486,7398],[4472,7458],[4451,7473],[4426,7518],[4448,7543],[4452,7604],[4459,7621],[4493,7635],[4535,7563],[4505,7533],[4511,7512],[4532,7515],[4545,7495]]]}},{type:"Feature",id:"BT",properties:{"hc-group":"admin0","hc-middle-x":.48,"hc-middle-y":.48,"hc-key":"bt","hc-a2":"BT",name:"Bhutan",labelrank:"5","country-abbrev":"Bhutan",subregion:"Southern Asia","region-wb":"South Asia","iso-a3":"BTN","iso-a2":"BT","woe-id":"23424770",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[6842,7305],[6882,7338],[6923,7319],[6937,7293],[6869,7285],[6842,7305]]]}},{type:"Feature",id:"MD",properties:{"hc-group":"admin0","hc-middle-x":.52,"hc-middle-y":.42,"hc-key":"md","hc-a2":"MD",name:"Moldova",labelrank:"6","country-abbrev":"Mda.",subregion:"Eastern Europe","region-wb":"Europe & Central Asia","iso-a3":"MDA","iso-a2":"MD","woe-id":"23424885",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[5041,7922],[5042,7965],[5005,8023],[4994,8026],[5028,8033],[5072,8011],[5068,7999],[5097,7955],[5063,7958],[5041,7922]]]}},{type:"Feature",id:"SS",properties:{"hc-group":"admin0","hc-middle-x":.49,"hc-middle-y":.58,"hc-key":"ss","hc-a2":"SS",name:"South Sudan",labelrank:"3","country-abbrev":"S. Sud.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"SSD","iso-a2":"SS","woe-id":"-99",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5212,6603],[5198,6589],[5119,6582],[5088,6613],[5046,6605],[5018,6628],[4988,6658],[4987,6675],[4956,6696],[4921,6735],[4948,6783],[4970,6787],[4992,6760],[5060,6754],[5095,6783],[5131,6768],[5166,6806],[5156,6834],[5190,6840],[5189,6800],[5215,6758],[5211,6728],[5190,6729],[5185,6709],[5205,6705],[5235,6675],[5270,6615],[5255,6627],[5212,6603]]]}},{type:"Feature",id:"BW",properties:{"hc-group":"admin0","hc-middle-x":.49,"hc-middle-y":.6,"hc-key":"bw","hc-a2":"BW",name:"Botswana",labelrank:"4","country-abbrev":"Bwa.",subregion:"Southern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"BWA","iso-a2":"BW","woe-id":"23424755",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[4954,5949],[4979,5896],[5026,5865],[5036,5833],[5075,5814],[5041,5799],[5006,5769],[5e3,5749],[4972,5734],[4963,5706],[4941,5700],[4887,5716],[4878,5695],[4847,5667],[4818,5666],[4822,5690],[4797,5734],[4797,5819],[4827,5821],[4826,5933],[4895,5942],[4904,5928],[4954,5949]]]}},{type:"Feature",id:"BS",properties:{"hc-group":"admin0","hc-middle-x":.8,"hc-middle-y":.92,"hc-key":"bs","hc-a2":"BS",name:"The Bahamas",labelrank:"4","country-abbrev":"Bhs.",subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"BHS","iso-a2":"BS","woe-id":"23424758",continent:"North America"},geometry:{type:"MultiPolygon",coordinates:[[[[1956,7219],[1937,7241],[1937,7241],[1937,7241],[1944,7236],[1956,7219],[1956,7219]]],[[[1956,7219],[1970,7205],[1976,7173],[2045,7149],[1983,7165],[1949,7190],[1966,7207],[1956,7219],[1956,7219]]],[[[1937,7241],[1911,7260],[1890,7236],[1901,7192],[1881,7221],[1883,7237],[1912,7268],[1937,7241],[1937,7241],[1937,7241]]]]}},{type:"Feature",id:"NZ",properties:{"hc-group":"admin0","hc-middle-x":.25,"hc-middle-y":.81,"hc-key":"nz","hc-a2":"NZ",name:"New Zealand",labelrank:"2","country-abbrev":"N.Z.",subregion:"Australia and New Zealand","region-wb":"East Asia & Pacific","iso-a3":"NZL","iso-a2":"NZ","woe-id":"23424916",continent:"Oceania"},geometry:{type:"MultiPolygon",coordinates:[[[[9238,4994],[9198,4996],[9194,4975],[9181,5009],[9153,5008],[9145,5023],[9159,5047],[9201,5088],[9241,5104],[9282,5140],[9311,5200],[9330,5213],[9341,5185],[9362,5199],[9374,5165],[9321,5099],[9289,5079],[9268,5027],[9238,4994]]],[[[9429,5191],[9404,5174],[9386,5186],[9404,5221],[9361,5252],[9385,5272],[9393,5308],[9378,5347],[9341,5395],[9364,5402],[9402,5361],[9422,5343],[9427,5313],[9470,5301],[9503,5310],[9483,5263],[9469,5264],[9429,5191]]]]}},{type:"Feature",id:"CU",properties:{"hc-group":"admin0","hc-middle-x":.67,"hc-middle-y":.64,"hc-key":"cu","hc-a2":"CU",name:"Cuba",labelrank:"3","country-abbrev":"Cuba",subregion:"Caribbean","region-wb":"Latin America & Caribbean","iso-a3":"CUB","iso-a2":"CU","woe-id":"23424793",continent:"North America"},geometry:{type:"Polygon",coordinates:[[[1916,7091],[1870,7097],[1853,7124],[1817,7140],[1776,7144],[1774,7159],[1748,7160],[1696,7131],[1700,7149],[1734,7169],[1770,7175],[1828,7171],[1852,7150],[1867,7154],[1879,7155],[1933,7113],[1986,7095],[2e3,7078],[1898,7071],[1916,7091]]]}},{type:"Feature",id:"EC",properties:{"hc-group":"admin0","hc-middle-x":.16,"hc-middle-y":.37,"hc-key":"ec","hc-a2":"EC",name:"Ecuador",labelrank:"3","country-abbrev":"Ecu.",subregion:"South America","region-wb":"Latin America & Caribbean","iso-a3":"ECU","iso-a2":"EC","woe-id":"23424801",continent:"South America"},geometry:{type:"Polygon",coordinates:[[[1820,6379],[1837,6400],[1803,6410],[1803,6447],[1828,6480],[1827,6500],[1865,6521],[1905,6498],[1940,6492],[1970,6476],[1961,6433],[1928,6403],[1879,6379],[1858,6331],[1815,6358],[1820,6379]]]}},{type:"Feature",id:"AU",properties:{"hc-group":"admin0","hc-middle-x":.53,"hc-middle-y":.39,"hc-key":"au","hc-a2":"AU",name:"Australia",labelrank:"2","country-abbrev":"Auz.",subregion:"Australia and New Zealand","region-wb":"East Asia & Pacific","iso-a3":"AUS","iso-a2":"AU","woe-id":"-90",continent:"Oceania"},geometry:{type:"MultiPolygon",coordinates:[[[[8563,5105],[8537,5105],[8515,5139],[8497,5193],[8499,5215],[8479,5229],[8543,5191],[8602,5210],[8604,5168],[8595,5117],[8581,5130],[8563,5105]]],[[[8541,5953],[8550,5909],[8629,5866],[8644,5812],[8680,5798],[8682,5771],[8712,5753],[8733,5720],[8756,5726],[8746,5701],[8761,5650],[8762,5603],[8731,5487],[8709,5472],[8660,5372],[8655,5318],[8605,5306],[8551,5275],[8505,5283],[8507,5304],[8464,5271],[8430,5288],[8379,5298],[8351,5328],[8347,5368],[8329,5384],[8261,5366],[8280,5383],[8270,5405],[8300,5464],[8283,5464],[8229,5404],[8216,5439],[8189,5463],[8185,5486],[8128,5500],[8096,5519],[8032,5512],[7981,5492],[7949,5494],[7887,5463],[7870,5437],[7765,5438],[7718,5405],[7680,5400],[7646,5408],[7616,5433],[7637,5459],[7637,5513],[7616,5560],[7616,5583],[7592,5627],[7587,5653],[7556,5702],[7573,5710],[7590,5680],[7592,5701],[7570,5741],[7577,5802],[7645,5849],[7698,5861],[7793,5892],[7834,5938],[7830,5965],[7853,5985],[7871,5957],[7872,5998],[7896,5993],[7897,6026],[7916,6045],[7961,6056],[7971,6072],[8008,6042],[8052,6031],[8043,6051],[8090,6125],[8063,6129],[8073,6147],[8104,6146],[8105,6115],[8141,6119],[8139,6152],[8156,6132],[8212,6115],[8254,6129],[8267,6115],[8237,6071],[8224,6036],[8256,6011],[8329,5976],[8359,5951],[8384,5959],[8408,6030],[8406,6107],[8417,6122],[8422,6177],[8436,6161],[8463,6071],[8476,6048],[8492,6058],[8517,6035],[8519,5993],[8541,5953]]]]}},{type:"Feature",id:"VE",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.33,"hc-key":"ve","hc-a2":"VE",name:"Venezuela",labelrank:"3","country-abbrev":"Ven.",subregion:"South America","region-wb":"Latin America & Caribbean","iso-a3":"VEN","iso-a2":"VE","woe-id":"23424982",continent:"South America"},geometry:{type:"Polygon",coordinates:[[[2087,6830],[2070,6823],[2080,6796],[2064,6769],[2082,6746],[2096,6767],[2080,6799],[2122,6818],[2160,6818],[2188,6788],[2237,6794],[2282,6777],[2307,6793],[2343,6797],[2357,6776],[2400,6756],[2397,6742],[2423,6732],[2408,6709],[2415,6689],[2387,6672],[2382,6653],[2401,6632],[2377,6604],[2286,6596],[2303,6552],[2324,6550],[2301,6525],[2258,6498],[2219,6515],[2210,6549],[2191,6564],[2207,6580],[2190,6612],[2201,6662],[2143,6659],[2123,6685],[2064,6688],[2056,6726],[2037,6753],[2040,6787],[2068,6824],[2087,6830]]]}},{type:"Feature",id:"SB",properties:{"hc-group":"admin0","hc-middle-x":.13,"hc-middle-y":.24,"hc-key":"sb","hc-a2":"SB",name:"Solomon Islands",labelrank:"3","country-abbrev":"S. Is.",subregion:"Melanesia","region-wb":"East Asia & Pacific","iso-a3":"SLB","iso-a2":"SB","woe-id":"23424766",continent:"Oceania"},geometry:{type:"Polygon",coordinates:[[[8977,6187],[8947,6189],[8947,6226],[8902,6255],[8881,6242],[8899,6222],[8858,6239],[8861,6266],[8912,6255],[8947,6233],[8955,6212],[8982,6224],[8977,6187]]]}},{type:"Feature",id:"MG",properties:{"hc-group":"admin0","hc-middle-x":.45,"hc-middle-y":.48,"hc-key":"mg","hc-a2":"MG",name:"Madagascar",labelrank:"3","country-abbrev":"Mad.",subregion:"Eastern Africa","region-wb":"Sub-Saharan Africa","iso-a3":"MDG","iso-a2":"MG","woe-id":"23424883",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5683,5987],[5616,5762],[5601,5727],[5544,5707],[5511,5726],[5503,5774],[5487,5812],[5495,5841],[5524,5882],[5508,5959],[5523,5997],[5558,6004],[5613,6031],[5635,6081],[5650,6080],[5665,6125],[5686,6092],[5702,6020],[5677,6017],[5683,5987]]]}},{type:"Feature",id:"IS",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.5,"hc-key":"is","hc-a2":"IS",name:"Iceland",labelrank:"3","country-abbrev":"Iceland",subregion:"Northern Europe","region-wb":"Europe & Central Asia","iso-a3":"ISL","iso-a2":"IS","woe-id":"23424845",continent:"Europe"},geometry:{type:"Polygon",coordinates:[[[3490,8732],[3556,8739],[3551,8757],[3516,8766],[3476,8762],[3500,8775],[3508,8796],[3538,8790],[3534,8809],[3571,8786],[3566,8765],[3584,8755],[3607,8792],[3661,8795],[3682,8785],[3715,8796],[3713,8811],[3768,8789],[3763,8773],[3795,8763],[3803,8741],[3772,8709],[3677,8676],[3648,8661],[3605,8668],[3575,8684],[3530,8682],[3560,8708],[3538,8728],[3490,8732]]]}},{type:"Feature",id:"EG",properties:{"hc-group":"admin0","hc-middle-x":.5,"hc-middle-y":.66,"hc-key":"eg","hc-a2":"EG",name:"Egypt",labelrank:"2","country-abbrev":"Egypt",subregion:"Northern Africa","region-wb":"Middle East & North Africa","iso-a3":"EGY","iso-a2":"EG","woe-id":"23424802",continent:"Africa"},geometry:{type:"Polygon",coordinates:[[[5239,7374],[5220,7318],[5190,7345],[5169,7390],[5172,7358],[5201,7320],[5213,7282],[5258,7199],[5263,7167],[5299,7138],[5131,7138],[4945,7138],[4945,7364],[4937,7397],[4950,7445],[5015,7435],[5065,7418],[5105,7440],[5140,7438],[5157,7425],[5219,7433],[5237,7382],[5239,7374]]]}},{type:"Feature",id:"KG",properties:{"hc-group":"admin0","hc-middle-x":.48,"hc-middle-y":.43,"hc-key":"kg","hc-a2":"KG",name:"Kyrgyzstan",labelrank:"4","country-abbrev":"Kgz.",subregion:"Central Asia","region-wb":"Europe & Central Asia","iso-a3":"KGZ","iso-a2":"KG","woe-id":"23424864",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[6389,7707],[6348,7698],[6325,7713],[6261,7709],[6280,7734],[6310,7734],[6331,7731],[6374,7754],[6333,7777],[6323,7766],[6286,7782],[6309,7805],[6336,7826],[6385,7812],[6405,7842],[6435,7827],[6531,7828],[6584,7803],[6529,7774],[6521,7763],[6482,7759],[6450,7736],[6446,7748],[6399,7728],[6389,7707]],[[6300,7721],[6296,7722],[6299,7718],[6302,7720],[6300,7721]],[[6333,7723],[6334,7726],[6331,7724],[6332,7723],[6333,7723]],[[6316,7728],[6310,7729],[6312,7722],[6317,7722],[6316,7728]]]}},{type:"Feature",id:"NP",properties:{"hc-group":"admin0","hc-middle-x":.52,"hc-middle-y":.54,"hc-key":"np","hc-a2":"NP",name:"Nepal",labelrank:"3","country-abbrev":"Nepal",subregion:"Southern Asia","region-wb":"South Asia","iso-a3":"NPL","iso-a2":"NP","woe-id":"23424911",continent:"Asia"},geometry:{type:"Polygon",coordinates:[[[6819,7322],[6820,7286],[6795,7274],[6751,7281],[6714,7305],[6660,7310],[6579,7353],[6589,7383],[6608,7397],[6640,7401],[6683,7364],[6699,7367],[6729,7336],[6756,7323],[6773,7330],[6819,7322]]]}}]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mapData2=[{code3:"ABW",name:"Aruba",value:582.34,code:"AW"},{code3:"AFG",name:"Afghanistan",value:53.08,code:"AF"},{code3:"AGO",name:"Angola",value:23.11,code:"AO"},{code3:"ALB",name:"Albania",value:104.97,code:"AL"},{code3:"AND",name:"Andorra",value:164.43,code:"AD"},{code3:"ARE",name:"United Arab Emirates",value:110.88,code:"AE"},{code3:"ARG",name:"Argentina",value:16.02,code:"AR"},{code3:"ARM",name:"Armenia",value:102.73,code:"AM"},{code3:"ASM",name:"American Samoa",value:278,code:"AS"},{code3:"ATG",name:"Antigua and Barbuda",value:229.46,code:"AG"},{code3:"AUS",name:"Australia",value:3.15,code:"AU"},{code3:"AUT",name:"Austria",value:105.81,code:"AT"},{code3:"AZE",name:"Azerbaijan",value:118.04,code:"AZ"},{code3:"BDI",name:"Burundi",value:409.82,code:"BI"},{code3:"BEL",name:"Belgium",value:374.45,code:"BE"},{code3:"BEN",name:"Benin",value:96.42,code:"BJ"},{code3:"BFA",name:"Burkina Faso",value:68.15,code:"BF"},{code3:"BGD",name:"Bangladesh",value:1251.84,code:"BD"},{code3:"BGR",name:"Bulgaria",value:65.66,code:"BG"},{code3:"BHR",name:"Bahrain",value:1848.47,code:"BH"},{code3:"BHS",name:"Bahamas, The",value:39.08,code:"BS"},{code3:"BIH",name:"Bosnia and Herzegovina",value:68.69,code:"BA"},{code3:"BLR",name:"Belarus",value:46.83,code:"BY"},{code3:"BLZ",name:"Belize",value:16.09,code:"BZ"},{code3:"BMU",name:"Bermuda",value:1307.52,code:"BM"},{code3:"BOL",name:"Bolivia",value:10.05,code:"BO"},{code3:"BRA",name:"Brazil",value:24.84,code:"BR"},{code3:"BRB",name:"Barbados",value:662.78,code:"BB"},{code3:"BRN",name:"Brunei Darussalam",value:80.3,code:"BN"},{code3:"BTN",name:"Bhutan",value:20.93,code:"BT"},{code3:"BWA",name:"Botswana",value:3.97,code:"BW"},{code3:"CAF",name:"Central African Republic",value:7.38,code:"CF"},{code3:"CAN",name:"Canada",value:3.99,code:"CA"},{code3:"CHE",name:"Switzerland",value:211.87,code:"CH"},{code3:"CHL",name:"Chile",value:24.09,code:"CL"},{code3:"CHN",name:"China",value:146.85,code:"CN"},{code3:"CIV",name:"Cote d'Ivoire",value:74.52,code:"CI"},{code3:"CMR",name:"Cameroon",value:49.58,code:"CM"},{code3:"COD",name:"Congo, Dem. Rep.",value:34.73,code:"CD"},{code3:"COG",name:"Congo, Rep.",value:15.01,code:"CG"},{code3:"COL",name:"Colombia",value:43.85,code:"CO"},{code3:"COM",name:"Comoros",value:427.51,code:"KM"},{code3:"CPV",name:"Cabo Verde",value:133.89,code:"CV"},{code3:"CRI",name:"Costa Rica",value:95.13,code:"CR"},{code3:"CUB",name:"Cuba",value:110.32,code:"CU"},{code3:"CUW",name:"Curacao",value:359.6,code:"CW"},{code3:"CYM",name:"Cayman Islands",value:253.19,code:"KY"},{code3:"CYP",name:"Cyprus",value:126.64,code:"CY"},{code3:"CZE",name:"Czech Republic",value:136.85,code:"CZ"},{code3:"DEU",name:"Germany",value:236.42,code:"DE"},{code3:"DJI",name:"Djibouti",value:40.65,code:"DJ"},{code3:"DMA",name:"Dominica",value:98.06,code:"DM"},{code3:"DNK",name:"Denmark",value:135.54,code:"DK"},{code3:"DOM",name:"Dominican Republic",value:220.43,code:"DO"},{code3:"DZA",name:"Algeria",value:17.05,code:"DZ"},{code3:"ECU",name:"Ecuador",value:65.97,code:"EC"},{code3:"EGY",name:"Egypt, Arab Rep.",value:96.13,code:"EG"},{code3:"ESP",name:"Spain",value:92.93,code:"ES"},{code3:"EST",name:"Estonia",value:31.04,code:"EE"},{code3:"ETH",name:"Ethiopia",value:102.4,code:"ET"},{code3:"FIN",name:"Finland",value:18.08,code:"FI"},{code3:"FJI",name:"Fiji",value:49.19,code:"FJ"},{code3:"FRA",name:"France",value:122.16,code:"FR"},{code3:"FRO",name:"Faroe Islands",value:35.18,code:"FO"},{code3:"FSM",name:"Micronesia, Fed. Sts.",value:149.91,code:"FM"},{code3:"GAB",name:"Gabon",value:7.68,code:"GA"},{code3:"GBR",name:"United Kingdom",value:271.13,code:"GB"},{code3:"GEO",name:"Georgia",value:53.52,code:"GE"},{code3:"GHA",name:"Ghana",value:123.96,code:"GH"},{code3:"GIB",name:"Gibraltar",value:3440.8,code:"GI"},{code3:"GIN",name:"Guinea",value:50.45,code:"GN"},{code3:"GMB",name:"Gambia, The",value:201.43,code:"GM"},{code3:"GNB",name:"Guinea-Bissau",value:64.57,code:"GW"},{code3:"GNQ",name:"Equatorial Guinea",value:43.55,code:"GQ"},{code3:"GRC",name:"Greece",value:83.56,code:"GR"},{code3:"GRD",name:"Grenada",value:315.64,code:"GD"},{code3:"GRL",name:"Greenland",value:.14,code:"GL"},{code3:"GTM",name:"Guatemala",value:154.74,code:"GT"},{code3:"GUM",name:"Guam",value:301.66,code:"GU"},{code3:"GUY",name:"Guyana",value:3.93,code:"GY"},{code3:"HKG",name:"Hong Kong SAR, China",value:6987.24,code:"HK"},{code3:"HND",name:"Honduras",value:81.44,code:"HN"},{code3:"HRV",name:"Croatia",value:74.6,code:"HR"},{code3:"HTI",name:"Haiti",value:393.59,code:"HT"},{code3:"HUN",name:"Hungary",value:108.41,code:"HU"},{code3:"IDN",name:"Indonesia",value:144.14,code:"ID"},{code3:"IMN",name:"Isle of Man",value:146.91,code:"IM"},{code3:"IND",name:"India",value:445.37,code:"IN"},{code3:"IRL",name:"Ireland",value:68.95,code:"IE"},{code3:"IRN",name:"Iran, Islamic Rep.",value:49.29,code:"IR"},{code3:"IRQ",name:"Iraq",value:85.66,code:"IQ"},{code3:"ISL",name:"Iceland",value:3.35,code:"IS"},{code3:"ISR",name:"Israel",value:394.92,code:"IL"},{code3:"ITA",name:"Italy",value:206.12,code:"IT"},{code3:"JAM",name:"Jamaica",value:266.05,code:"JM"},{code3:"JOR",name:"Jordan",value:106.51,code:"JO"},{code3:"JPN",name:"Japan",value:348.35,code:"JP"},{code3:"KAZ",name:"Kazakhstan",value:6.59,code:"KZ"},{code3:"KEN",name:"Kenya",value:85.15,code:"KE"},{code3:"KGZ",name:"Kyrgyz Republic",value:31.7,code:"KG"},{code3:"KHM",name:"Cambodia",value:89.3,code:"KH"},{code3:"KIR",name:"Kiribati",value:141.23,code:"KI"},{code3:"KNA",name:"St. Kitts and Nevis",value:210.85,code:"KN"},{code3:"KOR",name:"Korea, Rep.",value:525.7,code:"KR"},{code3:"KWT",name:"Kuwait",value:227.42,code:"KW"},{code3:"LAO",name:"Lao PDR",value:29.28,code:"LA"},{code3:"LBN",name:"Lebanon",value:587.16,code:"LB"},{code3:"LBR",name:"Liberia",value:47.9,code:"LR"},{code3:"LBY",name:"Libya",value:3.58,code:"LY"},{code3:"LCA",name:"St. Lucia",value:291.83,code:"LC"},{code3:"LIE",name:"Liechtenstein",value:235.41,code:"LI"},{code3:"LKA",name:"Sri Lanka",value:338.11,code:"LK"},{code3:"LSO",name:"Lesotho",value:72.59,code:"LS"},{code3:"LTU",name:"Lithuania",value:45.78,code:"LT"},{code3:"LUX",name:"Luxembourg",value:224.72,code:"LU"},{code3:"LVA",name:"Latvia",value:31.51,code:"LV"},{code3:"MAC",name:"Macao SAR, China",value:20405.57,code:"MO"},{code3:"MAF",name:"St. Martin (French part)",value:591.65,code:"MF"},{code3:"MAR",name:"Morocco",value:79.04,code:"MA"},{code3:"MCO",name:"Monaco",value:19249.5,code:"MC"},{code3:"MDA",name:"Moldova",value:108.06,code:"MD"},{code3:"MDG",name:"Madagascar",value:42.79,code:"MG"},{code3:"MDV",name:"Maldives",value:1425.85,code:"MV"},{code3:"MEX",name:"Mexico",value:65.61,code:"MX"},{code3:"MHL",name:"Marshall Islands",value:294.81,code:"MH"},{code3:"MKD",name:"Macedonia, FYR",value:82.52,code:"MK"},{code3:"MLI",name:"Mali",value:14.75,code:"ML"},{code3:"MLT",name:"Malta",value:1366.93,code:"MT"},{code3:"MMR",name:"Myanmar",value:80.98,code:"MM"},{code3:"MNE",name:"Montenegro",value:46.27,code:"ME"},{code3:"MNG",name:"Mongolia",value:1.95,code:"MN"},{code3:"MNP",name:"Northern Mariana Islands",value:119.62,code:"MP"},{code3:"MOZ",name:"Mozambique",value:36.66,code:"MZ"},{code3:"MRT",name:"Mauritania",value:4.17,code:"MR"},{code3:"MUS",name:"Mauritius",value:622.4,code:"MU"},{code3:"MWI",name:"Malawi",value:191.89,code:"MW"},{code3:"MYS",name:"Malaysia",value:94.92,code:"MY"},{code3:"NAM",name:"Namibia",value:3.01,code:"NA"},{code3:"NCL",name:"New Caledonia",value:15.15,code:"NC"},{code3:"NER",name:"Niger",value:16.32,code:"NE"},{code3:"NGA",name:"Nigeria",value:204.21,code:"NG"},{code3:"NIC",name:"Nicaragua",value:51.1,code:"NI"},{code3:"NLD",name:"Netherlands",value:505.5,code:"NL"},{code3:"NOR",name:"Norway",value:14.34,code:"NO"},{code3:"NPL",name:"Nepal",value:202.18,code:"NP"},{code3:"NRU",name:"Nauru",value:652.45,code:"NR"},{code3:"NZL",name:"New Zealand",value:17.82,code:"NZ"},{code3:"OMN",name:"Oman",value:14.3,code:"OM"},{code3:"PAK",name:"Pakistan",value:250.63,code:"PK"},{code3:"PAN",name:"Panama",value:54.27,code:"PA"},{code3:"PER",name:"Peru",value:24.82,code:"PE"},{code3:"PHL",name:"Philippines",value:346.51,code:"PH"},{code3:"PLW",name:"Palau",value:46.75,code:"PW"},{code3:"PNG",name:"Papua New Guinea",value:17.85,code:"PG"},{code3:"POL",name:"Poland",value:124.01,code:"PL"},{code3:"PRI",name:"Puerto Rico",value:384.59,code:"PR"},{code3:"PRK",name:"Korea, Dem. People’s Rep.",value:210.69,code:"KP"},{code3:"PRT",name:"Portugal",value:112.72,code:"PT"},{code3:"PRY",name:"Paraguay",value:16.93,code:"PY"},{code3:"PSE",name:"West Bank and Gaza",value:756.07,code:"PS"},{code3:"PYF",name:"French Polynesia",value:76.56,code:"PF"},{code3:"QAT",name:"Qatar",value:221.34,code:"QA"},{code3:"ROU",name:"Romania",value:85.62,code:"RO"},{code3:"RUS",name:"Russian Federation",value:8.81,code:"RU"},{code3:"RWA",name:"Rwanda",value:483.08,code:"RW"},{code3:"SAU",name:"Saudi Arabia",value:15.01,code:"SA"},{code3:"SDN",name:"Sudan",value:16.66,code:"SD"},{code3:"SEN",name:"Senegal",value:80.05,code:"SN"},{code3:"SGP",name:"Singapore",value:7908.72,code:"SG"},{code3:"SLB",name:"Solomon Islands",value:21.42,code:"SB"},{code3:"SLE",name:"Sierra Leone",value:102.47,code:"SL"},{code3:"SLV",name:"El Salvador",value:306.21,code:"SV"},{code3:"SMR",name:"San Marino",value:553.38,code:"SM"},{code3:"SOM",name:"Somalia",value:22.82,code:"SO"},{code3:"SRB",name:"Serbia",value:80.7,code:"RS"},{code3:"STP",name:"Sao Tome and Principe",value:208.24,code:"ST"},{code3:"SUR",name:"Suriname",value:3.58,code:"SR"},{code3:"SVK",name:"Slovak Republic",value:112.94,code:"SK"},{code3:"SVN",name:"Slovenia",value:102.53,code:"SI"},{code3:"SWE",name:"Sweden",value:24.36,code:"SE"},{code3:"SWZ",name:"Swaziland",value:78.09,code:"SZ"},{code3:"SXM",name:"Sint Maarten (Dutch part)",value:1175.56,code:"SX"},{code3:"SYC",name:"Seychelles",value:205.82,code:"SC"},{code3:"SYR",name:"Syrian Arab Republic",value:100.37,code:"SY"},{code3:"TCA",name:"Turks and Caicos Islands",value:36.74,code:"TC"},{code3:"TCD",name:"Chad",value:11.48,code:"TD"},{code3:"TGO",name:"Togo",value:139.85,code:"TG"},{code3:"THA",name:"Thailand",value:134.79,code:"TH"},{code3:"TJK",name:"Tajikistan",value:62.94,code:"TJ"},{code3:"TKM",name:"Turkmenistan",value:12.05,code:"TM"},{code3:"TLS",name:"Timor-Leste",value:85.32,code:"TL"},{code3:"TON",name:"Tonga",value:148.78,code:"TO"},{code3:"TTO",name:"Trinidad and Tobago",value:266.07,code:"TT"},{code3:"TUN",name:"Tunisia",value:73.4,code:"TN"},{code3:"TUR",name:"Turkey",value:103.31,code:"TR"},{code3:"TUV",name:"Tuvalu",value:369.9,code:"TV"},{code3:"TZA",name:"Tanzania",value:62.74,code:"TZ"},{code3:"UGA",name:"Uganda",value:206.9,code:"UG"},{code3:"UKR",name:"Ukraine",value:77.69,code:"UA"},{code3:"URY",name:"Uruguay",value:19.68,code:"UY"},{code3:"USA",name:"United States",value:35.32,code:"US"},{code3:"UZB",name:"Uzbekistan",value:74.87,code:"UZ"},{code3:"VCT",name:"St. Vincent and the Grenadines",value:281.14,code:"VC"},{code3:"VEN",name:"Venezuela, RB",value:35.79,code:"VE"},{code3:"VGB",name:"British Virgin Islands",value:204.41,code:"VG"},{code3:"VIR",name:"Virgin Islands (U.S.)",value:307.17,code:"VI"},{code3:"VNM",name:"Vietnam",value:304.99,code:"VN"},{code3:"VUT",name:"Vanuatu",value:22.18,code:"VU"},{code3:"WSM",name:"Samoa",value:68.95,code:"WS"},{code3:"YEM",name:"Yemen, Rep.",value:52.25,code:"YE"},{code3:"ZAF",name:"South Africa",value:46.18,code:"ZA"},{code3:"ZMB",name:"Zambia",value:22.32,code:"ZM"},{code3:"ZWE",name:"Zimbabwe",value:41.75,code:"ZW"}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=h(n(47)),s=n(138),l=h(n(69)),c=n(8),u=n(6),d=h(n(275)),f=n(15),p=n(12),m=h(n(153)),g=n(205),y=n(11);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.identifier=(0,i.default)(),n.formatDataQuery=function(e,t,a){var r=n.props.colors;if(e.length&&e[0].count){var o=Object.keys(r),i=o[a%o.length];return[{yKey:e[0].count,xKey:t,color:i}]}return[]},n.fetchData=function(e,t){var a=e.map((function(e,a){return n.fetchQuery(e,t,a)}));return Promise.all(a).then((function(e){n.setState({loading:!1,queryResult:e.reduce((function(e,t,n){return e.concat(t)}),[])})})).catch((function(){n.setState({error:!0,loading:!1})}))},n.fetchQuery=function(e,t,a){return n._queryService.getQuery(t,e).then((function(e){return e.data})).then((function(e){return(0,g.getFormattedQuery)(t,n._queryService,e)})).then((function(e){return n._queryService.runOTQLQuery(t,e.query_text,{use_cache:!0}).then((function(e){return e.data})).then((function(e){if((0,s.isCountResult)(e.rows))return Promise.resolve(n.formatDataQuery(e.rows,n.props.plotLabels[a]?n.props.plotLabels[a]:a.toString(),a));throw new Error("wrong query type")}))}))},n.generateOptions=function(){return{innerRadius:!0,isHalf:!1,text:{},colors:n.state.colors,showTooltip:!0}};var a=e.colors,r=[a["mcs-warning"],a["mcs-info"],a["mcs-highlight"],a["mcs-success"],a["mcs-normal"],a["mcs-primary"],a["mcs-error"]];return n.state={error:!1,loading:!0,colors:r},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.queryIds,n=e.datamartId;this.fetchData(t,n)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.queryIds,a=t.datamartId,r=e.queryIds,o=e.datamartId;n===r&&a===o||this.fetchData(n,a)}},{key:"render",value:function(){var e=this,t=this.props,n=t.title,a=t.colors,r=t.intl,i=t.height,s={xKey:"xKey",yKeys:[{key:"yKey",message:""}],colors:[a["mcs-info"]],labelsEnabled:this.props.labelsEnabled,showTooltip:!0};return o.createElement(m.default,{title:n},e.state.loading?o.createElement(y.LoadingChart,null):e.state.error?o.createElement(y.EmptyChart,{title:r.formatMessage(d.default.error),icon:"close-big"}):e.state.queryResult&&0===e.state.queryResult.length||!e.state.queryResult?o.createElement(y.EmptyChart,{title:r.formatMessage(d.default.noData),icon:"warning"}):o.createElement(y.StackedBarPlot,{dataset:e.state.queryResult,options:s,height:i}))}}]),t}(o.Component);v([(0,f.lazyInject)(p.TYPES.IQueryService)],b.prototype,"_queryService",void 0),t.default=(0,c.compose)(l.default,u.injectIntl)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=p(n(54)),s=n(138),l=n(56),c=n(15),u=n(12),d=p(n(153)),f=n(205);function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchData=function(e,t,a,r){return Promise.all([n.fetchQuery(e,a,r),n.fetchQuery(t,a,r)]).then((function(e){var t=e[0],a=e[1];return"number"==typeof t&&"number"==typeof a&&n.setState({queryResult:Math.round(t/a*1e3)/10,loading:!1}),Promise.reject(new Error("Error"))})).catch((function(){n.setState({error:!0,loading:!1})}))},n.fetchQuery=function(e,t,a){return n.setState({error:!1,loading:!0}),n._queryService.getQuery(t,e).then((function(e){return e.data})).then((function(e){return(0,f.getFormattedQuery)(t,n._queryService,e,a)})).then((function(e){var a=e.query_text;return n._queryService.runOTQLQuery(t,a,{use_cache:!0}).then((function(e){return e.data})).then((function(e){if((0,s.isCountResult)(e.rows))return e.rows[0].count;throw new Error("wrong query type")}))}))},n.state={error:!1,loading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.source,n=e.datamartId,a=e.queryId,r=e.totalQueryId;this.fetchData(a,r,n,t)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.source,a=t.queryId,r=t.datamartId,o=t.totalQueryId,s=e.source,l=e.queryId,c=e.datamartId,u=e.totalQueryId;i.default.isEqual(s,n)&&a===l&&r===c&&o===u||this.fetchData(a,o,r,n)}},{key:"render",value:function(){return o.createElement(d.default,null,o.createElement("div",{className:"dashboard-counter"},o.createElement("div",{className:"count-title"},this.state.loading?o.createElement("i",{className:"mcs-table-cell-loading",style:{maxWidth:"40%"}}):this.props.title),o.createElement("div",{className:"count-result"},this.state.loading?o.createElement("i",{className:"mcs-table-cell-loading-large",style:{maxWidth:"100%"}}):(0,l.formatMetric)(this.state.queryResult,"0,0","","%"))))}}]),t}(o.Component);t.default=g,m([(0,c.lazyInject)(u.TYPES.IQueryService)],g.prototype,"_queryService",void 0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=h(n(47)),s=n(138),l=h(n(69)),c=n(8),u=n(6),d=h(n(275)),f=n(15),p=n(12),m=h(n(153)),g=n(205),y=n(11);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.identifier=(0,i.default)(),n.formatDataQuery=function(e,t,a){var r=n.props.colors;if(e.length&&e[0].count){var o=Object.keys(r),i=o[a%o.length];return[{value:e[0].count,key:t,color:i}]}return[]},n.fetchData=function(e,t,a){n.setState({error:!1,loading:!0});var r=e.map((function(e,a){return n.fetchQuery(e,t,a)}));return Promise.all(r).then((function(e){n.setState({loading:!1,queryResult:e.reduce((function(e,t,n){return e.concat(t)}),[])})})).catch((function(){n.setState({error:!0,loading:!1})}))},n.fetchQuery=function(e,t,a,r){return n._queryService.getQuery(t,e).then((function(e){return e.data})).then((function(e){return(0,g.getFormattedQuery)(t,n._queryService,e,r)})).then((function(e){return n._queryService.runOTQLQuery(t,e.query_text,{use_cache:!0}).then((function(e){return e.data})).then((function(e){if((0,s.isCountResult)(e.rows))return Promise.resolve(n.formatDataQuery(e.rows,n.props.plotLabels[a]?n.props.plotLabels[a]:a.toString(),a));throw new Error("wrong query type")}))}))},n.state={error:!1,loading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.segment,n=e.queryIds,a=e.datamartId;this.fetchData(n,a,t)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.segment,a=t.queryIds,r=t.datamartId,o=e.segment,i=e.queryIds,s=e.datamartId;n===o&&a===i&&r===s||this.fetchData(a,r,n)}},{key:"render",value:function(){var e,t=this,n=this.props,a=n.title,r=n.colors,i=n.intl,s=n.height,l=n.queryIds,c={colors:(e=Object.keys(r).filter((function(e){return"mcs-normal"!==e})),l.map((function(t,n){return r[e[n%(e.length-1)]]}))),showLabels:this.props.labelsEnabled,showTooltip:!0,isHalf:!1,innerRadius:!0};return o.createElement(m.default,{title:a},t.state.loading?o.createElement(y.LoadingChart,null):t.state.error?o.createElement(y.EmptyChart,{title:i.formatMessage(d.default.error),icon:"close-big"}):t.state.queryResult&&0===t.state.queryResult.length||!t.state.queryResult?o.createElement(y.EmptyChart,{title:i.formatMessage(d.default.noData),icon:"warning"}):o.createElement(y.PiePlot,{dataset:t.state.queryResult,options:c,height:s}))}}]),t}(o.Component);v([(0,f.lazyInject)(p.TYPES.IQueryService)],b.prototype,"_queryService",void 0),t.default=(0,c.compose)(l.default,u.injectIntl)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=y(n(54)),s=n(138),l=n(15),c=n(12),u=y(n(153)),d=n(205),f=y(n(275)),p=n(6),m=n(8),g=n(11);function y(e){return e&&e.__esModule?e:{default:e}}var h=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchData=function(e,t,a){return n.setState({error:!1,loading:!0}),n._queryService.getQuery(t,e).then((function(e){return e.data})).then((function(e){return(0,d.getFormattedQuery)(t,n._queryService,e,a)})).then((function(e){var a=e.query_text;return n._queryService.runOTQLQuery(t,a,{use_cache:!0}).then((function(e){return e.data})).then((function(e){if((0,s.isAggregateResult)(e.rows))return n.setState({queryResult:e.rows[0].aggregations.buckets[0]&&e.rows[0].aggregations.buckets[0].buckets?e.rows[0].aggregations.buckets[0].buckets:[],loading:!1}),Promise.resolve();var t=new Error("wrong query type");return Promise.reject(t)}))})).catch((function(){n.setState({error:!0,loading:!1})}))},n.renderChart=function(){var e=n.props.intl,t=n.state,a=t.loading,r=t.error,i=t.queryResult;return a?o.createElement(g.LoadingChart,null):r?o.createElement(g.EmptyChart,{title:e.formatMessage(f.default.error),icon:"close-big"}):i&&0!==i.length?o.createElement("div",null,i.map((function(e){return o.createElement("div",{key:e.key,style:{padding:"5px 5px",width:"100%"}},o.createElement("div",{style:{display:"inline"}},e.key),o.createElement("div",{style:{float:"right"}},e.count))}))):o.createElement(g.EmptyChart,{title:e.formatMessage(f.default.noData),icon:"close-big"})},n.state={error:!1,loading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.source,n=e.datamartId,a=e.queryId;this.fetchData(a,n,t)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.source,a=t.queryId,r=t.datamartId,o=e.source,s=e.queryId,l=e.datamartId;i.default.isEqual(o,n)&&a===s&&r===l||this.fetchData(a,r,n)}},{key:"render",value:function(){return o.createElement(u.default,{title:this.props.title},this.renderChart())}}]),t}(o.Component);h([(0,l.lazyInject)(c.TYPES.IQueryService)],v.prototype,"_queryService",void 0),t.default=(0,m.compose)(p.injectIntl)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=_(n(47)),l=_(n(54)),c=n(138),u=_(n(69)),d=n(8),f=n(6),p=_(n(275)),m=n(15),g=n(12),y=_(n(153)),h=n(205),v=_(n(2212)),b=n(11);function _(e){return e&&e.__esModule?e:{default:e}}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O="yKey",w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.identifier=(0,s.default)(),n.formatOtqlQueryResult=function(e){return e&&(0,c.isAggregateResult)(e.rows)&&!(0,c.isCountResult)(e.rows)?n.setState({queryResult:n.formatData(e.rows,O),loading:!1}):n.setState({error:!0,loading:!1})},n.formatData=function(e,t){var a=n.props.percentage;if(e.length&&e[0].aggregations.buckets.length&&e[0].aggregations.buckets[0].buckets.length){var r=a?e[0].aggregations.buckets[0].buckets.reduce((function(e,t){return e+t.count}),0):void 0;return e[0].aggregations.buckets[0].buckets.map((function(e,n){var a;return S(a={},t+"-count",e.count),S(a,t,r?Math.round(e.count/r*1e4)/100:e.count),S(a,"xKey",e.key),a}))}return[]},n.mergeData=function(e,t,n,a){return e.map((function(e){return e.xKey})).concat(n.map((function(e){return e.xKey}))).filter((function(e,t,n){return n.indexOf(e)===t})).map((function(r){var o;return S(o={},a,n.find((function(e){return e.xKey===r}))&&n.find((function(e){return e.xKey===r}))[a]?n.find((function(e){return e.xKey===r}))[a]:0),S(o,t,e.find((function(e){return e.xKey===r}))&&e.find((function(e){return e.xKey===r}))[t]?e.find((function(e){return e.xKey===r}))[t]:0),S(o,"xKey",r),o}))},n.fetchData=function(e,t,r,o){n.setState({error:!1,loading:!0});var i=r?n._queryService.getQuery(t,e).then((function(e){return e.data})).then((function(e){return(0,h.getFormattedQuery)(t,n._queryService,e)})):Promise.resolve();return Promise.all([n._queryService.getQuery(t,e).then((function(e){return e.data})).then((function(e){return(0,h.getFormattedQuery)(t,n._queryService,e,o)})),i]).then((function(e){var r,o=a(e,2),i=o[0],s=o[1];return Promise.all([n._queryService.runOTQLQuery(t,i.query_text,{use_cache:!0}).then((function(e){return e.data})),(r=s,r?n._queryService.runOTQLQuery(t,r.query_text,{use_cache:!0}).then((function(e){return e.data})):Promise.resolve())]).then((function(e){var t=a(e,2),r=t[0],o=t[1];if(r&&!o&&(0,c.isAggregateResult)(r.rows)&&!(0,c.isCountResult)(r.rows))return n.setState({queryResult:n.formatData(r.rows,O),loading:!1}),Promise.resolve();if(r&&o&&(0,c.isAggregateResult)(r.rows)&&!(0,c.isCountResult)(r.rows)&&(0,c.isAggregateResult)(o.rows)&&!(0,c.isCountResult)(o.rows))return n.setState({queryResult:n.mergeData(n.formatData(r.rows,O),O,n.formatData(o.rows,"comparedYKey"),"comparedYKey"),loading:!1}),Promise.resolve();var i=new Error("wrong query type");return Promise.reject(i)})).catch((function(){return n.setState({error:!0,loading:!1})}))})).catch((function(){return n.setState({error:!0,loading:!1})}))};var r=e.colors,o=[r["mcs-warning"],r["mcs-info"],r["mcs-highlight"],r["mcs-success"],r["mcs-normal"],r["mcs-primary"],r["mcs-error"]];return n.state={error:!1,loading:!0,colors:o},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.source,n=e.queryId,a=e.datamartId,r=e.shouldCompare,o=e.data;o?this.formatOtqlQueryResult(o):this.fetchData(n,a,r,t)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.source,a=t.queryId,r=t.datamartId,o=t.shouldCompare,i=t.data,s=e.source,c=e.queryId,u=e.datamartId,d=e.data;l.default.isEqual(s,n)&&a===c&&r===u&&l.default.isEqual(i,d)||(i?this.formatOtqlQueryResult(i):this.fetchData(a,r,o,n))}},{key:"render",value:function(){var e=this,t=this.props,n=t.title,a=t.colors,r=t.intl,o=t.shouldCompare,s=t.vertical,l=t.labels,c=t.tooltip,u=t.sortKey,d={xKey:"xKey",yKeys:[{key:O,message:""}].concat(o?[{key:"comparedYKey",message:""}]:[]),colors:[a["mcs-info"]].concat(o?[a["mcs-normal"]]:[]),labelsEnabled:this.props.labelsEnabled,vertical:s,labels:l,sort:u,tooltip:c};return i.createElement(y.default,{title:n},e.state.loading?i.createElement(b.LoadingChart,null):e.state.error?i.createElement(b.EmptyChart,{title:r.formatMessage(p.default.error),icon:"close-big"}):e.state.queryResult&&0===e.state.queryResult.length||!e.state.queryResult?i.createElement(b.EmptyChart,{title:r.formatMessage(p.default.noData),icon:"warning"}):e.state.queryResult&&e.state.queryResult.length&&i.createElement(v.default,{dataset:e.state.queryResult,options:d}))}}]),t}(i.Component);E([(0,m.lazyInject)(g.TYPES.IQueryService)],w.prototype,"_queryService",void 0),t.default=(0,d.compose)(u.default,f.injectIntl)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=f(n(0)),i=f(n(203)),s=n(339),l=(a=s)&&a.__esModule?a:{default:a},c=n(6),u=n(8),d=n(619);function f(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}n(2213)(i);var p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getXAxisValues=function(e,t,n){return e.map((function(e){return e[t]})).sort((function(e,t){return n?e.localeCompare(t):1}))},n.formatSerieData=function(e,t,n,a){return(a?e.sort((function(e,t){return e[n].localeCompare(t[n])})):e).map((function(e){return{y:e[t.key]?e[t.key]:0,count:e[t.key+"-count"]}}))},n.formatSeries=function(e,t,a,r,o){var i=n.props.intl.formatMessage;return t.map((function(t){return{name:"string"==typeof t.message?t.message:i(t.message),data:n.formatSerieData(e,t,a,o),pointPlacement:"on",dataLabels:r?{enabled:r.enable,format:r.format,style:{"font-family":'LLCircularWeb-Book, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif',color:"#666666"},filter:r.filterValue?{property:t,operator:">",value:r.filterValue}:void 0}:{enabled:!1}}}))},n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.dataset,n=e.options,a=n.colors,r=n.xKey,s=n.yKeys,c=n.showLegend,u=n.tooltip,f=n.labels,p=n.sort,m=e.height,g={chart:{polar:!0,type:"line",height:m||d.BASE_CHART_HEIGHT},title:{text:""},colors:a,xAxis:{categories:this.getXAxisValues(t,r,p),tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0},series:this.formatSeries(t,s,r,f,p),credits:{enabled:!1},tooltip:Object.assign({shared:!0},(0,d.generateTooltip)(void 0,void 0,u)),legend:{enabled:void 0!==c&&c}};return o.createElement(l.default,{highcharts:i,options:g,style:{width:"100%"}})}}]),t}(o.Component);t.default=(0,u.compose)(c.injectIntl)(p)},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudienceFeatureFieldArray=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(35),i=n(10),s=n(8),l=n(6),c=n(227),u=n(11),d=y(n(2215)),f=y(n(162)),p=y(n(1085)),m=n(73),g=y(n(2217));function y(e){return e&&e.__esModule?e:{default:e}}var h=t.AudienceFeatureFieldArray=o.FieldArray,v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.addGroupExpression=function(e){return function(){var t=n.props.fields,a={type:"GROUP",boolean_operator:"OR",negation:e,expressions:[]};t.push(a)}},n.renderQueryBuilderButtons=function(){return r.createElement("div",{className:"mcs-audienceBuilder_queryButtons"},r.createElement(i.Button,{className:"mcs-audienceBuilder_narrowWithButton",onClick:n.addGroupExpression(!1)},"Narrow with"),r.createElement("br",null),"- or -",r.createElement("br",null),r.createElement(i.Button,{className:"mcs-audienceBuilder_excludeButton",onClick:n.addGroupExpression(!0)},"Exclude"))},n.addAudienceFeature=function(e){return function(t){var a,r=n.props,o=r.formChange,i=r.fields,s=r.closeNextDrawer,l={};if(t[0]){t[0].variables.forEach((function(e){e.container_type&&e.container_type.includes("List")?l[e.field_name]=[]:l[e.field_name]=void 0}));var c={type:"PARAMETRIC_PREDICATE",parametric_predicate_id:t[0].id,parameters:l},u=i.getAll().map((function(t,n){return n===e?Object.assign(Object.assign({},t),{expressions:t.expressions.concat(c)}):t}));n.setState({audienceFeatures:null===(a=n.state.audienceFeatures)||void 0===a?void 0:a.concat(t[0])}),o("where.expressions",u),s()}}},n.addFeature=function(e){return function(){var t=n.props,a=t.openNextDrawer,r=t.datamartId,o=t.demographicsFeaturesIds,i=t.hasFeature,s={datamartId:r,close:n.props.closeNextDrawer,save:n.addAudienceFeature(e),demographicIds:o.length>=1?o:void 0};i("new-audienceFeatureSelector")?a(g.default,{additionalProps:s}):a(p.default,{additionalProps:s})}},n.state={audienceFeatures:n.props.audienceFeatures},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.fields,a=t.intl,o=t.datamartId,s=t.demographicsFeaturesIds,l=t.objectTypes,f=this.state.audienceFeatures;return r.createElement(r.Fragment,null,n.map((function(t,p){return r.createElement(r.Fragment,{key:p+"_"+n.length},0!==p&&r.createElement("div",{className:"mcs-audienceBuilder_queryButtons"},n.get(p).negation?a.formatMessage(c.messages.excludingWith):a.formatMessage(c.messages.narrowingWith)),r.createElement(u.Card,{className:"mcs-audienceBuilder_categoryCard",title:0===p&&s.length>=1?a.formatMessage(c.messages.demographics):a.formatMessage(c.messages.audienceFeatures),buttons:0!==p&&r.createElement(i.Button,{className:"mcs-audienceBuilder_closeButton",onClick:function(){n.remove(p)}},r.createElement(u.McsIcon,{type:"close"}))},r.createElement(h,{name:t+".expressions",component:d.default,datamartId:o,objectTypes:l,audienceFeatures:f,isDemographicsSection:0===p&&s.length>=1}),(0!==p||0===s.length)&&r.createElement("div",{className:"mcs-audienceBuilder_categoryCardFooter"},r.createElement(i.Button,{onClick:e.addFeature(p),className:"mcs-audienceBuilder_moreButton"},a.formatMessage(c.messages.addAudienceFeature)))))})),this.renderQueryBuilderButtons())}}]),t}(r.Component);t.default=(0,s.compose)(l.injectIntl,f.default,m.injectFeatures)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(6),l=n(10),c=n(2216),u=(a=c)&&a.__esModule?a:{default:a},d=n(11);function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.fields,n=e.isDemographicsSection,a=e.datamartId,r=e.objectTypes,i=e.audienceFeatures;return t.map((function(e,s){return o.createElement(l.Row,{key:s+"_"+t.length,className:n?"mcs-audienceBuilder_demographicFeature":"mcs-audienceBuilder_audienceFeature"},o.createElement(l.Col,{span:n?24:22},o.createElement(u.default,{formPath:""+e,datamartId:a,parametricPredicateResource:t.get(s),objectTypes:r,audienceFeatures:i})),!n&&o.createElement(o.Fragment,null,o.createElement(l.Col,{span:2},o.createElement(l.Button,{className:"mcs-audienceBuilder_closeButton",onClick:function(){return t.remove(s)}},o.createElement(d.McsIcon,{type:"close"})))))}))}}]),t}(o.Component);t.default=(0,i.compose)(s.injectIntl)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormRelativeAbsoluteDateField=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(6),l=n(10),c=n(24),u=n(35),d=n(1084),f=(a=d)&&a.__esModule?a:{default:a};t.FormRelativeAbsoluteDateField=u.Field;var p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getAudienceFeature=function(){var e=n.props,t=e.parametricPredicateResource,a=e.audienceFeatures;a&&n.setState({audienceFeature:a.find((function(e){return e.id===t.parametric_predicate_id}))})},n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.getAudienceFeature()}},{key:"render",value:function(){var e=this.state.audienceFeature,t=this.props,n=t.datamartId,a=t.formPath,r=t.objectTypes;return e?o.createElement(o.Fragment,null,o.createElement("div",{className:"mcs-audienceBuilder_audienceFeatureName"},""+e.name),!!e.description&&o.createElement("i",{className:"mcs-audienceBuilder_audienceFeatureDescription"},e.description+" "),e.variables.map((function(e,t){return o.createElement(f.default,{key:t,datamartId:n,variable:e,formPath:a,objectTypes:r})}))):o.createElement(l.Spin,null)}}]),t}(o.Component);t.default=(0,i.compose)(s.injectIntl,c.withValidators)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(8),c=n(6),u=n(227),d=n(15),f=n(12),p=h(n(23)),m=n(11),g=h(n(2218)),y=n(41);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=s.Input.Search,_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchFolders=function(e){return n._audienceFeatureService.getAudienceFeatureFolders(e).then((function(e){return e.data})).catch((function(e){return n.props.notifyError(e),[]}))},n.fetchAudienceFeatures=function(e){var t=n.props,a=t.datamartId,r=t.demographicIds,o={};return(null==e?void 0:e.keywords)&&(o.keywords=[e.keywords]),r&&r.length>=1&&(o.exclude=r),o.fake_dataset=!0,n._audienceFeatureService.getAudienceFeatures(a,o).then((function(e){return e.data}))},n.saveAudienceFeatures=function(e,t){n.props.save(t)},n.getSearchOptions=function(){return{placeholder:n.props.intl.formatMessage(u.messages.searchAudienceFeature),onSearch:function(e){return n.setState({keywords:e})}}},n.getBreadCrumb=function(){var e=n.state,t=e.selectedFolder,a=e.audienceFeaturesByFolder;return i.createElement(s.Breadcrumb,{className:"mcs-audienceBuilder_breadCrumb"},function(){if(t&&a){var e=[];return function t(r){var o=n.getFolder(r.parent_id);null===r.id?e.unshift(a):(e.unshift(r),o&&t(o))}(t),e.map((function(e){return i.createElement(s.Breadcrumb.Item,{key:e.id?e.id:"root_key"},i.createElement(m.Button,{onClick:n.onSelectFolder(e.id)},e.name))}))}}())},n.getFolder=function(e){var t=n.state.audienceFeaturesByFolder,a=void 0;return t&&function n(r){null===e?a=t:r.children.forEach((function(t){t.id===e?a=t:n(t)}))}(t),a},n.onSelectFolder=function(e){return function(){n.setState({selectedFolder:n.getFolder(e)})}},n.onSelectFeature=function(e){return function(){var t=n.state.audienceFeaturesByFolder,a=null==t?void 0:t.audience_features.find((function(t){return t.id===e}));if(!a){t&&function t(n){n.forEach((function(n){var r=n.audience_features.find((function(t){return t.id===e}));r?a=r:t(n.children)}))}(t.children)}n.setState({selectedAudienceFeature:a})}},n.state={isLoading:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.datamartId,a=t.intl;this.setState({isLoading:!0}),this.fetchFolders(n).then((function(t){e.fetchAudienceFeatures().then((function(n){var r={id:null,name:a.formatMessage(u.messages.audienceFeatures),parent_id:"root",children:function e(a){return a.map((function(a){return{id:a.id,name:a.name,parent_id:a.parent_id,audience_features:n.filter((function(e){return a.audience_feature_ids.includes(e.id)})),children:e(t.filter((function(e){return null!==e.id&&a.children_ids.includes(e.id)})))}}))}(t.filter((function(e){return null===e.parent_id}))),audience_features:[]};e.setState({audienceFeaturesByFolder:r,selectedFolder:r,isLoading:!1})})).catch((function(t){e.props.notifyError(t),e.setState({isLoading:!1})}))}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.audienceFeaturesByFolder,r=t.selectedAudienceFeature,o=t.selectedFolder,l=this.props,c=l.intl.formatMessage,d=l.save,f=l.close;return i.createElement(m.SelectorLayout,{className:"mcs-audienceBuilder_featureSelector",actionBarTitle:c(u.messages.addAudienceFeature),handleAdd:function(){r&&d([r])},handleClose:f,disabled:!!n&&0===n.children.length&&0===n.audience_features.length,addButtonText:c(u.messages.addAudienceFeatureButton),noElementText:""},i.createElement(b,a({className:"mcs-search-input"},this.getSearchOptions())),this.getBreadCrumb(),i.createElement(s.Row,{gutter:16},!!o&&o.children.map((function(t){return i.createElement(s.Col,{key:t.id?t.id:"root_key",span:4},i.createElement("div",{className:"mcs-audienceBuilder_folder",onClick:e.onSelectFolder(t.id)},i.createElement(y.FolderOutlined,{className:"menu-icon"}),i.createElement("br",null),i.createElement("span",null,t.name),i.createElement("br",null),i.createElement("span",{className:"mcs-audienceBuilder_folderChildNumber"},t.audience_features.length," features")))}))),i.createElement(s.Row,{className:"mcs-audienceBuilder_featureCardContainer",gutter:16},!!o&&o.audience_features.map((function(t){return i.createElement(s.Col,{key:t.id,span:6},i.createElement(g.default,{audienceFeature:t,selectedAudienceFeature:r,onSelectFeature:e.onSelectFeature}))}))))}}]),t}(i.Component);v([(0,d.lazyInject)(f.TYPES.IAudienceFeatureService)],_.prototype,"_audienceFeatureService",void 0),t.default=(0,l.compose)(c.injectIntl,p.default)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(227),s=n(6),l=n(11);var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleCard=function(){n.setState({cardToggled:!n.state.cardToggled})},n.state={cardToggled:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.audienceFeature,n=e.selectedAudienceFeature,a=e.onSelectFeature,o=e.intl,s=this.state.cardToggled;return r.createElement("div",{className:"mcs-audienceBuilder_featureCard "+(n&&n.id===t.id&&"selected")+" "+(s&&"toggled"),onClick:a(t.id)},s?r.createElement(l.McsIcon,{type:"close",onClick:this.toggleCard}):r.createElement(l.McsIcon,{type:"info",onClick:this.toggleCard}),s?r.createElement(r.Fragment,null,r.createElement("span",null,o.formatMessage(i.messages.availableFilters)),r.createElement("div",{className:"mcs-audienceBuilder_featureCardDescritpion"},r.createElement("ul",null,t.variables.map((function(e){return r.createElement("li",{key:e.parameter_name},"- ",e.parameter_name," ")}))))):r.createElement(r.Fragment,null,r.createElement("span",null,t.name),r.createElement("div",{className:"mcs-audienceBuilder_featureCardDescritpion"},t.description)))}}]),t}(r.Component);t.default=(0,o.compose)(s.injectIntl)(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=g(n(47)),l=n(10),c=n(24),u=g(n(49)),d=n(61),f=n(183),p=g(n(2220)),m=n(263);function g(e){return e&&e.__esModule?e:{default:e}}var y=(0,i.defineMessages)({sectionSubtitle:{id:"goalEditor.section.attribution.model.subtitle",defaultMessage:"Give your Goal attribution models."},sectionTitle:{id:"goalEditor.section..attribution.model.title",defaultMessage:"Attribution Models"},addExistingAttributionModel:{id:"goalEditor.section..attribution.model.add.existing",defaultMessage:"Add existing attribution model"},emptyRecordTitle:{id:"edit.goal.no.attribution.model.title",defaultMessage:"Click on the pen to add an attribution model to your goal"},addDirectAttributionModel:{id:"edit.goal.add.direct.attribution.model",defaultMessage:"Add direct attribution model"},errorDeleteDefaultAttributionModel:{id:"edit.goal.delete.default.attribution.model",defaultMessage:"Please select another default attribution model before delete the default one."},checkedSwitchAttributionModelText:{id:"edit.goal.default.switch.attribution.model.text",defaultMessage:"DEFAULT"}}),h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateExistingAttributionModels=function(e){var t=n.props,a=t.fields,r=t.formChange,o=e.map((function(e){return e.id})),i=[];a&&a.getAll()&&a.getAll().forEach((function(e){((0,m.isAttributionSelectionResource)(e.model)&&o.includes(e.model.id)||o.includes(e.model.attribution_model_id)||"DIRECT"===e.model.attribution_type)&&i.push(e)}));var l=[];a&&a.getAll()&&a.getAll().forEach((function(e){l.push(e.model.attribution_model_id)}));var c=e.filter((function(e){return!l.includes(e.id)})).map((function(e,t){var a={attribution_model_id:e.id,attribution_type:"WITH_PROCESSOR",default:!1},r=!(n.props.fields.getAll().length>=1)&&0===t;return{key:(0,s.default)(),model:a,meta:n.buildFieldModelMeta(e,r)}}));r(a.name,i.concat(c)),n.props.closeNextDrawer()},n.addDirectAttributionModel=function(){var e=n.props.fields;e.push({key:(0,s.default)(),model:{attribution_model_id:"-1",attribution_type:"DIRECT"},meta:{name:"DIRECT",default:0===e.length}})},n.openAttributionModelSelector=function(){var e=n.props,t=e.openNextDrawer,a=e.closeNextDrawer,r=e.fields,o=[];r&&r.getAll()&&r.getAll().forEach((function(e){e.model.attribution_model_id&&"WITH_PROCESSOR"===e.model.attribution_type&&o.push(e.model.attribution_model_id)}));var i={additionalProps:{save:n.updateExistingAttributionModels,close:a,selectedAttributionModelIds:o}};t(p.default,i)},n.buildFieldModelMeta=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{name:e.name,artifact_id:e.artifact_id,group_id:e.group_id,default:t}},n.getAttributionModelRecords=function(){var e=n.props,t=e.fields,a=e.formChange,o=e.intl;return t.getAll().map((function(e,n){return r.createElement(f.RecordElement,{key:e.key,recordIconType:"display",record:e,title:function(e){return e.meta.name&&"DIRECT"!==e.meta.name?e.meta.name+" /\n         "+e.meta.group_id+" /\n         "+e.meta.artifact_id:"DIRECT"},onRemove:function(){var r=[];e.meta.default?l.message.error(o.formatMessage(y.errorDeleteDefaultAttributionModel)):(t.getAll().forEach((function(e,t){t!==n&&r.push(e)})),a(t.name,r))},additionalActionButtons:function(){return r.createElement("span",null,e.meta.default&&o.formatMessage(y.checkedSwitchAttributionModelText),r.createElement(l.Switch,{className:"mcs-table-switch m-l-10",checked:e.meta.default,disabled:e.meta.default,onChange:function(){var n=t.getAll().map((function(t){return t.key===e.key?Object.assign(Object.assign({},t),{meta:Object.assign(Object.assign({},t.meta),{default:!0})}):Object.assign(Object.assign({},t),{meta:Object.assign(Object.assign({},t.meta),{default:!1})})}));a(t.name,n)}}))}})}))},n.state={initialRadioGroupValue:1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"renderFieldArray",value:function(){var e=this.props,t=e.intl;return 0===e.fields.length?r.createElement(f.EmptyRecords,{message:t.formatMessage(y.emptyRecordTitle)}):r.createElement(f.RelatedRecords,{emptyOption:{iconType:"users",message:t.formatMessage(y.emptyRecordTitle)}},this.getAttributionModelRecords())}},{key:"render",value:function(){var e=this.props.fields,t=e&&e.getAll()&&e.getAll().find((function(e){return"DIRECT"===e.model.attribution_type}));return r.createElement("div",null,r.createElement(c.FormSection,{subtitle:y.sectionSubtitle,title:y.sectionTitle,dropdownItems:[{id:y.addExistingAttributionModel.id,message:y.addExistingAttributionModel,onClick:this.openAttributionModelSelector},{id:y.addDirectAttributionModel.id,message:y.addDirectAttributionModel,onClick:this.addDirectAttributionModel,disabled:!!t}]}),this.renderFieldArray())}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,d.injectDrawer,u.default)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(6),c=n(44),u=n(51),d=n(15),f=n(12);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},y=u.TableSelector,h=(0,l.defineMessages)({attributionModelSelectorColumnType:{id:"attributionModel.selector.column.attribution.type",defaultMessage:"Attribution Type"},attributionModelSelectorColumnProcessor:{id:"attributionModel.selector.column.attribution.processor",defaultMessage:"Attribution Model Processor"},attributionModelSelectorTitle:{id:"attributionModel.selector.title",defaultMessage:"Add Attribution Model"},attributionModelSelectorSearchPlaceholder:{id:"attributionModel.selector.search.placeholder",defaultMessage:"Search an attribution model"}}),v=function(e){function t(){p(this,t);var e=m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.fetchAttributionModels=function(t){var n=e.props.match.params.organisationId,a=Object.assign({},(0,c.getPaginatedApiParam)(t.currentPage,t.pageSize));return e._attributionModelService.getAttributionModels(n,a)},e.fetchAttributionModel=function(t){return e._attributionModelService.getAttributionModel(t)},e.saveAttributionModels=function(t,n){e.props.save(n)},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.selectedAttributionModelIds,n=e.intl.formatMessage,a=e.close,r=[{intlMessage:h.attributionModelSelectorColumnType,key:"type",render:function(e,t){return o.createElement("span",null,t.id," (WITH PROCESSOR)")}},{intlMessage:h.attributionModelSelectorColumnProcessor,key:"processor",render:function(e,t){return o.createElement("span",null,t.name,"(",t.group_id,":",t.artifact_id,")")}}];return o.createElement(y,{actionBarTitle:n(h.attributionModelSelectorTitle),displayFiltering:!0,searchPlaceholder:n(h.attributionModelSelectorSearchPlaceholder),selectedIds:t,fetchDataList:this.fetchAttributionModels,fetchData:this.fetchAttributionModel,columnsDefinitions:r,save:this.saveAttributionModels,close:a})}}]),t}(o.Component);g([(0,d.lazyInject)(f.TYPES.IAttributionModelService)],v.prototype,"_attributionModelService",void 0),t.default=(0,i.compose)(l.injectIntl,s.withRouter)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(6),s=n(24),l=n(11);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=o.Layout.Content,f=(0,i.defineMessages)({listTitle:{id:"goal.form.trigger.type.selector.list.title",defaultMessage:"Goal Trigger Types"},listSubtitle:{id:"goal.form.trigger.type.selector.list.subtitle",defaultMessage:"Choose your goal trigger type"},segmentTypeOr:{id:"goal.form.trigger.type.selector.or",defaultMessage:"Or"},otherSegmentTypes:{id:"goal.form.trigger.type.selector.other",defaultMessage:"Other trigger types"},triggerQuery:{id:"goal.form.trigger.type.query",defaultMessage:"Trigger via Query"},triggerExpertQuery:{id:"goal.form.trigger.type.expert-query",defaultMessage:"Trigger via Expert Query"},triggerPixel:{id:"goal.form.trigger.type.pixel",defaultMessage:"Trigger via Pixel"}}),p=function(e){function t(){return c(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.onSelect,n=e.datamart,a=e.intl,c=function(e,n){return function(){return t(e,n)}};return r.createElement(o.Layout,null,r.createElement("div",{className:"edit-layout ant-layout"},r.createElement(o.Layout,null,r.createElement(d,{className:"mcs-content-container mcs-form-container text-center"},r.createElement(s.FormTitle,{title:f.listTitle,subtitle:f.listSubtitle}),r.createElement(o.Row,{className:"mcs-selector_container"},r.createElement(o.Row,{className:"menu"},r.createElement("div",{className:"presentation"},r.createElement(l.MenuPresentational,{title:a.formatMessage(f.triggerQuery),type:"user-query",select:c("QUERY","JSON_OTQL")}),r.createElement("div",{className:"separator"},r.createElement(i.FormattedMessage,f.segmentTypeOr)),r.createElement(l.MenuPresentational,{title:a.formatMessage(f.triggerPixel),type:"user-pixel",select:c("PIXEL")}))),"v201506"!==n.storage_model_version&&r.createElement("div",null,r.createElement(o.Row,{className:"intermediate-title"},r.createElement(i.FormattedMessage,f.otherSegmentTypes)),r.createElement(o.Row,{className:"menu"},r.createElement(l.MenuList,{title:a.formatMessage(f.triggerExpertQuery),select:c("QUERY","OTQL")}))))))))}}]),t}(r.Component);t.default=(0,i.injectIntl)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=m(n(810)),c=n(263),u=m(n(23)),d=n(15),f=n(12),p=n(11);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},y=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={loading:!1,goalFormData:Object.assign({},c.INITIAL_GOAL_FORM_DATA)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({loading:!0});var t=this.props,n=t.goalId,a=t.notifyError;this._goalFormService.loadGoalData(n).then((function(t){return e._datamartService.getDatamart(t.goal.datamart_id).then((function(n){return e.setState({loading:!1,goalFormData:Object.assign(Object.assign({},t),{attributionModels:t.attributionModels}),datamart:n.data}),n}))})).catch((function(t){e.setState({loading:!1}),a(t)}))}},{key:"render",value:function(){var e=this.props,t=(e.goalId,y(e,["goalId"])),n=this.state,r=n.loading,o=n.datamart;return r||!o?i.createElement(p.Loading,{isFullScreen:!0}):i.createElement(l.default,a({},t,{initialValues:this.state.goalFormData,datamart:o}))}}]),t}(i.Component);g([(0,d.lazyInject)(f.TYPES.IGoalFormService)],h.prototype,"_goalFormService",void 0),g([(0,d.lazyInject)(f.TYPES.IDatamartService)],h.prototype,"_datamartService",void 0),t.default=(0,s.compose)(u.default)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(109),s=n(24),l=n(11),c=n(6),u=n(8);function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=o.Layout.Content,m=(0,c.defineMessages)({displayCampaignTypePickerTitle:{id:"display.campaign.edit.select.title",defaultMessage:"Select Your Campaign Type"},displayCampaignTypePickerSubTitle:{id:"display.campaign.edit.select.subtitle",defaultMessage:"Select your campaign type, if you don't know which type you should use, please contact your representative."},programmaticType:{id:"display.campaign.edit.select.programmatic",defaultMessage:"Programmatic"},adServingType:{id:"display.campaign.edit.select.adserving",defaultMessage:"Ad Serving"},displayTypeOr:{id:"display.campaign.edit.select.or",defaultMessage:"Or"},displayTypeAdvanced:{id:"display.campaign.edit.select.advanced",defaultMessage:"Advanced"},trackingType:{id:"display.campaign.edit.select.tracking",defaultMessage:"Tracking"},campaignSelectionBreadcrumb:{id:"display.campaign.edit.select.breadcrumb",defaultMessage:"New Campaign"}}),g=function(e){function t(){return d(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.onSelect,a=function(e){return function(){n(e)}},u={formId:"typePickerForm",onClose:e.close,paths:[{name:t(m.campaignSelectionBreadcrumb)}]};return r.createElement(o.Layout,null,r.createElement("div",{className:"edit-layout ant-layout"},r.createElement(i.FormLayoutActionbar,u),r.createElement(o.Layout,null,r.createElement(p,{className:"mcs-content-container mcs-form-container text-center"},r.createElement(s.FormTitle,{title:m.displayCampaignTypePickerTitle}),r.createElement(o.Row,{className:"mcs-selector_container"},r.createElement(o.Row,{className:"menu"},r.createElement("div",{className:"presentation"},r.createElement(l.MenuPresentational,{title:t(m.programmaticType),type:"image",select:a("PROGRAMMATIC")}),r.createElement("div",{className:"separator"},r.createElement(c.FormattedMessage,m.displayTypeOr)),r.createElement(l.MenuPresentational,{title:t(m.adServingType),type:"code",select:a("AD_SERVING")}))))))))}}]),t}(r.Component);t.default=(0,u.compose)(c.injectIntl)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(35),s=n(13),l=n(6),c=n(8),u=n(10),d=n(109),f=n(2225),p=g(n(95)),m=g(n(2227));function g(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=u.Layout.Content,b=t.FORM_ID="campaignForm",_=i.FieldArray,S=function(e){function t(){return y(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.breadCrumbPaths,r=e.close,s={formChange:e.change,rerenderOnEveryChange:!0},l={formId:b,paths:n,message:p.default.saveAdGroup,onClose:r},c=[];c.push({id:"general",title:p.default.sectionTitle1,component:o.createElement(f.GeneralFormSection,null)}),c.push({id:"ads",title:p.default.sectionTitle3,component:o.createElement(_,a({name:"adGroupFields",component:m.default},s))});var g={items:c.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:b},y=c.map((function(e,t){return o.createElement("div",{key:e.id},o.createElement("div",{key:e.id,id:e.id},e.component),t!==c.length-1&&o.createElement("hr",null))}));return o.createElement(u.Layout,{className:"edit-layout"},o.createElement(d.FormLayoutActionbar,l),o.createElement(u.Layout,{className:"ant-layout-has-sider"},o.createElement(d.ScrollspySider,g),o.createElement(i.Form,{className:"edit-layout ant-layout",onSubmit:t},o.createElement("button",{type:"submit",style:{display:"none"}}),o.createElement(v,{id:b,className:"mcs-content-container mcs-form-container"},o.createElement("div",{className:"ad-group-form"},y)))))}}]),t}(o.Component);t.default=(0,c.compose)(l.injectIntl,s.withRouter,(0,i.reduxForm)({form:b,enableReinitialize:!0}))(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeneralFormSection=void 0;var a,r=n(2226),o=(a=r)&&a.__esModule?a:{default:a};t.GeneralFormSection=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=m(n(95)),l=n(11),c=n(24),u=m(n(49)),d=m(n(63)),f=n(13),p=n(152);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage;return r.createElement("div",null,r.createElement(c.FormSection,{subtitle:s.default.sectionSubtitle1,title:s.default.sectionTitle1}),r.createElement("div",null,r.createElement(c.FormInputField,{name:"campaign.name",component:c.FormInput,validate:[t],formItemProps:{label:n((0,p.formatDisplayCampaignProperty)("name").message),required:!0},inputProps:{placeholder:n(s.default.campaignFormPlaceholderCampaignName)},helpToolTipProps:{title:n(s.default.contentSectionGeneralRow1Tooltip)}})),r.createElement("div",null,r.createElement(l.Button,{className:"optional-section-title",onClick:this.toggleAdvancedSection},r.createElement(l.McsIcon,{type:"settings"}),r.createElement("span",{className:"step-title"},n(s.default.contentSectionGeneralAdvancedPartTitle)),r.createElement(l.McsIcon,{type:"chevron"})),r.createElement("div",{className:this.state.displayAdvancedSection?"optional-section-content":"hide-section"},r.createElement(c.FormAlertInputField,{name:"campaign.technical_name",component:c.FormAlertInput,formItemProps:{label:n((0,p.formatDisplayCampaignProperty)("technical_name").message)},inputProps:{placeholder:n(s.default.contentSectionGeneralAdvancedPartRow1Placeholder)},helpToolTipProps:{title:n(s.default.contentSectionGeneralAdvancedPartRow1Tooltip)},iconType:"warning",type:"warning",message:n(s.default.warningOnTokenEdition)}))))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,u.default,d.default,f.withRouter)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=T(n(47)),s=n(6),l=n(8),c=n(13),u=n(54),d=n(61),f=n(24),p=T(n(95)),m=n(178),g=T(n(807)),y=n(137),h=n(10),v=n(51),b=n(11),_=n(1087),S=n(44),E=n(83),O=n(1024),w=T(n(808)),M=n(15),P=n(12);function T(e){return e&&e.__esModule?e:{default:e}}var I=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateAdsAdGroups=function(e){var t=n.props,a=t.fields,r=t.formChange,o=e.map((function(e){return e.id})),s=[];a.getAll().forEach((function(e){e.model.adFields.forEach((function(t){(0,m.isDisplayCreativeFormData)(t.model)?(0,y.isDisplayAdResource)(t.model.creative)&&o.includes(t.model.creative.id)&&s.push(e):o.includes(t.model.creative_id)&&s.push(e)}))}));var l=[];a.getAll().forEach((function(e){e.model.adFields.forEach((function(e){(0,m.isDisplayCreativeFormData)(e.model)||l.push(e.model.creative_id)}))}));var c=e.filter((function(e){return!l.includes(e.id)})).map((function(e){return{key:(0,i.default)(),model:Object.assign(Object.assign({},m.INITIAL_AD_GROUP_FORM_DATA),{adFields:[{key:(0,i.default)(),model:{creative_id:e.id}}]})}}));r(a.name,s.concat(c))},n.openCreativeCardSelector=function(){var e=n.props.fields,t=[];e.getAll().forEach((function(e){e.model.adFields.forEach((function(e){(0,m.isDisplayCreativeFormData)(e.model)||t.push(e.model.creative_id)}))}));var a={additionalProps:{close:n.props.closeNextDrawer,save:function(e){n.updateAdsAdGroups(e),n.props.closeNextDrawer()},creativeType:"DISPLAY_AD",selectedCreativeIds:t}};n.props.openNextDrawer(g.default,a)},n.getAdsAdGroupRecords=function(){var e=n.props.fields,t=n.state.displayCreativeCacheById,a=[];return e.getAll()&&e.getAll().forEach((function(e,n){e.model.adFields.forEach((function(e){(0,m.isDisplayCreativeFormData)(e.model)?a.push({creativeResource:e.model.creative,fieldIndex:n,fieldModel:e}):t[e.model.creative_id]&&a.push({creativeResource:t[e.model.creative_id],fieldIndex:n,fieldModel:e})}))})),a.map((function(e){return o.createElement(h.Col,{key:e.fieldModel.key,span:6},o.createElement("div",{className:"ad-group-card"},o.createElement(w.default,{key:e.fieldModel.key,creative:e.creativeResource,renderFooter:function(){return n.getCreativeCardFooter(e)}})))}))},n.getCreativeCardFooter=function(e){var t=n.props.fields,a=(0,u.split)(e.creativeResource.format,"x"),r=(0,O.computeDimensionsByRatio)(Number(a[0]),Number(a[1])),i={backgroundColor:"#e8e8e8",border:"solid 1px #c7c7c7",height:r.width+"em",width:r.height+"em"},s=(0,y.isDisplayAdResource)(e.creativeResource)?e.creativeResource.audit_status:void 0;return o.createElement("div",null,o.createElement(h.Row,{className:"footer"},o.createElement(h.Col,{className:"inline formatWrapper",span:20},o.createElement("div",{style:i}),o.createElement("div",{className:"dimensions"},e.creativeResource.format)),o.createElement(h.Col,{className:"inline buttons",span:2},o.createElement(b.Button,{onClick:function(){return t.remove(e.fieldIndex)}},o.createElement(b.McsIcon,{className:"button",type:"delete"})))),o.createElement(h.Row,{className:"footer"},o.createElement(h.Col,{className:"inline formatWrapper",span:22},o.createElement(_.AuditStatusRenderer,{auditStatus:s}))))},n.state={loading:!1,displayCreativeCacheById:{}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidUpdate",value:function(){var e=this,t=Object.keys(this.state.displayCreativeCacheById),n=[];this.props.fields.getAll().forEach((function(e){e.model.adFields.forEach((function(e){(0,m.isDisplayCreativeFormData)(e.model)||t.includes(e.model.creative_id)||n.push(e.model.creative_id)}))})),0!==n.length&&(this.cancelablePromise=(0,S.makeCancelable)(Promise.all(n.map((function(t){return e._creativeService.getDisplayAd(t).then((function(e){return e.data}))})))),this.cancelablePromise.promise.then((function(t){e.setState((function(e){return{displayCreativeCacheById:Object.assign(Object.assign({},e.displayCreativeCacheById),(0,E.normalizeArrayOfObject)(t,"id"))}}))})))}},{key:"componentWillUnmount",value:function(){this.cancelablePromise&&this.cancelablePromise.cancel()}},{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.fields;return o.createElement("div",null,o.createElement(f.FormSection,{button:{message:t(p.default.dropdownAddExisting),onClick:this.openCreativeCardSelector},subtitle:p.default.sectionSubtitleAds,title:p.default.sectionTitleAds}),o.createElement(h.Spin,{spinning:this.state.loading},o.createElement("div",{className:"ad-group-ad-section",style:{overflow:"hidden"}},o.createElement("div",{className:"mcs-table-card content"},o.createElement(h.Row,{gutter:20},this.getAdsAdGroupRecords())),!n.length&&o.createElement(v.EmptyRecords,{iconType:"ads",message:t(p.default.contentSectionAdEmptyTitle)}))))}}]),t}(o.Component);I([(0,M.lazyInject)(P.TYPES.ICreativeService)],A.prototype,"_creativeService",void 0),t.default=(0,l.compose)(s.injectIntl,c.withRouter,d.injectDrawer)(A)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=p(n(1088)),c=n(8),u=p(n(23)),d=n(15),f=n(12);function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchData=function(){var e=n.props.creativeId;n.setState({loading:!0}),Promise.all([n._creativeService.getDisplayAd(e),n._creativeService.getAuditStatus(e)]).then((function(e){var t=a(e,2),r=t[0],o=t[1];n.setState({loading:!1,creative:r.data,auditStatuses:o.data})}))},n.makeAuditAction=function(e){var t=n.props,a=t.creativeId,r=t.notifyError;n._creativeService.makeAuditAction(a,e).then(n.fetchData).catch((function(e){return r(e)}))},n.state={loading:!1,auditStatuses:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.creative,a=e.auditStatuses;return n?i.createElement(s.Spin,{spinning:t,wrapperClassName:"full-width"},i.createElement(l.default,{creative:n,auditStatuses:a,onMakeAuditAction:this.makeAuditAction})):null}}]),t}(i.Component);m([(0,d.lazyInject)(f.TYPES.ICreativeService)],g.prototype,"_creativeService",void 0),t.default=(0,c.compose)(u.default)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=_(n(0)),i=n(8),s=n(25),l=n(13),c=n(10),u=n(6),d=_(n(204)),f=n(263),p=b(n(1029)),m=b(n(23)),g=n(67),y=n(15),h=n(12),v=n(11);function b(e){return e&&e.__esModule?e:{default:e}}function _(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=(0,u.defineMessages)({errorFormMessage:{id:"campaigns.goal.edit.genericErrorMessage",defaultMessage:"There is an error with some fields in your form. Please review the data you entered."},savingInProgress:{id:"campaigns.goal.edit.savingInProgress",defaultMessage:"Saving in progress"},breadcrumbGoalsTitle:{id:"campaigns.goal.edit.breadcrumb.goals",defaultMessage:"Goals"},breadcrumbNewGoalTitle:{id:"campaigns.goal.edit.breadcrumb.newGoal",defaultMessage:"New Goal"},breadcrumbEditGoalTitle:{id:"campaigns.goal.edit.breadcrumb.editGoalName",defaultMessage:"Edit {name}"}}),O=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onSubmitFail=function(){var e=n.props.intl;c.message.error(e.formatMessage(E.errorFormMessage))},n.fetchData=function(e){return n.setState({loading:!0}),n._goalFormService.loadGoalData(e).then((function(e){return n.setState({goalFormData:e,loading:!1}),e})).catch((function(e){n.setState({loading:!1}),n.props.notifyError(e)}))},n.save=function(e){var t=n.props,a=t.match.params.organisationId,r=t.notifyError,o=t.history,i=t.intl,s=t.location,l=n.state.goalFormData,u=c.message.loading(i.formatMessage(E.savingInProgress),0);n.setState({loading:!0}),n._goalFormService.saveGoal(a,e,l).then((function(t){var r="QUERY"===e.triggerType?"/v2/o/"+a+"/campaigns/goals/"+t.id:"/v2/o/"+a+"/campaigns/goals/"+t.id+"/edit";"QUERY"===e.triggerType?u():n.fetchData(t.id).then((function(){return u()})),o.push({pathname:r,state:{from:""+s.pathname}})})).catch((function(e){u(),r(e),n.setState({loading:!1})}))},n.onClose=function(){var e=n.props,t=e.history,a=e.location,r=e.match.params,o=r.goalId,i=r.organisationId,s=o?"/v2/o/"+i+"/campaigns/goals/"+o:"/v2/o/"+i+"/campaigns/goals";return a.state&&a.state.from?t.push(a.state.from):t.push(s)},n.state={loading:!1,goalFormData:Object.assign({},f.INITIAL_GOAL_FORM_DATA)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params.goalId;e&&this.fetchData(e)}},{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.intl.formatMessage,a=this.state,r=a.loading,i=a.goalFormData;if(r)return o.createElement(v.Loading,{isFullScreen:!0});var s=i.goal&&i.goal.name?n(E.breadcrumbEditGoalTitle,{name:i.goal.name}):n(E.breadcrumbNewGoalTitle),l=[{name:n(E.breadcrumbGoalsTitle),path:"/v2/o/"+t+"/campaigns/goals"},{name:s}];return o.createElement(p.default,{initialValues:i,breadCrumbPaths:l,save:this.save,close:this.onClose,onSubmitFail:this.onSubmitFail})}}]),t}(o.Component);S([(0,y.lazyInject)(h.TYPES.IGoalFormService)],O.prototype,"_goalFormService",void 0);t.default=(0,i.compose)(l.withRouter,u.injectIntl,m.default,(0,s.connect)((function(e){return{workspace:(0,g.getWorkspace)(e),hasFeature:d.hasFeature(e)}}),void 0))(O)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=n(10),c=n(13),u=n(6),d=v(n(828)),f=n(592),p=v(n(184)),m=n(51),g=v(n(23)),y=n(12),h=n(15);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.redirect=function(){var e=n.props,t=e.match.params,a="/v2/o/"+t.organisationId+"/campaigns/email/"+t.campaignId;e.history.push(a)},n.save=function(e){var t=n.props,a=t.match.params.campaignId,r=t.intl.formatMessage,o=t.notifyError,i=n.state.blastFormData,s=l.message.loading(r(p.default.savingInProgress),0);return n.setState({loading:!0}),n._emailCampaignFormService.saveBlast(a,e,i).then((function(){s(),n.redirect()})).catch((function(e){s(),o(e),n.setState({loading:!1})}))},n.onSubmitFail=function(){var e=n.props.intl;l.message.error(e.formatMessage(p.default.errorFormMessage))},n.state={loading:!0,blastFormData:f.INITIAL_EMAIL_BLAST_FORM_DATA},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params,n=t.campaignId,r=t.blastId;Promise.all([this._emailCampaignService.getEmailCampaign(n),r?this._emailCampaignFormService.loadBlast(n,r):Promise.resolve(f.INITIAL_EMAIL_BLAST_FORM_DATA)]).then((function(t){var n=a(t,2),r=n[0],o=n[1];e.setState((function(e){var t=Object.assign(Object.assign({},e),{campaign:r.data,loading:!1});return o&&(t.blastFormData=o),t}))})).catch((function(t){e.setState({loading:!1}),e.props.notifyError(t)}))}},{key:"render",value:function(){var e=this.props,t=e.match.params,n=t.organisationId,a=t.campaignId,r=t.blastId,o=e.intl.formatMessage,s=this.state,l=s.loading,c=s.campaign,u=s.blastFormData;if(l)return i.createElement(m.Loading,{isFullScreen:!0});var f=[{name:c?c.name:a,path:"/v2/o/"+n+"/campaigns/email/"+a},{name:r?o(p.default.emailBlastEditorBreadcrumbTitleEditBlast,{blastName:u.blast&&u.blast.blast_name?u.blast.blast_name:r}):o(p.default.emailBlastEditorBreadcrumbTitleNewBlast)}];return i.createElement(d.default,{initialValues:u,onSubmit:this.save,close:this.redirect,breadCrumbPaths:f,onSubmitFail:this.onSubmitFail})}}]),t}(i.Component);b([(0,h.lazyInject)(y.TYPES.IEmailCampaignService)],_.prototype,"_emailCampaignService",void 0),b([(0,h.lazyInject)(y.TYPES.IEmailCampaignFormService)],_.prototype,"_emailCampaignFormService",void 0),t.default=(0,s.compose)(u.injectIntl,c.withRouter,g.default)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=n(24),l=d(n(49)),c=d(n(308)),u=d(n(184));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.fieldValidators,a=n.isRequired,o=n.isValidEmail,i=e.small,l=e.fieldName,d=e.disabled;return r.createElement("div",null,r.createElement(s.FormSection,{title:u.default.emailBlastEditorStepTitleBlastInformation}),r.createElement(s.FormInputField,{name:l+".subject_line",component:c.default,validate:[a],formItemProps:{label:t(u.default.emailBlastEditorInputLabelSubjectLine),required:!0},inputProps:{placeholder:t(u.default.emailBlastEditorInputPlaceholderSubjectLine),disabled:d},helpToolTipProps:{title:t(u.default.emailBlastEditorInputHelperSubjectLine)},small:i}),r.createElement(s.FormInputField,{name:l+".from_email",component:c.default,validate:[a,o],formItemProps:{label:t(u.default.emailBlastEditorInputLabelFromEmail),required:!0},inputProps:{placeholder:t(u.default.emailBlastEditorInputPlaceholderFromEmail),disabled:d},helpToolTipProps:{title:t(u.default.emailBlastEditorInputHelperFromEmail)},small:i}),r.createElement(s.FormInputField,{name:l+".from_name",component:c.default,validate:[a],formItemProps:{label:t(u.default.emailBlastEditorInputLabelFromName),required:!0},inputProps:{placeholder:t(u.default.emailBlastEditorInputPlaceholderFromName),disabled:d},helpToolTipProps:{title:t(u.default.emailBlastEditorInputHelperFromName)},small:i}),r.createElement(s.FormInputField,{name:l+".reply_to",component:c.default,validate:[a,o],formItemProps:{label:t(u.default.emailBlastEditorInputLabelReplyTo),required:!0},inputProps:{placeholder:t(u.default.emailBlastEditorInputPlaceholderReplyTo),disabled:d},helpToolTipProps:{title:t(u.default.emailBlastEditorInputHelperReplyTo)},small:i}))}}]),t}(r.Component);m.defaultProps={fieldName:"blast"},t.default=(0,o.compose)(i.injectIntl,l.default)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=b(n(0)),i=b(n(17)),s=n(8),l=n(6),c=n(10),u=n(13),d=n(24),f=v(n(49)),p=v(n(184)),m=v(n(308)),g=v(n(333)),y=n(15),h=n(12);function v(e){return e&&e.__esModule?e:{default:e}}function b(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={consents:[],fetchingConsents:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({fetchingConsents:!0}),this._consentService.getConsents(this.props.match.params.organisationId).then((function(t){e.setState({fetchingConsents:!1,consents:t.data})}))}},{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.fieldValidators.isRequired;return o.createElement("div",null,o.createElement(d.FormSection,{subtitle:p.default.emailBlastEditorStepSubTitleGeneralInformation,title:p.default.emailBlastEditorStepTitleGeneralInformation}),o.createElement(d.FormInputField,{name:"blast.blast_name",component:m.default,validate:[n],formItemProps:{label:t(p.default.emailBlastEditorInputLabelBlastName),required:!0},inputProps:{placeholder:t(p.default.emailBlastEditorInputPlaceholderBlastName)},helpToolTipProps:{title:t(p.default.emailBlastEditorInputHelperBlastName)}}),o.createElement(d.FormDatePickerField,{name:"blast.send_date",component:d.FormDatePicker,formItemProps:{label:t(p.default.emailBlastEditorDatePickerLabelSentDate)},datePickerProps:{format:"DD/MM/YYYY HH:mm",showTime:{format:"HH:mm"},placeholder:t(p.default.emailBlastEditorDatePickerPlaceholderSentDate),disabledDate:function(e){return!!e&&e.isBefore(i.now())}},helpToolTipProps:{title:t(p.default.emailBlastEditorDatePickerHelperSentDate)},unixTimestamp:!0}),o.createElement(d.FormSelectField,{name:"consentFields[0].model.consent_id",component:g.default,validate:[n],formItemProps:{label:t(p.default.emailEditorProviderSelectLabel),required:!0},selectProps:{notFoundContent:this.state.fetchingConsents?o.createElement(c.Spin,{size:"small"}):null},options:this.state.consents.map((function(e){return{value:e.id,title:e.technical_name}})),helpToolTipProps:{title:t(p.default.emailEditorProviderSelectHelper)}}))}}]),t}(o.Component);_([(0,y.lazyInject)(h.TYPES.IConsentService)],S.prototype,"_consentService",void 0),t.default=(0,s.compose)(l.injectIntl,u.withRouter,f.default)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(8),s=n(25),l=n(10),c=E(n(47)),u=n(35),d=n(13),f=n(24),p=E(n(2234)),m=E(n(1021)),g=n(183),y=E(n(78)),h=n(83),v=n(56),b=E(n(184)),_=E(n(81)),S=n(61);function E(e){return e&&e.__esModule?e:{default:e}}var O=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateSegments=function(e){var t=n.props,a=t.fields,r=t.formChange,o=e.map((function(e){return e.id})),i=a.getAll().map((function(e){return e.model.audience_segment_id})),s=a.getAll().filter((function(e){return o.includes(e.model.audience_segment_id)})),l=e.filter((function(e){return!i.includes(e.id)})).map((function(e){return{key:(0,c.default)(),model:{audience_segment_id:e.id,exclude:!1},meta:{name:e.name}}}));r(a.name,s.concat(l)),n.props.closeNextDrawer()},n.openAudienceSegmentSelector=function(){var e=n.props,t=e.openNextDrawer,a=e.closeNextDrawer,r={additionalProps:{selectedSegmentIds:e.fields.getAll().map((function(e){return e.model.audience_segment_id})),close:a,save:n.updateSegments}};t(m.default,r)},n.getSegmentRecords=function(){var e=n.props.fields,t=n.state,a=t.fetchingReport,o=t.reportBySegmentId,i=function(e){return e.meta.name},s=function(e){var t=e.model.audience_segment_id;if(a)return r.createElement(l.Spin,{size:"small"});var n=o&&o[t];return n?r.createElement("span",null,r.createElement("span",{className:"m-r-20"},"Cookies:"," ",n.desktop_cookie_ids?(0,v.formatMetric)(n.desktop_cookie_ids,"0,00"):"-"),r.createElement("span",null,"User Points:"," ",n.user_points?(0,v.formatMetric)(n.user_points,"0,00"):"-")):null};return e.getAll().map((function(t,n){return r.createElement(g.RecordElement,{key:t.key,recordIconType:"users",record:t,title:i,additionalData:s,onRemove:function(){return e.remove(n)}})}))},n.state={reportBySegmentId:{},fetchingReport:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.organisationId;this.setState({fetchingReport:!0}),y.default.getAudienceSegmentReport(t,new _.default("now"),new _.default("now"),["audience_segment_id"],void 0).then((function(t){e.setState({fetchingReport:!1,reportBySegmentId:(0,h.normalizeArrayOfObject)((0,v.normalizeReportView)(t.data.report_view),"audience_segment_id")})}))}},{key:"render",value:function(){var e=this.props,t=e.fields,n=e.consents,a=e.intl.formatMessage,o=t.length>0,i=t.getAll().map((function(e){return e.model.audience_segment_id})),s=n.map((function(e){return e.model?e.model.technical_name:"-"}));return r.createElement("div",null,r.createElement(f.FormSection,{dropdownItems:[{id:"why-an-id",message:b.default.segmentSelectionChooseExisting,onClick:this.openAudienceSegmentSelector}],subtitle:b.default.segmentSelectionSubTitle,title:b.default.segmentSelectionTitle}),r.createElement(g.RelatedRecords,{emptyOption:{iconType:"users",message:a(b.default.blastSegmentSelectionEmpty)}},this.getSegmentRecords()),o&&r.createElement("div",{className:"section-footer"},r.createElement(p.default,{segmentIds:i,providerTechnicalNames:s})))}}]),t}(r.Component),w=function(e,t){return(0,u.getFormValues)(e)(t)};t.default=(0,i.compose)(d.withRouter,o.injectIntl,S.injectDrawer,(0,s.connect)((function(e,t){return{consents:w(t.formName,e).consentFields}})))(O)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(25),s=n(8),l=n(6),c=n(13),u=n(67),d=n(56),f=n(15),p=n(12);var m=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.computeSegmentReach=function(e){var t=e.match.params.organisationId,a=e.defaultDatamart,r=e.segmentIds,o=e.providerTechnicalNames,i=a(t).id;r&&r.length>0?n._emailCampaignService.computeSegmentReach(i,r,o).then((function(e){n.setState({count:e})})):n.setState({count:0})},n.compareArrays=function(e,t){return e.length===t.length&&!e.map((function(e){return t.includes(e)})).includes(!1)},n.state={count:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){this.computeSegmentReach(this.props)}},{key:"componentDidUpdate",value:function(e){var t=e.segmentIds,n=this.props.segmentIds;this.compareArrays(n,t)||this.computeSegmentReach(this.props)}},{key:"render",value:function(){var e=this.state.count,t=this.props,n=t.segmentIds,a=t.providerTechnicalNames;return n&&n.length>0?a&&0===a.length?o.createElement("div",{className:"segment-user-reach"},o.createElement(l.FormattedMessage,{id:"email.campaign.edit.segmentReach.missing-provider",defaultMessage:"Please select a provider to have the potential reach number"})):0===e?o.createElement("div",{className:"segment-user-reach"},o.createElement(l.FormattedMessage,{id:"email.campaign.edit.segmentReach.potential-reach-zero",defaultMessage:"There are no email to reach"})):o.createElement("div",{className:"segment-user-reach"},o.createElement(l.FormattedMessage,{id:"email.campaign.edit.segmentReach.potential-reach",defaultMessage:"Potential Reach: {emailCountLabeled} \n              { emailCount, plural, one { email } other { emails }} ",values:{emailCountLabeled:o.createElement("span",{className:"reach-number"},(0,d.formatMetric)(e,"0,00")),emailCount:e}})):null}}]),t}(o.Component);m([(0,f.lazyInject)(p.TYPES.IEmailCampaignService)],g.prototype,"_emailCampaignService",void 0),t.default=(0,s.compose)(c.withRouter,(0,i.connect)((function(e){return{defaultDatamart:(0,u.getDefaultDatamart)(e)}})))(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(8),s=m(n(47)),l=n(13),c=n(24),u=m(n(807)),d=n(183),f=m(n(184)),p=n(61);function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=function(e){function t(){g(this,t);var e=y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.updateTemplates=function(t){var n=e.props,a=n.fields,r=n.formChange,o=n.closeNextDrawer,i=t.map((function(e){return e.id})),l=a.getAll().map((function(e){return e.model.email_template_id})),c=a.getAll().filter((function(e){return i.includes(e.model.email_template_id)})),u=t.filter((function(e){return!l.includes(e.id)})).map((function(e){return{key:(0,s.default)(),model:{email_template_id:e.id},meta:{name:e.name}}}));r(a.name,c.concat(u)),o()},e.openCreativeCardSelector=function(){var t=e.props,n=t.openNextDrawer,a=t.closeNextDrawer,r={additionalProps:{selectedCreativeIds:t.fields.getAll().map((function(e){return e.model.email_template_id})),creativeType:"EMAIL_TEMPLATE",singleSelection:!0,close:a,save:e.updateTemplates}};n(u.default,r)},e.getEmailTemplateRecords=function(){var t=e.props.fields,n=function(e){return e.meta.name};return t.getAll().map((function(e){return r.createElement(d.RecordElement,{key:e.key,recordIconType:"email",record:e,title:n})}))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.meta,n=e.intl.formatMessage,a=e.disabled,o=t.error;return r.createElement("div",null,r.createElement(c.FormSection,{button:{message:n(f.default.blastTemplateSelectionSelectButton),onClick:this.openCreativeCardSelector,disabled:!!a},subtitle:f.default.emailBlastEditorStepSubTitleTemplateSelection,title:f.default.emailBlastEditorStepTitleTemplateSelection}),r.createElement(d.RelatedRecords,{emptyOption:{iconType:"email",message:n(o?f.default.blastTemplateSelectionRequired:f.default.blastTemplateSelectionEmpty),className:o?"required":""}},this.getEmailTemplateRecords()))}}]),t}(r.Component);t.default=(0,i.compose)(o.injectIntl,l.withRouter,p.injectDrawer)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(10),l=n(13),c=n(6),u=h(n(2237)),d=n(592),f=h(n(184)),p=n(51),m=h(n(23)),g=n(15),y=n(12);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onClose=function(){var e=n.props,t=e.history,a=e.location,r=e.match.params,o=r.campaignId,i=r.organisationId,s=o?"/v2/o/"+i+"/campaigns/email/"+o:"/v2/o/"+i+"/campaigns/email";return a.state&&a.state.from?t.push(a.state.from):t.push(s)},n.save=function(e){var t=n.props,a=t.match.params.organisationId,r=t.intl.formatMessage,o=t.notifyError,i=t.history,l=n.state.campaignFormData,c=s.message.loading(r(f.default.savingInProgress),0);return n.setState({loading:!0}),n._emailCampaignFormService.saveCampaign(a,e,l).then((function(e){c();var t="/v2/o/"+a+"/campaigns/email/"+e;i.push(t)})).catch((function(e){c(),o(e),n.setState({loading:!1})}))},n.onSubmitFail=function(){var e=n.props.intl;s.message.error(e.formatMessage(f.default.errorFormMessage))},n.state={loading:!0,campaignFormData:d.INITIAL_EMAIL_CAMPAIGN_FORM_DATA},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.campaignId;t?this._emailCampaignFormService.loadCampaign(t).then((function(t){e.setState({loading:!1,campaignFormData:t})})).catch((function(t){e.setState({loading:!1}),e.props.notifyError(t)})):this.setState({loading:!1})}},{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.intl.formatMessage,a=this.state,r=a.campaignFormData;if(a.loading)return o.createElement(p.Loading,{isFullScreen:!0});var i=r.campaign&&r.campaign.name?n(f.default.emailEditorBreadcrumbEditCampaignTitle,{campaignName:r.campaign.name}):n(f.default.emailEditorBreadcrumbNewCampaignTitle),s=[{name:n(f.default.emailEditorBreadcrumbTitle1),path:"/v2/o/"+t+"/campaigns/email"},{name:i}];return o.createElement(u.default,{initialValues:r,save:this.save,close:this.onClose,breadCrumbPaths:s,onSubmitFail:this.onSubmitFail})}}]),t}(o.Component);v([(0,g.lazyInject)(y.TYPES.IEmailCampaignFormService)],b.prototype,"_emailCampaignFormService",void 0),t.default=(0,i.compose)(c.injectIntl,l.withRouter,m.default)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(35),i=n(10),s=n(2238),l=d(n(184)),c=d(n(60)),u=d(n(101));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=i.Layout.Content,g=o.FieldArray,y="emailCampaignForm",h=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.save,d=e.close,f=e.change,p={general:{sectionId:"general",title:l.default.emailEditorSectionTitle1},routers:{sectionId:"router",title:l.default.emailEditorSectionTitle2},blasts:{sectionId:"blasts",title:l.default.emailEditorSectionTitle3}},h={formId:y,paths:t,message:l.default.emailEditorSaveCampaign,onClose:d},v={items:Object.values(p),scrollId:y};return r.createElement(i.Layout,{className:"edit-layout"},r.createElement(c.default,h),r.createElement(i.Layout,{className:"ant-layout-has-sider"},r.createElement(u.default,v),r.createElement(o.Form,{className:"edit-layout ant-layout",onSubmit:n(a)},r.createElement("button",{type:"submit",style:{display:"none"}}),r.createElement(m,{id:y,className:"mcs-content-container mcs-form-container"},r.createElement("div",{id:p.general.sectionId},r.createElement(s.GeneralFormSection,null)),r.createElement("hr",null),r.createElement("div",{id:p.routers.sectionId},r.createElement(s.RouterFormSection,null)),r.createElement("hr",null),r.createElement("div",{id:p.blasts.sectionId},r.createElement(g,{name:"blastFields",component:s.BlastFormSection,formChange:f,rerenderOnEveryChange:!0}))))))}}]),t}(r.Component);t.default=(0,o.reduxForm)({form:y,enableReinitialize:!0})(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RouterFormSection=t.GeneralFormSection=t.BlastFormSection=void 0;var a=i(n(2239)),r=i(n(2240)),o=i(n(2241));function i(e){return e&&e.__esModule?e:{default:e}}t.BlastFormSection=a.default,t.GeneralFormSection=r.default,t.RouterFormSection=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=y(n(17)),i=y(n(47)),s=n(6),l=n(8),c=n(13),u=n(24),d=n(183),f=y(n(184)),p=n(592),m=y(n(828)),g=n(61);function y(e){return e&&e.__esModule?e:{default:e}}function h(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var _=function(e){function t(){v(this,t);var e=b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.updateBlasts=function(t,n){var a=e.props,r=a.fields,o=a.formChange,s=a.closeNextDrawer,l=[];n?r.getAll().forEach((function(e){e.key===n?l.push({key:n,model:t}):l.push(e)})):(l.push.apply(l,h(r.getAll())),l.push({key:(0,i.default)(),model:t})),o(r.name,l),s()},e.openEmailBlastForm=function(t){var n=e.props,a=n.intl.formatMessage,r=n.openNextDrawer,o=n.closeNextDrawer,i={breadCrumbPaths:[{name:t&&t.model.blast.blast_name?a(f.default.emailBlastEditorBreadcrumbTitleEditBlast,{blastName:t.model.blast.blast_name}):a(f.default.emailBlastEditorBreadcrumbTitleNewBlast)}],close:o,onSubmit:function(n){return e.updateBlasts(n,t&&t.key)}};i.initialValues=t?t.model:p.INITIAL_EMAIL_BLAST_FORM_DATA;var s={additionalProps:i};r(m.default,s)},e.getBlastRecords=function(){var t=e.props,n=t.fields,a=t.intl.formatMessage,i=function(e){return e.model.blast.blast_name},s=function(e){var t=e.model.blast.send_date;return t?r.createElement("span",null,a(f.default.emailBlastEditorDatePickerLabelSentDate),":"," ",(0,o.default)(t).format("DD/MM/YYYY HH:mm")):null};return n.getAll().map((function(t,a){return r.createElement(d.RecordElement,{key:t.key,recordIconType:"email",record:t,title:i,additionalData:s,onEdit:function(){return e.openEmailBlastForm(t)},onRemove:function(){return n.remove(a)}})}))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props.intl.formatMessage;return r.createElement("div",null,r.createElement(u.FormSection,{button:{message:t(f.default.emailBlastEditorBreadcrumbTitleNewBlast),onClick:function(){return e.openEmailBlastForm()}},subtitle:f.default.emailEditorEmailBlastSubTitle,title:f.default.emailEditorEmailBlastTitle}),r.createElement(d.RelatedRecords,{emptyOption:{iconType:"email",message:t(f.default.emailEditorEmailBlastEmpty)}},this.getBlastRecords()))}}]),t}(r.Component);t.default=(0,l.compose)(s.injectIntl,c.withRouter,g.injectDrawer)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=n(13),l=n(24),c=d(n(49)),u=d(n(184));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.fieldValidators.isRequired;return r.createElement("div",null,r.createElement(l.FormSection,{subtitle:u.default.emailBlastEditorStepSubTitleGeneralInformation,title:u.default.emailBlastEditorStepTitleGeneralInformation}),r.createElement(l.FormInputField,{name:"campaign.name",component:l.FormInput,validate:[n],formItemProps:{label:t(u.default.emailEditorNameInputLabel),required:!0},inputProps:{placeholder:t(u.default.emailEditorNameInputPlaceholder)},helpToolTipProps:{title:t(u.default.emailEditorNameInputHelper)}}),r.createElement(l.FormAlertInputField,{name:"campaign.technical_name",component:l.FormAlertInput,formItemProps:{label:t(u.default.emailEditorTechnicalNameInputLabel)},inputProps:{placeholder:t(u.default.emailEditorTechnicalNameInputPlaceholder)},helpToolTipProps:{title:t(u.default.emailEditorTechnicalNameInputHelper)},iconType:"warning",type:"warning",message:t(u.default.warningOnTokenEdition)}))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,s.withRouter,c.default)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(35),s=n(8),l=n(6),c=n(10),u=n(13),d=n(24),f=h(n(49)),p=h(n(333)),m=h(n(184)),g=n(15),y=n(12);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=i.Field,_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={routers:[],fetchingRouters:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({fetchingRouters:!0}),this._emailRouterService.getEmailRouters(this.props.match.params.organisationId).then((function(t){e.setState({fetchingRouters:!1,routers:t.data})}))}},{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.fieldValidators.isRequired;return o.createElement("div",null,o.createElement(d.FormSection,{subtitle:m.default.emailEditorRouterSubTitle,title:m.default.emailEditorRouterTitle}),o.createElement(b,{name:"routerFields[0].model.email_router_id",component:p.default,validate:[n],formItemProps:{label:t(m.default.emailEditorRouterSelectLabel),required:!0},selectProps:{notFoundContent:this.state.fetchingRouters?o.createElement(c.Spin,{size:"small"}):null},options:this.state.routers.map((function(e){return{value:e.id,title:e.name}})),helpToolTipProps:{title:t(m.default.emailEditorRouterSelectHelper)}}))}}]),t}(o.Component);v([(0,g.lazyInject)(y.TYPES.IEmailRouterService)],_.prototype,"_emailRouterService",void 0),t.default=(0,s.compose)(l.injectIntl,u.withRouter,f.default)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmailCampaignListPage=t.EmailCampaignsTable=t.EmailCampaignsActionbar=void 0;var a=i(n(2243)),r=i(n(1091)),o=i(n(2244));function i(e){return e&&e.__esModule?e:{default:e}}t.EmailCampaignsActionbar=a.default,t.EmailCampaignsTable=r.default,t.EmailCampaignListPage=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(8),l=n(33),c=n(6),u=n(11),d=_(n(142)),f=_(n(78)),p=n(56),m=n(83),g=n(829),y=n(30),h=_(n(616)),v=n(15),b=n(12);function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchExportData=function(e,t){var a,r=t.from,o=t.to;return Promise.all([n._emailCampaignService.getEmailCampaigns(e,"EMAIL",(a={archived:t.statuses.includes("ARCHIVED"),first_result:0,max_results:2e3},t.keywords&&(a.keywords=t.keywords),a)),f.default.getEmailDeliveryReport(e,r,o,["campaign_id"])]).then((function(e){var t=(0,m.normalizeArrayOfObject)(e[0].data,"id"),n=(0,m.normalizeArrayOfObject)((0,p.normalizeReportView)(e[1].data.report_view),"campaign_id");return Object.keys(t).map((function(e){return Object.assign(Object.assign({},t[e]),n[e])}))}))},n.handleRunExport=n.handleRunExport.bind(n),n.state={exportIsRunning:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"handleRunExport",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.intl,r=(0,y.parseSearch)(this.props.location.search,g.EMAIL_SEARCH_SETTINGS);this.setState({exportIsRunning:!0});var o=i.message.loading(a.formatMessage(h.default.exportInProgress),0);this.fetchExportData(n,r).then((function(t){d.default.exportEmailCampaigns(n,t,r,a.formatMessage),e.setState({exportIsRunning:!1}),o()})).catch((function(){e.setState({exportIsRunning:!1}),o()}))}},{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.intl,a=this.state.exportIsRunning,r=[{name:n.formatMessage(h.default.emails),path:"/v2/o/"+t+"/campaigns/email"}];return o.createElement(u.Actionbar,{paths:r},o.createElement(l.Link,{to:"/v2/o/"+t+"/campaigns/email/create"},o.createElement(i.Button,{type:"primary",className:"mcs-primary"},o.createElement(u.McsIcon,{type:"plus"})," ",o.createElement(c.FormattedMessage,{id:"email.campaigns.list.actionbar.newCampaign",defaultMessage:"New Campaign"}))),o.createElement(i.Button,{onClick:this.handleRunExport,loading:a},!a&&o.createElement(u.McsIcon,{type:"download"}),o.createElement(c.FormattedMessage,{id:"email.campaigns.list.actionbar.export",defaultMessage:"Export"})))}}]),t}(o.Component);S([(0,v.lazyInject)(b.TYPES.IEmailCampaignService)],E.prototype,"_emailCampaignService",void 0),t.default=(0,s.compose)(c.injectIntl,l.withRouter)(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=M(n(0)),i=n(8),s=n(25),l=n(6),c=w(n(1091)),u=n(30),d=n(44),f=n(56),p=n(83),m=n(829),g=w(n(78)),y=M(n(124)),h=n(13),v=w(n(23)),b=n(616),_=n(10),S=n(15),E=n(12),O=n(41);function w(e){return e&&e.__esModule?e:{default:e}}function M(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var P=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},T=(0,d.takeLatest)(g.default.getEmailDeliveryReport),I=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleArchiveCampaign=function(e){var t=n.props,a=t.match.params.organisationId,r=t.location,i=r.pathname,s=r.state,l=r.search,c=t.history,d=t.intl,f=(0,u.parseSearch)(l,m.EMAIL_SEARCH_SETTINGS),p=function(){n.fetchCampaignAndStats(a,f)},g=n.buildTableDataSource();_.Modal.confirm({title:d.formatMessage(b.messages.confirmArchiveModalTitle),content:d.formatMessage(b.messages.confirmArchiveModalContent),icon:o.createElement(O.ExclamationCircleOutlined,null),okText:d.formatMessage(b.messages.confirmArchiveModalOk),cancelText:d.formatMessage(b.messages.confirmArchiveModalCancel),onOk:function(){n._emailCampaignService.deleteEmailCampaign(e.id).then((function(){if(1===g.length&&1!==f.currentPage){var e=Object.assign(Object.assign({},f),{currentPage:f.currentPage-1,automated:!0});p(),c.replace({pathname:i,search:(0,u.updateSearch)(l,e),state:s})}p()}))},onCancel:function(){}})},n.handleFilterChange=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,u.updateSearch)(o,e,m.EMAIL_SEARCH_SETTINGS)};a.push(i)},n.fetchCampaignAndStats=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(){var e=Object.assign({archived:t.statuses.includes("ARCHIVED"),automated:!1},(0,d.getPaginatedApiParam)(t.currentPage,t.pageSize)),n=t.statuses.filter((function(e){return"ARCHIVED"!==e}));return t.keywords&&(e.keywords=t.keywords),t.label_id.length>0&&(e.label_id=t.label_id),n.length>0&&(e.status=n),a?Object.assign({},(0,d.getPaginatedApiParam)(1,10)):e};n._emailCampaignService.getEmailCampaigns(e,"EMAIL",r()).then((function(e){n.setState({isFetchingCampaigns:!1,allCampaignIds:e.data.map((function(e){return e.id})),emailCampaignsById:(0,p.normalizeArrayOfObject)(e.data,"id"),totalCampaigns:e.total||0,hasEmailCampaigns:!a||0!==e.count})})).catch((function(e){n.setState({isFetchingCampaigns:!1}),n.props.notifyError(e,{intlMessage:b.messages.fetchCampaignError})})),T(e,t.from,t.to,"campaign_id").then((function(e){n.setState({isFetchingStats:!1,deliveryReportByCampaignId:(0,p.normalizeArrayOfObject)((0,f.normalizeReportView)(e.data.report_view),"campaign_id")})})).catch((function(e){n.setState({isFetchingStats:!1}),n.props.notifyError(e,{intlMessage:b.messages.fetchReportError})}))},n.buildTableDataSource=function(){var e=n.state,t=e.emailCampaignsById,a=e.deliveryReportByCampaignId;return e.allCampaignIds.map((function(e){return Object.assign(Object.assign({},t[e]),a[e])}))},n.state={emailCampaignsById:{},deliveryReportByCampaignId:{},allCampaignIds:[],totalCampaigns:0,isFetchingCampaigns:!0,isFetchingStats:!0,hasEmailCampaigns:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.location,a=n.search,r=n.pathname,o=e.history;if((0,u.isSearchValid)(a,m.EMAIL_SEARCH_SETTINGS)){var i=(0,u.parseSearch)(a,m.EMAIL_SEARCH_SETTINGS);this.fetchCampaignAndStats(t,i,!0)}else o.replace({pathname:r,search:(0,u.buildDefaultSearch)(a,m.EMAIL_SEARCH_SETTINGS),state:{reloadDataSource:!0}})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.match.params.organisationId,a=t.location,r=a.pathname,o=a.search,i=t.history,s=e.match.params.organisationId,l=e.location.search;if(!(0,u.compareSearches)(o,l)||n!==s)if((0,u.isSearchValid)(o,m.EMAIL_SEARCH_SETTINGS)){var c=(0,u.parseSearch)(o,m.EMAIL_SEARCH_SETTINGS);this.fetchCampaignAndStats(n,c)}else i.replace({pathname:r,search:(0,u.buildDefaultSearch)(o,m.EMAIL_SEARCH_SETTINGS),state:{reloadDataSource:n!==s}})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isFetchingCampaigns,a=t.isFetchingStats,r=t.totalCampaigns,i=t.hasEmailCampaigns,s=this.props,l=s.location.search,d=s.labels,f=(0,u.parseSearch)(l,m.EMAIL_SEARCH_SETTINGS),p={labels:this.props.labels,selectedLabels:d.filter((function(e){return!!f.label_id.find((function(t){return t===e.id}))})),onChange:function(t){var n=t.map((function(e){return e.id}));e.handleFilterChange({label_id:n})},buttonMessage:b.messages.filterByLabel};return o.createElement(c.default,{dataSource:this.buildTableDataSource(),archiveCampaign:this.handleArchiveCampaign,hasEmailCampaigns:i,totalCampaigns:r,isFetchingCampaigns:n,isFetchingStats:a,filter:f,onFilterChange:this.handleFilterChange,labelsOptions:p})}}]),t}(o.Component);P([(0,S.lazyInject)(E.TYPES.IEmailCampaignService)],I.prototype,"_emailCampaignService",void 0),t.default=(0,i.compose)(l.injectIntl,h.withRouter,v.default,(0,s.connect)((function(e){return{labels:e.labels.labelsApi.data}}),{notifyError:y.notifyError}))(I)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmailCampaignPage=void 0;var a,r=n(2246),o=(a=r)&&a.__esModule?a:{default:a};t.EmailCampaignPage=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(8),l=n(33),c=n(10),u=M(n(2247)),d=M(n(338)),f=n(340),p=n(11),m=n(830),g=n(30),y=M(n(23)),h=M(n(1092)),v=n(831),b=M(n(2250)),_=M(n(78)),S=M(n(59)),E=n(56),O=n(15),w=n(12);function M(e){return e&&e.__esModule?e:{default:e}}var P=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},T=c.Layout.Content,I=(0,i.defineMessages)({overview:{id:"email.campaigns.page.tabs.overview",defaultMessage:"Overview"},devileryAnalysis:{id:"email.campaigns.page.tabs.deliveryAnalysis",defaultMessage:"Delivery Analysis"},statusUpdateSuccess:{id:"email.campaigns.page.status-update-successfull",defaultMessage:"Campaign status successfully updated"},statusUpdateFailure:{id:"email.campaigns.page.status-update-failure",defaultMessage:"There was an error updating your campaign... Please try again..."},notifSuccess:{id:"email.campaigns.page.notification-success",defaultMessage:"Success"},notifError:{id:"email.campaigns.page.notification-error",defaultMessage:"Error"}}),A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.loadCampaign=function(e){n.state.campaign&&n.state.campaign.id===e||(n.setState({isLoadingCampaign:!0}),n._emailCampaignService.getEmailCampaign(e).then((function(e){n.setState({isLoadingCampaign:!1,campaign:e.data})})).catch((function(e){S.default.error(e),n.setState({isLoadingCampaign:!1}),n.props.notifyError(e)})))},n.refreshStats=function(e,t,a){n.setState({isLoadingCampaignStatReport:!0}),_.default.getSingleEmailDeliveryReport(e,t,a.from,a.to,["day"]).then((function(e){n.setState({isLoadingCampaignStatReport:!1,campaignStatReport:(0,E.normalizeReportView)(e.data.report_view)})})).catch((function(e){S.default.error(e),n.setState({isLoadingCampaignStatReport:!1}),n.props.notifyError(e)}))},n.updateCampaignStatus=function(e){var t=n.props,a=t.match.params.campaignId,r=t.intl,o=t.notifySuccess,i=t.notifyError;n.setState({isLoadingCampaign:!0}),n._emailCampaignService.updateEmailCampaign(a,{status:e}).then((function(e){n.setState({isLoadingCampaign:!1,campaign:e.data}),o({message:r.formatMessage(I.notifSuccess),description:r.formatMessage(I.statusUpdateSuccess)})})).catch((function(e){return i(e,{message:r.formatMessage(I.notifError),description:r.formatMessage(I.statusUpdateFailure)})}))},n.state={isLoadingCampaign:!1,isLoadingCampaignStatReport:!1,campaignStatReport:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.history,n=e.location,a=n.search,r=n.pathname,o=e.match.params,i=o.organisationId,s=o.campaignId;if((0,g.isSearchValid)(a,m.EMAIL_DASHBOARD_SEARCH_SETTINGS)){var l=(0,g.parseSearch)(a,m.EMAIL_DASHBOARD_SEARCH_SETTINGS);this.loadCampaign(s),this.refreshStats(i,s,l)}else t.replace({pathname:r,search:(0,g.buildDefaultSearch)(a,m.EMAIL_DASHBOARD_SEARCH_SETTINGS)})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.location,a=n.pathname,r=n.search,o=t.match.params,i=o.campaignId,s=o.organisationId,l=t.history,c=e.location.search,u=e.match.params.campaignId;if(!(0,g.compareSearches)(r,c)||i!==u)if((0,g.isSearchValid)(r,m.EMAIL_DASHBOARD_SEARCH_SETTINGS)){var d=(0,g.parseSearch)(r,m.EMAIL_DASHBOARD_SEARCH_SETTINGS);this.loadCampaign(i),this.refreshStats(s,i,d)}else l.replace({pathname:a,search:(0,g.buildDefaultSearch)(r,m.EMAIL_DASHBOARD_SEARCH_SETTINGS)})}},{key:"updateLocationSearch",value:function(e){var t=this.props,n=t.history,a=t.location,r=a.search,o={pathname:a.pathname,search:(0,g.updateSearch)(r,e,m.EMAIL_DASHBOARD_SEARCH_SETTINGS)};n.push(o)}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params,a=n.organisationId,r=n.campaignId,i=t.location.search,s=t.intl,l=this.state,c=l.campaign,y=l.isLoadingCampaignStatReport,_=l.campaignStatReport,S=l.isLoadingCampaign,E=(0,g.parseSearch)(i,m.EMAIL_DASHBOARD_SEARCH_SETTINGS),O=[{title:s.formatMessage(I.overview),display:o.createElement(h.default,{campaign:c,isLoading:S})},{title:s.formatMessage(I.devileryAnalysis),display:o.createElement(v.EmailStackedAreaChart,{dateRangeValue:{from:E.from,to:E.to},onDateRangeChange:function(t){return e.updateLocationSearch(t)},isLoading:y,emailReport:_})}];return o.createElement("div",{className:"ant-layout"},o.createElement(u.default,{campaign:c,activateCampaign:function(){return e.updateCampaignStatus("ACTIVE")},pauseCampaign:function(){return e.updateCampaignStatus("PAUSED")},archiveCampaign:function(){}}),o.createElement("div",{className:"ant-layout"},o.createElement(T,{className:"mcs-content-container"},o.createElement(d.default,{campaign:c}),o.createElement(f.Labels,{labellableId:r,labellableType:"EMAIL_CAMPAIGN",organisationId:a}),o.createElement(p.Card,null,o.createElement(p.McsTabs,{items:O})),o.createElement(b.default,null))))}}]),t}(o.Component);P([(0,O.lazyInject)(w.TYPES.IEmailCampaignService)],A.prototype,"_emailCampaignService",void 0),t.default=(0,s.compose)(l.withRouter,i.injectIntl,y.default)(A)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(41),l=n(10),c=n(33),u=n(6),d=n(8),f=n(107),p=C(n(615)),m=C(n(309)),g=C(n(797)),y=C(n(142)),h=n(30),v=n(830),b=C(n(23)),_=n(11),S=C(n(78)),E=n(56),O=C(n(59)),w=C(n(162)),M=n(615),P=C(n(273)),T=C(n(182)),I=n(15),A=n(12);function C(e){return e&&e.__esModule?e:{default:e}}var j=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},R=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleRunExport=function(e){var t=n.props,r=t.match.params,o=r.organisationId,i=r.campaignId,s=t.intl.formatMessage,c=t.location.search,u=t.campaign;n.setState({exportIsRunning:!0});var d=(0,h.parseSearch)(c,v.EMAIL_DASHBOARD_SEARCH_SETTINGS),f=l.message.loading(s(g.default.exportInProgress),0);Promise.all([n._emailCampaignService.getBlasts(i).then((function(e){return e.data})),S.default.getSingleEmailDeliveryReport(o,i,d.from,d.to,["day"]).then((function(e){return(0,E.normalizeReportView)(e.data.report_view)}))]).then((function(e){var t=a(e,2),r=t[0],i=t[1];y.default.exportEmailCampaignDashboard(o,u,i,r,d,s),n.setState({exportIsRunning:!1}),f()})).catch((function(e){O.default.error(e),n.setState({exportIsRunning:!1}),f()}))},n.buildActionElement=function(){var e=n.props,t=e.campaign,a=e.activateCampaign,r=e.pauseCampaign,o=i.createElement(l.Button,{className:"mcs-primary",type:"primary",onClick:a},i.createElement(_.McsIcon,{type:"play"}),i.createElement(u.FormattedMessage,{id:"email.campaign.dashboard.actionbar.activateCampaign",defaultMessage:"Activate Campaign"})),s=i.createElement(l.Button,{className:"mcs-primary",type:"primary",onClick:r},i.createElement(_.McsIcon,{type:"pause"}),i.createElement(u.FormattedMessage,{id:"email.campaign.dashboard.actionbar.pauseCampaign",defaultMessage:"Pause Campaign"}));return t&&t.status?"PAUSED"===t.status||"PENDING"===t.status?o:s:null},n.buildMenu=function(){var e=n.props,t=e.campaign,a=e.archiveCampaign,r=e.intl.formatMessage;return i.createElement(l.Menu,{onClick:function(e){var o=n.props,c=o.match.params,d=c.organisationId,f=c.campaignId,p=o.history;switch(e.key){case"HISTORY":return n.props.openNextDrawer(P.default,{size:"small",additionalProps:{resourceType:"CAMPAIGN",resourceId:f,handleClose:function(){return n.props.closeNextDrawer()},formatProperty:M.formatCampaignProperty,resourceLinkHelper:{EMAIL_BLAST:{direction:"CHILD",getType:function(){return i.createElement(u.FormattedMessage,T.default.emailBlastResourceType)},getName:function(e){return n._emailCampaignService.getBlast(f,e).then((function(t){return t.data.blast_name||e}))},goToResource:function(e){p.push("/v2/o/"+d+"/campaigns/email/"+f+"/blasts/"+e+"/edit")}},EMAIL_ROUTER_SELECTION:{direction:"CHILD",getType:function(){return i.createElement(u.FormattedMessage,T.default.emailRouterResourceType)},getName:function(e){return n._resourceHistoryService.getLinkedResourceIdInSelection(d,"EMAIL_ROUTER_SELECTION",e,"EMAIL_ROUTER").then((function(e){return n._emailRoutersService.getEmailRouter(e).then((function(e){return e.data.name}))}))},goToResource:function(e){return n._resourceHistoryService.getLinkedResourceIdInSelection(d,"EMAIL_ROUTER_SELECTION",e,"EMAIL_ROUTER").then((function(e){p.push("/v2/o/"+d+"/settings/campaigns/email_routers/"+e+"/edit")}))}}}}});case"ARCHIVED":return t&&(t.id,void l.Modal.confirm({title:r(m.default.archiveCampaignConfirm),content:r(m.default.archiveCampaignMessage),icon:i.createElement(s.ExclamationCircleOutlined,null),okText:r(m.default.confirm),cancelText:r(m.default.cancel),onOk:function(){return a()}}));default:return function(){}}}},i.createElement(l.Menu.Item,{key:"HISTORY"},i.createElement(u.FormattedMessage,p.default.history)),i.createElement(l.Menu.Item,{key:"ARCHIVED"},i.createElement(u.FormattedMessage,{id:"email.campaign.dashboard.actionbar.archive",defaultMessage:"Archive"})))},n.exportIsRunningModal=function(e){var t=n.props.intl.formatMessage;l.Modal.warning({title:t(m.default.exportIsRunningTitle),content:t(m.default.exportIsRunningMessage),icon:i.createElement(s.ExclamationCircleOutlined,null),okText:t(m.default.confirm),onOk:function(){}})},n.state={exportIsRunning:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.match.params,n=t.organisationId,a=t.campaignId,r=e.intl.formatMessage,o=e.campaign,d=this.buildActionElement(),m=this.buildMenu(),g=[{name:r(p.default.email),path:"/v2/o/"+n+"/campaigns/email"},{name:o?o.name:""}];return i.createElement(_.Actionbar,{paths:g},d,i.createElement(l.Button,{onClick:this.state.exportIsRunning?this.exportIsRunningModal:this.handleRunExport},i.createElement(_.McsIcon,{type:"download"}),i.createElement(u.FormattedMessage,{id:"email.campaign.dashboard.actionbar.export",defaultMessage:"Export"})),i.createElement(c.Link,{to:"/v2/o/"+n+"/campaigns/email/"+a+"/edit"},i.createElement(l.Button,null,i.createElement(s.EditOutlined,null),i.createElement(u.FormattedMessage,{id:"email.campaign.dashboard.actionbar.edit",defaultMessage:"Edit"}))),i.createElement(f.Dropdown,{overlay:m,trigger:["click"]},i.createElement(l.Button,null,i.createElement(s.EllipsisOutlined,null))))}}]),t}(i.Component);j([(0,I.lazyInject)(A.TYPES.IEmailRouterService)],R.prototype,"_emailRoutersService",void 0),j([(0,I.lazyInject)(A.TYPES.IResourceHistoryService)],R.prototype,"_resourceHistoryService",void 0),j([(0,I.lazyInject)(A.TYPES.IEmailCampaignService)],R.prototype,"_emailCampaignService",void 0),t.default=(0,d.compose)(c.withRouter,u.injectIntl,b.default,w.default)(R)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(69),l=(a=s)&&a.__esModule?a:{default:a},c=n(8),u=n(6),d=n(11);function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=(0,u.defineMessages)({DELIVERED:{id:"email.campaigns.dashboard.charts.delivered",defaultMessage:"Delivered"},OPENS:{id:"email.campaigns.dashboard.charts.opened",defaultMessage:"Opened"},CLICKS:{id:"email.campaigns.dashboard.charts.clicks",defaultMessage:"Clicks"},CLICKS_TO_OPENS:{id:"email.campaigns.dashboard.charts.openingCLicks",defaultMessage:"Opening Clicks"},UNSUBSCRIBE:{id:"email.campaigns.dashboard.charts.Unsubscribed",defaultMessage:"Unsubscribed"}}),g=function(e){function t(){f(this,t);var e=p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.renderPieCharts=function(t){var n=t.emailClicks,a=t.emailDelivered,r=t.emailOpened,s=t.emailUnsubscribed,l=t.emailSent,c=function(e,t){if(0===e||0===t)return"0%";var n=e/t*100;return Math.round(n)+"%"},u=function(t){var o=e.props.colors;switch(t){case"delivered":return[{key:"delivered",value:a||0,color:o["mcs-warning"]},{key:"rest",value:0===a?100:Math.abs(l-a),color:"#eaeaea"}];case"opens":return[{key:"opened",value:r||0,color:o["mcs-info"]},{key:"rest",value:0===r?100:Math.abs(l-r),color:"#eaeaea"}];case"clicks2open":return[{key:"clicks",value:n||0,color:o["mcs-info"]},{key:"rest",value:0===n?100:Math.abs(r-n),color:"#eaeaea"}];case"clicks":return[{key:"clicks",value:n||0,color:o["mcs-info"]},{key:"rest",value:0===n?100:Math.abs(l-n),color:"#eaeaea"}];case"unsubscribe":return[{key:"unsubscribe",value:s||0,color:o["mcs-info"]},{key:"rest",value:0===s?100:Math.abs(l-s),color:"#eaeaea"}];default:return[]}},f=function(t,n,a,r,o){var i=e.props,s=i.colors,l=i.intl,u="";u="blue"===n?s["mcs-info"]:s["mcs-warning"];return{innerRadius:!0,isHalf:t,text:{value:c(r,o),text:l.formatMessage(m[a])},colors:[u,"#eaeaea"]}};return o.createElement("div",null,o.createElement(i.Row,null,o.createElement(i.Col,{span:7},o.createElement(d.PiePlot,{dataset:u("delivered"),options:f(!1,"orange","DELIVERED",a,l)})),o.createElement(i.Col,{span:17},o.createElement(i.Row,null,o.createElement(i.Col,{span:12},o.createElement(d.PiePlot,{dataset:u("opens"),options:f(!0,"blue","OPENS",r,l)})),o.createElement(i.Col,{span:12},o.createElement(d.PiePlot,{dataset:u("clicks"),options:f(!0,"blue","CLICKS",n,l)}))),o.createElement(i.Row,null,o.createElement(i.Col,{span:12},o.createElement(d.PiePlot,{dataset:u("clicks2open"),options:f(!0,"blue","CLICKS_TO_OPENS",n,r)})),o.createElement(i.Col,{span:12},o.createElement(d.PiePlot,{dataset:u("unsubscribe"),options:f(!0,"blue","UNSUBSCRIBE",s,l)}))))))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.deliveryReport;return e.isLoading?o.createElement(d.LoadingChart,null):t?this.renderPieCharts(t):o.createElement(d.EmptyChart,{title:o.createElement(u.FormattedMessage,{id:"email.campaign.dashboard.charts.noData",defaultMessage:"No Data"}),icon:"warning"})}}]),t}(o.Component);t.default=(0,c.compose)(l.default,u.injectIntl)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(8),s=n(415),l=p(n(1093)),c=p(n(69)),u=n(6),d=n(1094),f=n(11);function p(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e){function t(){return m(this,t),g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"renderStackedAreaCharts",value:function(){var e=this.props,t=e.emailReport,n=e.isLoading,a=e.colors,o=e.intl.formatMessage,i={xKey:"day",yKeys:[{key:"email_sent",message:o(l.default.emailSent)},{key:"clicks",message:o(l.default.emailClicks)},{key:"impressions",message:o(l.default.emailImpressions)},{key:"email_hard_bounced",message:o(l.default.emailHardBounce)}],colors:[a["mcs-warning"],a["mcs-info"],a["mcs-success"],a["mcs-error"]]};return n?r.createElement(f.LoadingChart,null):r.createElement(f.StackedAreaPlot,{dataset:t,options:i})}},{key:"render",value:function(){var e=this.props,t=e.emailReport,n=e.isLoading,a=e.colors,i=e.dateRangeValue,l=e.onDateRangeChange,c=e.intl,u=[{domain:c.formatHTMLMessage(d.messagesMap.emailSent),color:a["mcs-warning"]},{domain:c.formatHTMLMessage(d.messagesMap.clicks),color:a["mcs-info"]},{domain:c.formatHTMLMessage(d.messagesMap.impressions),color:a["mcs-success"]},{domain:c.formatHTMLMessage(d.messagesMap.emailHardBounced),color:a["mcs-error"]}];return r.createElement("div",null,r.createElement(o.Row,{className:"mcs-chart-header"},r.createElement(o.Col,{span:12},0===t.length&&n?r.createElement("div",null):r.createElement(s.LegendChart,{identifier:"chartLegend",options:u})),r.createElement(o.Col,{span:12},r.createElement("span",{className:"mcs-card-button"},r.createElement(f.McsDateRangePicker,{values:i,onChange:l})))),0===t.length&&n?r.createElement(f.EmptyChart,{title:c.formatMessage(d.messagesMap.noEmailStats),icon:"warning"}):this.renderStackedAreaCharts())}}]),t}(r.Component);t.default=(0,i.compose)(c.default,u.injectIntl)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(8),c=n(33),u=n(6),d=n(11),f=O(n(1093)),p=n(830),m=O(n(1094)),g=O(n(23)),y=O(n(59)),h=O(n(78)),v=n(30),b=n(56),_=n(83),S=n(15),E=n(12);function O(e){return e&&e.__esModule?e:{default:e}}var w=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.refreshData=function(){var e=n.props,t=e.location.search,r=e.match.params,o=r.campaignId,i=r.organisationId;n.setState({isLoading:!0});var s=(0,v.parseSearch)(t,p.EMAIL_DASHBOARD_SEARCH_SETTINGS);Promise.all([h.default.getEmailDeliveryReport(i,s.from,s.to,["campaign_id","sub_campaign_id"]).then((function(e){return(0,_.normalizeArrayOfObject)((0,b.normalizeReportView)(e.data.report_view),"sub_campaign_id")})),n._emailCampaignService.getBlasts(o).then((function(e){return e.data}))]).then((function(e){var t=a(e,2),r=t[0],o=t[1];n.setState({isLoading:!1,blasts:o.map((function(e){return Object.assign(Object.assign({},e),r[e.id])}))})})).catch((function(e){y.default.error(e),n.props.notifyError(e),n.setState({isLoading:!1})}))},n.handleUpdateStatus=function(e,t){var a=n.props.match.params.campaignId;n.setState({isLoading:!0}),n._emailCampaignService.updateBlast(a,e,{status:t}).then((function(e){n.props.notifySuccess({intlMessage:f.default.blastStatusUpdateSuccessMessage,intlDescription:f.default.blastStatusUpdateSuccessDescription}),n.refreshData(),n.setState({isLoading:!1})})).catch((function(e){y.default.error(e),n.props.notifyError(e,{intlMessxage:f.default.blastStatusUpdateFailure}),n.setState({isLoading:!1})}))},n.handleArchiveBlast=function(e){},n.state={isLoading:!1,blasts:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.refreshData()}},{key:"render",value:function(){var e=this.props,t=e.intl,n=e.match.params,a=n.organisationId,r=n.campaignId,o=this.state,l=o.isLoading,p=o.blasts,g=i.createElement(c.Link,{to:"/v2/o/"+a+"/campaigns/email/"+r+"/blasts/create"},i.createElement(s.Button,{type:"primary"},i.createElement(u.FormattedMessage,{id:"email.campaign.dashboard.blastCard.newEmailBlast",defaultMessage:"New Email Blast"})));return i.createElement(d.Card,{title:t.formatMessage(f.default.emailBlast),buttons:g},i.createElement(m.default,{isLoading:l,data:p,isStatLoading:!1,updateBlastStatus:this.handleUpdateStatus,archiveBlast:this.handleArchiveBlast}))}}]),t}(i.Component);w([(0,S.lazyInject)(E.TYPES.IEmailCampaignService)],M.prototype,"_emailCampaignService",void 0),t.default=(0,l.compose)(u.injectIntl,c.withRouter,g.default)(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoalsTable=t.GoalsActionbar=void 0;var a=o(n(2252)),r=o(n(2253));function o(e){return e&&e.__esModule?e:{default:e}}t.GoalsActionbar=a.default,t.GoalsTable=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=b(n(0)),i=n(10),s=n(33),l=n(6),c=n(8),u=n(11),d=b(n(142)),f=b(n(78)),p=n(56),m=n(83),g=n(1095),y=n(30),h=n(12),v=n(15);function b(e){return e&&e.__esModule?e:{default:e}}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=(0,l.defineMessages)({exportInProgress:{id:"goals.actionbar.button.export",defaultMessage:"Export in progress"},goals:{id:"goals.actionbar.breadCrumbPath.goals",defaultMessage:"Goals"}}),E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchExportData=function(e,t){var a,r=t.from,o=t.to;return Promise.all([n._goalService.getGoals(e,(a={},t.statuses&&(a={archived:t.statuses.includes("ARCHIVED"),first_result:0,max_results:2e3}),t.keywords&&(a.keywords=t.keywords),a)),f.default.getConversionPerformanceReport(e,r,o,["goal_id"])]).then((function(e){var t=(0,m.normalizeArrayOfObject)(e[0].data,"id"),n=(0,m.normalizeArrayOfObject)((0,p.normalizeReportView)(e[1].data.report_view),"goal_id");return Object.keys(t).map((function(e){return Object.assign(Object.assign({},t[e]),n[e])}))}))},n.handleRunExport=n.handleRunExport.bind(n),n.state={exportIsRunning:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"handleRunExport",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.intl,r=(0,y.parseSearch)(this.props.location.search,g.GOAL_SEARCH_SETTINGS);this.setState({exportIsRunning:!0});var o=i.message.loading(a.formatMessage(S.exportInProgress),0);this.fetchExportData(n,r).then((function(t){d.default.exportGoals(n,t,r,a.formatMessage),e.setState({exportIsRunning:!1}),o()})).catch((function(){e.setState({exportIsRunning:!1}),o()}))}},{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.intl,a=this.state.exportIsRunning,r=[{name:n.formatMessage(S.goals),path:"/v2/o/"+t+"/campaigns/goals"}];return o.default.createElement(u.Actionbar,{paths:r},o.default.createElement(s.Link,{to:"/v2/o/"+t+"/campaigns/goals/create"},o.default.createElement(i.Button,{className:"mcs-primary",type:"primary"},o.default.createElement(u.McsIcon,{type:"plus"}),o.default.createElement(l.FormattedMessage,{id:"goals.list.actionbar.newGoal",defaultMessage:"New Goal"}))),o.default.createElement(i.Button,{onClick:this.handleRunExport,loading:a},!a&&o.default.createElement(u.McsIcon,{type:"download"}),o.default.createElement(l.FormattedMessage,{id:"goals.list.actionbar.export",defaultMessage:"Export"})))}}]),t}(o.default.Component);_([(0,v.lazyInject)(h.TYPES.IGoalService)],E.prototype,"_goalService",void 0),t.default=(0,c.compose)(s.withRouter,l.injectIntl)(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(25),s=n(33),l=n(41),c=n(10),u=n(6),d=n(8),f=n(68),p=n(1095),m=n(30),g=n(56),y=n(67),h=M(n(23)),v=n(2254),b=n(44),_=M(n(78)),S=n(83),E=n(15),O=n(12),w=n(11);function M(e){return e&&e.__esModule?e:{default:e}}var P=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},T=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.loadGoalsDataSource=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n.setState({isLoadingGoals:!0,isLoadingStats:!0});var r=Object.assign({archived:t.statuses.includes("ARCHIVED")},(0,b.getPaginatedApiParam)(t.currentPage,t.pageSize));t.keywords&&(r.keywords=t.keywords),t.label_id.length&&(r.label_ids=t.label_id),t.datamartId&&(r.datamart_id=t.datamartId),n._goalService.getGoals(e,r).then((function(r){var o=(0,S.normalizeArrayOfObject)(r.data,"id");n.setState({dataSource:Object.keys(o).map((function(e){return Object.assign({},o[e])})),isLoadingGoals:!1,totalGoals:r.total||0,hasGoals:!a||0!==r.count}),_.default.getConversionPerformanceReport(e,t.from,t.to,["goal_id"]).then((function(e){var t=(0,S.normalizeArrayOfObject)((0,g.normalizeReportView)(e.data.report_view),"goal_id");n.setState({isLoadingStats:!1,dataSource:Object.keys(o).map((function(e){return Object.assign(Object.assign({},t[e]),o[e])}))})}))}))},n.handleArchiveGoal=function(e){var t=n.props,a=t.match.params.organisationId,r=t.location,i=r.pathname,s=r.state,u=r.search,d=t.history,f=t.intl,g=t.notifyError,y=n.state.dataSource,h=(0,m.parseSearch)(u,p.GOAL_SEARCH_SETTINGS),b=function(e,t){n.loadGoalsDataSource(a,h)};c.Modal.confirm({title:f.formatMessage(v.messages.archiveGoalModalTitle),content:f.formatMessage(v.messages.archiveGoalModalBody),icon:o.createElement(l.ExclamationCircleOutlined,null),okText:f.formatMessage(v.messages.archiveGoalModalOk),cancelText:f.formatMessage(v.messages.archiveGoalModalCancel),onOk:function(){return n._goalService.updateGoal(e.id,Object.assign(Object.assign({},e),{archived:!0})).then((function(){if(1===Object.keys(y).length&&1!==h.currentPage){var e=Object.assign(Object.assign({},h),{currentPage:h.currentPage-1});b(),d.replace({pathname:i,search:(0,m.updateSearch)(u,e),state:s})}else b()})).catch((function(e){g(e)}))},onCancel:function(){}})},n.handleEditGoal=function(e){var t=n.props,a=t.match.params.organisationId;t.history.push("/v2/o/"+a+"/campaigns/goals/"+e.id+"/edit")},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,m.updateSearch)(o,e,p.GOAL_SEARCH_SETTINGS)};a.push(i)},n.state={isLoadingGoals:!1,isLoadingStats:!1,dataSource:[],totalGoals:0,hasGoals:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.history,n=e.location,a=n.search,r=n.pathname,o=e.match.params.organisationId;if((0,m.isSearchValid)(a,p.GOAL_SEARCH_SETTINGS)){var i=(0,m.parseSearch)(a,p.GOAL_SEARCH_SETTINGS);this.loadGoalsDataSource(o,i,!0)}else t.replace({pathname:r,search:(0,m.buildDefaultSearch)(a,p.GOAL_SEARCH_SETTINGS),state:{reloadDataSource:!0}})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.location,a=n.pathname,r=n.search,o=n.state,i=t.match.params.organisationId,s=t.history,l=e.location.search,c=e.match.params.organisationId,u=o&&o.reloadDataSource;if(!(0,m.compareSearches)(r,l)||i!==c)if((0,m.isSearchValid)(r,p.GOAL_SEARCH_SETTINGS)){var d=(0,m.parseSearch)(r,p.GOAL_SEARCH_SETTINGS);this.loadGoalsDataSource(i,d,u)}else s.replace({pathname:a,search:(0,m.buildDefaultSearch)(r,p.GOAL_SEARCH_SETTINGS),state:{reloadDataSource:i!==c}})}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.location.search,r=t.labels,i=t.intl,d=t.workspace,y=this.state,h=y.dataSource,b=y.totalGoals,_=y.isLoadingStats,S=y.isLoadingGoals,E=y.hasGoals,O=(0,m.parseSearch)(a,p.GOAL_SEARCH_SETTINGS),M={placeholder:i.formatMessage(v.messages.searchBarPlaceholder),onSearch:function(t){return e.updateLocationSearch({keywords:t})},defaultValue:O.keywords},P={isEnabled:!0,onChange:function(t){return e.updateLocationSearch({from:t.from,to:t.to})},values:{from:O.from,to:O.to}},T={current:O.currentPage,pageSize:O.pageSize,total:b,onChange:function(t,n){return e.updateLocationSearch({currentPage:t,pageSize:n})},onShowSizeChange:function(t,n){return e.updateLocationSearch({pageSize:n,currentPage:1})}},I=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(_)return o.createElement("i",{className:"mcs-table-cell-loading"});var a="EUR"===n?"€ ":"";return(0,g.formatMetric)(e,t,a)},A=[{intlMessage:v.messages.status,key:"status",isHideable:!1,render:function(e,t){return o.createElement(c.Tooltip,{placement:"top",title:i.formatMessage(v.messages[e])},o.createElement("span",{className:"mcs-campaigns-status-"+e.toLowerCase()},o.createElement(w.McsIcon,{type:"status"})))}},{intlMessage:v.messages.name,key:"name",isHideable:!1,render:function(e,t){return o.createElement(s.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+n+"/campaigns/goals/"+t.id},e)}},{intlMessage:v.messages.conversions,key:"conversions",isVisibleByDefault:!0,isHideable:!0,render:function(e){return I(e,"0,0")}},{intlMessage:v.messages.conversionValue,key:"value",isVisibleByDefault:!0,isHideable:!0,render:function(e){return I(e,"0,0.00","EUR")}}],C=[{key:"action",actions:function(){return[{intlMessage:v.messages.edit,callback:e.handleEditGoal},{intlMessage:v.messages.archiveGoalActionButton,callback:e.handleArchiveGoal}]}}],j=[{displayElement:o.createElement("div",null,o.createElement(u.FormattedMessage,{id:"goals.list.statusFilter",defaultMessage:"Status"})," ",o.createElement(l.DownOutlined,null)),selectedItems:O.statuses.map((function(e){return{key:e,value:e}})),items:[{key:"ARCHIVED",value:"ARCHIVED"}],getKey:function(e){return e.key},display:function(e){return e.value},handleMenuClick:function(t){e.updateLocationSearch({statuses:t.map((function(e){return e.value}))})}}];if(d(n).datamarts.length>1){var R=d(n).datamarts.map((function(e){return{key:e.id,value:e.name||e.token}})).concat([{key:"",value:"All"}]),N={displayElement:o.createElement("div",null,o.createElement(u.FormattedMessage,{id:"goals.list.datamartFilter",defaultMessage:"Datamart"})," ",o.createElement(l.DownOutlined,null)),selectedItems:O.datamartId?[R.find((function(e){return e.key===O.datamartId}))]:[R],items:R,singleSelectOnly:!0,getKey:function(e){return e&&e.key?e.key:""},display:function(e){return e.value},handleItemClick:function(t){e.updateLocationSearch({datamartId:t&&t.key?t.key:void 0})}};j.push(N)}var k={labels:this.props.labels,selectedLabels:r.filter((function(e){return!!O.label_id.find((function(t){return t===e.id}))})),onChange:function(t){var n=t.map((function(e){return e.id}));e.updateLocationSearch({label_id:n})},buttonMessage:v.messages.labelFilterBy};return E?o.createElement("div",{className:"mcs-table-container"},o.createElement(f.TableViewFilters,{columns:A,actionsColumnsDefinition:C,searchOptions:M,dateRangePickerOptions:P,filtersOptions:j,columnsVisibilityOptions:{isEnabled:!0},dataSource:h,loading:S,pagination:T,labelsOptions:k})):o.createElement(w.EmptyTableView,{iconType:"goals",message:i.formatMessage(v.messages.noGoal)})}}]),t}(o.Component);P([(0,E.lazyInject)(O.TYPES.IGoalService)],T.prototype,"_goalService",void 0);t.default=(0,d.compose)(u.injectIntl,s.withRouter,h.default,(0,i.connect)((function(e){return{labels:e.labels.labelsApi.data,workspace:(0,y.getWorkspace)(e)}})))(T)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=n(6);t.messages=(0,a.defineMessages)({labelFilterBy:{id:"goal.filterby.label",defaultMessage:"Filter By Label"},archiveGoalModalTitle:{id:"goals.table.archive.modal.title",defaultMessage:"Are you sure you want to archive this goal?"},archiveGoalModalBody:{id:"goals.table.archive.modal.message",defaultMessage:"You'll not be able to recover it."},archiveGoalModalOk:{id:"goals.table.archive.modal.ok",defaultMessage:"Archive Now"},archiveGoalModalCancel:{id:"goals.table.archive.modal.cancel",defaultMessage:"Cancel"},searchBarPlaceholder:{id:"goals.table.searchbar.placeholder",defaultMessage:"Search Goals"},archiveGoalActionButton:{id:"goals.table.archive.action.button",defaultMessage:"Archive"},ACTIVE:{id:"goals.table.status.active",defaultMessage:"Active"},PAUSED:{id:"goals.table.status.paused",defaultMessage:"Paused"},status:{id:"goals.table.column.status",defaultMessage:"Status"},name:{id:"goals.table.column.name",defaultMessage:"Name"},conversions:{id:"goals.table.column.conversions",defaultMessage:"Conversions"},conversionValue:{id:"goals.table.column.conversionValue",defaultMessage:"Conversion value"},edit:{id:"goals.table.column.action.edit",defaultMessage:"Edit"},noGoal:{id:"goals.table.noGoal",defaultMessage:"No goals"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(13),l=n(10),c=n(8),u=b(n(2256)),d=n(11),f=b(n(2257)),p=n(30),m=b(n(336)),g=b(n(2260)),y=b(n(2261)),h=n(15),v=n(12);function b(e){return e&&e.__esModule?e:{default:e}}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=l.Layout.Content,E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchGoal=function(e){return n._goalService.getGoal(e).then((function(e){return e.data})).then((function(e){return n.setState({goalObject:{isLoading:!1,item:e}}),n._goalService.getAttributionModels(e.id)})).then((function(e){return e.data})).then((function(e){return n.setState({attributionModels:{isLoading:!1,items:e}})}))},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,p.updateSearch)(o,e,p.DATE_SEARCH_SETTINGS)};a.push(i)},n.renderItems=function(){return n.state.attributionModels.items.sort((function(e,t){return e.id.localeCompare(t.id)})).map((function(e){return{title:"DIRECT"===e.attribution_type?"Direct":e.attribution_model_name,display:o.createElement(y.default,{attributionModelId:e.id})}}))},n.state={goalObject:{item:void 0,isLoading:!0},attributionModels:{items:[],isLoading:!0}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.goalId,n=e.location,a=n.search,r=n.pathname,o=e.history;(0,p.isSearchValid)(a,p.DATE_SEARCH_SETTINGS)?this.fetchGoal(t):o.replace({pathname:r,search:(0,p.buildDefaultSearch)(a,p.DATE_SEARCH_SETTINGS),state:{reloadDataSource:!0}})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.history,a=t.location,r=a.pathname,o=a.search,i=t.match.params,s=i.organisationId,l=i.goalId,c=e.location.search,u=e.match.params.organisationId;(0,p.compareSearches)(o,c)&&s===u||((0,p.isSearchValid)(o,p.DATE_SEARCH_SETTINGS)?this.fetchGoal(l):n.replace({pathname:r,search:(0,p.buildDefaultSearch)(o,p.DATE_SEARCH_SETTINGS),state:{reloadDataSource:s!=s}}))}},{key:"renderDatePicker",value:function(){var e=this,t=this.props.history.location.search,n=(0,p.parseSearch)(t,p.DATE_SEARCH_SETTINGS),a={from:n.from,to:n.to};return o.createElement("div",{style:{marginBottom:5}},o.createElement(d.McsDateRangePicker,{values:a,onChange:function(t){return e.updateLocationSearch({from:t.from,to:t.to})}}))}},{key:"render",value:function(){var e=this.props.intl.formatMessage;return o.createElement("div",{className:"ant-layout"},o.createElement(f.default,{goal:this.state.goalObject.item,fetchGoal:this.fetchGoal}),o.createElement("div",{className:"ant-layout"},o.createElement(S,{className:"mcs-content-container"},o.createElement(u.default,{goal:this.state.goalObject.item}),o.createElement(d.Card,{title:e(m.default.conversions),buttons:this.renderDatePicker()},o.createElement(g.default,null)),this.state.attributionModels.items.length?o.createElement(d.Card,null,o.createElement(d.McsTabs,{items:this.renderItems()})):void 0)))}}]),t}(o.Component);_([(0,h.lazyInject)(v.TYPES.IGoalService)],E.prototype,"_goalService",void 0),t.default=(0,c.compose)(i.injectIntl,s.withRouter)(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),r=n(11);t.default=function(e){var t=e.goal;return a.createElement("div",{className:"mcs-campaign-header"},a.createElement(r.ContentHeader,{title:t?t.name:"",loading:!t||!t.name}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=A(n(54)),s=n(41),l=n(10),c=n(13),u=n(107),d=n(6),f=n(8),p=A(n(309)),m=n(11),g=A(n(59)),y=A(n(336)),h=A(n(78)),v=A(n(142)),b=n(30),_=n(2258),S=A(n(23)),E=n(56),O=n(61),w=A(n(273)),M=A(n(182)),P=n(2259),T=n(15),I=n(12);function A(e){return e&&e.__esModule?e:{default:e}}var C=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},j=[{reportType:"SOURCE",dimensions:["marketing_channel","source","interaction_type"]},{reportType:"CAMPAIGN",dimensions:["campaign_id","campaign_name","interaction_type"]},{reportType:"CREATIVE",dimensions:["creative_id","creative_name","interaction_type"]}],R=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchExportData=function(e,t,a){var r=a.from,o=a.to,s=h.default.getConversionPerformanceReport(e,r,o,["day"],["value","price","conversions"],[{name:"goal_id",value:t}]),l=n._goalService.getAttributionModels(t).then((function(n){var a=i.default.flatMap(n.data,(function(n){return j.map((function(a){return h.default.getConversionAttributionPerformance(e,r,o,[],a.dimensions,["weighted_conversions","weighted_value","interaction_to_conversion_duration"],[{name:"goal_id",value:t},{name:"attribution_model_id",value:n.id}]).then((function(e){return Object.assign(Object.assign({},e),{attribution_model_id:n.attribution_model_id,attribution_model_name:n.attribution_model_name,report_type:a.reportType})}))}))}));return Promise.all(a)}));return s.then((function(e){return l.then((function(t){return{goalData:(0,E.normalizeReportView)(e.data.report_view),attributionsData:t.map((function(e){return{attribution_model_id:e.attribution_model_id,attribution_model_name:e.attribution_model_name,report_type:e.report_type,normalized_report_view:(0,E.normalizeReportView)(e.data.report_view)}}))}}))}))},n.editCampaign=function(){var e=n.props,t=e.location,a=e.history,r=e.match.params,o="/v2/o/"+r.organisationId+"/campaigns/goals/"+r.goalId+"/edit";a.push({pathname:o,state:{from:""+t.pathname+t.search}})},n.changeCampaignStatus=function(){var e=n.props,t=e.fetchGoal,a=e.goal,r=e.notifyError;if(a)return("ACTIVE"===a.status?n._goalService.updateGoal(a.id,{status:"PAUSED"}):n._goalService.updateGoal(a.id,{status:"ACTIVE"})).then((function(e){return t(a.id)})).catch((function(e){return r(e)}))},n.buildMenu=function(){var e=n.props,t=e.goal,a=e.history,r=e.notifyError,i=e.match.params,c=i.organisationId,u=i.goalId,f=e.intl.formatMessage,m=function(e){if(t){l.Modal.confirm({title:f(y.default.archiveGoalModalTitle),content:f(y.default.archiveGoalModalBody),icon:o.createElement(s.ExclamationCircleOutlined,null),okText:f(p.default.confirm),cancelText:f(p.default.cancel),onOk:function(){return n._goalService.updateGoal(t.id,Object.assign(Object.assign({},t),{archived:!0})).then((function(){var e="/v2/o/"+c+"/campaigns/goals";a.push({pathname:e,state:{from:""+location.pathname+location.search}})})).catch((function(e){r(e)}))}})}};return o.createElement(l.Menu,{onClick:function(e){if(t)switch(e.key){case"ARCHIVED":return m(t.id);case"HISTORY":return n.props.openNextDrawer(w.default,{additionalProps:{resourceType:"GOAL",resourceId:u,handleClose:function(){return n.props.closeNextDrawer()},formatProperty:P.formatGoalProperty,resourceLinkHelper:{GOAL_SELECTION:{direction:"PARENT",getType:function(){return o.createElement(d.FormattedMessage,M.default.displayCampaignResourceType)},getName:function(e){return n._resourceHistoryService.getLinkedResourceIdInSelection(c,"GOAL_SELECTION",e,"CAMPAIGN").then((function(e){return n._displayCampaignService.getCampaignName(e).then((function(e){return e}))}))},goToResource:function(e){n._resourceHistoryService.getLinkedResourceIdInSelection(c,"GOAL_SELECTION",e,"CAMPAIGN").then((function(e){a.push("/v2/o/"+c+"/campaigns/display/"+e)}))}}}},size:"small"});default:return function(){g.default.error("onclick error")}}}},o.createElement(l.Menu.Item,{key:"HISTORY"},o.createElement(d.FormattedMessage,y.default.history)),o.createElement(l.Menu.Item,{key:"ARCHIVED"},o.createElement(d.FormattedMessage,y.default.archive)))},n.handleRunExport=n.handleRunExport.bind(n),n.state={exportIsRunning:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"handleRunExport",value:function(){var e=this,t=this.props,n=t.goal,a=t.match.params.organisationId,r=t.intl;if(n){var o=(0,b.parseSearch)(this.props.location.search,_.GOAL_SEARCH_SETTINGS);this.setState({exportIsRunning:!0});var i=l.message.loading(r.formatMessage(y.default.exportInProgress),0);this.fetchExportData(a,n.id,o).then((function(t){v.default.exportGoal(a,t.goalData,t.attributionsData,o,r.formatMessage),e.setState({exportIsRunning:!1}),i()})).catch((function(){e.setState({exportIsRunning:!1}),i()}))}}},{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.goal,a=e.intl,r=this.state.exportIsRunning,i=this.buildMenu(),c=[{name:a.formatMessage(y.default.goals),path:"/v2/o/"+t+"/campaigns/goals"},{name:n&&n.name?n.name:""}];return o.createElement(m.Actionbar,{paths:c},n&&o.createElement(l.Button,{type:"primary",className:"mcs-primary",onClick:this.changeCampaignStatus},"ACTIVE"===n.status?o.createElement("div",null,o.createElement(m.McsIcon,{type:"pause"}),o.createElement(d.FormattedMessage,y.default.pause)):o.createElement("div",null,o.createElement(m.McsIcon,{type:"play"}),o.createElement(d.FormattedMessage,y.default.activate))),o.createElement(l.Button,{onClick:this.handleRunExport,loading:r},!r&&o.createElement(m.McsIcon,{type:"download"}),o.createElement(d.FormattedMessage,{id:"goal.dashboard.actionbar.export",defaultMessage:"Export"})),o.createElement(l.Button,{onClick:this.editCampaign},o.createElement(m.McsIcon,{type:"pen"}),o.createElement(d.FormattedMessage,y.default.edit)),o.createElement(u.Dropdown,{overlay:i,trigger:["click"]},o.createElement(l.Button,null,o.createElement(s.EllipsisOutlined,null))))}}]),t}(o.Component);C([(0,T.lazyInject)(I.TYPES.IDisplayCampaignService)],R.prototype,"_displayCampaignService",void 0),C([(0,T.lazyInject)(I.TYPES.IResourceHistoryService)],R.prototype,"_resourceHistoryService",void 0),C([(0,T.lazyInject)(I.TYPES.IGoalService)],R.prototype,"_goalService",void 0),t.default=(0,f.compose)(c.withRouter,d.injectIntl,S.default,O.injectDrawer)(R)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GOAL_SEARCH_SETTINGS=void 0;var a=n(30);t.GOAL_SEARCH_SETTINGS=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(a.DATE_SEARCH_SETTINGS))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatGoalProperty=void 0;var a=n(6),r=n(414),o=(0,a.defineMessages)({PAUSED:{id:"goal.fields.status.paused",defaultMessage:"Paused"},ACTIVE:{id:"goal.fields.status.active",defaultMessage:"Active"}}),i=(0,a.defineMessages)({id:{id:"goal.fields.id",defaultMessage:"ID"},name:{id:"goal.fields.name",defaultMessage:"Name"},technical_name:{id:"goal.fields.technicalName",defaultMessage:"Technical Name"},default_goal_value:{id:"goal.fields.defaultGoalValue",defaultMessage:"Default Goal Value"},goal_value_currency:{id:"goal.fields.goalValueCurrency",defaultMessage:"Goal Value Currency"},datamart_id:{id:"goal.fields.datamartId",defaultMessage:"Datamart ID"},new_query_id:{id:"goal.fields.newQueryId",defaultMessage:"New Query ID"},organisation_id:{id:"goal.fields.organisationId",defaultMessage:"Organisation ID"},archived:{id:"goal.fields.archived",defaultMessage:"Archived"},status:{id:"goal.fields.status",defaultMessage:"Status"},history_title:{id:"goal.resourceHistory.title",defaultMessage:"Goal History"},history_resource_type:{id:"goal.resourceHistory.type",defaultMessage:"Goal"}}),s={id:{format:"STRING"},name:{format:"STRING"},technical_name:{format:"STRING"},default_goal_value:{format:"FLOAT"},goal_value_currency:{format:"STRING"},datamart_id:{format:"STRING"},new_query_id:{format:"STRING"},organisation_id:{format:"STRING"},archived:{format:"STRING"},status:{format:"MESSAGE",messageMap:o},history_title:{format:"STRING"},history_resource_type:{format:"STRING"}};t.formatGoalProperty=function(e,t){return{message:i[e],formattedValue:t&&s[e]?(0,r.formatToFormattingFunction)(t,s[e].format,s[e].messageMap):void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(33),s=n(10),l=n(6),c=n(415),u=_(n(336)),d=n(30),f=n(56),p=_(n(81)),m=_(n(78)),g=n(44),y=_(n(69)),h=_(n(23)),v=_(n(801)),b=n(11);function _(e){return e&&e.__esModule?e:{default:e}}var S=(0,g.takeLatest)(m.default.getSingleConversionPerformanceReport),E=(0,g.takeLatest)(m.default.getSingleConversionPerformanceReport),O={key1:"value",key2:"conversions",data:{items:[],overall:[],isLoading:!0}},w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchStats=function(e,t,a,r){n.setState({data:{items:[],overall:[],isLoading:!0}});var o=S(e,t,a,r,["day"],["value","price","conversions"]).then((function(e){return e.data.report_view})),i=E(e,t,a,r,[],[n.state.key1,n.state.key2]).then((function(e){return e.data.report_view}));return Promise.all([o,i]).then((function(e){return n.setState({data:{isLoading:!1,items:(0,f.normalizeReportView)(e[0]),overall:(0,f.normalizeReportView)(e[1])}})})).catch((function(e){n.props.notifyError(e),n.setState(Object.assign(Object.assign({},O),{data:Object.assign(Object.assign({},O.data),{isLoading:!1})}))}))},n.state=O,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params,n=t.organisationId,a=t.goalId,r=e.history.location.search,o=(0,d.parseSearch)(r,d.DATE_SEARCH_SETTINGS);this.fetchStats(n,a,o.from,o.to)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.match.params,a=n.organisationId,r=n.goalId,o=t.history,i=t.location,s=i.pathname,l=i.search,c=e.match.params,u=c.organisationId,f=c.goalId,p=e.location.search;if(!(0,d.compareSearches)(l,p)||a!==u||r!==f)if((0,d.isSearchValid)(l,d.DATE_SEARCH_SETTINGS)){var m=(0,d.parseSearch)(l,d.DATE_SEARCH_SETTINGS);this.fetchStats(a,r,m.from,m.to)}else o.replace({pathname:s,search:(0,d.buildDefaultSearch)(l,d.DATE_SEARCH_SETTINGS),state:{reloadDataSource:a!==u}})}},{key:"createLegend",value:function(){var e=this.props.intl.formatMessage;return[{key:"value",domain:e(u.default.value)},{key:"conversions",domain:e(u.default.conversions)},{key:"price",domain:e(u.default.price)}]}},{key:"updateLocationSearch",value:function(e){var t=this.props,n=t.history,a=t.location,r=a.search,o={pathname:a.pathname,search:(0,d.updateSearch)(r,e,d.DATE_SEARCH_SETTINGS)};n.push(o)}},{key:"renderDatePicker",value:function(){var e=this,t=this.props.history.location.search,n=(0,d.parseSearch)(t,d.DATE_SEARCH_SETTINGS),a={from:n.from,to:n.to};return r.createElement(b.McsDateRangePicker,{values:a,onChange:function(t){return e.updateLocationSearch({from:t.from,to:t.to})}})}},{key:"renderStackedAreaCharts",value:function(){var e=this,t=this.props.colors,n=this.state,a=n.key1,o=n.key2,i=n.data,s=i.isLoading,l=i.items,c=i.overall,d={xKey:"day",yKeys:[{key:a,message:u.default[a]},{key:o,message:u.default[o]}],colors:[t["mcs-warning"],t["mcs-info"]],isDraggable:!0,onDragEnd:function(t){e.updateLocationSearch({from:new p.default(t[0]),to:new p.default(t[1])})}},m=[{name:"conversions",value:!s&&c.length?(0,f.formatMetric)(c[0].conversions,"0,0"):void 0},{name:"value",value:!s&&c.length?(0,f.formatMetric)(c[0].value,"0,0"):void 0},{name:"price",value:!s&&c.length?(0,f.formatMetric)(c[0].price,"0,0[.]00","","€"):void 0}];return s?r.createElement(b.LoadingChart,null):r.createElement("div",{style:{display:"flex"}},r.createElement("div",{style:{float:"left"}},r.createElement(b.MetricsColumn,{metrics:m,isLoading:s})),r.createElement(v.default,{dataset:l,options:d,style:{flex:"1"}}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.colors,a=t.intl.formatMessage,o=this.state,i=o.key1,l=o.key2,d=o.data,f=d.isLoading,p=d.items,m=[{key:i,domain:a(u.default[i]),color:n["mcs-warning"]},{key:l,domain:a(u.default[l]),color:n["mcs-info"]}],g=this.createLegend();return r.createElement("div",null,r.createElement(s.Row,{className:"mcs-chart-header"},r.createElement(s.Col,{span:12},0===p.length&&f?r.createElement("div",null):r.createElement(c.LegendChartWithModal,{identifier:"chartLegend",options:m,legends:g,onLegendChange:function(t,n){e.setState({key1:t,key2:n})}}))),0!==p.length||f?r.createElement(s.Row,{gutter:20},r.createElement(s.Col,{span:24},this.renderStackedAreaCharts())):r.createElement(b.EmptyChart,{title:a(u.default.noStatAvailable),icon:"warning"}))}}]),t}(r.Component);t.default=(0,o.compose)(i.withRouter,l.injectIntl,y.default,h.default)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(13),s=n(8),l=h(n(54)),c=h(n(78)),u=n(30),d=n(56),f=h(n(2262)),p=n(10),m=h(n(336)),g=n(11),y=n(2263);function h(e){return e&&e.__esModule?e:{default:e}}var v=p.Select.Option,b=["SOURCE","CAMPAIGN","CREATIVES"],_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchOverall=function(e,t,a,r){return n.setState({overall:{isLoading:!0,items:[]}}),c.default.getConversionAttributionPerformance(e,r.from,r.to,["goal_id=="+t,"attribution_model_id=="+a],["interaction_type"],["weighted_conversions","interaction_to_conversion_duration"]).then((function(e){return e.data.report_view})).then((function(e){return n.setState({overall:{isLoading:!1,items:(0,d.normalizeReportView)(e)}})}))},n.fetchDetailled=function(e,t,a,r,o){n.setState((function(e){return{detailled:Object.assign(Object.assign({},e.detailled),{isLoading:!0})}}),(function(){"SOURCE"===o?n.fetchChannel(e,t,a,r):"CAMPAIGN"===o?n.fetchCampaign(e,t,a,r):"CREATIVES"===o&&n.fetchCreative(e,t,a,r)}))},n.fetchCreative=function(e,t,a,r){return c.default.getConversionAttributionPerformance(e,r.from,r.to,["goal_id=="+t,"attribution_model_id=="+a],["creative_id","creative_name","interaction_type"],["weighted_conversions","weighted_value"]).then((function(e){return(0,d.normalizeReportView)(e.data.report_view)})).then((function(e){var t=l.default.uniq(e.map((function(e){return e.creative_id})));n.setState({detailled:{isLoading:!1,data:{viewType:"CREATIVES",dataSource:e},uniq:t}})}))},n.fetchChannel=function(e,t,a,r){return c.default.getConversionAttributionPerformance(e,r.from,r.to,["goal_id=="+t,"attribution_model_id=="+a],["marketing_channel","source","interaction_type"],["weighted_conversions","weighted_value"]).then((function(e){return(0,d.normalizeReportView)(e.data.report_view)})).then((function(e){var t=l.default.uniq(e.map((function(e){return e.marketing_channel})));n.setState({detailled:{isLoading:!1,data:{dataSource:e,viewType:"SOURCE"},uniq:t}})}))},n.fetchCampaign=function(e,t,a,r){return c.default.getConversionAttributionPerformance(e,r.from,r.to,["goal_id=="+t,"attribution_model_id=="+a],["campaign_name","campaign_id","interaction_type"],["weighted_conversions","weighted_value"]).then((function(e){return(0,d.normalizeReportView)(e.data.report_view)})).then((function(e){var t=l.default.uniq(e.map((function(e){return e.campaign_id})));return n.setState({detailled:{isLoading:!1,data:{dataSource:e,viewType:"CAMPAIGN"},uniq:t}})}))},n.renderDatePicker=function(){var e=n.props.history.location.search,t=(0,u.parseSearch)(e,u.DATE_SEARCH_SETTINGS),a={from:t.from,to:t.to};return r.createElement("div",{style:{marginBottom:5}},r.createElement(g.McsDateRangePicker,{values:a,onChange:function(e){return n.updateLocationSearch({from:e.from,to:e.to})}}))},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,u.updateSearch)(o,e,u.DATE_SEARCH_SETTINGS)};a.push(i)},n.state={overall:{isLoading:!0,items:[]},detailled:{isLoading:!0,data:{dataSource:[],viewType:"SOURCE"},uniq:[]}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params,n=t.organisationId,a=t.goalId,r=e.attributionModelId,o=e.history,i=e.location,s=i.pathname,l=i.search;if((0,u.isSearchValid)(l,u.DATE_SEARCH_SETTINGS)){var c=(0,u.parseSearch)(l,u.DATE_SEARCH_SETTINGS);this.fetchOverall(n,a,r,c),this.fetchDetailled(n,a,r,c,b[0])}else o.replace({pathname:s,search:(0,u.buildDefaultSearch)(l,u.DATE_SEARCH_SETTINGS),state:{reloadDataSource:!0}})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.match.params,a=n.organisationId,r=n.goalId,o=t.history,i=t.location,s=i.pathname,l=i.search,c=t.attributionModelId,d=e.match.params,f=d.organisationId,p=d.goalId,m=e.location.search,g=e.attributionModelId;if(!(0,u.compareSearches)(l,m)||a!==f||r!==p||c!==g)if((0,u.isSearchValid)(l,u.DATE_SEARCH_SETTINGS)){var y=(0,u.parseSearch)(l,u.DATE_SEARCH_SETTINGS);this.fetchOverall(a,r,c,y),this.fetchDetailled(a,r,c,y,this.state.detailled.data.viewType)}else o.replace({pathname:s,search:(0,u.buildDefaultSearch)(l,u.DATE_SEARCH_SETTINGS),state:{reloadDataSource:a!==f}})}},{key:"render",value:function(){var e=this,t=this.props.intl.formatMessage,n=this.state.overall.items.reduce((function(e,t){return"POST_VIEW"===t.interaction_type?e+parseInt(t.interaction_to_conversion_duration,10):e}),0),a=this.state.overall.items.reduce((function(e,t){return"POST_CLICK"===t.interaction_type?e+parseInt(t.interaction_to_conversion_duration,10):e}),0),o=Math.max(n,a),i=[{name:t(m.default.weightedConversions),value:!this.state.overall.isLoading&&this.state.overall.items.length?(0,d.formatMetric)(this.state.overall.items.reduce((function(e,t){return e+parseInt(t.weighted_conversions,10)}),0),"0,0"):"--"},{name:t(m.default.postView),value:!this.state.overall.isLoading&&this.state.overall.items.length?t(m.default.pCpVFormatDuration,{value:(0,d.formatMetric)(this.state.overall.items.reduce((function(e,t){return"POST_VIEW"===t.interaction_type?e+parseInt(t.weighted_conversions,10):e}),0),"0,0"),duration:n&&!isNaN(n)?(0,y.formatSecondsIntoDhmsFormat)(n):"--"}):"--"},{name:t(m.default.postClick),value:!this.state.overall.isLoading&&this.state.overall.items.length?t(m.default.pCpVFormatDuration,{value:(0,d.formatMetric)(this.state.overall.items.reduce((function(e,t){return"POST_CLICK"===t.interaction_type?e+parseInt(t.weighted_conversions,10):e}),0),"0,0"),duration:a&&!isNaN(a)?(0,y.formatSecondsIntoDhmsFormat)(a):"--"}):"--"},{name:t(m.default.interactionToConversionDuration),value:!this.state.overall.isLoading&&this.state.overall.items.length&&o&&!isNaN(o)?(0,y.formatSecondsIntoDhmsFormat)(o):"--"}];return r.createElement("div",null,r.createElement(p.Row,{className:"m-t-10 m-b-10"},r.createElement(g.MetricsHighlight,{metrics:i,isLoading:this.state.overall.isLoading})),r.createElement(p.Row,null,r.createElement("div",{style:{display:"inline-block",float:"right",width:"100%",marginBottom:"10px",marginTop:"10px"}},r.createElement("div",{className:"float-right"},this.renderDatePicker()),r.createElement("div",{className:"float-right m-r-5"},r.createElement(p.Select,{defaultValue:"SOURCE",style:{width:120},onChange:function(t){return e.fetchDetailled(e.props.match.params.organisationId,e.props.match.params.goalId,e.props.attributionModelId,(0,u.parseSearch)(e.props.location.search,u.DATE_SEARCH_SETTINGS),t)}},b.map((function(e){return r.createElement(v,{value:e,key:e},t(m.default[e]))})))))),r.createElement(p.Row,null,r.createElement(f.default,{dataSource:this.state.detailled.data,uniq:this.state.detailled.uniq,isLoading:this.state.detailled.isLoading})))}}]),t}(r.Component);t.default=(0,s.compose)(i.withRouter,o.injectIntl)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(6),l=n(8),c=n(68),u=g(n(336)),d=n(33),f=g(n(620)),p=n(15),m=n(12);function g(e){return e&&e.__esModule?e:{default:e}}function y(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=function(e){function t(){h(this,t);var e=v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildNameColumn=function(){var t=e.props,n=t.dataSource,a=t.match.params.organisationId,r=[];return"SOURCE"===n.viewType?r=[{intlMessage:u.default.marketingChannel,key:"marketingChannel",render:function(e,t,n){return t.id}},{intlMessage:u.default.source,key:"source",render:function(e,t,a){var r=n.dataSource.find((function(e){return e.marketing_channel===t.id}));return r&&r.source}}]:"CAMPAIGN"===n.viewType?r=[{intlMessage:u.default.campaignName,key:"marketingChannel",render:function(t,r,i){var s=n.dataSource.find((function(e){return e.campaign_id===r.id})),l=s&&s.campaign_name,c="/v2/o/"+a+"/campaigns/display/"+r.id;return o.createElement(d.Link,{to:c},l||o.createElement(f.default,{fetchingMethod:e._displayCampaignService.getCampaignDisplay,id:r.id,renderMethod:function(e){return o.createElement("span",null,e.name)}}))}}]:"CREATIVES"===n.viewType&&(r=[{intlMessage:u.default.creativeName,key:"marketingChannel",render:function(t,r,i){var s=n.dataSource.find((function(e){return e.creative_id===r.id})),l=s&&s.creative_name,c="/v2/o/"+a+"/creatives/display/edit/"+r.id;return o.createElement(d.Link,{to:c},l||o.createElement(f.default,{fetchingMethod:e._creativeService.getCreative,id:r.id,renderMethod:function(e){return o.createElement("span",null,e.name)}}))}}]),r},e.returnListOfItemFromId=function(t,n){var a=e.props.dataSource;switch(a.viewType){case"SOURCE":return(a.dataSource.filter((function(e){return e.marketing_channel===t}))||[]).reduce((function(e,t){switch(n){case"weightedConversions":return e+parseInt(t.weighted_conversions,10);case"weightedValue":return e+parseInt(t.weighted_value,10);case"postViewWeightedConversions":return"POST_VIEW"===t.interaction_type?e+t.weighted_conversions:e;case"postClickWeightedConversions":return"POST_CLICK"===t.interaction_type?e+t.weighted_conversions:e;default:return 0}}),0);case"CAMPAIGN":return(a.dataSource.filter((function(e){return e.campaign_id===t}))||[]).reduce((function(e,t){switch(n){case"weightedConversions":return e+parseInt(t.weighted_conversions,10);case"weightedValue":return e+parseInt(t.weighted_value,10);case"postViewWeightedConversions":return"POST_VIEW"===t.interaction_type?e+t.weighted_conversions:e;case"postClickWeightedConversions":return"POST_CLICK"===t.interaction_type?e+t.weighted_conversions:e;default:return 0}}),0);case"CREATIVES":return(a.dataSource.filter((function(e){return e.creative_id===t}))||[]).reduce((function(e,t){switch(n){case"weightedConversions":return e+parseInt(t.weighted_conversions,10);case"weightedValue":return e+parseInt(t.weighted_value,10);case"postViewWeightedConversions":return"POST_VIEW"===t.interaction_type?e+t.weighted_conversions:e;case"postClickWeightedConversions":return"POST_CLICK"===t.interaction_type?e+t.weighted_conversions:e;default:return 0}}),0)}},e.buildDataColumn=function(){return[{intlMessage:u.default.weightedConversions,key:"weightedConversions",render:function(t,n,a){return e.returnListOfItemFromId(n.id,"weightedConversions")}},{intlMessage:u.default.weightedValue,key:"weightedValue",render:function(t,n,a){return e.returnListOfItemFromId(n.id,"weightedValue")}},{intlMessage:u.default.postViewWeightedConversions,key:"postViewWeightedConversions",render:function(t,n,a){return e.returnListOfItemFromId(n.id,"postViewWeightedConversions")}},{intlMessage:u.default.postClickWeightedConversions,key:"postClickWeightedConversions",render:function(t,n,a){return e.returnListOfItemFromId(n.id,"postClickWeightedConversions")}}]},e.buildColumnDefinition=function(){return{dataColumnsDefinition:[].concat(y(e.buildNameColumn()),y(e.buildDataColumn()))}},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.uniq.map((function(e){return{id:e}}));return o.createElement(c.TableView,{loading:this.props.isLoading,columns:this.buildColumnDefinition().dataColumnsDefinition,dataSource:e})}}]),t}(o.Component);b([(0,p.lazyInject)(m.TYPES.ICreativeService)],_.prototype,"_creativeService",void 0),b([(0,p.lazyInject)(m.TYPES.IDisplayCampaignService)],_.prototype,"_displayCampaignService",void 0),t.default=(0,l.compose)(i.withRouter,s.injectIntl)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatSecondsIntoDhmsFormat=function(e){var t=Math.floor(e/86400),n=Math.floor(e%86400/3600),a=Math.floor(e%3600/60),r=Math.floor(e%60);return t+"d "+n+"h "+a+"m "+r+"s"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=S(n(0)),i=n(8),s=n(25),l=_(n(139)),c=n(13),u=n(10),d=n(6),f=S(n(124)),p=S(n(204)),m=n(300),g=_(n(23)),y=n(51),h=n(15),v=n(12),b=_(n(1097));function _(e){return e&&e.__esModule?e:{default:e}}function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchDatamart=function(e){return n.setState({loading:!0}),n._datamartService.getDatamart(e).then((function(e){return n.setState({datamart:e.data,loading:!1})})).catch((function(e){n.props.notifyError(e),n.setState({loading:!1})}))},n.loadData=function(e){return n.setState({loading:!0}),n._scenarioService.getScenario(e).then((function(e){return n._datamartService.getDatamart(e.data.datamart_id)})).then((function(t){var a=t.data;return n._automationFormService.loadInitialAutomationValues(e).then((function(e){n.setState({datamart:a,automationFormData:e,loading:!1})}))})).catch((function(e){n.props.notifyError(e),n.setState({loading:!1})}))},n.save=function(e){var t=n.props.match.params,a=t.organisationId,r=t.automationId,o=n.state,i=o.datamart,s=o.automationFormData;i&&(n.setState({loading:!0}),n._automationFormService.validateAutomation(e.automationTreeData).then((function(){n._automationFormService.saveOrCreateAutomation(a,e,s).then((function(){n.setState({loading:!1}),n.props.history.push("/v2/o/"+n.props.match.params.organisationId+"/automations/"+r)})).catch((function(e){n.setState({loading:!1}),n.props.notifyError(e.data)}))})).catch((function(t){n.setState({loading:!1,automationFormData:e}),u.message.error(n.props.intl.formatMessage(t))})))},n.onClose=function(){var e=n.props,t=e.history,a=e.match.params.organisationId,r=e.location.state;t.push(r&&r.from?r.from:"/v2/o/"+a+"/automations")},n.state={loading:!0,automationFormData:m.INITIAL_AUTOMATION_DATA},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.automationId,n=e.location.search,a=l.default.parse(n).datamartId;t&&this.loadData(t),!t&&a&&this.fetchDatamart(a)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.match.params.automationId,a=t.location.search,r=e.match.params.automationId,o=e.location.search;n&&n!==r&&this.loadData(n);var i=l.default.parse(a).datamartId,s=l.default.parse(o).datamartId;n||n===r||i===s||this.fetchDatamart(i)}},{key:"render",value:function(){var e=this.props.match.params.automationId,t=this.state,n=t.loading,a=t.datamart;return n?o.createElement(y.Loading,{isFullScreen:!0}):e&&!n&&a?o.createElement(b.default,{datamartId:a.id,automationFormData:this.state.automationFormData,saveOrUpdate:this.save,loading:this.state.loading,edition:!0,creation_mode:"QUERY_INPUT"===this.state.automationFormData.automationTreeData.node.type?this.state.automationFormData.automationTreeData.node.ui_creation_mode:"QUERY"}):o.createElement(d.FormattedMessage,w.dontExist)}}]),t}(o.Component);E([(0,h.lazyInject)(v.TYPES.IAutomationFormService)],O.prototype,"_automationFormService",void 0),E([(0,h.lazyInject)(v.TYPES.IScenarioService)],O.prototype,"_scenarioService",void 0),E([(0,h.lazyInject)(v.TYPES.IDatamartService)],O.prototype,"_datamartService",void 0),t.default=(0,i.compose)(c.withRouter,d.injectIntl,g.default,(0,s.connect)((function(e){return{hasFeature:p.hasFeature(e)}}),{notifyError:f.notifyError}))(O);var w=(0,d.defineMessages)({dontExist:{id:"automation.edit.dontexist",defaultMessage:"The automation you are trying to load doesn't seem to exist or you don't have the right to view it"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(89),i=l(n(2266)),s=l(n(1100));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,n,a,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"automation-node"));return o.nodeOperations=e,o.lockGlobalInteraction=n,o.viewer=r,o.datamartId=a,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"generateReactWidget",value:function(e,t){return t.extras.collapsed?r.createElement("div",null):r.createElement(i.default,{node:t,diagramEngine:e,nodeOperations:this.nodeOperations,datamartId:this.datamartId,lockGlobalInteraction:this.lockGlobalInteraction,viewer:this.viewer})}},{key:"getNewInstance",value:function(e){return new s.default}}]),t}(o.AbstractNodeFactory);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=w(n(47)),s=n(89),l=n(51),c=n(127),u=n(6),d=n(61),f=n(8),p=n(221),m=n(10),g=n(113),y=w(n(2267)),h=w(n(2268)),v=n(13),b=n(15),_=n(12),S=n(160),E=n(11),O=w(n(2269));function w(e){return e&&e.__esModule?e:{default:e}}var M=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},P=(0,u.defineMessages)({edit:{id:"automation.builder.node.edit",defaultMessage:"Edit"},view:{id:"automation.builder.node.view",defaultMessage:"View Node Config."},stats:{id:"automation.builder.node.stats",defaultMessage:"View Stats."},remove:{id:"automation.builder.node.remove",defaultMessage:"Remove"},settings:{id:"automation.builder.node.settings",defaultMessage:"Settings"},goToSegment:{id:"automation.builder.node.goToSegment",defaultMessage:"Go to Segment"}}),T=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.top=0,n.left=0,n.id=(0,i.default)(),n.findSegmentNameFromAddToSegmentNode=function(e,t){var n=t.find((function(t){return(0,g.isAddToSegmentNode)(t.node)&&e===t.node.formData.audienceSegmentId}));return n&&(0,g.isAddToSegmentNode)(n.node)&&n.node.formData.audienceSegmentName||""},n.setPosition=function(e){var t=document.body.getBoundingClientRect(),a=e?e.getBoundingClientRect():null;n.top=a?a.top+t.top:0,n.left=a?a.left+t.left:0},n.removeNode=function(){n.setState({focus:!1},(function(){n.props.nodeOperations.deleteNode(n.props.node.storylineNodeModel.node.id)}))},n.viewStats=function(){var e=n.props,t=e.node,a=e.openNextDrawer,r=e.closeNextDrawer,o=t.storylineNodeModel.node;if((0,g.isDisplayCampaignNode)(o)){var i=o.formData;a(y.default,{additionalProps:{campaignId:i.campaign.id,close:r},size:"large"})}else(0,g.isEmailCampaignNode)(o)?a(h.default,{additionalProps:{campaignId:o.campaign_id,close:r},size:"large"}):(0,g.isFeedNode)(o)&&o.feed_id&&a(O.default,{additionalProps:{feedId:o.feed_id,close:r},size:"medium"})},n.editNode=function(){var e=n.props,t=e.node,a=e.openNextDrawer,r=e.closeNextDrawer,o=e.nodeOperations,i=e.viewer,s=e.datamartId,l=e.diagramEngine,c=e.intl.formatMessage;n.setState({focus:!1},(function(){if((0,g.isScenarioNodeShape)(t.storylineNodeModel.node)){var e=t.storylineNodeModel.node,n={},u="small";switch(e.type){case"ABN_NODE":case"DISPLAY_CAMPAIGN":case"EMAIL_CAMPAIGN":case"WAIT_NODE":n=Object.assign({},e.formData);break;case"QUERY_INPUT":case"IF_NODE":n=Object.assign(Object.assign({},e.formData),{datamart_id:e.formData.datamart_id?e.formData.datamart_id:s,events:[],fieldNodeForm:[]}),u="QUERY_INPUT"===e.type&&("REACT_TO_EVENT_STANDARD"===e.ui_creation_mode||"REACT_TO_EVENT_ADVANCED"===e.ui_creation_mode)?"small":"large";break;case"ON_SEGMENT_ENTRY_INPUT_NODE":case"ON_SEGMENT_EXIT_INPUT_NODE":n=Object.assign(Object.assign({},e.formData),{datamartId:e.formData.datamartId?e.formData.datamartId:s});break;case"CUSTOM_ACTION_NODE":case"SCENARIO_AUDIENCE_SEGMENT_FEED_NODE":case"DELETE_FROM_SEGMENT_NODE":case"ADD_TO_SEGMENT_NODE":n=Object.assign({},e.formData)}var d=!1;switch(e.type){case"ADD_TO_SEGMENT_NODE":case"DELETE_FROM_SEGMENT_NODE":d=!!e.user_list_segment_id;break;case"ON_SEGMENT_ENTRY_INPUT_NODE":case"ON_SEGMENT_EXIT_INPUT_NODE":d=!!e.audience_segment_id}var f=Object.values(l.diagramModel.nodes).filter((function(e){return"automation-node"===e.type})).map((function(e){return e.storylineNodeModel}));a(t.editFormComponent,{additionalProps:{storylineNodeModel:t.storylineNodeModel,scenarioNodes:f,close:function(){r()},breadCrumbPaths:[{name:(0,p.generateNodeProperties)(t.storylineNodeModel.node,c).title}],disabled:i||d,onSubmit:function(t){o.updateNode(e,t,n),r()},initialValues:n},size:u,isModal:!0})}}))},n.getQuery=function(){var e=n.props.node.storylineNodeModel.node;if((0,g.isQueryInputNode)(e)&&e.formData.query_text)return JSON.parse(e.formData.query_text)},n.renderAbnEdit=function(){var e=n.props,t=e.viewer,a=e.node,r=[];return t||(r.push(o.createElement("div",{key:"edit",onClick:n.editNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.edit))),a.isFirstNode||r.push(o.createElement("div",{key:"remove",onClick:n.removeNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.remove)))),r},n.renderAddToSegmentOrDeleteFromSegmentEdit=function(){var e=n.props,t=e.viewer,a=e.node,r=e.history,i=e.match.params.organisationId,s=[];if(t){s.push(o.createElement("div",{key:"stats",onClick:function(){((0,g.isAddToSegmentNode)(a.storylineNodeModel.node)||(0,g.isDeleteFromSegmentNode)(a.storylineNodeModel.node))&&r.push("/v2/o/"+i+"/audience/segments/"+a.storylineNodeModel.node.user_list_segment_id)},className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.goToSegment))),s.push(o.createElement("div",{key:"view",onClick:n.editNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.view)))}else s.push(o.createElement("div",{key:"edit",onClick:n.editNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.edit))),a.isFirstNode||s.push(o.createElement("div",{key:"remove",onClick:n.removeNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.remove)));return s},n.renderOnSegmentInputEdit=function(){var e=n.props,t=e.viewer,a=e.node,r=e.history,i=e.match.params.organisationId,s=[];if(t){s.push(o.createElement("div",{key:"stats",onClick:function(){((0,g.isOnSegmentEntryInputNode)(a.storylineNodeModel.node)||(0,g.isOnSegmentExitInputNode)(a.storylineNodeModel.node))&&r.push("/v2/o/"+i+"/audience/segments/"+a.storylineNodeModel.node.audience_segment_id)},className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.goToSegment))),s.push(o.createElement("div",{key:"view",onClick:n.editNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.view)))}else s.push(o.createElement("div",{key:"edit",onClick:n.editNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.edit)));return s},n.renderDefautEdit=function(){var e=n.props,t=e.viewer,a=e.node,r=[];return t?(r.push(o.createElement("div",{key:"stats",onClick:n.viewStats,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.stats))),r.push(o.createElement("div",{key:"view",onClick:n.editNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.view)))):(r.push(o.createElement("div",{key:"edit",onClick:n.editNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.edit))),a.isFirstNode||r.push(o.createElement("div",{key:"remove",onClick:n.removeNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.remove)))),r},n.renderQueryEdit=function(){var e=n.props,t=e.viewer,a=e.node,r=[];return t?r.push(o.createElement("div",{key:"view",onClick:n.editNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.view))):(r.push(o.createElement("div",{key:"edit",onClick:n.editNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.edit))),r.push(o.createElement("div",{key:"settings",onClick:n.editNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.settings))),a.isFirstNode||r.push(o.createElement("div",{key:"remove",onClick:n.removeNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.remove)))),r},n.renderEndNodeEdit=function(){return[]},n.defaultEditRemoveNode=function(){var e=n.props,t=e.viewer,a=e.node,r=[];return t?r.push(o.createElement("div",{key:"view",onClick:n.editNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.view))):(r.push(o.createElement("div",{key:"edit",onClick:n.editNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.edit))),a.isFirstNode||r.push(o.createElement("div",{key:"remove",onClick:n.removeNode,className:"boolean-menu-item"},o.createElement(u.FormattedMessage,P.remove)))),r},n.renderEditMenu=function(e){switch(e){case"ABN_NODE":return n.renderAbnEdit();case"EMAIL_CAMPAIGN":case"DISPLAY_CAMPAIGN":case"SCENARIO_AUDIENCE_SEGMENT_FEED_NODE":return n.renderDefautEdit();case"ADD_TO_SEGMENT_NODE":case"DELETE_FROM_SEGMENT_NODE":return n.renderAddToSegmentOrDeleteFromSegmentEdit();case"QUERY_INPUT":return n.renderQueryEdit();case"END_NODE":return n.renderEndNodeEdit();case"CUSTOM_ACTION_NODE":case"IF_NODE":case"WAIT_NODE":case"PLUGIN_NODE":return n.defaultEditRemoveNode();case"ON_SEGMENT_ENTRY_INPUT_NODE":case"ON_SEGMENT_EXIT_INPUT_NODE":return n.renderOnSegmentInputEdit();default:return[]}},n.getIcon=function(e){var t=e.getColor(),n=e.getColor(),a=e.iconAnt?e.iconAnt:o.createElement(E.McsIcon,{type:e.icon,className:"available-node-icon-gyph"});return e.iconAssetUrl?o.createElement("div",{className:"node-icon",style:{width:e.getSize().width,height:e.getSize().height,borderColor:n,backgroundColor:t,float:"left"}},o.createElement("img",{className:"available-node-icon-img",src:""+window.MCS_CONSTANTS.ASSETS_URL+e.iconAssetUrl})):o.createElement("div",{className:"node-icon",style:{width:e.getSize().width,height:e.getSize().height,borderWidth:e.getSize().borderWidth,borderColor:n,float:"left",color:"#ffffff",backgroundColor:t}},a)},n.state={focus:!1,hover:!1,nodeName:void 0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.node;(0,g.isScenarioNodeShape)(e.storylineNodeModel.node)&&e.storylineNodeModel.node.last_added_node&&this.editNode(),this.fetchNodeName()}},{key:"fetchNodeName",value:function(){var e=this,t=this.props,n=t.node,a=t.diagramEngine,r=n.storylineNodeModel.node;switch(r.type){case"DELETE_FROM_SEGMENT_NODE":if(r.formData.segmentId)if((0,S.isFakeId)(r.formData.segmentId)){var o=Object.values(a.diagramModel.nodes).filter((function(e){return"automation-node"===e.type})).map((function(e){return e.storylineNodeModel})),i=this.findSegmentNameFromAddToSegmentNode(r.formData.segmentId,o);this.setState({nodeName:i})}else this._audienceSegmentService.getSegment(r.formData.segmentId).then((function(t){var n=t.data;e.setState({nodeName:n.name})})).catch((function(){e.setState({nodeName:void 0})}))}}},{key:"render",value:function(){var e=this,t=this.props.node,n=this.state.nodeName,a=this.getIcon(t),r=function(){e.setPosition(document.getElementById(e.id)),e.setState({focus:!e.state.focus})},i=this.props.diagramEngine.getDiagramModel().zoom/100,u=n||t.title,d=t.storylineNodeModel.node.type,f=this.renderEditMenu(d),p=f.length?r:void 0,g=o.createElement("div",{className:"node-body",style:{width:t.getNodeSize().width+"px",height:t.getNodeSize().height+"px",cursor:p?"pointer":"default"}},a,o.createElement("div",{className:"node-content"},o.createElement(m.Tooltip,{title:u.length>20?u:void 0,placement:"bottom"},u.substring(0,20)+(u.length>20?"...":""))),o.createElement("div",{className:"node-subtitle"},t.subtitle?t.subtitle:""));return o.createElement("div",{id:this.id,key:this.id,onClick:p},g,o.createElement("div",{style:{position:"absolute",top:t.getNodeSize().height/2,left:t.getNodeSize().width/2}},o.createElement(s.PortWidget,{name:"center",node:this.props.node})),o.createElement("div",{style:{position:"absolute",top:t.getNodeSize().height/2,left:t.getNodeSize().width+20}},o.createElement(s.PortWidget,{name:"right",node:this.props.node})),(t.y!==c.ROOT_NODE_POSITION.y||t.x!==c.ROOT_NODE_POSITION.x)&&o.createElement("div",{style:{position:"absolute",top:t.getNodeSize().height/2-6,left:-10}},o.createElement(E.McsIcon,{type:"chevron-right",className:"arrow"})),this.state.focus&&o.createElement(l.WindowBodyPortal,null,o.createElement("div",{className:"automation-builder focus"},o.createElement("div",{onClick:r,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"black",zIndex:1e3,opacity:.6}}),o.createElement("span",{className:"object-node no-hover",style:{width:t.getNodeSize().width,height:t.getNodeSize().height,borderRadius:4,fontWeight:"bold",color:"#ffffff",borderColor:t.getColor(),top:this.top-t.getNodeSize().height*((1-i)/2),left:this.left-t.getNodeSize().width*((1-i)/2),position:"absolute",zIndex:1002,transform:"scale("+i+")"},onClick:r},g),o.createElement("div",{className:"boolean-menu",style:{top:this.top,left:this.left+t.getNodeSize().width*i,zIndex:1001}},f))))}}]),t}(o.Component);M([(0,b.lazyInject)(_.TYPES.IAudienceSegmentService)],T.prototype,"_audienceSegmentService",void 0),t.default=(0,f.compose)(v.withRouter,u.injectIntl,d.injectDrawer)(T)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(33),s=n(8),l=n(10),c=n(181),u=P(n(78)),d=n(83),f=n(56),p=n(44),m=P(n(59)),g=n(30),y=P(n(23)),h=n(803),v=P(n(338)),b=P(n(802)),_=n(6),S=P(n(1018)),E=P(n(114)),O=n(11),w=n(15),M=n(12);function P(e){return e&&e.__esModule?e:{default:e}}var T=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},I=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},A=l.Layout.Content,C=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.cancelablePromises=[],n.fetchAllData=function(e,t,a){var r=a.to.toMoment().unix()-a.from.toMoment().unix()>172800?["day"]:["day,hour_of_day"],o=(0,p.makeCancelable)(u.default.getSingleDisplayDeliveryReport(e,t,a.from,a.to,r)),i=(0,p.makeCancelable)(u.default.getSingleDisplayDeliveryReport(e,t,a.from,a.to,void 0,["cpa","cpm","ctr","cpc","impressions_cost"])),s=(0,p.makeCancelable)(u.default.getAdGroupDeliveryReport(e,"campaign_id",t,a.from,a.to,void 0)),l=(0,p.makeCancelable)(u.default.getAdDeliveryReport(e,"campaign_id",t,a.from,a.to,void 0)),c=(0,p.makeCancelable)(u.default.getMediaDeliveryReport(e,"campaign_id",t,a.from,a.to,void 0,void 0,{sort:"-clicks",limit:30}));n.cancelablePromises.push(o,c,l,s,i,i),n.setState((function(e){var t=Object.assign({},e);return t.campaign.data.isLoading=!0,t.adGroups.data.isLoading=!0,t.ads.data.isLoading=!0,t.campaign.performance.isLoading=!0,t.campaign.mediaPerformance.isLoading=!0,t.campaign.overallPerformance.isLoading=!0,t.adGroups.performance.isLoading=!0,t.ads.performance.isLoading=!0,t.goals.isLoading=!0,t})),n._displayCampaignService.getCampaignDisplayViewDeep(t,{view:"deep"}).then((function(e){var t=e.data,a=t.ad_groups,r=I(t,["ad_groups"]),o=a.map((function(e){e.ads;return I(e,["ads"])})),i=a.map((function(e){return{ad_group_id:e.id,campaign_id:r.id}})),s=[],l=[];t.ad_groups.forEach((function(e){e.ads.forEach((function(t){s.push(t),l.push({ad_id:t.id,ad_group_id:e.id,campaign_id:r.id})}))})),n.setState((function(e){var t=Object.assign({},e);return t.campaign.data.isLoading=!1,t.adGroups.data.isLoading=!1,t.ads.data.isLoading=!1,t.campaign.data.items=[r],t.adGroups.data.items=(0,d.normalizeArrayOfObject)(o,"id"),t.adGroups.data.adGroupCampaign=(0,d.normalizeArrayOfObject)(i,"ad_group_id"),t.ads.data.items=(0,d.normalizeArrayOfObject)(s,"id"),t.ads.data.adAdGroup=(0,d.normalizeArrayOfObject)(l,"ad_id"),t}))})),n._displayCampaignService.getGoals(t).then((function(e){return e.data})).then((function(e){var t=e.map((function(e){return n._goalService.getAttributionModels(e.goal_id).then((function(t){return Object.assign(Object.assign({},e),{attribution:t.data})}))}));return Promise.all(t)})).then((function(e){n.setState({goals:{items:e,isLoading:!1,isArchiving:!1,isUpdating:!1}})})),o.promise.then((function(e){n.updateStateOnPerf("campaign","performance","performance",(0,f.normalizeReportView)(e.data.report_view))})).catch((function(e){return n.catchCancellablePromises(e,"campaign","performance")})),s.promise.then((function(e){n.updateStateOnPerf("adGroups","performance","performanceById",n.formatReportView(e.data.report_view,"sub_campaign_id"))})).catch((function(e){return n.catchCancellablePromises(e,"adGroups","performance")})),l.promise.then((function(e){n.updateStateOnPerf("ads","performance","performanceById",n.formatReportView(e.data.report_view,"message_id"))})).catch((function(e){return n.catchCancellablePromises(e,"ads","performance")})),c.promise.then((function(e){var t=Object.assign({},e.data.report_view);t.rows=e.data.report_view.rows.splice(0,30),n.updateStateOnPerf("campaign","mediaPerformance","performance",(0,f.normalizeReportView)(t))})).catch((function(e){return n.catchCancellablePromises(e,"campaign","mediaPerformance")})),i.promise.then((function(e){n.updateStateOnPerf("campaign","overallPerformance","performance",(0,f.normalizeReportView)(e.data.report_view))})).catch((function(e){return n.catchCancellablePromises(e,"campaign","overallPerformance")}))},n.catchCancellablePromises=function(e,t,a){e.isCanceled||(m.default.error(e),n.setState((function(e){var n=Object.assign({},e);return n[t][a].isLoading=!1,n[t][a].hasFetched=!0,n[t][a].error=!0,n})))},n.updateAd=function(e,t,a,r,i){var s=n.props,c=s.notifySuccess,u=s.notifyError,d=s.removeNotification,f=n.state.ads.data.adAdGroup&&n.state.ads.data.adAdGroup[e],p=f?f.campaign_id:void 0,m=f?f.ad_group_id:void 0;return p&&m?n._displayCampaignService.updateAd(e,p,m,t).then((function(t){if(n.setState((function(n){var a=Object.assign({},n);return a.ads.data.items[e].status=t.data.status,a})),(r||i)&&a){var s=Math.random().toString();r&&c({uid:s,message:r.title,description:r.body,btn:o.createElement(l.Button,{type:"primary",size:"small",onClick:function(){n.updateAd(e,a).then((function(){d(s)}))}},o.createElement("span",null,"Undo"))})}return null})).catch((function(e){var t=i?{message:i.title,description:i.body}:void 0;throw u(e,t),e})):Promise.resolve()},n.state=h.initialPageState,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"formatReportView",value:function(e,t){var n=(0,f.normalizeReportView)(e);return(0,d.normalizeArrayOfObject)(n,t)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.history,n=e.location,a=n.search,r=n.pathname,o=e.match.params.organisationId,i=e.campaignId;if((0,g.isSearchValid)(a,c.DISPLAY_DASHBOARD_SEARCH_SETTINGS)){var s=(0,g.parseSearch)(a,c.DISPLAY_DASHBOARD_SEARCH_SETTINGS);this.fetchAllData(o,i,s)}else t.replace({pathname:r,search:(0,g.buildDefaultSearch)(a,c.DISPLAY_DASHBOARD_SEARCH_SETTINGS)})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.location,a=n.pathname,r=n.search,o=t.match.params.organisationId,i=t.campaignId,s=t.history,l=e.location.search,u=e.campaignId;if(!(0,g.compareSearches)(r,l)||i!==u)if((0,g.isSearchValid)(r,c.DISPLAY_DASHBOARD_SEARCH_SETTINGS)){var d=(0,g.parseSearch)(r,c.DISPLAY_DASHBOARD_SEARCH_SETTINGS);this.fetchAllData(o,i,d)}else s.replace({pathname:a,search:(0,g.buildDefaultSearch)(r,c.DISPLAY_DASHBOARD_SEARCH_SETTINGS)})}},{key:"componentWillUnmount",value:function(){this.cancelablePromises.forEach((function(e){return e.cancel()}))}},{key:"updateStateOnPerf",value:function(e,t,n,a){this.setState((function(r){var o=Object.assign({},r);return o[e][t].isLoading=!1,o[e][t].hasFetched=!0,o[e][t][n]=a,o}))}},{key:"formatListView",value:function(e,t){return e?Object.keys(e).map((function(n){return Object.assign(Object.assign({},t[n]),e[n])})):[]}},{key:"render",value:function(){var e=this.props.intl.formatMessage,t=this.state,n=t.campaign,a=t.ads,r=t.goals,i={media:{items:n.mediaPerformance.items,isLoading:n.mediaPerformance.isLoading,isUpdating:!1,isArchiving:!1},overall:{items:n.overallPerformance.items,isLoading:n.overallPerformance.isLoading,isUpdating:!1,isArchiving:!1},campaign:{items:n.performance.items,isLoading:n.performance.isLoading,isUpdating:!1,isArchiving:!1}};return o.createElement("div",{className:"ant-layout"},o.createElement(O.Actionbar,{paths:[{name:n&&n.data&&n.data.items&&n.data.items[0]?n.data.items[0].name:""}],edition:!0},o.createElement(O.McsIcon,{type:"close",className:"close-icon",style:{cursor:"pointer"},onClick:this.props.close})),o.createElement("div",{className:"ant-layout"},o.createElement(A,{className:"mcs-content-container"},o.createElement(v.default,{campaign:n.data.items[0]}),n&&n.data&&n.data.items&&n.data.items[0]&&"V2014_06"===n.data.items[0].model_version?o.createElement(l.Alert,{className:"m-b-20",message:e(E.default.editionNotAllowed),type:"warning"}):null,o.createElement(S.default,{isFetchingCampaignStat:i.campaign.isLoading,campaignStat:i.campaign.items,mediaStat:i.media.items,isFetchingMediaStat:i.media.isLoading,isFetchingOverallStat:i.overall.isLoading,overallStat:i.overall.items,goals:r.items}),o.createElement(b.default,{title:e(E.default.creatives),isFetching:a.data.isLoading,isFetchingStat:a.performance.isLoading,dataSet:this.formatListView(a.data,a.performance),updateAd:this.updateAd}))))}}]),t}(o.Component);T([(0,w.lazyInject)(M.TYPES.IDisplayCampaignService)],C.prototype,"_displayCampaignService",void 0),T([(0,w.lazyInject)(M.TYPES.IGoalService)],C.prototype,"_goalService",void 0),t.default=(0,s.compose)(i.withRouter,y.default,_.injectIntl)(C)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(8),l=n(13),c=n(10),u=S(n(338)),d=n(11),f=S(n(23)),p=S(n(1092)),m=n(831),g=S(n(78)),y=S(n(59)),h=n(56),v=n(15),b=n(12),_=S(n(81));function S(e){return e&&e.__esModule?e:{default:e}}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=c.Layout.Content,w=(0,i.defineMessages)({overview:{id:"email.automatedCampaigns.dashboard.tabs.overview",defaultMessage:"Overview"},devileryAnalysis:{id:"email.automatedCampaigns.dashboard.tabs.deliveryAnalysis",defaultMessage:"Delivery Analysis"},statusUpdateSuccess:{id:"email.automatedCampaigns.dashboard.status-update-successfull",defaultMessage:"Campaign status successfully updated"},statusUpdateFailure:{id:"email.automatedCampaigns.dashboard.status-update-failure",defaultMessage:"There was an error updating your campaign... Please try again..."},notifSuccess:{id:"email.automatedCampaigns.dashboard.notification-success",defaultMessage:"Success"},notifError:{id:"email.automatedCampaigns.dashboard.notification-error",defaultMessage:"Error"}}),M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.loadCampaign=function(e){n.state.campaign&&n.state.campaign.id===e||(n.setState({isLoadingCampaign:!0}),n._emailCampaignService.getEmailCampaign(e).then((function(e){n.setState({isLoadingCampaign:!1,campaign:e.data})})).catch((function(e){y.default.error(e),n.setState({isLoadingCampaign:!1}),n.props.notifyError(e)})))},n.refreshStats=function(e,t){n.setState({isLoadingCampaignStatReport:!0}),g.default.getSingleEmailDeliveryReport(e,t,n.state.dateRange.from,n.state.dateRange.to,["day"]).then((function(e){n.setState({isLoadingCampaignStatReport:!1,campaignStatReport:(0,h.normalizeReportView)(e.data.report_view)})})).catch((function(e){y.default.error(e),n.setState({isLoadingCampaignStatReport:!1}),n.props.notifyError(e)}))},n.state={isLoadingCampaign:!0,isLoadingCampaignStatReport:!0,campaignStatReport:[],dateRange:{from:new _.default("now-7d"),to:new _.default("now")}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.campaignId;this.loadCampaign(n),this.refreshStats(t,n)}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,a=n.match.params.organisationId,r=n.campaignId,o=e.campaignId,i=this.state.dateRange,s=t.dateRange;i.from.value===s.from.value&&i.to.value===s.to.value&&r===o||(this.loadCampaign(r),this.refreshStats(a,r))}},{key:"render",value:function(){var e=this,t=this.props.intl,n=this.state,a=n.campaign,r=n.isLoadingCampaignStatReport,i=n.campaignStatReport,s=n.isLoadingCampaign;return o.createElement("div",{className:"ant-layout"},o.createElement(d.Actionbar,{paths:[{name:a?a.name:""}],edition:!0},o.createElement(d.McsIcon,{type:"close",className:"close-icon",style:{cursor:"pointer"},onClick:this.props.close})),o.createElement("div",{className:"ant-layout"},o.createElement(O,{className:"mcs-content-container"},o.createElement(u.default,{campaign:a}),o.createElement(d.Card,{title:t.formatMessage(w.overview)},o.createElement(p.default,{campaign:a,isLoading:s})),o.createElement(d.Card,{title:t.formatMessage(w.devileryAnalysis)},o.createElement(m.EmailStackedAreaChart,{dateRangeValue:Object.assign({},this.state.dateRange),onDateRangeChange:function(t){return e.setState({dateRange:t})},isLoading:r,emailReport:i})))))}}]),t}(o.Component);E([(0,v.lazyInject)(b.TYPES.IEmailCampaignService)],M.prototype,"_emailCampaignService",void 0),t.default=(0,s.compose)(l.withRouter,i.injectIntl,f.default)(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=d(n(0)),o=n(13),i=d(n(23)),s=n(6),l=n(8),c=n(11),u=d(n(1099));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.match.params.organisationId,a=e.feedId;return r.default.createElement("div",{className:"mcs-feedNodeAutomationDashboardStats ant-layout"},r.default.createElement(c.Actionbar,{paths:[{name:t(g.actionbarName)}],edition:!0},r.default.createElement(c.McsIcon,{type:"close",className:"close-icon",style:{cursor:"pointer"},onClick:this.props.close})),r.default.createElement("div",{className:"mcs-feedNodeAutomationDashboardStats_content ant-layout ant-layout-content mcs-content-container"},r.default.createElement(c.Card,null,r.default.createElement(u.default,{organisationId:n,feedId:a,feedStatsUnit:"USER_POINTS"}))))}}]),t}(r.default.Component),g=(0,s.defineMessages)({actionbarName:{id:"automation.feedNode.dashboard.stats.actionbar.name",defaultMessage:"Feed stats"}});t.default=(0,l.compose)(o.withRouter,s.injectIntl,i.default)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(25),s=n(35),l=n(10),c=n(77),u=E(n(60)),d=n(8),f=n(6),p=n(13),m=n(113),g=E(n(2271)),y=n(804),h=E(n(95)),v=E(n(1025)),b=E(n(1022)),_=n(1026),S=n(2272);function E(e){return e&&e.__esModule?e:{default:e}}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var M=l.Layout.Content,P=(0,f.defineMessages)({save:{id:"automation.builder.node.displayCampaignForm.save.button",defaultMessage:"Update"},sectionGeneralTitle:{id:"automation.builder.node.displayCampaignForm.general.title",defaultMessage:"General Information"},sectionDisplayCampaignTitle:{id:"automation.builder.node.displayCampaignForm.display.title",defaultMessage:"Modify the parameters of the display campaign"}}),T=function(e){function t(){O(this,t);var e=w(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFormSections=function(){var t=e.props,n=t.change,r=t.disabled,i={formChange:n,rerenderOnEveryChange:!0,disabled:r},s=[],l={id:"displayCampaign",title:P.sectionGeneralTitle,component:o.createElement(g.default,{initialValues:e.props.initialValues,disabled:r})},c={id:"goals",title:h.default.sectionTitle2,component:o.createElement(_.GoalFieldArray,a({name:"goalFields",component:S.GoalFormSection,small:!0},i))},u={id:"device",title:h.default.sectionTitleDevice,component:o.createElement(v.default,{name:"adGroupFields[0].model.adGroup",formChange:e.props.change,small:!0,disabled:!!r,initialValues:e.props.initialValues.adGroupFields&&e.props.initialValues.adGroupFields[0].model.adGroup})},d={id:"display",title:h.default.sectionTitleAds,component:o.createElement(y.AdFieldArray,a({name:"adGroupFields[0].model.adFields",component:b.default,small:!0},i))};return s.push(l),s.push(c),s.push(u),s.push(d),s},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.close,r=e.disabled,i={formId:m.FORM_ID,paths:t,message:P.save,onClose:a,disabled:r},s=this.buildFormSections(),d=s.map((function(e,t){return o.createElement("div",{key:e.id},o.createElement("div",{key:e.id,id:e.id},e.component),t!==s.length-1&&o.createElement("hr",null))}));return o.createElement(l.Layout,{className:"edit-layout"},o.createElement(u.default,i),o.createElement(l.Layout,{className:"ant-layout-has-sider"},o.createElement(c.Form,{className:"edit-layout ant-layout",onSubmit:n,layout:"vertical"},o.createElement(M,{id:m.FORM_ID,className:"mcs-content-container mcs-form-container automation-form"},d))))}}]),t}(o.Component);t.default=(0,d.compose)(f.injectIntl,p.withRouter,(0,i.connect)((function(e){return{formValues:(0,s.getFormValues)(m.FORM_ID)(e)}})),(0,s.reduxForm)({form:m.FORM_ID,enableReinitialize:!0}))(T)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formMessages=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=n(24),l=f(n(49)),c=f(n(63)),u=n(152),d=f(n(95));function f(e){return e&&e.__esModule?e:{default:e}}var p=t.formMessages=(0,i.defineMessages)({sectionGeneralTitle:{id:"automation.builder.node.displayCampaignForm.generalInfoSection.title",defaultMessage:"General information"},sectionGeneralSubtitle:{id:"automation.builder.node.displayCampaignForm.general.subtitle",defaultMessage:"Modify the general information of your display campaign"},automationNodeName:{id:"automation.builder.node.displayCampaignForm.name",defaultMessage:"Automation Node name"},advancedSection:{id:"automation.builder.node.displayCampaignForm.advanced.section",defaultMessage:"Advanced"}}),m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldNormalizer.normalizeInteger,n=e.fieldValidators,a=n.isRequired,o=n.isNotZero,i=n.isValidFloat,l=n.isValidInteger,c=e.intl.formatMessage,f=e.disabled;return r.createElement("div",null,r.createElement(s.FormSection,{subtitle:p.sectionGeneralSubtitle,title:p.sectionGeneralTitle}),r.createElement("div",null,r.createElement(s.FormInputField,{name:"campaign.name",component:s.FormInput,validate:[a],formItemProps:{label:c((0,u.formatDisplayCampaignProperty)("name").message),required:!0},inputProps:{placeholder:c(d.default.campaignFormPlaceholderCampaignName),disabled:f},helpToolTipProps:{title:c(d.default.contentSectionGeneralRow1Tooltip)},small:!0}),r.createElement(s.FormInputField,{name:"campaign.per_day_impression_capping",component:s.FormInput,normalize:t,validate:[l],formItemProps:{label:c((0,u.formatDisplayCampaignProperty)("per_day_impression_capping").message)},inputProps:{placeholder:c(d.default.contentSectionGeneralAdvancedPartRow3Placeholder),disabled:f},helpToolTipProps:{title:c(d.default.contentSectionGeneralAdvancedPartRow3Tooltip)},small:!0}),r.createElement(s.FormInputField,{name:"campaign.total_impression_capping",component:s.FormInput,normalize:t,validate:[l],formItemProps:{label:c((0,u.formatDisplayCampaignProperty)("total_impression_capping").message)},inputProps:{placeholder:c(d.default.contentSectionGeneralAdvancedPartRow2Placeholder),disabled:f},helpToolTipProps:{title:c(d.default.contentSectionGeneralAdvancedPartRow2Tooltip)},small:!0}),r.createElement(s.FormInputField,{name:"campaign.total_budget",component:s.FormInput,validate:[i,o,a],formItemProps:{label:c((0,u.formatDisplayCampaignProperty)("total_budget").message),required:!0},inputProps:{suffix:r.createElement("span",null,"€"),placeholder:c(d.default.contentSectionGeneralAdvancedPartRow4Placeholder),disabled:f},helpToolTipProps:{title:c(d.default.contentSectionGeneralAdvancedPartRow4Tooltip)},small:!0}),r.createElement(s.FormInputField,{name:"campaign.max_budget_per_period",component:s.FormInput,validate:[i,o,a],formItemProps:{label:c((0,u.formatDisplayCampaignProperty)("max_budget_per_period").message),required:!0},inputProps:{disabled:f,suffix:r.createElement("span",null,"€"),addonAfter:r.createElement(s.FormAddonSelectField,{name:"campaign.max_budget_period",component:s.AddonSelect,options:[{value:"DAY",key:"DAY",children:(0,u.formatDisplayCampaignProperty)("max_budget_period","DAY").formattedValue},{value:"WEEK",key:"WEEK",children:(0,u.formatDisplayCampaignProperty)("max_budget_period","WEEK").formattedValue},{value:"MONTH",key:"MONTH",children:(0,u.formatDisplayCampaignProperty)("max_budget_period","MONTH").formattedValue}],selectProps:{disabled:f},disabled:f}),placeholder:c(d.default.contentSectionGeneralAdvancedPartRow5Placeholder),style:{width:"100%"}},helpToolTipProps:{title:c(d.default.contentSectionGeneralAdvancedPartRow5Tooltip)},small:!0}),r.createElement(s.FormInputField,{name:"adGroupFields[0].model.adGroup.max_bid_price",component:s.FormInput,validate:[i,o,a],formItemProps:{label:c((0,u.formatAdGroupProperty)("max_bid_price").message),required:!0},inputProps:{suffix:r.createElement("span",null,"€"),placeholder:c(d.default.contentSectionGeneralRow5Placeholder),disabled:f},helpToolTipProps:{title:c(d.default.contentSectionGeneralRow5Tooltip)},small:!0})))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,l.default,c.default)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdGroupFormSection=t.GoalFormSection=t.GeneralFormSection=void 0;var a=i(n(1027)),r=i(n(1028)),o=i(n(1086));function i(e){return e&&e.__esModule?e:{default:e}}t.GeneralFormSection=a.default,t.GoalFormSection=r.default,t.AdGroupFormSection=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(25),i=n(35),s=n(10),l=n(77),c=g(n(60)),u=n(8),d=n(6),f=n(13),p=n(113),m=g(n(2274));function g(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=s.Layout.Content,b=(0,d.defineMessages)({save:{id:"automation.builder.abnNode.form.save.button",defaultMessage:"Update"},sectionGeneralTitle:{id:"automation.builder.abnNode.edition.form.general.title",defaultMessage:"General Information"},sectionDisplayCampaignTitle:{id:"automation.builder.abnNode.edition.form.display.title",defaultMessage:"Modify the parameters of the display campaign"}}),_=function(e){function t(){y(this,t);var e=h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFormSections=function(){var t=e.props.disabled;return[{id:"general",title:b.sectionGeneralTitle,component:r.createElement(m.default,{disabled:t,initialValues:e.props.initialValues})}]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.close,o=e.disabled,i={formId:p.FORM_ID,paths:t,message:b.save,onClose:a,disabled:o},u=this.buildFormSections(),d=u.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==u.length-1&&r.createElement("hr",null))}));return r.createElement(s.Layout,{className:"edit-layout"},r.createElement(c.default,i),r.createElement(s.Layout,{className:"ant-layout-has-sider"},r.createElement(l.Form,{className:"edit-layout ant-layout",onSubmit:n,layout:"vertical"},r.createElement(v,{id:p.FORM_ID,className:"mcs-content-container mcs-form-container automation-form"},d))))}}]),t}(r.Component);t.default=(0,u.compose)(d.injectIntl,f.withRouter,(0,o.connect)((function(e){return{formValues:(0,i.getFormValues)(p.FORM_ID)(e)}})),(0,i.reduxForm)({form:p.FORM_ID,enableReinitialize:!0}))(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=n(24),l=u(n(49)),c=u(n(63));function u(e){return e&&e.__esModule?e:{default:e}}var d=t.messages=(0,i.defineMessages)({sectionGeneralTitle:{id:"automation.builder.abnNode.edition.form.generalInfoSection.title",defaultMessage:"Description"},sectionGeneralSubtitle:{id:"automation.builder.abnNode.edition.form.generalInfoSection.subtitle",defaultMessage:"Using {split}, you can split the flow of users going\n    through in any number of branches. For example, if you split the flow\n    into 2 branches, half the users will go through the first branch and the other\n    half will take the second branch."},split:{id:"automation.builder.abnNode.edition.form.generalInfoSection.subtitle.split",defaultMessage:"Split"},sectionGeneralConfigurationTitle:{id:"automation.builder.abnNode.edition.form.generalInfoSection.configuration.title",defaultMessage:"Configuration"},automationNodeName:{id:"automation.builder.abnNode.form.name",defaultMessage:"Automation Node name"},branchNumber:{id:"automation.builder.abnNode.split.form.branch.number",defaultMessage:"Number of branches to split the flow into"},advancedSection:{id:"automation.builder.abnNode.advanced.section",defaultMessage:"Advanced"}}),f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.disabled,a=Object.assign(Object.assign({},d.sectionGeneralSubtitle),{values:{split:r.createElement("span",{className:"mcs-automation_nodeName"},r.createElement(i.FormattedMessage,d.split))}});return r.createElement("div",null,r.createElement(s.FormSection,{subtitle:a,title:d.sectionGeneralTitle}),r.createElement(s.FormSection,{title:d.sectionGeneralConfigurationTitle}),r.createElement("div",null,r.createElement(s.FormSliderField,{name:"branch_number",component:s.FormSlider,formItemProps:{label:t(d.branchNumber),required:!0},inputProps:{min:2,max:10,defaultValue:2,disabled:!!n},small:!0})))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,l.default,c.default)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(25),i=n(35),s=n(10),l=n(77),c=g(n(60)),u=n(8),d=n(6),f=n(13),p=n(113),m=g(n(2276));function g(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=s.Layout.Content,b=(0,d.defineMessages)({save:{id:"automation.builder.node.edition.defaultForm.save.button",defaultMessage:"Update"},sectionGeneralTitle:{id:"automation.builder.node.edition.defaultForm.general.title",defaultMessage:"General Information"},sectionDisplayCampaignTitle:{id:"automation.builder.node.edition.defaultForm.display.title",defaultMessage:"Modify the parameters of the display campaign"}}),_=function(e){function t(){y(this,t);var e=h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFormSections=function(){var t=e.props.disabled;return[{id:"general",title:b.sectionGeneralTitle,component:r.createElement(m.default,{disabled:t,initialValues:e.props.initialValues})}]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.close,o=e.disabled,i={formId:p.FORM_ID,paths:t,message:b.save,onClose:a,disabled:o},u=this.buildFormSections(),d=u.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==u.length-1&&r.createElement("hr",null))}));return r.createElement(s.Layout,{className:"edit-layout"},r.createElement(c.default,i),r.createElement(s.Layout,{className:"ant-layout-has-sider"},r.createElement(l.Form,{className:"edit-layout ant-layout",onSubmit:n},r.createElement(v,{id:p.FORM_ID,className:"mcs-content-container mcs-form-container automation-form"},d))))}}]),t}(r.Component);t.default=(0,u.compose)(d.injectIntl,f.withRouter,(0,o.connect)((function(e){return{formValues:(0,i.getFormValues)(p.FORM_ID)(e)}})),(0,i.reduxForm)({form:p.FORM_ID,enableReinitialize:!0}))(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=n(24),l=u(n(49)),c=u(n(63));function u(e){return e&&e.__esModule?e:{default:e}}var d=t.messages=(0,i.defineMessages)({sectionGeneralTitle:{id:"automation.builder.node.defaultForm.generalInfoSection.title",defaultMessage:"General Information"},sectionGeneralSubtitle:{id:"automation.builder.node.defaultForm.general.subtitle",defaultMessage:"Modify the general information of the node"},automationNodeName:{id:"automation.builder.node.defaultForm.name",defaultMessage:"Automation Node name"},advancedSection:{id:"automation.builder.node.defaultForm.advanced.section",defaultMessage:"Advanced"}}),f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage,a=e.disabled;return r.createElement("div",null,r.createElement(s.FormSection,{subtitle:d.sectionGeneralSubtitle,title:d.sectionGeneralTitle}),r.createElement(s.FormInputField,{name:"name",component:s.FormInput,validate:[t],formItemProps:{label:n(d.automationNodeName),required:!0},inputProps:{placeholder:n(d.automationNodeName),disabled:!!a},small:!0}))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,l.default,c.default)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(25),i=n(35),s=n(77),l=n(10),c=h(n(60)),u=n(8),d=n(6),f=n(13),p=n(113),m=n(1090),g=n(828),y=h(n(2278));function h(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var _=l.Layout.Content,S=(0,d.defineMessages)({save:{id:"automation.builder.node.emailCampaignForm.save.button",defaultMessage:"Update"},sectionGeneralTitle:{id:"automation.builder.node.emailCampaignForm.general.title",defaultMessage:"General Information"},sectionDisplayCampaignTitle:{id:"automation.builder.node.emailCampaignForm.display.title",defaultMessage:"Modify the parameters of the display campaign"},sectionSenderInformationTitle:{id:"automation.builder.node.emailCampaignForm.campaign.sender.information",defaultMessage:"Sender information"}}),E=function(e){function t(){v(this,t);var e=b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFormSections=function(){var t=e.props,n=t.change,a=t.disabled,o=[],i={id:"displayCampaign",title:S.sectionGeneralTitle,component:r.createElement(y.default,{initialValues:e.props.initialValues,organisationId:e.props.match.params.organisationId,disabled:a})},s={id:"senderInformation",title:S.sectionSenderInformationTitle,component:r.createElement(m.BlastFormSection,{small:!0,disabled:a,fieldName:"blastFields[0].model.blast"})},l={id:"emailTemplate",title:S.sectionSenderInformationTitle,component:r.createElement(g.BlastTemplateSectionFieldArray,{name:"blastFields[0].model.templateFields",component:m.TemplateFormSection,formChange:n,rerenderOnEveryChange:!0,disabled:a})};return o.push(i),o.push(s),o.push(l),o},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.close,o=e.disabled,i={formId:p.FORM_ID,paths:t,message:S.save,onClose:a,disabled:o},u=this.buildFormSections(),d=u.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==u.length-1&&r.createElement("hr",null))}));return r.createElement(l.Layout,{className:"edit-layout"},r.createElement(c.default,i),r.createElement(l.Layout,{className:"ant-layout-has-sider"},r.createElement(s.Form,{className:"edit-layout ant-layout",onSubmit:n,layout:"vertical"},r.createElement(_,{id:p.FORM_ID,className:"mcs-content-container mcs-form-container automation-form"},d))))}}]),t}(r.Component);t.default=(0,u.compose)(d.injectIntl,f.withRouter,(0,o.connect)((function(e){return{formValues:(0,i.getFormValues)(p.FORM_ID)(e)}})),(0,i.reduxForm)({form:p.FORM_ID,enableReinitialize:!0}))(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formMessages=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=n(6),c=n(24),u=v(n(49)),d=v(n(63)),f=n(152),p=v(n(95)),m=n(10),g=n(15),y=n(12),h=n(33);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=t.formMessages=(0,l.defineMessages)({sectionGeneralTitle:{id:"automation.builder.node.emailCampaignForm.generalInfoSection.title",defaultMessage:"Description"},sectionGeneralSubtitle:{id:"automation.builder.node.emailCampaignForm.general.subtitle",defaultMessage:"This action allows you to send an email to the user who goes through it."},sectionGeneralConfigurationTitle:{id:"automation.builder.node.emailCampaignForm.generalInfoSection.configuration.title",defaultMessage:"Configuration"},automationNodeName:{id:"automation.builder.node.emailCampaignForm.name",defaultMessage:"Automation Node name"},emailEditorRouterSelectLabel:{id:"automation.builder.step.select.label.router",defaultMessage:"Router"},emailEditorRouterSelectHelper:{id:"automation.builder.emailEditor.step.select.helper.router",defaultMessage:"Choose a router for your campaign. A Router is basically a channel through which you will send your email. You can configure you email routers in your {campaignSettings}."},campaignSettings:{id:"automation.builder.emailEditor.step.select.helper.router.campaignSettings",defaultMessage:"campaigns settings"},emailEditorProviderSelectLabel:{id:"automation.builder.emailEditor.step.select.label.provider",defaultMessage:"Provider"},emailEditorProviderSelectHelper:{id:"automation.builder.emailEditor.step.select.helper.provider",defaultMessage:"A Provider helps you target users who have given you explicit consent to email targeting. Get in touch with your support contact to update your providers list."}}),S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={routers:[],fetchingRouters:!1,consents:[],fetchingConsents:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({fetchingRouters:!0,fetchingConsents:!0}),this._emailRouterService.getEmailRouters(this.props.organisationId).then((function(t){e._consentService.getConsents(e.props.organisationId).then((function(n){e.setState({fetchingRouters:!1,routers:t.data,fetchingConsents:!1,consents:n.data})}))}))}},{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage,r=e.organisationId,o=e.disabled,s=i.createElement(l.FormattedMessage,a({},_.emailEditorRouterSelectHelper,{values:{campaignSettings:i.createElement(h.Link,{to:"/v2/o/"+r+"/settings/campaigns/email_routers",target:"_blank"},i.createElement(l.FormattedMessage,_.campaignSettings))}}));return i.createElement("div",null,i.createElement(c.FormSection,{subtitle:_.sectionGeneralSubtitle,title:_.sectionGeneralTitle}),i.createElement(c.FormSection,{title:_.sectionGeneralConfigurationTitle}),i.createElement("div",null,i.createElement(c.FormInputField,{name:"campaign.name",component:c.FormInput,validate:[t],formItemProps:{label:n((0,f.formatDisplayCampaignProperty)("name").message),required:!0},inputProps:{placeholder:n(p.default.campaignFormPlaceholderCampaignName),disabled:!!o},helpToolTipProps:{title:n(p.default.contentSectionGeneralRow1Tooltip)},small:!0}),i.createElement(c.FormSelectField,{name:"routerFields[0].model.email_router_id",component:c.DefaultSelect,validate:[t],formItemProps:{label:n(_.emailEditorRouterSelectLabel),required:!0},selectProps:{notFoundContent:this.state.fetchingRouters?i.createElement(m.Spin,{size:"small"}):null},options:this.state.routers.map((function(e){return{value:e.id,title:e.name}})),helpToolTipProps:{title:s},small:!0,disabled:!!o}),i.createElement(c.FormSelectField,{name:"blastFields[0].model.consentFields[0].model.consent_id",component:c.DefaultSelect,validate:[t],formItemProps:{label:n(_.emailEditorProviderSelectLabel),required:!0},selectProps:{notFoundContent:this.state.fetchingConsents?i.createElement(m.Spin,{size:"small"}):null,disabled:!!o},options:this.state.consents.map((function(e){return{value:e.id,title:e.technical_name}})),helpToolTipProps:{title:n(_.emailEditorProviderSelectHelper)},small:!0,disabled:!!o})))}}]),t}(i.Component);b([(0,g.lazyInject)(y.TYPES.IConsentService)],S.prototype,"_consentService",void 0),b([(0,g.lazyInject)(y.TYPES.IEmailRouterService)],S.prototype,"_emailRouterService",void 0),t.default=(0,s.compose)(l.injectIntl,u.default,d.default)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(77),c=n(8),u=n(6),d=n(13),f=n(113),p=n(11),m=n(24),g=n(813),y=(a=g)&&a.__esModule?a:{default:a},h=n(51);var v=s.Layout.Content,b=(0,u.defineMessages)({descriptionTitle:{id:"automation.builder.node.edition.form.query.presentation.description.title",defaultMessage:"Description"},descriptionSubtitle:{id:"automation.builder.node.edition.form.query.presentation.description.subtitle",defaultMessage:"Using {if}, you can add a check whether the user should proceed to the next step of the automation."},if:{id:"automation.builder.node.edition.form.query.presentation.description.subtitle.if",defaultMessage:"If"},configurationTitle:{id:"automation.builder.node.edition.form.query.presentation.configuration.title",defaultMessage:"Configuration"},save:{id:"automation.builder.node.edition.form.query.save.button",defaultMessage:"Update"},or:{id:"automation.builder.node.edition.form.query.presentation.or",defaultMessage:"or"},subtitle:{id:"automation.builder.node.edition.form.query.presentation.subtitle",defaultMessage:"Please select the query type you want to do."},title:{id:"automation.builder.node.edition.form.query.presentation.title",defaultMessage:"Language Selection."},noMoreSupported:{id:"automation.builder.node.edition.form.query.legacyComponent.noMoreSupported",defaultMessage:"The query language related to this datamart is no more supported. Please select another datamart or create a new resource based on another datamart."}}),_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),a=e.storylineNodeModel.node;return n.state={queryLanguage:a.formData.query_language,queryText:a.formData.query_text,isTrigger:"LIVE"===a.evaluation_mode},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.breadCrumbPaths,a=t.close,o=t.storylineNodeModel,c=t.initialValues,d=t.onSubmit,g=t.disabled,_=t.intl,S=this.state,E=S.queryLanguage,O=S.isTrigger,w={disabled:g};if(!E){var M=function(t){return function(){return e.setState({queryLanguage:t})}},P=Object.assign(Object.assign({},b.descriptionSubtitle),{values:{if:i.createElement("span",{className:"mcs-automation_nodeName"},i.createElement(u.FormattedMessage,b.if))}});return i.createElement(s.Layout,null,i.createElement("div",{className:"edit-layout ant-layout"},i.createElement(p.Actionbar,{edition:!0,paths:n},i.createElement(p.McsIcon,{type:"close",className:"close-icon",style:{cursor:"pointer"},onClick:a})),i.createElement(s.Layout,null,i.createElement(v,{className:"mcs-content-container mcs-form-container"},i.createElement(m.FormSection,{subtitle:P,title:b.descriptionTitle}),i.createElement(m.FormSection,{title:b.configurationTitle}),i.createElement(v,{className:"text-center"},i.createElement(m.FormTitle,{title:b.title,subtitle:b.subtitle}),i.createElement(s.Row,{className:"mcs-selector_container"},i.createElement(s.Row,{className:"menu"},i.createElement("div",{className:"presentation"},i.createElement(p.MenuPresentational,{title:"Query Builder",type:"data",select:M("JSON_OTQL")}),i.createElement("div",{className:"separator"},i.createElement(u.FormattedMessage,b.or)),i.createElement(p.MenuPresentational,{title:"Expert Mode",type:"code",select:M("OTQL")})))))))))}if("SELECTORQL"===E)return i.createElement(s.Alert,{message:_.formatMessage(b.noMoreSupported),type:"warning"});var T=o.node,I=T.formData.datamart_id?T.formData.datamart_id:c.datamart_id;if("JSON_OTQL"===E){return i.createElement(y.default,r({datamartId:T.formData.datamart_id?T.formData.datamart_id:c.datamart_id,renderActionBar:function(e){return i.createElement(p.Actionbar,{edition:!0,paths:n},!g&&i.createElement(s.Button,{onClick:function(){var t=Object.assign(Object.assign({},c),{query_language:E,query_text:JSON.stringify(e)});d(t)},type:"primary",className:"mcs-primary"},"Save"),i.createElement(p.McsIcon,{type:"close",className:"close-icon",style:{cursor:"pointer"},onClick:a}))},editionLayout:!0,queryDocument:T.formData.query_text?JSON.parse(T.formData.query_text):void 0,isTrigger:O},w,{hideCounterAndTimeline:!0}))}return i.createElement(s.Layout,{className:"edit-layout"},i.createElement(s.Layout,{className:"ant-layout"},i.createElement(p.Actionbar,{edition:!0,paths:n},i.createElement(s.Button,{onClick:function(){var t=Object.assign(Object.assign({},c),{query_language:E,query_text:e.state.queryText});d(t)},type:"primary",className:"mcs-primary"},"Save"),i.createElement(p.McsIcon,{type:"close",className:"close-icon",style:{cursor:"pointer"},onClick:a})),i.createElement(l.Form,{className:"edit-layout ant-layout",layout:"vertical"},i.createElement(v,{id:f.FORM_ID,className:"mcs-content-container mcs-form-container automation-form"},i.createElement(h.OtqlConsole,r({value:this.state.queryText?this.state.queryText:"",datamartId:I,onChange:function(t){return e.setState({queryText:t})},showPrintMargin:!1,height:"250px",width:"100%",enableBasicAutocompletion:!0,enableLiveAutocompletion:!0},w))))))}}]),t}(i.Component);t.default=(0,c.compose)(u.injectIntl,d.withRouter)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(25),i=n(35),s=n(10),l=n(77),c=g(n(60)),u=n(8),d=n(6),f=n(13),p=n(113),m=g(n(2281));function g(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=s.Layout.Content,b=(0,d.defineMessages)({save:{id:"automation.builder.node.waitForm.saveButton",defaultMessage:"Update"},sectionGeneralTitle:{id:"automation.builder.node.waitForm.generalTitle",defaultMessage:"General Information"},sectionDisplayCampaignTitle:{id:"automation.builder.node.waitForm.displayTitle",defaultMessage:"Modify the parameters of the display campaign"}}),_=function(e){function t(){y(this,t);var e=h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFormSections=function(){var t=e.props.disabled;return[{id:"general",title:b.sectionGeneralTitle,component:r.createElement(m.default,{disabled:t,initialValues:e.props.initialValues})}]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.close,o=e.disabled,i={formId:p.FORM_ID,paths:t,message:b.save,onClose:a,disabled:o},u=this.buildFormSections(),d=u.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==u.length-1&&r.createElement("hr",null))}));return r.createElement(s.Layout,{className:"edit-layout"},r.createElement(c.default,i),r.createElement(s.Layout,{className:"ant-layout-has-sider"},r.createElement(l.Form,{className:"edit-layout ant-layout",onSubmit:n,layout:"vertical"},r.createElement(v,{id:p.FORM_ID,className:"mcs-content-container mcs-form-container automation-form"},d))))}}]),t}(r.Component);t.default=(0,u.compose)(d.injectIntl,f.withRouter,(0,o.connect)((function(e){return{formValues:(0,i.getFormValues)(p.FORM_ID)(e)}})),(0,i.reduxForm)({form:p.FORM_ID,enableReinitialize:!0}))(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=n(24),l=y(n(49)),c=y(n(63)),u=n(113),d=n(10),f=y(n(17)),p=n(25),m=n(35),g=n(73);function y(e){return e&&e.__esModule?e:{default:e}}var h=t.messages=(0,i.defineMessages)({sectionGeneralTitle:{id:"automation.builder.node.waitNodeForm.general.title",defaultMessage:"Description"},sectionGeneralSubtitle:{id:"automation.builder.node.waitNodeForm.general.subtitle",defaultMessage:"Using {wait}, you can stall the automation for a given amount of time.\n    For example, you can wait a few hours before checking if users have bought the product\n    they've added to their cart."},wait:{id:"automation.builder.node.waitNodeForm.general.subtitle.wait",defaultMessage:"Wait"},sectionGeneralConfigurationTitle:{id:"automation.builder.node.waitNodeForm.general.configuration.title",defaultMessage:"Configuration"},durationTitle:{id:"automation.builder.node.waitNodeForm.duration.title",defaultMessage:"Delay"},durationPlaceholder:{id:"automation.builder.node.waitNodeForm.duration.placeholder",defaultMessage:"Enter the duration"},durationUnitHours:{id:"automation.builder.node.waitNodeForm.duration.unit.hours",defaultMessage:"Hours"},durationUnitDays:{id:"automation.builder.node.waitNodeForm.duration.unit.days",defaultMessage:"Days"},enableTimeWindow:{id:"automation.builder.node.waitNodeForm.timeWindow.enable",defaultMessage:"Time window"},enableDayWindow:{id:"automation.builder.node.waitNodeForm.dayWindow.enable",defaultMessage:"Day selection"},timeWindowTitle:{id:"automation.builder.node.waitNodeForm.timeWindow.title",defaultMessage:"Wait until time is between:"},betweenTime:{id:"automation.builder.node.waitNodeForm.timeWindow.betweenTime",defaultMessage:"and"},startTimeRequired:{id:"automation.builder.node.waitNodeForm.timeWindow.error.startTimeRequired",defaultMessage:"Required when end time set"},endTimeRequired:{id:"automation.builder.node.waitNodeForm.general.error.endTimeRequired",defaultMessage:"Required when start time set"},startTimeInvalidValue:{id:"automation.builder.node.waitNodeForm.timeWindow.error.startTimeInvalidValue",defaultMessage:"Start time cannot be equal to 23:00"},endTimeInvalidValue:{id:"automation.builder.node.waitNodeForm.timeWindow.error.endTimeInvalidValue",defaultMessage:"End time cannot be equal to 00:00"},dayWindowTitle:{id:"automation.builder.node.waitNodeForm.dayWindow.title",defaultMessage:"Wait for the following days:"},monday:{id:"automation.builder.node.waitNodeForm.dayWindow.monday",defaultMessage:"Monday"},tuesday:{id:"automation.builder.node.waitNodeForm.dayWindow.tuesday",defaultMessage:"Tuesday"},wednesday:{id:"automation.builder.node.waitNodeForm.dayWindow.wednesday",defaultMessage:"Wednesday"},thursday:{id:"automation.builder.node.waitNodeForm.dayWindow.tursday",defaultMessage:"Thursday"},friday:{id:"automation.builder.node.waitNodeForm.dayWindow.friday",defaultMessage:"Friday"},saturday:{id:"automation.builder.node.waitNodeForm.dayWindow.saturday",defaultMessage:"Saturday"},sunday:{id:"automation.builder.node.waitNodeForm.dayWindow.sunday",defaultMessage:"Sunday"},dayWindowEmpty:{id:"automation.builder.node.waitNodeForm.dayWindow.error.empty",defaultMessage:"You have to choose at least one day"}}),v=["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY","SUNDAY"],b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isTimeSwitchInitiallyChecked=function(e){return!!e.time_window_start||!!e.time_window_end},n.isDaySwitchInitiallyChecked=function(e){return!!e.day_window&&7!==e.day_window.length},n.onTimeSwitchChange=function(e){var t=n.props.dispatch;return t&&(e?(t((0,m.change)(u.FORM_ID,"time_window_start",(0,f.default)("09:00","HH:mm"))),t((0,m.change)(u.FORM_ID,"time_window_end",(0,f.default)("18:00","HH:mm")))):(t((0,m.change)(u.FORM_ID,"time_window_start",null)),t((0,m.change)(u.FORM_ID,"time_window_end",null)))),n.setState({enableTimeWindow:e})},n.onDaySwitchChange=function(e){var t=n.props.dispatch;return t&&!e&&t((0,m.change)(u.FORM_ID,"day_window",v)),n.setState({enableDayWindow:e})},n.onStartTimeChange=function(e,t){var a=n.props,r=a.dispatch,o=a.formValues;r&&t&&o.time_window_end&&!t.isBefore(o.time_window_end)&&r((0,m.change)(u.FORM_ID,"time_window_end",(0,f.default)(0).hours(t.hours()+1).day(t.day())))},n.onEndTimeChange=function(e,t){var a=n.props,r=a.dispatch,o=a.formValues;r&&t&&o.time_window_start&&!t.isAfter(o.time_window_start)&&r((0,m.change)(u.FORM_ID,"time_window_start",(0,f.default)(0).hours(t.hours()-1).day(t.day())))},n.validateStartTime=function(e){var t=n.props.intl.formatMessage;return e&&23===e.hours()?t(h.startTimeInvalidValue):void 0},n.validateEndTime=function(e){var t=n.props.intl.formatMessage;return e&&0===e.hours()?t(h.endTimeInvalidValue):void 0},n.validateNotEmpty=function(e){var t=n.props.intl.formatMessage;return!e||void 0!==e.length&&!e.length?t(h.dayWindowEmpty):void 0},n.state={enableTimeWindow:n.isTimeSwitchInitiallyChecked(e.initialValues),enableDayWindow:n.isDaySwitchInitiallyChecked(e.initialValues)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators,n=t.isRequired,a=t.isValidInteger,o=t.isNotZero,l=e.intl.formatMessage,c=e.disabled,u=e.hasFeature,f=this.state,p=f.enableTimeWindow,m=f.enableDayWindow,g=Object.assign(Object.assign({},h.sectionGeneralSubtitle),{values:{wait:r.createElement("span",{className:"mcs-automation_nodeName"},r.createElement(i.FormattedMessage,h.wait))}});return r.createElement("div",{className:"mcs-automationWaitNodeForm"},r.createElement(s.FormSection,{subtitle:g,title:h.sectionGeneralTitle}),r.createElement(s.FormSection,{title:h.sectionGeneralConfigurationTitle}),r.createElement(s.FormInputField,{name:"wait_duration.value",component:s.FormInput,validate:[n,a,o],formItemProps:{label:l(h.durationTitle),required:!0},inputProps:{disabled:!!c,placeholder:l(h.durationPlaceholder),addonAfter:r.createElement(s.FormAddonSelectField,{name:"wait_duration.unit",component:s.AddonSelect,disabled:c,options:[{key:"hours",value:"hours",title:l(h.durationUnitHours)},{key:"days",value:"days",title:l(h.durationUnitDays)}]}),style:{width:"100%"}},small:!0}),u("automations-wait-node-day-and-time-window")&&r.createElement("div",{className:"mcs-automationWaitNodeForm_switchSection"},r.createElement(d.Switch,{defaultChecked:p,disabled:c,onChange:this.onTimeSwitchChange}),r.createElement("div",{className:"mcs-automationWaitNodeForm_switchSection_label"},l(h.enableTimeWindow))),p&&u("automations-wait-node-day-and-time-window")&&r.createElement("div",null,r.createElement("div",{className:"mcs-automationWaitNodeForm_sectionDescription"},l(h.timeWindowTitle)),r.createElement("div",{className:"mcs-automationWaitNodeForm_timeSection"},r.createElement(s.FormTimePickerField,{name:"time_window_start",component:s.FormTimePicker,timeFormat:"HH:mm",allowClear:!1,minuteStep:60,validate:[n,this.validateStartTime],onChange:this.onStartTimeChange,disabled:c}),r.createElement("div",{className:"mcs-automationWaitNodeForm_timeSection_label"},l(h.betweenTime)),r.createElement(s.FormTimePickerField,{name:"time_window_end",component:s.FormTimePicker,timeFormat:"HH:mm",allowClear:!1,minuteStep:60,validate:[n,this.validateEndTime],onChange:this.onEndTimeChange,disabled:c}))),u("automations-wait-node-day-and-time-window")&&r.createElement("div",{className:"mcs-automationWaitNodeForm_switchSection"},r.createElement(d.Switch,{defaultChecked:m,disabled:c,onChange:this.onDaySwitchChange}),r.createElement("div",{className:"mcs-automationWaitNodeForm_switchSection_label"},l(h.enableDayWindow))),m&&u("automations-wait-node-day-and-time-window")&&r.createElement("div",null,r.createElement("div",{className:"mcs-automationWaitNodeForm_sectionDescription"},l(h.dayWindowTitle)),r.createElement(s.FormCheckboxGroupField,{name:"day_window",className:"mcs-automationWaitNodeForm_checkBoxGroup",component:s.FormCheckboxGroup,validate:this.validateNotEmpty,disabled:c,options:v.map((function(e){return{label:l(h[e.toLowerCase()]),value:e}}))})))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,g.injectFeatures,l.default,c.default,(0,p.connect)((function(e){return{formValues:(0,m.getFormValues)(u.FORM_ID)(e)}})))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(35),o=n(113),i=n(6),s=n(13),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),c=n(25),u=n(8),d=n(10),f=n(77),p=y(n(60)),m=y(n(2283)),g=y(n(420));function y(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=d.Layout.Content,_=r.FieldArray,S=(0,i.defineMessages)({save:{id:"automation.builder.node.addToSegmentForm.save.button",defaultMessage:"Update"},sectionGeneralTitle:{id:"automation.builder.node.addToSegmentForm.general.title",defaultMessage:"General Information"}}),E=function(e){function t(){h(this,t);var e=v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFormSections=function(){var t=e.props,n=t.disabled,a=t.change,r=[],o={id:"addToSegmentSectionId",title:S.sectionGeneralTitle,component:l.createElement(m.default,{initialValues:e.props.initialValues,organisationId:e.props.match.params.organisationId,disabled:n})};r.push(o);var i={id:"processingActivities",title:S.sectionGeneralTitle,component:l.createElement(_,{name:"processingActivities",component:g.default,initialProcessingSelectionsForWarning:[],processingsAssociatedType:"ADD-TO-SEGMENT-AUTOMATION",formChange:a,disabled:n})};return r.push(i),r},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.close,r=e.disabled,i={formId:o.FORM_ID,paths:t,message:S.save,onClose:a,disabled:r},s=this.buildFormSections(),c=s.map((function(e,t){return l.createElement("div",{key:e.id},l.createElement("div",{key:e.id,id:e.id},e.component),t!==s.length-1&&l.createElement("hr",null))}));return l.createElement(d.Layout,{className:"edit-layout"},l.createElement(p.default,i),l.createElement(d.Layout,{className:"ant-layout-has-sider"},l.createElement(f.Form,{className:"edit-layout ant-layout",onSubmit:n,layout:"vertical"},l.createElement(b,{id:o.FORM_ID,className:"mcs-content-container mcs-form-container automation-form"},c))))}}]),t}(l.Component);t.default=(0,u.compose)(i.injectIntl,s.withRouter,(0,c.connect)((function(e){return{formValues:(0,r.getFormValues)(o.FORM_ID)(e)}})),(0,r.reduxForm)({form:o.FORM_ID,enableReinitialize:!0}))(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(8),l=n(63),c=(a=l)&&a.__esModule?a:{default:a},u=n(24);function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=function(e){function t(){return d(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators,n=t.isRequired,a=t.isValidInteger,r=e.intl.formatMessage,i=e.disabled;return o.createElement("div",null,o.createElement(u.FormSection,{subtitle:m.sectionGeneralSubtitle,title:m.sectionGeneralTitle}),o.createElement(u.FormSection,{title:m.sectionGeneralConfigurationTitle}),o.createElement("div",null,o.createElement(u.FormInputField,{name:"audienceSegmentName",component:u.FormInput,validate:[n],formItemProps:{label:r(m.audienceSegmentNameTitle),required:!0},inputProps:{placeholder:r(m.audienceSegmentNamePlaceholder),disabled:!!i},helpToolTipProps:{title:r(m.audienceSegmentNameSubtitle)},small:!0}),o.createElement(u.FormInputField,{name:"ttl.value",component:u.FormInput,validate:[a],formItemProps:{label:r(m.audienceSegmentTTLTitle)},inputProps:{disabled:i,placeholder:r(m.audienceSegmentTTLPlaceholder),addonAfter:o.createElement(u.FormAddonSelectField,{name:"ttl.unit",component:u.AddonSelect,disabled:i,options:[{value:"days",key:"days",title:r(m.audienceSegmentTTLUnitDays)},{value:"months",key:"months",title:r(m.audienceSegmentTTLUnitMonths)}]}),style:{width:"100%"}},helpToolTipProps:{title:r(m.audienceSegmentTTLSubtitle)},small:!0})))}}]),t}(o.Component);t.default=(0,s.compose)(i.injectIntl,u.withValidators,c.default)(p);var m=t.messages=(0,i.defineMessages)({sectionGeneralTitle:{id:"automation.builder.node.addToSegmentForm.general.title",defaultMessage:"Description"},sectionGeneralSubtitle:{id:"automation.builder.node.addToSegmentForm.general.subtitle",defaultMessage:"The action allows you to add users to a segment."},sectionGeneralConfigurationTitle:{id:"automation.builder.node.addToSegmentForm.general.configuration.title",defaultMessage:"Configuration"},automationNodeName:{id:"automation.builder.node.addToSegmentForm.name",defaultMessage:"Automation node name"},audienceSegmentNameTitle:{id:"automation.builder.node.addToSegmentForm.name.title",defaultMessage:"Segment Name"},audienceSegmentNameSubtitle:{id:"automation.builder.node.addToSegmentForm.name.subtitle",defaultMessage:"The segment name will help you identify it on the different screens. Make it as memorable as you want your results to be!"},audienceSegmentNamePlaceholder:{id:"automation.builder.node.addToSegmentForm.name.placeholder",defaultMessage:"Segment Name"},audienceSegmentTTLTitle:{id:"automation.builder.node.addToSegmentForm.ttl.title",defaultMessage:"Time to live in segment"},audienceSegmentTTLSubtitle:{id:"automation.builder.node.addToSegmentForm.ttl.subtitle",defaultMessage:"The time that users will be in the segment for (0 means forever). If not filled, a default TTL will be applied."},audienceSegmentTTLPlaceholder:{id:"automation.builder.node.addToSegmentForm.ttl.placeholder",defaultMessage:"Time to live"},audienceSegmentTTLUnitDays:{id:"automation.builder.node.addToSegmentForm.ttl.unit.days",defaultMessage:"Days"},audienceSegmentTTLUnitMonths:{id:"automation.builder.node.addToSegmentForm.ttl.unit.months",defaultMessage:"Months"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(6),c=g(n(272)),u=g(n(1101)),d=n(15),f=n(12),p=n(44),m=g(n(23));function g(e){return e&&e.__esModule?e:{default:e}}var y=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},h=c.default,v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.saveProcessingActivities=function(e,t){(0,n.props.save)(t)},n.fetchCommunityId=function(e){var t=n.props.notifyError;return n._organisationService.getOrganisation(e).then((function(e){var t=e.data.community_id;return n.setState({communityId:t}),t})).catch((function(e){return t(e),null}))},n.returnEmptyDataListResponse=function(){return{data:[],count:0,status:"error"}},n.fetchProcessingActivities=function(e){var t=n.props,a=t.match.params.organisationId,r=t.notifyError,o=n.state.communityId,i=Object.assign({},(0,p.getPaginatedApiParam)(e.currentPage,e.pageSize));return e.keywords&&(i.name=e.keywords),(o?Promise.resolve(o):n.fetchCommunityId(a)).then((function(e){return null!==e?n._organisationService.getProcessings(e,i).catch((function(e){return r(e),n.returnEmptyDataListResponse()})):n.returnEmptyDataListResponse()}))},n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.intl.formatMessage,a=t.selectedProcessingActivityIds,r=t.close,i=[{intlMessage:u.default.processingActivitiesSelectorColumnName,key:"name",render:function(e,t){return o.createElement("span",null,t.name)}},{intlMessage:u.default.processingActivitiesSelectorColumnLegalBasis,key:"legal_basis",render:function(e,t){return o.createElement("span",null,t.legal_basis)}}];return o.createElement(h,{actionBarTitle:n(u.default.processingActivitiesSelectorTitle),displayFiltering:!0,searchPlaceholder:n(u.default.processingActivitiesSelectorSearchPlaceholder),selectedIds:a,fetchDataList:this.fetchProcessingActivities,fetchData:function(t){return e._organisationService.getProcessing(t)},singleSelection:!1,columnsDefinitions:i,save:this.saveProcessingActivities,close:r})}}]),t}(o.Component);y([(0,d.lazyInject)(f.TYPES.IOrganisationService)],v.prototype,"_organisationService",void 0),t.default=(0,i.compose)(s.withRouter,l.injectIntl,m.default)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(35),o=n(113),i=n(6),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),l=n(25),c=n(8),u=n(10),d=n(77),f=m(n(60)),p=m(n(2286));function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=u.Layout.Content,v=(0,i.defineMessages)({save:{id:"automation.builder.node.deleteFromSegmentForm.save.button",defaultMessage:"Update"},sectionGeneralTitle:{id:"automation.builder.node.deleteFromSegmentForm.general.title",defaultMessage:"General Information"}}),b=function(e){function t(){g(this,t);var e=y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFormSections=function(){var t=e.props.disabled,n=[],a={id:"deleteFromSegmentSectionId",title:v.sectionGeneralTitle,component:s.createElement(p.default,{initialValues:e.props.initialValues,storylineNodeModel:e.props.storylineNodeModel,scenarioNodes:e.props.scenarioNodes,disabled:t})};return n.push(a),n},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.close,r=e.disabled,i={formId:o.FORM_ID,paths:t,message:v.save,onClose:a,disabled:r},l=this.buildFormSections(),c=l.map((function(e,t){return s.createElement("div",{key:e.id},s.createElement("div",{key:e.id,id:e.id},e.component),t!==l.length-1&&s.createElement("hr",null))}));return s.createElement(u.Layout,{className:"edit-layout"},s.createElement(f.default,i),s.createElement(u.Layout,{className:"ant-layout-has-sider"},s.createElement(d.Form,{className:"edit-layout ant-layout",onSubmit:n,layout:"vertical"},s.createElement(h,{id:o.FORM_ID,className:"mcs-content-container mcs-form-container automation-form"},c))))}}]),t}(s.Component);t.default=(0,c.compose)(i.injectIntl,(0,l.connect)((function(e){return{formValues:(0,r.getFormValues)(o.FORM_ID)(e)}})),(0,r.reduxForm)({form:o.FORM_ID,enableReinitialize:!0}))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(113),s=n(6),l=n(12),c=n(15),u=n(8),d=v(n(63)),f=n(24),p=n(311),m=v(n(343)),g=n(163),y=n(13),h=n(160);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchListMethod=function(e){var t=n.props,a=t.match.params.organisationId,r=t.storylineNodeModel,i=t.scenarioNodes;return n._audienceSegmentService.getSegments(a,{keywords:e,type:["USER_LIST"],feed_type:"SCENARIO"}).then((function(e){var t=e.data;return n.findPreviousAddToSegmentNodes(r,i).map((function(e){return{key:e.formData.audienceSegmentId||"",label:o.createElement("label",null,e.formData.audienceSegmentName||""),value:e.formData.audienceSegmentId||""}})).concat(t.map((function(e){return{key:e.id,label:o.createElement(g.SegmentNameDisplay,{audienceSegmentResource:e}),value:e.id}})))}))},n.findPreviousAddToSegmentNodes=function(e,t){return function e(n,a){var r=n.in_edge;if(r){var o=t.find((function(e){return e.node.id===r.source_id}));if(o)return(0,i.isAddToSegmentNode)(o.node)&&o.node.formData.audienceSegmentName&&o.node.formData.audienceSegmentId&&(0,h.isFakeId)(o.node.formData.audienceSegmentId)?e(o,a.concat(o.node)):e(o,a)}return a}(e,[])},n.fetchSingleMethod=function(e){var t=n.props.scenarioNodes;return(0,h.isFakeId)(e)?new Promise((function(a){return a({key:e,label:o.createElement("label",null,n.findSegmentName(e,t)),value:e})})):n._audienceSegmentService.getSegment(e).then((function(e){var t=e.data;return{key:t.id,label:o.createElement(g.SegmentNameDisplay,{audienceSegmentResource:t}),value:t.id}}))},n.findSegmentName=function(e,t){var n=t.find((function(t){return(0,i.isAddToSegmentNode)(t.node)&&e===t.node.formData.audienceSegmentId}));return n&&(0,i.isAddToSegmentNode)(n.node)&&n.node.formData.audienceSegmentName||""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage,a=e.disabled;return o.createElement("div",null,o.createElement(f.FormSection,{subtitle:S.sectionGeneralSubtitle,title:S.sectionGeneralTitle}),o.createElement(f.FormSection,{title:S.sectionGeneralConfigurationTitle}),o.createElement(p.FormSearchObjectField,{name:"segmentId",component:m.default,validate:[t],formItemProps:{label:n(S.audienceSegmentNameTitle),required:!0},fetchListMethod:this.fetchListMethod,fetchSingleMethod:this.fetchSingleMethod,selectProps:{disabled:!!a,mode:"multiple",showSearch:!0},type:"Audience",small:!0}))}}]),t}(o.Component);b([(0,c.lazyInject)(l.TYPES.IAudienceSegmentService)],_.prototype,"_audienceSegmentService",void 0),t.default=(0,u.compose)(s.injectIntl,f.withValidators,d.default,y.withRouter)(_);var S=t.messages=(0,s.defineMessages)({sectionGeneralTitle:{id:"automation.builder.node.deleteFromSegmentForm.generalInfoSection.title",defaultMessage:"Description"},sectionGeneralSubtitle:{id:"automation.builder.node.deleteFromSegmentForm.general.subtitle",defaultMessage:"This action allows you to delete users from a segment. If the users are not in the segment, there won't be any action and the automation will continue."},sectionGeneralConfigurationTitle:{id:"automation.builder.node.deleteFromSegmentForm.generalInfoSection.configuration.title",defaultMessage:"Configuration"},automationNodeName:{id:"automation.builder.node.deleteFromSegmentForm.name",defaultMessage:"Automation node name"},audienceSegmentNameTitle:{id:"automation.builder.node.deleteFromSegmentForm.name.title",defaultMessage:"Select the segment to delete the users from"},audienceSegmentNamePlaceholder:{id:"automation.builder.node.deleteFromSegmentForm.name.placeholder",defaultMessage:"Segment Name"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=M(n(0)),i=n(8),s=n(10),l=n(77),c=M(n(47)),u=n(35),d=n(6),f=n(24),p=n(221),m=n(25),g=n(2288),y=n(51),h=M(n(23)),v=n(112),b=n(12),_=n(15),S=M(n(60)),E=n(311),O=M(n(343)),w=M(n(1060));function M(e){return e&&e.__esModule?e:{default:e}}var P=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},T="reactToEventForm",I=u.FieldArray,A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n._isMounted=!1,n.getValidObjectType=function(){var e=n.props,t=e.notifyError,a=e.storylineNodeModel,r=e.initialValues,o=a.node,i=o.formData.datamart_id?o.formData.datamart_id:r.datamart_id;return n._runtimeSchemaService.getRuntimeSchemas(i).then((function(e){var t=e.data.find((function(e){return"LIVE"===e.status}));if(t)return n.setState({runtimeSchemaId:t.id}),n._runtimeSchemaService.getObjectTypesDeep(i,t.id).then((function(e){var a=e.data;return(0,v.reducePromises)((0,p.getValidObjectTypesForWizardReactToEvent)(a).map((function(e){return n._runtimeSchemaService.getFields(i,t.id,e.id).then((function(t){var n=t.data;return{objectType:e,validFields:(0,p.getValidFieldsForWizardReactToEvent)(e,n)}}))}))).then((function(e){var r=p.wizardValidObjectTypes.find((function(t){return!!e.find((function(e){return e.objectType.name===t.objectTypeName&&!!e.validFields.find((function(e){return e.name===t.fieldName}))}))}));if(r){var o=a.find((function(e){return"UserPoint"===e.name}));return o?n._runtimeSchemaService.getFields(i,t.id,o.id).then((function(e){var t=e.data.find((function(e){return e.field_type.match(/\w+/)[0]===r.objectTypeName}));if(t)return n.setState({objectType:o,objectTypes:a}),Object.assign(Object.assign({},r),{objectTypeQueryName:t?t.name:void 0})})):void 0}}))}))})).catch((function(e){t(e)}))},n.onEventsChange=function(e,t,a){var r=n.props.formValues.query_text,o=n.state,i=o.formMode,s=o.validObjectType;if(s&&s.objectTypeQueryName){var l=JSON.parse(r),c=l.where;if(c&&(0,g.isObjectNode)(c)){var d=c.expressions.filter((function(e){return!(0,g.isFieldNode)(e)||e.field!==s.fieldName}));(c={boolean_operator:"AND",field:s.objectTypeQueryName,type:"OBJECT",expressions:d}).expressions.push({type:"FIELD",field:s.fieldName,comparison:{type:"STRING",operator:"EQ",values:t}}),l.where=c;var f=JSON.stringify(l);"REACT_TO_EVENT_STANDARD"===i?n.setState({standardEventsQueryText:f}):n.setState({advancedQueryText:f}),n.props.dispatch&&n.props.dispatch((0,u.change)(T,"query_text",f))}}},n.onBooleanOperatorChange=function(){var e=n.state.booleanOperator;n.setState({booleanOperator:"AND"===e?"OR":"AND"})},n.getSelectedObjectType=function(){var e=n.state,t=e.objectTypes,a=e.validObjectType;if(a)return t.find((function(e){return e.name===a.objectTypeName}))},n.getQueryableFields=function(){var e=n.state,t=e.objectTypes,a=e.validObjectType,r=n.getSelectedObjectType();if(r&&a)return r.fields.filter((function(e){return!t.find((function(t){var n=e.field_type.match(/\w+/);return!(!n||n[0]!==t.name)}))&&e.directives.find((function(e){return"TreeIndex"===e.name}))})).filter((function(e){return e.name!==a.fieldName}))};var a=n.props,r=a.storylineNodeModel,o=a.dispatch,i=r.node.formData,s=i.query_text,l=i.uiCreationMode;if(s&&o)o((0,u.change)(T,"query_text",s));else{o&&o((0,u.change)(T,"query_text",JSON.stringify({from:"UserPoint",operations:[{directives:[],selections:[{name:"id"}]}],where:{type:"OBJECT",expressions:[],field:"",boolean_operator:"AND"}})))}return o&&o((0,u.change)(T,"uiCreationMode",l)),n.state={formMode:"QUERY"===l?"REACT_TO_EVENT_STANDARD":l,isLoading:!0,objectTypes:[],standardEventNames:[],standardEventsQueryText:s||"",advancedQueryText:s||"",booleanOperator:"AND"},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.intl.formatMessage,r=t.storylineNodeModel,o=t.initialValues,i=r.node.formData,l=i.query_text,d=i.datamart_id;this._isMounted=!0,n&&n((0,u.change)(T,"query_language","JSON_OTQL")),this.getValidObjectType().then((function(t){if(t&&t.objectTypeQueryName){if(l){var r=JSON.parse(l),i=[],f=[];if(r.where&&(0,g.isObjectNode)(r.where)&&r.where.expressions){var m=r.where.expressions.filter((function(e){return!(0,g.isFieldNode)(e)||e.field===t.fieldName}));m.length>0&&(i=m[0].comparison.values),f=r.where.expressions.filter((function(e){return!(0,g.isFieldNode)(e)||e.field!==t.fieldName})).map((function(e){return Object.assign(Object.assign({},e),{key:(0,c.default)()})}))}n&&(n((0,u.change)(T,"events",i)),n((0,u.change)(T,"fieldNodeForm",f)),n((0,u.change)(T,"standardEventNames",p.predefinedEventNames.filter((function(e){return i.includes(e)})))))}e.setState({validObjectType:t});var y=d||o.datamart_id;return(0,p.getDatamartPredefinedEventNames)(y,t,e._queryService).then((function(t){e.setState({standardEventNames:t})}))}s.message.warning(a(C.schemaNotSuitableForAction))})).then((function(){return e.setState({isLoading:!1})}))}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,a=n.formValues,r=a.fieldNodeForm,o=a.query_text,i=n.dispatch,s=this.state,l=s.formMode,c=s.validObjectType;if(c&&o){var d=JSON.parse(o),f=d.where.expressions.filter((function(e){return!(0,g.isFieldNode)(e)||e.field===c.fieldName}));d.where.expressions=f,"REACT_TO_EVENT_ADVANCED"===l&&r.map((function(e){e.comparison&&e.comparison.values&&d.where.expressions.push({type:"FIELD",field:e.field,comparison:e.comparison})}));var p=JSON.stringify(d);o!==p&&i&&i((0,u.change)(T,"query_text",p))}}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this,t=this.props,n=t.intl.formatMessage,a=t.fieldValidators.isRequired,r=t.close,i=t.disabled,c=t.breadCrumbPaths,m=t.storylineNodeModel,g=t.initialValues,h=t.change,v=t.dispatch,b=this.state,_=b.formMode,M=b.isLoading,P=b.validObjectType,A=b.runtimeSchemaId,j=b.standardEventNames,R=b.advancedQueryText,N=b.standardEventsQueryText,k=b.booleanOperator,D=m.node,F=D.formData.datamart_id?D.formData.datamart_id:g.datamart_id,L={formId:T,paths:c,message:C.save,onClose:r,disabled:i||M},x=this.getSelectedObjectType();return o.default.createElement(s.Layout,{className:"mcs-reactToEventAutomation edit-layout"},o.default.createElement(S.default,L),o.default.createElement(s.Layout,{className:"ant-layout-content"},o.default.createElement(l.Form,{id:T,className:"mcs-reactToEventAutomation_form edit-layout mcs-content-container mcs-form-container",layout:"vertical"},o.default.createElement(f.FormSection,{title:C.reactToEventFormSectionTitle,subtitle:C.reactToEventFormSectionSubtitle}),o.default.createElement(f.FormSection,{title:C.reactToEventFormSectionConfigurationTitle,subtitle:C.reactToEventFormSectionConfigurationSubtitle}),o.default.createElement(s.Radio.Group,{className:"mcs-reactToEventAutomation_buttonSwitchMode",defaultValue:_,onChange:function(){"REACT_TO_EVENT_STANDARD"===_?e.setState({formMode:"REACT_TO_EVENT_ADVANCED"},(function(){v&&(v((0,u.change)(T,"uiCreationMode","REACT_TO_EVENT_ADVANCED")),N&&v((0,u.change)(T,"query_text",R)))})):e.setState({formMode:"REACT_TO_EVENT_STANDARD"},(function(){v&&(v((0,u.change)(T,"uiCreationMode","REACT_TO_EVENT_STANDARD")),N&&v((0,u.change)(T,"query_text",N)))}))},buttonStyle:"solid",disabled:M},o.default.createElement(s.Radio.Button,{value:"REACT_TO_EVENT_STANDARD"},n(C.standardEvents)),o.default.createElement(s.Radio.Button,{value:"REACT_TO_EVENT_ADVANCED"},n(C.advanced))),"REACT_TO_EVENT_STANDARD"===_?o.default.createElement("div",{className:"mcs-reactToEventAutomation_standardEventsForm"},M?o.default.createElement(y.Loading,{isFullScreen:!0}):j.length>0?o.default.createElement(f.FormCheckboxGroupField,{name:"standardEventNames",className:"mcs-reactToEventAutomation_standardEventsForm-options",component:f.FormCheckboxGroup,disabled:i,validate:a,onChange:this.onEventsChange,options:j.sort().map((function(e){return{label:n(C[e]),value:e}}))}):o.default.createElement(d.FormattedMessage,C.noStandardEvents)):o.default.createElement("div",{className:"mcs-reactToEventAutomation_advancedForm"},A&&x?o.default.createElement("div",null,o.default.createElement("div",{className:"mcs-reactToEventAutomation_chooseEventNameContainer"},o.default.createElement(E.FormSearchObjectField,{name:"events",component:O.default,onChange:this.onEventsChange,fetchListMethod:function(t){return(0,p.getEventsNames)(F,P,e._queryService)},fetchSingleMethod:function(e){return Promise.resolve({key:e,label:e,value:e})},formItemProps:{label:n(C.eventName),required:!0},small:!0,validate:a,selectProps:{mode:"tags",disabled:i},loadOnlyOnce:!0})),o.default.createElement("hr",null),o.default.createElement(I,{name:"fieldNodeForm",component:w.default,objectType:x,availableFields:this.getQueryableFields(),formChange:h,booleanOperator:k,datamartId:F,runtimeSchemaId:A,formName:T,title:C.propertyFilterSectionTitle,subtitle:C.propertyFilterSectionSubtitle,disabled:i,onBooleanOperatorChange:this.onBooleanOperatorChange})):o.default.createElement(y.Loading,{isFullScreen:!0})))))}}]),t}(o.default.Component);P([(0,_.lazyInject)(b.TYPES.IQueryService)],A.prototype,"_queryService",void 0),P([(0,_.lazyInject)(b.TYPES.IRuntimeSchemaService)],A.prototype,"_runtimeSchemaService",void 0);t.default=(0,i.compose)(d.injectIntl,f.withValidators,h.default,(0,m.connect)((function(e){return{formValues:(0,u.getFormValues)(T)(e)}})),(0,u.reduxForm)({form:T,enableReinitialize:!0}))(A);var C=(0,d.defineMessages)({save:{id:"automation.builder.node.reactToEventForm.save.button",defaultMessage:"Update"},reactToEventFormSectionTitle:{id:"automation.builder.node.reactToEventForm.event.title",defaultMessage:"Description"},reactToEventFormSectionSubtitle:{id:"automation.builder.node.reactToEventForm.event.subtitle",defaultMessage:"This is the starting point for your automation."},reactToEventFormSectionConfigurationTitle:{id:"automation.builder.node.reactToEventForm.event.configuration.title",defaultMessage:"Configuration"},reactToEventFormSectionConfigurationSubtitle:{id:"automation.builder.node.reactToEventForm.event.configuration.subtitle",defaultMessage:"Define which events will cause a user to enter this automation. Standard events will appear if you've used mediarithmics predefined event names in your integration. Otherwise, use the advanced tab."},standardEvents:{id:"automation.builder.node.reactToEventForm.formMode.standardEvents",defaultMessage:"STANDARD EVENTS"},advanced:{id:"automation.builder.node.reactToEventForm.formMode.advanced",defaultMessage:"ADVANCED"},propertyFilterSectionTitle:{id:"automation.builder.node.reactToEventForm.propertyFilter.title",defaultMessage:"Event property filters"},propertyFilterSectionSubtitle:{id:"automation.builder.node.reactToEventForm.propertyFilter.subtitle",defaultMessage:"Filter Events based on Properties"},eventName:{id:"automation.builder.node.reactToEventForm.eventName",defaultMessage:"Event names"},schemaNotSuitableForAction:{id:"automation.builder.node.reactToEventForm.schemaNotSuitableForAction",defaultMessage:"Schema is not suitable for this action."},noStandardEvents:{id:"automation.builder.node.reactToEventForm.standardEventsForm.noStandardEvents",defaultMessage:'You have no standard events in your datamart. For more options, please switch to the "Advanced" mode above.'},$home_view:{id:"automation.builder.node.reactToEventForm.standardEventsForm.predefinedMessage.homeView",defaultMessage:"When the user views the site home page"},$item_list_view:{id:"automation.builder.node.reactToEventForm.standardEventsForm.predefinedMessage.itemListView",defaultMessage:"When the user views a list of products in a category page or in a search results page"},$item_view:{id:"automation.builder.node.reactToEventForm.standardEventsForm.predefinedMessage.itemView",defaultMessage:"When the user views a product page"},$basket_view:{id:"automation.builder.node.reactToEventForm.standardEventsForm.predefinedMessage.basketView",defaultMessage:"When the user views the basket page"},$transaction_confirmed:{id:"automation.builder.node.reactToEventForm.standardEventsForm.predefinedMessage.transactionConfirmed",defaultMessage:"When the user views the transaction confirmation page"},$conversion:{id:"automation.builder.node.reactToEventForm.standardEventsForm.predefinedMessage.conversion",defaultMessage:"When the user has completed a Goal"},$ad_click:{id:"automation.builder.node.reactToEventForm.standardEventsForm.predefinedMessage.adClick",defaultMessage:"When the user clicked on an Ad"},$ad_view:{id:"automation.builder.node.reactToEventForm.standardEventsForm.predefinedMessage.adView",defaultMessage:"When the user views an Ad"},$email_click:{id:"automation.builder.node.reactToEventForm.standardEventsForm.predefinedMessage.emailClick",defaultMessage:"When the user clicks in an Email"},$email_view:{id:"automation.builder.node.reactToEventForm.standardEventsForm.predefinedMessage.emailView",defaultMessage:"When the user opened an Email"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFieldNode=function(e){return"FIELD"===e.type},t.isObjectNode=function(e){return"OBJECT"===e.type},t.isGroupNode=function(e){return"GROUP"===e.type}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(35),o=n(113),i=n(6),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),l=n(25),c=n(8),u=n(10),d=n(77),f=m(n(60)),p=m(n(2290));function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=u.Layout.Content,v=(0,i.defineMessages)({save:{id:"automation.builder.node.onSegmentEntryInputForm.save.button",defaultMessage:"Update"},sectionGeneralTitle:{id:"automation.builder.node.onSegmentEntryInputForm.general.title",defaultMessage:"General Information"}}),b=function(e){function t(){g(this,t);var e=y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFormSections=function(){var t=e.props.disabled,n=[],a={id:"OnSegmentEntryInputSectionId",title:v.sectionGeneralTitle,component:s.createElement(p.default,{initialValues:e.props.initialValues,disabled:t})};return n.push(a),n},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.close,r=e.disabled,i={formId:o.FORM_ID,paths:t,message:v.save,onClose:a,disabled:r},l=this.buildFormSections(),c=l.map((function(e,t){return s.createElement("div",{key:e.id},s.createElement("div",{key:e.id,id:e.id},e.component),t!==l.length-1&&s.createElement("hr",null))}));return s.createElement(u.Layout,{className:"edit-layout"},s.createElement(f.default,i),s.createElement(u.Layout,{className:"ant-layout-has-sider"},s.createElement(d.Form,{className:"edit-layout ant-layout",onSubmit:n,layout:"vertical"},s.createElement(h,{id:o.FORM_ID,className:"mcs-content-container mcs-form-container automation-form"},c))))}}]),t}(s.Component);t.default=(0,c.compose)(i.injectIntl,(0,l.connect)((function(e){return{formValues:(0,r.getFormValues)(o.FORM_ID)(e)}})),(0,r.reduxForm)({form:o.FORM_ID,enableReinitialize:!0}))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(6),l=n(12),c=n(15),u=n(8),d=v(n(63)),f=n(24),p=n(311),m=v(n(343)),g=n(163),y=n(13),h=v(n(23));function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchListMethod=function(e){var t=n.props,r=t.match.params.organisationId,o=t.initialValues.datamartId,s=t.notifyError;return Promise.all([n._audienceSegmentService.getSegments(r,{keywords:e,type:["USER_QUERY"],persisted:!0,datamart_id:o}),n._audienceSegmentService.getSegments(r,{keywords:e,type:["USER_LIST"],feed_type:"FILE_IMPORT",persisted:!0,datamart_id:o})]).then((function(e){var t=a(e,2),n=t[0].data,r=t[1].data;return n.concat(r).map((function(e){return{key:e.id,label:i.createElement(g.SegmentNameDisplay,{audienceSegmentResource:e}),value:e.id}}))})).catch((function(e){return s(e),[]}))},n.fetchSingleMethod=function(e){return n._audienceSegmentService.getSegment(e).then((function(e){var t=e.data;return{key:t.id,label:i.createElement(g.SegmentNameDisplay,{audienceSegmentResource:t}),value:t.id}})).catch((function(e){throw n.props.notifyError(e),e}))},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage,a=e.disabled;return i.createElement("div",null,i.createElement(f.FormSection,{subtitle:S.sectionGeneralSubtitle,title:S.sectionGeneralTitle}),i.createElement(f.FormSection,{title:S.configurationTitle}),i.createElement(p.FormSearchObjectField,{name:"segmentId",component:m.default,validate:[t],formItemProps:{label:n(S.segmentEntryInputNameTitle),required:!0},fetchListMethod:this.fetchListMethod,fetchSingleMethod:this.fetchSingleMethod,selectProps:{disabled:!!a,mode:void 0,showSearch:!0},type:"Audience",small:!0}))}}]),t}(i.Component);b([(0,c.lazyInject)(l.TYPES.IAudienceSegmentService)],_.prototype,"_audienceSegmentService",void 0),t.default=(0,u.compose)(s.injectIntl,h.default,f.withValidators,d.default,y.withRouter)(_);var S=t.messages=(0,s.defineMessages)({sectionGeneralTitle:{id:"automation.builder.node.onSegmentEntryInputForm.generalInfoSection.title",defaultMessage:"Description"},sectionGeneralSubtitle:{id:"automation.builder.node.onSegmentEntryInputForm.general.subtitle",defaultMessage:"This is the starting point for your automation."},configurationTitle:{id:"automation.builder.node.onSegmentEntryInputForm.generalInfoSection.configuration.title",defaultMessage:"Configuration"},segmentEntryInputNameTitle:{id:"automation.builder.node.onSegmentEntryInputForm.name.title",defaultMessage:"Users will enter this automation when they enter this segment"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(35),o=n(113),i=n(6),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),l=n(25),c=n(8),u=n(10),d=n(77),f=m(n(60)),p=m(n(2292));function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=u.Layout.Content,v=(0,i.defineMessages)({save:{id:"automation.builder.node.onSegmentExitInputForm.save.button",defaultMessage:"Update"},sectionGeneralTitle:{id:"automation.builder.node.onSegmentExitInputForm.general.title",defaultMessage:"General Information"}}),b=function(e){function t(){g(this,t);var e=y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFormSections=function(){var t=e.props.disabled,n=[],a={id:"OnSegmentExitInputSectionId",title:v.sectionGeneralTitle,component:s.createElement(p.default,{initialValues:e.props.initialValues,disabled:t})};return n.push(a),n},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.close,r=e.disabled,i={formId:o.FORM_ID,paths:t,message:v.save,onClose:a,disabled:r},l=this.buildFormSections(),c=l.map((function(e,t){return s.createElement("div",{key:e.id},s.createElement("div",{key:e.id,id:e.id},e.component),t!==l.length-1&&s.createElement("hr",null))}));return s.createElement(u.Layout,{className:"edit-layout"},s.createElement(f.default,i),s.createElement(u.Layout,{className:"ant-layout-has-sider"},s.createElement(d.Form,{className:"edit-layout ant-layout",onSubmit:n,layout:"vertical"},s.createElement(h,{id:o.FORM_ID,className:"mcs-content-container mcs-form-container automation-form"},c))))}}]),t}(s.Component);t.default=(0,c.compose)(i.injectIntl,(0,l.connect)((function(e){return{formValues:(0,r.getFormValues)(o.FORM_ID)(e)}})),(0,r.reduxForm)({form:o.FORM_ID,enableReinitialize:!0}))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(12),l=n(15),c=n(8),u=h(n(63)),d=n(24),f=n(311),p=n(163),m=n(13),g=h(n(23)),y=h(n(2293));function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchListMethod=function(e,t,a){var r=n.props,i=r.match.params.organisationId,s=r.initialValues.datamartId,l=r.notifyError;return n._audienceSegmentService.getSegments(i,{keywords:e,type:["USER_QUERY"],persisted:!0,datamart_id:s,first_result:t,max_results:a}).then((function(e){return e.data.map((function(e){return{key:e.id,label:o.createElement(p.SegmentNameDisplay,{audienceSegmentResource:e}),value:e.id}}))})).catch((function(e){return l(e),[]}))},n.fetchSingleMethod=function(e){return n._audienceSegmentService.getSegment(e).then((function(e){var t=e.data;return{key:t.id,label:o.createElement(p.SegmentNameDisplay,{audienceSegmentResource:t}),value:t.id}})).catch((function(e){throw n.props.notifyError(e),e}))},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage,a=e.disabled;return o.createElement("div",null,o.createElement(d.FormSection,{subtitle:_.sectionGeneralSubtitle,title:_.sectionGeneralTitle}),o.createElement(d.FormSection,{title:_.configurationTitle}),o.createElement(f.FormInfiniteSearchObjectField,{name:"segmentId",component:y.default,validate:[t],formItemProps:{label:n(_.segmentExitInputNameTitle),required:!0},fetchListMethod:this.fetchListMethod,fetchSingleMethod:this.fetchSingleMethod,selectProps:{disabled:!!a,mode:"multiple",showSearch:!0},type:"Audience",small:!0}))}}]),t}(o.Component);v([(0,l.lazyInject)(s.TYPES.IAudienceSegmentService)],b.prototype,"_audienceSegmentService",void 0),t.default=(0,c.compose)(i.injectIntl,g.default,d.withValidators,u.default,m.withRouter)(b);var _=t.messages=(0,i.defineMessages)({sectionGeneralTitle:{id:"automation.builder.node.onSegmentExitInputForm.generalInfoSection.title",defaultMessage:"Description"},sectionGeneralSubtitle:{id:"automation.builder.node.onSegmentExitInputForm.general.subtitle",defaultMessage:"This is the starting point for your automation."},configurationTitle:{id:"automation.builder.node.onSegmentExitInputForm.generalInfoSection.configuration.title",defaultMessage:"Configuration"},segmentExitInputNameTitle:{id:"automation.builder.node.onSegmentExitInputForm.name.title",defaultMessage:"Users will enter this automation when they leave this segment."}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(54),c=n(84),u=(a=c)&&a.__esModule?a:{default:a};var d=s.Select.Option,f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.debounce=l.debounce,n.fetchInitialData=function(e){var t=n.props,a=t.fetchSingleMethod,r=t.selectProps;if(n.setState({initialFetch:!0}),r&&"multiple"===r.mode||"string"==typeof e){var o=e;if(!o)return void n.setState({initialFetch:!1});a(o).then((function(e){n.setState({value:[e],initialFetch:!1})}))}else{var i=e;Promise.all(i.map((function(e){return a(e)}))).then((function(e){n.setState({value:e,initialFetch:!1})}))}},n.fetchData=function(e){var t=n.props.fetchListMethod,a=n.state,r=a.data,o=e!==a.currentValue;n.setState({fetching:!0,currentValue:e}),t(e,o?0:r.length,30).then((function(e){n.setState({data:o?e:r.concat(e),fetching:!1},(function(){n.filterData()}))}))},n.handleChange=function(e){var t=n.props,a=t.input,r=t.selectProps;if(r&&"multiple"===r.mode){var o=e;n.setState({value:[o]},(function(){n.fetchData("")})),a.onChange(o.key)}else{var i=e;n.setState({value:i},(function(){n.fetchData("")})),a.onChange(i.map((function(e){return e.key})))}},n.onSearch=function(e){n.setState({currentValue:e}),n.debounce(n.filterData,300,{leading:!1,trailing:!0})()},n.filterData=function(){var e=n.state.currentValue;if(n.props.shouldFilterData){var t=n.state.data.filter((function(t){var n;return null===(n=t.key)||void 0===n?void 0:n.toLocaleLowerCase().startsWith(e)})).slice(0,100);n.setState({filteredData:t})}else n.setState({filteredData:n.state.data})},n.onInputKeyDown=function(){var e=n.props.input,t=n.state,a=t.value,r=t.currentValue,o=[];a&&(o=o.concat(a));var i=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(o.map((function(e){return e.key}))));r&&i.push(r),e.onChange(i)},n.onPopupScroll=function(e){var t=n.state.currentValue,a=e.target;a.scrollTop+a.offsetHeight===a.scrollHeight&&n.fetchData(t||"")},n.state={data:[],filteredData:[],fetching:!1,currentValue:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentDidMount",value:function(){var e=this.props.input;this.fetchInitialData(e.value),this.fetchData("")}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,a=n.type,r=n.input;a!==e.type&&(this.fetchInitialData(r.value),this.fetchData(""))}},{key:"render",value:function(){var e=this.props,t=e.meta,n=e.formItemProps,a=e.helpToolTipProps,o=e.small,l=e.selectProps,c=e.loadOnlyOnce,f=this.state,p=f.filteredData,m=f.fetching,g="success";t.touched&&t.invalid&&(g="error"),t.touched&&t.warning&&(g="warning");var y=p.map((function(e){return i.createElement(d,{key:e.key,value:e.key||""},e.label)}));return i.createElement(u.default,r({help:t.touched&&(t.warning||t.error),helpToolTipProps:a,validateStatus:g,small:o},n),i.createElement(s.Spin,{spinning:this.state.initialFetch},i.createElement(s.Select,r({mode:"multiple",labelInValue:!0,value:this.state.value,placeholder:"Search",defaultActiveFirstOption:!0,filterOption:!1,onSearch:c?this.onSearch:this.fetchData,onInputKeyDown:c?this.onInputKeyDown:void 0,onChange:this.handleChange,notFoundContent:m?i.createElement(s.Spin,{size:"small"}):null,style:{width:"100%"},onPopupScroll:this.onPopupScroll,loading:m},l),y)))}}]),t}(i.Component);f.defaultprops={formItemProps:{},inputProps:{},helpToolTipProps:{}},t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(25),l=n(13),c=n(8),u=n(35),d=n(113),f=n(10),p=n(77),m=n(109),g=S(n(832)),y=S(n(2295)),h=S(n(2296)),v=n(15),b=n(12),_=S(n(23));function S(e){return e&&e.__esModule?e:{default:e}}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=f.Layout.Content,w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getExtendedPluginVersionsWithLayouts=function(e){var t=n.props,a=t.notifyError,r=t.dispatch;return n._pluginService.getPlugins({organisation_id:+e,plugin_type:"SCENARIO_CUSTOM_ACTION"}).then((function(e){var t=e.data.map((function(e){var t=e.id,o=e.current_version_id,i=o?n._pluginService.getLocalizedPluginLayout(t,o):Promise.resolve(null),s=o?n._pluginService.getPluginVersionProperties(t,o).then((function(e){return e.data})).catch((function(e){return a(e),null})):Promise.resolve(null);return Promise.all([i,s]).then((function(t){var n=t[0],a=t[1];return r&&r((0,u.change)(d.FORM_ID,"pluginVersionProperties",a)),{plugin:e,pluginLayout:null!==n?n:void 0,pluginProperties:null!==a?a:void 0}}))}));return Promise.all(t).then((function(e){return e.filter((function(e){return e.plugin.current_version_id}))}))})).catch((function(e){return a(e),[]}))},n.buildFormSections=function(e){var t,a=n.props.match.params.organisationId,r=n.state.extendedPluginsInformation,i=[],s={id:"generalSection",title:g.default.sectionGeneralTitle,component:o.createElement(y.default,{initialValues:n.props.initialValues,organisationId:a,disabled:e,extendedPluginsInformation:r})};i.push(s);var l=null===(t=n.props.formValues)||void 0===t?void 0:t.pluginId;if(l){var c={id:"pluginInstance",title:g.default.sectionPluginSettingsTitle,component:o.createElement(h.default,{pluginId:l,extendedPluginsInformation:r,organisationId:a,disabled:e})};i.push(c)}return i},n.state={extendedPluginsInformation:[],fetchingPluginVersions:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.initialValues;if(a.pluginId&&a.pluginResource){var r={plugin:a.pluginResource,pluginLayout:a.pluginLayout,pluginProperties:a.pluginVersionProperties};this.setState({extendedPluginsInformation:[r],fetchingPluginVersions:!1})}else this.setState({fetchingPluginVersions:!0},(function(){e.getExtendedPluginVersionsWithLayouts(n).then((function(t){e.setState({extendedPluginsInformation:t,fetchingPluginVersions:!1})}))}))}},{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.close,r=e.disabled,i=e.initialValues.pluginResource,s=this.state.fetchingPluginVersions,l=r||void 0!==i,c={formId:d.FORM_ID,paths:t,message:g.default.save,onClose:a,disabled:l},u=this.buildFormSections(l),y=u.map((function(e,t){return o.createElement("div",{key:e.id},o.createElement("div",{key:e.id,id:e.id},e.component),t!==u.length-1&&o.createElement("hr",null))})),h=s?o.createElement(f.Spin,null):y;return o.createElement(f.Layout,{className:"edit-layout"},o.createElement(m.FormLayoutActionbar,c),o.createElement(f.Layout,{className:"ant-layout-has-sider"},o.createElement(p.Form,{className:"edit-layout ant-layout",onSubmit:n,layout:"vertical"},o.createElement(O,{id:d.FORM_ID,className:"mcs-content-container mcs-form-container automation-form"},h))))}}]),t}(o.Component);E([(0,v.lazyInject)(b.TYPES.IPluginService)],w.prototype,"_pluginService",void 0);t.default=(0,c.compose)(i.injectIntl,l.withRouter,_.default,(0,s.connect)((function(e){return{formValues:(0,u.getFormValues)(d.FORM_ID)(e)}})),(0,u.reduxForm)({form:d.FORM_ID,enableReinitialize:!0}))(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=u(n(49)),s=u(n(832)),l=n(24),c=n(8);function u(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=function(e){function t(){return d(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage,a=e.disabled,o=e.extendedPluginsInformation.map((function(e){var t;return{value:e.plugin.id,title:(null===(t=e.pluginLayout)||void 0===t?void 0:t.metadata.display_name)||e.plugin.name||e.plugin.artifact_id}}));return r.createElement("div",null,r.createElement(l.FormSection,{title:s.default.sectionGeneralTitle}),r.createElement("div",null,r.createElement(l.FormInputField,{name:"name",component:l.FormInput,validate:[t],formItemProps:{label:n(s.default.customActionNameTitle),required:!0},inputProps:{placeholder:n(s.default.customActionNamePlaceholder),disabled:!!a},small:!0}),r.createElement(l.FormSelectField,{name:"pluginId",component:l.DefaultSelect,validate:[t],formItemProps:{label:n(s.default.pluginVersionLabel),required:!0},options:o,small:!0,disabled:!!a})))}}]),t}(r.Component);t.default=(0,c.compose)(o.injectIntl,i.default)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(8),s=n(24),l=n(628),c=d(n(421)),u=d(n(832));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){f(this,t);var e=p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.displayPluginInstanceFormSection=function(e){return r.createElement("div",null,r.createElement(s.FormSection,{title:u.default.sectionPluginSettingsTitle}),e)},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.pluginId,n=e.organisationId,a=e.extendedPluginsInformation,i=e.disabled;if(t){var s=a.find((function(e){return e.plugin.id===t}));if(s){var d=s.pluginProperties||[],f=s.pluginLayout,p=s.plugin.current_version_id;if(p){if(f){var m=f.sections.map((function(e,t){var a=t!==f.sections.length-1,o=null!==e.fields&&0!==e.fields.length,s=null!==e.advanced_fields&&0!==e.advanced_fields.length,l=a&&(o||s);return r.createElement("div",{key:e.title},r.createElement(c.default,{pluginLayoutSection:e,organisationId:n,pluginProperties:d,disableFields:i,pluginVersionId:p,small:!0}),l?r.createElement("hr",null):null)}));return this.displayPluginInstanceFormSection(r.createElement("div",null,m))}var g=d.map((function(e){return r.createElement(l.PluginFieldGenerator,{key:""+e.technical_name,definition:e,disabled:i,pluginVersionId:p,organisationId:n})}));return this.displayPluginInstanceFormSection(r.createElement("div",null,g))}}}return r.createElement("div",null,r.createElement(o.FormattedMessage,u.default.noInformationOnPlugin))}}]),t}(r.Component);t.default=(0,i.compose)(o.injectIntl)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(6),l=n(833),c=n(61),u=n(24),d=n(24),f=y(d),p=n(35),m=y(n(2320)),g=y(n(2321));function y(e){return e&&e.__esModule?e:{default:e}}var h=f.default.DefaultSelect,v=f.default.TagSelect,b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.technicalNameToName=function(e){return e.split("_").map((function(e){return""+e.charAt(0).toUpperCase()+e.slice(1)})).join(" ")},n.renderFieldBasedOnConfig=function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},u=n.props.disabled,d={formItemProps:{label:n.technicalNameToName(r.technical_name)},inputProps:Object.assign({placeholder:n.technicalNameToName(r.technical_name),disabled:!r.writable||u,defaultValue:r.value.value},l),buttonText:l.buttonText?l.buttonText:void 0,accept:l.accept?l.accept:void 0,options:c,helpToolTipProps:{},noUploadModal:l.noUploadModal?l.noUploadModal:void 0,openNextDrawer:n.props.openNextDrawer,closeNextDrawer:n.props.closeNextDrawer,small:n.props.small};return o.createElement("div",null,o.createElement(p.Field,a({key:"properties."+t,name:"properties."+t,component:e,validate:i,warn:s},d)))},n.handleFieldDefinition=function(e){var t=n.props,a=t.fieldValidators,r=a.isValidInteger,i=a.isValidDouble,s=t.organisationId;switch(e.property_type){case"STRING":return n.renderFieldBasedOnConfig(u.FormInput,e.technical_name+".value.value",e);case"URL":return n.renderFieldBasedOnConfig(u.FormInput,e.technical_name+".value.url",e);case"ASSET":case"ASSET_FILE":return n.renderFieldBasedOnConfig(u.FormUpload,e.technical_name+".value",e,[],[],{disabled:n.props.disabled,buttonText:"Upload File",accept:".jpg,.jpeg,.png,.gif,.svg",noUploadModal:n.props.noUploadModal});case"ASSET_FOLDER":return n.renderFieldBasedOnConfig(u.FormUpload,e.technical_name+".value",e,[],[],{disabled:n.props.disabled,buttonText:"Upload File",accept:".zip",noUploadModal:n.props.noUploadModal});case"PIXEL_TAG":return n.renderFieldBasedOnConfig(u.FormInput,e.technical_name+".value.value",e,[],[],{rows:4},{textArea:!0});case"STYLE_SHEET":return n.renderFieldBasedOnConfig(m.default,e.technical_name+".value",e,[],[],{},{disabled:n.props.disabled,pluginVersionId:n.props.pluginVersionId,organisationId:s});case"AD_LAYOUT":return n.renderFieldBasedOnConfig(g.default,e.technical_name+".value",e,[],[],{},{disabled:n.props.disabled,pluginVersionId:n.props.pluginVersionId,organisationId:s});case"BOOLEAN":return n.renderFieldBasedOnConfig(u.FormBoolean,e.technical_name+".value.value",e);case"LONG":return n.renderFieldBasedOnConfig(u.FormInput,e.technical_name+".value.value",e,[i]);case"INT":return n.renderFieldBasedOnConfig(u.FormInput,e.technical_name+".value.value",e,[r]);case"DOUBLE":return n.renderFieldBasedOnConfig(u.FormInput,e.technical_name+".value.value",e,[i]);case"DATA_FILE":return n.renderFieldBasedOnConfig(l.FormDataFile,e.technical_name+".value",e,[],[],{buttonText:"Upload File",accept:e.value.acceptedFile?e.value.acceptedFile:"*"});case"MODEL_ID":return o.createElement("div",null,"MODEL_ID");case"DATAMART_ID":return o.createElement("div",null,"DATAMART_ID");case"RECOMMENDER":return o.createElement("div",null,"RECOMMENDER_ID");case"NATIVE_DATA":return n.renderFieldBasedOnConfig(u.FormInput,e.technical_name+".value.value",e,n.getErrorValidatorForNativeFieldProperty(e.value.type),n.getWarningValidatorForNativeFieldProperty(e.value.type));case"NATIVE_TITLE":return n.renderFieldBasedOnConfig(u.FormInput,e.technical_name+".value.value",e);case"NATIVE_IMAGE":return n.renderFieldBasedOnConfig(u.FormUpload,e.technical_name+".value",e,[],[],{disabled:n.props.disabled,buttonText:"Upload File",accept:".jpg,.jpeg,.png,.gif,.svg",noUploadModal:n.props.noUploadModal});default:return o.createElement("div",null,"Please contact your support")}},n.generateFieldBasedOnDefinition=function(e,t){var r=n.props,i=r.pluginLayoutFieldDefinition,s=r.pluginPresetProperty,c=r.disabled,f=r.fieldValidators.isRequired,p=r.small,m=r.intl;if(void 0===i)return n.handleFieldDefinition(e);var g=!!s&&!!s.value.value||!e.writable||c,y={inputProps:{placeholder:n.technicalNameToName(i.property_technical_name),disabled:g},formItemProps:{label:i.label}};null!==i.tooltip&&(y.helpToolTipProps={title:i.tooltip}),null!==i.required&&!0===i.required&&(y.formItemProps.required=!0),p&&(y.small=p);var b=null!==i.tooltip?{helpToolTipProps:{title:i.tooltip}}:void 0;switch(i.field_type){case"TEXTAREA":var S=void 0!==i.max_length?{inputProps:{maxLength:i.max_length}}:void 0;return o.createElement(u.FormTextAreaField,a({formItemProps:y.formItemProps},S,b,{component:u.FormTextArea,inputProps:{disabled:g},validate:!0===y.formItemProps.required?[f]:void 0,name:"properties."+i.property_technical_name+".value.value",key:"properties."+i.property_technical_name,small:y.small}));case"URL":return o.createElement(u.FormInputField,a({},y,{component:u.FormInput,validate:!0===y.formItemProps.required?[f]:void 0,name:"properties."+i.property_technical_name+".value.url",key:"properties."+i.property_technical_name}));case"DATA_FILE":var E={buttonText:m.formatMessage(_.uploadFileDataFile),accept:e.value.acceptedFile};return o.createElement(l.FormDataFileField,a({key:"properties."+i.property_technical_name,name:"properties."+i.property_technical_name+".value",validate:!0===y.formItemProps.required?[f]:void 0,component:l.FormDataFile,disabled:g},E,y));case"HTML":return o.createElement(u.FormCodeEditField,{key:"properties."+i.property_technical_name,name:"properties."+i.property_technical_name+".value.value",validate:!0===y.formItemProps.required?[f]:void 0,component:u.FormCodeEdit,formItemProps:y.formItemProps,inputProps:{mode:"html",height:"200px",showGutter:!1},disabled:g,helpToolTipProps:y.helpToolTipProps,small:y.small});case"NUMBER":return o.createElement(u.FormInputField,a({key:"properties."+i.property_technical_name,name:"properties."+i.property_technical_name+".value.value",validate:!0===y.formItemProps.required?[f]:void 0,component:u.FormInput},y,{inputProps:Object.assign(Object.assign({},y.inputProps),{type:"number"})}));case"SELECT":return o.createElement(d.DefaultSelectField,{key:"properties."+i.property_technical_name,name:"properties."+i.property_technical_name+".value.value",validate:!0===y.formItemProps.required?[f]:void 0,component:h,options:void 0!==i.enum?i.enum.map((function(e){return{value:e.value,title:e.label}})):[],disabled:g,formItemProps:y.formItemProps,helpToolTipProps:y.helpToolTipProps,small:y.small});case"MULTI_SELECT":return o.createElement(d.TagSelectField,{key:"properties."+i.property_technical_name,name:"properties."+i.property_technical_name+".value.value",validate:!0===y.formItemProps.required?[f]:void 0,component:v,selectProps:{options:void 0!==i.enum?i.enum:[]},disabled:g,formItemProps:y.formItemProps,helpToolTipProps:y.helpToolTipProps,valueAsString:!0,small:y.small});case"IMAGE":return o.createElement(u.FormUploadField,{key:"properties."+i.property_technical_name,name:"properties."+i.property_technical_name+".value",validate:!0===y.formItemProps.required?[f]:void 0,component:u.FormUpload,buttonText:m.formatMessage(_.uploadFileImage),noUploadModal:n.props.noUploadModal,formItemProps:y.formItemProps,disabled:g,helpToolTipProps:y.helpToolTipProps,small:y.small});case"INPUT":return o.createElement(u.FormInputField,a({key:"properties."+i.property_technical_name,name:"properties."+i.property_technical_name+".value.value",validate:!0===y.formItemProps.required?[f]:void 0,component:u.FormInput},y));case"INPUT_NUMBER":return o.createElement(u.FormInputField,a({key:"properties."+i.property_technical_name,name:"properties."+i.property_technical_name+".value.value",validate:!0===y.formItemProps.required?[f]:void 0,component:u.FormInput},y,{inputProps:Object.assign(Object.assign({},y.inputProps),{type:"number"})}));case"SWITCH":return o.createElement(u.FormFieldWrapper,a({help:y.formItemProps.help,helpToolTipProps:y.helpToolTipProps,validateStatus:y.formItemProps.validateStatus},y.formItemProps,{small:y.small}),o.createElement(u.FormSwitchField,a({key:"properties."+i.property_technical_name,name:"properties."+i.property_technical_name+".value.value",validate:!0===y.formItemProps.required?[f]:void 0,component:u.FormSwitch,disabled:g},y)));case"RADIO":var O=void 0!==i.enum?i.enum.map((function(e){return{id:e.value,value:e.value,title:e.label}})):[];return o.createElement(u.FormFieldWrapper,a({help:y.formItemProps.help,helpToolTipProps:y.helpToolTipProps,validateStatus:y.formItemProps.validateStatus},y.formItemProps,{small:y.small}),o.createElement(u.FormRadioGroupField,a({key:"properties."+i.property_technical_name,name:"properties."+i.property_technical_name+".value.value",validate:!0===y.formItemProps.required?[f]:void 0,component:u.FormRadioGroup,elements:O,disabled:g},y)));case"CHECKBOX":var w=void 0!==i.enum?i.enum:[];return o.createElement(u.FormFieldWrapper,a({help:y.formItemProps.help,helpToolTipProps:y.helpToolTipProps,validateStatus:y.formItemProps.validateStatus},y.formItemProps,{small:y.small}),o.createElement(u.FormCheckboxGroupField,a({key:"properties."+i.property_technical_name,name:"properties."+i.property_technical_name+".value.value",validate:!0===y.formItemProps.required?[f]:void 0,component:u.FormCheckboxGroup,options:w,valueAsString:!0,disabled:g},y)));case"DATE":return o.createElement(u.FormDatePickerField,a({key:"properties."+i.property_technical_name,name:"properties."+i.property_technical_name+".value.value",validate:!0===y.formItemProps.required?[f]:void 0,component:u.FormDatePicker,datePickerProps:{},isoDate:!0,disabled:g},y));case"DATE_RANGE":return o.createElement(u.FormDateRangePickerField,a({key:"properties."+i.property_technical_name,name:"properties."+i.property_technical_name+".value.value",validate:!0===y.formItemProps.required?[f]:void 0,component:u.FormDateRangePicker,startDatePickerProps:{},endDatePickerProps:{},disabled:g},y));default:return n.handleFieldDefinition(e)}},n.getErrorValidatorForNativeFieldProperty=function(e){var t=n.props.fieldValidators,a=t.isRequired,r=t.isValidInteger;switch(e){case 1:case 2:return[a];case 4:case 5:case 6:case 7:return[r];default:return[]}},n.getWarningValidatorForNativeFieldProperty=function(e){var t=n.props.fieldValidators,a=t.isCharLengthLessThan,r=t.isIntegerBetween;switch(e){case 1:return[a(25)];case 2:return[a(140)];case 3:return[r(0,5)];case 12:return[a(15)];default:return[]}},n.state={nativeDataType:1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.definition,n=e.organisationId;return t&&n&&this.generateFieldBasedOnDefinition(t,n)}}]),t}(o.Component);t.default=(0,i.compose)(u.withValidators,c.injectDrawer)(b);var _=(0,s.defineMessages)({uploadFileDataFile:{id:"pluginField-DataFile-uploadFile",defaultMessage:"Upload File"},uploadFileImage:{id:"pluginField-DataFile-image",defaultMessage:"Upload File"},uploadFileAsset:{id:"fieldDefinition-DataFile-asset",defaultMessage:"Upload File"},uploadFileDataFile2:{id:"fieldDefinition-DataFile-uploadFile",defaultMessage:"Upload File"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(6),c=n(8),u=v(n(2299)),d=n(11),f=n(24),p=v(n(834)),m=n(61),g=n(15),y=n(12),h=v(n(1104));function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchDataFileData=function(e){var t=n.props.input;n._dataFileService.getDatafileData(e).then((function(a){n.onFileUpdate(a).then((function(a){var r=n.parseFileName(e),o=n.parseFileName(e,!0),i=h.default.sanitize(a,{SAFE_FOR_TEMPLATES:!0,WHOLE_DOCUMENT:!0});n.setState({canEdit:!0,fileContent:i,fileName:r,basePath:o}),t.onChange({uri:e,fileContent:i,fileName:r})}))}))},n.parseFileName=function(e,t){var n=e.split("/");return t?(n.pop(),n.join("/")):n[n.length-1]},n.changeCanRemoveFile=function(e){n.setState({canRemoveFile:e})},n.changeFileName=function(e){n.setState({fileName:e})},n.onRemoveFile=function(){var e=n.props.input;n.changeFileName(""),e.onChange({}),n.setState({canEdit:!1})},n.onFileUpdate=function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(e){var n=e.target.result;return t(n)},a.readAsText(e,"UTF-8")}))},n.onDrawerClose=function(e,t){var a=n.props.input;t&&e&&(n.setState({fileContent:e,fileName:t,canEdit:!0}),n.state.basePath?a.onChange({fileContent:e,fileName:t,uri:n.state.basePath+"/"+t}):a.onChange({fileContent:e,fileName:t})),n.props.closeNextDrawer()},n.state={fileName:"",canRemoveFile:!1,canEdit:!1,fileContent:"",type:"",modalVisible:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this.props.input;e.value.uri?this.fetchDataFileData(e.value.uri):(e.onChange({}),this.changeCanRemoveFile(!0))}},{key:"render",value:function(){var e=this,t=this.props,n=t.meta,r=t.input,o=t.disabled,c=this.state.canEdit,m="success";n.touched&&n.invalid&&(m="error"),n.touched&&n.warning&&(m="warning");var g={onClick:function(){var t={additionalProps:{content:e.state.fileContent,type:e.state.type,fileName:e.state.fileName,close:e.onDrawerClose,accept:e.props.accept,openNextDrawer:e.props.openNextDrawer,closeNextDrawer:e.props.closeNextDrawer},isModal:!0};e.props.openNextDrawer(u.default,t)}},y={onClick:function(){s.Modal.confirm({title:"Do you want to delete this datafile",content:"If you delete an unsaved file you will loose all your work, are you sure you want to proceed?",okText:"Yes",cancelText:"No",onOk:function(){e.setState({fileContent:"",fileName:"",canEdit:!1}),r.onChange({})}})}};return i.createElement(f.FormFieldWrapper,a({help:this.props.meta.touched&&(this.props.meta.warning||this.props.meta.error),helpToolTipProps:this.props.helpToolTipProps,validateStatus:m},this.props.formItemProps,{small:this.props.small}),i.createElement(s.Col,{span:24},c?null:i.createElement("span",null,i.createElement(s.Button,{onClick:function(){var t={additionalProps:{content:e.state.fileContent,close:e.onDrawerClose,accept:e.props.accept,openNextDrawer:e.props.openNextDrawer,closeNextDrawer:e.props.closeNextDrawer},isModal:!0};e.props.openNextDrawer(u.default,t)},disabled:o},i.createElement(l.FormattedMessage,p.default.datafileFileSelect))),c?i.createElement("span",null,i.createElement("span",{className:"m-r-20"},this.state.fileName),i.createElement(d.Button,g,i.createElement(d.McsIcon,{type:"pen"})),i.createElement(d.Button,y,i.createElement(d.McsIcon,{type:"close"}))):null))}}]),t}(i.Component);b([(0,g.lazyInject)(y.TYPES.IDataFileService)],_.prototype,"_dataFileService",void 0),t.default=(0,c.compose)(m.injectDrawer)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(6),l=n(11),c=n(24),u=g(n(834)),d=n(2300),f=g(n(270));n(613),n(2302),n(2303),n(2304),n(2305),n(2306),n(2307),n(2308),n(2309),n(2310),n(2312),n(2313),n(2314),n(2315),n(2316),n(2317),n(2318),n(2319);var p=n(15),m=n(12);function g(e){return e&&e.__esModule?e:{default:e}}var y=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},h=i.Select.Option,v=i.Layout.Content,b=["javascript","java","python","xml","ruby","sass","markdown","mysql","json","html","handlebars","golang","csharp","elixir","typescript","css"],_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onChange=function(e){n.setState({updatedContent:e})},n.parseFileName=function(e,t){var n=e.split("/");return t?(n.pop(),n.join("/")):n[n.length-1]},n.defineMode=function(e){switch(e&&e.split(".").pop()){case"js":return"javascript";case"py":return"python";case"css":return"css";case"json":return"json";case"html":return"html";default:return"text"}},n.handleAdd=function(){n.props.close(n.state.updatedContent,n.state.fileName)},n.handleEditorChange=function(e){return n.setState({type:e})},n.onFileUpdate=function(e){var t=new FileReader;t.onload=function(e){var t=e.target.result;n.setState({updatedContent:t})},t.readAsText(e,"UTF-8")},n.changeFileName=function(e){n.setState({fileName:e})},n.state={updatedContent:e.content,type:n.defineMode(e.fileName),editMode:""!==e.content,fileName:e.fileName&&e.fileName?e.fileName:"",iframeHeight:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.state.editMode,n={action:"/",beforeUpload:function(t){return e.changeFileName(t.name),(new FormData).append("file",t,t.name),e.onFileUpdate(t),e.setState({editMode:!0,type:e.defineMode(t.name)}),!1}};"*"!==this.props.accept&&(n=Object.assign(Object.assign({},n),{accept:this.props.accept}));var a=o.createElement("div",{className:"text-center"},o.createElement("div",{className:"m-t-20 m-b-20"},o.createElement(c.FormTitle,{title:u.default.datafileDrawerUpload})),o.createElement(i.Upload,n,o.createElement(i.Button,null,o.createElement(s.FormattedMessage,u.default.datafileDrawerUpload))),o.createElement("div",{className:"m-t-20 m-b-20"},o.createElement(c.FormTitle,{title:u.default.datafileDrawerSelect})),o.createElement("div",null,o.createElement(i.Input,{style:{maxWidth:300},onChange:function(t){e.setState({fileSelectorValue:t.target.value})}})),o.createElement("div",{className:"m-t-20"},o.createElement(i.Button,{onClick:function(){var t=e.state.fileSelectorValue;t&&e._dataFileService.getDatafileData(t).then((function(n){e.onFileUpdate(n);var a=e.parseFileName(t);e.changeFileName(a),e.setState({editMode:!0,fileName:a,type:e.defineMode(a)})})).catch((function(e){}))}},o.createElement(s.FormattedMessage,u.default.datafileDrawerSelectOk)))),r=o.createElement(f.default,{mode:this.state.type,theme:"monokai",name:"blah2",onChange:this.onChange,fontSize:14,showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,value:this.state.updatedContent,setOptions:{enableBasicAutocompletion:!1,enableLiveAutocompletion:!1,enableSnippets:!1,showLineNumbers:!0,tabSize:2},width:"100%",wrapEnabled:!0}),p=o.createElement("div",null,o.createElement("div",{style:{marginBottom:20}},o.createElement(i.Select,{defaultValue:this.state.type,style:{width:120,float:"right"},onChange:this.handleEditorChange},b.map((function(e){return o.createElement(h,{key:e,value:e},e)}))),o.createElement(i.Input,{defaultValue:this.state.fileName,style:{width:"50%"},onChange:function(t){e.setState({fileName:t.target.value})}})),r),m=o.createElement(d.HtmlEditor,{onChange:this.onChange,content:this.state.updatedContent}),g="text/html"===this.props.accept?m:p;return o.createElement(i.Layout,null,o.createElement("div",{className:"edit-layout ant-layout"},o.createElement(l.Actionbar,{paths:[{name:"Add a Data File"}],edition:!0},o.createElement(i.Button,{type:"primary",className:"mcs-primary",onClick:this.handleAdd},o.createElement(l.McsIcon,{type:"plus"}),o.createElement("span",null,"Update")),o.createElement(l.McsIcon,{type:"close",className:"close-icon",style:{cursor:"pointer"},onClick:this.props.close})),o.createElement(i.Layout,null,o.createElement(v,{className:"mcs-table-edit-container"},t?g:a))))}}]),t}(o.Component);y([(0,p.lazyInject)(m.TYPES.IDataFileService)],_.prototype,"_dataFileService",void 0),t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HtmlEditor=void 0;var a,r=n(2301),o=(a=r)&&a.__esModule?a:{default:a};t.HtmlEditor=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(8),s=d(n(1102)),l=d(n(270));n(613);var c=n(61),u=n(11);function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.buildCodeInitialValues=function(){return{code:n.props.content}},n.onQuickContentChange=function(e){var t=document.createElement("div");t.innerHTML=n.props.content;for(var a=t.querySelectorAll("[data-mcs-type]"),r=0;r<=a.length-1;r+=1){if("image"===a[r].getAttribute("data-mcs-type"))a[r].src=e[a[r].getAttribute("data-mcs-name")||""];else if("link"===a[r].getAttribute("data-mcs-type")){var o=a[r];o.href=e[a[r].getAttribute("data-mcs-name")||""],o.target="_blank"}else"text"===a[r].getAttribute("data-mcs-type")&&(a[r].innerHTML=e[a[r].getAttribute("data-mcs-name")||""])}n.props.onChange(t.innerHTML)},n.onCodeContentChange=function(e){n.props.onChange(e)},n.state={size:"MEDIUM",type:"CODE"},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=r.createElement(s.default,{content:this.props.content}),n=r.createElement(l.default,{value:this.props.content,theme:"monokai",name:"code",width:"100%",height:"800px",mode:"handlebars",showPrintMargin:!1,showGutter:!0,highlightActiveLine:!0,setOptions:{enableBasicAutocompletion:!1,enableLiveAutocompletion:!1,enableSnippets:!1,showLineNumbers:!0,tabSize:2},onChange:this.onCodeContentChange,wrapEnabled:!0}),a="LARGE"===this.state.size?-4:"SMALL"===this.state.size?4:0;return r.createElement("div",null,r.createElement(o.Row,{style:{marginBottom:10}},r.createElement(o.Col,{span:12-a},r.createElement(o.Radio.Group,{onChange:function(t){return e.setState({type:t.target.value})},defaultValue:this.state.type},r.createElement(o.Radio.Button,{value:"CODE"},r.createElement(u.McsIcon,{type:"code"}),"Code"))),r.createElement(o.Col,{span:12+a,style:{textAlign:"right"}},r.createElement(o.Radio.Group,{onChange:function(t){return e.setState({size:t.target.value})},defaultValue:this.state.size},r.createElement(o.Radio.Button,{value:"SMALL"},"Large"),r.createElement(o.Radio.Button,{value:"MEDIUM"},"Medium"),r.createElement(o.Radio.Button,{value:"LARGE"},"Small")))),r.createElement(o.Row,{style:{maxHeight:800}},r.createElement(o.Col,{span:12-a,style:{overflowY:"CODE"===this.state.type?"initial":"scroll",maxHeight:800}},"CODE"===this.state.type&&n),r.createElement(o.Col,{span:12+a,style:{overflowY:"scroll",maxHeight:800}},t)))}}]),t}(r.Component);t.default=(0,i.compose)(c.injectDrawer)(f)},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(54),s=c(n(84)),l=c(n(1105));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.meta,n=e.formItemProps,r=e.helpToolTipProps,c=e.input,u=e.options,d="success";t.touched&&t.invalid&&(d="error"),t.touched&&t.warning&&(d="warning");var f=!(0,i.isEmpty)(r);return o.createElement(s.default,a({help:t.touched&&(t.warning||t.error),helpToolTipProps:f?r:void 0,validateStatus:d},n),o.createElement(l.default,{input:c,type:"stylesheet",options:u}))}}]),t}(o.Component);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(54),s=c(n(84)),l=c(n(1105));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.meta,n=e.formItemProps,r=e.helpToolTipProps,c=e.input,u=e.options,d="success";t.touched&&t.invalid&&(d="error"),t.touched&&t.warning&&(d="warning");var f=!(0,i.isEmpty)(r);return o.createElement(s.default,a({help:t.touched&&(t.warning||t.error),helpToolTipProps:f?r:void 0,validateStatus:d},n),o.createElement(l.default,{input:c,type:"formAdLayout",options:u}))}}]),t}(o.Component);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(113),i=n(35),s=n(6),l=n(25),c=n(8),u=n(10),d=n(77),f=n(109),p=g(n(2323)),m=g(n(1106));function g(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=u.Layout.Content,b=function(e){function t(){y(this,t);var e=h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFormSections=function(){var t,n,a=e.props,o=a.storylineNodeModel.node,i=a.disabled,s=[];if("SCENARIO_AUDIENCE_SEGMENT_FEED_NODE"===o.type&&o.strictlyLayoutablePlugin){var l=(null===(t=o.strictlyLayoutablePlugin)||void 0===t?void 0:t.disabled)?null===(n=o.strictlyLayoutablePlugin)||void 0===n?void 0:n.disabled:i,c=o.strictlyLayoutablePlugin,u=c.plugin_preset?c.plugin_preset.plugin_version_id:c.current_version_id;if(u){var d={id:"generalSection",title:m.default.sectionGeneralTitle,component:r.createElement(p.default,{strictlyLayoutablePlugin:c,pluginVersionId:u,disabled:l})};s.push(d)}}return s},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.close,i=e.disabled,s={formId:o.FORM_ID,paths:t,message:m.default.save,onClose:a,disabled:i},l=this.buildFormSections(),c=l.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==l.length-1&&r.createElement("hr",null))}));return r.createElement(u.Layout,{className:"edit-layout"},r.createElement(f.FormLayoutActionbar,s),r.createElement(u.Layout,{className:"ant-layout-has-sider"},r.createElement(d.Form,{id:o.FORM_ID,className:"edit-layout ant-layout",onSubmit:n,layout:"vertical"},r.createElement(v,{className:"mcs-content-container mcs-form-container automation-form"},c))))}}]),t}(r.Component);t.default=(0,c.compose)(s.injectIntl,(0,l.connect)((function(e){return{formValues:(0,i.getFormValues)(o.FORM_ID)(e)}})),(0,i.reduxForm)({form:o.FORM_ID,enableReinitialize:!0}))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(8),s=n(24),l=d(n(49)),c=d(n(421)),u=d(n(1106));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.strictlyLayoutablePlugin,n=e.pluginVersionId,a=e.disabled,o=e.intl.formatMessage,i=t.plugin_layout,l=t.plugin_preset,d=l?l.properties:[],f=t.plugin_version_properties,p=l?{label:o(u.default.nameFieldLabel),title:r.createElement("div",null,o(u.default.nameFieldTitle),r.createElement("br",null),r.createElement("b",null,o(u.default.nameFieldTitleWarning))),placeholder:o(u.default.nameFieldPlaceholder),display:!0,disabled:!0,value:l.name}:void 0,m=l?{label:o(u.default.descriptionFieldLabel),title:o(u.default.descriptionFieldTitle),placeholder:o(u.default.descriptionFieldPlaceholder),display:!0,disabled:!0,value:l.description}:void 0,g=i.sections.map((function(e,o){var s=o!==i.sections.length-1,l=null!==e.fields&&0!==e.fields.length,u=null!==e.advanced_fields&&0!==e.advanced_fields.length,g=s&&(l||u);return r.createElement("div",{key:e.title},r.createElement(c.default,{pluginLayoutSection:e,organisationId:t.organisation_id,pluginProperties:f,pluginPresetProperties:d,disableFields:a,nameField:0===o?p:void 0,descriptionField:0===o?m:void 0,pluginVersionId:n,small:!0}),g?r.createElement("hr",null):null)}));return r.createElement("div",null,r.createElement(s.FormSection,{title:u.default.descriptionFormSectionTitle,subtitle:u.default.descriptionFormSectionSubtitle}),g)}}]),t}(r.Component);t.default=(0,i.compose)(o.injectIntl,l.default)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(89),i=l(n(2325)),s=l(n(1107));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"simple"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"generateReactWidget",value:function(e,t){return r.createElement(i.default,{link:t,diagramEngine:e})}},{key:"getNewInstance",value:function(e){return new s.default}},{key:"generateLinkSegment",value:function(e,t,n,a){return r.createElement("path",{strokeWidth:e.width,stroke:e.color,d:a})}}]),t}(o.AbstractLinkFactory);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(89);var i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.refPaths=[],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"generateLabel",value:function(){var e=this;return this.props.link.labels.map((function(t){return r.createElement("foreignObject",{key:t.type,className:"link-label",width:"100%",height:"100%",style:{overflow:"visible"}},r.createElement("div",{ref:function(t){return e.refLabel=t}},t.type))}))}},{key:"updateLabelPosition",value:function(){null!==this.refLabel&&void 0!==this.refLabel&&this.refLabel.setAttribute("style","position: relative; top: "+(this.props.link.points[0].y-20)+"px; left: "+(this.props.link.points[0].x+10)+"px;")}},{key:"componentDidUpdate",value:function(){this.updateLabelPosition()}},{key:"componentDidMount",value:function(){this.updateLabelPosition()}},{key:"generateLink",value:function(e,t,n){var a=this,o=this.props,i=r.cloneElement(o.diagramEngine.getFactoryForLink(this.props.link).generateLinkSegment(this.props.link,this,!1,e),{ref:function(e){return e&&a.refPaths.push(e)}}),s=r.cloneElement(i,Object.assign(Object.assign({},t),{strokeLinecap:"round",onMouseLeave:function(){a.setState({selected:!1})},onMouseEnter:function(){a.setState({selected:!0})},ref:null,"data-linkid":this.props.link.getID(),strokeOpacity:0,strokeWidth:20,onContextMenu:function(){a.props.diagramEngine.isModelLocked(a.props.link)||(event.preventDefault(),a.props.link.remove())}}));return r.createElement("g",{key:"link-"+n},i,s)}},{key:"render",value:function(){for(var e=this.props.link.points,t=[],n=0;n<e.length-1;n++)t.push(this.generateLink(o.Toolkit.generateLinePath(e[n],e[n+1]),{"data-linkid":this.props.link.id,"data-point":n},n));return r.createElement("g",null,t,this.generateLabel())}}]),t}(r.Component);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(89),i=l(n(2327)),s=l(n(1108));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"drop-node"));return n.treeNodeOperations=e,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"generateReactWidget",value:function(e,t){return t.extras.collapsed?r.createElement("div",null):r.createElement(i.default,{node:t,diagramEngine:e,treeNodeOperations:this.treeNodeOperations})}},{key:"getNewInstance",value:function(e){return new s.default}}]),t}(o.AbstractNodeFactory);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=u(n(47)),i=u(n(2328)),s=n(8),l=u(n(1051)),c=u(n(69));function u(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.top=0,n.left=0,n.id=(0,o.default)(),n.setPosition=function(e){var t=e?e.getBoundingClientRect():null;n.top=t?t.top:0,n.left=t?t.left:0},n.state={hover:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.node,a=t.connectDropTarget,o=t.isDragging,s=t.isOver,l=t.colors,c=n.getColor(),u=n.getColor(),d=function(t){return function(){return e.setState({hover:"enter"===t})}};s&&o&&(c=l["mcs-info"],u=l["mcs-info"]);var f=o?1:0;return a&&a(r.createElement("div",{className:"drop-container"},r.createElement("div",{className:"drop-area",onMouseEnter:d("enter"),onMouseLeave:d("leave")},r.createElement("div",{className:"drop-node",onMouseEnter:d("enter"),onMouseLeave:d("leave"),style:{width:n.getNodeSize().width,height:n.getNodeSize().height,borderWidth:n.getNodeSize().borderWidth,borderColor:u,backgroundColor:c,opacity:f}}),r.createElement(i.default,{node:n}))))}}]),t}(r.Component);t.default=(0,s.compose)((0,l.default)((function(){return"automation-node"}),{drop:function(e,t){var n=t.getItem();e.treeNodeOperations.addNode(e.node.dropNode.parentNode.node.id,e.node.dropNode.outNode.node.id,n)}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop(),isDragging:t.getItemType()}})),c.default)(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(89);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){function t(){return i(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.node;return r.createElement("div",null,r.createElement("div",{style:{position:"absolute",top:50,left:10}},r.createElement(o.PortWidget,{name:"center",node:e})),r.createElement("div",{style:{position:"absolute",top:50,left:40}},r.createElement(o.PortWidget,{name:"right",node:e})))}}]),t}(r.Component);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(2330),c=(a=l)&&a.__esModule?a:{default:a},u=n(6),d=n(113),f=n(160),p=n(73),m=n(8),g=n(15),y=n(12),h=n(13);function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=s.Collapse.Panel,S=(0,u.defineMessages)({availableNodeTitle:{id:"automation.builder.availableNode.title",defaultMessage:"Automation Components"},availableNodeSubtitle:{id:"automation.builder.availableNode.subtitle",defaultMessage:"Drag and drop your components in the builder to create your automation."},actionsTitle:{id:"automation.builder.availableNode.actions.title",defaultMessage:"Actions"},flowControlTitle:{id:"automation.builder.availableNode.flowControl.title",defaultMessage:"Flow control"}}),E={id:(0,f.generateFakeId)(),type:"EMAIL_CAMPAIGN",scenario_id:"",campaign_id:"",formData:d.INITIAL_EMAIL_CAMPAIGN_NODE_FORM_DATA,initialFormData:d.INITIAL_EMAIL_CAMPAIGN_NODE_FORM_DATA},O={id:(0,f.generateFakeId)(),type:"ADD_TO_SEGMENT_NODE",user_list_segment_id:"",user_segment_expiration_period:"0",scenario_id:"",formData:d.INITIAL_ADD_TO_SEGMENT_NODE_FORM_DATA,initialFormData:d.INITIAL_ADD_TO_SEGMENT_NODE_FORM_DATA},w={id:(0,f.generateFakeId)(),type:"DELETE_FROM_SEGMENT_NODE",user_list_segment_id:"",scenario_id:"",formData:d.INITIAL_DELETE_FROM_SEGMENT_NODE_FORM_DATA,initialFormData:d.INITIAL_DELETE_FROM_SEGMENT_NODE_FORM_DATA},M={id:(0,f.generateFakeId)(),type:"CUSTOM_ACTION_NODE",scenario_id:"",formData:{name:""}},P={id:(0,f.generateFakeId)(),type:"ABN_NODE",scenario_id:"",edges_selection:{},branch_number:2,formData:{edges_selection:{},branch_number:2}},T={id:(0,f.generateFakeId)(),type:"WAIT_NODE",scenario_id:"",delay_period:"PT1H",formData:{wait_duration:{unit:"hours",value:"1"},day_window:["MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY","SUNDAY"]}},I={id:(0,f.generateFakeId)(),type:"IF_NODE",scenario_id:"",query_id:"",formData:{}},A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.getFeedPresetNodes=function(){var e=n.props.match.params.organisationId;if(n.props.hasFeature("automations-feed-nodes")){var t=["AUDIENCE_SEGMENT_EXTERNAL_FEED","AUDIENCE_SEGMENT_TAG_FEED"].reduce((function(t,a){var r=n._pluginService.getPluginPresets({organisation_id:+e,plugin_type:a}).then((function(e){return e.data})).catch((function(e){return[]}));return Promise.all([t,r]).then((function(e){return e[0].concat(e[1])}))}),Promise.resolve([])),a=t.then((function(e){var t=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(new Set(e.map((function(e){return e.plugin_version_id})))));return Promise.all(t.map((function(t){var a,r=null===(a=e.find((function(e){return e.plugin_version_id===t})))||void 0===a?void 0:a.plugin_id,o=r?n._pluginService.getLocalizedPluginLayout(r,t).then((function(e){return null!==e?e:void 0})):Promise.resolve(void 0),i=r?n._pluginService.getPluginVersion(r,t).then((function(e){return e.data})).catch((function(e){})):Promise.resolve(void 0),s=r?n._pluginService.getPluginVersionProperties(r,t).then((function(e){return e.data})).catch((function(e){})):Promise.resolve(void 0);return Promise.all([o,i,s]).then((function(e){return{pluginLayout:e[0],pluginVersion:e[1],pluginVersionProperties:e[2]}}))}))).then((function(e){return e.reduce((function(e,t){return t.pluginLayout&&t.pluginVersion&&t.pluginVersionProperties?e.concat([{pluginLayout:t.pluginLayout,pluginVersion:t.pluginVersion,pluginVersionProperties:t.pluginVersionProperties}]):e}),[])}))}));return Promise.all([a,t]).then((function(e){var t=e[0];return e[1].map((function(e){var n=t.find((function(t){var n;return(null===(n=t.pluginVersion)||void 0===n?void 0:n.id)===e.plugin_version_id}));if(n&&e.plugin_type){var a={plugin_layout:n.pluginLayout,plugin_preset:e,plugin_version_properties:n.pluginVersionProperties,id:n.pluginVersion.plugin_id,name:e.name,organisation_id:e.organisation_id,plugin_type:e.plugin_type,group_id:n.pluginVersion.group_id,artifact_id:n.pluginVersion.artifact_id,current_version_id:n.pluginVersion.id},r=n.pluginVersionProperties.reduce((function(e,t){return Object.assign(Object.assign({},e),v({},t.technical_name,t))}),{}),o=e.properties.reduce((function(e,t){var n=e[t.technical_name];if(n){var a=Object.assign(Object.assign({},n),{value:t.value});return Object.assign(Object.assign({},e),v({},t.technical_name,a))}return e}),r),i={properties:Object.assign({},o)};return{id:(0,f.generateFakeId)(),type:"SCENARIO_AUDIENCE_SEGMENT_FEED_NODE",scenario_id:"",formData:i,strictlyLayoutablePlugin:a}}}))})).then((function(e){return e.reduce((function(e,t){return t?e.concat([t]):e}),[])}))}return Promise.resolve([])},n.createNodeGrid=function(e){var t=n.props.intl;return e.map((function(e){return i.createElement(c.default,{node:e,intl:t,key:e.id})}))};var a=[E].concat(n.props.hasFeature("automations-add-delete-to-from-segment-node")?[O,w]:[]).concat(n.props.hasFeature("automations-custom-action-node")?[M]:[]);return n.state={actionNodes:a,conditionNodes:[P,T,I],exitsNodes:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.state.actionNodes;this.getFeedPresetNodes().then((function(n){var a=t.concat(n);e.setState({actionNodes:a})}))}},{key:"render",value:function(){var e=this.props.intl;return i.createElement("div",{className:"mcs-availableNodeVisualizer"},i.createElement(s.Row,{className:"mcs-availableNodeVisualizer_header"},i.createElement("div",{className:"mcs-availableNodeVisualizer_title"},e.formatMessage(S.availableNodeTitle)),i.createElement("div",{className:"mcs-availableNodeVisualizer_subtitle"},e.formatMessage(S.availableNodeSubtitle))),i.createElement(s.Collapse,{defaultActiveKey:["1"],bordered:!1},i.createElement(_,{header:e.formatMessage(S.actionsTitle),key:"1",className:"mcs-availableNodeVisualizer_panel"},this.createNodeGrid(this.state.actionNodes)),i.createElement(_,{header:e.formatMessage(S.flowControlTitle),key:"2",className:"mcs-availableNodeVisualizer_panel"},this.createNodeGrid(this.state.conditionNodes))))}}]),t}(i.Component);b([(0,g.lazyInject)(y.TYPES.IPluginService)],A.prototype,"_pluginService",void 0),t.default=(0,m.compose)(h.withRouter,u.injectIntl,p.injectFeatures)(A)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(0),i=(a=o)&&a.__esModule?a:{default:a},s=n(226),l=n(221),c=n(113),u=n(160),d=n(11);function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m={beginDrag:function(e){var t=e.intl.formatMessage,n=(0,l.generateNodeProperties)(e.node,t);return Object.assign(Object.assign({},e.node),{id:(0,u.generateFakeId)(),icon:n.iconType,iconAnt:n.iconAnt,color:n.color,branch_number:(0,c.isAbnNode)(e.node)?e.node.branch_number:0})}},g=function(e){function t(){f(this,t);var e=p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.getIcon=function(e){var t=e.iconAnt?e.iconAnt:i.default.createElement(d.McsIcon,{type:e.iconType,className:"available-node-icon-gyph"});return e.iconAssetUrl?i.default.createElement("div",{className:"available-node-icon"},i.default.createElement("img",{className:"available-node-icon-img",src:""+window.MCS_CONSTANTS.ASSETS_URL+e.iconAssetUrl})):i.default.createElement("div",{className:"available-node-icon",style:{backgroundColor:e.color}},t)},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.node,n=e.connectDragSource,a=e.intl.formatMessage,r=(0,l.generateNodeProperties)(t,a),o=r.title,s=this.getIcon(r);return n&&n(i.default.createElement("div",{className:"available-node"},s,i.default.createElement("div",{className:"available-node-text"},o)))}}]),t}(i.default.Component);t.default=(0,s.DragSource)((function(){return"automation-node"}),m,(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=S(n(0)),i=n(8),s=n(10),l=n(77),c=n(35),u=n(6),d=n(24),f=n(221),p=n(25),m=n(51),g=S(n(23)),y=n(12),h=n(15),v=S(n(60)),b=n(311),_=S(n(343));function S(e){return e&&e.__esModule?e:{default:e}}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O="scenarioExitConditionForm",w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.onEventsChange=function(e,t,a){var r=n.state.validObjectType;if(r&&r.objectTypeQueryName){var o={from:"UserPoint",operations:[{directives:[],selections:[{name:"id"}]}],where:{boolean_operator:"OR",field:r.objectTypeQueryName,type:"OBJECT",expressions:[{type:"FIELD",field:r.fieldName,comparison:{type:"STRING",operator:"EQ",values:t}}]}};n.props.dispatch&&n.props.dispatch((0,c.change)(O,"query_text",JSON.stringify(o)))}};var a=[];if(e.exitCondition.formData.query_text){var r=JSON.parse(e.exitCondition.formData.query_text),o=r.where?r.where:void 0,i=o?o.expressions[0]:void 0;a=i&&i.comparison?i.comparison.values:[],n.props.dispatch&&n.props.dispatch((0,c.change)(O,"events",a))}return n.state={queryText:"",isLoading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.intl.formatMessage,r=t.formValues.datamart_id,o=t.notifyError;n&&n((0,c.change)(O,"query_language","JSON_OTQL")),(0,f.getValidObjectType)(r,this._runtimeSchemaService).then((function(t){t&&t.objectTypeQueryName?e.setState({validObjectType:t,isLoading:!1}):s.message.warning(a(M.schemaNotSuitableForAction))})).catch((function(e){return o(e)}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.intl.formatMessage,a=t.fieldValidators.isRequired,r=t.close,i=t.disabled,c=t.formValues.datamart_id,p=this.state,g=p.isLoading,y=p.validObjectType,h={formId:O,paths:[{name:n(M.title)}],message:M.save,onClose:r,disabled:i||g};return o.default.createElement(s.Layout,{className:"mcs-reactToEventAutomation edit-layout"},o.default.createElement(v.default,h),o.default.createElement(s.Layout,{className:"ant-layout-content"},g?o.default.createElement(m.Loading,{isFullScreen:!0}):o.default.createElement(l.Form,{id:O,className:"edit-layout mcs-content-container mcs-form-container",layout:"vertical"},o.default.createElement("div",{className:"mcs-exitConditionAutomation_description"},o.default.createElement(d.FormSection,{title:M.descriptionTitle}),o.default.createElement("div",{className:"mcs-exitConditionAutomation_descriptionSubtitle"},o.default.createElement(u.FormattedMessage,M.descriptionSubtitle)),o.default.createElement("div",{className:"mcs-exitConditionAutomation_descriptionSubtitle"},o.default.createElement(u.FormattedMessage,M.descriptionSubtitleExplanation))),o.default.createElement(d.FormSection,{title:M.configurationTitle}),o.default.createElement("div",{className:"mcs-reactToEventAutomation_chooseEventNameContainer"},o.default.createElement(b.FormSearchObjectField,{name:"events",component:_.default,onChange:this.onEventsChange,fetchListMethod:function(t){return(0,f.getEventsNames)(c,y,e._queryService)},fetchSingleMethod:function(e){return Promise.resolve({key:e,label:e,value:e})},formItemProps:{label:n(M.eventName),required:!0},helpToolTipProps:{title:n(M.eventNameHelp)},small:!0,validate:a,selectProps:{mode:"tags",disabled:i},loadOnlyOnce:!0})))))}}]),t}(o.default.Component);E([(0,h.lazyInject)(y.TYPES.IQueryService)],w.prototype,"_queryService",void 0),E([(0,h.lazyInject)(y.TYPES.IRuntimeSchemaService)],w.prototype,"_runtimeSchemaService",void 0);t.default=(0,i.compose)(u.injectIntl,d.withValidators,g.default,(0,c.reduxForm)({form:O,enableReinitialize:!0}),(0,p.connect)((function(e){return{formValues:(0,c.getFormValues)(O)(e)}})))(w);var M=(0,u.defineMessages)({title:{id:"automation.builder.node.scenarioExitConditionForm.title",defaultMessage:"Exit condition"},save:{id:"automation.builder.node.scenarioExitConditionForm.save.button",defaultMessage:"Update"},eventName:{id:"automation.builder.node.scenarioExitConditionForm.eventName",defaultMessage:"Event names"},eventNameHelp:{id:"automation.builder.node.scenarioExitConditionForm.eventNameHelp",defaultMessage:"When receiving one of these events, the user will instantly leave the automation."},schemaNotSuitableForAction:{id:"automation.builder.node.scenarioExitConditionForm.schemaNotSuitableForAction",defaultMessage:"Schema is not suitable for this action."},descriptionTitle:{id:"automation.builder.node.scenarioExitConditionForm.description.title",defaultMessage:"Description"},descriptionSubtitle:{id:"automation.builder.node.scenarioExitConditionForm.description.subtitle",defaultMessage:"If you add an exit condition, users will leave the automation as soon as this condition is met."},descriptionSubtitleExplanation:{id:"automation.builder.node.scenarioExitConditionForm.description.subtitle.explanation",defaultMessage:'For instance, if you plan to send an email to all users who\'ve added an item to their cart but have not completed a transaction,\n    you could set a "transaction confirmed" event as an exit condition. This way, if a "transaction confirmed" event is received,\n    the users will leave the automation and not receive an email.'},configurationTitle:{id:"automation.builder.node.scenarioExitConditionForm.configuration.title",defaultMessage:"Configuration"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(25),s=n(35),l=n(13),c=n(1109),u=n(11),d=n(10),f=n(6),p=n(2334),m=h(p),g=h(n(23)),y=n(300);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onClick=function(){n.handleModal()},n.handleModal=function(){n.setState({visible:!n.state.visible})},n.onSave=function(){var e=n.props,t=e.saveOrUpdate,a=e.automationData,r=e.formValues;t({automation:a?Object.assign(Object.assign({},a.automation),r):Object.assign({},r),exitCondition:a&&a.exitCondition?a.exitCondition:y.INITIAL_AUTOMATION_DATA.exitCondition,automationTreeData:a&&a.automationTreeData?a.automationTreeData:y.INITIAL_AUTOMATION_DATA.automationTreeData})},n.state={isLoading:!1,visible:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl,n=e.submit,a=e.automationData,o=e.match.params.automationId,i=this.state.visible,s={name:a&&a.automation?a.automation.name:""};return r.createElement(u.Actionbar,{paths:[{name:t.formatMessage(c.messages.automationBuilder)},{name:a&&a.automation&&a.automation.name?a.automation.name:t.formatMessage(c.messages.newAutomation)}]},r.createElement(d.Button,{className:"mcs-primary",type:"primary",onClick:this.onClick},r.createElement(u.McsIcon,{type:"plus"}),o?t.formatMessage(c.messages.updateAutomation):t.formatMessage(c.messages.saveAutomation)),i&&r.createElement(m.default,{onSubmit:this.onSave,initialValues:s,visible:i,onClose:this.handleModal,onHandleOk:function(){n(p.FORM_ID)}}))}}]),t}(r.Component);t.default=(0,o.compose)(f.injectIntl,g.default,l.withRouter,(0,i.connect)((function(e){return{formValues:(0,s.getFormValues)(p.FORM_ID)(e)}})),(0,i.connect)(void 0,{submit:s.submit}))(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(10),s=n(6),l=n(24),c=n(73),u=n(11);function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=function(e){function t(){d(this,t);var e=f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.renderSelectionAutomationType=function(){var t=e.props,n=t.onSelectTemplate,a=t.intl.formatMessage,o=t.disableReactToEvent;return r.createElement(i.Row,{className:"mcs-selector_container"},r.createElement(i.Row,{className:"menu"},r.createElement(u.MenuList,{title:a(m.reactToAnEvent),subtitles:o?[a(m.reactToAnEventDisabled)]:void 0,select:function(){return n("REACT_TO_EVENT")},disabled:o}),e.props.hasFeature("automations-on-segment-entry")&&r.createElement(u.MenuList,{title:a(m.onSegmentEntry),select:function(){return n("ON_SEGMENT_ENTRY")}}),e.props.hasFeature("automations-on-segment-exit")&&r.createElement(u.MenuList,{title:a(m.onSegmentExit),select:function(){return n("ON_SEGMENT_EXIT")}})))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.actionbarProps;return r.createElement(i.Layout,null,r.createElement(u.Actionbar,e),r.createElement(i.Layout.Content,{className:"mcs-content-container mcs-form-container text-center"},r.createElement(l.FormTitle,{title:m.title,subtitle:m.subTitleStep1}),this.renderSelectionAutomationType()))}}]),t}(r.Component);t.default=(0,o.compose)(s.injectIntl,c.injectFeatures)(p);var m=(0,s.defineMessages)({title:{id:"automations-template-selector-title",defaultMessage:"Automations Builder"},advanced:{id:"automations-template-selector-advanced",defaultMessage:"Advanced"},subTitleStep1:{id:"automations-template-selector-subtitle-step1",defaultMessage:"Choose your automation type"},subTitleStep2:{id:"automations-template-selector-subtitle-step2",defaultMessage:"Choose your automation period"},or:{id:"automations-template-selector-or",defaultMessage:"or"},onSegmentEntry:{id:"automations-template-selector-on-segment-entry",defaultMessage:"On Segment Entry"},onSegmentExit:{id:"automations-template-selector-on-segment-exit",defaultMessage:"On Segment Exit"},reactToAnEvent:{id:"automations-template-selector-reactToAnEvent",defaultMessage:"React to an Event"},reactToAnEventDisabled:{id:"automations-template-selector-reactToAnEvent-disabled",defaultMessage:"Invalid configured schema - Please contact your support contact to enable it."}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(35),s=n(77),l=n(10),c=n(24),u=n(8),d=n(6),f=n(11);var p=t.FORM_ID="automationSimpleForm",m=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators,n=e.intl,r=e.handleSubmit,i=e.visible,u=e.onClose,d={htmlType:"submit",type:"primary",onClick:e.onHandleOk},m=o.createElement(l.Button,a({},d,{className:"mcs-primary"}),o.createElement(f.McsIcon,{type:"plus"}),"Save");return o.createElement(s.Form,{className:"edit-layout ant-layout",onSubmit:r},o.createElement(f.BlurredModal,{onClose:u,formId:p,opened:i,footer:m},o.createElement(c.FormInputField,{name:"name",component:c.FormInput,validate:[t.isRequired],formItemProps:{label:n.formatMessage(g.automationNameLabel),required:!0},inputProps:{placeholder:n.formatMessage(g.automationNamePlaceHolder)},helpToolTipProps:{title:n.formatMessage(g.automationNameTooltip)}})))}}]),t}(o.Component);t.default=(0,u.compose)(d.injectIntl,c.withValidators,c.withNormalizer,(0,i.reduxForm)({form:p}))(m);var g=(0,d.defineMessages)({automationNameLabel:{id:"automation.builder.page.actionbar.form.name.label",defaultMessage:"Name"},automationNamePlaceHolder:{id:"automation.builder.page.actionbar.form.name.placeholder",defaultMessage:"Automation Name"},automationNameTooltip:{id:"automation.builder.page.actionbar.form.name.helper",defaultMessage:"Give your Automation a name to find it back on the automation screen."}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(6),l=n(13),c=n(10),u=n(8),d=_(n(162)),f=_(n(23)),p=n(740),m=n(30),g=n(112),y=_(n(2336)),h=_(n(2338)),v=n(15),b=n(12);function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=c.Layout.Content,O=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.showModal=function(){n.setState({visible:!0})},n.updateAutomationStatus=function(e,t){n.setState({isUpdatingStatuses:!0});var a=n.props.notifyError;return n._scenarioService.updateScenario(e.id,{id:e.id,name:e.name,status:t,datamart_id:e.datamart_id,organisation_id:e.organisation_id}).then((function(){return n.setState({isUpdatingStatuses:!1,selectedRowKeys:[]}),null})).catch((function(e){a(e),n.setState({isUpdatingStatuses:!1,selectedRowKeys:[]})}))},n.onSelectChange=function(e){n.setState({selectedRowKeys:e})},n.selectAllItemIds=function(){n.setState({allRowsAreSelected:!0})},n.unselectAllItemIds=function(){n.setState({selectedRowKeys:[],allRowsAreSelected:!1})},n.unsetAllItemsSelectedFlag=function(){n.setState({allRowsAreSelected:!1})},n.handleStatusAction=function(e){var t=n.props,a=t.match.params.organisationId,r=t.location.search,o=n.state,i=o.allRowsAreSelected,s=o.selectedRowKeys;n.setState({isUpdatingStatuses:!0});var l=(0,m.parseSearch)(r,p.SCENARIOS_SEARCH_SETTINGS),c={organisation_id:a,keywords:l.keywords};n._scenarioService.getScenarios(a,c).then((function(t){var r=i?t.data:s?t.data.filter((function(e){return s.includes(e.id)})):[],o=[];r.forEach((function(t){o.push((function(){return n.updateAutomationStatus(t,e)}))})),(0,g.executeTasksInSequence)(o).then((function(){n.setState({isUpdatingStatuses:!1},(function(){n._scenarioService.getScenarios(a,l)}))})).catch((function(e){n.setState({isUpdatingStatuses:!1}),n.props.notifyError(e)}))}))},n.state={selectedRowKeys:[],allRowsAreSelected:!1,visible:!1,isUpdatingStatuses:!1,isArchiving:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.state,t=e.selectedRowKeys,n=e.isUpdatingStatuses,r=e.allRowsAreSelected,o=this.props.labels,s={selectedRowKeys:t,allRowsAreSelected:r,onChange:this.onSelectChange,selectAllItemIds:this.selectAllItemIds,unselectAllItemIds:this.unselectAllItemIds,onSelectAll:this.unsetAllItemsSelectedFlag,onSelect:this.unsetAllItemsSelectedFlag},l={visible:this.state.visible,handleStatusAction:this.handleStatusAction},c={labels:o};return i.createElement("div",{className:"ant-layout"},i.createElement(h.default,{organisationId:this.props.match.params.organisationId,rowSelection:s,multiEditProps:l}),i.createElement("div",{className:"ant-layout"},i.createElement(E,{className:"mcs-content-container"},i.createElement(y.default,a({rowSelection:s,isUpdatingStatuses:n},c)))))}}]),t}(i.Component);S([(0,v.lazyInject)(b.TYPES.IScenarioService)],O.prototype,"_scenarioService",void 0),t.default=(0,u.compose)(l.withRouter,s.injectIntl,d.default,f.default)(O)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=_(n(0)),i=n(33),s=n(41),l=n(10),c=n(8),u=n(6),d=n(2337),f=n(30),p=n(68),m=_(n(1110)),g=n(740),y=n(44),h=n(15),v=n(12),b=n(11);function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=l.Layout.Content,O=(0,u.defineMessages)({NEW:{id:"automations.list.status.new",defaultMessage:"New"},ACTIVE:{id:"automations.list.status.active",defaultMessage:"Active"},PAUSED:{id:"automations.list.status.paused",defaultMessage:"Paused"},name:{id:"automations.list.column.name",defaultMessage:"Name"},status:{id:"automations.list.column.status",defaultMessage:"Status"},edit:{id:"automations.list.actionColumn.edit",defaultMessage:"Edit"},oldAutomationModalTitle:{id:"automations.list.oldAutomation.modal.title",defaultMessage:"Not supported"},oldAutomationModalContent:{id:"automations.list.oldAutomation.modal.content",defaultMessage:"This is automation is not supported anymore."}}),w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchAutomationList=function(e,t){n.setState({isLoading:!0});var a=Object.assign({},(0,y.getPaginatedApiParam)(t.currentPage,t.pageSize));return t.keywords&&(a.keywords=t.keywords),t.statuses&&t.statuses.length&&(a.status=t.statuses),n._scenarioService.getScenarios(e,a).then((function(e){n.setState({isLoading:!1,dataSource:e.data,totalAutomations:e.total||e.count})}))},n.editAutomation=function(e){var t=n.props,a=t.match.params.organisationId,r=t.history,o=t.location,i=t.intl.formatMessage;n._datamartService.getDatamart(e.datamart_id).then((function(t){"v201506"!==t.data.storage_model_version?r.push("/v2/o/"+a+"/automations/"+e.id+"/edit",{from:""+o.pathname+o.search}):l.Modal.info({title:i(O.oldAutomationModalTitle),content:i(O.oldAutomationModalContent)})}))},n.deleteAutomation=function(e){var t=n.props,a=t.match.params.organisationId,r=t.location,i=r.search,c=r.pathname,u=r.state,d=t.intl,p=t.history,y=n.state.dataSource,h=(0,f.parseSearch)(i,g.SCENARIOS_SEARCH_SETTINGS);l.Modal.confirm({title:d.formatMessage(m.default.automationModalConfirmDeletionTitle),content:d.formatMessage(m.default.automationModalConfirmDeletionContent),icon:o.default.createElement(s.ExclamationCircleOutlined,null),okText:d.formatMessage(m.default.deleteAutomation),cancelText:d.formatMessage(m.default.automationModalConfirmDeletionCancel),onOk:function(){var t;(t=e.id,n._scenarioService.deleteScenario(t)).then((function(){!function(){if(1===y.length&&1!==h.currentPage){var e=Object.assign(Object.assign({},h),{currentPage:h.currentPage-1});n.fetchAutomationList(a,h),p.replace({pathname:c,search:(0,f.updateSearch)(i,e),state:u})}n.fetchAutomationList(a,h)}()}))},onCancel:function(){}})},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,f.updateSearch)(o,e,g.SCENARIOS_SEARCH_SETTINGS)};a.push(i)},n.viewAutomation=function(e){return function(){var t=n.props,a=t.match.params.organisationId,r=t.history,o=t.intl.formatMessage;n._datamartService.getDatamart(e.datamart_id).then((function(t){"v201506"!==t.data.storage_model_version?r.push("/v2/o/"+a+"/automations/"+e.id):l.Modal.info({title:o(O.oldAutomationModalTitle),content:o(O.oldAutomationModalContent)})}))}},n.state={isLoading:!1,dataSource:[],totalAutomations:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.history,n=e.location,a=n.search,r=n.pathname,o=e.match.params.organisationId;if((0,f.isSearchValid)(a,g.SCENARIOS_SEARCH_SETTINGS)){var i=(0,f.parseSearch)(a,g.SCENARIOS_SEARCH_SETTINGS);this.fetchAutomationList(o,i)}else t.replace({pathname:r,search:(0,f.buildDefaultSearch)(a,g.SCENARIOS_SEARCH_SETTINGS),state:{reloadDataSource:!0}})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.location,a=n.pathname,r=n.search,o=t.match.params.organisationId,i=t.history,s=e.location.search,l=e.match.params.organisationId;if(!(0,f.compareSearches)(r,s)||o!==l)if((0,f.isSearchValid)(r,g.SCENARIOS_SEARCH_SETTINGS)){var c=(0,f.parseSearch)(r,g.SCENARIOS_SEARCH_SETTINGS);this.fetchAutomationList(o,c)}else i.replace({pathname:a,search:(0,f.buildDefaultSearch)(r,g.SCENARIOS_SEARCH_SETTINGS),state:{reloadDataSource:o!==l}})}},{key:"render",value:function(){var e=this,t=this.props,n=t.location.search,a=t.intl,r=t.rowSelection,i=this.state,c=i.dataSource,y=i.totalAutomations,h=i.isLoading,v=(0,f.parseSearch)(n,g.SCENARIOS_SEARCH_SETTINGS),_={placeholder:a.formatMessage(m.default.searchScenarios),onSearch:function(t){return e.updateLocationSearch({keywords:t,currentPage:1})},defaultValue:v.keywords},S={current:v.currentPage,pageSize:v.pageSize,total:y,onChange:function(t){e.updateLocationSearch({currentPage:t}),r&&r.unselectAllItemIds&&r.allRowsAreSelected&&r.unselectAllItemIds()},onShowSizeChange:function(t,n){return e.updateLocationSearch({currentPage:1,pageSize:n})}},w=[{intlMessage:O.status,key:"status",isHideable:!1,render:function(e){return o.default.createElement(l.Tooltip,{placement:"top",title:a.formatMessage(O[e])},o.default.createElement("span",{className:"mcs-campaigns-status-"+e.toLowerCase()},o.default.createElement(b.McsIcon,{type:"status"})))}},{intlMessage:O.name,key:"name",isHideable:!1,render:function(t,n){return o.default.createElement("a",{onClick:e.viewAutomation(n)},o.default.createElement("span",{className:"mcs-automation-link"},t))}}],M=[{key:"action",actions:function(){return[{intlMessage:O.edit,callback:e.editAutomation},{intlMessage:m.default.deleteAutomation,callback:e.deleteAutomation}]}}],P=d.automationStatuses.map((function(e){return{key:e,value:e}})),T=[{displayElement:o.default.createElement("div",null,o.default.createElement(u.FormattedMessage,{id:"automations.list.filterStatus",defaultMessage:"Status"})," ",o.default.createElement(s.DownOutlined,null)),selectedItems:v.statuses.map((function(e){return{key:e,value:e}})),items:P,getKey:function(e){return e.key},display:function(e){return e.value},handleMenuClick:function(t){return e.updateLocationSearch({statuses:t.map((function(e){return e.value}))})}}];return o.default.createElement("div",{className:"ant-layout"},o.default.createElement(E,{className:"mcs-content-container"},o.default.createElement("div",{className:"mcs-table-container"},o.default.createElement(p.TableViewFilters,{columns:w,actionsColumnsDefinition:M,searchOptions:_,filtersOptions:T,dataSource:c,loading:h,pagination:S,rowSelection:r}))))}}]),t}(o.default.Component);S([(0,h.lazyInject)(v.TYPES.IScenarioService)],w.prototype,"_scenarioService",void 0),S([(0,h.lazyInject)(v.TYPES.IDatamartService)],w.prototype,"_datamartService",void 0),t.default=(0,c.compose)(i.withRouter,u.injectIntl)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAutomationResource=function(e){return void 0!==e.id};t.automationStatuses=["NEW","ACTIVE","PAUSED"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=m(n(0)),o=n(10),i=n(33),s=n(6),l=n(11),c=n(8),u=m(n(2339)),d=m(n(23)),f=m(n(1114)),p=m(n(1110));function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.buildMenu=function(){var e=n.props.multiEditProps.handleStatusAction;return r.default.createElement(u.default,{onClick:function(t){switch(t.key){case"pause":return e("PAUSED");case"activate":return e("ACTIVE")}}},r.default.createElement(u.default.Item,{key:"pause"},r.default.createElement(s.FormattedMessage,p.default.pauseAll)),r.default.createElement(u.default.Item,{key:"activate"},r.default.createElement(s.FormattedMessage,p.default.activeAll)))},n.state={exportIsRunning:!1,allAutomationsActivated:!1,allAutomationsPaused:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.organisationId,a=t.intl,c=t.rowSelection.selectedRowKeys,u=!!(c&&c.length>0),d=[{name:a.formatMessage(p.default.automationListTitle),path:"/v2/o/"+n+"/automations"}];return r.default.createElement(l.Actionbar,{paths:d},r.default.createElement(i.Link,{to:"/v2/o/"+n+"/automation-builder"},r.default.createElement(o.Button,{className:"mcs-primary",type:"primary"},r.default.createElement(l.McsIcon,{type:"plus"})," ",r.default.createElement(s.FormattedMessage,{id:"automations.list.actionbar.newAutomation",defaultMessage:"New Automation"}))),r.default.createElement(l.Slide,{toShow:u,horizontal:!0,content:r.default.createElement(f.default,{overlay:e.buildMenu(),trigger:["click"]},r.default.createElement(o.Button,{className:"button-glow"},r.default.createElement(l.McsIcon,{type:"chevron"}),r.default.createElement(s.FormattedMessage,p.default.setStatus)))}))}}]),t}(r.default.Component);t.default=(0,c.compose)(i.withRouter,d.default,s.injectIntl)(g)},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(8),l=E(n(23)),c=n(15),u=n(12),d=n(300),f=n(51),p=n(10),m=E(n(1098)),g=n(11),y=n(6),h=E(n(162)),v=E(n(2362)),b=n(73),_=n(30),S=E(n(81));function E(e){return e&&e.__esModule?e:{default:e}}var O=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},w=(0,y.defineMessages)({testTitle:{id:"automationDashboardPage.actionBar.test",defaultMessage:"Test"},timeWindowLabel:{id:"automationDashboardPage.actionBar.timeWindow.label",defaultMessage:"View user flow"}}),M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderStatus=function(e){switch(e){case"ACTIVE":return o.createElement("span",null,o.createElement(g.McsIcon,{type:"pause"})," Pause");case"NEW":case"PAUSED":return o.createElement("span",null,o.createElement(g.McsIcon,{type:"play"})," Activate")}},n.onStatusClick=function(e,t){return function(){var a={status:"PAUSED"===t||"NEW"===t?"ACTIVE":"PAUSED",id:e};return n.setState({updating:!0}),n._scenarioService.updateScenario(e,a).then((function(e){return n.setState({automationFormData:Object.assign(Object.assign({},n.state.automationFormData),{automation:e.data}),updating:!1})}))}},n.onEditClick=function(){var e=n.props,t=e.history,a=e.match.params,r=a.organisationId,o=a.automationId;t.push("/v2/o/"+r+"/automations/"+o+"/edit")},n.onTestClick=function(e,t){return function(){var a=n.props,r=a.openNextDrawer,o={close:a.closeNextDrawer,datamartId:e,nodeId:t};r(v.default,{additionalProps:o,size:"small"})}},n.renderDatePicker=function(){var e=n.props.history.location.search,t=(0,_.parseSearch)(e,_.DATE_SEARCH_SETTINGS),a={from:t.from,to:t.to};return o.createElement(g.McsDateRangePicker,{values:a,onChange:function(e){return n.updateLocationSearch({from:e.from,to:e.to})}})},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,_.updateSearch)(o,e,_.DATE_SEARCH_SETTINGS)};a.push(i)},n.state={isLoading:!0,updating:!1,automationFormData:d.INITIAL_AUTOMATION_DATA},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match.params.automationId,a=t.history.location.search;n&&(this.setState({isLoading:!0}),this._automationFormService.loadInitialAutomationValues(n).then((function(t){e.setState({automationFormData:t,isLoading:!1})})));var r=(0,_.parseSearch)(a,_.DATE_SEARCH_SETTINGS);r.from.value&&r.from.to||this.updateLocationSearch({from:new S.default("now-7d"),to:new S.default("now")})}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.match.params.automationId,a=e.match.params.automationId;n||n===a?n!==a&&(this.setState({isLoading:!0}),this._automationFormService.loadInitialAutomationValues(n).then((function(e){t.setState({automationFormData:e,isLoading:!1})}))):this.setState({automationFormData:d.INITIAL_AUTOMATION_DATA})}},{key:"render",value:function(){var e,t,n=this.props,a=n.match.params.organisationId,r=n.intl.formatMessage,i=n.hasFeature,s=this.state,l=s.automationFormData,c=s.isLoading,u=s.updating;if(c)return o.createElement(f.Loading,{isFullScreen:!0});if(!l.automation||!l.automationTreeData)return"this automation does not seem to exist!";var d=[{name:"Automations",path:"/v2/o/"+a+"/automations"},{name:l.automation.name?l.automation.name:""}],y=l.automation.status,h=null===(e=l.automation)||void 0===e?void 0:e.datamart_id,v=null===(t=l.automationTreeData)||void 0===t?void 0:t.node.id,b=("ACTIVE"===y||"PAUSED"===y)&&h&&v&&i("automations-test-scenario")?o.createElement(p.Button,{onClick:this.onTestClick(h,v),disabled:c},o.createElement(g.McsIcon,{type:"gears"}),r(w.testTitle)):null,_=i("automations-analytics");return o.createElement("div",{style:{height:"100%",display:"flex"}},o.createElement(p.Layout,null,o.createElement(g.Actionbar,{paths:d},l.automation&&l.automation.status&&l.automation.id?o.createElement(p.Button,{onClick:this.onStatusClick(l.automation.id,l.automation.status),className:"mcs-primary",type:"primary"},u?o.createElement("i",{className:"mcs-table-cell-loading",style:{minWidth:50}}):this.renderStatus(l.automation.status)):null,o.createElement(p.Button,{onClick:this.onEditClick},o.createElement(g.McsIcon,{type:"pen"})," Edit"),b,_&&o.createElement("span",{key:"label"},r(w.timeWindowLabel)),_&&this.renderDatePicker()),o.createElement(p.Layout.Content,{className:"mcs-content-container",style:{padding:0,overflow:"hidden"}},o.createElement(m.default,{datamartId:l.automation.datamart_id,automationTreeData:l.automationTreeData,exitCondition:l.exitCondition,scenarioId:l.automation.id,viewer:!0,creation_mode:l.automationTreeData&&"QUERY_INPUT"===l.automationTreeData.node.type?l.automationTreeData.node.ui_creation_mode:"QUERY"}))))}}]),t}(o.Component);O([(0,c.lazyInject)(u.TYPES.IAutomationFormService)],M.prototype,"_automationFormService",void 0),O([(0,c.lazyInject)(u.TYPES.IScenarioService)],M.prototype,"_scenarioService",void 0),t.default=(0,s.compose)(i.withRouter,y.injectIntl,h.default,l.default,b.injectFeatures)(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(10),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(6),l=n(25),c=n(33),u=n(8),d=n(24),f=n(109),p=n(15),m=n(12),g=n(590),y=n(67),h=b(n(23)),v=b(n(2363));function b(e){return e&&e.__esModule?e:{default:e}}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=o.Layout.Content,E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchUserPointId=function(e){var t=n.props.match.params,a=t.organisationId,r=t.automationId;n.setState({isFetchingUserPointId:!0},(function(){n._scenarioService.getScenario(r).then((function(t){var r=t.data.datamart_id;return n._userDataService.getIdentifiers(a,r,"user_agent_id","vec:"+e).then((function(e){var t;n.setState({isFetchingUserPointId:!1,userPointId:null===(t=e.data.find(g.isUserPointIdentifier))||void 0===t?void 0:t.user_point_id})}))})).catch((function(e){n.setState({isFetchingUserPointId:!1})}))}))},n.getContent=function(){var e=n.props,t=e.match.params.organisationId,a=e.datamartId,r=e.nodeId,l=n.state,u=l.userPointId,f=l.isLaunchingTest,p=Object.assign({values:{userPointId:i.createElement(c.Link,{to:"/v2/o/"+t+"/audience/timeline/user_point_id/"+u,target:"_blank"},u)}},v.default.contentSubtitle),m=f?i.createElement("div",null,i.createElement(o.Spin,{size:"small",className:"text-center"})):i.createElement(s.FormattedMessage,v.default.buttonTitle);return u?i.createElement("div",null,i.createElement(d.FormSection,{title:v.default.contentTitle,subtitle:p}),i.createElement(o.Button,{className:"mcs-primary",type:"primary",disabled:f,onClick:n.launchTest(a,r,u)},m)):i.createElement(d.FormSection,{title:v.default.contentTitle,subtitle:v.default.contentSubtitleNoUserPoint})},n.launchTest=function(e,t,a){return function(){var r=n.props,i=r.match.params.automationId,s=r.intl.formatMessage,l=r.close,c=r.notifyError,u={datamart_id:e,user_point_id:a,scenario_id:i,node_id:t};n.setState({isLaunchingTest:!0},(function(){n._scenarioService.upsertUserScenarioByUserPointIdAndScenarioId(u).then((function(e){n.setState({isLaunchingTest:!1},(function(){o.message.success(s(v.default.testSuccessfullyLaunched)),l()}))})).catch((function(e){n.setState({isLaunchingTest:!1},(function(){c(e)}))}))}))}},n.state={isFetchingUserPointId:!1,isLaunchingTest:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.cookies;e.mics_vid&&this.fetchUserPointId(e.mics_vid)}},{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.close,a=this.state.isFetchingUserPointId,r={paths:[{name:t(v.default.testActionbarTitle)}],onClose:n},s=a?i.createElement(o.Spin,{size:"small",className:"text-center"}):this.getContent();return i.createElement(o.Layout,{className:"ant-layout"},i.createElement(f.FormLayoutActionbar,r),i.createElement(S,{className:"mcs-content-container mcs-form-container"},s))}}]),t}(i.Component);_([(0,p.lazyInject)(m.TYPES.IScenarioService)],E.prototype,"_scenarioService",void 0),_([(0,p.lazyInject)(m.TYPES.IUserDataService)],E.prototype,"_userDataService",void 0);t.default=(0,u.compose)(s.injectIntl,c.withRouter,h.default,(0,l.connect)((function(e){return{cookies:e.session.cookies,workspace:(0,y.getWorkspace)(e)}}),void 0))(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({testActionbarTitle:{id:"automation.test.actionbar.title",defaultMessage:"Test"},contentTitle:{id:"automation.test.content.title",defaultMessage:"Test your automation"},contentSubtitle:{id:"automation.test.content.subtitle",defaultMessage:"Your user point ({userPointId}) will go through the automation. All waiting nodes will be bypassed for the purpose of testing."},contentSubtitleNoUserPoint:{id:"automation.test.content.subtitle.noUserPoint",defaultMessage:"Since we will be using your own user point to test the scenario, you should make sure your current browser is linked to some activity on one of your channels before you can launch a test."},buttonTitle:{id:"automation.test.content.button.title",defaultMessage:"Launch test"},testSuccessfullyLaunched:{id:"automation.test.launched.message",defaultMessage:"Your test was successfully launched."}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentsActionbar=t.AudienceSegmentsTable=void 0;var a=o(n(2365)),r=o(n(2367));function o(e){return e&&e.__esModule?e:{default:e}}t.AudienceSegmentsTable=a.default,t.SegmentsActionbar=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=I(n(139)),s=n(25),l=I(n(54)),c=n(33),u=n(41),d=n(10),f=n(6),p=n(68),m=n(1116),g=n(30),y=n(11),h=n(56),v=n(8),b=n(65),_=n(44),S=n(67),E=n(12),O=n(15),w=n(163),M=n(124),P=n(202),T=I(n(2366));function I(e){return e&&e.__esModule?e:{default:e}}var A=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},C=(0,f.defineMessages)({filterByLabel:{id:"audience.segments.list.label.filterBy",defaultMessage:"Filter By Label"},modalTitle:{id:"audience.segments.list.archive.modal.title",defaultMessage:"Are you sure you want to archive this Segment?"},modalText:{id:"audience.segments.list.archive.modal.text",defaultMessage:"By archiving this Segment all it will stop campaign using it. Are you sure?"},modalOk:{id:"audience.segments.list.archive.modal.ok",defaultMessage:"Ok"},modalCancel:{id:"audience.segments.list.archive.modal.cancel",defaultMessage:"Cancel"},searchTitle:{id:"audience.segments.list.search.title",defaultMessage:"Search Segments"},USER_ACTIVATION:{id:"audience.segments.list.type.userActivation",defaultMessage:"User Activation"},USER_LOOKALIKE:{id:"audience.segments.list.type.userLookalike",defaultMessage:"User Lookalike"},USER_PARTITION:{id:"audience.segments.list.type.userPartition",defaultMessage:"User Partition"},USER_QUERY:{id:"audience.segments.list.type.userQuery",defaultMessage:"User Query"},USER_LIST:{id:"audience.segments.list.type.userList",defaultMessage:"User List"},FILE_IMPORT:{id:"audience.segments.list.type.userList.fileImport",defaultMessage:"File Import"},TAG:{id:"audience.segments.list.type.userList.tag",defaultMessage:"Tag"},SCENARIO:{id:"audience.segments.list.type.userList.scenario",defaultMessage:"Scenario"},SCENARIO_FEED:{id:"audience.segments.list.type.userList.scenarioFeed",defaultMessage:"Scenario Feed"},USER_PIXEL:{id:"audience.segments.list.type.userPixel",defaultMessage:"User Pixel"},USER_CLIENT:{id:"audience.segments.list.type.userClient",defaultMessage:"User Client"},EDGE:{id:"audience.segments.list.type.edge",defaultMessage:"EDGE"},filterType:{id:"audience.segments.list.filter.type",defaultMessage:"Type"},userActivationClickers:{id:"audience.segments.list.useractivation.clickers",defaultMessage:"{audienceSegmentName} - Clickers"},userActivationExposed:{id:"audience.segments.list.useractivation.exposed",defaultMessage:"{audienceSegmentName} - Exposed"},name:{id:"audience.segments.list.column.name",defaultMessage:"Name"},technicalName:{id:"audience.segments.list.column.technicalName",defaultMessage:"Technical Name"},type:{id:"audience.segments.list.column.type",defaultMessage:"Type"},addition:{id:"audience.segments.list.column.addition",defaultMessage:"Addition"},deletion:{id:"audience.segments.list.column.deletion",defaultMessage:"Deletion"},editSegment:{id:"audience.segments.list.editSegment",defaultMessage:"Edit"},more:{id:"audience.segments.list.typeFilter.more",defaultMessage:"More ..."},emptySegments:{id:"audience.segments.list.emptyList",defaultMessage:"No segments"}}),j=(0,f.defineMessages)({user_accounts_count:{id:"audience.segments.list.column.userAccounts",defaultMessage:"User Accounts"},user_points_count:{id:"audience.segments.list.column.userPoints",defaultMessage:"User Points"},desktop_cookie_ids_count:{id:"audience.segments.list.column.cookies",defaultMessage:"Cookies"},emails_count:{id:"audience.segments.list.column.emails",defaultMessage:"Emails"}}),R=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.cancellablePromises=[],n.checkIfHasItem=function(e){var t=Object.assign({with_third_parties:!0},(0,_.getPaginatedApiParam)(1,1));return n._audienceSegmentService.getSegments(e,t).then((function(e){n.setState({hasItems:0!==e.count})}))},n.fetchAudienceSegments=function(e,t,a){return n._audienceSegmentService.getSegments(e,n.buildApiSearchFilters(a,t)).then((function(e){n.setState({list:{segments:e.data,total:e.total?e.total:e.count,isLoading:!1}})})).catch((function(e){(0,M.notifyError)(e)}))},n.buildApiSearchFilters=function(e,t){var n={with_third_parties:!0};e.currentPage&&e.pageSize&&(n=Object.assign(Object.assign({},n),(0,_.getPaginatedApiParam)(e.currentPage,e.pageSize))),t&&(n=Object.assign(Object.assign({},n),{datamart_id:t})),e.keywords&&(n=Object.assign(Object.assign({},n),{keywords:e.keywords})),e.orderBy&&(n=Object.assign(Object.assign({},n),{order_by:e.orderBy}));var a=function(e){return"USER_LIST"===e},r=function(e){return"EDGE"===e||"USER_PIXEL"===e},o=e.type.filter(r);e.type.some(a)&&o.push("STANDARD");var i=e.type.filter((function(e){return"EDGE"!==e&&"USER_PIXEL"!==e}));o.length&&(n=Object.assign(Object.assign({},n),{subtype:o}));var s=0===i.filter(a).length&&o.length>0,l=0===i.length&&0===o.length,c=s?["USER_LIST"]:l?["USER_LIST","USER_QUERY","USER_LOOKALIKE","USER_ACTIVATION","USER_PARTITION","USER_DATA_SUBSCRIPTION"]:i;n=Object.assign(Object.assign({},n),{type:c});var u=c.some(a)&&0===e.feed_type.length?["SCENARIO","FILE_IMPORT","TAG"]:e.feed_type;return e.type.some(r)&&u.push("TAG"),u.length&&(n=Object.assign(Object.assign({},n),{feed_type:u})),e.label_id.length&&(n=Object.assign(Object.assign({},n),{label_id:e.label_id})),n},n.editSegment=function(e){var t=n.props,a=t.match.params.organisationId,r=t.history,o="/v2/o/"+a+"/audience/segments/"+e.id+"/edit";r.push(o)},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,g.updateSearch)(o,e,n.getSearchSetting())};a.push(i)},n.isPionusDatamart=function(e){var t=n.props,a=t.location.search,r=t.match.params.organisationId,o=t.workspace,s=e||i.default.parse(a).datamartId,l=o(r).datamarts,c=l.find((function(e){return e.id===s}));return 1===l.length&&"v201506"!==l[0].storage_model_version||c&&"v201506"!==c.storage_model_version},n.renderMetricData=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(n.state.list.isLoading)return o.createElement("i",{className:"mcs-table-cell-loading"});var r="EUR"===a?"€ ":"";return(0,h.formatMetric)(e,t,r)},n.columnStatSort=function(e,t,a){var r,o,i=n.props,s=i.history,l=i.location,c=l.search,u=l.pathname,d=(0,g.parseSearch)(c,n.getSearchSetting()),f={pathname:u,search:(0,g.updateSearch)(c,{orderBy:(r=e,o=d.orderBy,o?o.startsWith("-")?void n.setState({isAsc:void 0,sortField:void 0}):(n.setState({isAsc:!1,sortField:r}),"-"+r):(n.setState({isAsc:!0,sortField:r}),r))},n.getSearchSetting())};s.push(f)},n.buildDataColumns=function(){var e=n.props,t=e.match.params.organisationId,a=e.intl,r=[{intlMessage:C.type,key:"type",isHideable:!1,render:function(e,t){var n=o.createElement(u.DatabaseOutlined,null),r=void 0,i=void 0;switch(e){case"USER_ACTIVATION":n=o.createElement(u.RocketOutlined,null);break;case"USER_QUERY":n=o.createElement(u.DatabaseOutlined,null);break;case"USER_LIST":n=o.createElement(u.SolutionOutlined,null);var s=t.subtype;if("EDGE"===s||"USER_CLIENT"===s){r=o.createElement(u.FileImageOutlined,null);i=a.formatMessage(C.EDGE)}if("USER_PIXEL"===s&&(r=o.createElement(u.GlobalOutlined,null),i=a.formatMessage(C[s])),"STANDARD"===s){var l=t.feed_type;"FILE_IMPORT"===l&&(r=o.createElement(u.FileOutlined,null)),"SCENARIO"===l&&(r=o.createElement(u.ShareAltOutlined,null)),i=a.formatMessage(C[l])}break;case"USER_PARTITION":n=o.createElement(u.ApiOutlined,null);break;case"USER_LOOKALIKE":n=o.createElement(u.UsergroupAddOutlined,null);break;default:n=o.createElement(u.DatabaseOutlined,null)}return o.createElement("div",{className:"mcs-audienceSegmentTable_type"},o.createElement(d.Tooltip,{placement:"top",title:a.formatMessage(C[t.type]||e)},n),r&&o.createElement("span",null," > "),r&&o.createElement(d.Tooltip,{placement:"top",title:i},r))}},{intlMessage:C.name,key:"name",isHideable:!1,render:function(e,n){return o.createElement(c.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+t+"/audience/segments/"+n.id},o.createElement(w.SegmentNameDisplay,{audienceSegmentResource:n,tableViewMode:!0}))}},{intlMessage:C.technicalName,isVisibleByDefault:!1,key:"technical_name",isHideable:!0,render:function(e,n){return o.createElement(c.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+t+"/audience/segments/"+n.id},e)}},{title:n.getColumnButton("user_points_count"),key:"user_points_count",isVisibleByDefault:!0,isHideable:!0,render:function(e){return n.renderMetricData(e,"0,0")}},{title:function(){return n.getColumnButton("user_accounts_count")},key:"user_accounts_count",isVisibleByDefault:!0,isHideable:!0,render:function(e){return n.renderMetricData(e,"0,0")}},{title:function(){return n.getColumnButton("emails_count")},key:"emails_count",isVisibleByDefault:!0,isHideable:!0,render:function(e){return n.renderMetricData(e,"0,0")}},{title:function(){return n.getColumnButton("desktop_cookie_ids_count")},key:"desktop_cookie_ids_count",isVisibleByDefault:!0,isHideable:!0,render:function(e){return n.renderMetricData(e,"0,0")}}],i=[{intlMessage:C.addition,key:"user_point_additions",isVisibleByDefault:!0,isHideable:!0,render:function(e,t){return n.isPionusDatamart(t.datamart_id)?"-":n.renderMetricData(e,"0,0")}},{intlMessage:C.deletion,key:"user_point_deletions",isVisibleByDefault:!0,isHideable:!0,render:function(e,t){return n.isPionusDatamart(t.datamart_id)?"-":n.renderMetricData(e,"0,0")}}];return n.isPionusDatamart()?r:r.concat(i)},n.renderTreeSelectFilter=function(){var e=n.props,t=e.intl.formatMessage,a=e.location.search,r=(0,g.parseSearch)(a,n.getSearchSetting()),i={className:"mcs-table-filters-item mcs-audienceSegmentTable-typeFilter",placeholder:"Type filter",parentFilterName:"type",maxTagCount:2,tree:[{title:t(P.audienceSegmentTypeMessages.USER_LIST),value:"USER_LIST",childrenFilterName:"feed_type",children:[{title:t(P.userListFeedTypeMessages.FILE_IMPORT),value:"FILE_IMPORT"},{title:t(P.userListFeedTypeMessages.SCENARIO),value:"SCENARIO"}]},{title:t(P.audienceSegmentTypeMessages.USER_QUERY),value:"USER_QUERY"},{title:t(P.audienceSegmentTypeMessages.USER_ACTIVATION),value:"USER_ACTIVATION"},{title:t(P.audienceSegmentTypeMessages.USER_PARTITION),value:"USER_PARTITION"},{title:t(P.audienceSegmentTypeMessages.USER_LOOKALIKE),value:"USER_LOOKALIKE"},{title:t(P.audienceSegmentTypeMessages.USER_PIXEL),value:"USER_PIXEL"},{title:t(P.audienceSegmentTypeMessages.EDGE),value:"EDGE"}],selectedItems:r.type.concat(r.feed_type.map((function(e){return"USER_LIST_"+e}))),handleItemClick:function(e){n.updateLocationSearch(Object.assign(Object.assign({},e),{currentPage:1}))}};return o.createElement(T.default,i)},n.state={list:{isLoading:!0,total:0,segments:[]},hasItems:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.history,n=e.location,a=n.search,r=n.pathname,o=e.match.params.organisationId;if((0,g.isSearchValid)(a,this.getSearchSetting())){var i=(0,g.parseSearch)(a,this.getSearchSetting()),s=i.datamartId;this.fetchAudienceSegments(o,s,i),this.checkIfHasItem(o)}else t.replace({pathname:r,search:(0,g.buildDefaultSearch)(a,this.getSearchSetting()),state:{reloadDataSource:!0}})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.match.params.organisationId,a=t.location,r=a.search,o=a.pathname,i=t.history,s=e.match.params.organisationId,c=e.location.search,u=(0,g.parseSearch)(r,this.getSearchSetting()),d=(0,g.parseSearch)(c,this.getSearchSetting()),f=u.datamartId;(0,g.isSearchValid)(r,this.getSearchSetting())?(!(0,g.compareSearches)(c,r)||s!==n||!l.default.isEqual(d,u)||d.orderBy!==u.orderBy&&u.pageSize<this.state.list.total)&&this.fetchAudienceSegments(n,f,u):i.replace({pathname:o,search:(0,g.buildDefaultSearch)(r,this.getSearchSetting()),state:{reloadDataSource:!0}})}},{key:"componentWillUnmount",value:function(){this.cancellablePromises.forEach((function(e){e.cancel()}))}},{key:"getSearchSetting",value:function(){return[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(m.SEGMENTS_SEARCH_SETTINGS))}},{key:"getColumnButton",value:function(e){var t=this,n=this.state,a=n.isAsc,r=n.sortField;return o.createElement(y.Button,{onClick:function(){return t.columnStatSort(e)}},o.createElement(f.FormattedMessage,j[e]),o.createElement("div",{className:"mcs-table-header-icons"},o.createElement(y.McsIcon,{type:"chevron",className:a&&r===e?"mcs-table-header-icon":""}),o.createElement(y.McsIcon,{type:"chevron",className:!1===a&&r===e?"mcs-table-header-icon":""})))}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.location.search,r=t.labels,i=t.intl,s=t.workspace,l=this.state,c=l.hasItems,d=l.list,m=(0,g.parseSearch)(a,this.getSearchSetting()),h={placeholder:i.formatMessage(C.searchTitle),onSearch:function(t){return e.updateLocationSearch({keywords:t,currentPage:1})},defaultValue:m.keywords},v={current:m.currentPage,pageSize:m.pageSize,total:this.state.list.total,onChange:function(t,n){return e.updateLocationSearch({currentPage:t,pageSize:n})},onShowSizeChange:function(t,n){return e.updateLocationSearch({currentPage:1,pageSize:n})}},b=[{key:"action",actions:function(){return[{intlMessage:C.editSegment,callback:e.editSegment}]}}],_=s(n).datamarts.map((function(e){return{key:e.id,value:e.name||e.token}})).concat([{key:"",value:"All"}]),S=[];if(s(n).datamarts.length>1){var E={displayElement:o.createElement("div",null,o.createElement(f.FormattedMessage,{id:"audience.segments.list.datamartFilter",defaultMessage:"Datamart"})," ",o.createElement(u.DownOutlined,null)),selectedItems:m.datamartId?[_.find((function(e){return e.key===m.datamartId}))]:[_],items:_,singleSelectOnly:!0,getKey:function(e){return e&&e.key?e.key:""},display:function(e){return e.value},handleItemClick:function(t){e.updateLocationSearch({datamartId:t&&t.key?t.key:void 0,currentPage:1})}};S.push(E)}var O={labels:this.props.labels,selectedLabels:r.filter((function(e){return!!m.label_id.find((function(t){return t===e.id}))})),onChange:function(t){var n=t.map((function(e){return e.id}));e.updateLocationSearch({label_id:n,currentPage:1})},buttonMessage:C.filterByLabel};return c?o.createElement("div",{className:"mcs-table-container mcs-audienceSegmentTable"},o.createElement(p.TableViewFilters,{columns:this.buildDataColumns(),actionsColumnsDefinition:b,searchOptions:h,filtersOptions:S,columnsVisibilityOptions:{isEnabled:!0},dataSource:d.segments,loading:d.isLoading,pagination:v,labelsOptions:O,treeSelectFilter:this.renderTreeSelectFilter})):o.createElement(y.EmptyTableView,{iconType:"data",message:i.formatMessage(C.emptySegments)})}}]),t}(o.Component);A([(0,O.lazyInject)(E.TYPES.IAudienceSegmentService)],R.prototype,"_audienceSegmentService",void 0);t.default=(0,v.compose)(c.withRouter,f.injectIntl,b.injectDatamart,(0,s.connect)((function(e){return{labels:e.labels.labelsApi.data,workspace:(0,S.getWorkspace)(e)}})))(R)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(47),l=(a=s)&&a.__esModule?a:{default:a};var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.id=(0,l.default)(),n.onTreeSelectChange=function(e){var t=n.props,a=t.tree,r=t.parentFilterName,o=t.handleItemClick,i={filterName:r,values:a.filter((function(t){return e.some((function(e){return e===t.value}))})).map((function(e){return e.value}))},s=a.map((function(t){return{filterName:t.childrenFilterName,values:t.children?t.children.filter((function(n){return e.some((function(e){return e===t.value+"_"+n.value}))})).map((function(e){return e.value})):[]}})).reduce((function(e,t){return void 0!==t.filterName&&void 0!==t.values&&t.values.length>0?e.concat({filterName:t.filterName,values:t.values}):e}),[]);s.forEach((function(e){var t=a.find((function(t){return t.childrenFilterName===e.filterName}));t&&!i.values.some((function(e){return e===t.value}))&&i.values.push(t.value)}));var l={};a.forEach((function(e){e.childrenFilterName&&(l[e.childrenFilterName]=[])})),l[i.filterName]=i.values,s.forEach((function(e){l[e.filterName]=e.values})),o(l)},n.state={didMount:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.setState({didMount:!0})}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,a=t.tree,r=t.placeholder,s=t.style,l=t.maxTagCount,c=t.selectedItems,u=this.state.didMount,d=a.map((function(e){return{value:e.value,title:e.title,key:e.value,children:e.children&&e.children.map((function(t){return{value:e.value+"_"+t.value,title:t.title,key:e.value+"_"+t.value}}))}})),f=c;f&&f.forEach((function(e){var t=a.find((function(t){return t.value===e}));if(t&&t.children){var n=t.children.map((function(e){return t.value+"_"+e.value})),r=0;n.forEach((function(e){f.includes(e)&&r++})),0!==r&&r!==n.length&&f.splice(f.indexOf(t.value),1)}}));return o.createElement("span",{id:this.id,className:"mcs-treeSelectFilter"},u&&o.createElement(i.TreeSelect,{className:n,treeData:d,treeCheckable:!0,placeholder:r,showCheckedStrategy:"SHOW_PARENT",showSearch:!1,maxTagCount:l,onChange:this.onTreeSelectChange,style:s,value:f,allowClear:!0,getPopupContainer:function(){return document.getElementById(e.id)}}))}}]),t}(o.Component);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(33),l=n(6),c=n(8),u=n(11),d=v(n(142)),f=n(1116),p=n(30),m=n(65),g=v(n(23)),y=n(15),h=n(12);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=(0,l.defineMessages)({exportRunning:{id:"audiencesegment.actionbar.exportRunning",defaultMessage:"Export in progress..."},audienceSegment:{id:"audiencesegment.actionbar.audienceSegment",defaultMessage:"Segments"},newSegment:{id:"audiencesegment.actionbar.newSegment",defaultMessage:"New Segment"},export:{id:"audiencesegment.actionbar.export",defaultMessage:"Export stats"},userQuery:{id:"audiencesegment.actionbar.userQuery",defaultMessage:"User Query"},userPixel:{id:"audiencesegment.actionbar.userPixel",defaultMessage:"User Pixel"},userList:{id:"audiencesegment.actionbar.userList",defaultMessage:"User List"},userActivationClickers:{id:"segment.dashboard.useractivation.clickers",defaultMessage:"{audienceSegmentName} - Clickers"},userActivationExposed:{id:"segment.dashboard.useractivation.exposed",defaultMessage:"{audienceSegmentName} - Exposed"}}),S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getSearchSetting=function(){return[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(f.SEGMENTS_SEARCH_SETTINGS))},n.formatUserActivationSegmentName=function(e){var t=n.props.intl;return e.clickers?t.formatMessage(_.userActivationClickers,{audienceSegmentName:e.name}):e.exposed?t.formatMessage(_.userActivationExposed,{audienceSegmentName:e.name}):e.name},n.fetchExportData=function(e,t,a){var r;return n._audienceSegmentService.getSegments(e,(r={first_result:0,max_results:5e3},a.keywords&&(r.keywords=a.keywords),t&&(r.datamart_id=t),a.type&&a.type.length>0&&(r.type=a.type),a.label_id&&a.label_id.length&&(r.label_id=a.label_id),a.orderBy&&a.orderBy.length&&(r.order_by=a.orderBy),r)).then((function(e){return e.data.map((function(e){var t="USER_ACTIVATION"===e.type?n.formatUserActivationSegmentName(e):e.name;return Object.assign(Object.assign({},e),{name:t})}))})).catch((function(e){n.props.notifyError(e)}))},n.handleRunExport=function(){var e=n.props,t=e.match.params.organisationId,a=e.intl.formatMessage,r=e.notifyError,o=(0,p.parseSearch)(n.props.location.search,n.getSearchSetting());n.setState({exportIsRunning:!0});var s=i.message.loading(a(_.exportRunning),0),l=o.datamartId?o.datamartId:void 0;n.fetchExportData(t,l,o).then((function(e){d.default.exportAudienceSegments(t,l,e,o,a),n.setState({exportIsRunning:!1}),s()})).catch((function(e){r(e),n.setState({exportIsRunning:!1}),s()}))},n.state={exportIsRunning:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.intl,a=this.state.exportIsRunning,r=[{name:n.formatMessage(_.audienceSegment),path:"/v2/o/"+t+"/audience/segments"}];return o.createElement(u.Actionbar,{paths:r},o.createElement(s.Link,{to:{pathname:"/v2/o/"+t+"/audience/segments/create"}},o.createElement(i.Button,{className:"mcs-primary",type:"primary"},o.createElement(u.McsIcon,{type:"plus"})," ",o.createElement(l.FormattedMessage,_.newSegment))),o.createElement(i.Button,{onClick:this.handleRunExport,loading:a},!a&&o.createElement(u.McsIcon,{type:"download"}),o.createElement(l.FormattedMessage,_.export)))}}]),t}(o.Component);b([(0,y.lazyInject)(h.TYPES.IAudienceSegmentService)],S.prototype,"_audienceSegmentService",void 0),t.default=(0,c.compose)(s.withRouter,l.injectIntl,m.injectDatamart,g.default)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditAudienceSegmentPage=void 0;var a,r=n(2369),o=(a=r)&&a.__esModule?a:{default:a};t.EditAudienceSegmentPage=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=n(25),c=n(13),u=n(10),d=M(n(17)),f=n(6),p=n(228),m=M(n(346)),g=M(n(2370)),y=M(n(23)),h=n(51),v=M(n(200)),b=n(109),_=M(n(2375)),S=n(67),E=n(15),O=n(12),w=n(73);function M(e){return e&&e.__esModule?e:{default:e}}function P(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var T=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},I=(0,f.defineMessages)({breadcrumbEditAudienceSegment:{id:"audience.segment.form.breadcrumb.edit",defaultMessage:"Edit {name}"},breadcrumbAudienceSegmentList:{id:"audience.segment.form.breadcrumb.list",defaultMessage:"Segments"},noQueryText:{id:"audience.segment.form.save.error.noQUeryText",defaultMessage:"You must edit a query in order to save the segment."},editionNotAllowed:{id:"audience.segments.edit.editionNotAllowed",defaultMessage:"Edition is not allowed on USER_ACTIVATION segment."}}),A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.countDefaultLifetime=function(e){var t=d.default.duration(e.audienceSegment.default_ttl,"milliseconds").asMonths();return Number.isInteger(t)&&t>0?{defaultLiftime:t,defaultLiftimeUnit:"months"}:(t=d.default.duration(e.audienceSegment.default_ttl,"milliseconds").asWeeks(),Number.isInteger(t)&&t>0?{defaultLiftime:t,defaultLiftimeUnit:"weeks"}:{defaultLiftime:t=d.default.duration(e.audienceSegment.default_ttl,"milliseconds").asDays(),defaultLiftimeUnit:"days"})},n.initialLoading=function(e){var t=e.match.params,a=t.organisationId,r=t.segmentId,o=e.workspace;if(r)n._audienceSegmentFormService.loadSegmentInitialValue(r).then((function(e){n._datamartService.getDatamart(e.audienceSegment.datamart_id).then((function(e){return e.data})).then((function(t){var a={audienceSegmentFormData:Object.assign(Object.assign({},e),{defaultLifetime:n.countDefaultLifetime(e).defaultLiftime,defaultLifetimeUnit:n.countDefaultLifetime(e).defaultLiftimeUnit}),selectedDatamart:t,loading:!1};if(e.query){a.queryLanguage=e.query.query_language;var r=e.audienceSegment;r.audience_builder_id?n._audienceBuilderService.getAudienceBuilder(r.datamart_id,r.audience_builder_id).then((function(e){a.audienceBuilder=e.data,n.setState(a)})):n.setState(a)}else n.setState(a)}))})).catch((function(t){e.notifyError(t),n.setState({loading:!1})}));else{var i=o(a).datamarts.length>1;n.setState({loading:!1,displayDatamartSelector:i,selectedDatamart:i?void 0:o(a).datamarts[0]})}},n.onSubmitFail=function(){var e=n.props.intl;u.message.error(e.formatMessage(m.default.errorFormMessage))},n.onClose=function(){var e=n.props,t=e.history,a=e.match.params.organisationId,r=e.location,o="/v2/o/"+a+"/audience/segments";return r.state&&r.state.from?t.push(r.state.from):t.push(o)},n.shouldWarnProcessings=function(e){var t=e.initialProcessingSelectionResources,n=e.processingActivities,a=t.map((function(e){return e.processing_id})),r=n.map((function(e){return e.model.id}));return void 0!==e.audienceSegment.id&&!(t.length===r.length&&a.every((function(e){return r.includes(e)})))},n.checkProcessingsAndSave=function(e){var t=n.props.intl.formatMessage,a=n.shouldWarnProcessings(e),r=function(){n.save(e)};a?u.Modal.confirm({content:t(m.default.processingsWarningModalContent),okText:t(m.default.processingsWarningModalOk),cancelText:t(m.default.processingsWarningModalCancel),onOk:function(){return r()}}):r()},n.save=function(e){var t=n.props,a=t.match.params.organisationId,r=t.notifyError,o=t.history,i=t.intl,s=n.state,l=s.selectedDatamart,c=s.queryLanguage;if("USER_QUERY"===e.audienceSegment.type&&!e.query||"USER_LIST"===e.audienceSegment.type&&"USER_CLIENT"===e.audienceSegment.subtype&&!e.query||"USER_LIST"===e.audienceSegment.type&&"EDGE"===e.audienceSegment.subtype&&!e.query)u.message.error(i.formatMessage(I.noQueryText));else if("USER_ACTIVATION"===e.audienceSegment.type)u.message.error(i.formatMessage(I.editionNotAllowed));else{n.setState({loading:!0});var f=l?l.id:e.audienceSegment.datamart_id,p=Object.assign(Object.assign({},e.audienceSegment),{default_ttl:function(e){if(e.defaultLifetimeUnit&&e.defaultLifetime)return d.default.duration(Number(e.defaultLifetime),e.defaultLifetimeUnit).asMilliseconds()}(e),datamart_id:f,organisation_id:a});e=Object.assign(Object.assign({},e),{audienceSegment:p});var g=u.message.loading(i.formatMessage(m.default.savingInProgress),0);n._audienceSegmentFormService.saveOrCreateAudienceSegment(a,e,c).then((function(t){var a,r,o,i,s,l,c,u,d;return t&&Promise.all([].concat(P((a=t.data.id,r=e.initialProcessingSelectionResources,o=e.processingActivities,i=r.map((function(e){return e.processing_id})),s=o.map((function(e){return e.model.id})),l=s.filter((function(e){return!i.includes(e)})),c=i.filter((function(e){return!s.includes(e)})),u=l.map((function(e){var t=o.find((function(t){return t.model.id===e}));if(t){var r=t.model,i={processing_id:r.id,processing_name:r.name};return n._audienceSegmentFormService.createProcessingSelectionForAudienceSegment(a,i)}return Promise.resolve({})})),d=c.map((function(e){var t=r.find((function(t){return t.processing_id===e}));if(t){var o=t.id;return n._audienceSegmentFormService.deleteAudienceSegmentProcessingSelection(a,o)}return Promise.resolve()})),[].concat(P(u),P(d)))))),t})).then((function(t){if(g(),t){var n="";n="USER_LIST"!==t.data.type||e.audienceSegment.id||"USER_PIXEL"!==e.audienceSegment.subtype?"/v2/o/"+a+"/audience/segments/"+t.data.id:"/v2/o/"+a+"/audience/segments/"+t.data.id+"/edit",o.push(n)}})).catch((function(e){g(),n.setState({loading:!1}),r(e)}))}},n.redirectToSegmentList=function(){var e=n.props,t=e.history,a=e.match.params.organisationId;return t.push("/v2/o/"+a+"/audience/segments")},n.onDatamartSelect=function(e){n.setState({selectedDatamart:e,queryLanguage:"OTQL",displayDatamartSelector:!1})},n.onSegmentTypeSelect=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"OTQL",a=t;"USER_PIXEL"===e?n.setState({audienceSegmentFormData:Object.assign(Object.assign({},n.state.audienceSegmentFormData),{audienceSegment:Object.assign(Object.assign({},n.state.audienceSegmentFormData.audienceSegment),{type:"USER_LIST",feed_type:"TAG",subtype:"USER_PIXEL"})})}):"USER_LIST"===e?n.setState({audienceSegmentFormData:Object.assign(Object.assign({},n.state.audienceSegmentFormData),{audienceSegment:Object.assign(Object.assign({},n.state.audienceSegmentFormData.audienceSegment),{type:"USER_LIST",feed_type:"FILE_IMPORT",subtype:"STANDARD"})})}):"USER_QUERY"===e?n.setState({queryLanguage:a,audienceSegmentFormData:Object.assign(Object.assign({},n.state.audienceSegmentFormData),{audienceSegment:Object.assign(Object.assign({},n.state.audienceSegmentFormData.audienceSegment),{type:"USER_QUERY"})})}):"EDGE"===e&&n.setState({queryLanguage:"JSON_OTQL",audienceSegmentFormData:Object.assign(Object.assign({},n.state.audienceSegmentFormData),{audienceSegment:Object.assign(Object.assign({},n.state.audienceSegmentFormData.audienceSegment),{type:"USER_LIST",feed_type:"TAG",subtype:"EDGE"})})})},n.getSegmentTypesToDisplay=function(){var e=n.state.selectedDatamart,t=n.props.hasFeature,a=[];return e&&"v201709"===e.storage_model_version&&a.push({title:"User Pixel",value:"USER_PIXEL"},{title:"User Expert Query",value:"USER_QUERY"}),t("audience-user_client_segment")&&a.push({title:"Edge",value:"EDGE"}),a},n.state={audienceSegmentFormData:p.INITIAL_AUDIENCE_SEGMENT_FORM_DATA,loading:!0,displayDatamartSelector:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.initialLoading(this.props)}},{key:"componentDidUpdate",value:function(e){this.props.match.params.segmentId!==e.match.params.segmentId&&this.initialLoading(this.props)}},{key:"render",value:function(){var e=this,t=this.props,n=t.intl.formatMessage,r=t.match.params,o=r.organisationId,s=r.segmentId,l=this.state,c=l.audienceSegmentFormData,u=l.selectedDatamart,d=l.loading,f=l.displayDatamartSelector,p=l.queryLanguage,y=l.audienceBuilder,S=c.audienceSegment&&c.audienceSegment.name?n(I.breadcrumbEditAudienceSegment,{name:c.audienceSegment.name}):n(m.default.audienceSegmentBreadCrumb),E=[{name:n(I.breadcrumbAudienceSegmentList),path:"/v2/o/"+o+"/audience/segments"},{name:S}],O=void 0;s||(O=function(){e.setState({audienceSegmentFormData:{audienceSegment:{},initialProcessingSelectionResources:[],processingActivities:[]}})});var w={onClose:this.redirectToSegmentList,formId:"audienceSegmentForm"};if(d)return i.createElement(h.Loading,{isFullScreen:!0});var M=c.audienceSegment.id?c.initialProcessingSelectionResources:void 0,P=void 0;c.audienceSegment&&(P="USER_LIST"===c.audienceSegment.type&&"TAG"===c.audienceSegment.feed_type?"JSON_OTQL"===p?"USER_LIST":"USER_PIXEL":c.audienceSegment.type);var T=this.state.audienceSegmentFormData.query&&this.state.audienceSegmentFormData.query.query_language?this.state.audienceSegmentFormData.query.query_language:this.state.queryLanguage;return s||P&&u?i.createElement(g.default,{initialValues:this.state.audienceSegmentFormData,close:this.onClose,onSubmit:this.checkProcessingsAndSave,breadCrumbPaths:E,audienceSegmentFormData:this.state.audienceSegmentFormData,datamart:u,segmentCreation:!s,queryLanguage:T,segmentType:P,goToSegmentTypeSelection:O,initialProcessingSelectionsForWarning:M,audienceBuilder:y}):f?i.createElement(v.default,{onSelect:this.onDatamartSelect,actionbarProps:{paths:E,onClose:this.onClose}}):i.createElement(b.EditContentLayout,a({paths:E},w),i.createElement(_.default,{onSelect:this.onSegmentTypeSelect,segmentTypesToDisplay:this.getSegmentTypesToDisplay()}))}}]),t}(i.Component);T([(0,E.lazyInject)(O.TYPES.IAudienceSegmentFormService)],A.prototype,"_audienceSegmentFormService",void 0),T([(0,E.lazyInject)(O.TYPES.IDatamartService)],A.prototype,"_datamartService",void 0),T([(0,E.lazyInject)(O.TYPES.IAudienceBuilderService)],A.prototype,"_audienceBuilderService",void 0);t.default=(0,s.compose)(c.withRouter,f.injectIntl,y.default,w.injectFeatures,(0,l.connect)((function(e){return{workspace:(0,S.getWorkspace)(e)}})))(A)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(35),l=n(6),c=n(10),u=n(8),d=I(n(60)),f=I(n(101)),p=I(n(49)),m=I(n(346)),g=I(n(63)),y=I(n(2371)),h=n(2372),v=n(24),b=I(n(787)),_=I(n(812)),S=I(n(1030)),E=n(73),O=I(n(420)),w=n(2374),M=n(15),P=n(12),T=n(25);function I(e){return e&&e.__esModule?e:{default:e}}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var j=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},R=t.FORM_ID="audienceSegmentForm",N=c.Layout.Content,k=s.Field,D=s.Field,F=s.FieldArray,L=function(e){function t(){A(this,t);var e=C(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.generateUserQueryTemplate=function(e){return i.createElement("div",null,i.createElement(v.FormSection,{title:m.default.audienceSegmentSectionQueryTitle,subtitle:m.default.audienceSegmentSectionQuerySubTitle}),e)},e.renderPropertiesField=function(){var t=e.props,n=t.datamart,a=t.queryLanguage,r=t.intl,o=t.initialValues,s=t.segmentType,l=t.audienceSegmentFormData,u=t.audienceBuilder,d=s||(o&&o.audienceSegment?o.audienceSegment.type:void 0),f=n?n.id:l.audienceSegment.datamart_id;switch(d){case"USER_LIST":return o&&o.audienceSegment&&"TAG"===o.audienceSegment.feed_type?e.generateUserQueryTemplate(i.createElement(D,{name:"query.query_text",component:S.default,inputProps:{datamartId:f,context:"GOALS",isEdge:"EDGE"===o.audienceSegment.subtype,queryHasChanged:e.hasQueryChanged()}})):i.createElement(h.UserListSection,{segmentId:l.audienceSegment.id});case"USER_PIXEL":return n&&l.audienceSegment.technical_name?i.createElement(b.default,{language:"html",codeSnippet:'<img style="display:none" src="https://events.mediarithmics.com/v1/user_lists/pixel?$dat_token='+n.token+"&$segtn="+encodeURIComponent(l.audienceSegment.technical_name)+'" />',copyToClipboard:!0}):i.createElement(c.Alert,{message:r.formatMessage(m.default.configureAudienceSegmentTechnicalName),type:"warning"});case"USER_QUERY":return"OTQL"===a?e.generateUserQueryTemplate(i.createElement(k,{name:"query.query_text",component:_.default,formItemProps:{label:r.formatMessage(m.default.audienceSegmentSectionQueryTitle)},helpToolTipProps:{title:r.formatMessage(m.default.audienceSegmentCreationUserQueryFieldHelper)},datamartId:f})):"JSON_OTQL"===a?e.generateUserQueryTemplate(i.createElement(D,{name:"query.query_text",component:S.default,inputProps:{datamartId:f,context:"GOALS",queryHasChanged:e.hasQueryChanged(),segmentEditor:o.audienceSegment.segment_editor,audienceBuilder:u}})):i.createElement(c.Alert,{message:r.formatMessage(m.default.noMoreSupported),type:"warning"});default:return i.createElement("div",null,"Not Supported")}},e.hasQueryChanged=function(){var t=e.props,n=t.formValues,a=t.initialValues;return n.query&&a.query&&n.query.query_text!==a.query.query_text||n.query&&!!n.query.query_text&&!a.query},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.handleSubmit,r=t.close,o=t.segmentType,l=t.segmentCreation,u=t.breadCrumbPaths,p=t.datamart,g=t.initialValues,h=t.goToSegmentTypeSelection,v=t.change,b=t.hasFeature,_=t.initialProcessingSelectionsForWarning,S=t.audienceSegmentFormData,E=t.queryLanguage,M=o||(g&&g.audienceSegment?g.audienceSegment.type:void 0),P={formId:R,paths:u,message:m.default.audienceSegmentSaveButton,onClose:r},T=S.query;"USER_QUERY"===M&&"JSON_OTQL"===E&&p&&T&&(P.convert2Otql=function(){return e._queryService.convertJsonOtql2Otql(p.id,T)});var I=[];I.push({id:"general",title:m.default.audienceSegmentSectionGeneralTitle,component:i.createElement(y.default,{segmentCreation:l,segmentType:M,datamart:p})});var A=S.audienceSegment,C="USER_QUERY"===M,j=(0,w.isPartialUserListSegment)(A);if(b("datamart-user_choices")&&(C||j)){var k={formChange:v,rerenderOnEveryChange:!0},D=(0,w.isPartialUserListSegment)(A)&&"EDGE"===A.subtype?"SEGMENT-EDGE":"SEGMENT";I.push({id:"processingActivities",title:m.default.sectionProcessingActivitiesTitle,component:i.createElement(F,a({name:"processingActivities",component:O.default,initialProcessingSelectionsForWarning:_,processingsAssociatedType:D},k))})}!(!l||"USER_PIXEL"!==M&&"USER_LIST"!==M||"USER_LIST"===M&&g&&g.audienceSegment&&"TAG"===g.audienceSegment.feed_type)||"USER_LIST"===M&&g&&g.audienceSegment&&"SCENARIO"===g.audienceSegment.feed_type||I.push({id:"properties",title:"USER_PIXEL"===M?m.default.audienceSegmentSiderMenuProperties:"USER_QUERY"===M||"USER_LIST"===M&&g&&"TAG"===g.feedType?m.default.audienceSegmentSectionQueryTitle:m.default.audienceSegmentSiderMenuImport,component:this.renderPropertiesField()});var L={items:I.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:R};h&&L.items.unshift({sectionId:"type",title:m.default.audienceSegmentSiderMenuType,onClick:h,type:"validated"});var x=I.map((function(e,t){return e.component?i.createElement("div",{key:e.id},i.createElement("div",{key:e.id,id:e.id},e.component),t!==I.length-1&&i.createElement("hr",null)):null}));return i.createElement(c.Layout,{className:"edit-layout"},i.createElement(d.default,P),i.createElement(c.Layout,{className:"ant-layout-has-sider"},i.createElement(f.default,L),i.createElement(s.Form,{className:"edit-layout ant-layout",onSubmit:n},i.createElement("button",{type:"submit",style:{display:"none"}}),i.createElement(N,{id:R,className:"mcs-content-container mcs-form-container"},x))))}}]),t}(i.Component);j([(0,M.lazyInject)(P.TYPES.IQueryService)],L.prototype,"_queryService",void 0),t.default=(0,u.compose)(l.injectIntl,E.injectFeatures,p.default,g.default,(0,s.reduxForm)({form:R,enableReinitialize:!0}),(0,T.connect)((function(e){return{formValues:(0,s.getFormValues)(R)(e)}})))(L)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(8),s=n(614),l=p(n(49)),c=p(n(346)),u=p(n(63)),d=n(24),f=n(11);function p(e){return e&&e.__esModule?e:{default:e}}var m=(0,o.defineMessages)({audienceSegmentFormSelectTypeOptionUserList:{id:"audience.segment.section1.select.type.option.list",defaultMessage:"User List"},audienceSegmentFormSelectTypeOptionUserPixel:{id:"audience.segment.section1.select.type.option.pixel",defaultMessage:"User Pixel"},audienceSegmentFormSelectTypeOptionUserQuery:{id:"audience.segment.section1.select.type.option.query",defaultMessage:"User Query"}}),g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.handleOnchangeTechnicalName=function(e){n.setState({technicalName:e.target.value})},n.getTechnicalNameField=function(){var e=n.props.intl.formatMessage;return r.createElement(d.FormAlertInputField,{name:"audienceSegment.technical_name",component:d.FormAlertInput,onChange:n.handleOnchangeTechnicalName,formItemProps:{label:e(c.default.contentSectionGeneralAdvancedPartRow1Label)},inputProps:{placeholder:e(c.default.contentSectionGeneralAdvancedPartRow1Placeholder)},helpToolTipProps:{title:e(c.default.contentSectionGeneralAdvancedPartRow1Tooltip)},iconType:"warning",type:"warning",message:e(c.default.warningOnTokenEdition)})},n.getAudienceTypeOptions=function(){var e=n.props,t=e.intl.formatMessage,a=e.datamart,r=[{value:"USER_LIST",title:t(m.audienceSegmentFormSelectTypeOptionUserList)},{value:"USER_QUERY",title:t(m.audienceSegmentFormSelectTypeOptionUserQuery)}];return a&&"v201709"===a.storage_model_version&&r.push({value:"USER_PIXEL",title:t(m.audienceSegmentFormSelectTypeOptionUserPixel)}),r},n.state={displayAdvancedSection:!1,neverExpire:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators,n=t.isRequired,a=t.isNotZero,o=t.isValidInteger,i=t.isCharLengthLessThan,l=e.intl.formatMessage,u=e.segmentType;return r.createElement("div",null,r.createElement(d.FormSection,{title:c.default.audienceSegmentSectionGeneralTitle,subtitle:c.default.audienceSegmentSectionGeneralSubTitle}),r.createElement("div",{id:"general"},r.createElement("div",null,r.createElement(d.FormInputField,{name:"audienceSegment.name",component:d.FormInput,validate:[n],formItemProps:{label:l(c.default.audienceSegmentCreationGeneralNameFieldTitle),required:!0},inputProps:{placeholder:l(c.default.audienceSegmentCreationGeneralNameFieldPlaceHolder)},helpToolTipProps:{title:l(c.default.audienceSegmentCreationGeneralNameFieldHelper)}})),r.createElement("div",null,r.createElement(d.FormTextAreaField,{name:"audienceSegment.short_description",component:d.FormTextArea,validate:[i(255)],formItemProps:{label:l(c.default.audienceSegmentCreationGeneralDescriptionFieldTitle)},inputProps:{placeholder:l(c.default.audienceSegmentCreationGeneralDescriptionFieldPlaceHolder)},helpToolTipProps:{title:l(c.default.audienceSegmentCreationGeneralDescriptionFieldHelper)}})),r.createElement("div",null,r.createElement(f.Button,{className:"optional-section-title",onClick:this.toggleAdvancedSection},r.createElement(f.McsIcon,{type:"settings"}),r.createElement("span",{className:"step-title"},l(c.default.contentSectionGeneralAdvancedPartTitle)),r.createElement(f.McsIcon,{type:"chevron"})),r.createElement("div",{className:this.state.displayAdvancedSection?"optional-section-content":"hide-section"},this.getTechnicalNameField(),r.createElement("div",null,r.createElement("div",{className:"custom-lifetime"},r.createElement(d.FormInputField,{name:"defaultLifetime",component:d.FormInput,validate:[o,a],formItemProps:{label:l(c.default.contentSectionGeneralAdvancedPartRow2Label)},inputProps:{disabled:this.state.neverExpire,addonAfter:r.createElement("div",null,r.createElement(s.Row,null,r.createElement(d.FormAddonSelectField,{name:"defaultLifetimeUnit",component:d.AddonSelect,disabled:this.state.neverExpire,options:[{value:"days",title:l(c.default.contentSectionGeneralRow5OptionDAY)},{value:"weeks",title:l(c.default.contentSectionGeneralRow5OptionWEEK)},{value:"months",title:l(c.default.contentSectionGeneralRow5OptionMONTH)}]}))),placeholder:l(c.default.contentSectionGeneralAdvancedPartRow2Placeholder),style:{width:"100%"}},helpToolTipProps:{title:l(c.default.contentSectionGeneralAdvancedPartRow2Tooltip)}}))),"USER_QUERY"===u||"USER_LOOKALIKE"===u?r.createElement("div",null,r.createElement(d.FormBooleanField,{name:"audienceSegment.persisted",component:d.FormBoolean,formItemProps:{label:l(c.default.audienceSegmentCreationGeneralPersistedFieldTitle)},helpToolTipProps:{title:l(c.default.audienceSegmentCreationGeneralPersistedFieldHelper)}})):null,r.createElement("div",null,r.createElement(d.FormBooleanField,{name:"audienceSegment.paused",component:d.FormBoolean,formItemProps:{label:l(c.default.audienceSegmentCreationGeneralPausedFieldTitle)},helpToolTipProps:{title:l(c.default.audienceSegmentCreationGeneralPausedFieldHelper)}}))))))}}]),t}(r.Component);t.default=(0,i.compose)(o.injectIntl,l.default,u.default)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserListSection=void 0;var a,r=n(2373),o=(a=r)&&a.__esModule?a:{default:a};t.UserListSection=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=p(n(0)),i=n(6),s=n(35),l=f(n(792)),c=p(n(795)),u=n(24),d=f(n(346));function f(e){return e&&e.__esModule?e:{default:e}}function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.downloadTemplateUserList=function(){var e=l.default.utils.json_to_sheet([{OPERATION:"UPDATE",USER_AGENT_ID:"vec:89998434",USER_ACCOUNT_ID:"",COMPARTMENT_ID:"1",COMPARTMENT_TOKEN:"",EMAIL_HASH:"",EXPIRATION_DURATION:"0",EXPIRATION_TS:"",DATA_BAG:""},{OPERATION:"DELETE",USER_AGENT_ID:"web:321:abcd",USER_ACCOUNT_ID:"",COMPARTMENT_ID:"1",COMPARTMENT_TOKEN:"",EMAIL_HASH:"",EXPIRATION_DURATION:"0",EXPIRATION_TS:"",DATA_BAG:""},{OPERATION:"UPDATE",USER_AGENT_ID:"tech:apx:123",USER_ACCOUNT_ID:"",COMPARTMENT_ID:"",COMPARTMENT_TOKEN:"my_compartment",EMAIL_HASH:"",EXPIRATION_DURATION:"",EXPIRATION_TS:"6516511616516",DATA_BAG:""},{OPERATION:"UPDATE",USER_AGENT_ID:"",USER_ACCOUNT_ID:"my user account",COMPARTMENT_ID:"",COMPARTMENT_TOKEN:"my_compartment",EMAIL_HASH:"",EXPIRATION_DURATION:"10",EXPIRATION_TS:"",DATA_BAG:'{"distance_to_closest_store": 123}}'},{OPERATION:"DELETE",USER_AGENT_ID:"",USER_ACCOUNT_ID:"",COMPARTMENT_ID:"",COMPARTMENT_TOKEN:"",EMAIL_HASH:"my email hash",EXPIRATION_DURATION:"",EXPIRATION_TS:"0",DATA_BAG:'{"distance_to_closest_store": 123}}'}]),t=l.default.utils.book_new();l.default.utils.book_append_sheet(t,e);var n=l.default.write(t,{bookType:"csv",type:"binary"});c.saveAs(new Blob([function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),a=0;a!==e.length;++a)n[a]=e.charCodeAt(a);return t}(n)],{type:"application/octet-stream"}),"template_import_user_segment.csv")},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=s.Field,t={maxFileSize:104857600,uploadTitle:d.default.uploadTitle,uploadMessage:d.default.uploadMessage,uploadError:d.default.uploadError,fileMasks:".csv,.tsv"};return o.createElement("div",null,o.createElement(u.FormSection,{dropdownItems:[{id:d.default.downloadTemplate.id,message:d.default.downloadTemplate,onClick:this.downloadTemplateUserList}],title:d.default.audienceSegmentSectionImportTitle,subtitle:d.default.audienceSegmentSectionImportSubTitle}),o.createElement(e,a({name:"userListFiles",component:u.FormDragAndDrop},t)))}}]),t}(o.Component);t.default=(0,i.injectIntl)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPartialUserListSegment=function(e){return"USER_LIST"===e.type}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(6),s=n(24),l=n(11);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=o.Layout.Content,f=(0,i.defineMessages)({listTitle:{id:"audience.segments.form.segmentTypeSelector.title",defaultMessage:"Segment Types"},listSubtitle:{id:"audience.segments.form.segmentTypeSelector.subtitle",defaultMessage:"Choose your segment type"},segmentTypeOr:{id:"audience.segments.form.segmentTypeSelector.or",defaultMessage:"Or"},otherSegmentTypes:{id:"audience.segments.form.segmentTypeSelector.other",defaultMessage:"Other segment types"}}),p=function(e){function t(){c(this,t);var e=u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.onSelect=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(){e.props.onSelect(t,n?"OTQL":"JSON_OTQL")}},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props.segmentTypesToDisplay;return r.createElement(o.Layout,null,r.createElement("div",{className:"edit-layout ant-layout"},r.createElement(o.Layout,null,r.createElement(d,{className:"mcs-content-container mcs-form-container text-center"},r.createElement(s.FormTitle,{title:f.listTitle,subtitle:f.listSubtitle}),r.createElement(o.Row,{className:"mcs-selector_container"},r.createElement(o.Row,{className:"menu"},r.createElement("div",{className:"presentation"},r.createElement(l.MenuPresentational,{title:"User Query",type:"user-query",select:this.onSelect("USER_QUERY")}),r.createElement("div",{className:"separator"},r.createElement(i.FormattedMessage,f.segmentTypeOr)),r.createElement(l.MenuPresentational,{title:"User List",type:"user-list",select:this.onSelect("USER_LIST")}))),t.length>0&&r.createElement("div",null,r.createElement(o.Row,{className:"intermediate-title"},r.createElement(i.FormattedMessage,f.otherSegmentTypes)),r.createElement(o.Row,{className:"menu"},t.map((function(t){return r.createElement(l.MenuList,{key:t.value,title:t.title,select:e.onSelect(t.value,!0)})})))))))))}}]),t}(r.Component);t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudienceSegmentPage=void 0;var a,r=n(2377),o=(a=r)&&a.__esModule?a:{default:a};t.AudienceSegmentPage=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=_(n(0)),i=n(13),s=n(6),l=n(10),c=n(8),u=n(30),d=b(n(2378)),f=b(n(1117)),p=n(12),m=n(15),g=_(n(67)),y=n(25),h=n(228),v=b(n(23));function b(e){return e&&e.__esModule?e:{default:e}}function _(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=l.Layout.Content,O=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.interval=null,n.refreshAudienceSegment=function(e){return new Promise((function(t,a){n.interval=setInterval((function(){n._audienceSegmentService.getSegment(e).then((function(e){return e.data})).then((function(e){if("USER_LOOKALIKE"===e.type&&("CALIBRATED"===e.status||"CALIBRATION_ERROR"===e.status))return clearInterval(n.interval),n.setState({segment:e}),t(e)}))}),2e3)}))},n.onCalibrationClick=function(){var e=n.state.segment;return e&&e.id&&n._audienceSegmentService.recalibrateAudienceLookAlike(e.id).then((function(t){n.fetchAudienceSegment(e.id).then((function(){n.refreshAudienceSegment(e.id)}))})),Promise.resolve()},n.fetchAudienceSegment=function(e){return n._audienceSegmentService.getSegment(e).then((function(e){var t=e.data;n.setState({isLoading:!1,segment:t}),t&&(0,h.isUserQuerySegment)(t)&&t.control_group_id&&n._audienceSegmentService.getSegment(t.control_group_id).then((function(e){n.setState({controlGroupSegment:e.data})})).catch((function(e){n.props.notifyError(e)}))})).catch((function(e){n.props.notifyError(e)}))},n.state={isLoading:!0,datamarts:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params,n=t.segmentId,a=t.organisationId,r=e.workspaces[a];this.setState({datamarts:r?r.datamarts:[]}),this.fetchAudienceSegment(n)}},{key:"componentWillUnmount",value:function(){this.interval&&clearInterval(this.interval)}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,a=n.location.search,r=n.match.params,o=r.segmentId,i=r.organisationId,s=n.history,l=e.location.search,c=e.match.params,d=c.segmentId,f=c.organisationId,p=this.state.segment,m=t.segment,g=m?m.id:void 0;(!(0,u.compareSearches)(a,l)||o!==d||i!==f||p&&"USER_LOOKALIKE"===p.type&&p.id!==g)&&(i!==f&&s.push("/v2/o/"+i+"/audience/segments"),this.setState({isLoading:!0}),this.fetchAudienceSegment(o))}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.segment,a=e.datamarts,r=e.controlGroupSegment;return o.createElement("div",{className:"ant-layout"},o.createElement(d.default,{isLoading:t,segment:n,onCalibrationClick:this.onCalibrationClick,datamarts:a,controlGroupSegment:r}),o.createElement("div",{className:"ant-layout"},o.createElement(E,{className:"mcs-content-container"},o.createElement(f.default,{isLoading:t,segment:n,datamarts:a,controlGroupSegment:r}))))}}]),t}(o.Component);S([(0,m.lazyInject)(p.TYPES.IAudienceSegmentService)],O.prototype,"_audienceSegmentService",void 0),t.default=(0,c.compose)(i.withRouter,s.injectIntl,v.default,(0,y.connect)((function(e){return{workspaces:g.getWorkspaces(e)}}),void 0))(O)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(33),l=n(8),c=n(6),u=j(n(23)),d=n(30),f=j(n(142)),p=j(n(797)),m=n(202),g=j(m),y=j(n(2379)),h=n(61),v=j(n(273)),b=n(65),_=n(229),S=j(n(78)),E=j(n(81)),O=n(56),w=n(12),M=n(15),P=n(73),T=j(n(2380)),I=n(228),A=j(n(182)),C=n(11);function j(e){return e&&e.__esModule?e:{default:e}}function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var k=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},D=function(e){function t(){R(this,t);var e=N(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state={overlapFetchIsRunning:!1,overlap:void 0,exportIsRunning:!1,showLookalikeModal:!1,datamarts:[]},e.hideExportLoadingMsg=function(){},e.fetchExportData=function(t,n,a,r){var o=e.fetchCounterView(t,[{name:"audience_segment_id",value:n}]),i=e.fetchDashboardView(t,a,r,[{name:"audience_segment_id",value:n}]),s=e._overlapInterval.fetchOverlapAnalysis(n).then((function(t){return e.formatOverlapData(t)}));return Promise.all([o,i,s])},e.formatOverlapData=function(e){return e.data?e.data.formattedOverlap.map((function(e){return{xKey:e.segment_intersect_with.name,yKey:0===e.segment_intersect_with.segment_size?0:e.overlap_number/e.segment_source_size*100,segment_intersect_with:e.segment_intersect_with.id}})):[]},e.fetchCounterView=function(e,t){return S.default.getAudienceSegmentReport(e,new E.default("now"),new E.default("now"),["day"],["user_points","user_accounts","emails","desktop_cookie_ids"],t).then((function(e){return(0,O.normalizeReportView)(e.data.report_view)}))},e.fetchDashboardView=function(e,t,n,a){return S.default.getAudienceSegmentReport(e,t,n,["day"],["user_points","user_accounts","emails","desktop_cookie_ids","user_point_additions","user_point_deletions"],a).then((function(e){return(0,O.normalizeReportView)(e.data.report_view)}))},e.handleRunExport=function(){var t=e.props,n=t.match.params,a=n.organisationId,r=n.segmentId,o=t.location.search,s=t.intl.formatMessage,l=t.segment,c=t.datamarts,u=(0,d.parseSearch)(o,_.SEGMENT_QUERY_SETTINGS);e.setState({exportIsRunning:!0});var m=i.message.loading(s(p.default.exportInProgress),0),g=l&&l.datamart_id,y=c.find((function(e){return e.id===g})),h=y&&y.audience_segment_metrics?y.audience_segment_metrics.filter((function(e){return"LIVE"===e.status})):void 0;e.fetchExportData(a,r,u.from,u.to).then((function(e){return f.default.exportAudienceSegmentDashboard(a,l&&l.datamart_id,e[1],e[2],u,s,l,h)})).then((function(){m(),e.setState({exportIsRunning:!1})})).catch((function(t){m(),i.message.error("There was an error generating your export please try again.",5),e.setState({exportIsRunning:!1})}))},e.onEditClick=function(){var t=e.props,n=t.match.params,a=n.organisationId,r=n.segmentId,o=t.location,i="/v2/o/"+a+"/audience/segments/"+r+"/edit";t.history.push({pathname:i,state:{from:""+o.pathname+o.search}})},e.handleCreateNewFeed=function(){var t=e.props,n=t.match.params,a=n.organisationId,r=n.segmentId,o=t.location,i="/v2/o/"+a+"/audience/segments/"+r+"/feeds/create";t.history.push({pathname:i,state:{from:""+o.pathname+o.search}})},e.onCreateExperimentationClick=function(){var t=e.props,n=t.segment,a=t.intl.formatMessage;(0,t.openNextDrawer)(T.default,{additionalProps:{close:e.props.closeNextDrawer,breadCrumbPaths:[{name:n.name||""},{name:a(g.default.experimentationCreation)}],segment:n}})},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.intl.formatMessage,r=t.segment,s=t.onCalibrationClick,l=t.hasFeature,u=t.controlGroupSegment,d=t.history,f=this.state.exportIsRunning,p=r&&r.datamart_id,h=[{key:a(g.default.audienceSegment),name:a(g.default.audienceSegment),path:"/v2/o/"+n+"/audience/segments"},{key:r?r.name:"",name:r?r.name:""}],b=function(){return s()},_=null;if(r&&"USER_LOOKALIKE"===r.type)switch(r.status){case"DRAFT":_=o.createElement(i.Button,{className:"mcs-primary",type:"primary",onClick:b},o.createElement(C.McsIcon,{type:"bolt"}),o.createElement(c.FormattedMessage,g.default.lookAlikeCalibrationExecution));break;case"CALIBRATING":_=o.createElement(i.Button,{className:"mcs-primary",type:"primary",disabled:!0},o.createElement(C.McsIcon,{type:"bolt"}),o.createElement(c.FormattedMessage,g.default.lookAlikeCalibrationRunning));break;case"CALIBRATION_ERROR":case"CALIBRATED":_=o.createElement(i.Button,{className:"mcs-primary",type:"primary",onClick:b},o.createElement(C.McsIcon,{type:"bolt"}),o.createElement(c.FormattedMessage,g.default.lookAlikeCalibrationErrorSuccess))}var S=o.createElement(i.Menu,{onClick:function(t){switch(t.key){case"LOOKALIKE":return void(p&&e.props.openNextDrawer(y.default,{additionalProps:{datamartId:p,close:e.props.closeNextDrawer,breadCrumbPaths:[{name:r.name||""},{name:a(g.default.lookAlikeCreation)}],initialValues:{source_segment_id:r.id,persisted:!0,type:"USER_LOOKALIKE",lookalike_algorithm:"CLUSTER_OVERLAP",extension_factor:1,datamart_id:p,organisation_id:n}}}));case"EXPERIMENTATION":return r&&(0,I.isUserQuerySegment)(r)&&e.onCreateExperimentationClick();case"CONTROL_GROUP_SEGMENT":return u&&d.push("/v2/o/"+n+"/audience/segments/"+u.id);case"HISTORY":return e.props.openNextDrawer(v.default,{additionalProps:{resourceType:"AUDIENCE_SEGMENT",resourceId:r.id,handleClose:function(){return e.props.closeNextDrawer()},formatProperty:m.formatAudienceSegmentProperty,resourceLinkHelper:{AUDIENCE_SEGMENT:{direction:"CHILD",getType:function(){return o.createElement(c.FormattedMessage,A.default.segmentResourceType)},getName:function(t){return e._audienceSegmentService.getSegment(t).then((function(e){return e.data.name||t}))},goToResource:function(e){d.push("/v2/o/"+n+"/audience/segments/"+e)}}}},size:"small"});default:return function(){return{}}}}},o.createElement(i.Menu.Item,{key:"HISTORY"},o.createElement(c.FormattedMessage,g.default.history)),o.createElement(i.Menu.Item,{key:"LOOKALIKE"},o.createElement(c.FormattedMessage,g.default.lookAlikeCreation)),r&&"USER_QUERY"===r.type&&l("audience-segment_uplift")&&"STANDARD"===r.subtype&&o.createElement(i.Menu.Item,{key:"EXPERIMENTATION"},o.createElement(c.FormattedMessage,g.default.experimentationCreation)),u&&o.createElement(i.Menu.Item,{key:"CONTROL_GROUP_SEGMENT"},o.createElement(c.FormattedMessage,g.default.seeToControlGroupDashboard)));return o.createElement(C.Actionbar,{paths:h},_,o.createElement(i.Button,{className:"mcs-primary",type:"primary",onClick:this.handleCreateNewFeed},o.createElement(C.McsIcon,{type:"bolt"}),o.createElement(c.FormattedMessage,{id:"audience.segments.dashboard.actionbar.feedButton",defaultMessage:"Add a Feed"})),o.createElement(i.Button,{onClick:this.onEditClick},o.createElement(C.McsIcon,{type:"pen"}),o.createElement(c.FormattedMessage,{id:"audience.segments.dashboard.actionbar.editButton",defaultMessage:"Edit"})),o.createElement(i.Button,{onClick:this.handleRunExport,loading:f},o.createElement(C.McsIcon,{type:"download"}),o.createElement(c.FormattedMessage,{id:"audience.segments.dashboard.actionbar.exportButton",defaultMessage:"Export stats"})),r&&"USER_CLIENT"!==r.subtype&&"EDGE"!==r.subtype&&o.createElement(i.Dropdown,{overlay:S,trigger:["click"]},o.createElement(i.Button,null,o.createElement(C.McsIcon,{className:"compact",type:"dots"}))))}}]),t}(o.Component);k([(0,M.lazyInject)(w.TYPES.IOverlapInterval)],D.prototype,"_overlapInterval",void 0),k([(0,M.lazyInject)(w.TYPES.IAudienceSegmentService)],D.prototype,"_audienceSegmentService",void 0),t.default=(0,l.compose)(s.withRouter,c.injectIntl,u.default,h.injectDrawer,b.injectDatamart,P.injectFeatures)(D)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(13),l=n(8),c=n(35),u=n(24),d=n(65),f=n(6),p=O(n(60)),m=O(n(202)),g=n(10),y=O(n(23)),h=n(51),v=n(12),b=n(15),_=n(73),S=n(11),E=n(25);function O(e){return e&&e.__esModule?e:{default:e}}var w=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},P="lookalikeForm",T=g.Layout.Content,I=["partition_based_lookalike","score_based_lookalike"],A=(0,f.defineMessages)({partition_based_lookalike:{id:"audience.segments.lookaliketypeSelector.type.partitionBased",defaultMessage:"Partition based lookalike"},score_based_lookalike:{id:"audience.segments.lookaliketypeSelector.type.scoreBased",defaultMessage:"Score based lookalike"}}),C={labelCol:{span:3},wrapperCol:{span:19,offset:1}},j=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchAudiencePartition=function(){var e=n.props,t=e.match.params.organisationId,a=e.datamartId,r=e.notifyError;n._audiencePartitionsService.getPartitions(t,{first_result:0,max_results:500,status:["PUBLISHED"],datamart_id:a}).then((function(e){return e.data})).then((function(e){return n.setState({partitions:e,loading:!1})})).catch((function(e){r(e),n.setState({loading:!1})}))},n.save=function(e){var t=n.props,a=t.match.params.organisationId,r=t.history,o=t.notifyError,i=t.datamartId,s=t.formValues,l=n.state,c=l.lookalikeType,u=l.similarity;return n.setState({loading:!0},(function(){var t=e.extension_factor,l=M(e,["extension_factor"]),d=t?Object.assign(Object.assign({},l),{extension_factor:t}):Object.assign({},l);("partition_based_lookalike"===c?n._audienceSegmentService.createAudienceSegment(a,d):n._queryService.createQuery(i,{datamart_id:i,query_language:"OTQL",query_text:'SELECT @count{} FROM UserPoint WHERE segments { id = "'+s.source_segment_id+'" } OR segment_scores { scores { score >=  '+-u+"} } "}).then((function(e){return e.data})).then((function(e){return n._audienceSegmentService.createAudienceSegment(a,Object.assign(Object.assign({},l),{type:"USER_QUERY",query_id:e.id,extension_factor:u/100}))}))).then((function(e){return e.data})).then((function(e){n.setState({loading:!1},(function(){n.props.close(),r.push("/v2/o/"+a+"/audience/segments/"+e.id)}))})).catch((function(e){o(e),n.setState({loading:!1})}))}))},n.onSelectLookalikeType=function(e){n.setState({lookalikeType:e})},n.getMinValue=function(){var e=n.props.datamartId;return n._queryService.runOTQLQuery(e,"SELECT { segment_scores { scores { score @min } } } FROM UserPoint",{use_cache:!0}).then((function(e){return e.data.rows[0].aggregations.metric_aggregations[0].value})).then((function(e){n.setState({min:e})}))},n.getMaxValue=function(){var e=n.props.datamartId;return n._queryService.runOTQLQuery(e,"SELECT { segment_scores { scores { score @max } } } FROM UserPoint",{use_cache:!0}).then((function(e){return e.data.rows[0].aggregations.metric_aggregations[0].value})).then((function(e){n.setState({max:e,similarity:-e})}))},n.onChange=function(e){n.setState({similarity:e})},n.onAfterChange=function(e){var t=n.props,a=t.datamartId,r=t.formValues,o='SELECT @count{} FROM UserPoint WHERE segments { id = "'+r.source_segment_id+'" }',i='SELECT @count{} FROM UserPoint WHERE segments { id = "'+r.source_segment_id+'" } OR segment_scores { scores { score >=  '+-e+"} } ";n._queryService.runOTQLQuery(a,o,{use_cache:!0}).then((function(e){return e.data.rows[0].count})).then((function(e){n._queryService.runOTQLQuery(a,i,{use_cache:!0}).then((function(e){return e.data.rows[0].count})).then((function(t){n.setState({extensionRatio:100*(t-e)/e})}))}))},n.state={partitions:[],loading:!0,lookalikeType:"",similarity:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.fetchAudiencePartition(),this.getMinValue(),this.getMaxValue()}},{key:"render",value:function(){var e=this,t=this.props,n=t.intl,r=t.handleSubmit,o=t.breadCrumbPaths,s=t.fieldValidators.isRequired,l=t.close,d=t.hasFeature,f=this.state,y=f.lookalikeType,v=f.extensionRatio,b=f.similarity,_=f.max,E=f.min,O={formId:P,paths:o,message:m.default.lookAlikeCreation,onClose:l};return this.state.loading?i.createElement(h.Loading,{isFullScreen:!0}):d("audience-score_based_lookalike")||"partition_based_lookalike"!==y?"score_based_lookalike"===y?i.createElement(g.Layout,{className:"edit-layout"},i.createElement(p.default,O),i.createElement(g.Layout,null,i.createElement(c.Form,{onSubmit:r(this.save),className:"edit-layout ant-layout"},i.createElement(T,{id:P,className:"mcs-content-container mcs-form-container"},i.createElement("div",{className:"m-t-20 m-b-20"},n.formatMessage(m.default.lookAlikeModalHelper)),i.createElement("div",null,i.createElement(u.FormInputField,{name:"name",component:u.FormInput,validate:[s],props:{formItemProps:Object.assign({label:n.formatMessage(m.default.lookAlikeModalNameLabel),required:!0},C),inputProps:{placeholder:n.formatMessage(m.default.lookAlikeModalNameLabel)}}})),i.createElement("div",null,E&&_?i.createElement(u.FormSliderField,{name:"extension_factor",component:u.FormSlider,validate:[s],formItemProps:Object.assign({label:n.formatMessage(m.default.similarity),required:!0},C),inputProps:{value:b,min:-Math.round(_),max:-Math.round(E),onChange:this.onChange,onAfterChange:this.onAfterChange,tooltipVisible:!1}}):i.createElement(g.Spin,null)),i.createElement("div",null,i.createElement(u.FormFieldWrapper,a({label:n.formatMessage(m.default.extensionFactor)},C),i.createElement("span",{className:"lookalike-form-extensionFactor"},(v?v.toFixed(2):"-")+" %"))),v&&v>100&&i.createElement(g.Alert,{className:"m-b-20",message:n.formatMessage(m.default.lookalikeTooBroad),type:"warning"}))))):i.createElement(g.Layout,{className:"edit-layout"},i.createElement(p.default,O),i.createElement(g.Layout.Content,{className:"mcs-content-container mcs-form-container text-center"},i.createElement(u.FormTitle,{title:m.default.lookalikeTypeSelectorTitle,subtitle:m.default.lookalikeTypeSelectorsubTitle}),i.createElement(g.Row,{className:"mcs-selector_container"},i.createElement(g.Row,{className:"menu"},I.map((function(t){return i.createElement(S.MenuList,{key:t,title:n.formatMessage(A[t]),select:function(){return e.onSelectLookalikeType(t)}})})))))):i.createElement(g.Layout,{className:"edit-layout"},i.createElement(p.default,O),i.createElement(g.Layout,null,i.createElement(c.Form,{onSubmit:r(this.save),className:"edit-layout ant-layout"},i.createElement(T,{id:P,className:"mcs-content-container mcs-form-container"},i.createElement("div",{className:"m-t-20 m-b-20"},n.formatMessage(m.default.lookAlikeModalHelper)),i.createElement("div",null,i.createElement(u.FormInputField,{name:"name",component:u.FormInput,validate:[s],props:{formItemProps:Object.assign({label:n.formatMessage(m.default.lookAlikeModalNameLabel),required:!0},C),inputProps:{placeholder:n.formatMessage(m.default.lookAlikeModalNameLabel)}}})),i.createElement("div",null,i.createElement(u.FormSelectField,{name:"audience_partition_id",component:u.DefaultSelect,options:this.state.partitions.map((function(e){return{title:e.name||e.id,value:e.id}})),validate:[s],formItemProps:Object.assign({label:n.formatMessage(m.default.lookAlikeModalPartitionLabel),required:!0},C)})),i.createElement("div",null,this.props.formValues.audience_partition_id?i.createElement(u.FormSliderField,{name:"extension_factor",component:u.FormSlider,validate:[s],formItemProps:Object.assign({label:n.formatMessage(m.default.lookAlikeModalExtentionFactorLabel),required:!0},C),inputProps:{min:1,max:this.state.partitions.filter((function(t){return t.id===e.props.formValues.audience_partition_id})).map((function(e){return e.part_count}))[0]},helpToolTipProps:{title:n.formatMessage(m.default.tooltipExtensionFactor)}}):i.createElement(g.Row,null,i.createElement(g.Col,{offset:4,style:{width:"66%"}},i.createElement(g.Alert,{message:i.createElement("div",null,i.createElement(S.McsIcon,{type:"warning"}),n.formatMessage(m.default.extensionFactorError)),type:"error"}))))))))}}]),t}(i.Component);w([(0,b.lazyInject)(v.TYPES.IAudiencePartitionsService)],j.prototype,"_audiencePartitionsService",void 0),w([(0,b.lazyInject)(v.TYPES.IAudienceSegmentService)],j.prototype,"_audienceSegmentService",void 0),w([(0,b.lazyInject)(v.TYPES.IQueryService)],j.prototype,"_queryService",void 0);t.default=(0,l.compose)(s.withRouter,d.injectDatamart,_.injectFeatures,u.withValidators,f.injectIntl,y.default,(0,E.connect)((function(e){return{formValues:(0,c.getFormValues)(P)(e)}})),(0,c.reduxForm)({form:P,enableReinitialize:!0}))(j)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INITIAL_EXPERIMENTATION_FORM_DATA=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(8),l=n(6),c=y(n(23)),u=n(12),d=n(15),f=n(617),p=y(f),m=n(10),g=n(205);function y(e){return e&&e.__esModule?e:{default:e}}var h=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},v=t.INITIAL_EXPERIMENTATION_FORM_DATA={engagement:"E_COMMERCE_ENGAGEMENT",weight:0},b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.save=function(e){var t=n.props,a=t.match.params.organisationId,r=t.segment,o=t.intl,i=t.notifyError,s=t.history,l=t.close;n.setState({isSaving:!0});var c=m.message.loading(o.formatMessage(f.messagesMap.savingInProgress),0),u=r.datamart_id,d=e.selectedPartition&&e.selectedPartition.id,p=r.query_id;d&&p&&n._audienceSegmentService.getSegments(a,{audience_partition_id:d,type:["USER_PARTITION"],max_results:500}).then((function(t){var d=Math.round(e.weight/100*t.data.length);(0,g.getFormattedExperimentationQuery)(u,p,n._queryService,t.data.slice(0,d),!1).then((function(y){n._queryService.createQuery(u,Object.assign(Object.assign({},y),{query_text:y.query_text})).then((function(y){n._audienceSegmentService.createAudienceSegment(a,{name:r.name+"-control-group",type:"USER_QUERY",datamart_id:u,subtype:"AB_TESTING_CONTROL_GROUP",weight:e.weight,query_id:y.data.id}).then((function(y){(0,g.getFormattedExperimentationQuery)(u,p,n._queryService,t.data.slice(0,d),!0).then((function(t){n._queryService.createQuery(u,Object.assign(Object.assign({},t),{query_text:t.query_text})).then((function(t){n._audienceSegmentService.updateAudienceSegment(r.id,Object.assign(Object.assign({},r),{query_id:t.data.id,weight:e.weight,target_metric:e.engagement,control_group_id:y.data.id,subtype:"AB_TESTING_EXPERIMENT"})).then((function(e){c(),m.message.success(o.formatMessage(f.messagesMap.successfullyCreated),3),s.push("/v2/o/"+a+"/audience/segments/"+e.data.id),l()})).catch((function(e){i(e),c()}))})).catch((function(e){i(e),c()}))}))})).catch((function(e){i(e),c()}))})).catch((function(e){i(e),c()}))})).catch((function(e){i(e),c()}))})).catch((function(e){i(e),c()}))},n.state={loadingPartitions:!0,partitions:[],formData:v,isSaving:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a={first_result:0,max_results:100,status:["PUBLISHED"],datamart_id:t.segment.datamart_id};return this.setState({loadingPartitions:!0}),this._audiencePartitionService.getPartitions(n,a).then((function(t){e.setState({partitions:t.data,loadingPartitions:!1})})).catch((function(t){e.setState({loadingPartitions:!1})}))}},{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.close,a=this.state,r=a.formData,i=a.partitions,s=a.loadingPartitions;return o.createElement(p.default,{initialValues:r,close:n,onSubmit:this.save,breadCrumbPaths:t,partitions:i,loadingPartitions:s})}}]),t}(o.Component);h([(0,d.lazyInject)(u.TYPES.IAudiencePartitionsService)],b.prototype,"_audiencePartitionService",void 0),h([(0,d.lazyInject)(u.TYPES.IAudienceSegmentService)],b.prototype,"_audienceSegmentService",void 0),h([(0,d.lazyInject)(u.TYPES.IQueryService)],b.prototype,"_queryService",void 0),t.default=(0,s.compose)(i.withRouter,l.injectIntl,c.default)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(33),s=n(17),l=(a=s)&&a.__esModule?a:{default:a},c=n(11),u=n(6),d=n(8),f=n(163),p=n(228),m=n(202),g=n(41);function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=(0,u.defineMessages)({createdOn:{id:"audience.segments.dashboard.createdOn",defaultMessage:"Created on"}}),b=function(e){function t(){return y(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.segment,a=e.isLoading,r=null;n&&("USER_ACTIVATION"===n.type?r=o.createElement(g.RocketOutlined,null):"USER_QUERY"===n.type?r=o.createElement(g.DatabaseOutlined,null):"USER_LIST"===n.type?r=o.createElement(g.SolutionOutlined,null):"USER_LOOKALIKE"===n.type?r=o.createElement(g.UsergroupAddOutlined,null):"USER_PARTITION"===n.type&&(r=o.createElement(g.ApiOutlined,null)));var i=n&&n.creation_ts?l.default.unix(n.creation_ts/1e3).toDate():void 0,s=i?o.createElement("span",{className:"mcs-audienceSegmentDashboard_createdOn"},t(v.createdOn)+" "+i.toLocaleDateString()+" - "+i.toLocaleTimeString()):void 0,d=n?o.createElement(o.Fragment,null,r," ",function(){var e=o.createElement(u.FormattedMessage,m.audienceSegmentTypeMessages.EDGE);if(n){var t=n.subtype;return"USER_CLIENT"===t||"EDGE"===t?e:o.createElement(u.FormattedMessage,m.audienceSegmentTypeMessages[n.type])}}(),(0,p.isUserQuerySegment)(n)&&n.subtype&&"AB_TESTING_EXPERIMENT"===n.subtype&&o.createElement("div",{className:"mcs-audienceSegmentDashboard_subtype"},o.createElement(u.FormattedMessage,m.userQuerySegmentSubtypeMessages[n.subtype])),s):o.createElement("span",null);return o.createElement(c.ContentHeader,{title:o.createElement(f.SegmentNameDisplay,{audienceSegmentResource:n}),subTitle:d,loading:a})}}]),t}(o.Component);t.default=(0,d.compose)(i.withRouter,u.injectIntl)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(11),c=n(2383),u=n(228),d=I(n(23)),f=I(n(2387)),p=n(6),m=I(n(2388)),g=I(n(78)),y=n(56),h=n(30),v=n(229),b=I(n(1118)),_=I(n(2392)),S=n(15),E=n(12),O=I(n(823)),w=n(73),M=I(n(631)),P=n(632),T=n(10);function I(e){return e&&e.__esModule?e:{default:e}}var A=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},C=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchDashboardView=function(e,t,a,r,o){var i=(0,h.parseSearch)(e,v.SEGMENT_QUERY_SETTINGS),s=["user_points","user_point_additions","user_point_deletions"],l=void 0;if(r&&o){var c=r.find((function(e){return e.id===o.datamart_id}));n.fetchDashboardChartView(t,o.datamart_id,o.id),l=c&&c.audience_segment_metrics?c.audience_segment_metrics.map((function(e){return e.technical_name})):void 0}n.fetchAudienceSegmentReport(t,i.from,i.to,[{name:"audience_segment_id",value:a}],l?s.concat(l):s)},n.fetchDashboardChartView=function(e,t,a){n._dashboardService.getSegmentDashboards(e,t,a).then((function(e){n.setState({charts:e.data})})).catch((function(e){n.props.notifyError(e)}))},n.fetchAudienceSegmentReport=function(e,t,a,r,o){return n.setState({dashboard:Object.assign(Object.assign({},n.state.dashboard),{isLoading:!0})}),g.default.getAudienceSegmentReport(e,t,a,["day"],o,r).then((function(e){return n.setState({dashboard:{isLoading:!1,reports:(0,y.normalizeReportView)(e.data.report_view).filter((function(e){return void 0!==e.user_points||null!==e.user_points}))}})}))},n.isDatamartPionus=function(){var e=n.props,t=e.datamarts,a=e.segment,r=a&&a.datamart_id,o=r&&t.find((function(e){return e.id===r}));return o&&"v201506"!==o.storage_model_version},n.buildItems=function(){var e=n.props,t=e.intl,a=e.segment,r=e.datamarts,i=n.state.dashboard,s=[{title:t.formatMessage(j.overview),display:o.createElement(c.Overview,{isFetching:i.isLoading,dataSource:i.reports,datamarts:r,datamartId:a?a.datamart_id:void 0})}];return n.isDatamartPionus()||s.push({title:t.formatMessage(j.additionDeletion),display:o.createElement(c.AdditionDeletion,{isFetching:i.isLoading,dataSource:i.reports})}),a&&(s.push({title:t.formatMessage(j.overlap),display:o.createElement(c.Overlap,{datamartId:a.datamart_id,segment:a})}),"USER_LIST"===a.type&&s.push({title:t.formatMessage(j.imports),display:o.createElement(f.default,{datamartId:a.datamart_id,segmentId:a.id})}),a.persisted&&n.isDatamartPionus()&&n.props.hasFeature("audience-segment_exports")&&s.push({title:t.formatMessage(j.exports),display:o.createElement(_.default,{datamartId:a.datamart_id,segmentId:a.id})})),s},n.getDatamartAnaylicsDashboardConfig=function(e,t,n){return[{title:"Channel engagment",datamartId:t,organisationId:e,config:P.averageSessionDurationConfig,allUserFilter:!1,showFilter:!0},{title:"E-commerce engagment",datamartId:t,organisationId:e,config:P.ecommerceEngagementConfig}]},n.state={loading:!0,dashboard:{isLoading:!0,reports:[]},charts:[],datamartAnalyticsDashboardConfig:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params,n=t.segmentId,a=t.organisationId,r=e.location,o=r.search,i=r.pathname,s=e.segment,l=e.datamarts,c=e.history,u=e.hasFeature;(0,h.isSearchValid)(o,this.getSearchSetting())||u("audience-dashboards-datamart_users_analytics")||c.replace({pathname:i,search:(0,h.buildDefaultSearch)(o,this.getSearchSetting())}),this.fetchDashboardView(o,a,n,l,s)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.match.params,a=n.segmentId,r=n.organisationId,o=t.location.search,i=t.datamarts,s=t.segment,l=t.intl,c=e.match.params.segmentId,u=e.segment,d=e.location.search;(0,h.compareSearches)(o,d)&&a===c&&s===u||(this.fetchDashboardView(o,r,a,i,s),s&&s.datamart_id&&this.setState({datamartAnalyticsDashboardConfig:this.getDatamartAnaylicsDashboardConfig(r,s.datamart_id,l)}))}},{key:"getSearchSetting",value:function(){return[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(v.SEGMENT_QUERY_SETTINGS))}},{key:"render",value:function(){var e=this.props,t=e.intl,n=e.segment,a=e.datamarts,r=e.hasFeature,i=this.state,s=i.charts,c=i.datamartAnalyticsDashboardConfig,d=n?{key:n.id.toString(),label:n.name,value:n.name}:void 0,f=n&&a.find((function(e){return e.id===n.datamart_id})),p=0===s.length&&r("audience-dashboards-datamart_users_analytics")&&f&&n&&(0,u.isUserQuerySegment)(n)&&"AB_TESTING_EXPERIMENT"!==n.subtype;return o.createElement("div",null,n&&n.paused&&o.createElement(T.Alert,{className:"m-b-20",message:t.formatMessage(j.pausedSegment),type:"warning"}),n&&o.createElement(m.default,{datamarts:a,segment:n}),s.map((function(e){return o.createElement(O.default,{key:e.id,layout:e.components,title:e.name,datamartId:e.datamart_id,source:n})})),s.length?o.createElement(l.ContentHeader,{size:"medium",title:"Technical Information"}):null,o.createElement(l.Card,null,o.createElement(l.McsTabs,{items:this.buildItems()})),p&&c.map((function(e,t){return o.createElement(M.default,{key:t.toString(),title:e.title,subTitle:e.subTitle,datamartId:e.datamartId,organisationId:e.organisationId,config:e.config,showFilter:e.showFilter,showDateRangePicker:e.showDateRangePicker,disableAllUserFilter:!0,defaultSegment:d})})),o.createElement(b.default,null))}}]),t}(o.Component);A([(0,S.lazyInject)(E.TYPES.IDashboardService)],C.prototype,"_dashboardService",void 0),t.default=(0,i.compose)(p.injectIntl,s.withRouter,d.default,w.injectFeatures)(C);var j=(0,p.defineMessages)({overview:{id:"audience-segment-dashboard-tab-title-overview",defaultMessage:"Overview"},additionDeletion:{id:"audience-segment-dashboard-tab-title-addition-deletion",defaultMessage:"Addition Deletion"},overlap:{id:"audience-segment-dashboard-tab-title-overlap",defaultMessage:"Overlap"},imports:{id:"audience-segment-dashboard-tab-title-user-list-imports",defaultMessage:"Imports Status"},exports:{id:"audience-segment-dashboard-tab-title-exports",defaultMessage:"Exports"},pausedSegment:{id:"audience-segment-dashboard-warning-paused-segment",defaultMessage:"Warning: This segment has been paused and is no longer refreshed (statistics, user insertions and deletions won't be computed)."}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Overlap=t.AdditionDeletion=t.Overview=void 0;var a=i(n(2384)),r=i(n(2385)),o=i(n(2386));function i(e){return e&&e.__esModule?e:{default:e}}t.Overview=a.default,t.AdditionDeletion=r.default,t.Overlap=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(33),i=n(10),s=n(8),l=n(6),c=n(229),u=n(30),d=g(n(202)),f=g(n(69)),p=n(11),m=g(n(422));function g(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=function(e){function t(){y(this,t);var e=h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.getMetricsDisplayName=function(e,t){var n=t&&t.audience_segment_metrics.find((function(t){return t.technical_name===e}));return n?n.display_name:void 0},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"updateLocationSearch",value:function(e){var t=this.props,n=t.history,a=t.location,r=a.search,o={pathname:a.pathname,search:(0,u.updateSearch)(r,e,c.SEGMENT_QUERY_SETTINGS)};n.push(o)}},{key:"renderDatePicker",value:function(){var e=this,t=this.props.location.search,n=(0,u.parseSearch)(t,c.SEGMENT_QUERY_SETTINGS),a={from:n.from,to:n.to};return r.createElement(p.McsDateRangePicker,{values:a,onChange:function(t){return e.updateLocationSearch({from:t.from,to:t.to})},excludeToday:!0})}},{key:"renderStackedAreaCharts",value:function(){var e=this,t=this.props,n=t.dataSource,a=t.isFetching,o=t.colors,i=t.datamarts,s=t.datamartId,l=t.intl.formatMessage,c=n&&n[0]?Object.keys(n[0]).filter((function(e){return"day"!==e&&"user_point_additions"!==e&&"user_point_deletions"!==e})):[],u=i&&i.find((function(e){return e.id===s})),d=[o["mcs-warning"],o["mcs-info"],o["mcs-success"],o["mcs-error"],o["mcs-highlight"],o["mcs-primary"],o["mcs-normal"]];if(d.length<c.length){var f=d.length;for(f=d.length;f<c.length;f++)d.push(m.default.random().hex())}var g={xKey:"day",yKeys:c.map((function(t){return{key:t,message:e.getMetricsDisplayName(t,u)||l(b[t])}})),colors:d};return a?r.createElement(p.LoadingChart,null):r.createElement(p.StackedAreaPlot,{dataset:n,options:g})}},{key:"render",value:function(){var e=this.props,t=e.dataSource,n=e.isFetching,a=e.intl;return r.createElement("div",null,r.createElement(i.Row,{className:"mcs-chart-header"},r.createElement(i.Col,{span:12},r.createElement("div",null)),r.createElement(i.Col,{span:12},r.createElement("span",{className:"mcs-card-button"},this.renderDatePicker()))),0!==t.length||n?this.renderStackedAreaCharts():r.createElement(p.EmptyChart,{title:a.formatMessage(d.default.noAdditionDeletion),icon:"warning"}))}}]),t}(r.Component);t.default=(0,s.compose)(o.withRouter,l.injectIntl,f.default)(v);var b=(0,l.defineMessages)({user_points:{id:"segment.user_points",defaultMessage:"User Points"},user_accounts:{id:"segment.user_accounts",defaultMessage:"Accounts"},emails:{id:"segment.emails",defaultMessage:"Emails"},desktop_cookie_ids:{id:"segment.desktop_cookie_ids",defaultMessage:"Display Cookies"},user_point_additions:{id:"segment.user_point_additions",defaultMessage:"User Point Additions"},user_point_deletions:{id:"segment.user_point_deletions",defaultMessage:"User Point Deletions"},mobile_ad_ids:{id:"segment.mobile_ad_ids",defaultMessage:"Mobile Ad Ids"},mobile_cookie_ids:{id:"segment.mobile_cookie_ids",defaultMessage:"Mobile Cookie Ids"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(33),i=n(10),s=n(8),l=m(n(202)),c=n(229),u=n(30),d=m(n(69)),f=n(6),p=n(11);function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=function(e){function t(){return g(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"updateLocationSearch",value:function(e){var t=this.props,n=t.history,a=t.location,r=a.search,o={pathname:a.pathname,search:(0,u.updateSearch)(r,e,c.SEGMENT_QUERY_SETTINGS)};n.push(o)}},{key:"renderDatePicker",value:function(){var e=this,t=this.props.location.search,n=(0,u.parseSearch)(t,c.SEGMENT_QUERY_SETTINGS),a={from:n.from,to:n.to};return r.createElement(p.McsDateRangePicker,{values:a,onChange:function(t){return e.updateLocationSearch({from:t.from,to:t.to})}})}},{key:"renderStackedAreaCharts",value:function(){var e=this.props,t=e.dataSource,n=e.isFetching,a=e.colors,o=e.intl.formatMessage,i=t.length?t.map((function(e){return Object.assign(Object.assign({},e),{user_point_deletions:e&&e.user_point_deletions?-e.user_point_deletions:0})})):[],s={xKey:"day",yKeys:[{key:"user_point_additions",message:o(l.default.userPointAddition)},{key:"user_point_deletions",message:o(l.default.userPointDeletion)}],colors:[a["mcs-success"],a["mcs-error"]]};return n?r.createElement(p.LoadingChart,null):r.createElement(p.StackedBarPlot,{dataset:i,options:s})}},{key:"render",value:function(){var e=this.props,t=e.dataSource,n=e.isFetching,a=e.intl;return r.createElement("div",null,r.createElement(i.Row,{className:"mcs-chart-header"},r.createElement(i.Col,{span:12},r.createElement("div",null)),r.createElement(i.Col,{span:12},r.createElement("span",{className:"mcs-card-button"},this.renderDatePicker()))),0!==t.length||n?this.renderStackedAreaCharts():r.createElement(p.EmptyChart,{title:a.formatMessage(l.default.noAdditionDeletion),icon:"warning"}))}}]),t}(r.Component);t.default=(0,s.compose)(o.withRouter,f.injectIntl,d.default)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=v(n(54)),s=n(33),l=n(10),c=v(n(17)),u=n(6),d=n(8),f=v(n(202)),p=v(n(69)),m=n(65),g=n(12),y=n(15),h=n(11);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderModalExtend=function(){var e=n.props,t=e.datamartId,a=e.segment,r=e.match.params.organisationId,i=e.intl.formatMessage;l.Modal.confirm({title:i(f.default.modalOverlapContentTitle),content:o.createElement("div",null,o.createElement("p",null,i(f.default.modalOverlapContentMessage))),onOk:function(){n.setState({isFetchingOverlap:!0}),n._overlapInterval.createOverlapAnalysis(t,a.id,r).then((function(){n._overlapInterval.fetchOverlapAnalysis(a.id).then((function(e){return n.setState({data:e,isFetchingOverlap:!1})}))}))},onCancel:function(){}})},n.state={data:{hasOverlap:!1,isRunning:!1,isInError:!1,data:null},isFetchingOverlap:!0,overlapFetchingError:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.segment;this._overlapInterval.fetchOverlapAnalysisLoop(t.id).then((function(){return e._overlapInterval.fetchOverlapAnalysis(t.id)})).then((function(t){return e.setState({data:t,isFetchingOverlap:!1})})).catch((function(){return e.setState({overlapFetchingError:!0,isFetchingOverlap:!1})}))}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.segment,a=e.segment;i.default.isEqual(n,a)||this.setState({isFetchingOverlap:!0},(function(){t._overlapInterval.fetchOverlapAnalysisLoop(n.id).then((function(){return t._overlapInterval.fetchOverlapAnalysis(n.id)})).then((function(e){return t.setState({data:e,isFetchingOverlap:!1})}))}))}},{key:"componentWillUnmount",value:function(){this._overlapInterval.stopInterval()}},{key:"renderStackedAreaCharts",value:function(){var e=this.props,t=e.colors,n=e.intl.formatMessage,a=this.state,r=a.data,i=a.isFetchingOverlap;if(i)return o.createElement(h.LoadingChart,null);var s=[],l=r.data;l&&l.formattedOverlap.forEach((function(e){e&&s.push({xKey:e.segment_intersect_with.name,yKey:0===e.segment_intersect_with.segment_size?0:e.overlap_number/e.segment_source_size*100})}));var c={xKey:"xKey",yKeys:[{key:"yKey",message:n({id:"overlap.name",defaultMessage:"Overlapping %"})}],colors:[t["mcs-info"]],showLegend:!1};return i?o.createElement(h.LoadingChart,null):o.createElement(h.StackedBarPlot,{dataset:s.sort((function(e,t){return t.yKey-e.yKey})).slice(0,20),options:c})}},{key:"render",value:function(){var e=this.props.intl,t=this.state,n=t.data,a=t.isFetchingOverlap,r=t.overlapFetchingError;return o.createElement("div",null,o.createElement(l.Row,{className:"mcs-chart-header"},o.createElement(l.Col,{span:12},o.createElement("div",null)),o.createElement(l.Col,{span:12,className:"text-right"},!a&&n.hasOverlap&&o.createElement("span",{className:"generated"},o.createElement(u.FormattedMessage,f.default.generated)," ",(0,c.default)(n.data?n.data.date:0).fromNow())," ",!a&&o.createElement(l.Button,{onClick:this.renderModalExtend},o.createElement(h.McsIcon,{type:"extend"})," ",n.hasOverlap?o.createElement(u.FormattedMessage,f.default.refresh):o.createElement(u.FormattedMessage,f.default.createOverlap)))),r?o.createElement(h.EmptyChart,{title:e.formatMessage(f.default.overlapFetchingError),icon:"warning"}):n.hasOverlap||a?this.renderStackedAreaCharts():o.createElement(h.EmptyChart,{title:e.formatMessage(f.default.noAdditionDeletion),icon:"warning"}))}}]),t}(o.Component);b([(0,y.lazyInject)(g.TYPES.IOverlapInterval)],_.prototype,"_overlapInterval",void 0),t.default=(0,d.compose)(s.withRouter,u.injectIntl,p.default,m.injectDatamart)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(33),l=n(56),c=n(412),u=n(68),d=y(n(23)),f=y(n(59)),p=n(12),m=n(15),g=n(6);function y(e){return e&&e.__esModule?e:{default:e}}var h=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},v=u.TableView,b=(0,g.defineMessages)({submissionDate:{id:"audience.segments.dashboard.userImportList.submissionDate",defaultMessage:"Submission Date"},status:{id:"audience.segments.dashboard.userImportList.status",defaultMessage:"Status"},totalUserSegmentTreated:{id:"audience.segments.dashboard.userImportList.totalUserSegmentTreated",defaultMessage:"User Segments Treated"},totalUserSegmentImported:{id:"audience.segments.dashboard.userImportList.totalUserSegmentImported",defaultMessage:"User Segments Imported"}}),_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.refreshData=function(){var e=n.props,t=e.datamartId,a=e.segmentId;n.setState({isLoading:!0}),n._audienceSegmentService.findUserListImportExecutionsBySegment(t,a).then((function(e){n.setState({isLoading:!1,executions:e.data})})).catch((function(e){f.default.error(e),n.props.notifyError(e),n.setState({isLoading:!1})}))},n.state={isLoading:!1,executions:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){this.refreshData()}},{key:"render",value:function(){var e=this.state.isLoading,t=[{intlMessage:b.submissionDate,key:"submissionDate",isVisibleByDefault:!0,isHideable:!1,render:function(e,t){return(0,c.formatUnixTimestamp)(t.submissionDate)}},{intlMessage:b.status,key:"status",isHideable:!1,render:function(e,t){return e}},{intlMessage:b.totalUserSegmentTreated,key:"totalUserSegmentTreated",isVisibleByDefault:!0,isHideable:!1,render:function(e,t){return(0,l.formatMetric)(e,"0","","")}},{intlMessage:b.totalUserSegmentImported,key:"totalUserSegmentImported",isVisibleByDefault:!0,isHideable:!1,render:function(e,t){return(0,l.formatMetric)(e,"0","","")}}],n=this.state.executions.map((function(e){return{status:e.status,totalUserSegmentTreated:e.result?e.result.total_user_segment_treated:void 0,totalUserSegmentImported:e.result?e.result.total_user_segment_imported:void 0,submissionDate:e.creation_date}}));return o.createElement(v,{columns:t,dataSource:n,loading:e})}}]),t}(o.Component);h([(0,m.lazyInject)(p.TYPES.IAudienceSegmentService)],_.prototype,"_audienceSegmentService",void 0),t.default=(0,i.compose)(s.withRouter,d.default)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(13),l=n(202),c=(a=l)&&a.__esModule?a:{default:a},u=n(11);var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getLoadingValue=function(e){var t=n.state.counter;return{value:!t.isLoading&&t.report?t.report[n.adaptKey(e)]:void 0,loading:t.isLoading}},n.getCounters=function(){var e=n.props,t=e.datamarts,a=e.segment,r=e.intl,o=[];o.push(Object.assign({iconType:"full-users",title:r.formatMessage(c.default.userPoints)},n.getLoadingValue("user_points")));var i=t.find((function(e){return e.id===a.datamart_id})),s=i&&i.audience_segment_metrics?i.audience_segment_metrics.map((function(e){return Object.assign({iconType:e.icon,title:e.display_name},n.getLoadingValue(e.technical_name))})):[];return o.concat(s)},n.getKnownCounters=function(){var e=n.props,t=e.datamarts,a=e.intl,r=t[0]&&t[0].audience_segment_metrics?t[0].audience_segment_metrics.map((function(e){return Object.assign({iconType:e.icon,title:e.display_name},n.getLoadingValue(e.technical_name))})):[];return[Object.assign({iconType:"full-users",title:a.formatMessage(c.default.userPoints)},n.getLoadingValue("user_points"))].concat(r)},n.state={counter:{isLoading:!0}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this.props.segment;this.setState({counter:{isLoading:!1,report:e}})}},{key:"adaptKey",value:function(e){return"user_points"===e?"user_points_count":"user_accounts"===e?"user_accounts_count":"emails"===e?"emails_count":"desktop_cookie_ids"===e?"desktop_cookie_ids_count":"mobile_ad_ids"===e?"mobile_ad_ids_count":"mobile_cookie_ids"===e?"mobile_cookie_ids_count":"user_points_count"}},{key:"render",value:function(){var e=this,t=this.props.datamarts;return o.createElement("div",{className:"audience-statistic"},o.createElement(u.CounterDashboard,{counters:t.length>1?e.getCounters():e.getKnownCounters(),invertedColor:!0}))}}]),t}(o.Component);t.default=(0,i.injectIntl)((0,s.withRouter)(d))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=_(n(47)),s=n(11),l=_(n(1119)),c=_(n(23)),u=n(8),d=n(10),f=n(6),p=_(n(630)),m=n(13),g=n(73),y=n(24),h=n(15),v=n(12),b=n(591);function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},O=p.default,w=(0,f.defineMessages)({modalTitle:{id:"audienceFeed.modal.title",defaultMessage:"Are you sure you want to continue ?"},modalDescription:{id:"audienceFeed.modal.description",defaultMessage:"Are you sure you want delete this feed ? Careful this action cannot be undone."},pause:{id:"audienceFeed.status.actions.pause",defaultMessage:"Pause"},activate:{id:"audienceFeed.status.actions.activate",defaultMessage:"Activate"},resume:{id:"audienceFeed.status.actions.resume",defaultMessage:"Resume"},edit:{id:"audienceFeed.card.actions.edit",defaultMessage:"Edit"},stats:{id:"audienceFeed.card.actions.stats",defaultMessage:"Stats (BETA)"},inTheLast7Days:{id:"audienceFeed.card.inTheLast7Days",defaultMessage:"In the last 7 days... (BETA)"},view:{id:"audienceFeed.card.actions.view",defaultMessage:"View"},delete:{id:"audienceFeed.card.actions.delete",defaultMessage:"Delete"},loadingStats:{id:"audienceFeed.card.loadingStats",defaultMessage:"Loading stats..."},nothingSent:{id:"audienceFeed.card.nothingSent",defaultMessage:"Nothing was sent"},userPointsSent:{id:"audienceFeed.card.userPointsSent",defaultMessage:"user points sent"},identifiersSent:{id:"audienceFeed.card.identifiersSent",defaultMessage:"identifiers (cookies, mobile IDs) sent"},feedModalNameFieldLabel:{id:"audience.segment.feed.card.create.nameField.label",defaultMessage:"Name"},feedModalNameFieldTitle:{id:"audience.segment.feed.card.create.nameField.title",defaultMessage:"The name used to identify this feed."},feedModalNameFieldTitleWarning:{id:"audience.segment.feed.card.create.nameField.title.warning",defaultMessage:"Warning: This name is only used in the platform, it won't be visible on the external system."},feedModalNameFieldPlaceholder:{id:"audience.segment.feed.card.create.nameField.placeholder",defaultMessage:"Name"}}),M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.id=(0,i.default)(),n.renderActionButton=function(){var e=n.props,t=e.feed,a=e.onFeedUpdate,r=e.notifyError,i=e.intl,l=function(){t.type;var e=E(t,["type"]),o=n.getNextBestAction(),i=e;return null!==o&&(i=Object.assign(Object.assign({},e),{status:o})),n.setState({isLoading:!0}),n.feedService.updateAudienceFeed(t.id,i).then((function(e){return e.data})).then((function(e){n.setState({isLoading:!1},(function(){a(Object.assign(Object.assign({},e),{type:"EXTERNAL_FEED"}))}))})).catch((function(e){n.setState({isLoading:!1}),r(e)}))};switch(t.status){case"ACTIVE":return o.createElement(s.Button,{onClick:l},i.formatMessage(w.pause));case"INITIAL":return o.createElement(s.Button,{onClick:l},i.formatMessage(w.activate));case"PAUSED":return o.createElement(s.Button,{onClick:l},i.formatMessage(w.resume));case"PUBLISHED":return o.createElement("div",{className:"feedcard-placeholder"})}},n.generateStatusColor=function(){switch(n.props.feed.status){case"ACTIVE":return"mcs-campaigns-status-active";case"INITIAL":return"mcs-campaigns-status-pending";case"PAUSED":return"mcs-campaigns-status-paused";case"PUBLISHED":return"mcs-campaigns-status-pending"}},n.getNextBestAction=function(){switch(n.props.feed.status){case"ACTIVE":return"PAUSED";case"INITIAL":case"PAUSED":return"ACTIVE";case"PUBLISHED":return null}},n.getPluginProperties=function(){var e=n.props.feed;return n._pluginService.findPluginFromVersionId(e.version_id).then((function(e){return n._pluginService.getPluginVersionProperties(e.data.id,e.data.current_version_id)})).then((function(e){return n.setState({pluginProperties:e.data})}))},n.getInitialValues=function(){var e=n.props.feed;return n.feedService.getAudienceFeedProperties(e.id).then((function(t){return n.setState({initialValue:{plugin:e,properties:t.data.reduce((function(e,t){return Object.assign(Object.assign({},e),(n={},a=t.technical_name,r={value:t.value},a in n?Object.defineProperty(n,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[a]=r,n));var n,a,r}),{})}})}))},n.updatePropertiesValue=function(e,t,a){var r=n.feedService.updatePluginInstanceProperty,o=[];return e.forEach((function(e){o.push(r(t,a,e.technical_name,e))})),Promise.all(o)},n.saveOrCreatePluginInstance=function(e,t,a){var r=n.props,o=r.notifyError,i=r.organisationId,s=r.onFeedUpdate,l=n.feedService.updatePluginInstance;n.setState({isLoadingCard:!0});e.type,e.version_value,e.version_id,e.status;var c=E(e,["type","version_value","version_id","status"]);return l(e.id,a?Object.assign(Object.assign({},c),{name:a}):c).then((function(){return n.updatePropertiesValue(t,i,e.id)})).then((function(){n.setState({isLoadingCard:!1,opened:!1}),s(a?Object.assign(Object.assign({},e),{name:a}):e)})).catch((function(e){o(e),n.setState({isLoadingCard:!1})}))},n.state={isLoading:!0,isLoadingCard:!0,opened:!1,modalTab:"configuration",pluginProperties:[]},n._audienceExternalFeedServiceFactory=n._audienceSegmentFeedServiceFactory("EXTERNAL_FEED"),n._audienceTagFeedServiceFactory=n._audienceSegmentFeedServiceFactory("TAG_FEED"),n.props.feed&&(n.feedService="EXTERNAL_FEED"===n.props.feed.type?n._audienceExternalFeedServiceFactory(n.props.segmentId):n._audienceTagFeedServiceFactory(n.props.segmentId)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.feed;this._pluginService.findPluginFromVersionId(t.version_id).then((function(t){null!==t&&"error"!==t.status&&t.data.current_version_id&&e._pluginService.getLocalizedPluginLayout(t.data.id,t.data.current_version_id).then((function(t){null!==t&&e.setState({cardHeaderTitle:t.metadata.display_name,cardHeaderThumbnail:t.metadata.small_icon_asset_url,pluginLayout:t,isLoading:!1})}))})).catch((function(){return e.setState({isLoading:!1})}))}},{key:"getFeedStatsDisplayStatus",value:function(e){return null==e.exportedUserIdentifiersCount&&null==e.exportedUserPointsCount?"LOADING":0===e.exportedUserIdentifiersCount&&0===e.exportedUserPointsCount?"READY-NO-DATA":"READY"}},{key:"getFeedStatsDisplayMsg",value:function(e,t,n,a){switch(t){case"LOADING":return e.formatMessage(w.loadingStats);case"READY-NO-DATA":return e.formatMessage(w.nothingSent);case"READY":switch(n){case"USER_POINTS":return(a.exportedUserPointsCount?a.exportedUserPointsCount.toLocaleString():"-")+" "+e.formatMessage(w.userPointsSent);case"USER_IDENTIFIERS":return(a.exportedUserIdentifiersCount?a.exportedUserIdentifiersCount.toLocaleString():"-")+" "+e.formatMessage(w.identifiersSent);default:return"error"}default:return"error"}}},{key:"render",value:function(){var e=this,t=this.props,n=t.feed,a=t.onFeedDelete,r=t.segmentId,i=t.organisationId,c=t.exportedUserPointsCount,u=t.exportedUserIdentifiersCount,f=t.notifyError,p=t.hasFeature,m=t.history,g=t.intl,y=t.fieldValidators.isRequired,h=t.intl.formatMessage,v=this.state,_=v.isLoading,S=v.cardHeaderTitle,E=v.cardHeaderThumbnail;if(_)return o.createElement(l.default,null);var M=function(t){return function(){return e.state.pluginLayout?(e.setState({opened:!0,isLoadingCard:!0,modalTab:t}),Promise.all([e.getPluginProperties(),e.getInitialValues()]).then((function(){return e.setState({isLoadingCard:!1})})).catch((function(t){f(t),e.setState({opened:!1})}))):m.push(function(){switch(n.type){case"EXTERNAL_FEED":return"/v2/o/"+i+"/audience/segments/"+r+"/feeds/external/"+n.id+"/edit";case"TAG_FEED":return"/v2/o/"+i+"/audience/segments/"+r+"/feeds/tag/"+n.id+"/edit"}}())}},P=o.createElement(d.Menu,null,o.createElement(d.Menu.Item,{key:"0"},o.createElement("a",{onClick:M("configuration")},g.formatMessage(w.edit))),p("audience-feeds_stats")?o.createElement(d.Menu.Item,{key:"1"},o.createElement("a",{onClick:M("stats")},g.formatMessage(w.stats))):null,o.createElement(d.Menu.Item,{key:"2"},o.createElement("a",{onClick:function(){d.Modal.confirm({title:g.formatMessage(w.modalTitle),content:g.formatMessage(w.modalDescription),onOk:function(){return e.setState({isLoading:!0},(function(){return e.feedService.deleteAudienceFeed(n.id).then((function(t){e.setState({isLoading:!1}),a(n)})).catch((function(t){e.setState({isLoading:!1}),f(t)}))}))}})}},g.formatMessage(w.delete)))),T={exportedUserPointsCount:c,exportedUserIdentifiersCount:u},I=this.getFeedStatsDisplayStatus(T),A=(0,b.getFeedStatsUnit)(n),C=this.getFeedStatsDisplayMsg(g,I,A,T);return o.createElement(s.Card,{className:"hoverable-card actionable-card compact feed-card"},o.createElement("div",{className:"top-menu",id:this.id},o.createElement(d.Dropdown,{overlay:P,trigger:["click"],getPopupContainer:function(){return document.getElementById(e.id)}},o.createElement("a",null,o.createElement(s.McsIcon,{type:"dots"})))),o.createElement("div",{className:"wrapper"},o.createElement("div",{className:"card-header"},E?o.createElement("img",{className:"image-title",src:""+window.MCS_CONSTANTS.ASSETS_URL+E}):void 0,o.createElement("div",{className:"title"},n.name&&o.createElement("div",{className:"feed-name"},n.name),o.createElement("div",{className:"plugin-name"},S||n.artifact_id))),o.createElement("div",{className:"content"},o.createElement("div",{className:"content-left"},o.createElement(s.McsIcon,{type:"status",className:this.generateStatusColor()})," ",n.status),p("audience-feeds_stats")&&o.createElement("div",{className:"content-right"},C," ",o.createElement(d.Tooltip,{placement:"topRight",title:g.formatMessage(w.inTheLast7Days)}," ",o.createElement(s.McsIcon,{style:{marginRight:"0px"},type:"info"})))),o.createElement("div",{className:"actions"},this.renderActionButton())),this.state.opened&&this.state.pluginLayout&&this.state.pluginProperties&&o.createElement(O,{editionMode:!0,disableFields:"ACTIVE"===n.status||"PUBLISHED"===n.status,initialValues:this.state.initialValue,isLoading:this.state.isLoadingCard,onClose:function(){return e.setState({opened:!1})},opened:!!this.state.opened,organisationId:i,plugin:n,pluginLayout:this.state.pluginLayout,pluginProperties:this.state.pluginProperties,pluginVersionId:n.version_id,save:this.saveOrCreatePluginInstance,selectedTab:this.state.modalTab,feedStatsUnit:A,nameField:{label:h(w.feedModalNameFieldLabel),title:o.createElement("div",null,h(w.feedModalNameFieldTitle),o.createElement("br",null),o.createElement("b",null,h(w.feedModalNameFieldTitleWarning))),placeholder:h(w.feedModalNameFieldPlaceholder),display:!0,disabled:"ACTIVE"===n.status||"PUBLISHED"===n.status,value:n.name,validator:[y]}}))}}]),t}(o.Component);S([(0,h.lazyInject)(v.TYPES.IAudienceSegmentFeedServiceFactory)],M.prototype,"_audienceSegmentFeedServiceFactory",void 0),S([(0,h.lazyInject)(v.TYPES.IPluginService)],M.prototype,"_pluginService",void 0),t.default=(0,u.compose)(m.withRouter,f.injectIntl,g.injectFeatures,c.default,y.withValidators)(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(11),i=n(8),s=v(n(69)),l=v(n(421)),c=v(n(23)),u=n(35),d=n(41),f=n(10),p=n(77),m=n(2391),g=n(160),y=v(n(1099)),h=n(73);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=function(e){n.node&&n.node.contains(e.target)||n.props.onClose()},n.getData=function(e){n.setState({loading:!0,imageUrl:e}),n.getPallette(""+window.MCS_CONSTANTS.ASSETS_URL+e)},n.getPallette=function(e){return(0,m.getColorPalettes)(e,{paletteCount:3,paletteType:"dominant"}).then((function(e){return n.setState({loading:!1,backgroundColor:(0,m.rgbToHex)(e[0]),color:(0,m.getPerceivedBrightness)(e[0][0],e[0][1],e[0][2])>160?"black":"white"}),{}})).catch((function(e){n.props.notifyError(e),n.setState({loading:!1})}))},n.generateFormFromPluginLayout=function(e){var t=n.props,a=t.organisationId,o=t.plugin,i=t.pluginProperties,s=t.disableFields,c=t.nameField,u=t.descriptionField;return e.sections.map((function(t,n){var d=n!==e.sections.length-1,f=null!==t.fields&&0!==t.fields.length,p=null!==t.advanced_fields&&0!==t.advanced_fields.length,m=d&&(f||p);return r.createElement("div",{key:t.title},r.createElement(l.default,{pluginLayoutSection:t,organisationId:a,pluginProperties:i,pluginPresetProperties:o.plugin_preset?o.plugin_preset.properties:void 0,disableFields:!!s,pluginVersionId:o.current_version_id,nameField:0===n&&c?c:void 0,descriptionField:0===n&&u?u:void 0,small:!0}),m?r.createElement("hr",null):null)}))},n.onSubmit=function(e){var t=n.props,a=t.editionMode,r=t.save,o=t.nameField,i=t.descriptionField;!1===a&&(e.id=e.id?e.id:(0,g.generateFakeId)()),r(Object.assign({},e.plugin),n.props.pluginProperties.filter((function(e){return!0===e.writable})).map((function(t){return Object.assign(Object.assign({},t),{value:e.properties&&e.properties[t.technical_name]?e.properties[t.technical_name].value:t.value})})),e.plugin&&e.plugin.name||o&&o.value,e.description||i&&i.value)},n.renderForm=function(e){var t=n.props.handleSubmit;return r.createElement(p.Form,{className:n.state.loading?"hide-section":"edit-layout mcs-form-container",layout:"vertical",onSubmit:t(n.onSubmit)},n.generateFormFromPluginLayout(e),r.createElement("div",{style:{height:110,width:"100%"}}))},n.renderStats=function(){var e=n.props,t=e.plugin,a=e.organisationId,o=e.feedStatsUnit;return r.createElement(y.default,{organisationId:a,feedId:t.id,feedStatsUnit:o})},n.state={loading:!0,backgroundColor:"",color:"",selectedTab:e.selectedTab},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.pluginLayout;e&&e.metadata&&e.metadata.small_icon_asset_url&&this.getData(e.metadata.small_icon_asset_url),document.addEventListener("mousedown",this.handleClick,!1)}},{key:"componentDidUpdate",value:function(e){var t=this.props.pluginLayout,n=e.pluginLayout;t&&t.metadata&&t.metadata.small_icon_asset_url&&(n&&n.metadata&&n.metadata.small_icon_asset_url!==t.metadata.small_icon_asset_url||!n&&t)&&this.getData(t.metadata.small_icon_asset_url)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClick,!1)}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,a=t.handleSubmit,i=t.isLoading,s=t.pluginLayout,l=t.editionMode,c=t.hasFeature,u=this.state,p=u.backgroundColor,m=u.color,g=u.loading,y=u.selectedTab;if(g||!s||i)return r.createElement("div",{className:"plugin-modal-loading"},r.createElement(f.Spin,{size:"large"}));var h=[{title:"Configuration",key:"configuration",display:r.createElement("div",{className:"tab"},this.renderForm(s))}];c("audience-feeds_stats")&&l&&(h=[{title:"Stats (BETA)",key:"stats",display:r.createElement("div",{className:"tab"},this.renderStats())}].concat(h));return r.createElement("div",{className:"plugin-modal",ref:function(t){return e.node=t}},r.createElement("style",null,".ant-tabs-ink-bar { background-color: "+p+"; height: 3px; }"),r.createElement(o.Actionbar,{paths:[{name:s.metadata.display_name}],backgroundColor:p,edition:!0,inverted:"black"===m},r.createElement(o.Button,{onClick:n,style:{marginRight:0}},r.createElement(o.McsIcon,{type:"close",className:"close-icon",style:{cursor:"pointer"}}))),r.createElement("div",{className:"body"},r.createElement("div",{className:"header"},r.createElement("div",{className:"logo"},this.state.imageUrl&&r.createElement("img",{src:""+window.MCS_CONSTANTS.ASSETS_URL+this.state.imageUrl})),r.createElement("div",{className:"meta"},r.createElement("div",null,s.version)),r.createElement("div",{className:"information"},r.createElement("div",{className:"name"},s.metadata.display_name),r.createElement("div",{className:"description"},s.metadata.description))),r.createElement("div",{className:"tabs"},r.createElement(o.McsTabs,{items:h,defaultActiveKey:y,onChange:function(t){e.setState({selectedTab:t})}})),"configuration"===y?r.createElement("div",{className:"footer"},r.createElement(o.Button,{className:" m-r-20",onClick:n},"Close"),r.createElement(o.ColoredButton,{className:"mcs-primary",backgroundColor:p,color:m,onClick:a(this.onSubmit)}," ",i?r.createElement(d.LoadingOutlined,null):null," Save")):null))}}]),t}(r.Component);t.default=(0,i.compose)(s.default,(0,u.reduxForm)({form:"pluginForm",enableReinitialize:!0}),c.default,h.injectFeatures)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shadeColor=function(e,t){var n=parseInt(e.slice(1),16),a=t<0?0:255,r=t<0?-1*t:t,o=n>>16,i=n>>8&255,s=255&n;return"#"+(16777216+65536*(Math.round((a-o)*r)+o)+256*(Math.round((a-i)*r)+i)+(Math.round((a-s)*r)+s)).toString(16).slice(1)},t.getColorPalettes=function(e,t){var n=t.paletteCount,a=void 0===n?3:n,r=t.paletteType,o=void 0===r?"average":r,i=new Image;return i.crossOrigin="Anonymous",i.src=e+"?"+Date.now(),new Promise((function(e,t){try{i.addEventListener("load",(function(){var t=document.createElement("canvas"),n=t.getContext&&t.getContext("2d");if(!n)return[0,0,0,1];var r=t.width=i.naturalWidth||i.offsetWidth||i.width,s=t.height=i.naturalHeight||i.offsetHeight||i.height;return n.drawImage(i,0,0),e("average"===o?function(e,t,n){var a=-4,r=0,o=0,i=0,s=0,l=void 0;try{for(l=n.getImageData(0,0,e,t);(a+=20)<l.data.length;)++r,o+=l.data[a],i+=l.data[a+1],s+=l.data[a+2];return[[o=~~(o/r),i=~~(i/r),s=~~(s/r),1]]}catch(e){throw new Error(e)}}(r,s,n):function(e,t){var n=function(e){var t=[],n=[],a=void 0;return e.sort(),e.forEach((function(r,o){r.toString()!==a?(t.push(r),n.push(1)):n[n.length-1]++,a=e[o].toString()})),[t,n]}(e),a=n[0],r=n[1],o=[];if(0===e.length){for(var i=0;i<t;i++)o.push([10,50,84,255]);return o}var s=function(){var e=0,n=0;r.forEach((function(t,a){t>e&&(e=t,n=a)})),o.push(a[n]),a.splice(n,1),r.splice(n,1),t--};for(;t;)s();return o}(function(e,t,n){var a=[];try{for(var r=n.getImageData(0,0,t,e).data,o=0;o<=e*t;o+=4){var i=r.slice(o,o+4);"0,0,0,0"!==i.toString().trim()&&a.push(i)}}catch(e){return[]}return a}(r,s,n),a))}))}catch(e){t(e)}}))},t.rgbToHex=function(e){var t="#";return e.slice(0,3).forEach((function(e){var n=e.toString(16);t+=1===n.length?"0"+n:n})),t},t.getPerceivedBrightness=function(e,t,n){return Math.sqrt(e*e*.241+t*t*.691+n*n*.068)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(33),l=n(10),c=n(56),u=n(412),d=n(68),f=_(n(23)),p=n(12),m=n(15),g=n(6),y=_(n(69)),h=_(n(261)),v=n(44),b=n(11);function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=l.Input.Group,O=l.Select.Option,w=d.TableView,M=(0,g.defineMessages)({submissionDate:{id:"audience.segments.dashboard.segmentExportsList.submissionDate",defaultMessage:"Submission Date"},status:{id:"audience.segments.dashboard.segmentExportsList.status",defaultMessage:"Status"},progress:{id:"audience.segments.dashboard.segmentExportsList.progress",defaultMessage:"Progress"},startDate:{id:"audience.segments.dashboard.segmentExportsList.startDate",defaultMessage:"Start Date"},endDate:{id:"audience.segments.dashboard.segmentExportsList.endDate",defaultMessage:"End Date"},userIdentifierType:{id:"audience.segments.dashboard.segmentExportsList.userIdentifierType",defaultMessage:"User Identifier type"},totalUserPoints:{id:"audience.segments.dashboard.segmentExportsList.totalUserPoints",defaultMessage:"User Points in segment"},totalExportedUserPoints:{id:"audience.segments.dashboard.segmentExportsList.totalExportedUserPoints",defaultMessage:"Exported User Points (with identifiers)"},totalExportedIdentifiers:{id:"audience.segments.dashboard.segmentExportsList.totalExportedIdentifiers",defaultMessage:"Exported Identifiers"},download:{id:"audience.segments.dashboard.segmentExportsList.download",defaultMessage:"Download"},exportRunning:{id:"audience.segments.dashboard.segmentExportsList.running",defaultMessage:"An export execution is already running"},exportFailed:{id:"audience.segments.dashboard.segmentExportsList.failed",defaultMessage:"This export has failed. Please launch another execution."},exportRunningDownload:{id:"audience.segments.dashboard.segmentExportsList.running.download",defaultMessage:"This export is being created, please try again when the export has succeeded."},createExport:{id:"audience.segments.dashboard.segmentExportsList.startNew",defaultMessage:"New export"},popupTitle:{id:"audience.segments.dashboard.segmentExportsList.startNew.modal.title",defaultMessage:"Enter the type of user identifier that you want to export"}}),P=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchLoop=window.setInterval((function(){var e=n.state,t=e.executions,a=e.filter;t.items.length>0&&t.items.some((function(e,t,n){return"PENDING"===e.status||"RUNNING"===e.status}))&&n.refreshData(a)}),5e3),n.fetchCompartments=function(e){n._datamartService.getUserAccountCompartmentDatamartSelectionResources(e,{with_source_datamarts:!0}).then((function(e){n.setState({compartments:e.data,isLoadingCompartments:!1,selectedCompartmentId:e.data.filter((function(e){return e.default}))[0]?e.data.filter((function(e){return e.default}))[0].compartment_id:void 0})})).catch((function(e){n.props.notifyError(e),n.setState({isLoadingCompartments:!1})}))},n.refreshData=function(e){var t=n.props.segmentId;n.setState({filter:e});var a=Object.assign({},(0,v.getPaginatedApiParam)(e.currentPage,e.pageSize));n._audienceSegmentService.findAudienceSegmentExportExecutionsBySegment(t,a).then((function(e){n.setState({isLoadingExecutions:!1,executions:{items:e.data,total:e.total?e.total:e.count}})})).catch((function(e){n.props.notifyError(e),n.setState({isLoadingExecutions:!1})}))},n.getExecutionProgress=function(e){var t=n.props.colors,a=e.num_tasks||0,r="SUCCEEDED"===e.status?e.num_tasks||0:(e.completed_tasks||0)+(e.erroneous_tasks||0);return{percent:a?r/a:0,color:function(e){switch(e){case"RUNNING":case"PENDING":return t["mcs-primary"];case"SUCCESS":case"SUCCEEDED":return t["mcs-success"];case"FAILED":return t["mcs-error"];default:return t["mcs-primary"]}}(e.status)}},n.downloadFile=function(e){return function(t){var a=n.props.intl.formatMessage;"RUNNING"===e.status||"PENDING"===e.status?l.message.error(a(M.exportRunning)):"FAILED"===e.status?l.message.error(a(M.exportFailed)):"SUCCEEDED"===e.status&&(window.location=window.MCS_CONSTANTS.API_URL+"/v1/data_file/data?access_token="+encodeURIComponent(h.default.getItem("access_token"))+"&uri="+(e.result?e.result.export_file_uri:""))}},n.submitModal=function(){var e=n.props.segmentId,t=n.state,a=t.identifierType,r=t.selectedCompartmentId,o="USER_ACCOUNT"===a?{type:a,compartment_id:r}:{type:a},i=Object.assign(Object.assign({},n.state.filter),{currentPage:1});n.setState({filter:i}),n._audienceSegmentService.createAudienceSegmentExport(e,o).then((function(){return n.refreshData(i)})).catch((function(e){n.props.notifyError(e)})),n.handleModal(!1)},n.handleModal=function(e){n.setState({isModalVisible:e})},n.createCompartmentOptions=function(e){return e.map((function(e){return o.createElement(l.Select.Option,{key:e.compartment_id,value:e.compartment_id},e.compartment_id+" - "+e.name)}))},n.updateIdentifierType=function(e){n.setState({identifierType:e})},n.updateCompartment=function(e){n.setState({selectedCompartmentId:e})},n.state={isLoadingExecutions:!0,isLoadingCompartments:!0,isModalVisible:!1,compartments:[],executions:{items:[],total:0},identifierType:"USER_AGENT",filter:{currentPage:1,pageSize:10}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.datamartId;this.refreshData(this.state.filter),this.fetchCompartments(e)}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.fetchLoop)}},{key:"render",value:function(){var e=this,t=this.state,n=t.isLoadingExecutions,a=t.isLoadingCompartments,r=t.compartments,i=t.selectedCompartmentId,s={current:this.state.filter.currentPage,pageSize:this.state.filter.pageSize,total:this.state.executions.total,onChange:function(t,n){e.setState({isLoadingExecutions:!0}),e.refreshData({currentPage:t,pageSize:n})},onShowSizeChange:function(t,n){e.setState({isLoadingExecutions:!0}),e.refreshData({pageSize:n,currentPage:1})}},d=function(){return e.handleModal(!1)},f=[{intlMessage:M.submissionDate,key:"submissionDate",isVisibleByDefault:!0,isHideable:!1,render:function(e,t){return(0,u.formatUnixTimestamp)(t.creation_date,"DD/MM/YYYY HH:mm:ss")}},{intlMessage:M.status,key:"status",isHideable:!1,render:function(e,t){return e}},{intlMessage:M.progress,key:"progress",isHideable:!1,render:function(t,n){return o.createElement("div",null,o.createElement(l.Progress,{showInfo:!1,percent:100*e.getExecutionProgress(n).percent}))}},{intlMessage:M.startDate,key:"startDate",isVisibleByDefault:!0,isHideable:!1,render:function(e,t){return(0,u.formatUnixTimestamp)(t.start_date,"DD/MM/YYYY HH:mm:ss")}},{intlMessage:M.endDate,key:"endDate",isVisibleByDefault:!0,isHideable:!1,render:function(e,t){return(0,u.formatUnixTimestamp)(t.start_date&&t.duration?t.start_date+t.duration:void 0,"DD/MM/YYYY HH:mm:ss")}},{intlMessage:M.userIdentifierType,key:"userIdentifierType",isHideable:!1,render:function(e,t){return t.parameters?t.parameters.export_user_identifier.type:""}},{intlMessage:M.totalUserPoints,key:"totalUserPoints",isVisibleByDefault:!0,isHideable:!1,render:function(e,t){return(0,c.formatMetric)(t.result?t.result.total_user_points_in_segment:"-","0")}},{intlMessage:M.totalExportedUserPoints,key:"totalExportedUserPoints",isVisibleByDefault:!0,isHideable:!1,render:function(e,t){return(0,c.formatMetric)(t.result?t.result.total_exported_user_points:"-","0")}},{intlMessage:M.totalExportedIdentifiers,key:"totalExportedIdentifiers",isVisibleByDefault:!0,isHideable:!1,render:function(e,t){return(0,c.formatMetric)(t.result?t.result.total_exported_identifiers:"-","0")}},{key:"action",render:function(t,n){return"SUCCEEDED"===n.status&&n.result&&n.result.export_file_uri&&o.createElement(l.Button,{type:"primary",onClick:e.downloadFile(n)},o.createElement(b.McsIcon,{type:"download"})," ",e.props.intl.formatMessage(M.download))}}],p=this.state.executions.items,m="USER_ACCOUNT"===this.state.identifierType&&r.length>0,y=this.createCompartmentOptions(r);return o.createElement("div",{className:"ant-layout"},o.createElement(l.Modal,{title:o.createElement(g.FormattedMessage,M.popupTitle),wrapClassName:"vertical-center-modal",visible:this.state.isModalVisible,footer:o.createElement(o.Fragment,null,o.createElement(l.Button,{key:"back",size:"large",onClick:d},"Return"),o.createElement(l.Button,{disabled:!1,key:"submit",type:"primary",size:"large",onClick:function(t){return e.submitModal()}},"Submit")),onCancel:d},o.createElement(E,{compact:!0,style:{display:"flex"}},o.createElement(l.Select,{style:{width:"30%"},defaultValue:this.state.identifierType,onChange:this.updateIdentifierType},o.createElement(O,{value:"USER_AGENT"},"User Agents"),o.createElement(O,{value:"USER_ACCOUNT"},"User Accounts"),o.createElement(O,{value:"USER_EMAIL"},"Email Hash")),m&&o.createElement("div",{style:{display:"flex"}},o.createElement("div",{style:{paddingLeft:"30px",paddingRight:"5px",display:"flex",alignItems:"center"}},"Compartment :"),o.createElement(l.Select,{showSearch:!0,defaultValue:i,onChange:this.updateCompartment},y)))),o.createElement("div",{style:{flex:1,justifyContent:"flex-end",display:"flex"}},o.createElement(l.Button,{style:{marginBottom:"20px",width:"14%"},onClick:function(){return e.handleModal(!0)},loading:a},o.createElement(g.FormattedMessage,M.createExport))),o.createElement(w,{columns:f,dataSource:p,loading:n,pagination:s}))}}]),t}(o.Component);S([(0,m.lazyInject)(p.TYPES.IDatamartService)],P.prototype,"_datamartService",void 0),S([(0,m.lazyInject)(p.TYPES.IAudienceSegmentService)],P.prototype,"_audienceSegmentService",void 0),t.default=(0,i.compose)(s.withRouter,g.injectIntl,f.default,y.default)(P)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=b(n(2394)),s=n(15),l=n(12),c=b(n(23)),u=n(8),d=n(2399),f=b(n(81)),p=n(30),m=n(13),g=n(229),y=n(56),h=n(54),v=n(11);function b(e){return e&&e.__esModule?e:{default:e}}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getDataRangeValues=function(){var e=n.props.dateRange;return e.from.value&&e.to.value?[e.from,e.to]:[new f.default("now-8d"),new f.default("now-1d")]},n.fetchAnalytics=function(e,t,a,r,o,i,s,l,c){var u=n.props.chart;n.setState({loading:!0}),e(!0);var d=[];if(i&&i.includes("date_yyyy_mm_dd")){var f=i.slice().filter((function(e){return"date_yyyy_mm_dd"!==e}));return n._datamartUsersAnalyticsService.getAnalytics(t,a,r,o,f,s,c||l).then((function(f){var p=(0,y.normalizeReportView)(f.data.report_view),m=(0,h.orderBy)(p,a,"desc");return m&&u.filterBy&&(d=m.slice(0,11).map((function(e){if(u.filterBy)return e[u.filterBy]}))),n.doFetchAnalytics(e,t,a,r,o,i,s,l,c,d)}))}return n.doFetchAnalytics(e,t,a,r,o,i,s,l,c)},n.doFetchAnalytics=function(e,t,a,r,o,i,s,l,c,u){return n._datamartUsersAnalyticsService.getAnalytics(t,a,r,o,i,s,c||l,n.getSegmentIdToAddToDimensionFilterClause(!!c)).then((function(t){if(u&&u.length>0){var a=t.data.report_view.rows.filter((function(e){return(0,h.intersection)(e,u).length>0}));t.data.report_view.rows=a}c?n.setState({loading:!1,reportViewApiResponseToCompareWith:t.data.report_view}):n.setState({loading:!1,reportViewApiResponse:t.data.report_view}),e(!1)})).catch((function(t){n.props.notifyError(t),n.setState({loading:!1}),e(!1)}))},n.getSegmentIdToAddToDimensionFilterClause=function(e){var t=n.props,a=t.segmentToAggregate,r=t.location.search,o=(0,p.parseSearch)(r,g.DATAMART_USERS_ANALYTICS_SETTING);return a&&1===o.segments.length&&e?o.segments[0]:void 0},n.state={loading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.datamartId,a=t.chart,r=t.onChange,o=t.segmentId,i=t.compareWithSegmentId;this.fetchAnalytics(r,n,a.metricNames,this.getDataRangeValues()[0],this.getDataRangeValues()[1],a.dimensions,a.dimensionFilterClauses,o).then((function(){i&&e.fetchAnalytics(r,n,a.metricNames,e.getDataRangeValues()[0],e.getDataRangeValues()[1],a.dimensions,a.dimensionFilterClauses,o,i)}))}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,a=n.datamartId,r=n.chart,o=n.dateRange,i=n.onChange,s=n.segmentId,l=n.compareWithSegmentId,c=n.location.search,u=n.segmentToAggregate;(!(0,h.isEqual)(e.dateRange,o)||e.segmentId!==s||e.compareWithSegmentId!==l||e.location.search!==c&&u)&&this.fetchAnalytics(i,a,r.metricNames,this.getDataRangeValues()[0],this.getDataRangeValues()[1],r.dimensions,r.dimensionFilterClauses,s).then((function(){l&&t.fetchAnalytics(i,a,r.metricNames,t.getDataRangeValues()[0],t.getDataRangeValues()[1],r.dimensions,r.dimensionFilterClauses,s,l)}))}},{key:"render",value:function(){var e=this.props,t=e.chart,n=e.segmentName,a=e.compareWithSegmentName,r=this.state,s=r.loading,l=r.reportViewApiResponse,c=r.reportViewApiResponseToCompareWith;return s?"SINGLE_STAT"!==t.type?o.createElement(v.LoadingChart,null):o.createElement(d.MetricCounterLoader,null):o.createElement("div",{className:"mcs-datamartUsersAnalytics_component_charts"},l&&o.createElement(i.default,{apiResponse:l,apiResponseToCompareWith:c,chart:t,resourceNames:{resourceName:n,compareWithSegmentName:a}}))}}]),t}(o.Component);_([(0,s.lazyInject)(l.TYPES.IDatamartUsersAnalyticsService)],S.prototype,"_datamartUsersAnalyticsService",void 0),t.default=(0,u.compose)(c.default,m.withRouter)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=O(n(0)),o=E(n(2395)),i=E(n(54)),s=n(56),l=E(n(2396)),c=E(n(2397)),u=E(n(2398)),d=n(10),f=O(n(203)),p=n(619),m=E(n(17)),g=E(n(323)),y=E(n(69)),h=n(8),v=n(6),b=n(51),_=n(11),S=n(41);function E(e){return e&&e.__esModule?e:{default:e}}function O(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var P=(0,v.defineMessages)({noData:{id:"datamartUsersAnalytics.noData",defaultMessage:"No data"}}),T=function(e){function t(){w(this,t);var e=M(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.getXAxisValues=function(e,t){return e.map((function(e){return e[t]}))},e.formatSeriesForChart=function(t,n){var a=t.dimensions?t.dimensions[0]:"";switch(t.type){case"PIE":return[{type:"pie",name:"",innerSize:"65%",data:n.map((function(e){return{name:e[a]||"null",y:e[t.metricNames[0]]}}))}];case"AREA":return n.reduce((function(n,r){var o=n.find((function(e){return e.name===r[a]})),i=r[t.metricNames[0]],s=void 0;return t.dimensions&&(s="date_yyyy_mm_dd"===t.dimensions[t.dimensions.length-1]?e.formatDateToTs(r[t.dimensions[t.dimensions.length-1]]):r[t.dimensions[t.dimensions.length-1]]),o?o.data.push([s,i]):n.push({visible:n.length<4,name:r[a],data:[[s,i]],fillOpacity:.5,fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,f.Color(t.options.colors?t.options.colors[0]:"#2fa1de").setOpacity(p.AREA_OPACITY).get("rgba")],[1,f.Color(t.options.colors?t.options.colors[0]:"#2fa1de").setOpacity(0).get("rgba")]]},type:"area"}),n}),[]);case"WORLD_MAP":return n.reduce((function(e,n){var r=e.find((function(e){return e.code3===n[a]})),o=n[t.metricNames[0]];return r?r.value+=o:e.push({code3:n[a],value:n[t.metricNames[0]]}),e}),[]);case"STACKED_BAR":return n.reduce((function(e,n){return 0===e.length?e.push({type:"bar",data:[n[t.metricNames[0]]]}):e[0].data.push(n[t.metricNames[0]]),e}),[]);case"COLUMN":return n.reduce((function(e,n){return 0===e.length?e.push({type:"column",data:[n[t.metricNames[0]]],showInLegend:!1,name:t.metricNames[0]}):e[0].data.push(n[t.metricNames[0]]),e}),[]);default:return[]}},e.formatSeriesForCounters=function(e,t){var n=e.dimensions?e.dimensions[0]:"";return t.reduce((function(t,a){var r=t.find((function(e){return e.title===a[n]})),o=a[e.metricNames[0]];return r?r.value=r.value+o:(t.push({title:a[n],iconType:e.icons?e.icons[0]:"data",value:o,unit:"%",iconStyle:{color:e.options.colors?e.options.colors[0]:void 0}}),e.options.colors&&e.options.colors.length>0&&e.options.colors.splice(0,1),e.icons&&e.icons.length>0&&e.icons.splice(0,1)),t}),[])},e.formatDateToTs=function(e){return(0,m.default)(e).seconds(0).hours(0).milliseconds(0).minutes(0).valueOf()},e.generateCharElements=function(t,n,a){var s=e.props.colors,f=t.dimensions?t.dimensions[0]:"";switch(t.type){case"AREA":return t.dimensions&&0!==t.dimensions.length?(t.options.series=e.formatSeriesForChart(t,n),r.createElement(o.default,{options:t.options})):null;case"PIE":return t.options.series=e.formatSeriesForChart(t,n),r.createElement(_.PieChart,{options:t.options});case"COUNT":return t.counterFormatedProps=e.formatSeriesForCounters(t,n),r.createElement(_.CounterDashboard,{counters:t.counterFormatedProps});case"WORLD_MAP":return r.createElement(l.default,{options:t.options,dataset:e.formatSeriesForChart(t,n)});case"STACKED_BAR":return t.dimensions?(t.options.series=e.formatSeriesForChart(t,n),r.createElement(c.default,{options:t.options})):null;case"COLUMN":return t.dimensions?(t.options.series=e.formatSeriesForChart(t,n),t.options.xAxis={categories:e.getXAxisValues(n,f)},r.createElement(u.default,{options:t.options})):null;case"TABS":return r.createElement(d.Tabs,{key:0},i.default.map(t.tabs,(function(t,o){return r.createElement(d.Tabs.TabPane,{tab:t.title,key:o.toString()},e.generateCharElements(t,n,a))})));case"SINGLE_STAT":var p=void 0,y=a?null===a[0][t.metricNames[0]]||"NaN"===a[0][t.metricNames[0]]?0:a[0][t.metricNames[0]]:null===n[0][t.metricNames[0]]||"NaN"===n[0][t.metricNames[0]]?0:n[0][t.metricNames[0]];p="time"===t.unit?m.default.duration(y,"second").format("h[hr] m[min] s[s]"):"%"===t.unit?(0,g.default)(100*y).format("0.00"):"€"===t.unit?(0,g.default)(y).format("0.00a"):(0,g.default)(y).format("0.00");var h=n[0][t.metricNames[0]],v=a?a[0][t.metricNames[0]]:void 0,b=void 0;return a?(b=(h-v)/h*100,isNaN(b)&&(b=void 0)):b=void 0,r.createElement("div",{className:"mcs-metricCounter"},r.createElement("div",{className:"mcs-metricCounter_title"},t.options.title&&t.options.title.text),r.createElement("div",{className:"mcs-metricCounter_result"},r.createElement(d.Statistic,{className:"mcs-datamartUsersAnalytics_charts_singleStat",value:p,precision:"number"!==t.unit?2:void 0,suffix:"time"!==t.unit&&"number"!==t.unit?t.unit:void 0}),b&&r.createElement(d.Statistic,{className:"mcs-datamartUsersAnalytics_charts_trend",value:(0,g.default)(Math.abs(b)).format("0.00"),precision:2,valueStyle:{color:Math.sign(b)>-1?s["mcs-error"]:s["mcs-success"]},prefix:Math.sign(b)>-1?r.createElement(S.CaretDownOutlined,null):r.createElement(S.CaretUpOutlined,null),suffix:"%"})));default:return null}},e.areAnalyticsReady=function(e){var t=e[0]&&null===e[0][0],n=e[0]&&"NaN"===e[0][0];return!(t||n)},e.shouldDisplayData=function(){var t=e.props,n=t.apiResponse,a=t.apiResponseToCompareWith;return n&&(n.total_items>0||a&&a.total_items>0)&&(e.areAnalyticsReady(n.rows)||a&&e.areAnalyticsReady(a.rows))},e.addSegmentNameToReportView=function(e,t){var n=["resource_name"].concat(e.columns_headers),a=e.rows.map((function(e){return[t].concat(e)}));return Object.assign(Object.assign({},e),{columns_headers:n,rows:a})},e.getMergedApiResponse=function(t,n){var a=e.props.resourceNames,r=e.addSegmentNameToReportView(t,a.resourceName);return Object.assign(Object.assign({},r),{rows:n?r.rows.concat(e.addSegmentNameToReportView(n,a.compareWithSegmentName).rows):r.rows})},e.getChartVariables=function(){var t=e.props,n=t.chart,a=t.apiResponse,r=t.apiResponseToCompareWith;if(n.enhancedManualReportView){var o=e.getMergedApiResponse(a,r);return[Object.assign(Object.assign({},n),{dimensions:n.dimensions?["resource_name"].concat(n.dimensions):[]}),(0,s.normalizeReportView)(o),r?(0,s.normalizeReportView)(r):void 0]}return[n,(0,s.normalizeReportView)(a),r?(0,s.normalizeReportView)(r):void 0]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"getEmptyDataComponent",value:function(e,t){return"SINGLE_STAT"!==e?r.createElement(_.EmptyChart,{title:t,icon:"warning"}):r.createElement(b.EmptyRecords,{message:t})}},{key:"render",value:function(){var e=this.props,t=e.chart,n=e.intl;return this.shouldDisplayData()?r.createElement("div",null,this.generateCharElements(this.getChartVariables()[0],this.getChartVariables()[1],this.getChartVariables()[2])):this.getEmptyDataComponent(t.type,n.formatMessage(P.noData))}}]),t}(r.Component);t.default=(0,h.compose)(y.default,v.injectIntl)(T)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=l(n(0)),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(203)),i=l(n(339)),s=l(n(47));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.cuid=(0,s.default)(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.options;return r.default.createElement(i.default,{highcharts:o,options:e})}}]),t}(r.default.Component);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=s(n(0)),o=s(n(827)),i=s(n(47));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.generateMap=function(e,t){t[0].code3&&(o.default.createElement("link",{},void 0,document.getElementsByTagName("head")[0]),e.series=[{data:t,mapData:o.default.maps["custom/world"],joinBy:["iso-a3","code3"],type:"map"}],o.default.mapChart(n.cuid,e))},n.cuid=(0,i.default)(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.options,n=e.dataset;this.generateMap(t,n)}},{key:"render",value:function(){return r.default.createElement("div",{id:this.cuid})}}]),t}(r.default.Component);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=c(n(0)),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(203)),i=c(n(339)),s=n(6),l=n(8);function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e){function t(){return u(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.options;return r.default.createElement(i.default,{highcharts:o,options:e,style:{width:"100%"}})}}]),t}(r.default.Component);t.default=(0,l.compose)(s.injectIntl)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=d(n(0)),i=d(n(203)),s=n(339),l=(a=s)&&a.__esModule?a:{default:a},c=n(6),u=n(8);function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props.options;return o.createElement(l.default,{highcharts:i,options:e,style:{width:"100%"}})}}]),t}(o.Component);t.default=(0,u.compose)(c.injectIntl)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetricCounterLoader=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.MetricCounterLoader=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){return r.createElement("div",{className:"mcs-metricCounter"},r.createElement("div",{className:"mcs-metricCounter_title"},r.createElement("i",{className:"mcs-table-cell-loading"})),r.createElement("div",{className:"mcs-metricCounter_result"},r.createElement("i",{className:"mcs-table-cell-loading-large"})))}}]),t}(r.Component)},,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=n(10),l=n(13);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=(0,i.defineMessages)({draft:{id:"segment.lookalike.alert.draft",defaultMessage:"In order to calibrate your Lookalike Audience Segment, please press the calibrate button in the action bar."},calibrating:{id:"segment.lookalike.alert.calibrating",defaultMessage:"Your Lookalike Audience Segment is being calibrating, please check later on to view the result."},calibration_error:{id:"segment.lookalike.alert.error",defaultMessage:"The calibration of your Lookalike Audience Segment has failed, please contact your customer success manager or try starting another calibration manualy."},calibration_success:{id:"segment.lookalike.alert.success",defaultMessage:"Your Lookalike Audience Segment is properly calibrated, if you wish to recalibrate it again, please push the calibration button in the action bar."}}),f=function(e){function t(){return c(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.segment,n=e.intl.formatMessage;if(t&&Object.keys(t).length&&"USER_LOOKALIKE"===t.type){switch(t.status){case"DRAFT":return r.createElement(s.Alert,{className:"m-b-20",message:n(d.draft),type:"warning"});case"CALIBRATION_ERROR":return r.createElement(s.Alert,{className:"m-b-20",message:n(d.calibration_error),type:"error"});case"CALIBRATING":return r.createElement(s.Alert,{className:"m-b-20",message:n(d.calibrating),type:"info"});case"CALIBRATED":return r.createElement(s.Alert,{className:"m-b-20",message:n(d.calibration_success),type:"success"})}return r.createElement("div",null)}return r.createElement("div",null)}}]),t}(r.Component);t.default=(0,o.compose)(l.withRouter,i.injectIntl)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=M(n(54)),s=n(13),l=M(n(23)),c=n(6),u=M(n(1118)),d=M(n(2411)),f=n(617),p=n(632),m=M(n(631)),g=M(n(69)),y=n(10),h=n(11),v=n(51),b=M(n(1120)),_=n(73),S=M(n(1121)),E=n(229),O=n(30),w=n(163);function M(e){return e&&e.__esModule?e:{default:e}}var P=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getABComparisonDashboardConfig=function(){var e=n.props,t=e.experimentationSegment,a=e.match.params.organisationId,r=e.intl,o=function(e){return e.map((function(e){return Object.assign(Object.assign({},e),{title:e.title?r.formatMessage(f.messagesMap[e.title]):""})}))},i=[{title:"E_COMMERCE_ENGAGEMENT",datamartId:t.datamart_id,config:p.ecommerceEngagementConfig,organisationId:a},{title:"CHANNEL_ENGAGEMENT",datamartId:t.datamart_id,config:p.averageSessionDurationConfig,organisationId:a}],s=i.find((function(e){return e.title===t.target_metric}));return s?[Object.assign(Object.assign({},s),{title:s.title?r.formatMessage(f.messagesMap[s.title]):""})].concat(o(i.filter((function(e){return e.title!==t.target_metric})))):o(i)},n.buildItems=function(){var e=n.props,t=e.experimentationSegment,a=e.controlGroupSegment,o=e.intl,i=e.colors;return a?p.abTestingDashboardConfig.map((function(e,s){var l=Object.assign(Object.assign({},e),{segments:{segmentIdToCompareWith:t.id,baseSegmentId:a.id,segmentToCompareWithName:o.formatMessage(f.messagesMap.experimentationSegmentName),baseSegmentName:o.formatMessage(f.messagesMap.controlGroupSegmentName)},charts:e.charts.map((function(e){return Object.assign(Object.assign({},e),{options:Object.assign(Object.assign({},e.options),{colors:[i["mcs-primary"],i["mcs-warning"]]})})}))});return{title:e.title||"",display:r.createElement(b.default,{key:s.toString(),datamartId:t.datamart_id,dateRange:{from:n.getFilter().from,to:n.getFilter().to},onChange:n.getLoadingState,config:[l],segmentToAggregate:!0})}})):[]},n.getFilter=function(){var e=n.props.location.search;return(0,O.parseSearch)(e,E.DATAMART_USERS_ANALYTICS_SETTING)},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,O.updateSearch)(o,e,E.DATAMART_USERS_ANALYTICS_SETTING)};a.push(i)},n.onSegmentFilterChange=function(e){n.updateLocationSearch({segments:e})},n.onAllUserFilterChange=function(e){n.updateLocationSearch({allusers:e})},n.getLoadingState=function(e){return n.setState({disableFilters:e})},n.getSegmentToAddToDimensionFilterClause=function(){var e=n.getFilter().segments&&n.getFilter().segments[0];return e?{key:e,label:r.createElement(w.SegmentNameDisplay,{audienceSegmentId:e}),value:e}:void 0},n.state={ABComparisonDashboardConfig:[],isLoading:!0,disableFilters:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.controlGroupSegment,a=t.experimentationSegment,r=t.colors,o=e.controlGroupSegment,s=e.experimentationSegment;i.default.isEqual(o,n)&&i.default.isEqual(s,a)||!n||!n.id||this.setState({ABComparisonDashboardConfig:this.getABComparisonDashboardConfig().map((function(e){return Object.assign(Object.assign({},e),{config:e.config.map((function(e){return Object.assign(Object.assign({},e),{color:r["mcs-warning"],segments:{segmentIdToCompareWith:a.id,baseSegmentId:n.id}})}))})})),isLoading:!1})}},{key:"renderDatePicker",value:function(){var e=this,t=this.props.controlGroupSegment,n=this.state.disableFilters,a={from:this.getFilter().from,to:this.getFilter().to};return r.createElement(h.McsDateRangePicker,{values:a,onChange:function(t){return e.updateLocationSearch({from:t.from,to:t.to})},disabled:n,excludeToday:!0,startDate:t&&t.creation_ts})}},{key:"render",value:function(){var e=this.props,t=e.experimentationSegment,n=e.controlGroupSegment,a=e.hasFeature,o=e.colors,i=e.intl,s=this.state,l=s.ABComparisonDashboardConfig,p=s.isLoading,g=s.disableFilters;return p?r.createElement(v.Loading,{isFullScreen:!0}):!t.user_points_count||n&&!n.user_points_count?r.createElement(y.Alert,{message:r.createElement(c.FormattedMessage,{id:"audience.segments.experimentation.dashboard.noUserPoint",defaultMessage:"Your {segmentName} segment has no data. If you feel this is not normal, please contact support.",values:{segmentName:t.user_points_count?"Control Group":"Experimentation"}}),type:"warning"}):0===t.user_points_count||n&&0===n.user_points_count?r.createElement(y.Alert,{message:r.createElement(c.FormattedMessage,{id:"audience.segments.experimentation.dashboard.zeroUserPoint",defaultMessage:"Your {segmentName} segment has 0 User Point. If you feel this is not normal, please contact support.",values:{segmentName:0===t.user_points_count?"Experimentation":"Control Group"}}),type:"warning"}):r.createElement(r.Fragment,null,r.createElement(d.default,{weight:t.weight,segment:t,segmentToCompareWith:n}),r.createElement(y.Row,{className:"mcs-datamartUsersAnalytics m-b-20"},r.createElement(S.default,{className:g?"mcs-datamartUsersAnalytics_segmentFilter _is_disabled":"mcs-datamartUsersAnalytics_segmentFilter",onChange:this.onSegmentFilterChange,onToggleAllUsersFilter:this.onAllUserFilterChange,datamartId:t.datamart_id,organisationId:t.organisation_id,disableAllUserFilter:!0,hideAllUsersButton:!0,segmentcolors:[o["mcs-warning"]],segmentFiltersLength:1,defaultSegment:this.getSegmentToAddToDimensionFilterClause(),defaultSegmentCanBeRemoved:!0,placeholder:i.formatMessage(f.messagesMap.abDashboardSegmentFilterPlaceholder),segmentType:"USER_ACTIVATION"}),r.createElement(y.Col,{className:"text-right",offset:6},this.renderDatePicker())),a("audience-segment_uplift_area_chart")&&r.createElement(y.Card,null,r.createElement(h.McsTabs,{items:this.buildItems()})),l.map((function(e,t){return r.createElement(m.default,{key:t.toString(),title:e.title,subTitle:e.subTitle,datamartId:e.datamartId,organisationId:e.organisationId,config:e.config,showFilter:e.showFilter,segmentToAggregate:!0})})),r.createElement(u.default,null))}}]),t}(r.Component);t.default=(0,o.compose)(c.injectIntl,s.withRouter,l.default,_.injectFeatures,g.default)(P)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(6),l=n(69),c=(a=l)&&a.__esModule?a:{default:a},u=n(1117),d=n(56);function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){f(this,t);var e=p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.getGaugeRatio=function(e){return 0===e?[0,100]:e>=0&&e<30?[30,70]:e>=70&&e<100?[70,30]:100===e?[100,0]:[e,100-e]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.segment,n=e.segmentToCompareWith,a=e.intl,r=e.weight,i=r&&Math.round(100*r)/100;return i&&o.createElement("div",{className:"mcs-audienceSegmentDashboard_abGauge"},o.createElement("div",{style:{width:this.getGaugeRatio(i)[0]+"%"},className:"mcs-audienceSegmentDashboard_abGaugeLeft"},a.formatMessage(u.messages.experimentation)," (",i,"%)",o.createElement("span",null," - "+(0,d.formatMetric)(t.user_points_count,"0,0")+" User Points")),o.createElement("div",{style:{width:this.getGaugeRatio(i)[1]+"%"},className:"mcs-audienceSegmentDashboard_abGaugeRight"},a.formatMessage(u.messages.controlGroup)," (",100-i,"%)",o.createElement("span",null,n&&" - "+(0,d.formatMetric)(n.user_points_count,"0,0")+" User Points")))}}]),t}(o.Component);t.default=(0,i.compose)(s.injectIntl,c.default)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(11),l=n(13),c=n(10),u=_(n(23)),d=n(6),f=n(68),p=n(617),m=n(15),g=n(12),y=n(30),h=_(n(142)),v=n(229),b=n(56);function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=(0,d.defineMessages)({avg_number_of_transactions:{id:"audience.segment.dashboard.ABDetailsTable.numberOfTransactions",defaultMessage:"Average number of transactions"},avg_transaction_amount:{id:"audience.segment.dashboard.ABDetailsTable.avgTransactionAmount",defaultMessage:"Average transaction amount"},avg_revenue_per_user_point:{id:"audience.segment.dashboard.ABDetailsTable.revenue",defaultMessage:"Average Revenue Per User Point"},avg_session_duration:{id:"audience.segment.dashboard.ABDetailsTable.avgSessionDuration",defaultMessage:"Average session duration"},avg_number_of_user_events:{id:"audience.segment.dashboard.ABDetailsTable.avgNumberOfUserEvents",defaultMessage:"Average number of User Events"},conversion_rate:{id:"audience.segment.dashboard.ABDetailsTable.conversionRate",defaultMessage:"Conversion Rate"},user_points:{id:"audience.segment.dashboard.ABDetailsTable.userPoints",defaultMessage:"User Points"},export:{id:"audience.segment.dashboard.ABDetailsTable.export",defaultMessage:"Export"}}),O=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchABDetailsDatasource=function(){var e=n.props,t=e.experimentationSegment,a=e.controlGroupSegment,r=e.location.search,o=(0,y.parseSearch)(r,v.DATAMART_USERS_ANALYTICS_SETTING);if(t&&a&&a.creation_ts){n.setState({dataSource:[{metricName:"user_points",experimentationMetric:t.user_points_count,controlGroupMetric:a.user_points_count,comparison:"N/A"}]});var i={operator:"OR",filters:[{dimension_name:"type",not:!1,operator:"IN_LIST",expressions:["SITE_VISIT","APP_VISIT"],case_sensitive:!1}]},s=function(e,a){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n._datamartUsersAnalyticsService.getAnalytics(t.datamart_id,[a],o.from,o.to,[],i,e,r&&1===o.segments.length?o.segments[0]:void 0)};["avg_number_of_transactions","avg_transaction_amount","avg_revenue_per_user_point","avg_session_duration","avg_number_of_user_events","conversion_rate"].map((function(e){return Promise.all([s(t.id,e,!0),s(a.id,e)]).then((function(t){var n=t[0].data.report_view.rows[0][0],a=t[1].data.report_view.rows[0][0];return{metricName:e,experimentationMetric:n,controlGroupMetric:a,comparison:"number"==typeof n&&"number"==typeof a&&0!==a?Math.abs((a-n)/a):"-"}})).then((function(e){n.setState((function(t){return{dataSource:t.dataSource.concat(e),isLoading:!1}}))})).catch((function(e){n.props.notifyError(e),n.setState({isLoading:!1})}))}))}},n.getExport=function(){var e=n.props,t=e.experimentationSegment,a=e.intl.formatMessage,r=n.state.dataSource;n.setState({isExportLoading:!0}),t&&(h.default.exportABComparison(t,r,a),n.setState({isExportLoading:!1}))},n.buildDataColumns=function(){var e=n.props.intl;return[{key:"metricName",isHideable:!1,render:function(t){return e.formatMessage(E[t])}},{intlMessage:p.messagesMap.experimentationSegmentName,key:"experimentationMetric",isHideable:!1,render:function(e,t){return(0,b.formatMetric)(e,"conversion_rate"===t.metricName?"0,0.00%":"0,0.00")}},{intlMessage:p.messagesMap.controlGroupSegmentName,key:"controlGroupMetric",isHideable:!1,render:function(e,t){return(0,b.formatMetric)(e,"conversion_rate"===t.metricName?"0,0.00%":"0,0.00")}},{intlMessage:p.messagesMap.uplift,key:"comparison",isHideable:!1,render:function(e,t){return"User Points"!==t.metricName?""+(0,b.formatMetric)(e,"0.00%"):e}}]},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,y.updateSearch)(o,e,v.DATAMART_USERS_ANALYTICS_SETTING)};a.push(i)},n.state={isLoading:!0,dataSource:[],isExportLoading:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){this.fetchABDetailsDatasource()}},{key:"componentDidUpdate",value:function(e){var t=this.props.location.search;e.location.search!==t&&this.fetchABDetailsDatasource()}},{key:"renderDatePicker",value:function(){var e=this,t=this.props,n=t.location.search,a=t.controlGroupSegment,r=this.state.isLoading,i=(0,y.parseSearch)(n,v.DATAMART_USERS_ANALYTICS_SETTING),l={from:i.from,to:i.to};return o.createElement(s.McsDateRangePicker,{values:l,onChange:function(t){return e.updateLocationSearch({from:t.from,to:t.to})},disabled:r,excludeToday:!0,startDate:a&&a.creation_ts})}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.dataSource,a=e.isExportLoading;return o.createElement(s.Card,{buttons:o.createElement(o.Fragment,null,o.createElement(c.Button,{onClick:this.getExport,loading:a,type:"primary",className:"mcs-audienceSegmentDashboard_abExportButton"},o.createElement(d.FormattedMessage,E.export)),this.renderDatePicker())},o.createElement(f.TableViewFilters,{columns:this.buildDataColumns(),loading:t,dataSource:n}))}}]),t}(o.Component);S([(0,m.lazyInject)(g.TYPES.IDatamartUsersAnalyticsService)],O.prototype,"_datamartUsersAnalyticsService",void 0),t.default=(0,i.compose)(l.withRouter,d.injectIntl,u.default)(O)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=n(13),c=n(6),u=b(n(23)),d=b(n(2414)),f=n(51),p=b(n(2417)),m=n(109),g=b(n(346)),y=n(12),h=n(15),v=b(n(2418));function b(e){return e&&e.__esModule?e:{default:e}}var _=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchAudienceFeed=function(e,t,a){"tag"===t&&n._audienceFeedFormService.loadTagInitialValue(e,a).then((function(e){return n.setState({initialValue:e,loading:!1})})).catch((function(e){n.setState({loading:!1}),n.props.notifyError(e)})),"external"===t&&n._audienceFeedFormService.loadExternalInitialValue(e,a).then((function(e){return n.setState({initialValue:e,loading:!1})})).catch((function(e){n.setState({loading:!1}),n.props.notifyError(e)}))},n.fetchAudienceSegment=function(e){return n._audienceSegmentService.getSegment(e).then((function(e){return e.data})).then((function(e){return n.setState({audienceSegment:e})}))},n.save=function(e){var t=n.props,a=t.match.params,r=a.segmentId,o=a.organisationId;t.history.push({pathname:"/v2/o/"+o+"/audience/segments/"+r,state:{scrollToFeed:!0}})},n.onPresetSave=function(e){n.setState({type:"EXTERNAL_FEED"===e?"create_external":"create_tag"})},n.onClose=function(){var e=n.props,t=e.history,a=e.match.params,r=a.segmentId,o=a.organisationId;return t.push("/v2/o/"+o+"/audience/segments/"+r)},n.onSelectFeedType=function(e){n.setState({type:e})},n.getFeedType=function(){var e=n.props.match.params.feedType,t=n.state.type;return e?"create_tag"===e?"AUDIENCE_SEGMENT_TAG_FEED":"AUDIENCE_SEGMENT_EXTERNAL_FEED":t&&"create_tag"===t?"AUDIENCE_SEGMENT_TAG_FEED":"AUDIENCE_SEGMENT_EXTERNAL_FEED"},n.state={loading:!0,edition:!!e.match.params.feedId&&!!e.match.params.feedType},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params,t=e.segmentId,n=e.feedId,a=e.feedType;t&&this.fetchAudienceSegment(t),t&&n&&a?this.fetchAudienceFeed(t,a,n):this.setState({loading:!1})}},{key:"componentDidUpdate",value:function(e){var t=this.props.match.params,n=t.segmentId,a=t.feedId,r=t.feedType,o=e.match.params,i=o.segmentId,s=o.feedId,l=o.feedType;(n&&n!==i||a!==s||r!==l)&&(a&&r&&this.fetchAudienceFeed(n,r,a),this.fetchAudienceSegment(n))}},{key:"render",value:function(){var e=this.props,t=e.match.params,n=t.feedType,r=t.organisationId,o=t.segmentId,s=t.feedId,l=e.intl.formatMessage,c=this.state,u=c.loading,y=c.type;if(u)return i.createElement(f.Loading,{isFullScreen:!0});var h=[{name:l(g.default.actionBarSegmentTitle),path:"/v2/o/"+r+"/audience/segments"},{name:this.state.audienceSegment&&this.state.audienceSegment.name?this.state.audienceSegment.name:"",path:"/v2/o/"+r+"/audience/segments/"+o}],b=h.concat({name:l(s?g.default.actionBarSegmentFeedsEdit:g.default.actionBarSegmentFeedsCreate)});if(!n&&!y){var _={onClose:this.onClose,formId:"audienceSegmentForm"};return i.createElement(m.EditContentLayout,a({paths:h},_),i.createElement(p.default,{onSelect:this.onSelectFeedType}))}if("create_external_preset"===y||"create_tag_preset"===y){var S=h.concat({name:l(g.default.actionBarSegmentPresetCreate)});return i.createElement(v.default,{feedType:"create_external_preset"===y?"EXTERNAL_FEED":"TAG_FEED",breadcrumbPaths:S,onClose:this.onClose,onPresetSave:this.onPresetSave})}return i.createElement(d.default,{onClose:this.onClose,initialValues:this.state.initialValue,onSave:this.save,breadcrumbPaths:b,type:this.getFeedType()})}}]),t}(i.Component);_([(0,h.lazyInject)(y.TYPES.IAudienceSegmentService)],S.prototype,"_audienceSegmentService",void 0),_([(0,h.lazyInject)(y.TYPES.IAudienceFeedFormService)],S.prototype,"_audienceFeedFormService",void 0),t.default=(0,s.compose)(c.injectIntl,u.default,l.withRouter)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=v(n(0)),i=n(8),s=n(25),l=n(10),c=n(6),u=n(13),d=v(n(124)),f=h(n(346)),p=h(n(23)),m=h(n(347)),g=n(12),y=n(15);function h(e){return e&&e.__esModule?e:{default:e}}function v(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var b=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=(0,c.defineMessages)({AUDIENCE_SEGMENT_EXTERNAL_FEED:{id:"audience.segment.audienceExternalFeed.list.title",defaultMessage:"Choose your Server Side Feed Type"},AUDIENCE_SEGMENT_TAG_FEED:{id:"audience.segment.audienceTagFeed.list.title",defaultMessage:"Choose your Client Side Feed Type"},GENERIC_PLUGIN:{id:"audience.segment.genericPlugin.list.title",defaultMessage:"Choose your Plugin Type"}}),S=(0,c.defineMessages)({AUDIENCE_SEGMENT_EXTERNAL_FEED:{id:"audience.segment.audienceExternalFeed.list.subtitle",defaultMessage:"Add a Server Side Feed. A Server Side Feed Type will trigger a pixel on your properties to push cookies to third parties receivers."},AUDIENCE_SEGMENT_TAG_FEED:{id:"audience.segment.audienceTagFeed.list.subtitle",defaultMessage:"Add a Client Side Feed. A Client Side Feed Type will trigger a pixel on your properties to push cookies to third parties receivers."},GENERIC_PLUGIN:{id:"audience.segment.genericPlugin.list.subtitle",defaultMessage:"Add a Plugin. A Plugin will trigger a pixel on your properties to push cookies to third parties receivers."}}),E=(0,c.defineMessages)({AUDIENCE_SEGMENT_EXTERNAL_FEED:{id:"audience.segment.audienceExternalFeed.preset.list.title",defaultMessage:"Presets"},AUDIENCE_SEGMENT_TAG_FEED:{id:"audience.segment.audienceTagFeed.preset.list.title",defaultMessage:"Presets"},GENERIC_PLUGIN:{id:"audience.segment.genericPlugin.preset.list.title",defaultMessage:"Presets"}}),O=(0,c.defineMessages)({AUDIENCE_SEGMENT_EXTERNAL_FEED:{id:"audience.segment.audienceExternalFeed.preset.list.subtitle",defaultMessage:"Add a pre-configured Server Side Feed."},AUDIENCE_SEGMENT_TAG_FEED:{id:"audience.segment.audienceTagFeed.preset.list.subtitle",defaultMessage:"Add a pre-configured Client Side Feed."},GENERIC_PLUGIN:{id:"audience.segment.genericPlugin.preset.list.subtitle",defaultMessage:"Add a pre-configured Plugin."}}),w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.onSave=function(e,t){return(0,n.props.onSave)({plugin:e,properties:t})},n.createTagFeedPluginInstance=function(e,t,n){return{version_id:n.version_id,current_version_id:n.version_value,artifact_id:t.artifact_id,group_id:t.group_id,organisation_id:e,plugin_type:"AUDIENCE_SEGMENT_TAG_FEED"}},n.createExternalFeedPluginInstance=function(e,t,a){var r=n.props.match.params.segmentId;return{version_id:a.version_id,version_value:a.version_value,artifact_id:t.artifact_id,group_id:t.group_id,organisation_id:e,audience_segment_id:r,status:"INITIAL",created_from:"SEGMENT"}};var a="AUDIENCE_SEGMENT_EXTERNAL_FEED"===e.type?"EXTERNAL_FEED":"TAG_FEED";return n._audienceExternalFeedServiceFactory=n._audienceSegmentFeedServiceFactory("EXTERNAL_FEED"),n._audienceTagFeedServiceFactory=n._audienceSegmentFeedServiceFactory("TAG_FEED"),n.feedService="EXTERNAL_FEED"===a?n._audienceExternalFeedServiceFactory(e.match.params.segmentId):n._audienceTagFeedServiceFactory(e.match.params.segmentId),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.breadcrumbPaths,n=e.type,a=e.onClose,r=e.initialValues,i=e.match.params.feedId,s=e.intl.formatMessage,c=r&&"ACTIVE"===r.plugin.status?o.createElement(l.Alert,{message:s(f.default.audienceFeedWarningMessage),type:"warning"}):void 0;return o.createElement(m.default,{pluginType:n,listTitle:_[n]||_.genericPlugin,listSubTitle:S[n]||_.genericPlugin,pluginPresetListTitle:E[n]||E.genericPlugin,pluginPresetListSubTitle:O[n]||O.genericPlugin,breadcrumbPaths:function(){return t},pluginInstanceService:this.feedService,pluginInstanceId:i,createPluginInstance:this.createTagFeedPluginInstance,onSaveOrCreatePluginInstance:this.onSave,onClose:a,showGeneralInformation:!1,showedMessage:c,disableFields:r&&("ACTIVE"===r.plugin.status||"PUBLISHED"===r.plugin.status),isCardLayout:!0})}}]),t}(o.Component);b([(0,y.lazyInject)(g.TYPES.IAudienceSegmentFeedServiceFactory)],w.prototype,"_audienceSegmentFeedServiceFactory",void 0),t.default=(0,i.compose)(c.injectIntl,p.default,u.withRouter,(0,s.connect)(void 0,{notifyError:d.notifyError}))(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(10),s=n(24),l=n(11);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=i.Layout.Content,f=function(e){function t(){c(this,t);var e=u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.onSelect=function(t){return function(){e.props.onSelect(t)}},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.listTitle,a=t.listSubTitle;return r.createElement(i.Layout,null,r.createElement("div",{className:"edit-layout ant-layout"},r.createElement(i.Layout,null,r.createElement(d,{className:"mcs-content-container mcs-form-container text-center"},r.createElement(s.FormTitle,{title:n,subtitle:a}),r.createElement(i.Row,{className:"mcs-selector_container"},r.createElement(i.Row,{className:"menu"},this.props.availablePlugins.map((function(t){return r.createElement(l.MenuList,{title:t.plugin_layout&&t.plugin_layout.metadata&&t.plugin_layout.metadata.display_name?t.plugin_layout.metadata.display_name:t.artifact_id,key:t.id,subtitles:t.plugin_layout&&t.plugin_layout.metadata&&t.plugin_layout.metadata.description?[t.plugin_layout.metadata.description]:void 0,select:e.onSelect(t),icon_path:void 0!==t.plugin_layout?window.MCS_CONSTANTS.ASSETS_URL+t.plugin_layout.metadata.small_icon_asset_url:void 0})}))))))))}}]),t}(r.Component);t.default=(0,o.injectIntl)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(10),l=n(1127),c=(a=l)&&a.__esModule?a:{default:a},u=n(24),d=n(13),f=n(8),p=n(73);function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=s.Layout.Content,h=(0,i.defineMessages)({presetTitle:{id:"plugin.preset.list.default.title",defaultMessage:"Presets"},presetSubtitle:{id:"plugin.preset.list.default.subtitle",defaultMessage:"Add a pre-configured Plugin."}}),v=function(e){function t(){m(this,t);var e=g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.renderPluginCards=function(t){for(var n=t.map((function(t){return!!t.plugin_layout&&o.createElement(s.Col,{key:t.id+(t.plugin_preset?"-"+t.plugin_preset.id:""),span:4,className:"text-center"},o.createElement(c.default,{plugin:t,onSelect:function(){return e.props.onSelect(t)},onPresetDelete:function(){return e.props.onPresetDelete(t)},hoverable:!0}))})).filter((function(e){return!!e})),a=[];n.length>0;)a.push(n.splice(0,6));return a.map((function(e,t){return o.createElement(s.Row,{key:t,style:{marginTop:30,marginBottom:40},gutter:40},e)}))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.availablePluginLayouts,n=e.pluginListTitle,a=e.pluginListSubTitle,r=e.availablePresetLayouts,i=e.pluginPresetListTitle,l=e.pluginPresetListSubTitle;return o.createElement(s.Layout,null,o.createElement("div",{className:"edit-layout ant-layout"},o.createElement(s.Layout,null,o.createElement(y,{className:"mcs-content-container mcs-form-container"},r.length>0&&this.props.hasFeature("plugins-presets")&&o.createElement("div",null,o.createElement(u.FormTitle,{title:i||h.presetTitle,subtitle:l||h.presetSubtitle}),this.renderPluginCards(r)),o.createElement("div",null,o.createElement(u.FormTitle,{title:n,subtitle:a})),this.renderPluginCards(t)))))}}]),t}(o.Component);t.default=(0,f.compose)(i.injectIntl,d.withRouter,p.injectFeatures)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(24),s=n(6),l=n(11),c=n(8),u=n(73),d=n(65);function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=o.Layout.Content,g=(0,s.defineMessages)({listTitle:{id:"audience.segments.form.audienceFeedSelector.title",defaultMessage:"Feed Types"},listSubtitle:{id:"audience.segments.form.audienceFeedSelector.subtitle",defaultMessage:"Chose your feed type."},segmentTypeOr:{id:"audience.segments.form.audienceFeedSelector.or",defaultMessage:"Or"},feedAdvanced:{id:"audience.segments.form.audienceFeedSelector.advanced",defaultMessage:"Advanced"},createServerSidePreset:{id:"audience.segments.form.audienceFeedSelector.createServerSidePreset",defaultMessage:"Create a server side preset"},createClientSidePreset:{id:"audience.segments.form.audienceFeedSelector.createClientSidePreset",defaultMessage:"Create a client side preset"}}),y=function(e){function t(){f(this,t);var e=p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.onSelect=function(t){return function(){e.props.onSelect(t)}},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"hasRightToCreatePreset",value:function(){var e=this.props.workspace.role;return"ORGANISATION_ADMIN"===e||"COMMUNITY_ADMIN"===e||"CUSTOMER_ADMIN"===e}},{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.hasFeature;return r.createElement(o.Layout,null,r.createElement("div",{className:"edit-layout ant-layout"},r.createElement(o.Layout,null,r.createElement(m,{className:"mcs-content-container mcs-form-container text-center"},r.createElement(i.FormTitle,{title:g.listTitle,subtitle:g.listSubtitle}),r.createElement(o.Row,{className:"mcs-selector_container"},r.createElement(o.Row,{className:"menu"},r.createElement("div",{className:"presentation"},r.createElement(l.MenuPresentational,{title:"Server side",subtitles:["Triggered when users are added / deleted from segment"],type:"data",select:this.onSelect("create_external")}),r.createElement("div",{className:"separator"},r.createElement(s.FormattedMessage,g.segmentTypeOr)),r.createElement(l.MenuPresentational,{title:"Client side",subtitles:["Triggered when users are visiting your webpages / apps"],type:"code",select:this.onSelect("create_tag")}))),n("plugins-presets")&&this.hasRightToCreatePreset()?r.createElement("div",null,r.createElement(o.Row,{className:"intermediate-title"},r.createElement(s.FormattedMessage,g.feedAdvanced)),r.createElement(o.Row,{className:"menu"},r.createElement(l.MenuList,{title:t(g.createServerSidePreset),select:this.onSelect("create_external_preset")}),r.createElement(l.MenuList,{title:t(g.createClientSidePreset),select:this.onSelect("create_tag_preset")}))):null)))))}}]),t}(r.Component);t.default=(0,c.compose)(s.injectIntl,u.injectFeatures,d.injectWorkspace)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(24),l=n(6),c=n(8),u=n(109),d=v(n(1127)),f=n(51),p=v(n(630)),m=n(13),g=v(n(49)),y=n(15),h=n(12);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.modalSave=function(e,t,a,r){var o=n.props,i=o.feedType,s=o.onPresetSave,l=o.match.params.organisationId,c=n.state.selectedPlugin;c&&c.current_version_id&&c.plugin_type&&a&&n._pluginService.createPluginPreset(c.id,c.current_version_id,{organisation_id:l,name:a,description:r,plugin_type:c.plugin_type,properties:t}).then((function(){n.modalOnClose(),s(i)})).catch((function(){s(i)}))},n.modalOnClose=function(){n.setState({selectedPlugin:void 0})},n.state={plugins:[],isLoading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){this.getPluginsList()}},{key:"getPluginsList",value:function(){var e=this;this.setState({isLoading:!0},(function(){e._pluginService.getPlugins({plugin_type:"EXTERNAL_FEED"===e.props.feedType?"AUDIENCE_SEGMENT_EXTERNAL_FEED":"AUDIENCE_SEGMENT_TAG_FEED"}).then((function(e){return e.data})).then((function(t){var n=t.reduce((function(t,n){return n.current_version_id?[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t),[Promise.all([e._pluginService.getPluginVersionProperties(n.id,n.current_version_id),e._pluginService.getLocalizedPluginLayout(n.id,n.current_version_id)]).then((function(e){var t=e[0].data,a=e[1];return a&&(a=Object.assign(Object.assign({},a),{sections:a.sections.map((function(e){return Object.assign(Object.assign({},e),{fields:e.fields.map((function(e){return Object.assign(Object.assign({},e),{required:!1})}))})}))})),Object.assign(Object.assign({},n),{plugin_properties:t,plugin_layout:a||void 0})}))]):t}),[]);Promise.all(n).then((function(t){e.setState({plugins:t,isLoading:!1})}))})).catch((function(){e.setState({isLoading:!1})}))}))}},{key:"onSelect",value:function(e){this.setState({selectedPlugin:e})}},{key:"renderPluginCards",value:function(){for(var e=this,t=this.state.plugins.filter((function(e){return e&&e.plugin_layout})).map((function(t){return!!t.plugin_layout&&o.createElement(i.Col,{key:t.id+(t.plugin_preset?"-"+t.plugin_preset.id:""),span:4,className:"text-center"},o.createElement(d.default,{plugin:t,onSelect:function(){return e.onSelect(t)},hoverable:!0}))})).filter((function(e){return!!e})),n=[];t.length>0;)n.push(t.splice(0,6));return n.map((function(e,t){return o.createElement(i.Row,{key:t,style:{marginTop:30,marginBottom:40},gutter:40},e)}))}},{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.feedType,a=e.breadcrumbPaths,r=e.onClose,l=e.intl.formatMessage,c=e.fieldValidators.isRequired,d=this.state.selectedPlugin,m="EXTERNAL_FEED"===n?S.createExternalFeedPresetTitle:S.createTagFeedPresetTitle,g="EXTERNAL_FEED"===n?S.createExternalFeedPresetSubtitle:S.createTagFeedPresetSubtitle;return o.createElement(u.EditContentLayout,{paths:a,formId:"createPreset",onClose:r},this.state.isLoading?o.createElement(f.Loading,{isFullScreen:!0}):o.createElement(i.Layout,{className:"mcs-content-container mcs-form-container ant-layout-content"},o.createElement(s.FormTitle,{title:m,subtitle:g}),o.createElement("div",null,this.renderPluginCards()),d&&d.current_version_id&&d.plugin_layout&&d.plugin_properties&&o.createElement(p.default,{onClose:this.modalOnClose,organisationId:t,opened:!!d,plugin:d,save:this.modalSave,pluginProperties:d.plugin_properties,disableFields:!1,pluginLayout:d.plugin_layout,pluginVersionId:d.current_version_id,editionMode:!1,isLoading:!1,nameField:{label:l(S.feedModalNameFieldLabel),title:o.createElement("div",null,l(S.feedModalNameFieldTitle),o.createElement("br",null),o.createElement("b",null,l(S.feedModalNameFieldTitleWarning))),placeholder:l(S.feedModalNameFieldPlaceholder),display:!0,disabled:!1,validator:[c]},descriptionField:{label:l(S.feedModalDescriptionFieldLabel),title:l(S.feedModalDescriptionFieldTitle),placeholder:l(S.feedModalDescriptionFieldPlaceholder),display:!0,disabled:!1,validator:[c]},selectedTab:"configuration"})))}}]),t}(o.Component);b([(0,y.lazyInject)(h.TYPES.IPluginService)],_.prototype,"_pluginService",void 0),t.default=(0,c.compose)(m.withRouter,l.injectIntl,g.default)(_);var S=(0,l.defineMessages)({createExternalFeedPresetTitle:{id:"audience.segment.externalFeed.createPreset.title",defaultMessage:"Preset creation"},createExternalFeedPresetSubtitle:{id:"audience.segment.externalFeed.createPreset.subtitle",defaultMessage:"Choose the server side connector to create a preset from"},createTagFeedPresetTitle:{id:"audience.segment.tagFeed.createPreset.title",defaultMessage:"Preset creation"},createTagFeedPresetSubtitle:{id:"audience.segment.tagFeed.createPreset.subtitle",defaultMessage:"Choose the client side connector to create a preset from"},feedModalNameFieldLabel:{id:"audience.segment.feed.createPreset.nameField.label",defaultMessage:"Name"},feedModalNameFieldTitle:{id:"audience.segment.feed.createPreset.nameField.title",defaultMessage:"The name that will be used to identify this feed preset and the feeds created with it."},feedModalNameFieldPlaceholder:{id:"audience.segment.feed.createPreset.nameField.placeholder",defaultMessage:"Name"},feedModalDescriptionFieldLabel:{id:"audience.segment.feed.createPreset.descriptionField.label",defaultMessage:"Description"},feedModalDescriptionFieldTitle:{id:"audience.segment.feed.createPreset.descriptionField.title",defaultMessage:"A description of the feed preset to help understand what this preset is about."},feedModalDescriptionFieldPlaceholder:{id:"audience.segment.feed.createPreset.descriptionField.placeholder",defaultMessage:"Description"},feedModalNameFieldTitleWarning:{id:"audience.segment.feed.preset.create.nameField.title.warning",defaultMessage:"Warning: This name is only used in the platform, it won't be visible on the external system."}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(33),i=n(8),s=n(25),l=g(n(139)),c=n(6),u=n(67),d=g(n(2420)),f=g(n(23)),p=n(65),m=g(n(2443));function g(e){return e&&e.__esModule?e:{default:e}}var y=(0,c.defineMessages)({selectMonitoringDatamart:{id:"audience.monitoring.select.datamart.breadcrumb.title",defaultMessage:"Select Monitoring Datamart"}}),h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onDatamartSelect=function(e){var t=n.props,a=t.history,r=t.location;a.push({pathname:r.pathname,search:l.default.stringify({datamartId:e.id})})},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.history,n=e.cookies,a=e.match.params,r=a.organisationId,o=a.identifierId,i=a.identifierType;o||i||(n.mics_vid?t.push("/v2/o/"+r+"/audience/timeline/user_agent_id/vec:"+n.mics_vid):t.push("/v2/o/"+r+"/audience/timeline"))}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.history,n=e.cookies,a=e.match.params,r=a.organisationId,o=a.identifierId,i=a.identifierType,s=e.location,c=l.default.parse(s.search).datamarId;if(!o&&!i&&n.mics_vid){var u="/v2/o/"+r+"/audience/timeline/user_agent_id/vec:"+n.mics_vid+"?datamartId="+(c||"");t.push(u)}}},{key:"render",value:function(){var e=this.props,t=e.intl,n=e.workspace,a=e.match.params.organisationId,o=e.location,i=void 0,s=l.default.parse(o.search).datamartId,c=n(a).datamarts;return s&&(i=c.find((function(e){return e.id===s}))),c&&1===c.length&&(i=c[0]),i?r.createElement(m.default,null,r.createElement(d.default,{selectedDatamart:i})):r.createElement(p.DatamartSelector,{onSelect:this.onDatamartSelect,actionbarProps:{paths:[{name:t.formatMessage(y.selectMonitoringDatamart)}]},isMainlayout:!0})}}]),t}(r.Component);t.default=(0,i.compose)(c.injectIntl,o.withRouter,f.default,(0,s.connect)((function(e){return{cookies:e.session.cookies,workspace:(0,u.getWorkspace)(e)}}),void 0))(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(25),l=P(n(139)),c=n(33),u=n(6),d=n(10),f=P(n(2421)),p=P(n(2422)),m=P(n(2426)),g=P(n(2428)),y=P(n(2429)),h=P(n(2430)),v=P(n(2431)),b=P(n(2432)),_=P(n(2433)),S=P(n(132)),E=n(15),O=n(12),w=n(51),M=n(11);function P(e){return e&&e.__esModule?e:{default:e}}var T=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},I=d.Layout.Content,A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleModal=function(e){n.setState({isModalVisible:e})},n.onIdentifierChange=function(e){var t=n.props,a=t.history,r=t.match.params.organisationId,o=t.location,i=l.default.parse(o.search).datamartId?l.default.parse(o.search).datamartId:n.props.selectedDatamart.id;a.push("/v2/o/"+r+"/audience/timeline/"+e.type+"/"+e.id+"?datamartId="+i+(e.compartmentId?"&compartmentId="+e.compartmentId:""))},n.state={isModalVisible:!1,monitoringData:{userAgentList:[],userEmailList:[],userAccountsByCompartmentId:{},userAccountCompartments:[],userPointList:[],userSegmentList:[],userChoices:{userChoices:[],processings:[]},userProfile:{type:void 0,profile:{}},lastSeen:0,userIdentifier:{type:"",id:""},isUserFound:!1},isLoading:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.location.search,a=t.match.params,r=a.organisationId,o=a.identifierType,i=a.identifierId,s=t.selectedDatamart;o&&i&&(this.setState({isLoading:!0}),this._monitoringService.fetchMonitoringData(r,s,o,i,l.default.parse(n).compartmentId).then((function(t){e.setState({monitoringData:t,isLoading:!1})})).catch((function(){e.setState({isLoading:!1})})))}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,a=n.location,r=a.search,o=a.pathname,i=n.match.params,s=i.identifierType,c=i.identifierId,u=i.organisationId,d=n.selectedDatamart,f=e.location,p=f.search,m=f.pathname,g=e.selectedDatamart;r===p&&o===m&&d.id===g.id||s&&c&&(this.setState({isLoading:!0}),this._monitoringService.fetchMonitoringData(u,d,s,c,l.default.parse(r).compartmentId).then((function(e){t.setState({monitoringData:e,isLoading:!1})})).catch((function(){t.setState({monitoringData:{userAgentList:[],userEmailList:[],userAccountsByCompartmentId:{},userAccountCompartments:[],userPointList:[],userSegmentList:[],userChoices:{userChoices:[],processings:[]},userProfile:{type:void 0,profile:{}},lastSeen:0,userIdentifier:{type:"",id:""},isUserFound:!1},isLoading:!1})})))}},{key:"render",value:function(){var e=this.props.selectedDatamart,t=this.state,n=t.isModalVisible,a=t.monitoringData,r=t.isLoading;return o.createElement("div",{className:"ant-layout"},o.createElement(f.default,{selectedDatamart:e,onIdentifierChange:this.onIdentifierChange,isModalVisible:n,handleModal:this.handleModal}),o.createElement("div",{className:"ant-layout"},r?o.createElement(w.Loading,{isFullScreen:!0}):o.createElement(I,{className:"mcs-content-container"},a.isUserFound?o.createElement("div",null,o.createElement(b.default,{dataSource:a,isLoading:r}),o.createElement(d.Row,{gutter:20,style:{marginTop:"20px"},className:"mcs-monitoring"},o.createElement(d.Col,{span:6},o.createElement("div",{className:"mcs-subtitle"},o.createElement(u.FormattedMessage,S.default.visitor)),o.createElement(p.default,{dataSource:a.userProfile,isLoading:r}),o.createElement(m.default,{dataSource:a.userSegmentList,isLoading:r})),o.createElement(d.Col,{span:12},o.createElement("div",{className:"mcs-subtitle"},o.createElement(u.FormattedMessage,S.default.activities)),o.createElement(_.default,{selectedDatamart:e,userIdentifier:a.userIdentifier})),o.createElement(d.Col,{span:6},o.createElement("div",{className:"mcs-subtitle"},o.createElement(u.FormattedMessage,S.default.identifiers)),o.createElement(g.default,{userAccountCompartments:a.userAccountCompartments,userAccountsByCompartmentId:a.userAccountsByCompartmentId,isLoading:r}),o.createElement(y.default,{dataSource:a.userAgentList,isLoading:r}),o.createElement(h.default,{dataSource:a.userEmailList,isLoading:r}),o.createElement(v.default,{dataSource:a.userChoices,isLoading:r})))):o.createElement(M.EmptyTableView,{iconType:"user",message:this.props.intl.formatMessage(S.default.pleaseFillInformations)}))))}}]),t}(o.Component);T([(0,E.lazyInject)(O.TYPES.IMonitoringService)],A.prototype,"_monitoringService",void 0);t.default=(0,i.compose)(c.withRouter,u.injectIntl,(0,s.connect)((function(e){return{isFechingCookies:e.session.isFechingCookies}}),void 0))(A)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(33),c=n(6),u=n(8),d=n(11),f=n(132),p=(a=f)&&a.__esModule?a:{default:a},m=n(51),g=n(12),y=n(15);var h=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},v=s.Input.Group,b=s.Select.Option,_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchCompartments=function(e){n.setState({isLoading:!0}),n._datamartService.getUserAccountCompartmentDatamartSelectionResources(e).then((function(e){n.setState({compartments:e.data,isLoading:!1});var t=e.data.length>0?e.data.filter((function(e){return e.default}))[0]:void 0;t&&n.setState({selectedCompartment:t.compartment_id})}))},n.updateCompartment=function(e){n.setState({selectedCompartment:e})},n.updateValue=function(e){n.setState({identifierId:e.target.value})},n.updateType=function(e){n.setState({identifierType:e})},n.submitModal=function(){var e=n.state,t=e.identifierId,a=e.identifierType,r=e.selectedCompartment;n.props.onIdentifierChange({id:t,type:a,compartmentId:r}),n.props.handleModal(!1)},n.createCompartmentOptions=function(e){return e.map((function(e){return i.createElement(s.Select.Option,{key:e.compartment_id,value:e.compartment_id},e.compartment_id)}))},n.state={identifierId:"",identifierType:"user_point_id"},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this.props.selectedDatamart;this.fetchCompartments(e.id)}},{key:"componentDidUpdate",value:function(e){var t=this.props.selectedDatamart;t!==e.selectedDatamart&&this.fetchCompartments(t.id)}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.intl.formatMessage,r=t.isModalVisible,o=t.handleModal,l=t.selectedDatamart,u=this.state,f=u.identifierId,g=u.identifierType,y=u.compartments,h=u.isLoading,_=u.selectedCompartment,S=[{name:a(p.default.monitoring),path:"/v2/o/"+n+"/audience/timeline"}],E=function(){return o(!1)};if(h||!y)return i.createElement(m.Loading,{isFullScreen:!0});var O="user_account_id"===this.state.identifierType&&"DF_EU_LEGACY"!==l.datafarm&&y.length>0,w=O?_:void 0,M=O?"50%":"70%",P=this.createCompartmentOptions(y),T=O?i.createElement("span",{title:"compartment id"},"comp. id"):void 0;return i.createElement(d.Actionbar,{paths:S},i.createElement(s.Modal,{title:"Enter the user identifier you want to lookup",wrapClassName:"vertical-center-modal",visible:r,footer:[i.createElement(s.Button,{key:"back",size:"large",onClick:E},"Return"),i.createElement(s.Button,{disabled:null===f||null===g,key:"submit",type:"primary",size:"large",onClick:function(t){return e.submitModal()}},"Submit")],onCancel:E},i.createElement(v,{compact:!0},i.createElement(s.Select,{style:{width:"30%"},defaultValue:g||"user_point_id",onChange:this.updateType},i.createElement(b,{value:"user_point_id"},"User Point Id"),i.createElement(b,{value:"user_account_id"},"User Account Id"),i.createElement(b,{value:"user_agent_id"},"Vector Id"),i.createElement(b,{value:"email_hash"},"Email Hash")),i.createElement(s.Input,{name:"value",placeholder:"input your value",style:{width:M},onChange:function(t){t.persist(),e.updateValue(t)},addonAfter:T}),O&&i.createElement(s.Select,{style:{width:"20%"},defaultValue:w,onChange:this.updateCompartment},P))),i.createElement(s.Button,{className:"mcs-primary",type:"primary",onClick:function(){return o(!0)}},i.createElement(d.McsIcon,{type:"refresh"})," ",i.createElement(c.FormattedMessage,p.default.lookUpUser)))}}]),t}(i.Component);h([(0,y.lazyInject)(g.TYPES.IDatamartService)],_.prototype,"_datamartService",void 0),t.default=(0,u.compose)(c.injectIntl,l.withRouter)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(6),s=g(n(132)),l=n(11),c=n(13),u=n(8),d=g(n(23)),f=g(n(2423)),p=g(n(47)),m=g(n(1128));function g(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderProfile=function(e){return"pionus"===e.type&&Object.keys(e.profile).length>0?Object.keys(e.profile).map((function(t){return r.createElement(o.Row,{gutter:10,key:(0,p.default)(),className:"table-line border-top"},r.createElement("div",{className:"sub-title"},e.profile[t].compartmentName),r.createElement(f.default,{profiles:e.profile[t].profiles}))})):"legacy"===e.type?r.createElement(o.Row,{gutter:10,key:(0,p.default)(),className:"table-line border-top"},r.createElement(m.default,{profileGlobal:e.profile})):r.createElement("span",null,r.createElement(i.FormattedMessage,s.default.emptyProfile))},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.dataSource,n=e.intl,a=e.isLoading;return r.createElement(l.Card,{title:n.formatMessage(s.default.profileTitle),isLoading:a,className:"mcs-profileCard"},this.renderProfile(t))}}]),t}(r.Component);t.default=(0,u.compose)(i.injectIntl,c.withRouter,d.default)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=s(n(1128)),i=s(n(47));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.profiles;return r.createElement("div",null,e.map((function(e){return r.createElement(o.default,{key:(0,i.default)(),profileGlobal:e})})))}}]),t}(r.Component);t.default=l,l.defaultProps={profiles:[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(2425),l=(a=s)&&a.__esModule?a:{default:a},c=n(10),u=n(6);var d=(0,u.defineMessages)({viewMore:{id:"components.customObjectRenderer.viewMore",defaultMessage:"View more..."},viewLess:{id:"components.customObjectRenderer.viewLess",defaultMessage:"View less"}}),f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.formatObject=function(e){return null!==e&&"object"===(void 0===e?"undefined":r(e))?Object.entries(e).filter((function(e){return null!==e[1]})):[]},n.getApplyTemplateOpt=function(e,t){return function(n){if(e in n){var a=n[e](t);return i.createElement(l.default,{name:e,value:a})}return null}},n.createRecLocalTemplates=function(e,t){var n={absoluteTemplates:{},transformedTemplates:{},relativeTemplates:e.relativeTemplates},a=function(e,n){Object.entries(e).forEach((function(e){var a=e[0],r=t+".",o=e[1];if(a.startsWith(r)){var i=a.substr(r.length);n[i]=o}}))};return a(e.absoluteTemplates,n.absoluteTemplates),a(e.transformedTemplates,n.transformedTemplates),a(e.relativeTemplates,n.transformedTemplates),n},n.createDisplayedObject=function(e,t){return e?i.createElement("div",{className:"left-border-object"},t):i.createElement("span",{className:"object"},t)},n.createDisplayedObjectWithProperty=function(e,t){var a=i.createElement(l.default,{value:t});return n.createDisplayedObject(e,a)},n.reduceListAndGetViewMore=function(e){var t=n.props,a=t.expandAllStatus,r=t.authorizeExpandAll,o=n.state.viewMoreStatus,s=function(){"VIEW_MORE"===o?n.setState({viewMoreStatus:"VIEW_LESS"}):"VIEW_LESS"===o&&n.setState({viewMoreStatus:"VIEW_MORE"})},l=function(e){var t=e?d.viewMore:d.viewLess;return i.createElement("button",{className:"button-sm",onClick:s},i.createElement(u.FormattedMessage,t))};switch(a){case"INIT_OR_NOT_NEEDED":case"EXPAND_ALL":switch(o){case"INIT_OR_NOT_NEEDED":return e.length>5?(r(),n.setState({viewMoreStatus:"VIEW_MORE"}),{listToBeRendered:e.slice(0,5),viewMoreButton:l(!0)}):{listToBeRendered:e};case"VIEW_MORE":return{listToBeRendered:e.slice(0,5),viewMoreButton:l(!0)};case"VIEW_LESS":return{listToBeRendered:e,viewMoreButton:l(!1)}}break;case"COLLAPSE_ALL":return"INIT_OR_NOT_NEEDED"!==o&&n.setState({viewMoreStatus:"INIT_OR_NOT_NEEDED"}),{listToBeRendered:e}}return{listToBeRendered:[]}},n.renderAux=function(){var e=n.props,a=e.objectToBeRendered,o=e.customRenderingTemplates,s=e.leftBorder,u=e.expandAllStatus,d=e.authorizeExpandAll,f=o.absoluteTemplates,p=o.transformedTemplates,m=o.relativeTemplates;switch(void 0===a?"undefined":r(a)){case"boolean":return n.createDisplayedObjectWithProperty(s,a?"True":"False");case"string":case"number":return n.createDisplayedObjectWithProperty(s,a)}if(Array.isArray(a)){var g=n.reduceListAndGetViewMore(a),y=g.listToBeRendered,h=g.viewMoreButton,v=0!==y.length?y.map((function(e,a){return i.createElement(t,{key:a,objectToBeRendered:e,customRenderingTemplates:o,leftBorder:!0,intl:n.props.intl,expandAllStatus:u,authorizeExpandAll:d})})):n.createDisplayedObject(s,i.createElement("span",{className:"EmptyListPropertyValue"},i.createElement(c.Tooltip,{title:"Empty list"},i.createElement(c.Tag,{className:"card-tag"},"[]"))));return i.createElement("span",{className:"PropertyList"},v,h&&n.createDisplayedObject(!0,h))}var b=n.formatObject(a);if(0===b.length)return n.createDisplayedObject(s,i.createElement("span",{className:"EmptyObjectPropertyValue"},i.createElement(c.Tooltip,{title:"Empty object"},i.createElement(c.Tag,{className:"card-tag"},"{}"))));var _=n.reduceListAndGetViewMore(b),S=_.listToBeRendered,E=_.viewMoreButton,O=S.map((function(e){var a=e[0],s=e[1],c=n.getApplyTemplateOpt(a,s),g=c(f)||c(p)||c(m);if(null!==g)return g;var y=n.createRecLocalTemplates(o,a),h="boolean"==typeof s||"string"==typeof s||"number"==typeof s||Array.isArray(s)&&0===s.length||null!==s&&"object"===(void 0===s?"undefined":r(s))&&!1===Array.isArray(s)&&0===Object.keys(s).length,v=i.createElement(t,{objectToBeRendered:s,customRenderingTemplates:y,leftBorder:!h,intl:n.props.intl,expandAllStatus:u,authorizeExpandAll:d});return i.createElement(l.default,{key:a,name:a,value:v,nameNewLineValue:!h})})),w=i.createElement("span",null,O,E);return n.createDisplayedObject(s,w)},n.state={viewMoreStatus:"INIT_OR_NOT_NEEDED"},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){return i.createElement("span",null,this.renderAux())}}]),t}(i.Component);t.default=(0,u.injectIntl)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){function t(){return i(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.value,a=e.nameNewLineValue;return t?r.createElement("div",{className:a?"PropertyWithNameAndNewLine":"PropertyWithNameNoNewLine"},r.createElement(o.Tooltip,{title:t},r.createElement(o.Tag,{className:"card-tag"},t))," : ",a&&r.createElement("br",null),n):r.createElement("span",{className:"PropertyValueOnly"},n)}}]),t}(r.Component);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(11),s=f(n(2427)),l=f(n(132)),c=n(13),u=n(8),d=f(n(23));function f(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showMore:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props.intl.formatMessage,n=this.props,a=n.dataSource,c=n.isLoading,u=[];u=a.length>5&&!this.state.showMore?u.concat(a).splice(0,5):u.concat(a);var d=a.length>5;return r.createElement(i.Card,{title:t(l.default.segmentTitle),isLoading:c,className:"mcs-segmentCard"},u.length>0&&u.map((function(e){return r.createElement(s.default,{key:e.segment_id,segmentId:e.segment_id})})),0===u.length&&r.createElement("span",null,r.createElement(o.FormattedMessage,l.default.emptySegment)),d?this.state.showMore?r.createElement("div",{className:"mcs-card-footer"},r.createElement("button",{className:"mcs-card-footer-link mcs-segmentCard_viewLessLink",onClick:function(t){t.preventDefault(),e.setState({showMore:!1})}},r.createElement(o.FormattedMessage,l.default.viewLess),".")):r.createElement("div",{className:"mcs-card-footer"},r.createElement("button",{className:"mcs-card-footer-link mcs-segmentCard_viewMoreLink",onClick:function(t){t.preventDefault(),e.setState({showMore:!0})}},r.createElement(o.FormattedMessage,l.default.viewMore))):null)}}]),t}(r.Component);t.default=(0,u.compose)(o.injectIntl,c.withRouter,d.default)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(12),l=n(15),c=n(8),u=n(6),d=n(163);var f=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchSegmentData=function(e){n._audienceSegmentService.getSegment(e).then((function(e){n.setState({segment:e.data})}))},n.state={segment:void 0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.segmentId;this.fetchSegmentData(e)}},{key:"componentDidUpdate",value:function(e){var t=this.props.segmentId;t!==e.segmentId&&this.fetchSegmentData(t)}},{key:"render",value:function(){return o.createElement(i.Tooltip,{title:this.state.segment?this.state.segment.name:""},o.createElement(i.Tag,{className:"card-tag alone"},o.createElement(d.SegmentNameDisplay,{audienceSegmentResource:this.state.segment})))}}]),t}(o.Component);f([(0,l.lazyInject)(s.TYPES.IAudienceSegmentService)],p.prototype,"_audienceSegmentService",void 0),t.default=(0,c.compose)(u.injectIntl)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(6),l=n(11),c=n(132),u=(a=c)&&a.__esModule?a:{default:a};var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderCompartmentName=function(e){var t=n.props.userAccountCompartments;if(t){var a=t.find((function(t){return t.compartment_id===e}));return a?a.name?a.name:a.token?a.token:n.props.intl.formatMessage(u.default.unknownCompartmentName):""}return""},n.state={expandedItems:[],showMore:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props.intl.formatMessage,n=this.props.userAccountsByCompartmentId,a=function(t){return function(){e.setState((function(e){return{expandedItems:-1===e.expandedItems.indexOf(t)?[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e.expandedItems),[t]):e.expandedItems.filter((function(e){return e!==t}))}}))}},r=void 0===n;return o.createElement(l.Card,{title:t(u.default.accountTitle),isLoading:r,className:"mcs-accountIdCard"},n?0===Object.keys(n).length?o.createElement("span",null,o.createElement(s.FormattedMessage,u.default.emptyAccount)):Object.keys(n).map((function(t){var r=n[t].length,l=e.renderCompartmentName(t),c=n[t].slice(),d=r>5&&!e.state.expandedItems.find((function(e){return e===t}))?c.splice(0,5):n[t];return o.createElement(i.Row,{gutter:10,key:t,className:"table-line border-top",style:{display:"block"}},o.createElement("div",{className:"sub-title"},l),d.map((function(e){return o.createElement(i.Tooltip,{key:e.user_account_id,placement:"topRight",title:e.user_account_id},o.createElement(i.Tag,{className:"card-tag alone"},e.user_account_id)," ")})),r>5?e.state.expandedItems.find((function(e){return e===t}))?o.createElement("div",{className:"mcs-card-footer"},o.createElement("button",{className:"mcs-card-footer-link mcs-accountIdCard_viewLessLink",onClick:a(t)},o.createElement(s.FormattedMessage,u.default.viewLess))):o.createElement("div",{className:"mcs-card-footer"},o.createElement("button",{className:"mcs-card-footer-link mcs-accountIdCard_viewMoreLink",onClick:a(t)},o.createElement(s.FormattedMessage,u.default.viewMore))):null)})):void 0)}}]),t}(o.Component);t.default=(0,s.injectIntl)(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(11),s=c(n(1129)),l=c(n(132));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showMore:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.intl.formatMessage,a=t.dataSource,c=t.isLoading,u=a||[],d=[];d=u.length>5&&!this.state.showMore?d.concat(u).splice(0,5):d.concat(u);var f=u.length>5,p=function(t){return function(){e.setState({showMore:t})}};return r.createElement(i.Card,{title:n(l.default.deviceTitle),isLoading:c,className:"mcs-deviceCard"},d&&d.map((function(e){return e.device?r.createElement(s.default,{key:e.vector_id,vectorId:e.vector_id,device:e.device}):r.createElement("div",{key:e.vector_id},e.vector_id)})),(0===d.length||0===a.length)&&r.createElement("span",null,r.createElement(o.FormattedMessage,l.default.emptyDevice)),f?this.state.showMore?r.createElement("div",{className:"mcs-card-footer"},r.createElement("button",{className:"mcs-card-footer-link mcs-deviceCard_viewLessLink",onClick:p(!1)},r.createElement(o.FormattedMessage,l.default.viewLess))):r.createElement("div",{className:"mcs-card-footer"},r.createElement("button",{className:"mcs-card-footer-link mcs-deviceCard_viewMoreLink",onClick:p(!0)},r.createElement(o.FormattedMessage,l.default.viewMore))):null)}}]),t}(r.Component);t.default=(0,o.injectIntl)(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(6),s=d(n(17)),l=n(11),c=n(68),u=d(n(132));function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderModal=function(){var e=n.state,t=e.selectedAgent,a=e.showModal,d=n.props.intl.formatMessage,f=t.providers?t.providers:void 0,p=t.providers&&t.providers.length>0?Object.keys(t.providers[0]).map((function(e){var t=e.toUpperCase();return{intlMessage:u.default[t],key:e,isHiddable:!1,render:function(t){return function(e,t){return e.indexOf("_ts")>-1?null!==t?r.createElement("span",null,(0,s.default)(t).format("YYYY-MM-DD HH:mm:ss")):r.createElement("span",null,r.createElement("i",null,r.createElement(i.FormattedMessage,u.default.nullEmail))):"boolean"==typeof t?r.createElement("span",null,t?r.createElement(l.McsIcon,{type:"check"}):r.createElement(l.McsIcon,{type:"close"})):r.createElement("span",null,t||r.createElement("i",null,r.createElement(i.FormattedMessage,u.default.nullEmail)))}(e,t)}}})):[];return a&&r.createElement(o.Modal,{title:d(u.default.titleModalEmail),visible:a,width:"70%",onOk:n.handleClose,onCancel:n.handleClose,footer:[r.createElement(o.Button,{key:"submit",type:"primary",size:"large",onClick:n.handleClose},r.createElement(i.FormattedMessage,u.default.okModalEmail))]},r.createElement(o.Row,{gutter:10,className:"table-line",style:{display:"block"}},r.createElement(o.Col,{span:24,className:"title"},r.createElement(i.FormattedMessage,u.default.emailInfo)),r.createElement(o.Row,null,r.createElement(o.Col,{className:"table-left",span:12},r.createElement(i.FormattedMessage,u.default.emailAddress)),r.createElement(o.Col,{className:"table-right",span:12},t.email)),r.createElement(o.Row,null,r.createElement(o.Col,{className:"table-left",span:12},r.createElement(i.FormattedMessage,u.default.emailHash)),r.createElement(o.Col,{className:"table-right",span:12},t.hash)),r.createElement(o.Row,null,r.createElement(o.Col,{className:"table-left",span:12},r.createElement(i.FormattedMessage,u.default.emailCreation)),r.createElement(o.Col,{className:"table-right",span:12},(0,s.default)(t.creation_ts).format("YYYY-MM-DD HH:mm:ss"))),r.createElement(o.Row,null,r.createElement(o.Col,{className:"table-left",span:12},r.createElement(i.FormattedMessage,u.default.emailActivity)),r.createElement(o.Col,{className:"table-right",span:12},(0,s.default)(t.last_activity_ts).format("YYYY-MM-DD HH:mm:ss")))),r.createElement(o.Row,{style:{display:"block"}},t.providers?r.createElement("div",null,r.createElement(o.Col,{span:24,className:"title"},r.createElement(i.FormattedMessage,u.default.emailConsent)),r.createElement(o.Col,{span:24},r.createElement(c.TableView,{dataSource:f,columns:p,loading:!1}))):null))},n.initModal=function(e){n.setState((function(t){var n=Object.assign(Object.assign({},t),{selectedAgent:Object.assign({},e)});return n.showModal=!0,n}))},n.handleClose=function(){n.setState((function(e){var t=Object.assign({},e);return t.showModal=!1,t}))},n.state={showMore:!1,showModal:!1,selectedAgent:{providers:[],hash:"",creation_ts:0,last_activity_ts:0,type:"USER_EMAIL"}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.intl.formatMessage,a=t.dataSource,s=t.isLoading,c=a||[],d=c.length>5&&!this.state.showMore?c.splice(0,5):c,f=c.length>5,p=function(t){return function(){e.initModal(t)}},m=function(t){return function(){e.setState({showMore:t})}};return r.createElement(l.Card,{title:n(u.default.emailTitle),isLoading:s,className:"mcs-emailCard"},this.renderModal(),d&&d.map((function(e){return r.createElement("div",{key:e.email+e.hash},r.createElement(o.Row,{gutter:10,className:"table-line"},r.createElement("div",{className:"mcs-icon-left"},r.createElement(l.McsIcon,{type:"email"})),r.createElement("div",{className:"info-right"},r.createElement("div",null,r.createElement(o.Tooltip,{placement:"topRight",title:e.email},e.email)),r.createElement("div",null,r.createElement(o.Tooltip,{placement:"topRight",title:e.hash},e.hash)))),r.createElement(o.Row,{className:"text-right",style:{display:"block"}},r.createElement("button",{className:"button-sm",onClick:p(e)},r.createElement(i.FormattedMessage,u.default.viewMore))))})),(0===d.length||0===a.length)&&r.createElement("span",null,r.createElement(i.FormattedMessage,u.default.emptyEmail)),f?this.state.showMore?r.createElement("div",{className:"mcs-card-footer"},r.createElement("button",{className:"mcs-card-footer-link mcs-emailCard_viewLessLink",onClick:m(!1)},r.createElement(i.FormattedMessage,u.default.viewLess))):r.createElement("div",{className:"mcs-card-footer"},r.createElement("button",{className:"mcs-card-footer-link mcs-emailCard_viewMoreLink",onClick:m(!0)},r.createElement(i.FormattedMessage,u.default.viewMore))):null)}}]),t}(r.Component);t.default=(0,i.injectIntl)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(8),s=n(11),l=n(10),c=y(n(132)),u=y(n(225)),d=n(271),f=n(73),p=y(n(69)),m=y(n(17)),g=y(n(839));function y(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.buildData=function(e){return e.processings.reduce((function(t,n){var a=e.userChoices.find((function(e){return e.$processing_id===n.id}));return a&&t.push({processing:n,userChoice:a}),t}),[])},n.renderUserChoice=function(e){var t=n.props.colors,a=function(e){return(0,m.default)(e).format("YYYY-MM-DD, hh:mm:ss")},o={absoluteTemplates:{$choice_acceptance_value:function(e){return e?r.createElement(l.Tag,{color:t["mcs-success"]},"True"):r.createElement(l.Tag,{color:t["mcs-error"]},"False")},$creation_ts:a,$choice_ts:a},relativeTemplates:{}};return r.createElement(g.default,{customRenderingTemplates:o,customObject:e})},n.uppercaseFirstLetter=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},n.renderProcessing=function(e){var t=e.processing,a=n.uppercaseFirstLetter(t.legal_basis.toLowerCase().replace(/_/gi," ")),o=e.userChoice;return r.createElement(l.Row,{gutter:10,key:e.processing.id,className:"table-line border-top"},r.createElement(l.Row,null,r.createElement(l.Col,{span:21},r.createElement("span",{className:"title"},t.name," (",a,")")),r.createElement(l.Col,{span:3},r.createElement(l.Tooltip,{title:t.purpose,placement:"right"},r.createElement(s.McsIcon,{className:"mcs-timeline-info",type:"info"})))),o&&n.renderUserChoice(o))},n.createHandleJSONViewModal=function(e){return function(){var t=n.props.intl;l.Modal.info({title:t.formatMessage(c.default.userChoicesJson),okText:t.formatMessage(c.default.userChoicesJsonModalOkText),width:"650px",content:r.createElement(u.default,{language:"json",style:d.docco},JSON.stringify(e,void 0,4)),onOk:function(){}})}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.dataSource,a=e.isLoading;if((0,e.hasFeature)("datamart-user_choices")){var i=this.buildData(n),u=this.createHandleJSONViewModal(i),d=0!==i.length?r.createElement(l.Row,null,r.createElement("button",{className:"button-sm",onClick:u},r.createElement(o.FormattedMessage,c.default.userChoicesviewJsonButton))):null;return r.createElement(s.Card,{title:t(c.default.userChoicesTitle),isLoading:a,className:"mcs-userChoicesCard",buttons:d},0!==i.length?i.map(this.renderProcessing):r.createElement("span",null,r.createElement(o.FormattedMessage,c.default.emptyUserChoices)))}return null}}]),t}(r.Component);t.default=(0,i.compose)(f.injectFeatures,o.injectIntl,p.default)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=d(n(17)),s=d(n(132)),l=n(11),c=n(13),u=n(8);function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.dataSource,n=e.isLoading,a=t.lastSeen,c=t.userIdentifier.id,u=!n&&0!==a&&r.createElement("span",null,r.createElement(o.FormattedMessage,s.default.lastSeen)," ",(0,i.default)(a).format("YYYY-MM-DD, HH:mm:ss"));return c&&r.createElement(l.ContentHeader,{title:c,subTitle:u})}}]),t}(r.Component);t.default=(0,u.compose)(c.withRouter)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=E(n(54)),s=n(41),l=n(10),c=E(n(17)),u=E(n(47)),d=n(8),f=n(6),p=n(590),m=E(n(132)),g=n(13),y=E(n(2434)),h=E(n(23)),v=n(44),b=n(15),_=n(12),S=n(11);function E(e){return e&&e.__esModule?e:{default:e}}function O(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var w=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchUserAgents=function(e,t){n._userDataService.getIdentifiers(e.organisation_id,e.id,t.type,t.id).then((function(e){var t=e.data.filter(p.isUserAgentIdentifier);n.setState({userAgentsIdentifierInfo:t})}))},n.groupByDate=function(e,t){return i.default.groupBy(e,(function(e){return(0,c.default)(e[t]).format("YYYY-MM-DD")}))},n.removeDuplicatesFromResponse=function(e,t){var n=e.map((function(e){return Object.assign(Object.assign({},e),{$events:e.$events.sort((function(e,t){return(t.$ts||0)-(e.$ts||0)}))})})),a=t.map((function(e){return Object.assign(Object.assign({},e),{$events:e.$events.sort((function(e,t){return(t.$ts||0)-(e.$ts||0)}))})}));return t.length>0?i.default.differenceWith(n,a,i.default.isEqual):e},n.fetchActivities=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=n.state,o=r.nextDate,i=r.activityCountOnOldestDate,s=o&&!a?{live:!0,limit:10+i,to:o}:{live:!0,limit:10};n.setState((function(e){return{activities:Object.assign(Object.assign({},e.activities),{isLoading:!0})}}),(function(){return(0,v.takeLatest)(n._userDataService.getActivities)(e.id,t,s).then((function(r){(0,v.takeLatest)(n._userDataService.getActivities)(e.id,t,Object.assign(Object.assign({},s),{limit:s.limit+1})).then((function(e){n.setState((function(t){var o=a?r.data:t.activities.items.concat(n.removeDuplicatesFromResponse(r.data,t.activities.items)),i=n.generateScenarioMovementActivities(o.slice(0)).sort((function(e,t){return n.orderScenarioActivities(e,t)})),s={activities:Object.assign(Object.assign({},t.activities),{isLoading:!1,hasItems:r.count!==e.count,items:o,byDay:n.groupByDate(i,"$ts")}),nextDate:r.count!==e.count&&r.data&&r.data[r.data.length-1]?(0,c.default)(r.data[r.data.length-1].$ts).add(1,"day").format("YYYY-MM-DD"):void 0,activityCountOnOldestDate:0};return s.activityCountOnOldestDate=(s.activities.byDay[Object.keys(s.activities.byDay)[Object.keys(s.activities.byDay).length-1]]||[]).length,s}))}))})).catch((function(e){n.setState((function(e){return{activities:{hasItems:!1,isLoading:!1,items:[],byDay:{}}}}))}))}))},n.fetchNewActivities=function(e){var t=n.props,a=t.userIdentifier,r=t.selectedDatamart;e.preventDefault(),n.fetchActivities(r,a)},n.renderPendingTimeline=function(e){return e.hasItems&&e.items.length>0?e.isLoading?o.createElement(l.Spin,{size:"small"}):o.createElement("button",{className:"mcs-card-inner-action mcs-monitoring_seeMoreBtn",onClick:n.fetchNewActivities},o.createElement(f.FormattedMessage,m.default.seeMore)):o.createElement("div",{className:"mcs-title"},e.hasItems?o.createElement(f.FormattedMessage,m.default.noActivities):o.createElement(f.FormattedMessage,m.default.noActivitiesLeft))},n.renderDate=function(e){var t=n.props.intl.formatMessage;switch(e){case(0,c.default)().format("YYYY-MM-DD"):return t(m.default.today);case(0,c.default)().subtract(1,"days").format("YYYY-MM-DD"):return t(m.default.yesterday);default:return e}},n.state={activities:{isLoading:!1,hasItems:!1,items:[],byDay:{}},activityCountOnOldestDate:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.selectedDatamart,n=e.userIdentifier;n.id&&n.type&&(this.fetchActivities(t,n),this.fetchUserAgents(t,n))}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.selectedDatamart,a=t.userIdentifier,r=e.selectedDatamart,o=e.userIdentifier;a.id&&a.type&&(a.id!==o.id||n.id!==r.id||a.type!==o.type)&&(this.fetchActivities(n,a,!0),this.fetchUserAgents(n,a))}},{key:"generateScenarioMovementActivities",value:function(e){var t=e.filter((function(e){return"USER_SCENARIO_NODE_ENTER"===e.$type&&"None"!==e.$previous_node_name})),n=i.default.flatMap(t,(function(t){return e.filter((function(e){return e.$ts===t.$ts&&"USER_SCENARIO_NODE_EXIT"===e.$type&&e.$node_name===t.$previous_node_name})).map((function(e){return{scenarioActivity:Object.assign(Object.assign({},t),{$type:"USER_SCENARIO_NODE_MOVEMENT"}),nodeEnterActivity:t,nodeExitActivity:e}}))})).reduce((function(e,t){return{scenarioActivities:[].concat(O(e.scenarioActivities),[t.scenarioActivity]),nodeEnterActivitiesToBeRemoved:[].concat(O(e.nodeEnterActivitiesToBeRemoved),[t.nodeEnterActivity]),nodeExitActivitiesToBeRemoved:[].concat(O(e.nodeExitActivitiesToBeRemoved),[t.nodeExitActivity])}}),{scenarioActivities:[],nodeEnterActivitiesToBeRemoved:[],nodeExitActivitiesToBeRemoved:[]}),a=n.scenarioActivities,r=n.nodeEnterActivitiesToBeRemoved,o=n.nodeExitActivitiesToBeRemoved;return i.default.difference(e.concat(a),r.concat(o))}},{key:"orderScenarioActivities",value:function(e,t){return t.$ts-e.$ts==0?"USER_SCENARIO_START"===e.$type||"USER_SCENARIO_STOP"===t.$type?1:"USER_SCENARIO_START"===t.$type||"USER_SCENARIO_STOP"===e.$type?-1:t.$ts-e.$ts:t.$ts-e.$ts}},{key:"findMcsType",value:function(e){switch(e.$type){case"USER_SCENARIO_STOP":return"close";case"USER_SCENARIO_NODE_ENTER":case"USER_SCENARIO_NODE_EXIT":case"USER_SCENARIO_NODE_MOVEMENT":return"refresh";default:return"status"}}},{key:"findClassName",value:function(e){return"USER_SCENARIO_STOP"===e.$type?"mcs-timeline-dot red":"SESSION_SNAPSHOT"===e.$session_status?"mcs-timeline-dot live":"mcs-timeline-dot"}},{key:"renderType",value:function(e){switch(e.$type){case"USER_SCENARIO_START":return o.createElement(s.FlagOutlined,{className:"mcs-timeline-dot live"});default:var t=this.findMcsType(e);return o.createElement(S.McsIcon,{type:t,className:this.findClassName(e)})}}},{key:"render",value:function(){var e=this,t=this.state,n=t.activities,a=t.userAgentsIdentifierInfo,r=this.props.selectedDatamart,i=Object.keys(n.byDay);return!0===n.isLoading&&0===n.items.length?o.createElement(l.Col,{span:24,className:"text-center"},o.createElement(l.Spin,null)):o.createElement(l.Timeline,{pending:this.renderPendingTimeline(n),pendingDot:o.createElement(S.McsIcon,{type:"status",className:"mcs-timeline-last-dot"})},i.map((function(t){var i=n.byDay[t],c=e.renderDate(t);return o.createElement("div",{className:"mcs-timeline",key:(0,u.default)()},o.createElement(l.Timeline.Item,{dot:o.createElement(s.FlagOutlined,{className:"mcs-timeline-dot"})},o.createElement("div",{className:"mcs-title"},c)),0!==i.length&&i.map((function(t){return o.createElement(l.Timeline.Item,{key:(0,u.default)(),dot:e.renderType(t)},o.createElement(y.default,{activity:t,selectedDatamart:r,userAgentsIdentifierInfo:a}))})))})))}}]),t}(o.Component);w([(0,b.lazyInject)(_.TYPES.IUserDataService)],M.prototype,"_userDataService",void 0),t.default=(0,d.compose)(g.withRouter,f.injectIntl,h.default)(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(41),s=n(10),l=T(n(17)),c=n(8),u=T(n(225)),d=n(271),f=n(6),p=n(11),m=T(n(2435)),g=T(n(1129)),y=T(n(2436)),h=T(n(2437)),v=T(n(2441)),b=T(n(132)),_=T(n(59)),S=n(44),E=n(13),O=T(n(2442)),w=n(15),M=n(12),P=n(65);function T(e){return e&&e.__esModule?e:{default:e}}var I,A=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},C=["SITE_VISIT","APP_VISIT"];!function(e){e[e.USER_SCENARIO_START=0]="USER_SCENARIO_START",e[e.USER_SCENARIO_STOP=1]="USER_SCENARIO_STOP",e[e.USER_SCENARIO_NODE_ENTER=2]="USER_SCENARIO_NODE_ENTER",e[e.USER_SCENARIO_NODE_EXIT=3]="USER_SCENARIO_NODE_EXIT",e[e.USER_SCENARIO_NODE_MOVEMENT=4]="USER_SCENARIO_NODE_MOVEMENT"}(I||(I={}));var j=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getChannelPromise=void 0,n.getAgentInfoFromAgentId=function(e){var t=n.props.userAgentsIdentifierInfo;return e?t&&t.find((function(t){return t.vector_id===e})):void 0},n.diplayVisitDuration=function(e){var t=l.default.duration(e.$session_duration,"seconds").seconds(),a=l.default.duration(e.$session_duration,"seconds").minutes(),r=l.default.duration(e.$session_duration,"seconds").hours(),o=l.default.duration(e.$session_duration,"seconds").days(),i=n.props.intl.formatMessage;return o>1?o+" "+i(b.default.day)+" "+r+" "+i(b.default.hours)+" "+a+" "+i(b.default.minutes)+" "+t+" "+i(b.default.seconds):r>=1?r+" "+i(b.default.hours)+" "+a+" "+i(b.default.minutes)+" "+t+" "+i(b.default.seconds):a>=1?a+" "+i(b.default.minutes)+" "+t+" "+i(b.default.seconds):t+" "+i(b.default.seconds)},n.handleJSONViewModal=function(){var e=n.props,t=e.activity,a=e.intl;s.Modal.info({title:a.formatMessage(b.default.activityJson),okText:a.formatMessage(b.default.eventJsonModalOkText),width:"650px",content:o.createElement(u.default,{language:"json",style:d.docco},JSON.stringify(t,void 0,4))})},n.state={siteName:void 0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentWillUnmount",value:function(){this.getChannelPromise&&this.getChannelPromise.cancel()}},{key:"getChannelInformation",value:function(e){var t=this,n=this.props,a=n.selectedDatamart,r=n.workspace,o=r.community_id,i=r.organisation_id;if(e&&C.indexOf(e.$type)>-1){var s=e.$site_id?e.$site_id:e.$app_id,l=e.$site_id?"Site":"App";this.getChannelPromise=(0,S.makeCancelable)(o===i?this._userDataService.getChannel(s,{community_id:o,with_source_datamarts:!0}):this._userDataService.getChannel(s,{organisation_id:i,datamart_id:a.id})),this.getChannelPromise.promise.then((function(e){t.setState({siteName:l+": "+e.data.name})})).catch((function(e){return _.default.error(e)}))}else this.setState((function(t){var n=Object.assign({},t);switch(e.$type){case"TOUCH":n.siteName="Touch";break;case"EMAIL":n.siteName="Email";break;case"DISPLAY_AD":n.siteName="Display Ad";break;case"STOPWATCH":n.siteName="Stopwatch";break;case"RECOMMENDER":n.siteName="Recommender";break;default:n.siteName=e.$type}return n}))}},{key:"componentDidMount",value:function(){var e=this.props.activity;this.getChannelInformation(e)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.match.params.organisationId,a=t.selectedDatamart,r=t.activity,o=e.match.params.organisationId,i=e.selectedDatamart;n===o&&a===i||this.getChannelInformation(r)}},{key:"generateCardContent",value:function(e){var t=this.getAgentInfoFromAgentId(e.$user_agent_id),n=t&&t.device?t.device:void 0,a=e&&e.$location&&e.$location.$latlon?parseInt(e.$location.$latlon[1],10):0,r=e&&e.$location&&e.$location.$latlon?parseInt(e.$location.$latlon[0],10):0;return o.createElement(s.Row,{style:{display:"block"}},o.createElement(g.default,{vectorId:e.$user_agent_id,device:n}),o.createElement(y.default,{origin:e.$origin}),o.createElement(h.default,{longitude:a,latitude:r}),o.createElement(v.default,{topics:e.$topics}),o.createElement("div",null,e.$events.sort((function(e,t){return(t.$ts||0)-(e.$ts||0)})).map((function(e){return o.createElement(m.default,{key:e.$event_name+e.$ts,event:e})}))))}},{key:"render",value:function(){var e=this.props.activity;if(Object.values(I).includes(e.$type))return o.createElement(O.default,{activity:e});var t=this.diplayVisitDuration(e),n=o.createElement("div",{className:"timeline-activity-card-buttons"},C.indexOf(e.$type)>-1?o.createElement("span",null,o.createElement(i.ClockCircleOutlined,null)," ",t||0,o.createElement("br",null)):null,o.createElement(p.Button,{onClick:this.handleJSONViewModal,className:"mcs-card-inner-action"},o.createElement(f.FormattedMessage,b.default.viewActivityJson)));return o.createElement(p.Card,{title:this.state.siteName,buttons:n,className:"mcs-activityCard"},this.generateCardContent(e),o.createElement(s.Row,{className:"border-top sm-footer timed-footer text-right",style:{display:"block"}},(0,l.default)(e.$ts).format("H:mm:ss")))}}]),t}(o.Component);A([(0,w.lazyInject)(M.TYPES.IUserDataService)],j.prototype,"_userDataService",void 0),t.default=(0,c.compose)(f.injectIntl,P.injectWorkspace,E.withRouter)(j)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=p(n(17)),s=n(6),l=p(n(225)),c=n(271),u=p(n(132)),d=n(11),f=p(n(839));function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleJSONViewModal=function(){var e=n.props,t=e.event,a=e.intl;o.Modal.info({title:a.formatMessage(u.default.eventJson),okText:a.formatMessage(u.default.eventJsonModalOkText),width:"650px",content:r.createElement(l.default,{language:"json",style:c.docco},JSON.stringify(t,void 0,4)),onOk:function(){}})},n.state={showMore:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props.event,n=this.state.showMore,a=function(){return e.setState({showMore:!n})};return r.createElement(o.Row,{className:"section border-top"},r.createElement(o.Col,{className:"section-ts",span:5},(0,i.default)(t.$ts).format("HH:mm:ss")),r.createElement(o.Col,{span:19},r.createElement("div",{className:"section-title"},t.$event_name),r.createElement("div",{className:"section-cta"},t.$properties&&n?r.createElement("div",null,r.createElement(d.Button,{onClick:this.handleJSONViewModal,className:"mcs-card-inner-action",style:{marginRight:"10px"}},r.createElement(s.FormattedMessage,u.default.viewEventJson)),r.createElement("button",{className:"mcs-card-inner-action",onClick:a},r.createElement(d.McsIcon,{className:"mcs-icon-inverted",type:"chevron"})," ",r.createElement(s.FormattedMessage,u.default.less))):r.createElement("div",null,r.createElement("button",{className:"mcs-card-inner-action",onClick:a},r.createElement(d.McsIcon,{type:"chevron"})," ",r.createElement(s.FormattedMessage,u.default.detail))))),t.$properties&&n&&r.createElement("div",{className:"event-properties-list"},r.createElement(f.default,{customObject:t.$properties,customRenderingTemplates:{absoluteTemplates:{},relativeTemplates:{}}})))}}]),t}(r.Component);t.default=(0,s.injectIntl)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=c(n(17)),s=n(10),l=c(n(132));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e){function t(){return u(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.origin;return r.createElement(s.Row,{gutter:10,className:"section table-line border-top"},r.createElement(s.Col,{span:5,className:"section-title"},r.createElement(o.FormattedMessage,l.default.origin)),r.createElement(s.Col,{span:19},e?Object.keys(e).map((function(t){var n=e[t];return n?function(e,t){return r.createElement("div",{key:e},r.createElement(s.Col,{className:"table-left",span:12},r.createElement("span",null,r.createElement(s.Tooltip,{title:e},e))),r.createElement(s.Col,{className:"table-right",span:12},r.createElement("span",null,r.createElement(s.Tooltip,{title:"$ts"===e?(0,i.default)(t).format("YYYY MM DD, hh:mm:ss"):t},"$ts"===e?(0,i.default)(t).format("YYYY MM DD, hh:mm:ss"):t))))}(t,n):null})):r.createElement("span",null,r.createElement(o.FormattedMessage,l.default.direct))))}}]),t}(r.Component);t.default=f},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(1241),l=u(s),c=u(n(840));function u(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=function(t){function n(){return d(this,n),f(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,t),r(n,[{key:"render",value:function(){var t=this.props,n=t.longitude,r=t.latitude,c=this.props.containerWidth?this.props.containerWidth:0;return n&&r?o.createElement(i.Row,{gutter:10,className:"table-line section border-top"},o.createElement(i.Col,{span:24,style:{height:"100px",margin:"-5px -20px"}},o.createElement(l.default,a({},{dragPan:!1,dragRotate:!1,scrollZoom:!1,touchZoomRotate:!1,doubleClickZoom:!1},{width:c+40,height:100,latitude:r,longitude:n,zoom:9,attributionControl:!1,preventStyleDiffing:!0,mapboxApiAccessToken:e.window.MCS_CONSTANTS.MAPBOX_TOKEN}),o.createElement(s.Marker,{latitude:r,longitude:n},o.createElement("svg",{width:"10",height:"10"},o.createElement("circle",{cx:"5",cy:"5",r:"5",fill:"#00a1df"})))))):o.createElement("span",null)}}]),n}(o.Component);t.default=(0,c.default)(p)}).call(this,n(71))},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(6),l=n(132),c=(a=l)&&a.__esModule?a:{default:a};var u=function(e,t,n){return o.createElement(i.Row,{key:e+t+n},o.createElement(i.Col,{className:"",span:8},o.createElement("span",null,e)),o.createElement(i.Col,{className:"",span:8},o.createElement("span",null,t)),o.createElement(i.Col,{className:"",span:8},o.createElement("span",null,n)))};t.default=function(e){var t=e.topics;return t&&Object.keys(t).length?o.createElement(i.Row,{gutter:10,className:"section table-line border-top"},o.createElement(i.Col,{span:5,className:"section-title"},o.createElement(s.FormattedMessage,c.default.topics)),o.createElement(i.Col,{span:19},t?Object.keys(t).map((function(e){var n=t;return"object"!==r(n[e])||Array.isArray(n[e])?(Array.isArray(n[e])&&n[e].map((function(t){return u(e,void 0,t)})),u(e,void 0,n[e])):0===Object.keys(n[e]).length?u(e):Object.keys(n[e]).map((function(t){return u(e,t,n[e][t])}))})):null)):null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=p(n(17)),l=n(8),c=n(6),u=n(11),d=p(n(132)),f=n(13);function p(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e){function t(){return m(this,t),g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"generateCardElements",value:function(e){switch(e.$type){case"USER_SCENARIO_START":return{title:o.createElement(c.FormattedMessage,d.default.userScenarioStartTitle),intlMsg:o.createElement(c.FormattedMessage,a({},d.default.userScenarioStartContent,{values:{scenarioName:o.createElement("b",null,e.$scenario_name)}}))};case"USER_SCENARIO_STOP":return{title:e.$matched_exit_condition_id?o.createElement(c.FormattedMessage,d.default.userScenarioStopOnExitConditionTitle):o.createElement(c.FormattedMessage,d.default.userScenarioStopTitle),intlMsg:o.createElement(c.FormattedMessage,a({},d.default.userScenarioStopContent,{values:{scenarioName:o.createElement("b",null,e.$scenario_name)}}))};case"USER_SCENARIO_NODE_ENTER":return{title:o.createElement(c.FormattedMessage,d.default.userScenarioNodeEnterTitle),intlMsg:o.createElement(c.FormattedMessage,a({},d.default.userScenarioNodeEnterContent,{values:{scenarioName:o.createElement("b",null,e.$scenario_name),scenarioNodeName:o.createElement("b",null,e.$node_name)}}))};case"USER_SCENARIO_NODE_EXIT":return{title:o.createElement(c.FormattedMessage,d.default.userScenarioNodeExitTitle),intlMsg:o.createElement(c.FormattedMessage,a({},d.default.userScenarioNodeExitContent,{values:{scenarioName:o.createElement("b",null,e.$scenario_name),scenarioNodeName:o.createElement("b",null,e.$node_name)}}))};case"USER_SCENARIO_NODE_MOVEMENT":return{title:o.createElement(c.FormattedMessage,d.default.userScenarioNodeMovementTitle),intlMsg:o.createElement(c.FormattedMessage,a({},d.default.userScenarioNodeMovementContent,{values:{scenarioName:o.createElement("b",null,e.$scenario_name),scenarioNodeName:o.createElement("b",null,e.$node_name),scenarioOldNodeName:o.createElement("b",null,e.$previous_node_name)}}))};default:return{title:"Scenario item not found",intlMsg:""}}}},{key:"render",value:function(){var e=this.props.activity,t=this.generateCardElements(e);return o.createElement(u.Card,{title:t.title},o.createElement(i.Row,null,o.createElement("div",{className:"mcs-card-content-text"},t.intlMsg)),o.createElement(i.Row,{className:"border-top sm-footer timed-footer text-right"},(0,s.default)(e.$ts).format("H:mm:ss")))}}]),t}(o.Component);t.default=(0,l.compose)(c.injectIntl,f.withRouter)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(23),s=(a=i)&&a.__esModule?a:{default:a},l=n(8),c=n(6);var u={id:"components.errorBoundary.hasError.msg",defaultMessage:"Something went wrong"},d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hasError:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidCatch",value:function(e,t){this.setState({hasError:!0}),this.props.notifyError(e,t)}},{key:"render",value:function(){return this.state.hasError?o.createElement("div",{className:"ant-layout"},o.createElement(c.FormattedMessage,u)):this.props.children}}]),t}(o.Component);t.default=(0,l.compose)(s.default)(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentBuilderPage=void 0;var a,r=n(2445),o=(a=r)&&a.__esModule?a:{default:a};t.SegmentBuilderPage=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=b(n(139)),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(6),l=n(25),c=n(13),u=n(8),d=n(65),f=b(n(23)),p=b(n(813)),m=b(n(1130)),g=n(12),y=n(15),h=n(10),v=n(228);function b(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=(0,s.defineMessages)({segmentBuilder:{id:"audience.segmentBuilder.actionbar.title",defaultMessage:"Segment Builder"},noMoreSupported:{id:"audience.segmentBuilder.legacyComponent.noMoreSupported",defaultMessage:"The query language related to this datamart is no more supported. Please select another datamart or create a new resource based on another datamart."}}),w=function(e){function t(){return _(this,t),S(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.intl,a=t.connectedUser,r=t.location,s=t.history,l=t.match,c=void 0,u=a.workspaces.find((function(t){return t.organisation_id===e.props.match.params.organisationId})),f=o.default.parse(r.search).datamartId;u&&u.datamarts&&1===u.datamarts.length&&(c=u.datamarts[0]),f&&u&&(c=u.datamarts.find((function(e){return e.id===f})));return i.createElement("div",{style:{height:"100%",display:"flex"}},!c&&i.createElement(d.DatamartSelector,{onSelect:function(e){s.push({pathname:r.pathname,search:o.default.stringify({datamartId:e.id})})},actionbarProps:{paths:[{name:n.formatMessage(O.segmentBuilder)}]},isMainlayout:!0}),c&&"v201709"===c.storage_model_version&&i.createElement(p.default,{datamartId:c.id,renderActionBar:function(t,a){return i.createElement(m.default,{saveAsUserQuery:function(n){var r=n.name,o=n.technical_name,i=n.persisted;return e._queryService.createQuery(a,{query_language:"JSON_OTQL",query_text:JSON.stringify(t)}).then((function(t){var s={datamart_id:a,type:"USER_QUERY",name:r,technical_name:o,persisted:i,default_ttl:(0,v.calculateDefaultTtl)(n),query_id:t.data.id,segment_editor:"SEGMENT_BUILDER"};return e._audienceSegmentService.saveSegment(l.params.organisationId,s)})).then((function(e){s.push("/v2/o/"+l.params.organisationId+"/audience/segments/"+e.data.id)}))},convertToOtql:function(){return e._queryService.createQuery(a,{query_language:"JSON_OTQL",query_text:JSON.stringify(t)}).then((function(e){return e.data})).then((function(t){return e._queryService.convertJsonOtql2Otql(a,t)}))},breadcrumb:[{name:n.formatMessage(O.segmentBuilder)}]})}}),c&&"v201506"===c.storage_model_version&&i.createElement(h.Alert,{message:n.formatMessage(O.noMoreSupported),type:"warning"}))}}]),t}(i.Component);E([(0,y.lazyInject)(g.TYPES.IAudienceSegmentService)],w.prototype,"_audienceSegmentService",void 0),E([(0,y.lazyInject)(g.TYPES.IQueryService)],w.prototype,"_queryService",void 0),t.default=(0,u.compose)(s.injectIntl,c.withRouter,f.default,(0,l.connect)((function(e){return{connectedUser:e.session.connectedUser}})))(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=n(25),c=n(35),u=n(10),d=n(6),f=n(2447),p=(a=f)&&a.__esModule?a:{default:a};function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},h=function(e){function t(){return m(this,t),g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.onOk,n=e.submit,a=e.visible,o=e.csvExportDisabled,s=y(e,["onOk","submit","visible","csvExportDisabled"]);return i.createElement(u.Modal,r({},s,{visible:a,onOk:function(){n(f.FORM_ID)},title:i.createElement(d.FormattedMessage,{id:"queryTool.query-tool-modal-saveas-export-title",defaultMessage:"Save As Export"})}),a&&i.createElement(p.default,{onSubmit:function(e){t(e)},csvExportDisabled:o}))}}]),t}(i.Component);t.default=(0,s.compose)((0,l.connect)(void 0,{submit:c.submit}))(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(35),i=n(77),s=n(24),l=n(8),c=n(6);var u=t.FORM_ID="exportSimpleForm",d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"getOptionList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?[{value:"JSON",title:"JSON"}]:[{value:"JSON",title:"JSON"},{value:"CSV",title:"CSV"}]}},{key:"render",value:function(){var e=this.props,t=e.fieldValidators,n=e.intl,a=e.handleSubmit,o=e.csvExportDisabled;return r.createElement(i.Form,{className:"edit-layout ant-layout",layout:"vertical",onSubmit:a},r.createElement("div",{className:"mcs-form-container",style:{paddingTop:"0px"}},r.createElement(s.FormInputField,{name:"name",component:s.FormInput,validate:[t.isRequired],formItemProps:{label:n.formatMessage(f.exportNameLabel),required:!0},inputProps:{placeholder:n.formatMessage(f.exportNamelPlaceholder),addonAfter:r.createElement(s.FormAddonSelectField,{name:"outputFormat",component:s.AddonSelect,options:this.getOptionList(o)})},helpToolTipProps:{title:n.formatMessage(f.exportNameTooltip)},small:!0})))}}]),t}(r.Component);t.default=(0,l.compose)(c.injectIntl,s.withValidators,(0,o.reduxForm)({form:u,initialValues:{outputFormat:"JSON"}}))(d);var f=(0,c.defineMessages)({exportNameLabel:{id:"query.saveas.export.name.title",defaultMessage:"Name"},exportNamelPlaceholder:{id:"query.saveas.export.name.placeholder",defaultMessage:"Export Name"},exportNameTooltip:{id:"query.saveas.export.name.helper",defaultMessage:"Give your Export a name to find it back on the export screen."}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(6),c=n(2449),u=(a=c)&&a.__esModule?a:{default:a},d=n(25),f=n(8),p=n(35);function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},h=function(e){function t(){return m(this,t),g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.onOk,n=e.submit,a=e.visible,o=y(e,["onOk","submit","visible"]);return i.createElement(s.Modal,r({},o,{visible:a,onOk:function(){n(c.FORM_ID)},title:i.createElement(l.FormattedMessage,{id:"queryTool.queryTool.query-tool-modal-saveas-export",defaultMessage:"Save As User Query Segment"})}),a&&i.createElement(u.default,{onSubmit:function(e){t(e)}}))}}]),t}(i.Component);t.default=(0,f.compose)((0,d.connect)(void 0,{submit:p.submit}))(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(35),i=n(77),s=n(11),l=n(24),c=n(8),u=n(6);var d=t.FORM_ID="userQuerySegmentSimpleForm",f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.fieldValidators,a=t.intl,o=t.handleSubmit;return r.createElement(i.Form,{className:"edit-layout ant-layout",layout:"vertical",onSubmit:o},r.createElement("div",{className:"mcs-form-container",style:{paddingTop:"0px"}},r.createElement(l.FormInputField,{name:"name",component:l.FormInput,validate:[n.isRequired],formItemProps:{label:a.formatMessage(p.segmentNameLabel),required:!0},inputProps:{placeholder:a.formatMessage(p.segmentNamePlaceHolder)},helpToolTipProps:{title:a.formatMessage(p.segmentNameTooltip)},small:!0}),r.createElement(s.Button,{className:"optional-section-title",onClick:function(){return e.setState({displayAdvancedSection:!e.state.displayAdvancedSection})}},r.createElement(s.McsIcon,{type:"settings"}),r.createElement("span",{className:"step-title"},a.formatMessage(p.segmentAdvancedButtonLabel)),r.createElement(s.McsIcon,{type:"chevron"})),this.state.displayAdvancedSection&&r.createElement("div",null,r.createElement("div",{className:"optional-section-content"},r.createElement(l.FormInputField,{name:"technical_name",component:l.FormInput,formItemProps:{label:a.formatMessage(p.segmentTechinicalNameLabel)},inputProps:{placeholder:a.formatMessage(p.segmentTechinicalNamePlaceholder)},helpToolTipProps:{title:a.formatMessage(p.segmentTechinicalNameTooltip)},small:!0})),r.createElement(l.FormInputField,{name:"defaultLifetime",component:l.FormInput,validate:[n.isValidInteger,n.isNotZero],formItemProps:{label:a.formatMessage(p.segmentDefaultLifetimeLabel)},inputProps:{addonAfter:r.createElement(l.FormAddonSelectField,{name:"defaultLifetimeUnit",component:l.AddonSelect,options:[{value:"days",title:a.formatMessage(p.segmentDefaultLifetimeOptionDAY)},{value:"weeks",title:a.formatMessage(p.segmentDefaultLifetimeOptionWEEK)},{value:"months",title:a.formatMessage(p.segmentDefaultLifetimeOptionMONTH)}]}),placeholder:a.formatMessage(p.segmentDefaultLifetimePlaceholder),style:{width:"100%"}},helpToolTipProps:{title:a.formatMessage(p.segmentDefaultLifetimeTooltip)},small:!0}),r.createElement(l.FormBooleanField,{name:"persisted",component:l.FormBoolean,formItemProps:{label:a.formatMessage(p.segmentPersistedLabel),hasMarginBottom:!0},helpToolTipProps:{title:a.formatMessage(p.segmentPersistedTooltip)},small:!0}),r.createElement(l.FormBooleanField,{name:"paused",component:l.FormBoolean,formItemProps:{label:a.formatMessage(p.segmentPausedLabel),hasMarginBottom:!0},helpToolTipProps:{title:a.formatMessage(p.segmentPausedTooltip)},small:!0}))))}}]),t}(r.Component);t.default=(0,c.compose)(u.injectIntl,l.withValidators,l.withNormalizer,(0,o.reduxForm)({form:d,initialValues:{defaultLifetimeUnit:"days",persisted:!0}}))(f);var p=(0,u.defineMessages)({segmentNameLabel:{id:"query.saveas.segment.name.label",defaultMessage:"Name"},segmentNamePlaceHolder:{id:"query.saveas.segment.name.placeholder",defaultMessage:"Audience Segment Name"},segmentNameTooltip:{id:"query.saveas.segment.name.helper",defaultMessage:"Give your Audience Segment a name to find it back on the segment screen."},segmentAdvancedButtonLabel:{id:"query.saveas.segment.advanced",defaultMessage:"Advanced"},segmentDefaultLifetimeLabel:{id:"query.saveas.segment.defaultlifetime.label",defaultMessage:"Default lifetime"},segmentDefaultLifetimePlaceholder:{id:"query.saveas.segment.defaultlifetime.placeholder",defaultMessage:"Default lifetime"},segmentDefaultLifetimeOptionDAY:{id:"query.saveas.segment.defaultlifetime.optionDAY",defaultMessage:"Days"},segmentDefaultLifetimeOptionWEEK:{id:"query.saveas.segment.defaultlifetime.optionWEEK",defaultMessage:"Weeks"},segmentDefaultLifetimeOptionMONTH:{id:"query.saveas.segment.defaultlifetime.optionMONTH",defaultMessage:"Months"},segmentDefaultLifetimeTooltip:{id:"query.saveas.segment.defaultlifetime.tooltip",defaultMessage:"Use the Default lifetime expiration"},segmentTechinicalNameLabel:{id:"query.saveas.segment.technicalname.label",defaultMessage:"Technical Name"},segmentTechinicalNamePlaceholder:{id:"query.saveas.segment.technicalname.placeholder",defaultMessage:"Technical Name"},segmentTechinicalNameTooltip:{id:"query.saveas.segment.technicalname.tooltip",defaultMessage:"Use the Technical Name for custom integration"},segmentPersistedLabel:{id:"query.saveas.segment.persisted.title",defaultMessage:"Persisted"},segmentPersistedTooltip:{id:"query.saveas.segment.persisted.helper",defaultMessage:"A persisted segment can be used in a campaign whereas a non persisted serves as analytics"},segmentPausedLabel:{id:"query.saveas.segment.paused.title",defaultMessage:"Paused"},segmentPausedTooltip:{id:"query.saveas.segment.paused.helper",defaultMessage:"When a segment is paused, all related processings (statistics, user insertions and deletions) are stopped."}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudienceBuilderPage=void 0;var a,r=n(2451),o=(a=r)&&a.__esModule?a:{default:a};t.AudienceBuilderPage=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=E(n(54)),s=n(8),l=E(n(139)),c=n(6),u=n(11),d=n(2452),f=E(d),p=E(n(1075)),m=n(15),g=n(12),y=E(n(23)),h=n(227),v=n(13),b=E(n(2453)),_=n(228),S=n(65);function E(e){return e&&e.__esModule?e:{default:e}}var O=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getAudienceBuilders=function(){var e=n.props.workspace;n.setState({selectedAudienceBuilder:void 0,isLoading:!0});var t=e.datamarts.map((function(e){return n._audienceBuilderService.getAudienceBuilders(e.id).then((function(e){return e.data}))}));return Promise.all(t).then((function(e){n.setState({audienceBuildersByDatamartId:e.filter((function(e){return e.length>0})),isLoading:!1})})).catch((function(e){n.setState({isLoading:!1}),n.props.notifyError(e)}))},n.selectAudienceBuilder=function(e){var t=n.props.match.params.organisationId;n.props.history.push("/v2/o/"+t+"/audience/segment-builder-v2?audienceBuilderId="+e)},n.getAudienceBuilder=function(e){var t=n.state.audienceBuildersByDatamartId;if(e){var a=i.default.flattenDeep(t).find((function(t){return t.id===e}));if(a&&a.demographics_features_ids.length>=1){var r=a.datamart_id,o=a.demographics_features_ids.map((function(e){return n._audienceFeatureService.getAudienceFeature(r,e)}));Promise.all(o).then((function(e){var t=e.map((function(e){return e.data}));n.setState({selectedAudienceBuilder:a,formData:{where:{type:"GROUP",boolean_operator:"AND",expressions:[{type:"GROUP",boolean_operator:"AND",expressions:t.map((function(e){var t={};return e.variables.forEach((function(e){var n=e.parameter_name;t[n]=""})),{type:"PARAMETRIC_PREDICATE",parametric_predicate_id:e.id,parameters:t}}))}]}}})}))}else n.setState({selectedAudienceBuilder:a,formData:h.INITIAL_AUDIENCE_BUILDER_FORM_DATA})}else n.setState({selectedAudienceBuilder:void 0})},n.audienceBuilderActionbar=function(e,t){var a=n.props,r=a.match,i=a.history,s=n.state.selectedAudienceBuilder;return o.createElement(b.default,{save:function(a){var o=a.name,l=a.technical_name,c=a.persisted;return n._queryService.createQuery(t,{query_language:"JSON_OTQL",query_text:JSON.stringify((0,h.formatQuery)(e))}).then((function(e){var i={datamart_id:t,type:"USER_QUERY",name:o,technical_name:l,persisted:c,default_ttl:(0,_.calculateDefaultTtl)(a),query_id:e.data.id,segment_editor:"AUDIENCE_BUILDER",audience_builder_id:null==s?void 0:s.id};return n._audienceSegmentService.saveSegment(r.params.organisationId,i)})).then((function(e){i.push("/v2/o/"+r.params.organisationId+"/audience/segments/"+e.data.id)}))},audienceBuilder:s})},n.state={isLoading:!0,formData:h.INITIAL_AUDIENCE_BUILDER_FORM_DATA},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.location.search;this.getAudienceBuilders().then((function(){var n=l.default.parse(t).audienceBuilderId;n&&e.getAudienceBuilder(n)}))}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,a=n.match.params.organisationId,r=n.location.search,o=e.match.params.organisationId,i=e.location.search,s=this.state,c=s.audienceBuildersByDatamartId,u=s.selectedAudienceBuilder,d=s.isLoading;if(a!==o)this.getAudienceBuilders();else if(void 0!==u||1!==(null==c?void 0:c.length)||1!==c[0].length||d){if(r!==i){var f=l.default.parse(r).audienceBuilderId;this.getAudienceBuilder(f)}}else this.setState({selectedAudienceBuilder:c[0][0]})}},{key:"render",value:function(){var e=this.props,t=e.intl,n=e.workspace.datamarts,a=this.state,r=a.selectedAudienceBuilder,i=a.audienceBuildersByDatamartId,s=a.isLoading,l=a.formData;return s?o.createElement(u.Loading,{isFullScreen:!0}):r?o.createElement(p.default,{initialValues:l,audienceBuilder:r,renderActionBar:this.audienceBuilderActionbar}):o.createElement(f.default,{audienceBuildersByDatamartId:i,datamarts:n,onSelect:this.selectAudienceBuilder,actionbarProps:{paths:[{name:t.formatMessage(d.messages.subTitle)}]},isMainlayout:!0})}}]),t}(o.Component);O([(0,m.lazyInject)(g.TYPES.IAudienceBuilderService)],w.prototype,"_audienceBuilderService",void 0),O([(0,m.lazyInject)(g.TYPES.IAudienceFeatureService)],w.prototype,"_audienceFeatureService",void 0),O([(0,m.lazyInject)(g.TYPES.IAudienceSegmentService)],w.prototype,"_audienceSegmentService",void 0),O([(0,m.lazyInject)(g.TYPES.IQueryService)],w.prototype,"_queryService",void 0),t.default=(0,s.compose)(v.withRouter,c.injectIntl,y.default,S.injectWorkspace)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(10),s=n(6),l=n(11),c=d(n(60)),u=d(n(47));function d(e){return e&&e.__esModule?e:{default:e}}var f=t.messages=(0,s.defineMessages)({subTitle:{id:"audienceBuilderSelector.subtitle",defaultMessage:"Audience Builders"},noAudienceBuilder:{id:"datamart.audienceBuilder.alert.noAudienceBuilder",defaultMessage:"No Audience Builder found for selected datamart. Please create one to proceed or contact the support team."}}),p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.onSelect,n=e.actionbarProps,a=e.isMainlayout,o=e.audienceBuildersByDatamartId,s=e.intl,d=e.datamarts;return r.createElement(i.Layout,null,a?r.createElement(l.Actionbar,n):r.createElement(c.default,n),r.createElement(i.Layout.Content,{className:"mcs-content-container mcs-form-container text-center"},o&&0!==o.length?r.createElement(i.Row,{className:"mcs-selector_container"},r.createElement(i.Row,{className:"menu"},o.map((function(e,n){var a;return r.createElement("div",{key:n},r.createElement("div",{className:"mcs-datamartName_title"},null===(a=d.find((function(t){return t.id===e[0].datamart_id})))||void 0===a?void 0:a.name),e.map((function(e){return r.createElement(l.MenuList,{key:(0,u.default)(),title:e.name,select:function(){return t(e.id)}})})))})))):r.createElement(i.Alert,{message:r.createElement("div",null,r.createElement(l.McsIcon,{type:"warning"}),s.formatMessage(f.noAudienceBuilder)),type:"warning"})))}}]),t}(r.Component);t.default=(0,o.compose)(s.injectIntl)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(8),s=n(227),l=n(10),c=n(1131),u=n(11),d=n(13);var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.closeSegmentModal=function(){return n.setState({segmentModalVisible:!1,segmentModalLoading:!1})},n.handleSaveAsUserQuery=function(e){n.setState({segmentModalLoading:!0}),n.props.save(e).catch((function(e){n.setState({segmentModalVisible:!1,segmentModalLoading:!1})}))},n.state={segmentModalLoading:!1,segmentModalVisible:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.intl,a=t.audienceBuilder,i=t.match.params,d=i.organisationId,f=i.segmentId,p=r.createElement(l.Menu,{onClick:function(t){"USER_QUERY"===t.key&&e.setState({segmentModalVisible:!0})}},r.createElement(l.Menu.Item,{key:"USER_QUERY"},r.createElement(o.FormattedMessage,{id:"audience.audienceBuilder.actionbar.saveAsButton.userQuerySegment",defaultMessage:"User Query Segment"}))),m=[{name:n.formatMessage(s.messages.title),path:"/v2/o/"+d+"/audience/segment-builder-v2?audienceBuilderId="}];return a&&(m=m.concat({name:a.name}),f||(m=m.concat({name:n.formatMessage(s.messages.newAudienceSegment)}))),r.createElement(u.Actionbar,{paths:m},r.createElement(l.Dropdown,{overlay:p,trigger:["click"]},r.createElement(l.Button,{className:"mcs-primary",type:"primary"},r.createElement(o.FormattedMessage,{id:"audience.audienceBuilder.actionBar.saveAsButton",defaultMessage:"Save As"}))),r.createElement(c.SaveAsUserQuerySegmentModal,{onOk:this.handleSaveAsUserQuery,onCancel:this.closeSegmentModal,visible:this.state.segmentModalVisible,confirmLoading:this.state.segmentModalLoading}))}}]),t}(r.Component);t.default=(0,i.compose)(o.injectIntl,d.withRouter)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(10),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(6),l=n(13),c=n(8),u=n(65),d=S(n(23)),f=n(12),p=n(15),m=n(1132),g=n(51),y=S(n(823)),h=S(n(631)),v=n(73),b=n(632),_=n(11);function S(e){return e&&e.__esModule?e:{default:e}}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=o.Layout.Content,w=(0,s.defineMessages)({homeTitle:{id:"audience.home.homeTitle",defaultMessage:"Home"},channelEngagementsAnalyticsTitle:{id:"audience.home.channelEngagementsAnalyticsTitle",defaultMessage:"Channel Engagement"},ecommerceEngagementTitle:{id:"audience.home.ecommerceEngagementTitle",defaultMessage:"E-commerce Engagement"},comingSoon:{id:"audience.home.dashboard",defaultMessage:"Coming Soon..."},acquisitionEngagementTitle:{id:"audience.home.acquisitionEngagementTitle",defaultMessage:"Acquisition Engagement"}}),M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getDatamartAnaylicsDashboardConfig=function(e,t,n){return[{pageTitle:n.formatMessage(w.homeTitle),datamartId:t,organisationId:e,config:b.averageSessionDurationConfig,showDateRangePicker:!0,showFilter:!0},{title:n.formatMessage(w.ecommerceEngagementTitle),datamartId:t,organisationId:e,config:b.ecommerceEngagementConfig},{title:n.formatMessage(w.channelEngagementsAnalyticsTitle),datamartId:t,organisationId:e,config:b.channelEngagementConfig},{title:n.formatMessage(w.acquisitionEngagementTitle),datamartId:t,organisationId:e,config:b.acquisitionEngagementConfig}]},n.loadData=function(e,t){n.setState({isLoading:!0}),n._dashboardService.getDashboards(e,t,"HOME",{}).then((function(e){return e.data})).then((function(e){n.setState({isLoading:!1,dashboards:e})})).catch((function(e){n.props.notifyError(e),n.setState({isLoading:!1})}))},n.state={dashboards:[],isLoading:!0,datamartAnalyticsDashboardConfig:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.selectedDatamartId,n=e.intl,a=e.match.params.organisationId;this.setState({datamartAnalyticsDashboardConfig:this.getDatamartAnaylicsDashboardConfig(a,t,n)}),this.loadData(a,t)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.selectedDatamartId,a=t.intl,r=t.match.params.organisationId;n!==e.selectedDatamartId&&(this.loadData(r,n),this.setState({datamartAnalyticsDashboardConfig:this.getDatamartAnaylicsDashboardConfig(r,n,a)}))}},{key:"render",value:function(){var e=this.props,t=e.hasFeature,n=e.intl,a=this.state,r=a.isLoading,o=a.dashboards,s=a.datamartAnalyticsDashboardConfig;if(r)return i.createElement(g.Loading,{isFullScreen:!1});var l=t("audience-dashboards-datamart_users_analytics");return r||0!==o.length||l?i.createElement("div",{className:"ant-layout"},i.createElement("div",{className:"ant-layout"},i.createElement(O,{className:"mcs-content-container"},o.map((function(e){return i.createElement(y.default,{key:e.id,layout:e.components,title:e.name,datamartId:e.datamart_id})})),l&&0===o.length&&s.map((function(e,t){return i.createElement(h.default,{key:t.toString(),title:e.title,subTitle:e.subTitle,datamartId:e.datamartId,organisationId:e.organisationId,config:e.config,showFilter:e.showFilter,showDateRangePicker:e.showDateRangePicker,pageTitle:e.pageTitle})}))))):i.createElement(_.Error,{message:n.formatMessage(w.comingSoon)})}}]),t}(i.Component);E([(0,p.lazyInject)(f.TYPES.IDashboardService)],M.prototype,"_dashboardService",void 0),t.default=(0,c.compose)(m.withDatamartSelector,l.withRouter,s.injectIntl,u.injectWorkspace,d.default,v.injectFeatures)(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudienceFeedsActionbar=t.AudienceFeedsTable=void 0;var a=o(n(2456)),r=o(n(1133));function o(e){return e&&e.__esModule?e:{default:e}}t.AudienceFeedsTable=a.default,t.AudienceFeedsActionbar=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(6),l=n(8),c=n(68),u=n(30),d=n(841),f=n(10),p=n(41),m=n(15),g=n(12),y=n(33),h=n(44),v=O(n(23)),b=O(n(2457)),_=O(n(796)),S=n(73),E=n(11);function O(e){return e&&e.__esModule?e:{default:e}}function w(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var M=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},P=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.buildApiSearchFilters=function(e){return Object.assign(Object.assign({},(0,h.getPaginatedApiParam)(e.currentPage,e.pageSize)),{status:e.status&&e.status.length>0?e.status:void 0,artifact_id:e.artifactId&&e.artifactId.length>0?e.artifactId:void 0})},n.fetchFeeds=function(e,t){return n.setState({list:Object.assign(Object.assign({},n.state.list),{isLoading:!0})}),(t.feedType&&"TAG_FEED"===t.feedType[0]?n._audienceTagFeedServiceFactory(""):n._audienceExternalFeedServiceFactory("")).getFeeds(Object.assign({organisation_id:e,order_by:"AUDIENCE_SEGMENT_NAME"},n.buildApiSearchFilters(t))).then((function(e){var t=[].concat(w(new Set(e.data.map((function(e){return e.scenario_id}))))),a=Promise.all(t.map((function(e){return e?n._scenarioService.getScenario(e).then((function(e){return e.data})).catch((function(){})):void 0}))),r=[].concat(w(new Set(e.data.filter((function(e){return"SEGMENT"===e.created_from})).map((function(e){return e.audience_segment_id}))))),o=Promise.all(r.map((function(e){return n._audienceSegmentService.getSegment(e).then((function(e){return e.data})).catch((function(){}))})));return Promise.all([a,o]).then((function(t){var a=t[0],r=t[1],o=e.data.map((function(e){return{feed:"TAG_FEED"===n.getFeedType()?Object.assign(Object.assign({},e),{type:"TAG_FEED"}):Object.assign(Object.assign({},e),{type:"EXTERNAL_FEED"}),audienceSegment:r.find((function(t){return!!t&&t.id===e.audience_segment_id})),scenarioResource:a.find((function(t){return!!t&&t.id===e.scenario_id}))}}));n.setState({list:{feeds:o,total:e.total?e.total:e.count,isLoading:!1}})}))})).catch((function(){n.setState({list:{feeds:[],total:0,isLoading:!1}})}))},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,u.updateSearch)(o,e,d.FEEDS_SEARCH_SETTINGS)};a.push(i)},n.activateFeed=function(e){var t="TAG_FEED"===e.feed.type?n._audienceTagFeedServiceFactory(e.audienceSegment?e.audienceSegment.id:""):n._audienceExternalFeedServiceFactory(e.audienceSegment?e.audienceSegment.id:""),a=n.props,r=a.notifyError,o=a.location.search,i=(0,u.parseSearch)(o,d.FEEDS_SEARCH_SETTINGS),s=Object.assign(Object.assign({},e.feed),{status:"ACTIVE"});return t.updateAudienceFeed(e.feed.id,s).then((function(){return n.fetchFeeds(e.feed.organisation_id,i)})).catch((function(e){r(e)}))},n.pauseFeed=function(e){var t="TAG_FEED"===e.feed.type?n._audienceTagFeedServiceFactory(e.audienceSegment?e.audienceSegment.id:""):n._audienceExternalFeedServiceFactory(e.audienceSegment?e.audienceSegment.id:""),a=n.props,r=a.notifyError,o=a.location.search,i=(0,u.parseSearch)(o,d.FEEDS_SEARCH_SETTINGS),s=Object.assign(Object.assign({},e.feed),{status:"PAUSED"});return t.updateAudienceFeed(e.feed.id,s).then((function(){return n.fetchFeeds(e.feed.organisation_id,i)})).catch((function(e){r(e)}))},n.editFeed=function(e){n.setState({modalFeed:e.feed,modalTab:"configuration"})},n.openFeedStats=function(e){n.setState({modalFeed:e.feed,modalTab:"stats"})},n.deleteFeed=function(e){var t="TAG_FEED"===e.feed.type?n._audienceTagFeedServiceFactory(e.audienceSegment?e.audienceSegment.id:""):n._audienceExternalFeedServiceFactory(e.audienceSegment?e.audienceSegment.id:""),a=n.props,r=a.notifyError,o=a.location.search,i=a.intl,s=n.state.list.feeds,l=(0,u.parseSearch)(o,d.FEEDS_SEARCH_SETTINGS);f.Modal.confirm({title:i.formatMessage(_.default.deleteModalTitle),content:i.formatMessage(_.default.deleteModalDescription),onOk:function(){return t.deleteAudienceFeed(e.feed.id).then((function(){if(1===s.length&&1!==l.currentPage){var t=Object.assign(Object.assign({},l),{currentPage:l.currentPage-1});n.fetchFeeds(e.feed.organisation_id,t)}else n.fetchFeeds(e.feed.organisation_id,l)})).catch((function(e){r(e)}))}})},n.renderActionColumnDefinition=function(e){var t=n.props.hasFeature,a=[];return"AUTOMATION"!==e.feed.created_from&&("PAUSED"===e.feed.status||"INITIAL"===e.feed.status?a.push({callback:n.activateFeed,intlMessage:_.default.activate}):a.push({callback:n.pauseFeed,intlMessage:_.default.pause}),a.push({intlMessage:_.default.edit,callback:n.editFeed})),t("audience-feeds_stats")&&a.push({intlMessage:_.default.stats,callback:n.openFeedStats}),"AUTOMATION"!==e.feed.created_from&&a.push({intlMessage:_.default.delete,callback:n.deleteFeed}),a},n.buildActionColumns=function(){return[{key:"action",actions:n.renderActionColumnDefinition}]},n.buildDataColumns=function(){var e=n.props,t=e.match.params.organisationId,a=e.intl;return[{intlMessage:_.default.source,key:"source",isHideable:!1,render:function(e,n){return"SEGMENT"===n.feed.created_from?o.createElement("span",null,n.audienceSegment?n.audienceSegment.name?o.createElement(y.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+t+"/audience/segments/"+n.audienceSegment.id},n.audienceSegment.name.length>40?o.createElement(f.Tooltip,{title:n.audienceSegment.name},n.audienceSegment.name.substring(0,40),"..."):n.audienceSegment.name):o.createElement(s.FormattedMessage,_.default.segmentNameNotFound):o.createElement(s.FormattedMessage,_.default.segmentDeleted)):o.createElement("span",null,n.scenarioResource?o.createElement(y.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+t+"/automations/"+n.scenarioResource.id},n.scenarioResource.name.length>40?o.createElement(f.Tooltip,{title:n.scenarioResource.name},n.scenarioResource.name.substring(0,40),"..."):n.scenarioResource.name):o.createElement(s.FormattedMessage,_.default.scenarioNameNotFound))}},{intlMessage:_.default.feedName,key:"feedName",isHideable:!1,render:function(e,t){return o.createElement("span",null,t.feed.name?t.feed.name.length>40?o.createElement(f.Tooltip,{title:t.feed.name},t.feed.name.substring(0,40),"..."):t.feed.name:"-")}},{intlMessage:_.default.artifactId,key:"artifactId",isHideable:!1,render:function(e,t){return o.createElement("span",null,t.feed.artifact_id)}},{intlMessage:_.default.createdFrom,key:"createdFrom",isHideable:!1,render:function(e,t){return o.createElement("span",null,t.feed.created_from)}},{intlMessage:_.default.status,key:"status",isHideable:!1,render:function(e,t){return o.createElement(f.Tooltip,{placement:"top",title:a.formatMessage(_.default[t.feed.status])},o.createElement(E.McsIcon,{type:"status",className:"mcs-feeds-status-"+t.feed.status.toLowerCase()}))}}]},n.onClose=function(){n.setState({modalFeed:void 0})},n.onFeedChange=function(){var e=n.props,t=e.location.search,a=e.match.params.organisationId,r=(0,u.parseSearch)(t,d.FEEDS_SEARCH_SETTINGS);n.fetchFeeds(a,r)},n._audienceExternalFeedServiceFactory=n._audienceSegmentFeedServiceFactory("EXTERNAL_FEED"),n._audienceTagFeedServiceFactory=n._audienceSegmentFeedServiceFactory("TAG_FEED"),n.state={list:{feeds:[],total:0,isLoading:!0},externalPlugins:[],tagPlugins:[],modalTab:"configuration"},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.history,n=e.location,a=n.search,r=n.pathname,o=e.match.params.organisationId;if((0,u.isSearchValid)(a,d.FEEDS_SEARCH_SETTINGS)){var i=(0,u.parseSearch)(a,d.FEEDS_SEARCH_SETTINGS);this.fetchFeeds(o,i)}else t.replace({pathname:r,search:(0,u.buildDefaultSearch)(a,d.FEEDS_SEARCH_SETTINGS),state:{reloadDataSource:!0}});this.fetchPlugins()}},{key:"shouldComponentUpdate",value:function(e,t){var n=this.props,a=n.location.search,r=n.match.params.organisationId,o=e.location.search,i=e.match.params.organisationId,s=this.state,l=s.list,c=s.externalPlugins,d=s.modalFeed,f=t.list,p=t.externalPlugins,m=t.modalFeed;return!(0,u.compareSearches)(a,o)||r!==i||l.isLoading&&!f.isLoading||c.length!==p.length||m!==d}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,a=n.location,r=a.pathname,o=a.search,i=n.match.params.organisationId,s=n.history;if((0,u.isSearchValid)(o,d.FEEDS_SEARCH_SETTINGS)){if(!t.list.isLoading||this.state.list.isLoading){var l=(0,u.parseSearch)(o,d.FEEDS_SEARCH_SETTINGS);this.fetchFeeds(i,l)}}else s.replace({pathname:r,search:(0,u.buildDefaultSearch)(o,d.FEEDS_SEARCH_SETTINGS)})}},{key:"getFeedType",value:function(){var e=this.props.location.search,t=(0,u.parseSearch)(e,d.FEEDS_SEARCH_SETTINGS);return t.feedType&&t.feedType.length>0?t.feedType[0]:"EXTERNAL_FEED"}},{key:"fetchPlugins",value:function(){var e=this;this._pluginService.getPlugins({plugin_type:"AUDIENCE_SEGMENT_EXTERNAL_FEED"}).then((function(t){e.setState({externalPlugins:t.data})})).catch((function(){e.setState({externalPlugins:[]})})),this._pluginService.getPlugins({plugin_type:"AUDIENCE_SEGMENT_TAG_FEED"}).then((function(t){e.setState({tagPlugins:t.data})})).catch((function(){e.setState({tagPlugins:[]})}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.location.search,a=t.intl,r=this.state,i=r.list,l=i.feeds,f=i.isLoading,m=r.externalPlugins,g=r.tagPlugins,y=r.modalFeed,h=r.modalTab,v=(0,u.parseSearch)(n,d.FEEDS_SEARCH_SETTINGS),S={current:v.currentPage,pageSize:v.pageSize,total:this.state.list.total,onChange:function(t,n){return e.updateLocationSearch({currentPage:t,pageSize:n})},onShowSizeChange:function(t,n){return e.updateLocationSearch({currentPage:1,pageSize:n})}},E=this.getFeedType(),O=[];"EXTERNAL_FEED"===E?O=["INITIAL","ACTIVE","PAUSED","PUBLISHED"]:"TAG_FEED"===E&&(O=["ACTIVE","PAUSED"]);var w=O.map((function(e){return{key:e,value:e}})),M=[{displayElement:o.createElement("div",null,a.formatMessage(_.default[E])," ",o.createElement(p.DownOutlined,null)),selectedItems:[E],items:["EXTERNAL_FEED","TAG_FEED"],getKey:function(e){return e},display:function(e){return a.formatMessage(_.default[e])},handleItemClick:function(t){return e.updateLocationSearch({feedType:[t],artifactId:[],status:[],currentPage:1})}}],P="TAG_FEED"===E?g:m;if(P.length>0){var T=Array.from(new Set(P.map((function(e){return e.artifact_id})))).sort();M.push({displayElement:o.createElement("div",null,o.createElement(s.FormattedMessage,_.default.filterArtifactId)," ",o.createElement(p.DownOutlined,null)),selectedItems:v.artifactId,items:T,getKey:function(e){return e},display:function(e){return e},handleMenuClick:function(t){return e.updateLocationSearch({artifactId:t,currentPage:1})}})}return M.push({displayElement:o.createElement("div",null,o.createElement(s.FormattedMessage,_.default.filterStatus)," ",o.createElement(p.DownOutlined,null)),selectedItems:v.status.map((function(e){return{key:e,value:e}})),items:w,getKey:function(e){return e.key},display:function(e){return e.value},handleMenuClick:function(t){return e.updateLocationSearch({status:t.map((function(e){return e.value})),currentPage:1})}}),o.createElement("div",{className:"mcs-table-container"},y&&o.createElement(b.default,{feed:y,modalTab:h,onClose:this.onClose,onChange:this.onFeedChange}),o.createElement(c.TableViewFilters,{columns:this.buildDataColumns(),loading:f,pagination:S,filtersOptions:M,dataSource:l,actionsColumnsDefinition:this.buildActionColumns()}))}}]),t}(o.Component);M([(0,m.lazyInject)(g.TYPES.IAudienceSegmentFeedServiceFactory)],P.prototype,"_audienceSegmentFeedServiceFactory",void 0),M([(0,m.lazyInject)(g.TYPES.IAudienceSegmentService)],P.prototype,"_audienceSegmentService",void 0),M([(0,m.lazyInject)(g.TYPES.IScenarioService)],P.prototype,"_scenarioService",void 0),M([(0,m.lazyInject)(g.TYPES.IPluginService)],P.prototype,"_pluginService",void 0),t.default=(0,l.compose)(i.withRouter,s.injectIntl,v.default,S.injectFeatures)(P)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(8),l=g(n(630)),c=g(n(23)),u=n(6),d=n(24),f=n(15),p=n(12),m=n(591);function g(e){return e&&e.__esModule?e:{default:e}}var y=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},h=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},v=(0,u.defineMessages)({feedModalNameFieldLabel:{id:"audience.segment.feed.list.create.nameField.label",defaultMessage:"Name"},feedModalNameFieldTitle:{id:"audience.segment.feed.list.create.nameField.title",defaultMessage:"The name used to identify this feed."},feedModalNameFieldTitleWarning:{id:"audience.segment.feed.list.create.nameField.title.warning",defaultMessage:"Warning: This name is only used in the platform, it won't be visible on the external system."},feedModalNameFieldPlaceholder:{id:"audience.segment.feed.list.create.nameField.placeholder",defaultMessage:"Name"}}),b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getInitialValues=function(){var e=n.props,t=e.feed,a=e.notifyError,r=e.onClose;return n.feedService.getAudienceFeedProperties(t.id).then((function(e){return n.setState({initialValues:{plugin:t,properties:e.data.reduce((function(e,t){return Object.assign(Object.assign({},e),(n={},a=t.technical_name,r={value:t.value},a in n?Object.defineProperty(n,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[a]=r,n));var n,a,r}),{})}})})).catch((function(e){a(e),r()}))},n.savePluginInstance=function(e,t,a){var r=n.props,o=r.notifyError,i=r.feed,s=r.onClose,l=r.onChange;n.setState({isLoading:!0});e.type,e.version_value,e.version_id,e.status;var c=h(e,["type","version_value","version_id","status"]);return n.feedService.updatePluginInstance(e.id,a?Object.assign(Object.assign({},c),{name:a}):c).then((function(){return n.updatePropertiesValue(t,i.organisation_id,e.id)})).then((function(){l(),s()})).catch((function(e){o(e),s()}))},n.updatePropertiesValue=function(e,t,a){var r=n.feedService.updatePluginInstanceProperty,o=[];return e.forEach((function(e){o.push(r(t,a,e.technical_name,e))})),Promise.all(o)},n.state={pluginProperties:[],isLoading:!0},n._audienceExternalFeedServiceFactory=n._audienceSegmentFeedServiceFactory("EXTERNAL_FEED"),n._audienceTagFeedServiceFactory=n._audienceSegmentFeedServiceFactory("TAG_FEED"),n.feedService="EXTERNAL_FEED"===e.feed.type?n._audienceExternalFeedServiceFactory(e.feed.audience_segment_id):n._audienceTagFeedServiceFactory(e.feed.audience_segment_id),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({isLoading:!0},(function(){Promise.all([e.getPluginLayout(),e.getProperties(),e.getInitialValues()]).then((function(){return e.setState({isLoading:!1})}))}))}},{key:"getPluginLayout",value:function(){var e=this,t=this.props,n=t.feed,a=t.notifyError,r=t.onClose;return this._pluginService.getLocalizedPluginLayoutFromVersionId(n.version_id).then((function(t){e.setState({layout:t.layout})})).catch((function(e){a(e),r()}))}},{key:"getProperties",value:function(){var e=this,t=this.props,n=t.feed,a=t.notifyError,r=t.onClose;return this.feedService.getInstanceProperties(n.id).then((function(t){e.setState({pluginProperties:t.data})})).catch((function(e){a(e),r()}))}},{key:"render",value:function(){var e=this.props,t=e.feed,n=e.modalTab,a=e.onClose,r=e.intl.formatMessage,i=e.fieldValidators.isRequired,s=this.state,c=s.isLoading,u=s.layout,d=s.pluginProperties,f=s.initialValues,p=(0,m.getFeedStatsUnit)(t);return o.createElement(l.default,{onClose:a,organisationId:t.organisation_id,opened:!0,plugin:{id:t.id,organisation_id:t.organisation_id,type:t.type,group_id:t.group_id,artifact_id:t.artifact_id,current_version_id:t.version_id,plugin_layout:u},feedStatsUnit:p,save:this.savePluginInstance,pluginProperties:d,disableFields:"ACTIVE"===t.status||"PUBLISHED"===t.status,initialValues:f,pluginLayout:u,isLoading:c,pluginVersionId:t.version_id,editionMode:!0,selectedTab:n,nameField:{label:r(v.feedModalNameFieldLabel),title:o.createElement("div",null,r(v.feedModalNameFieldTitle),o.createElement("br",null),o.createElement("b",null,r(v.feedModalNameFieldTitleWarning))),placeholder:r(v.feedModalNameFieldPlaceholder),display:!0,disabled:"ACTIVE"===t.status||"PUBLISHED"===t.status,value:t.name,validator:[i]}})}}]),t}(o.Component);y([(0,f.lazyInject)(p.TYPES.IAudienceSegmentFeedServiceFactory)],b.prototype,"_audienceSegmentFeedServiceFactory",void 0),y([(0,f.lazyInject)(p.TYPES.IPluginService)],b.prototype,"_pluginService",void 0),t.default=(0,s.compose)(i.withRouter,c.default,u.injectIntl,d.withValidators)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeedsOverviewActionbar=t.AudienceFeedsOverviewCard=t.AudienceFeedsOverview=void 0;var a=i(n(2459)),r=i(n(1135)),o=i(n(1134));function i(e){return e&&e.__esModule?e:{default:e}}t.AudienceFeedsOverview=a.default,t.AudienceFeedsOverviewCard=r.default,t.FeedsOverviewActionbar=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(6),l=n(8),c=n(2460),u=y(n(1135)),d=y(n(23)),f=n(51),p=n(12),m=n(15),g=n(11);function y(e){return e&&e.__esModule?e:{default:e}}var h=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},v=(0,s.defineMessages)({noData:{id:"audience.feeds.overview.nodata",defaultMessage:'No feeds found.\nTo add one, please go to a segment page and click on “Add a Feed".'}}),b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={feedsAggregationMetrics:{aggregates:{},isLoading:!0}},n._audienceExternalFeedServiceFactory=n._audienceSegmentFeedServiceFactory("EXTERNAL_FEED"),n._audienceTagFeedServiceFactory=n._audienceSegmentFeedServiceFactory("TAG_FEED"),n.externalfeedService=n._audienceExternalFeedServiceFactory(""),n.tagfeedService=n._audienceTagFeedServiceFactory(""),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){this.fetchFeedsAggregationMetrics()}},{key:"componentDidUpdate",value:function(e){this.props.match.params.organisationId!==e.match.params.organisationId&&(this.setState({feedsAggregationMetrics:{aggregates:{},isLoading:!0}}),this.fetchFeedsAggregationMetrics())}},{key:"fetchFeedsAggregationMetrics",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.notifyError;this.setState({feedsAggregationMetrics:{aggregates:{},isLoading:!0}});var r={primary_dimension:"PLUGIN_VERSION_ID",secondary_dimension:"STATUS",metric:"FEED_COUNT",organisation_id:n,order_by:{sort_value:"PRIMARY_DIMENSION"},max_results:100},o=this.externalfeedService.getFeedsAggregationMetrics(r),i=this.tagfeedService.getFeedsAggregationMetrics(r);Promise.all([o,i]).then((function(t){var n={},a=t[0].data.rows.map((function(e){return{rowAggregation:e,feedType:"EXTERNAL_FEED"}})),r=t[1].data.rows.map((function(e){return{rowAggregation:e,feedType:"TAG_FEED"}}));a.concat(r).map((function(e){var t=e.rowAggregation.primary_dimension_value.value,a={};e.rowAggregation.cells.map((function(e){var t=e.secondary_dimension_value.value;t in c.StatusEnum&&(a[t]=e.metric_value)})),n[t]={aggregation:a,feedType:e.feedType}})),e.setState({feedsAggregationMetrics:{aggregates:n,isLoading:!1}})})).catch((function(t){a(t),e.setState({feedsAggregationMetrics:{aggregates:{},isLoading:!1}})}))}},{key:"render",value:function(){var e=this.state.feedsAggregationMetrics;return e.isLoading?o.createElement(f.Loading,{isFullScreen:!0,className:"full-height"}):Object.keys(e.aggregates).length>0?o.createElement("div",{className:"feed-overview"},Object.keys(e.aggregates).map((function(t){var n=e.aggregates[t];return o.createElement("div",{className:"feed-overview-card",key:"card-"+t},o.createElement(u.default,{pluginVersionId:t,aggregatesByStatus:n.aggregation,feedType:n.feedType}))}))):o.createElement(g.EmptyTableView,{iconType:"users",message:this.props.intl.formatMessage(v.noData)})}}]),t}(o.Component);h([(0,m.lazyInject)(p.TYPES.IAudienceSegmentFeedServiceFactory)],b.prototype,"_audienceSegmentFeedServiceFactory",void 0),t.default=(0,l.compose)(i.withRouter,s.injectIntl,d.default)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=t.StatusEnum=void 0;!function(e){e[e.INITIAL=0]="INITIAL",e[e.PAUSED=1]="PAUSED",e[e.ACTIVE=2]="ACTIVE",e[e.PUBLISHED=3]="PUBLISHED"}(a||(t.StatusEnum=a={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(8),s=n(10),l=n(11);var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.generateStatusColor=function(e){switch(e){case"ACTIVE":return"mcs-metrics-status-active";case"INITIAL":return"mcs-metrics-status-pending";case"PAUSED":return"mcs-metrics-status-paused";default:return"mcs-metrics-status-pending"}},n.showTooltip=function(){n.setState({isTooltipVisible:!0})},n.hideTooltip=function(){n.setState({isTooltipVisible:!1})},n.state={isTooltipVisible:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.color,a=e.iconType,o=e.metricValue,i=e.message,c=e.tooltipMessage,u=e.onClick,d=this.state.isTooltipVisible;return r.createElement(s.Tooltip,{placement:"top",title:t(c),visible:d},r.createElement("div",{onClick:u,className:"metric-info",onMouseEnter:this.showTooltip,onMouseLeave:this.hideTooltip},r.createElement(l.McsIcon,{style:{marginRight:0,flex:1},type:a,className:this.generateStatusColor(n)}),r.createElement("div",{className:"metric-label"},t(i)),r.createElement("div",{className:"metric-value"},o)))}}]),t}(r.Component);t.default=(0,i.compose)(o.injectIntl)(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(35),i=n(8),s=n(6),l=n(137),c=m(n(164)),u=m(n(1137)),d=m(n(842)),f=n(843),p=m(n(844));function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.buildFormSections=function(){var e=n.props.initialValues,t=[],a=[],o=(0,l.isExistingCreative)(e);return a.push({id:"general",title:c.default.creativeSectionGeneralTitle,component:r.createElement(f.GeneralFormSection,{small:!0})}),o&&t.push({id:"audit_status",title:c.default.creativeSectionAuditTitle,component:r.createElement(f.AuditFormSection,{creativeId:o.id})}),void 0===e.pluginLayout?a.push({id:"properties",title:c.default.creativeSectionPropertyTitle,component:r.createElement(f.PropertiesFormSection,{small:!0})}):e.pluginLayout.sections.forEach((function(e){a.push({id:e.title,title:e.title,component:r.createElement(f.PropertiesFormSection,{sectionTitle:e.title,small:!0})})})),o&&t.push({id:"preview",title:c.default.creativeSectionPreviewTitle,component:e.rendererPlugin&&e.rendererPlugin.archived?r.createElement(d.default,null):r.createElement(f.PreviewFormSection,null)}),o||t.push({id:"no-loader",title:c.default.creativeSectionPreviewTitle,component:r.createElement(u.default,null)}),{leftPanel:t,rightPanel:a}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.actionBarButtonText,n=e.breadCrumbPaths,a=e.pristine,o=e.close,i=this.buildFormSections();return r.createElement(p.default,{actionBarButtonText:t,close:o,breadCrumbPaths:n,leftFormSections:i.leftPanel,rightFormSections:i.rightPanel,pristine:a})}}]),t}(r.Component);t.default=(0,i.compose)((0,o.reduxForm)({form:l.DISPLAY_CREATIVE_FORM,enableReinitialize:!0}),s.injectIntl)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(1087),i=n(10);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=function(e){function t(){return s(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.creativeId;return r.createElement(i.Row,{align:"middle",justify:"space-between",className:"mcs-actionbar",style:{backgroundColor:"white"}},r.createElement(o.AuditComponentContainer,{creativeId:e}))}}]),t}(r.Component);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(35),i=n(25),s=n(6),l=n(8),c=n(11),u=n(24),d=m(n(164)),f=n(137),p=m(n(2465));function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.isCreativeFormatValid=function(){return function(e){var t=n.props.intl;if(e){var a=e.split("x")[0],r=e.split("x")[1];return a&&r&&/^\d+$/.test(a)&&/^\d+$/.test(r)?void 0:t.formatMessage(d.default.invalidFormat)}}},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.fieldValidators.isRequired,a=e.initialValue.creative,i=e.small,s=!1;(0,f.isDisplayAdResource)(a)&&(s="AUDIT_PASSED"===a.audit_status||"AUDIT_PENDING"===a.audit_status);var l=o.Field;return r.createElement("div",null,r.createElement(u.FormSection,{title:d.default.creativeSectionGeneralTitle,subtitle:d.default.creativeSectionGeneralSubTitle}),r.createElement(u.FormInputField,{name:"creative.name",component:u.FormInput,validate:[n],formItemProps:{label:t(d.default.creativeCreationGeneralNameFieldTitle),required:!0},inputProps:{placeholder:t(d.default.creativeCreationGeneralNameFieldPlaceHolder),disabled:s},helpToolTipProps:{title:t(d.default.creativeCreationGeneralNameFieldHelper)},small:i}),r.createElement(l,{name:"creative.format",component:p.default,validate:[this.isCreativeFormatValid()],disabled:s,small:i}),r.createElement(u.FormInputField,{name:"creative.destination_domain",component:u.FormInput,validate:[n],formItemProps:{label:t(d.default.creativeCreationGeneralDomainFieldTitle),required:i},inputProps:{placeholder:t(d.default.creativeCreationGeneralDomainFieldPlaceHolder),disabled:s},helpToolTipProps:{title:t(d.default.creativeCreationGeneralDomainFieldHelper)},small:i}),r.createElement("div",null,r.createElement(c.Button,{className:"optional-section-title",onClick:this.toggleAdvancedSection},r.createElement(c.McsIcon,{type:"settings"}),r.createElement("span",{className:"step-title"},t(d.default.advanced)),r.createElement(c.McsIcon,{type:"chevron"})),r.createElement("div",{className:this.state.displayAdvancedSection?"optional-section-content":"hide-section"},r.createElement(u.FormAlertInputField,{name:"creative.technical_name",component:u.FormAlertInput,formItemProps:{label:t(d.default.creativeCreationAdvancedTechnicalFieldTitle)},inputProps:{placeholder:t(d.default.creativeCreationAdvancedTechnicalFieldPlaceholder),disabled:s},helpToolTipProps:{title:t(d.default.creativeCreationAdvancedTechnicalFieldTooltip)},iconType:"warning",type:"warning",message:t(d.default.warningOnTokenEdition),small:i}))))}}]),t}(r.Component);t.default=(0,l.compose)(s.injectIntl,u.withValidators,(0,i.connect)((function(e,t){return{initialValue:(0,o.getFormInitialValues)(f.DISPLAY_CREATIVE_FORM)(e)}})))(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(10),l=n(6),c=n(13),u=g(n(84)),d=n(11),f=g(n(164)),p=n(15),m=n(12);function g(e){return e&&e.__esModule?e:{default:e}}var y=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},h=s.Select.Option,v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={availableFormats:[],standardFormat:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.input;this._creativeService.getCreativeFormats(n,{type:"DISPLAY_AD"}).then((function(t){var n=t.data.sort((function(e,t){return e.width-t.width})).map((function(e){return e.width+"x"+e.height}));e.setState({availableFormats:n}),a.value||a.onChange(n[0])}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.intl.formatMessage,a=t.input,r=t.meta,i=t.disabled,l=t.small,c=this.state,p=c.standardFormat,m=c.availableFormats,g="success";r.invalid&&(g="error"),r.warning&&(g="warning");var y=n(f.default[p?"creativeCreationGeneralFormatFieldButtonCustom":"creativeCreationGeneralFormatFieldButtonStandard"]),v=a.value?a.value.split("x"):"",b=v[0]?v[0]:"",_=v[1]?v[1]:"",S=function(e){return function(t){var n=t.target.value;(!n||/^\d+$/i.test(n)&&n.length<15)&&a.onChange("width"===e?n+"x"+_:b+"x"+n)}};return o.createElement(u.default,{helpToolTipProps:{title:n(f.default.creativeCreationGeneralFormatFieldHelper)},label:n(f.default.creativeCreationGeneralFormatFieldTitle),required:!0,validateStatus:g,small:l},o.createElement("div",{className:"creative-format"},o.createElement("div",{className:"field"},p?o.createElement(s.Select,{onBlur:function(){return function(){return a.onBlur(a.value)}},onChange:a.onChange,onFocus:a.onFocus,value:a.value,disabled:i},m.map((function(e){return o.createElement(h,{key:e,value:e},e)}))):o.createElement("div",{className:"custom"},o.createElement("div",{className:"input"},o.createElement(s.Input,{value:b,onChange:S("width"),disabled:i})),o.createElement("div",{className:"separator"},"x"),o.createElement("div",{className:"input"},o.createElement(s.Input,{value:_,onChange:S("height"),disabled:i})))),o.createElement("div",{className:"button"},o.createElement(d.Button,{className:"clickable-on-hover",onClick:function(){e.setState({standardFormat:!p})}},y))))}}]),t}(o.Component);y([(0,p.lazyInject)(m.TYPES.ICreativeService)],v.prototype,"_creativeService",void 0),t.default=(0,i.compose)(l.injectIntl,c.withRouter)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(137),i=n(25),s=n(35),l=n(8),c=n(10);var u=n(840),d="//ads.mediarithmics.com/ads/render",f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderIframeCreative=function(e){var t="iframe",a=n.props.initialValue.properties.tag_type;if(a)switch(a.property_type){case"URL":t=a.value.url;break;case"ASSET":break;default:t=a.value.value}var r=d+"?ctx=PREVIEW&rid="+e.id+"&caid=preview";return"script"===t&&(r="data:text/html;charset=utf-8,"+encodeURI('<html><body style="margin-left: 0%; margin-right: 0%; margin-top: 0%; margin-bottom: 0%"><script type="text/javascript" src="https:'+d+"?ctx=PREVIEW&rid="+e.id+'&caid=preview"><\/script></body></html>')),r},n.formatDimension=function(e){return{width:parseInt(e.split("x")[0],10),height:parseInt(e.split("x")[1],10)}},n.state={width:void 0,height:void 0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props.initialValue.creative;if(!(0,o.isDisplayAdResource)(t))return null;var n=function(){var n=e.props,a=n.containerHeight,r=n.containerWidth;if(r&&a){var o=(r-80)/e.formatDimension(t.format).width,i=(a-80)/e.formatDimension(t.format).height,s=Math.min(i,o);return s>=1?1:s}}();return r.createElement("div",{style:{padding:40,flexGrow:1,display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"}},r.createElement("div",{style:{opacity:this.state.loaded?0:1}},r.createElement(c.Spin,null)),n&&r.createElement("iframe",{className:"renderer",src:this.renderIframeCreative(t),frameBorder:"0",scrolling:"no",width:this.formatDimension(t.format).width,height:this.formatDimension(t.format).height,style:{position:"absolute",transform:"scale("+n+")",opacity:this.state.loaded?1:0},onLoad:function(){return e.setState({loaded:!0})}}))}}]),t}(r.Component);t.default=(0,l.compose)((0,i.connect)((function(e){return{initialValue:(0,s.getFormInitialValues)(o.DISPLAY_CREATIVE_FORM)(e)}})),u({containerStyle:{flexGrow:1,display:"flex",justifyContent:"space-between",flexDirection:"column"}}))(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(10),c=n(25),u=n(35),d=n(6),f=b(n(164)),p=b(n(309)),m=n(24),g=n(628),y=n(137),h=b(n(421)),v=n(41);function b(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var E=function(e){function t(){_(this,t);var e=S(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.noUploadModal=function(t){return function(){var n=e.props.intl.formatMessage;l.Modal.warning({title:n(p.default.noActionTitle),content:"AUDIT_PASSED"===t.audit_status?n(p.default.noUploadMessage):n(p.default.noUpdateMessage),icon:o.createElement(v.ExclamationCircleOutlined,null),okText:n(p.default.confirm)})}},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.initialValue,r=n.creative,i=n.rendererPlugin.id,s=n.properties,l=n.pluginLayout,c=t.match.params.organisationId,u=t.small,d=!1,p={small:u};if((0,y.isDisplayAdResource)(r)&&(d="AUDIT_PASSED"===r.audit_status||"AUDIT_PENDING"===r.audit_status,p.noUploadModal=this.noUploadModal(r),p.small=u),void 0===l)return o.createElement("div",null,o.createElement(m.FormSection,{title:f.default.creativeSectionPropertyTitle,subtitle:f.default.creativeSectionPropertySubTitle}),Object.keys(s).map((function(e){var t=s[e];return o.createElement(g.PluginFieldGenerator,a({key:t.technical_name,definition:t,disabled:d,pluginVersionId:i,organisationId:c},p))})));var v=[];for(var b in s)s.hasOwnProperty(b)&&v.push(s[b]);if(void 0===this.props.sectionTitle)return null;var _=l.sections.filter((function(t){return t.title===e.props.sectionTitle}));if(0!==_.length){var S=_[0];return o.createElement(h.default,a({key:S.title,pluginLayoutSection:S,organisationId:c,pluginProperties:v,pluginVersionId:i},p))}return null}}]),t}(o.Component);t.default=(0,i.compose)(s.withRouter,d.injectIntl,(0,c.connect)((function(e,t){return{initialValue:(0,u.getFormInitialValues)(y.DISPLAY_CREATIVE_FORM)(e)}})))(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(8),l=n(24),c=n(164),u=(a=c)&&a.__esModule?a:{default:a};var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={displayAdvancedSection:!1,displayWarning:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.fieldValidators.isRequired,a=e.small;return o.createElement("div",null,o.createElement(l.FormSection,{title:u.default.creativeSectionGeneralTitle,subtitle:u.default.creativeSectionGeneralMultipleSubTitle}),o.createElement(l.FormInputField,{name:"creative.destination_domain",component:l.FormInput,validate:[n],formItemProps:{label:t(u.default.creativeCreationGeneralDomainFieldTitle),required:a},inputProps:{placeholder:t(u.default.creativeCreationGeneralDomainFieldPlaceHolder)},helpToolTipProps:{title:t(u.default.creativeCreationGeneralDomainFieldHelper)},small:a}))}}]),t}(o.Component);t.default=(0,s.compose)(i.injectIntl,l.withValidators)(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=n(13),c=n(10),u=n(6),d=v(n(1138)),f=n(633),p=v(n(164)),m=v(n(23)),g=n(15),y=n(12),h=n(11);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.redirect=function(e){var t=n.props,a=t.history,r=t.location.state,o=t.match.params.organisationId,i=r&&r.from?r.from:"/v2/o/"+o+"/creatives/display";e&&(i="/v2/o/"+o+"/creatives/display/edit/"+e),a.push(i)},n.onSave=function(e){var t=n.props,a=t.match.params,r=a.organisationId,o=a.creativeId,i=t.intl,s=c.message.loading(i.formatMessage(p.default.savingInProgress),0);n.setState({loading:!0}),(e.repeatFields&&e.repeatFields.length?n._displayCreativeFormService.handleSaveMutipleCreatives(r,e):n._displayCreativeFormService.saveDisplayCreative(r,e)).then((function(e){s(),o?n.setState({loading:!1}):"string"==typeof e?n.redirect(e):n.redirect(),c.message.success(i.formatMessage(p.default.successfulSaving),3)})).catch((function(e){s(),n.props.notifyError(e),n.setState({loading:!1})}))},n.onSubmitFail=function(){var e=n.props.intl;c.message.error(e.formatMessage(p.default.errorFormMessage))},n.state={loading:!1,creativeName:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.creativeId;t&&this._creativeService.getCreative(t).then((function(e){return e.data})).then((function(t){e.setState({creativeName:t.name?t.name:"creative "+t.id})})).catch((function(t){e.setState({loading:!1}),e.props.notifyError(t)}))}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.match.params.creativeId;n!==e.match.params.creativeId&&(this.setState({loading:!0}),this._creativeService.getCreative(n).then((function(e){return e.data})).then((function(e){t.setState({loading:!1,creativeName:e.name?e.name:"creative "+e.id})})).catch((function(e){t.setState({loading:!1}),t.props.notifyError(e)})))}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params,r=n.creativeId,o=n.organisationId,s=t.location,l=t.intl.formatMessage,c=this.state.creativeName,u=p.default.saveCreative,m=p.default.creativeCreationSaveButton,g=s&&s.state&&s.state.from,y=g&&g.includes("native")?{name:l(p.default.nativeListBreadCrumb),path:"/v2/o/"+o+"/creatives/native"}:{name:l(p.default.displayListBreadCrumb),path:"/v2/o/"+o+"/creatives/display"},v=r?l(p.default.creativeEditionBreadCrumb,{name:c}):g&&g.includes("native")?l(p.default.nativeCreationBreadCrumb):l(p.default.creativeCreationBreadCrumb),b=[Object.assign({},y),{name:v}],_={close:function(){return e.redirect()},onSubmit:this.onSave,actionBarButtonText:r?m:u,breadCrumbPaths:b,onSubmitFail:this.onSubmitFail};return this.state.loading?i.createElement(h.Loading,{isFullScreen:!0}):r?i.createElement(d.default,a({},_,{creativeId:r})):i.createElement(f.DisplayCreativeCreator,_)}}]),t}(i.Component);b([(0,g.lazyInject)(y.TYPES.ICreativeService)],_.prototype,"_creativeService",void 0),b([(0,g.lazyInject)(y.TYPES.IDisplayCreativeFormService)],_.prototype,"_displayCreativeFormService",void 0),t.default=(0,s.compose)(u.injectIntl,l.withRouter,m.default)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=h(n(1139)),c=h(n(59)),u=n(633),d=n(137),f=h(n(23)),p=h(n(2471)),m=n(12),g=n(15),y=n(11);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.filterProperties=function(e,t){switch(e){case d.IMAGE_AD_RENDERER:t.image;return b(t,["image"]);default:return t}},n.loadFormData=function(e){n.setState({isLoading:!0}),n._displayCreativeFormService.initializeFormData(e,"BANNER").then((function(e){n.setState({creativeFormData:Object.assign(Object.assign({},e),{properties:n.filterProperties(e.rendererPlugin.plugin_id,e.properties)}),isLoading:!1})})).catch((function(e){c.default.debug(e),n.props.notifyError(e),n.setState((function(){return{isLoading:!1}}))}))},n.resetFormData=function(){n.setState({creativeFormData:{}})},n.state={isLoading:!1,creativeFormData:{}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.state,t=e.creativeFormData;if(e.isLoading)return i.createElement(y.Loading,{isFullScreen:!0});var n=this.props.initialValues||t;return Object.keys(n).length?n.rendererPlugin&&n.rendererPlugin.plugin_id===d.IMAGE_AD_RENDERER?i.createElement(p.default,a({},this.props,{initialValues:n,goToCreativeTypeSelection:this.resetFormData})):i.createElement(u.DisplayCreativeForm,a({},this.props,{initialValues:n,goToCreativeTypeSelection:this.resetFormData})):i.createElement(l.default,{onSelect:this.loadFormData,close:this.props.close})}}]),t}(i.Component);v([(0,g.lazyInject)(m.TYPES.IDisplayCreativeFormService)],_.prototype,"_displayCreativeFormService",void 0),t.default=(0,s.compose)(f.default)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(35),s=n(8),l=n(6),c=n(137),u=g(n(164)),d=n(843),f=g(n(844)),p=g(n(2472)),m=g(n(842));function g(e){return e&&e.__esModule?e:{default:e}}var y=i.FieldArray,h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.buildFormSections=function(){var e=n.props,t=e.initialValues,r={formChange:e.change,rerenderOnEveryChange:!0},i=[],s=[],l=(0,c.isExistingCreative)(t);return s.push({id:"general",title:u.default.creativeSectionGeneralTitle,component:o.createElement(d.GeneralMultipleSection,{small:!0})}),l&&i.push({id:"audit_status",title:u.default.creativeSectionAuditTitle,component:o.createElement(d.AuditFormSection,{creativeId:l.id})}),void 0===t.pluginLayout?s.push({id:"properties",title:u.default.creativeSectionPropertyTitle,component:o.createElement(d.PropertiesFormSection,{small:!0})}):t.pluginLayout.sections.forEach((function(e){s.push({id:e.title,title:e.title,component:o.createElement(d.PropertiesFormSection,{sectionTitle:e.title,small:!0})})})),l&&i.push({id:"preview",title:u.default.creativeSectionPreviewTitle,component:t.rendererPlugin&&t.rendererPlugin.archived?o.createElement(m.default,null):o.createElement(d.PreviewFormSection,null)}),l||i.push({id:"loader",title:u.default.creativeSectionPreviewTitle,component:o.createElement(y,a({name:"repeatFields",component:p.default,inputProps:{multiple:!0}},r))}),{leftPanel:i,rightPanel:s}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.actionBarButtonText,n=e.breadCrumbPaths,a=e.pristine,r=e.close,i=this.buildFormSections();return o.createElement(f.default,{actionBarButtonText:t,close:r,breadCrumbPaths:n,leftFormSections:i.leftPanel,rightFormSections:i.rightPanel,pristine:a})}}]),t}(o.Component);t.default=(0,s.compose)((0,i.reduxForm)({form:c.DISPLAY_CREATIVE_FORM,enableReinitialize:!0}),l.injectIntl)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(6),l=n(8),c=n(11);var u=(0,s.defineMessages)({uploadMessage:{id:"creative.create.loader.upload.message",defaultMessage:"is above 200kB! You can only upload image files with the following format .jpg,.jpeg,.png,.gif,.svg with a maximum size of 200kB"},uploadText:{id:"creative.create.loader.upload.text",defaultMessage:"click here to upload one or several images"},editName:{id:"creative.create.loader.upload.edit.name",defaultMessage:"Edit Name"},modalTitle:{id:"creative.create.loader.upload.modal.title",defaultMessage:"Edit Creative Name"}}),d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderImageEditor=function(e){var t=n.props.intl,a=URL.createObjectURL(e.file);return o.createElement("div",{className:"content"},o.createElement("div",{className:"image"},o.createElement("img",{src:""+a})),o.createElement("div",{className:"text"},e.name),o.createElement("div",{className:"overlay"},o.createElement("div",null,o.createElement("div",{className:"tets"},o.createElement(c.Button,{onClick:function(){n.removeItem(e.file.uid)}},o.createElement(c.McsIcon,{type:"close"}))),o.createElement("div",null,o.createElement(c.Button,{onClick:function(){n.setState({modalVisible:!0,selectedFile:e,inputValue:e.name})}},t.formatMessage(u.editName))))))},n.removeItem=function(e){var t=n.props,a=t.fields,r=t.formChange,o=[];a.getAll().forEach((function(t){t.file.uid!==e&&o.push(t)})),r(a.name,o)},n.handleOk=function(){var e=n.props,t=e.fields,a=e.formChange,r=[];t.getAll().forEach((function(e){n.state.selectedFile&&e.file.uid===n.state.selectedFile.file.uid?r.push({file:n.state.selectedFile.file,name:n.state.inputValue}):r.push(e)})),a(t.name,r),n.setState({modalVisible:!1,selectedFile:void 0,inputValue:""})},n.handleCancel=function(){n.setState({modalVisible:!1,selectedFile:void 0,inputValue:""})},n.handleInputChange=function(e){n.setState({inputValue:e.target.value})},n.state={modalVisible:!1,inputValue:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.fields,r=t.formChange,s=t.inputProps,l=t.disabled,c=t.intl,d={action:"/",beforeUpload:function(e){return!1},onChange:function(e){if(!l){var t=n.getAll();e.file.size<=204800?t.push({name:e.file.name,file:e.file}):i.message.error(e.file.name+" "+c.formatMessage(u.uploadMessage),2),r(n.name,t)}},showUploadList:!1,accept:"image/*",multiple:!(!s||!s.multiple)&&s.multiple},f=n.getAll();return o.createElement("div",{className:"mcs-custom-loader image-loader"},o.createElement("div",{className:"square-container"},f&&f.map((function(t){return o.createElement("div",{key:t.file.uid,className:"square"},e.renderImageEditor(t))})),o.createElement("div",{className:"square"},o.createElement("span",{className:"content"},o.createElement(i.Upload.Dragger,a({fileList:f.map((function(e){return e.file}))},s,d),o.createElement("div",null,c.formatMessage(u.uploadText))))),o.createElement(i.Modal,{title:c.formatMessage(u.modalTitle),visible:this.state.modalVisible,onOk:this.handleOk,onCancel:this.handleCancel},o.createElement(i.Input,{value:this.state.inputValue,onChange:this.handleInputChange}))))}}]),t}(o.Component);t.default=(0,l.compose)(s.injectIntl)(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(8),l=n(13),c=n(6),u=O(n(2474)),d=O(n(2475)),f=n(61),p=n(30),m=O(n(23)),g=n(1140),y=n(112),h=n(44),v=n(83),b=O(n(348)),_=n(15),S=n(12),E=n(41);function O(e){return e&&e.__esModule?e:{default:e}}var w=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=i.Layout.Content,P=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchDisplayAds=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n.setState({isLoadingDisplayAds:!0});var r=Object.assign(Object.assign({},(0,h.getPaginatedApiParam)(t.currentPage,t.pageSize)),{archived:t.archived,subtype:["BANNER","VIDEO"]});t.keywords&&(r=Object.assign(Object.assign({},r),{keywords:t.keywords})),n._creativeService.getDisplayAds(e,r).then((function(e){var t=e.data,r=(0,v.normalizeArrayOfObject)(t,"id");n.setState({dataSource:Object.keys(r).map((function(e){return Object.assign({},r[e])})),isLoadingDisplayAds:!1,hasDisplayAds:!a||0!==e.count,totalDisplayAds:e.total||0})}))},n.getAllCreativesIds=function(){var e=n.props,t=e.match.params.organisationId,a=e.notifyError,r={type:"DISPLAY_AD",archived:!1,max_results:n.state.totalDisplayAds};return n._creativeService.getDisplayAds(t,r).then((function(e){return e.data.map((function(e){return e.id}))})).catch((function(e){a(e)}))},n.makeAuditAction=function(e,t){n.setState({isUpdatingAuditStatus:!0});var a=[],r=n.props.notifyError;e.forEach((function(e){a.push((function(){return n._creativeService.getDisplayAd(e).then((function(e){return e.data})).then((function(e){e.available_user_audit_actions.includes(t)&&n._creativeService.makeAuditAction(e.id,t).catch((function(e){return r(e)}))}))}))})),(0,y.executeTasksInSequence)(a).then((function(){n.setState({selectedRowKeys:[],allRowsAreSelected:!1,isUpdatingAuditStatus:!1}),n.redirect()})).catch((function(e){n.setState({isUpdatingAuditStatus:!1}),n.props.notifyError(e)}))},n.handleAuditAction=function(e){var t=n.state,a=t.allRowsAreSelected,r=t.selectedRowKeys;a?n.getAllCreativesIds().then((function(t){n.makeAuditAction(t,e)})):n.makeAuditAction(r,e)},n.onSelectChange=function(e){n.setState({selectedRowKeys:e})},n.selectAllItemIds=function(){n.setState({allRowsAreSelected:!0})},n.unselectAllItemIds=function(){n.setState({selectedRowKeys:[],allRowsAreSelected:!1})},n.unsetAllItemsSelectedFlag=function(){n.setState({allRowsAreSelected:!1})},n.archiveCreatives=function(){n.showModal()},n.showModal=function(){n.setState({isArchiveModalVisible:!0})},n.handleCancel=function(){n.setState({isArchiveModalVisible:!1})},n.redirect=function(){var e=n.props,t=e.location,a=t.search,r=t.pathname,o=t.state,i=e.history,s=e.match.params.organisationId,l=n.state.dataSource,c=(0,p.parseSearch)(a,g.CREATIVE_DISPLAY_SEARCH_SETTINGS);if(1===l.length&&1!==c.currentPage){var u=Object.assign(Object.assign({},c),{currentPage:c.currentPage-1});n.fetchDisplayAds(s,c,!0),i.push({pathname:r,search:(0,p.updateSearch)(a,u),state:o})}n.fetchDisplayAds(s,c,!0)},n.makeArchiveAction=function(e){n.setState({isArchiving:!0});var t=[];e.forEach((function(e){t.push((function(){return n._creativeService.getDisplayAd(e).then((function(e){return e.data})).then((function(t){return"AUDIT_PENDING"!==t.audit_status&&"AUDIT_FAILED"!==t.audit_status&&"AUDIT_PASSED"!==t.audit_status?n._creativeService.updateDisplayCreative(e,Object.assign(Object.assign({},t),{archived:!0})):Promise.resolve()}))}))})),(0,y.executeTasksInSequence)(t).then((function(){n.setState({isArchiveModalVisible:!1,selectedRowKeys:[]},(function(){i.message.success(n.props.intl.formatMessage(b.default.archiveSuccess)),n.redirect(),n.setState({isArchiving:!1})}))}))},n.archiveDisplayAd=function(e){var t=n.props,a=t.match.params.organisationId,r=t.location,s=r.search,l=r.pathname,c=r.state,u=t.intl,d=t.history,f=n.state.dataSource,m=(0,p.parseSearch)(s,g.CREATIVE_DISPLAY_SEARCH_SETTINGS),y=function(){n.fetchDisplayAds(a,m)};"NOT_AUDITED"===e.audit_status?i.Modal.confirm({title:u.formatMessage(b.default.creativeModalConfirmArchivedTitle),content:u.formatMessage(b.default.creativeModalConfirmArchivedContent),icon:o.createElement(E.ExclamationCircleOutlined,null),okText:u.formatMessage(b.default.creativeModalConfirmArchivedOk),cancelText:u.formatMessage(b.default.cancelText),onOk:function(){n._creativeService.updateDisplayCreative(e.id,Object.assign(Object.assign({},e),{archived:!0})).then((function(){if(1===f.length&&1!==m.currentPage){var e=Object.assign(Object.assign({},m),{currentPage:m.currentPage-1});y(),d.replace({pathname:l,search:(0,p.updateSearch)(s,e),state:c})}y()}))},onCancel:function(){}}):i.Modal.warning({title:u.formatMessage(b.default.creativeModalNoArchiveTitle),content:u.formatMessage(b.default.creativeModalNoArchiveMessage),icon:o.createElement(E.ExclamationCircleOutlined,null)})},n.handleOk=function(){var e=n.state,t=e.selectedRowKeys;return e.allRowsAreSelected?n.getAllCreativesIds().then((function(e){n.makeArchiveAction(e)})):n.makeArchiveAction(t)},n.state={selectedRowKeys:[],allRowsAreSelected:!1,isArchiveModalVisible:!1,isArchiving:!1,isUpdatingAuditStatus:!1,isLoadingDisplayAds:!1,dataSource:[],totalDisplayAds:0,hasDisplayAds:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.history,n=e.location,a=n.search,r=n.pathname,o=e.match.params.organisationId;if((0,p.isSearchValid)(a,g.CREATIVE_DISPLAY_SEARCH_SETTINGS)){var i=(0,p.parseSearch)(a,g.CREATIVE_DISPLAY_SEARCH_SETTINGS);this.fetchDisplayAds(o,i,!0)}else t.replace({pathname:r,search:(0,p.buildDefaultSearch)(a,g.CREATIVE_DISPLAY_SEARCH_SETTINGS),state:{reloadDataSource:!0}})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.location,a=n.pathname,r=n.search,o=n.state,i=t.match.params.organisationId,s=t.history,l=e.location.search,c=e.match.params.organisationId,u=o&&o.reloadDataSource;if(!(0,p.compareSearches)(r,l)||i!==c)if((0,p.isSearchValid)(r,g.CREATIVE_DISPLAY_SEARCH_SETTINGS)){var d=(0,p.parseSearch)(r,g.CREATIVE_DISPLAY_SEARCH_SETTINGS);this.fetchDisplayAds(i,d,u)}else s.replace({pathname:a,search:(0,p.buildDefaultSearch)(r,g.CREATIVE_DISPLAY_SEARCH_SETTINGS),state:{reloadDataSource:i!==c}})}},{key:"render",value:function(){var e=this.state,t=e.selectedRowKeys,n=e.allRowsAreSelected,a=e.isUpdatingAuditStatus,r=e.dataSource,i=e.hasDisplayAds,s=e.totalDisplayAds,l=e.isLoadingDisplayAds,c={selectedRowKeys:t,allRowsAreSelected:n,onChange:this.onSelectChange,selectAllItemIds:this.selectAllItemIds,unselectAllItemIds:this.unselectAllItemIds,onSelectAll:this.unsetAllItemsSelectedFlag,onSelect:this.unsetAllItemsSelectedFlag},f={archiveCreatives:this.archiveCreatives,isArchiveModalVisible:this.state.isArchiveModalVisible,handleOk:this.handleOk,handleCancel:this.handleCancel,handleAuditAction:this.handleAuditAction,isArchiving:this.state.isArchiving};return o.createElement("div",{className:"ant-layout"},o.createElement(u.default,{selectedRowKeys:c.selectedRowKeys,multiEditProps:f}),o.createElement("div",{className:"ant-layout"},o.createElement(M,{className:"mcs-content-container"},o.createElement(d.default,{rowSelection:c,isUpdatingAuditStatus:a,dataSource:r,archiveDisplayAd:this.archiveDisplayAd,hasDisplayAds:i,isLoadingDisplayAds:l,totalDisplayAds:s}))))}}]),t}(o.Component);w([(0,_.lazyInject)(S.TYPES.ICreativeService)],P.prototype,"_creativeService",void 0),t.default=(0,s.compose)(l.withRouter,c.injectIntl,f.injectDrawer,m.default)(P)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(33),s=n(6),l=n(8),c=n(107),u=n(11);function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=(0,s.defineMessages)({displayAds:{id:"creatives.display.list.actionbar.breadcrumb",defaultMessage:"Display Ads"},archiveCreativesModalTitle:{id:"creatives.display.list.multiArchive.modal.title",defaultMessage:"Archive Creatives"},archiveCreativesModalMessage:{id:"creatives.display.list.multiArchive.modal.msg",defaultMessage:"You can only archive creatives that haven't passed or failed the audit. If you have selected creatives wtih passed or failed audit status, please reset their audit status first before archiving."},auditAction:{id:"creatives.display.list.audit",defaultMessage:"Audit Action"},startAll:{id:"creatives.display.list.startAllAudits",defaultMessage:"Start"},resetAll:{id:"creatives.display.list.resetAllAudits",defaultMessage:"Reset"}}),m=function(e){function t(){return d(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.selectedRowKeys,n=e.multiEditProps,a=n.archiveCreatives,l=n.isArchiveModalVisible,d=n.handleCancel,f=n.handleAuditAction,m=n.handleOk,g=n.isArchiving,y=e.match.params.organisationId,h=e.intl,v=!!(t&&t.length>0),b=[{name:h.formatMessage(p.displayAds),path:"/v2/o/"+y+"/creatives/display"}];return r.createElement(u.Actionbar,{paths:b},r.createElement(i.Link,{to:"/v2/o/"+y+"/creatives/display/create"},r.createElement(o.Button,{className:"mcs-primary",type:"primary"},r.createElement(u.McsIcon,{type:"plus"})," ",r.createElement(s.FormattedMessage,{id:"creatives.display.list.actionbar.newDisplatAd",defaultMessage:"New Display Ad"}))),r.createElement(u.Slide,{toShow:v,horizontal:!0,content:r.createElement(o.Button,{onClick:a,className:"button-slider button-glow"},r.createElement(u.McsIcon,{type:"delete"}),r.createElement(s.FormattedMessage,{id:"creatives.display.list.actionbar.archive",defaultMessage:"Archive"}))}),v?r.createElement(o.Modal,{title:h.formatMessage(p.archiveCreativesModalTitle),visible:l,onOk:m,onCancel:d,confirmLoading:g},r.createElement("p",null,h.formatMessage(p.archiveCreativesModalMessage))):null,r.createElement(u.Slide,{toShow:v,horizontal:!0,content:r.createElement(c.Dropdown,{overlay:r.createElement(o.Menu,{onClick:function(e){switch(e.key){case"start":return f("START_AUDIT");case"reset":return f("RESET_AUDIT")}}},r.createElement(o.Menu.Item,{key:"start"},r.createElement(s.FormattedMessage,p.startAll)),r.createElement(o.Menu.Item,{key:"reset"},r.createElement(s.FormattedMessage,p.resetAll))),trigger:["click"]},r.createElement(o.Button,{className:"button-glow",style:{marginRight:"20px"}},r.createElement(u.McsIcon,{type:"chevron"}),r.createElement(s.FormattedMessage,p.auditAction)))}))}}]),t}(r.Component);t.default=(0,l.compose)(i.withRouter,s.injectIntl)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(33),s=n(8),l=n(68),c=n(1140),u=n(30),d=m(n(845)),f=m(n(348)),p=n(11);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.editDisplayCreative=function(e){var t=n.props,a=t.match.params.organisationId;t.history.push("/v2/o/"+a+"/creatives/display/edit/"+e.id)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"updateLocationSearch",value:function(e){var t=this.props,n=t.history,a=t.location,r=a.search,o={pathname:a.pathname,search:(0,u.updateSearch)(r,e,c.CREATIVE_DISPLAY_SEARCH_SETTINGS)};n.push(o)}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.dataSource,o=t.isLoadingDisplayAds,s=t.location.search,m=t.rowSelection,g=t.isUpdatingAuditStatus,y=t.totalDisplayAds,h=t.intl,v=t.hasDisplayAds,b=t.archiveDisplayAd,_=(0,u.parseSearch)(s,c.CREATIVE_DISPLAY_SEARCH_SETTINGS),S={placeholder:h.formatMessage(f.default.creativeModalSearchPlaceholder),onSearch:function(t){return e.updateLocationSearch({keywords:t,currentPage:1})},defaultValue:_.keywords},E={current:_.currentPage,pageSize:_.pageSize,total:y,onChange:function(t,n){e.updateLocationSearch({currentPage:t,pageSize:n}),m&&m.unselectAllItemIds&&m.allRowsAreSelected&&m.unselectAllItemIds()},onShowSizeChange:function(t,n){return e.updateLocationSearch({pageSize:n,currentPage:1})}},O=[{intlMessage:f.default.preview,key:"asset_path",isHideable:!1,className:"mcs-table-image-col",render:function(e,t){return r.createElement(d.default,{item:t})}},{intlMessage:f.default.name,key:"name",isHideable:!1,render:function(e,t){return r.createElement(i.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+n+"/creatives/display/edit/"+t.id},e)}},{intlMessage:f.default.auditStatus,key:"audit_status",isHideable:!1,render:function(e){return r.createElement("span",null,e)}},{intlMessage:f.default.publishedVersion,key:"published_version",isHideable:!1,render:function(e){return r.createElement("span",null,e)}}],w=[{key:"action",actions:function(){return[{intlMessage:f.default.edit,callback:e.editDisplayCreative},{intlMessage:f.default.archive,callback:b}]}}];return v?r.createElement("div",{className:"mcs-table-container"},r.createElement(l.TableViewFilters,{columns:O,actionsColumnsDefinition:w,dataSource:a,loading:o||g,pagination:E,rowSelection:m,searchOptions:S})):r.createElement(p.EmptyTableView,{iconType:"display",message:h.formatMessage(f.default.noDisplayCreative)})}}]),t}(r.Component);t.default=(0,s.compose)(i.withRouter,o.injectIntl)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(8),l=O(n(2477)),c=O(n(2478)),u=n(6),d=n(13),f=n(61),p=n(30),m=n(1141),g=O(n(23)),y=n(112),h=n(44),v=n(83),b=O(n(348)),_=n(15),S=n(12),E=n(41);function O(e){return e&&e.__esModule?e:{default:e}}var w=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=i.Layout.Content,P=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchNativeAds=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n.setState({isLoadingNatives:!0});var r=Object.assign(Object.assign({},(0,h.getPaginatedApiParam)(t.currentPage,t.pageSize)),{archived:t.archived,subtype:["NATIVE"]});t.keywords&&(r=Object.assign(Object.assign({},r),{keywords:t.keywords})),n._creativeService.getDisplayAds(e,r).then((function(e){var t=e.data,r=(0,v.normalizeArrayOfObject)(t,"id");n.setState({dataSource:Object.keys(r).map((function(e){return Object.assign({},r[e])})),isLoadingNatives:!1,hasNatives:!a||0!==e.count,totalNativeCreatives:e.total||0})}))},n.onSelectChange=function(e){n.setState({selectedRowKeys:e})},n.selectAllItemIds=function(){n.setState({allRowsAreSelected:!0})},n.unselectAllItemIds=function(){n.setState({selectedRowKeys:[],allRowsAreSelected:!1})},n.archiveNativeCreatives=function(){n.showModal()},n.showModal=function(){n.setState({isArchiveModalVisible:!0})},n.handleCancel=function(){n.setState({isArchiveModalVisible:!1})},n.getAllNativeCreativeIds=function(){var e=n.props,t=e.match.params.organisationId,a=e.notifyError,r={type:"DISPLAY_AD",subtype:["NATIVE"],archived:!1,max_results:n.state.totalNativeCreatives};return n._creativeService.getDisplayAds(t,r).then((function(e){return e.data.map((function(e){return e.id}))})).catch((function(e){a(e)}))},n.archiveNativeAd=function(e){var t=n.props,a=t.match.params.organisationId,r=t.location,s=r.search,l=r.pathname,c=r.state,u=t.history,d=t.intl,f=(0,p.parseSearch)(s,m.NATIVE_SEARCH_SETTINGS),g=n.state.dataSource,y=function(){n.fetchNativeAds(a,f)};i.Modal.confirm({title:d.formatMessage(b.default.creativeModalConfirmArchivedTitle),content:d.formatMessage(b.default.creativeModalNoArchiveMessage),icon:o.createElement(E.ExclamationCircleOutlined,null),okText:d.formatMessage(b.default.creativeModalConfirmArchivedOk),cancelText:d.formatMessage(b.default.cancelText),onOk:function(){n._creativeService.updateDisplayCreative(e.id,Object.assign(Object.assign({},e),{archived:!0})).then((function(){if(1===g.length&&1!==f.currentPage){var e=Object.assign(Object.assign({},f),{currentPage:f.currentPage-1});y(),u.replace({pathname:l,search:(0,p.updateSearch)(s,e),state:c})}y()}))},onCancel:function(){}})},n.redirectAndNotify=function(){var e=n.props,t=e.location,a=t.search,r=t.pathname,o=t.state,s=e.history,l=e.intl,c=e.match.params.organisationId,u=n.state.dataSource,d=(0,p.parseSearch)(a,m.NATIVE_SEARCH_SETTINGS);if(1===u.length&&1!==d.currentPage){var f=Object.assign(Object.assign({},d),{currentPage:1});n.fetchNativeAds(c,d,!0),s.push({pathname:r,search:(0,p.updateSearch)(a,f),state:o})}else n.fetchNativeAds(c,d,!0);n.setState({isArchiveModalVisible:!1,selectedRowKeys:[]}),i.message.success(l.formatMessage(b.default.archiveNativeSuccess))},n.makeArchiveAction=function(e){n.setState({isArchiving:!0});var t=[];e.forEach((function(e){t.push((function(){return n._creativeService.getDisplayAd(e).then((function(e){return e.data})).then((function(t){return n._creativeService.updateDisplayCreative(e,Object.assign(Object.assign({},t),{archived:!0}))}))}))})),(0,y.executeTasksInSequence)(t).then((function(){n.redirectAndNotify(),n.setState({isArchiving:!1})}))},n.handleOk=function(){var e=n.state,t=e.selectedRowKeys;return e.allRowsAreSelected?n.getAllNativeCreativeIds().then((function(e){n.makeArchiveAction(e)})):n.makeArchiveAction(t)},n.unsetAllItemsSelectedFlag=function(){n.setState({allRowsAreSelected:!1})},n.state={selectedRowKeys:[],isArchiveModalVisible:!1,allRowsAreSelected:!1,isArchiving:!1,hasNatives:!0,isLoadingNatives:!1,dataSource:[],totalNativeCreatives:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.history,n=e.location,a=n.search,r=n.pathname,o=e.match.params.organisationId;if((0,p.isSearchValid)(a,m.NATIVE_SEARCH_SETTINGS)){var i=(0,p.parseSearch)(a,m.NATIVE_SEARCH_SETTINGS);this.fetchNativeAds(o,i,!0)}else t.replace({pathname:r,search:(0,p.buildDefaultSearch)(a,m.NATIVE_SEARCH_SETTINGS),state:{reloadDataSource:!0}})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.location,a=n.pathname,r=n.search,o=n.state,i=t.match.params.organisationId,s=t.history,l=e.location.search,c=e.match.params.organisationId,u=o&&o.reloadDataSource;if(!(0,p.compareSearches)(r,l)||i!==c)if((0,p.isSearchValid)(r,m.NATIVE_SEARCH_SETTINGS)){var d=(0,p.parseSearch)(r,m.NATIVE_SEARCH_SETTINGS);this.fetchNativeAds(i,d,u)}else s.replace({pathname:a,search:(0,p.buildDefaultSearch)(r,m.NATIVE_SEARCH_SETTINGS),state:{reloadDataSource:i!==c}})}},{key:"render",value:function(){var e=this.state,t=e.selectedRowKeys,n=e.allRowsAreSelected,a=e.dataSource,r=e.hasNatives,i=e.isLoadingNatives,s=e.totalNativeCreatives,u={selectedRowKeys:t,onChange:this.onSelectChange,allRowsAreSelected:n,selectAllItemIds:this.selectAllItemIds,unselectAllItemIds:this.unselectAllItemIds,onSelectAll:this.unsetAllItemsSelectedFlag,onSelect:this.unsetAllItemsSelectedFlag},d={archiveNatives:this.archiveNativeCreatives,isArchiveModalVisible:this.state.isArchiveModalVisible,handleOk:this.handleOk,handleCancel:this.handleCancel,isArchiving:this.state.isArchiving};return o.createElement("div",{className:"ant-layout"},o.createElement(l.default,{rowSelection:u,multiEditProps:d}),o.createElement("div",{className:"ant-layout"},o.createElement(M,{className:"mcs-content-container"},o.createElement(c.default,{rowSelection:u,dataSource:a,archiveNativeAd:this.archiveNativeAd,hasNativeAds:r,isLoadingNativeAds:i,totalNativeAds:s}))))}}]),t}(o.Component);w([(0,_.lazyInject)(S.TYPES.ICreativeService)],P.prototype,"_creativeService",void 0),t.default=(0,s.compose)(d.withRouter,u.injectIntl,f.injectDrawer,g.default)(P)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(33),s=n(6),l=n(8),c=n(11);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=(0,s.defineMessages)({archiveNativesModalTitle:{id:"creatives.native.list.multiArchive.modal.title",defaultMessage:"Archive Native Creatives"},archiveNativesModalMessage:{id:"creatives.native.list.multiArchive.modal.message",defaultMessage:"Are you sure to archive all the selected native creatives ?"},breadCrumbNativeListTitle:{id:"creatives.native.list.actionBar.breadCrumb.title",defaultMessage:"Natives"},newNativeCreativeButton:{id:"creatives.native.list.actionBar.new.Native",defaultMessage:"New Native"}}),p=function(e){function t(){return u(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.rowSelection,a=e.multiEditProps,i=a.archiveNatives,l=a.isArchiveModalVisible,u=a.handleCancel,d=a.handleOk,p=a.isArchiving,m=e.intl,g=e.location.pathname,y=e.history,h=[{name:m.formatMessage(f.breadCrumbNativeListTitle),path:"/v2/o/"+t+"/creatives/native"}],v=!!(n.selectedRowKeys&&n.selectedRowKeys.length>0);return r.createElement(c.Actionbar,{paths:h},r.createElement("a",{onClick:function(){y.push({pathname:"/v2/o/"+t+"/creatives/native/create",state:{from:""+g}})}},r.createElement(o.Button,{className:"mcs-primary",type:"primary"},r.createElement(c.McsIcon,{type:"plus"})," ",r.createElement(s.FormattedMessage,f.newNativeCreativeButton))),r.createElement(c.Slide,{toShow:v,horizontal:!0,content:r.createElement(o.Button,{onClick:i,className:"button-slider button-glow"},r.createElement(c.McsIcon,{type:"delete"}),r.createElement(s.FormattedMessage,{id:"creatives.native.list.actionbar.archive",defaultMessage:"Archive"}))}),v?r.createElement(o.Modal,{title:m.formatMessage(f.archiveNativesModalTitle),visible:l,onOk:d,onCancel:u,confirmLoading:p},r.createElement("p",null,m.formatMessage(f.archiveNativesModalMessage))):null)}}]),t}(r.Component);t.default=(0,l.compose)(i.withRouter,s.injectIntl)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(33),i=n(8),s=n(6),l=n(68),c=n(1141),u=n(30),d=m(n(845)),f=m(n(348)),p=n(11);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.editNativeCreatives=function(e){var t=n.props,a=t.match.params.organisationId,r=t.history,o=t.location;r.push({pathname:"/v2/o/"+a+"/creatives/native/edit/"+e.id,state:{from:""+o.pathname}})},n.viewTestModal=function(e){n.setState({modalVisible:!0,selectedNativeId:e.id})},n.handleCancel=function(){n.setState({modalVisible:!1,selectedNativeId:""})},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"updateLocationSearch",value:function(e){var t=this.props,n=t.history,a=t.location,r=a.search,o={pathname:a.pathname,search:(0,u.updateSearch)(r,e,c.NATIVE_SEARCH_SETTINGS)};n.push(o)}},{key:"render",value:function(){var e=this,t=this.props,n=t.location.search,a=t.rowSelection,o=t.intl,i=t.totalNativeAds,s=t.archiveNativeAd,m=t.hasNativeAds,g=t.dataSource,y=t.isLoadingNativeAds,h=(0,u.parseSearch)(n,c.NATIVE_SEARCH_SETTINGS),v={current:h.currentPage,pageSize:h.pageSize,total:i,onChange:function(t,n){e.updateLocationSearch({currentPage:t,pageSize:n}),a&&a.unselectAllItemIds&&a.allRowsAreSelected&&a.unselectAllItemIds()},onShowSizeChange:function(t,n){return e.updateLocationSearch({pageSize:n,currentPage:1})}},b=[{intlMessage:f.default.preview,key:"asset_path",isHideable:!1,className:"mcs-table-image-col",render:function(e,t){return r.createElement(d.default,{item:t})}},{intlMessage:f.default.name,key:"name",isHideable:!1,render:function(t,n){return r.createElement("a",{className:"mcs-campaigns-link",onClick:function(){e.editNativeCreatives(n)}},t)}},{intlMessage:f.default.auditStatus,key:"audit_status",isHideable:!1,render:function(e){return r.createElement("span",null,e)}},{intlMessage:f.default.publishedVersion,key:"published_version",isHideable:!1,render:function(e){return r.createElement("span",null,e)}}],_=[{key:"action",actions:function(){return[{intlMessage:f.default.edit,callback:e.editNativeCreatives},{intlMessage:f.default.archive,callback:s}]}}],S={placeholder:o.formatMessage(f.default.searchPlaceholder),onSearch:function(t){return e.updateLocationSearch({keywords:t,currentPage:1})},defaultValue:h.keywords};return m?r.createElement("div",{className:"mcs-table-container"},r.createElement(l.TableViewFilters,{columns:b,actionsColumnsDefinition:_,dataSource:g,loading:y,pagination:v,rowSelection:a,searchOptions:S})):r.createElement(p.EmptyTableView,{iconType:"display",message:o.formatMessage(f.default.noNativeCreative)})}}]),t}(r.Component);t.default=(0,i.compose)(o.withRouter,s.injectIntl)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateEmailTemplate=void 0;var a,r=n(2480),o=(a=r)&&a.__esModule?a:{default:a};t.CreateEmailTemplate=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=n(6),c=n(13),u=h(n(1126)),d=n(109),f=n(51),p=h(n(2481)),m=h(n(23)),g=n(15),y=n(12);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.promisesValues=function(e,t,a){var r=e.sort((function(e){return!1===e.writable?-1:1})).map((function(e){return"template_file"===e.technical_name&&"DATA_FILE"===e.property_type?Object.assign(Object.assign({},e),{value:Object.assign(Object.assign({},e.value),{acceptedFile:"text/html"})}):e}));n.setState((function(e){var n=Object.assign(Object.assign({},e),{isLoading:!1,initialValues:{properties:r},emailTemplateRenderer:a});return null!==t&&(n.pluginLayout=t),n}))},n.fetchCreationValue=function(e){return n._pluginService.getPluginVersions("1034").then((function(e){var t=e.data[e.data.length-1];return Promise.all([n._pluginService.getPluginVersionProperties("1034",t.id).then((function(e){return e.data})),n._pluginService.getLocalizedPluginLayout("1034",t.id)]).then((function(e){return n.promisesValues(e[0],e[1],t),e}))}))},n.fetchInitialValues=function(e){return n._pluginService.getPluginVersions("1034").then((function(t){return n._creativeService.getEmailTemplate(e).then((function(t){return Promise.all([n._creativeService.getEmailTemplateProperties(e).then((function(e){return e.data})),n._pluginService.getLocalizedPluginLayout(t.data.renderer_plugin_id,t.data.renderer_version_id)]).then((function(e){return n.promisesValues(e[0],e[1]),n.setState((function(e){return Object.assign(Object.assign({},e),{initialValues:{properties:e.initialValues?e.initialValues.properties:[],plugin:t.data}})})),e}))}))}))},n.redirect=function(){var e=n.props,t=e.history,a="/v2/o/"+e.match.params.organisationId+"/creatives/email";t.push(a)},n.saveOrCreatePluginInstance=function(e,t){var a=n.props,r=a.match.params,o=r.organisationId,i=r.creativeId,s=a.history,l=a.notifyError;if(i)return n.setState({isLoading:!0},(function(){n._creativeService.updateEmailTemplate(e.id,e).then((function(a){return n.updatePropertiesValue(t,o,e.id)})).then((function(e){n.setState({isLoading:!1},(function(){s.push("/v2/o/"+o+"/creatives/email")}))})).catch((function(e){return l(e)}))}));var c=Object.assign({},e);return n.state.initialValues&&n.state.emailTemplateRenderer&&(c.renderer_artifact_id=n.state.emailTemplateRenderer.artifact_id,c.renderer_group_id=n.state.emailTemplateRenderer.group_id,c.editor_artifact_id="default-editor",c.editor_group_id="com.mediarithmics.template.email"),n.setState({isLoading:!0},(function(){n._creativeService.createEmailTemplate(o,c).then((function(e){return e.data})).then((function(e){return n.updatePropertiesValue(t,o,e.id)})).then((function(e){n.setState({isLoading:!1},(function(){s.push("/v2/o/"+o+"/creatives/email")}))})).catch((function(e){return l(e)}))}))},n.updatePropertiesValue=function(e,t,a){var r=[];return e.forEach((function(e){if("DATA_FILE"===e.property_type&&"template_file"===e.technical_name){var o=e.value;o.fileName=o&&o.fileName?o.fileName.replace(/\s/g,"_"):void 0,e.value=o}r.push(n._creativeService.updateEmailTemplateProperty(t,a,e.technical_name,e))})),Promise.all(r)},n.formatInitialValues=function(e){var t={};return e.properties&&e.properties.forEach((function(e){t[e.technical_name]={value:e.value}})),{plugin:e.plugin,properties:t}},n.state={edition:!!e.match.params.creativeId,isLoading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.state.edition,n=this.props,a=n.match.params,r=a.organisationId,o=a.creativeId,i=n.notifyError;this.setState((function(){return{isLoading:!0}})),(t&&o?this.fetchInitialValues(o):this.fetchCreationValue(r)).then((function(){e.setState((function(){return{isLoading:!1}}))})).catch((function(t){i(t),e.setState((function(){return{isLoading:!1}}))}))}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,a=n.match.params,r=a.organisationId,o=a.creativeId,i=n.notifyError,s=e.match.params,l=s.organisationId,c=s.creativeId;r===l&&o===c||!o||(this.setState((function(){return{isLoading:!0}})),this.fetchInitialValues(o).then((function(){t.setState((function(){return{isLoading:!1}}))})).catch((function(e){i(e),t.setState((function(){return{isLoading:!1}}))})))}},{key:"render",value:function(){var e=this.props,t=e.match.params,n=t.organisationId,r=t.creativeId,o=e.intl.formatMessage,s=this.state.isLoading,l=[{name:o(p.default.emailTemplateBreadCrumb)}],c=void 0===this.state.pluginLayout?[{sectionId:"properties",title:p.default.menuProperties}]:this.state.pluginLayout.sections.map((function(e){return{sectionId:e.title,title:{id:e.title,defaultMessage:e.title}}})),m=[{sectionId:"general",title:p.default.menuGeneralInformation}].concat(c),g="pluginForm",y=this.state.initialValues&&this.state.initialValues.properties&&this.state.initialValues.properties.length||r?{formId:g,message:p.default.save,onClose:this.redirect}:{formId:g,onClose:this.redirect};return s?i.createElement("div",{style:{display:"flex",flex:1}},i.createElement(f.Loading,{isFullScreen:!0})):i.createElement(d.EditContentLayout,a({paths:l,items:m,scrollId:g},y),i.createElement(u.default,{editionMode:!!r,organisationId:n,save:this.saveOrCreatePluginInstance,pluginProperties:this.state.initialValues&&this.state.initialValues.properties||[],disableFields:s,pluginLayout:this.state.pluginLayout,isLoading:s,pluginVersionId:this.state.emailTemplateRenderer&&this.state.emailTemplateRenderer.id||"",formId:g,initialValues:this.formatInitialValues(this.state.initialValues),showGeneralInformation:!0,showTechnicalName:!0}))}}]),t}(i.Component);v([(0,g.lazyInject)(y.TYPES.ICreativeService)],b.prototype,"_creativeService",void 0),v([(0,g.lazyInject)(y.TYPES.IPluginService)],b.prototype,"_pluginService",void 0),t.default=(0,s.compose)(l.injectIntl,c.withRouter,m.default)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({emailTemplateBreadCrumb:{id:"creatives.email.edit.breadcrumb.title",defaultMessage:"New Email Template"},creativesTypePickerSubTitle:{id:"creatives.edit.typePicker.subtitle",defaultMessage:"Choose your creative type"},menuGeneralInformation:{id:"creatives.edit.sidebar.general",defaultMessage:"General"},menuProperties:{id:"creatives.edit.sidebar.properties",defaultMessage:"Properties"},save:{id:"creatives.edit.breadcrumb.save",defaultMessage:"Save"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmailTemplatesPage=t.EmailTemplatesTable=t.EmailTemplatesActionBar=void 0;var a=i(n(1142)),r=i(n(1143)),o=i(n(2484));function i(e){return e&&e.__esModule?e:{default:e}}t.EmailTemplatesActionBar=a.default,t.EmailTemplatesTable=r.default,t.EmailTemplatesPage=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(6),c=n(8),u=n(23),d=(a=u)&&a.__esModule?a:{default:a},f=n(15),p=n(12);var m=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},g=(0,l.defineMessages)({modalTitle:{id:"email.campaign.sendTest.modal.title",defaultMessage:"Test your Template"},modalBody1:{id:"email.campaign.sendTest.modal.body.1",defaultMessage:"Enter the email address to send your template to."},modalBody2:{id:"email.campaign.sendTest.modal.body.2",defaultMessage:"Your email will be sent from support@mediarithmics.com with the following subject Mediarithmics - Test"},inputPlaceholder:{id:"email.campaign.sendTest.modal.input.placeholder",defaultMessage:"Email address"},inputError:{id:"email.campaign.sendTest.modal.input.error",defaultMessage:"Please enter an valid email address"},notifSuccessTitle:{id:"email.campaign.sendTest.notif.success.title",defaultMessage:"Success"},notifSuccessContent:{id:"email.campaign.sendTest.notif.success.content",defaultMessage:"The test email has been successfully sent!"}}),y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleOk=function(){var e=n.props.intl.formatMessage;if(n.state.inputValue&&n.state.inputValue.length)return n.setState({isLoading:!0},(function(){n._creativeService.sendTestBlast(n.props.selectedtemplateId,n.props.organisationId,n.state.inputValue).then((function(){return n.setState({isLoading:!1},(function(){n.props.notifySuccess({message:e(g.notifSuccessTitle),description:e(g.notifSuccessContent)}),n.props.handleCancel()}))})).catch((function(e){n.props.notifyError(e),n.setState({isLoading:!1})}))}));n.setState({error:!0})},n.state={inputValue:"",isLoading:!1,error:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props.intl.formatMessage;return i.createElement(s.Modal,{title:t(g.modalTitle),visible:this.props.isModalVisible,onOk:this.handleOk,onCancel:this.props.handleCancel,confirmLoading:this.state.isLoading},i.createElement("p",null,t(g.modalBody1)),i.createElement("p",null,t(g.modalBody2)),i.createElement("br",null),this.state.error?i.createElement(s.Alert,{message:t(g.inputError),type:"error"}):null,i.createElement(s.Input,{onChange:function(t){e.setState({inputValue:t.target.value})},defaultValue:"",placeholder:t(g.inputPlaceholder)}))}}]),t}(i.Component);m([(0,f.lazyInject)(p.TYPES.ICreativeService)],y.prototype,"_creativeService",void 0),t.default=(0,c.compose)(l.injectIntl,d.default)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(8),l=O(n(1142)),c=O(n(1143)),u=n(6),d=n(13),f=n(61),p=n(30),m=n(1144),g=O(n(23)),y=n(112),h=n(44),v=n(83),b=O(n(348)),_=n(15),S=n(12),E=n(41);function O(e){return e&&e.__esModule?e:{default:e}}var w=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=i.Layout.Content,P=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchCreativeEmails=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n.setState({isLoadingEmailTemplates:!0});var r=Object.assign(Object.assign({},(0,h.getPaginatedApiParam)(t.currentPage,t.pageSize)),{archived:t.archived});t.keywords&&(r=Object.assign(Object.assign({},r),{keywords:t.keywords})),n._creativeService.getEmailTemplates(e,r).then((function(e){var t=e.data,r=(0,v.normalizeArrayOfObject)(t,"id");n.setState({dataSource:Object.keys(r).map((function(e){return Object.assign({},r[e])})),isLoadingEmailTemplates:!1,hasEmailTemplates:!a||0!==e.count,totalEmailTemplates:e.total||0})}))},n.onSelectChange=function(e){n.setState({selectedRowKeys:e})},n.selectAllItemIds=function(){n.setState({allRowsAreSelected:!0})},n.unselectAllItemIds=function(){n.setState({selectedRowKeys:[],allRowsAreSelected:!1})},n.archiveEmails=function(){n.showModal()},n.showModal=function(){n.setState({isArchiveModalVisible:!0})},n.handleCancel=function(){n.setState({isArchiveModalVisible:!1})},n.getAllEmailTemplatesIds=function(){var e=n.props,t=e.match.params.organisationId,a=e.notifyError,r={type:"EMAIL_TEMPLATE",archived:!1,max_results:n.state.totalEmailTemplates};return n._creativeService.getEmailTemplates(t,r).then((function(e){return e.data.map((function(e){return e.id}))})).catch((function(e){a(e)}))},n.redirectAndNotify=function(){var e=n.props,t=e.location,a=t.search,r=t.pathname,o=t.state,s=e.history,l=e.intl,c=e.match.params.organisationId,u=(0,p.parseSearch)(a,m.CREATIVE_EMAIL_SEARCH_SETTINGS);if(1===n.state.dataSource.length&&1!==u.currentPage){var d=Object.assign(Object.assign({},u),{currentPage:1});n.fetchCreativeEmails(c,u,!0),s.push({pathname:r,search:(0,p.updateSearch)(a,d),state:o})}else n.fetchCreativeEmails(c,u,!0);n.setState({isArchiveModalVisible:!1,selectedRowKeys:[]}),i.message.success(l.formatMessage(b.default.archiveEmailSuccess))},n.makeArchiveAction=function(e){n.setState({isArchiving:!0});var t=[];e.forEach((function(e){t.push((function(){return n._creativeService.getEmailTemplate(e).then((function(e){return e.data})).then((function(t){return n._creativeService.updateEmailTemplate(e,Object.assign(Object.assign({},t),{archived:!0}))}))}))})),(0,y.executeTasksInSequence)(t).then((function(){n.redirectAndNotify(),n.setState({isArchiving:!1})}))},n.archiveCreativeEmail=function(e){var t=n.props,a=t.match.params.organisationId,r=t.location,s=r.search,l=r.pathname,c=r.state,u=t.history,d=t.intl,f=n.state.dataSource,g=(0,p.parseSearch)(s,m.CREATIVE_EMAIL_SEARCH_SETTINGS),y=function(){n.fetchCreativeEmails(a,g,!0)};i.Modal.confirm({title:d.formatMessage(b.default.creativeModalConfirmArchivedTitle),content:d.formatMessage(b.default.creativeModalConfirmArchivedContent),icon:o.createElement(E.ExclamationCircleOutlined,null),okText:d.formatMessage(b.default.creativeModalConfirmArchivedOk),cancelText:d.formatMessage(b.default.cancelText),onOk:function(){n._creativeService.updateEmailTemplate(e.id,Object.assign(Object.assign({},e),{archived:!0})).then((function(){if(1===f.length&&1!==g.currentPage){var e=Object.assign(Object.assign({},g),{currentPage:g.currentPage-1});y(),u.replace({pathname:l,search:(0,p.updateSearch)(s,e),state:c})}y()}))},onCancel:function(){}})},n.handleOk=function(){var e=n.state,t=e.selectedRowKeys;return e.allRowsAreSelected?n.getAllEmailTemplatesIds().then((function(e){n.makeArchiveAction(e)})):n.makeArchiveAction(t)},n.unsetAllItemsSelectedFlag=function(){n.setState({allRowsAreSelected:!1})},n.state={selectedRowKeys:[],isArchiveModalVisible:!1,allRowsAreSelected:!1,isArchiving:!1,isLoadingEmailTemplates:!1,dataSource:[],totalEmailTemplates:0,hasEmailTemplates:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.history,n=e.location,a=n.search,r=n.pathname,o=e.match.params.organisationId;if((0,p.isSearchValid)(a,m.CREATIVE_EMAIL_SEARCH_SETTINGS)){var i=(0,p.parseSearch)(a,m.CREATIVE_EMAIL_SEARCH_SETTINGS);this.fetchCreativeEmails(o,i,!0)}else t.replace({pathname:r,search:(0,p.buildDefaultSearch)(a,m.CREATIVE_EMAIL_SEARCH_SETTINGS),state:{reloadDataSource:!0}})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.location,a=n.pathname,r=n.search,o=n.state,i=t.match.params.organisationId,s=t.history,l=e.location.search,c=e.match.params.organisationId,u=o&&o.reloadDataSource;if(!(0,p.compareSearches)(r,l)||i!==c)if((0,p.isSearchValid)(r,m.CREATIVE_EMAIL_SEARCH_SETTINGS)){var d=(0,p.parseSearch)(r,m.CREATIVE_EMAIL_SEARCH_SETTINGS);this.fetchCreativeEmails(i,d,u)}else s.replace({pathname:a,search:(0,p.buildDefaultSearch)(r,m.CREATIVE_EMAIL_SEARCH_SETTINGS),state:{reloadDataSource:i!==c}})}},{key:"render",value:function(){var e=this.state,t=e.selectedRowKeys,n=e.allRowsAreSelected,a=e.dataSource,r=e.totalEmailTemplates,i=e.hasEmailTemplates,s=e.isLoadingEmailTemplates,u={selectedRowKeys:t,onChange:this.onSelectChange,allRowsAreSelected:n,selectAllItemIds:this.selectAllItemIds,unselectAllItemIds:this.unselectAllItemIds,onSelectAll:this.unsetAllItemsSelectedFlag,onSelect:this.unsetAllItemsSelectedFlag},d={archiveEmails:this.archiveEmails,isArchiveModalVisible:this.state.isArchiveModalVisible,handleOk:this.handleOk,handleCancel:this.handleCancel,isArchiving:this.state.isArchiving};return o.createElement("div",{className:"ant-layout"},o.createElement(l.default,{rowSelection:u,multiEditProps:d}),o.createElement("div",{className:"ant-layout"},o.createElement(M,{className:"mcs-content-container"},o.createElement(c.default,{rowSelection:u,dataSource:a,archiveEmailTemplate:this.archiveCreativeEmail,hasEmailTemplates:i,isLoadingEmailTemplates:s,totalEmailTemplates:r}))))}}]),t}(o.Component);w([(0,_.lazyInject)(S.TYPES.ICreativeService)],P.prototype,"_creativeService",void 0),t.default=(0,s.compose)(d.withRouter,u.injectIntl,f.injectDrawer,g.default)(P)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=n(13),c=n(10),u=n(6),d=v(n(2486)),f=v(n(2490)),p=v(n(23)),m=v(n(2491)),g=n(15),y=n(12),h=n(11);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.redirect=function(){var e=n.props,t=e.history,a=e.location.state,r=e.match.params.organisationId,o=a&&a.from?a.from:"/v2/o/"+r+"/creatives/native";t.push(o)},n.redirectWithCreatedId=function(e){var t=n.props,a=t.history,r="/v2/o/"+t.match.params.organisationId+"/creatives/native/edit/"+e;a.push(r)},n.onSave=function(e){var t=n.props,a=t.match.params.organisationId,r=t.intl,o=c.message.loading(r.formatMessage(f.default.savingInProgress),0);n.setState({loading:!0}),n._displayCreativeFormService.saveDisplayCreative(a,e).then((function(e){o(),n.setState({loading:!1}),n.redirectWithCreatedId(e),c.message.success(r.formatMessage(f.default.successfulSaving))})).catch((function(e){o(),n.props.notifyError(e),n.setState({loading:!1})}))},n.onSubmitFail=function(){var e=n.props.intl;c.message.error(e.formatMessage(f.default.errorFormMessage))},n.state={loading:!1,nativeName:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.nativeId;t&&this._creativeService.getCreative(t).then((function(e){return e.data})).then((function(t){e.setState({nativeName:t.name?t.name:"creative "+t.id})}))}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.match.params.nativeId,a=e.match.params.nativeId;n&&n!==a&&this._creativeService.getCreative(n).then((function(e){return e.data})).then((function(e){t.setState({nativeName:e.name?e.name:"creative "+e.id})}))}},{key:"render",value:function(){var e=this.props,t=e.match.params,n=t.nativeId,r=t.organisationId,o=e.intl.formatMessage,s=this.state.nativeName,l=f.default.save,c={name:o(f.default.nativeListBreadCrumb),path:"/v2/o/"+r+"/creatives/native"},u=n?o(f.default.creativeEditionBreadCrumb,{name:s}):o(f.default.nativeCreationBreadCrumb),p=[Object.assign({},c),{name:u}],g={close:this.redirect,onSubmit:this.onSave,actionBarButtonText:l,breadCrumbPaths:p,onSubmitFail:this.onSubmitFail};return this.state.loading?i.createElement(h.Loading,{isFullScreen:!0}):n?i.createElement(m.default,a({},g,{creativeId:n})):i.createElement(d.default,g)}}]),t}(i.Component);b([(0,g.lazyInject)(y.TYPES.ICreativeService)],_.prototype,"_creativeService",void 0),b([(0,g.lazyInject)(y.TYPES.IDisplayCreativeFormService)],_.prototype,"_displayCreativeFormService",void 0),t.default=(0,s.compose)(u.injectIntl,l.withRouter,p.default)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=g(n(2487)),c=g(n(59)),u=g(n(23)),d=g(n(1145)),f=n(15),p=n(12),m=n(11);function g(e){return e&&e.__esModule?e:{default:e}}var y=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.loadFormData=function(e){n.setState({isLoading:!0}),n._displayCreativeFormService.initializeFormData(e,"NATIVE","640x190").then((function(e){return n.setState({nativeFormData:e,isLoading:!1})})).catch((function(e){c.default.debug(e),n.props.notifyError(e),n.setState((function(){return{isLoading:!1}}))}))},n.resetFormData=function(){n.setState({nativeFormData:{}})},n.state={isLoading:!1,nativeFormData:{}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.state,t=e.nativeFormData;if(e.isLoading)return i.createElement(m.Loading,{isFullScreen:!0});var n=this.props.initialValues||t;return Object.keys(n).length>0?i.createElement(d.default,a({},this.props,{initialValues:n,goToCreativeTypeSelection:this.resetFormData})):i.createElement(l.default,{onSelect:this.loadFormData,close:this.props.close})}}]),t}(i.Component);y([(0,f.lazyInject)(p.TYPES.IDisplayCreativeFormService)],h.prototype,"_displayCreativeFormService",void 0),t.default=(0,s.compose)(u.default)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(10),s=n(13),l=n(24),c=n(11),u=p(n(164)),d=p(n(60)),f=n(2488);function p(e){return e&&e.__esModule?e:{default:e}}var m=i.Layout.Content,g=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.onSelect,a={formId:"typePickerForm",onClose:this.props.close,paths:[{name:t(u.default.nativeCreationBreadCrumb)}]},o=function(e){return function(){return n(e)}};return r.createElement(i.Layout,null,r.createElement("div",{className:"edit-layout ant-layout"},r.createElement(d.default,a),r.createElement(i.Layout,null,r.createElement(m,{className:"mcs-content-container mcs-form-container text-center"},r.createElement(l.FormTitle,{title:u.default.creativesTypePickerTitle,subtitle:u.default.creativesTypePickerSubTitle}),r.createElement(i.Row,{className:"mcs-selector_container"},r.createElement(i.Row,{className:"menu"},r.createElement(c.MenuList,{title:t(u.default.creativeTypeNative),select:o(f.NATIVE_AD_RENDERER)}),r.createElement(c.MenuList,{title:t(u.default.creativeTypeQuantum),select:o(f.QUANTUM_AD_RENDERER)}),r.createElement(c.MenuList,{title:t(u.default.creativeTypeIvidence),select:o(f.IVIDENCE_AD_RENDERER)})))))))}}]),t}(r.Component);t.default=(0,s.withRouter)((0,o.injectIntl)(g))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DISPLAY_CREATIVE_FORM="displayCreativeForm";var a={equals:function(e,t){return e}};t.IVIDENCE_AD_RENDERER="1032",t.QUANTUM_AD_RENDERER="1047",t.NATIVE_AD_RENDERER="1075";t.default=function(e,t,n){return a[e](t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(35),s=n(25),l=n(6),c=n(8),u=n(24),d=n(164),f=(a=d)&&a.__esModule?a:{default:a},p=n(137),m=n(11);var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.state={displayAdvancedSection:!1,displayWarning:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.fieldValidators.isRequired,a=e.initialValue.creative,r=e.small,i=!1;return(0,p.isDisplayAdResource)(a)&&(i="AUDIT_PASSED"===a.audit_status||"AUDIT_PENDING"===a.audit_status),o.createElement("div",null,o.createElement(u.FormSection,{title:f.default.creativeSectionGeneralTitle,subtitle:f.default.creativeSectionGeneralSubTitle}),o.createElement(u.FormInputField,{name:"creative.name",component:u.FormInput,validate:[n],formItemProps:{label:t(f.default.creativeCreationGeneralNameFieldTitle),required:!0},inputProps:{placeholder:t(f.default.creativeCreationGeneralNameFieldPlaceHolder),disabled:i},helpToolTipProps:{title:t(f.default.creativeCreationGeneralNameFieldHelper)},small:r}),o.createElement("div",null,o.createElement(m.Button,{className:"optional-section-title",onClick:this.toggleAdvancedSection},o.createElement(m.McsIcon,{type:"settings"}),o.createElement("span",{className:"step-title"},t(f.default.advanced)),o.createElement(m.McsIcon,{type:"chevron"})),o.createElement("div",{className:this.state.displayAdvancedSection?"optional-section-content":"hide-section"},o.createElement(u.FormAlertInputField,{name:"creative.technical_name",component:u.FormAlertInput,formItemProps:{label:t(f.default.creativeCreationAdvancedTechnicalFieldTitle)},inputProps:{placeholder:t(f.default.creativeCreationAdvancedTechnicalFieldPlaceholder),disabled:i},helpToolTipProps:{title:t(f.default.creativeCreationAdvancedTechnicalFieldTooltip)},iconType:"warning",type:"warning",message:t(f.default.warningOnTokenEdition),small:r}))))}}]),t}(o.Component);t.default=(0,c.compose)(l.injectIntl,u.withValidators,(0,s.connect)((function(e,t){return{initialValue:(0,i.getFormInitialValues)(p.DISPLAY_CREATIVE_FORM)(e)}})))(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({nativeListBreadCrumb:{id:"native.creatives.breadcrumb.list.natives",defaultMessage:"Natives"},creativeEditionBreadCrumb:{id:"native.creatives.breadcrumb.edit.native",defaultMessage:"Edit {name}"},nativeCreationBreadCrumb:{id:"native.creatives.breadcrumb.new.native",defaultMessage:"New Native Creative"},save:{id:"native.creatives.edit.breadcrumb.save",defaultMessage:"Save"},savingInProgress:{id:"creatives.native.edit.savingInProgress",defaultMessage:"Saving in progress"},errorFormMessage:{id:"native.creative.form.error.message",defaultMessage:"There is an error with some fields in your form. Please review the data you entered."},successfulSaving:{id:"native.creative.form.success.message",defaultMessage:"Your creative has successfully been saved!"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=g(n(59)),c=n(13),u=n(51),d=g(n(23)),f=g(n(1145)),p=n(15),m=n(12);function g(e){return e&&e.__esModule?e:{default:e}}var y=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},h=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.loadFormData=function(e,t){n.setState({isLoading:!0}),n._displayCreativeFormService.loadFormData(t).then((function(e){n.setState({creativeFormData:e,isLoading:!1})})).catch((function(e){l.default.debug(e),n.props.notifyError(e),n.setState((function(){return{isLoading:!1}}))}))},n.saveFormData=function(){n.setState({isLoading:!0})},n.state={isLoading:!0,creativeFormData:{}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.creativeId;this.loadFormData(t,n)}},{key:"render",value:function(){var e=this.props,t=(e.creativeId,h(e,["creativeId"]));return this.state.isLoading?i.createElement(u.Loading,{isFullScreen:!0}):i.createElement(f.default,a({},t,{initialValues:this.state.creativeFormData}))}}]),t}(i.Component);y([(0,p.lazyInject)(m.TYPES.IDisplayCreativeFormService)],v.prototype,"_displayCreativeFormService",void 0),t.default=(0,s.compose)(c.withRouter,d.default)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(2493),o=(a=r)&&a.__esModule?a:{default:a};t.default={contentComponent:o.default}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(10),c=n(6),u=v(n(126)),d=n(30),f=n(44),p=v(n(2494)),m=v(n(1147)),g=n(15),y=n(12),h=n(41);function v(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=l.Layout.Content,O={loading:!1,data:[],total:0},w=function(t){function n(){b(this,n);var e=_(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments));return e.state=O,e.archiveAssetList=function(t){return e._assetFileService.deleteAssetsFile(t)},e.fetchAssetList=function(t,n){e.setState({loading:!0},(function(){var a=Object.assign({},(0,f.getPaginatedApiParam)(n.currentPage,n.pageSize));e._assetFileService.getAssetsFiles(t,a).then((function(t){e.setState({loading:!1,data:t.data,total:t.total||t.count})}))}))},e.onClickArchive=function(t){var n=e.props,a=n.location,r=a.search,i=a.state,s=a.pathname,c=n.history,u=n.match.params.organisationId,f=n.intl.formatMessage,p=e.state.data,g=(0,d.parseSearch)(r,d.PAGINATION_SEARCH_SETTINGS);l.Modal.confirm({icon:o.createElement(h.ExclamationCircleOutlined,null),title:f(m.default.assetArchiveTitle),content:f(m.default.assetArchiveMessage),okText:f(m.default.assetArchiveOk),cancelText:f(m.default.assetArchiveCancel),onOk:function(){e.archiveAssetList(t.id).then((function(){if(1===p.length&&1!==g.currentPage){var t=Object.assign(Object.assign({},g),{currentPage:g.currentPage-1});return c.replace({pathname:s,search:(0,d.updateSearch)(r,t),state:i}),Promise.resolve()}return e.fetchAssetList(u,g)}))},onCancel:function(){}})},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,t),a(n,[{key:"render",value:function(){var t=this,n=[{key:"action",actions:function(){return[{intlMessage:m.default.archive,callback:t.onClickArchive}]}}],a=[{intlMessage:m.default.preview,key:"path",isHideable:!1,className:"mcs-table-image-col",render:function(t,n){return o.createElement("div",{className:"mcs-table-cell-thumbnail"},o.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:""+e.window.MCS_CONSTANTS.ASSETS_URL+t},o.createElement("span",{className:"thumbnail-helper"}),o.createElement("img",{src:""+e.window.MCS_CONSTANTS.ASSETS_URL+t,alt:n.original_name})))}},{intlMessage:m.default.name,key:"original_name",isHideable:!1,render:function(t,n){return o.createElement("a",{href:""+e.window.MCS_CONSTANTS.ASSETS_URL+n.path,rel:"noreferrer noopener",target:"_blank"},t)}},{intlMessage:m.default.type,key:"mime_type",isHideable:!1,render:function(e){return o.createElement("span",null,e)}},{intlMessage:m.default.dimensions,key:"width",isHideable:!1,render:function(e,t){return o.createElement("span",null,e,"x",t.height)}}],r={iconType:"library",message:this.props.intl.formatMessage(m.default.empty)};return o.createElement("div",{className:"ant-layout"},o.createElement(p.default,{onUploadDone:this.fetchAssetList}),o.createElement("div",{className:"ant-layout"},o.createElement(E,{className:"mcs-content-container"},o.createElement(u.default,{fetchList:this.fetchAssetList,dataSource:this.state.data,loading:this.state.loading,total:this.state.total,columns:a,actionsColumnsDefinition:n,pageSettings:d.PAGINATION_SEARCH_SETTINGS,emptyTable:r}))))}}]),n}(o.Component);S([(0,g.lazyInject)(y.TYPES.IAssetFileService)],w.prototype,"_assetFileService",void 0),t.default=(0,i.compose)(s.withRouter,c.injectIntl)(w)}).call(this,n(71))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(13),l=n(6),c=n(8),u=n(11),d=y(n(1147)),f=n(30),p=y(n(23)),m=n(15),g=n(12);function y(e){return e&&e.__esModule?e:{default:e}}function h(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=i.Upload.Dragger,_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleOpenClose=function(){n.setState({isModalOpen:!n.state.isModalOpen,fileList:[]})},n.handleOnUpload=function(){var e=n.props,t=e.match.params.organisationId,a=e.history,r=e.location,o=r.pathname,i=r.search;return n.setState({isLoading:!0}),Promise.all(n.state.fileList.map((function(e){var a=new FormData;return a.append("file",e,e.name),n._assetFileService.uploadAssetsFile(t,a)}))).then((function(e){n.setState({isLoading:!1,isModalOpen:!1,fileList:[]}),1!==(0,f.parseSearch)(i,f.PAGINATION_SEARCH_SETTINGS).currentPage?a.replace({pathname:o,search:(0,f.updateSearch)(i,{currentPage:1,pageSize:10},f.PAGINATION_SEARCH_SETTINGS)}):n.props.onUploadDone(n.props.match.params.organisationId,{currentPage:1,pageSize:10})})).catch((function(e){n.setState({isLoading:!1,fileList:[]}),n.props.notifyError(e)}))},n.checkIfSizeOK=function(e){var t=n.props.intl.formatMessage;e.size<204800||i.message.error(e.name+" "+t(d.default.uploadError),2)},n.filterFileList=function(e){return e.filter((function(e){return e.size<204800}))},n.renderModal=function(){var e=n.props.intl.formatMessage,t={name:"file",multiple:!0,action:"/",accept:".jpg,.jpeg,.png,.gif,.svg",beforeUpload:function(e,t){n.checkIfSizeOK(e);var a=[].concat(h(n.state.fileList),h(n.filterFileList(t)));return n.setState({fileList:a}),!1},fileList:n.state.fileList,onRemove:function(e){n.setState({fileList:n.state.fileList.filter((function(t){return t.uid!==e.uid}))})}};return o.createElement(i.Modal,{title:e(d.default.newAsset),visible:n.state.isModalOpen,onOk:n.handleOnUpload,okText:e(d.default.uploadButton),onCancel:n.handleOpenClose,confirmLoading:n.state.isLoading},o.createElement(i.Spin,{spinning:n.state.isLoading},o.createElement(b,t,o.createElement("p",{className:"ant-upload-text"},e(d.default.uploadTitle)),o.createElement("p",{className:"ant-upload-hint"},e(d.default.uploadMessage)))))},n.state={isModalOpen:!1,fileList:[],isLoading:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=[{name:(0,e.intl.formatMessage)(d.default.assets),path:"/v2/o/"+t+"/library/assets"}];return o.createElement(u.Actionbar,{paths:n},this.renderModal(),o.createElement(i.Button,{className:"mcs-primary",type:"primary",onClick:this.handleOpenClose},o.createElement(u.McsIcon,{type:"plus"})," ",o.createElement(l.FormattedMessage,d.default.newAsset)))}}]),t}(o.Component);v([(0,m.lazyInject)(g.TYPES.IAssetFileService)],_.prototype,"_assetFileService",void 0),t.default=(0,c.compose)(l.injectIntl,s.withRouter,p.default)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(2496)),r=o(n(2497));function o(e){return e&&e.__esModule?e:{default:e}}t.default={actionBarComponent:a.default,contentComponent:r.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(8),l=n(13),c=n(11),u=n(846),d=(a=u)&&a.__esModule?a:{default:a};function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=[{name:(0,e.intl.formatMessage)(d.default.catalog),path:"/v2/o/"+t+"/library/catalog"}];return o.createElement(c.Actionbar,{paths:n})}}]),t}(o.Component);t.default=(0,s.compose)(i.injectIntl,l.withRouter)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(13),l=n(8),c=n(11),u=v(n(2498)),d=v(n(846)),f=n(41),p=n(10),m=v(n(23)),g=n(65),y=n(12),h=n(15);function v(e){return e&&e.__esModule?e:{default:e}}function b(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=p.Select.Option,E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchCatalog=function(e){n._libraryCatalogService.getCatalogs(e).then((function(e){return e.data})).then((function(t){var a=function(e){return n.state.catalogs.selectedId?n.state.catalogs.selectedId:e&&e.length?e[0].token:null}(t);if(null!==a)return n.setState({catalogs:{loading:!1,items:t,selectedId:a}}),n.fetchInitialCategories(e,a);n.setState({catalogs:{loading:!1,items:[]},categories:{loading:!1,items:[]}})})).catch((function(e){return n.handleError(e)}))},n.fetchInitialCategories=function(e,t){n._libraryCatalogService.getCatalogMainCategories(e,t,{depth:0,first_result:0,max_results:500}).then((function(e){return e.data})).then((function(a){var r=a.map((function(a){return n._libraryCatalogService.getCatalogSubCategories(e,t,a.category_id).then((function(e){return e.data})).then((function(e){return Object.assign(Object.assign({},a),{hasSubCategory:e.length>0})})).then((function(r){return n._libraryCatalogService.getCatalogCategoryItems(e,t,a.category_id,{first_result:0,max_results:500}).then((function(e){return e.data})).then((function(e){return Object.assign(Object.assign({},r),{hasItems:e.length>0,subItems:e})}))}))}));return Promise.all(r)})).then((function(e){return n.setState({categories:{items:e,loading:!1}})})).catch((function(e){return n.handleError(e)}))},n.handleError=function(e){n.props.notifyError(e),n.setState({path:[],catalogs:Object.assign(Object.assign({},n.state.catalogs),{loading:!1}),categories:Object.assign(Object.assign({},n.state.categories),{loading:!1})})},n.fetchSubCategories=function(e,t,a){n.setState({categories:{items:n.state.categories.items,loading:!0}},(function(){n._libraryCatalogService.getCatalogSubCategories(e,t,a,{depth:0,first_result:0,max_results:500}).then((function(e){return e.data})).then((function(a){var r=a.map((function(a){return n._libraryCatalogService.getCatalogSubCategories(e,t,a.category_id).then((function(e){return e.data})).then((function(e){return Object.assign(Object.assign({},a),{hasSubCategory:e.length>0})})).then((function(r){return r.hasSubCategory?Object.assign(Object.assign({},r),{hasItems:!1,subItems:[]}):n._libraryCatalogService.getCatalogCategoryItems(e,t,a.category_id).then((function(e){return e.data})).then((function(e){return Object.assign(Object.assign({},r),{hasItems:e.length>0,subItems:e})}))}))}));return Promise.all(r)})).then((function(e){return n.setState({categories:{items:e,loading:!1}})})).catch((function(e){return n.handleError(e)}))}))},n.handleCatalogChange=function(e){var t=n.props.datamart;n.setState({path:[],catalogs:{items:n.state.catalogs.items,loading:!1,selectedId:e},categories:Object.assign(Object.assign({},n.state.categories),{loading:!0})},(function(){return n.fetchInitialCategories(t.id,e)}))},n.generateCatalogSelect=function(){return n.state.catalogs.items.length?o.createElement(p.Select,{defaultValue:n.state.catalogs.selectedId,style:{minWidth:120},onChange:n.handleCatalogChange},n.state.catalogs.items.map((function(e){return o.createElement(S,{key:e.token,value:e.token},e.token)}))):null},n.generateBreadcrumb=function(){var e=n.props.datamart,t=function(t){return function(){var a=[].concat(b(n.state.path)),r=a.findIndex((function(e){return e.category_id===t.category_id}));n.setState({path:a.slice(0,r+1)},(function(){n.state.catalogs.selectedId&&n.fetchSubCategories(e.id,n.state.catalogs.selectedId,t.category_id)}))}};return o.createElement(p.Breadcrumb,{style:{marginBottom:14}},o.createElement(p.Breadcrumb.Item,null,o.createElement(c.Button,{onClick:function(){n.setState({path:[],categories:{items:[],loading:!0}},(function(){n.state.catalogs.selectedId&&n.fetchInitialCategories(e.id,n.state.catalogs.selectedId)}))}},o.createElement(f.HomeOutlined,null)," ",n.state.catalogs.selectedId)),n.state.path.map((function(e,a){return o.createElement(p.Breadcrumb.Item,{key:e.category_id},a===n.state.path.length-1?e.category_id:o.createElement(c.Button,{onClick:t(e)},e.category_id))})))},n.renderEmbededView=function(e){var t=n.props.intl;return e.hasItems?o.createElement(u.default,{records:e.subItems}):o.createElement("div",null,t.formatMessage(d.default.noProduct))},n.state={catalogs:{items:[],selectedId:void 0,loading:!0},categories:{items:[],loading:!0},path:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.datamart;this.fetchCatalog(e.id)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.match.params.organisationId,a=t.datamart;n!==e.match.params.organisationId&&this.fetchCatalog(a.id)}},{key:"render",value:function(){var e=this,t=this.props,n=t.datamart,a=t.intl;return o.createElement("div",{style:{marginTop:40}},o.createElement(c.Card,{title:"",buttons:this.generateCatalogSelect()},o.createElement("hr",null),this.generateBreadcrumb(),o.createElement(p.Table,{columns:[{title:a.formatMessage(d.default.category),dataIndex:"category_id"},{render:function(e,t){return t.hasSubCategory?o.createElement("div",{className:"float-right"},o.createElement(c.McsIcon,{type:"chevron-right"})):null}}],onRow:function(t){return{onClick:function(){t.hasSubCategory&&e.setState({path:[].concat(b(e.state.path),[t]),categories:{loading:!0,items:e.state.categories.items}},(function(){e.state.catalogs.selectedId&&e.fetchSubCategories(n.id,e.state.catalogs.selectedId,t.category_id)}))}}},rowClassName:function(e){return e.hasSubCategory?"mcs-table-cursor":""},rowKey:"category_id",loading:this.state.catalogs.loading||this.state.categories.loading,dataSource:this.state.categories.items,expandedRowRender:this.renderEmbededView,pagination:{size:"small",showSizeChanger:!0,hideOnSinglePage:!0}})))}}]),t}(o.Component);_([(0,h.lazyInject)(y.TYPES.ILibraryCatalogService)],E.prototype,"_libraryCatalogService",void 0),t.default=(0,l.compose)(i.injectIntl,s.withRouter,m.default,g.injectDatamart)(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(8),l=n(6),c=n(846),u=(a=c)&&a.__esModule?a:{default:a};function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=function(e){function t(){d(this,t);var e=f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.expandedItemRowRender=function(e){var t=Object.assign(Object.assign({},e.properties),e.overriding_properties);return o.createElement(i.Row,{gutter:24},t.$image_link&&o.createElement(i.Col,{span:6},o.createElement("img",{src:t.$image_link,style:{width:"100%"}})),o.createElement(i.Col,{span:t.$image_link?18:24},o.createElement("div",null,o.createElement(i.Tag,null,"Item Id"),": ",o.createElement("code",null,e.item_id)),Object.keys(t).map((function(e){switch(e){case"$link":return o.createElement("div",{key:e},o.createElement(i.Tag,null,e),": ",o.createElement("a",{href:t[e],target:"_blank"},t[e]));default:return o.createElement("div",{key:e},o.createElement(i.Tag,null,e),": ",t[e])}}))))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props.intl;return o.createElement(i.Table,{columns:[{title:e.formatMessage(u.default.brand),render:function(e,t){return t.properties.$brand}},{title:e.formatMessage(u.default.title),render:function(e,t){return t.properties.$title}},{title:e.formatMessage(u.default.product_type),render:function(e,t){return t.properties.$product_type}}],dataSource:this.props.records,expandedRowRender:this.expandedItemRowRender,rowClassName:function(){return"mcs-table-cursor"},rowKey:"item_id",pagination:{size:"small",showSizeChanger:!0,hideOnSinglePage:!0}})}}]),t}(o.Component);t.default=(0,s.compose)(l.injectIntl)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(8),l=n(6),c=h(n(2500)),u=n(13),d=n(906),f=n(51),p=n(159),m=h(n(23)),g=n(12),y=n(15);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=(0,l.defineMessages)({editDealList:{id:"dealList.edit.actionbar.editDealList",defaultMessage:"Edit {name}"},dealList:{id:"dealList.edit.actionbar.breadCrumb.dealList",defaultMessage:"Deal List"},newDealList:{id:"dealList.edit.actionbar.newDealList.",defaultMessage:"New Deal List"},dealLists:{id:"dealList.edit.actionbar.breadCrumb.dealLists",defaultMessage:"Deal Lists"},dealListSaved:{id:"dealList.edit.save.successMessage",defaultMessage:"Deal List successfully saved."},savingInProgress:{id:"dealList.edit.savingInProgress",defaultMessage:"Saving in progress"}}),_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.save=function(e){var t=n.props,a=t.match.params,r=a.dealListId,o=a.organisationId,s=t.intl,l=t.notifyError,c=n.state.dealListFormData,u=i.message.loading(s.formatMessage(b.savingInProgress),0);n.setState({isLoading:!0}),n._dealListFormService.saveDealList(o,e,c,r).then((function(){u(),n.close(),i.message.success(s.formatMessage(b.dealListSaved))})).catch((function(e){n.setState({isLoading:!1}),l(e),u()}))},n.close=function(){var e=n.props,t=e.history,a="/v2/o/"+e.match.params.organisationId+"/library/deallist";return t.push(a)},n.state={dealListFormData:d.INITIAL_DEAL_LIST_FORM_DATA,isLoading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params,n=t.organisationId,a=t.dealListId;a?this._dealsListService.getDealList(n,a).then((function(e){return e.data})).then((function(t){e._dealsListService.getDeals(n,{deal_list_id:t.id}).then((function(n){return e.setState({isLoading:!1,dealListFormData:Object.assign(Object.assign({},t),{deals:n.data.map((function(e){return(0,p.createFieldArrayModel)(e)}))})})}))})):this.setState({isLoading:!1})}},{key:"render",value:function(){var e=this.props,t=e.intl,n=e.match.params,a=n.organisationId,r=n.dealListId,i=this.state,s=i.dealListFormData;if(i.isLoading)return o.createElement(f.Loading,{isFullScreen:!0});var l=r&&s?t.formatMessage(b.editDealList,{name:s.name?s.name:t.formatMessage(b.dealList)}):t.formatMessage(b.newDealList),u=[{name:t.formatMessage(b.dealLists),path:"/v2/o/"+a+"/library/deallist"},{name:l}];return o.createElement(c.default,{initialValues:this.state.dealListFormData,save:this.save,close:this.close,breadCrumbPaths:u})}}]),t}(o.Component);v([(0,y.lazyInject)(g.TYPES.IDealListService)],_.prototype,"_dealsListService",void 0),v([(0,y.lazyInject)(g.TYPES.IDealListFormService)],_.prototype,"_dealListFormService",void 0),t.default=(0,s.compose)(l.injectIntl,m.default,u.withRouter)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(8),s=n(35),l=n(6),c=p(n(60)),u=p(n(2501)),d=p(n(2502)),f=p(n(101));function p(e){return e&&e.__esModule?e:{default:e}}var m=o.Layout.Content,g=s.FieldArray,y="dealListForm",h=(0,l.defineMessages)({saveDealList:{id:"dealList.form.save.button",defaultMessage:"Save"},sectionTitleGeneral:{id:"dealList.form.sectionTitleGeneral",defaultMessage:"General Information"},sectionTitleKeywords:{id:"dealList.form.sectionTitleDeals",defaultMessage:"Deals"}}),v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.buildFormSections=function(){var e=[],t={id:"general",title:h.sectionTitleGeneral,component:r.createElement(u.default,null)},a={id:"deals",title:h.sectionTitleKeywords,component:r.createElement(g,{name:"deals",component:d.default,formChange:n.props.change,rerenderOnEveryChange:!0})};return e.push(t),e.push(a),e},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.save,i=e.close,l={formId:y,paths:t,message:h.saveDealList,onClose:i},u=this.buildFormSections(),d={items:u.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:y},p=u.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==u.length-1&&r.createElement("hr",null))}));return r.createElement(o.Layout,{className:"edit-layout"},r.createElement(c.default,l),r.createElement(o.Layout,{className:"ant-layout-has-sider"},r.createElement(f.default,d),r.createElement(s.Form,{className:"edit-layout ant-layout",onSubmit:n(a)},r.createElement("button",{type:"submit",style:{display:"none"}}),r.createElement(m,{id:y,className:"mcs-content-container mcs-form-container"},r.createElement("div",{className:"ad-group-form"},p)))))}}]),t}(r.Component);t.default=(0,i.compose)((0,s.reduxForm)({form:y,enableReinitialize:!0}))(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=d(n(49)),l=d(n(63)),c=n(24),u=n(13);function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=(0,i.defineMessages)({sectionSubtitleGeneral:{id:"edit.dealList.form.general.subtitle",defaultMessage:"Give your Deal List a name."},sectionTitleGeneral:{id:"edit.dealList.form.general.title",defaultMessage:"General Information"},labelDealListName:{id:"edit.dealList.general.infos.label.name",defaultMessage:"Deal List Name"},tooltipDealListName:{id:"edit.dealList.general.infos.tooltip.name",defaultMessage:"Give your Deal List a name so that you can find it back across the different screens!"}}),g=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage;return r.createElement("div",null,r.createElement(c.FormSection,{subtitle:m.sectionSubtitleGeneral,title:m.sectionTitleGeneral}),r.createElement(c.FormInputField,{name:"name",component:c.FormInput,validate:[t],formItemProps:{label:n(m.labelDealListName),required:!0},inputProps:{placeholder:n(m.labelDealListName)},helpToolTipProps:{title:n(m.tooltipDealListName)}}))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,s.default,l.default,u.withRouter)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(10),s=g(n(47)),l=n(8),c=g(n(49)),u=g(n(63)),d=n(24),f=n(61),p=g(n(2503)),m=n(183);function g(e){return e&&e.__esModule?e:{default:e}}var y=(0,o.defineMessages)({sectionSubtitleGeneral:{id:"edit.deal.list.form.deal.subtitle",defaultMessage:"This is the list of all Deals added to your Deal List. You can target or exclude it directly within an Ad Group."},sectionTitleGeneral:{id:"edit.deal.list.form.deal.title",defaultMessage:"Deal List"},addDeal:{id:"edit.deal.list.form.add.new",defaultMessage:"Add New Deal"},addNewDeal:{id:"edit.deal.list.form.add.new.text.button",defaultMessage:"Add"},emptyRecordTitle:{id:"edit.deal.list.no.placementDescriptor.title",defaultMessage:"Click on the pen to add a Deal to your Deal List"},formError:{id:"form.deal.descriptor.empty.select.message.error",defaultMessage:"Error: Empty fields are forbidden. Please select values."}}),h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateDeal=function(e,t){var a=n.props,r=a.fields,o=a.formChange,l=a.closeNextDrawer,c=a.intl,u=[];e?(t?r.getAll().forEach((function(n){n.key===t?u.push({key:t,model:e}):u.push(n)})):(u.push.apply(u,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(r.getAll())),u.push({key:(0,s.default)(),model:e})),o(r.name,u),l()):i.message.error(c.formatMessage(y.formError),5)},n.openDealForm=function(e){return function(){var t=n.props,a=t.openNextDrawer,r=t.closeNextDrawer,o=t.intl,i={additionalProps:{initialValues:e?e.model:{currency:"EUR"},onSave:function(t){return n.updateDeal(t,e&&e.key)},actionBarButtonText:o.formatMessage(y.addNewDeal),close:r}};a(p.default,i)}},n.getDealRecords=function(e){var t=n.props.fields,a=n.state,o=a.page,i=a.pageSize,l=1!==o?(o-1)*i:0,c=o*i;return(e||t.getAll()).slice(l,c).map((function(e,a){var o=n.openDealForm(e);return r.createElement(m.RecordElement,{key:(0,s.default)(),recordIconType:"display",record:e,title:function(e){return e.model.value},onEdit:o,onRemove:function(){var n=t.getAll().indexOf(e);t.remove(n)}})}))},n.onPaginationChange=function(e,t){var a=n.props.fields,r=1!==e?(e-1)*t:0,o=e*t;n.setState({page:e,pageSize:t});var i=a?a.getAll().slice(r,o):void 0;n.getDealRecords(i)},n.state={isModalOpen:!1,fileList:[],page:1,pageSize:10},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"renderFieldArray",value:function(){var e=this.props,t=e.intl;return 0===e.fields.length?r.createElement(m.EmptyRecords,{message:t.formatMessage(y.emptyRecordTitle)}):r.createElement(m.RelatedRecords,{emptyOption:{iconType:"users",message:t.formatMessage(y.emptyRecordTitle)}},this.getDealRecords())}},{key:"render",value:function(){var e=this.props.fields;return r.createElement("div",null,r.createElement(d.FormSection,{subtitle:y.sectionSubtitleGeneral,title:y.sectionTitleGeneral,dropdownItems:[{id:y.addDeal.id,message:y.addDeal,onClick:this.openDealForm()}]}),r.createElement("div",null,this.renderFieldArray()),r.createElement("br",null),e.getAll().length>=this.state.pageSize+1&&r.createElement(i.Pagination,{style:{float:"right"},onChange:this.onPaginationChange,defaultCurrent:1,pageSize:this.state.pageSize,total:e.length,current:this.state.page,size:"small"}))}}]),t}(r.Component);t.default=(0,l.compose)(o.injectIntl,c.default,u.default,f.injectDrawer)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(10),l=n(13),c=n(35),u=n(6),d=b(n(60)),f=b(n(101)),p=n(61),m=n(24),g=b(n(23)),y=n(51),h=n(12),v=n(15);function b(e){return e&&e.__esModule?e:{default:e}}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=s.Layout.Content,E=(0,u.defineMessages)({addDealDescriptor:{id:"deal.edit.addDeal",defaultMessage:"Add Deal"},editDeal:{id:"deal.edit.actionbar.editDeal",defaultMessage:"Edit {name}"},deals:{id:"deal.edit.actionbar.breadCrumb.deals",defaultMessage:"Deals"},newDealDescriptor:{id:"deal.edit.actionabar.newDeal",defaultMessage:"New Deal"},generalInfos:{id:"deal.edit.generalSection.title",defaultMessage:"General Information"},generalInfosSubtitle:{id:"deal.edit.generalSection.subtitle",defaultMessage:"Enter here your Deal information."},valueLabel:{id:"deal.edit.input.value.label",defaultMessage:"Value"},valuePlaceholder:{id:"deal.edit.input.value.placeholder",defaultMessage:"Deal Value"},valueTooltip:{id:"deal.edit.input.value.tooltip",defaultMessage:"This represent the value your provider has given to you."},adExchangeLabel:{id:"deal.edit.input.adExchange.label",defaultMessage:"Ad Exchange"},adExchangePlaceholder:{id:"deal.edit.input.adExchange.placeholder",defaultMessage:"Ad Exchange"},adExchangeTooltip:{id:"deal.edit.input.adExchange.tooltip",defaultMessage:"This represent the ad exchange your deal has been agreed upon."},displayNetworkLabel:{id:"deal.edit.input.displayNetwork.label",defaultMessage:"Display Network"},displayNetworkPlaceholder:{id:"deal.edit.input.displayNetwork.placeholder",defaultMessage:"Display Network"},displayNetworkTooltip:{id:"deal.edit.input.displayNetwork.tooltip",defaultMessage:"This represent the display network your deal has been agreed upon."},floorPriceLabel:{id:"deal.edit.input.floorPrice.label",defaultMessage:"Floor Price"},floorPricePlaceholder:{id:"deal.edit.input.floorPrice.placeholder",defaultMessage:"Floor Price"},floorPriceTooltip:{id:"deal.edit.input.floorPrice.tooltip",defaultMessage:"This is the floor price you have agreed with your provided in the currency agreed upon."},eur:{id:"deal.edit.eur",defaultMessage:"Euro"},usd:{id:"deal.edit.usd",defaultMessage:"US Dollars"},savingInProgress:{id:"deal.edit.savingInProgress",defaultMessage:"Saving in progress"}}),O=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchAdexchanges=function(e){return n._catalogService.getServices(e,{serviceType:["DISPLAY_CAMPAIGN.INVENTORY_ACCESS"]}).then((function(e){return e.data})).then((function(e){return n.setState({adex:{loading:!1,data:e.filter((function(e){return"inventory_access_ad_exchange"===e.type}))},displayNetwork:{loading:!1,data:e.filter((function(e){return"inventory_access_display_network"===e.type}))}})}))},n.state={adex:{loading:!0,data:[]},displayNetwork:{loading:!0,data:[]}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params.organisationId;this.fetchAdexchanges(e)}},{key:"render",value:function(){var e=this.props,t=e.intl,n=e.initialValues,a=e.handleSubmit,r=e.onSave,i=e.fieldValidators.isRequired;if(this.state.adex.loading||this.state.displayNetwork.loading)return o.createElement(y.Loading,{isFullScreen:!0});var l={formId:"dealForm",paths:[{name:n&&n.id?t.formatMessage(E.editDeal,{name:this.props.initialValues.value?this.props.initialValues.value:this.props.initialValues.id}):t.formatMessage(E.newDealDescriptor)}],message:E.addDealDescriptor,onClose:this.props.closeNextDrawer},u={items:[{sectionId:"general",title:E.generalInfos}],scrollId:"dealForm"};return o.createElement(s.Layout,{className:"edit-layout"},o.createElement(d.default,l),o.createElement(s.Layout,{className:"ant-layout-has-sider"},o.createElement(f.default,u),o.createElement(c.Form,{className:"edit-layout ant-layout",onSubmit:a(r)},o.createElement(S,{id:"dealForm",className:"mcs-content-container mcs-form-container"},o.createElement("div",{id:"general"},o.createElement(m.FormSection,{subtitle:E.generalInfosSubtitle,title:E.generalInfos}),o.createElement("div",null,o.createElement(m.FormInputField,{name:"value",component:m.FormInput,validate:[i],formItemProps:{label:t.formatMessage(E.valueLabel),required:!0},inputProps:{placeholder:t.formatMessage(E.valuePlaceholder)},helpToolTipProps:{title:t.formatMessage(E.valueTooltip)}})),o.createElement("div",null,o.createElement(m.FormSelectField,{name:"ad_exchange_id",component:m.DefaultSelect,validate:[i],options:this.state.adex.data.map((function(e){return{value:e.ad_exchange_id,title:e.name}})),formItemProps:{label:t.formatMessage(E.adExchangeLabel),required:!0},helpToolTipProps:{title:t.formatMessage(E.adExchangeTooltip)}})),o.createElement("div",null,o.createElement(m.FormSelectField,{name:"display_network_id",component:m.DefaultSelect,validate:[i],options:this.state.displayNetwork.data.map((function(e){return{value:e.display_network_id,title:e.name}})),formItemProps:{label:t.formatMessage(E.displayNetworkLabel),required:!0},helpToolTipProps:{title:t.formatMessage(E.displayNetworkTooltip)}})),o.createElement("div",null,o.createElement(m.FormInputField,{name:"floor_price",component:m.FormInput,validate:[i],formItemProps:{label:t.formatMessage(E.floorPriceLabel)},inputProps:{addonAfter:o.createElement(m.FormAddonSelectField,{name:"currency",component:m.AddonSelect,options:[{value:"EUR",title:t.formatMessage(E.eur)},{value:"USD",title:t.formatMessage(E.usd)}]}),placeholder:t.formatMessage(E.floorPricePlaceholder),style:{width:"100%"}},helpToolTipProps:{title:t.formatMessage(E.floorPriceTooltip)}})))))))}}]),t}(o.Component);_([(0,v.lazyInject)(h.TYPES.ICatalogService)],O.prototype,"_catalogService",void 0),t.default=(0,i.compose)(u.injectIntl,p.injectDrawer,m.withValidators,l.withRouter,g.default,(0,c.reduxForm)({form:"dealForm",enableReinitialize:!0}))(O)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(2505)),r=o(n(2506));function o(e){return e&&e.__esModule?e:{default:e}}t.default={actionBarComponent:a.default,contentComponent:r.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(13),l=n(33),c=n(6),u=n(8),d=n(11),f=n(1148),p=(a=f)&&a.__esModule?a:{default:a};function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e){function t(){return m(this,t),g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=[{name:(0,e.intl.formatMessage)(p.default.dealList),path:"/v2/o/"+t+"/library/deallist"}];return o.createElement(d.Actionbar,{paths:n},o.createElement(l.Link,{to:"/v2/o/"+t+"/library/deallist/create"},o.createElement(i.Button,{className:"mcs-primary",type:"primary"},o.createElement(d.McsIcon,{type:"plus"})," ",o.createElement(c.FormattedMessage,p.default.newDealList))))}}]),t}(o.Component);t.default=(0,u.compose)(c.injectIntl,s.withRouter)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(33),c=n(10),u=n(6),d=b(n(126)),f=n(44),p=n(30),m=b(n(1148)),g=b(n(23)),y=n(15),h=n(12),v=n(41);function b(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O={loading:!1,data:[],total:0},w=function(e){function t(){_(this,t);var e=S(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state=O,e.archiveDealList=function(t){var n=e.props,a=n.match.params.organisationId,r=n.notifyError;return e.setState({loading:!0}),e._dealsListService.deleteDealList(a,t).then((function(t){return e.fetchDealList(a,{currentPage:1,pageSize:10})})).catch((function(e){return r(e)}))},e.fetchDealList=function(t,n){e.setState({loading:!0},(function(){var a=Object.assign({},(0,f.getPaginatedApiParam)(n.currentPage,n.pageSize));e._dealsListService.getDealLists(t,a).then((function(t){e.setState({loading:!1,data:t.data,total:t.total||t.count})}))}))},e.onClickArchive=function(t){var n=e.props,a=n.location,r=a.search,i=a.pathname,s=a.state,l=n.history,u=n.match.params.organisationId,d=n.intl.formatMessage,f=e.state.data,g=(0,p.parseSearch)(r,p.PAGINATION_SEARCH_SETTINGS);c.Modal.confirm({icon:o.createElement(v.ExclamationCircleOutlined,null),title:d(m.default.dealListArchiveTitle),content:d(m.default.dealListArchiveMessage),okText:d(m.default.dealListArchiveOk),cancelText:d(m.default.dealListArchiveCancel),onOk:function(){e.archiveDealList(t.id).then((function(){if(1===f.length&&1!==g.currentPage){var t=Object.assign(Object.assign({},g),{currentPage:g.currentPage-1});return l.replace({pathname:i,search:(0,p.updateSearch)(r,t),state:s}),Promise.resolve()}return e.fetchDealList(u,g)}))},onCancel:function(){}})},e.onClickEdit=function(t){e.props.history.push("deallist/"+t.id+"/edit")},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=[{key:"action",actions:function(){return[{intlMessage:m.default.edit,callback:e.onClickEdit},{intlMessage:m.default.archive,callback:e.onClickArchive}]}}],n=[{intlMessage:m.default.name,key:"name",isHideable:!1,render:function(e,t){return o.createElement(l.Link,{className:"mcs-campaigns-link",to:"deallist/"+t.id+"/edit"},e)}}],a={iconType:"library",message:this.props.intl.formatMessage(m.default.empty)};return o.createElement(d.default,{fetchList:this.fetchDealList,dataSource:this.state.data,loading:this.state.loading,total:this.state.total,columns:n,actionsColumnsDefinition:t,pageSettings:p.PAGINATION_SEARCH_SETTINGS,emptyTable:a})}}]),t}(o.Component);E([(0,y.lazyInject)(h.TYPES.IDealListService)],w.prototype,"_dealsListService",void 0),t.default=(0,i.compose)(s.withRouter,u.injectIntl,g.default)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=b(n(0)),i=b(n(17)),s=v(n(139)),l=n(6),c=n(25),u=n(13),d=n(8),f=n(65),p=v(n(1130)),m=n(12),g=n(15),y=v(n(2508)),h=n(10);function v(e){return e&&e.__esModule?e:{default:e}}function b(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=(0,l.defineMessages)({queryBuilder:{id:"datastudio.queryTool.edit.actionbar.title",defaultMessage:"Query Tool"},noMoreSupported:{id:"datastudio.queryTool.edit.legacyComponent.noMoreSupported",defaultMessage:"The query language related to this datamart is no more supported. Please select another datamart or create a new resource based on another datamart."}}),w=function(e){function t(){_(this,t);var e=S(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.getSelectedDatamart=function(){var t=e.props,n=t.connectedUser,a=t.location,r=void 0,o=n.workspaces.find((function(t){return t.organisation_id===e.props.match.params.organisationId})),i=s.default.parse(a.search).datamartId;return o.datamarts&&1===o.datamarts.length&&(r=o.datamarts[0]),i&&(r=o.datamarts.find((function(e){return e.id===i}))),r},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.intl,a=t.location,r=t.history,i=t.match,l=this.getSelectedDatamart();return o.createElement("div",{style:{height:"100%",display:"flex"}},!l&&o.createElement(f.DatamartSelector,{onSelect:function(e){r.push({pathname:a.pathname,search:s.default.stringify({datamartId:e.id})})},actionbarProps:{paths:[{name:n.formatMessage(O.queryBuilder)}]},isMainlayout:!0}),l&&"v201709"===l.storage_model_version&&o.createElement(y.default,{renderActionBar:function(t,a){return o.createElement(p.default,{saveAsUserQuery:function(n){return e._queryService.createQuery(a,{query_language:"OTQL",query_text:t}).then((function(e){return e.data})).then((function(t){var o=n.name,s=n.technical_name,l=n.persisted,c={datamart_id:a,type:"USER_QUERY",name:o,technical_name:s,persisted:l,default_ttl:M(n),query_id:t.id};return e._audienceSegmentService.saveSegment(i.params.organisationId,c).then((function(e){r.push("/v2/o/"+i.params.organisationId+"/audience/segments/"+e.data.id)}))}))},saveAsExort:function(n){return e._queryService.createQuery(a,{datamart_id:a,query_language:"OTQL",query_text:t}).then((function(t){return e._exportService.createExport(i.params.organisationId,{name:n.name,output_format:n.outputFormat,query_id:t.data.id,type:"QUERY"}).then((function(e){r.push("/v2/o/"+i.params.organisationId+"/datastudio/exports/"+e.data.id)}))}))},csvExportDisabled:!0,breadcrumb:[{name:n.formatMessage(O.queryBuilder)}]})},datamartId:l.id}),l&&"v201506"===l.storage_model_version&&o.createElement(h.Alert,{message:n.formatMessage(O.noMoreSupported),type:"warning"}))}}]),t}(o.Component);function M(e){if(e.defaultLifetime&&e.defaultLifetimeUnit)return i.duration(Number(e.defaultLifetime),e.defaultLifetimeUnit).asMilliseconds()}E([(0,g.lazyInject)(m.TYPES.IAudienceSegmentService)],w.prototype,"_audienceSegmentService",void 0),E([(0,g.lazyInject)(m.TYPES.IQueryService)],w.prototype,"_queryService",void 0),E([(0,g.lazyInject)(m.TYPES.IExportService)],w.prototype,"_exportService",void 0),t.default=(0,d.compose)(l.injectIntl,u.withRouter,(0,c.connect)((function(e){return{connectedUser:e.session.connectedUser}})))(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=p(n(2509)),i=p(n(1150)),s=n(10),l=n(24),c=n(11),u=n(6),d=n(8),f=n(73);function p(e){return e&&e.__esModule?e:{default:e}}var m=(0,u.defineMessages)({title:{id:"queryselector.title",defaultMessage:"Query Language"},subTitle:{id:"queryselector.subtitle",defaultMessage:"Choose your Query Language"}}),g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onSelect=function(e){return function(){n.setState({queryLanguage:e})}},n.state={queryLanguage:e.hasFeature("datamart-graphql")?void 0:"OTQL"},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.state.queryLanguage;if(e)switch(e){case"GRAPHQL":return r.createElement(o.default,this.props);case"OTQL":return r.createElement(i.default,this.props)}return r.createElement(s.Layout,null,r.createElement(s.Layout.Content,{className:"mcs-content-container mcs-form-container text-center"},r.createElement(l.FormTitle,{title:m.title,subtitle:m.subTitle}),r.createElement(s.Row,{className:"mcs-selector_container"},r.createElement(s.Row,{className:"menu"},r.createElement(c.MenuList,{title:"OTQL",select:this.onSelect("OTQL")}),r.createElement(c.MenuList,{title:"GraphQL",select:this.onSelect("GRAPHQL")})))))}}]),t}(r.Component);t.default=(0,d.compose)(f.injectFeatures)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(13),l=n(8),c=n(6),u=n(44),d=n(11),f=_(n(23)),p=_(n(2510)),m=_(n(2511)),g=_(n(821)),y=n(127),h=n(51),v=n(15),b=n(12);function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=i.Layout.Content,O=i.Layout.Sider,w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchObjectTypes=function(e){return n.setState({schemaLoading:!0}),n._runtimeSchemaService.getRuntimeSchemas(e).then((function(t){var a=t.data.find((function(e){return"LIVE"===e.status}));return a?n._runtimeSchemaService.getObjectTypeInfoResources(e,a.id).then((function(e){return n.setState({rawSchema:e,schemaLoading:!1}),e})):[]}))},n.runQuery=function(e){var t=n.props.datamartId;n.setState({runningQuery:!0,error:null,queryAborted:!1,queryResult:null}),n.asyncQuery=(0,u.makeCancelable)(n._queryService.runGraphQLQuery(t,e)),n.asyncQuery.promise.then((function(e){n.setState({runningQuery:!1,queryResult:e.data})})).catch((function(e){n.setState({error:e.isCanceled?null:e,runningQuery:!1})}))},n.abortQuery=function(){n.asyncQuery.cancel(),n.setState({queryAborted:!0,runningQuery:!1})},n.dismissError=function(){return n.setState({error:null})},n.state={queryResult:null,runningQuery:!1,queryAborted:!1,error:null,query:'query { fetchUserPoint(user_point_id:"") { creation_date } }',schemaVizOpen:!0,schemaLoading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.datamartId;this.fetchObjectTypes(e)}},{key:"componentDidUpdate",value:function(e){var t=this.props.datamartId;e.datamartId!==t&&this.fetchObjectTypes(t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.intl,a=t.datamartId,r=this.state,s=r.error,l=r.queryResult,u=r.runningQuery,f=r.queryAborted,v=r.schemaVizOpen,b=r.schemaLoading,_=r.rawSchema,S=r.query;if(b)return o.createElement(h.Loading,{isFullScreen:!0});var w=s&&o.createElement(i.Alert,{message:"Error",style:{marginBottom:40},description:s.error_id?o.createElement("span",null,s.error,o.createElement("br",null),o.createElement("code",null,s.error_id)):n.formatMessage(M.queryErrorDefaultMsg),type:"error",showIcon:!0,closable:!0,onClose:this.dismissError}),P=(u||f||l)&&o.createElement(p.default,{loading:u,result:l,aborted:f});return o.createElement(i.Layout,null,this.props.renderActionBar(this.state.query,a),o.createElement(i.Layout,null,o.createElement(i.Layout,null,o.createElement(E,{className:"mcs-content-container"},o.createElement(d.ContentHeader,{title:o.createElement(c.FormattedMessage,{id:"queryTool.query-tool-page-title",defaultMessage:"Query Tool"})}),w,o.createElement(m.default,{onRunQuery:this.runQuery,onAbortQuery:this.abortQuery,runningQuery:u,datamartId:a,onQueryChange:function(t){return e.setState({query:t})},defaultValue:S}),P)),o.createElement(O,{width:v?250:0},o.createElement("div",{className:"schema-visualizer"},o.createElement(g.default,{schema:_?(0,y.computeFinalSchemaItem)(_,"UserPoint",!1,!1,!1):void 0,disableDragAndDrop:!0})))))}}]),t}(o.Component);S([(0,v.lazyInject)(b.TYPES.IQueryService)],w.prototype,"_queryService",void 0),S([(0,v.lazyInject)(b.TYPES.IRuntimeSchemaService)],w.prototype,"_runtimeSchemaService",void 0),t.default=(0,l.compose)(c.injectIntl,s.withRouter,f.default)(w);var M=(0,c.defineMessages)({queryToolBreadcrumbLabel:{id:"query-tool.action-bar.breadcrumb.label.query-tool.graphql",defaultMessage:"Query Tool"},queryErrorDefaultMsg:{id:"query-tool.error.graphql.default-message",defaultMessage:"An error occured"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(6),l=n(11),c=n(69),u=(a=c)&&a.__esModule?a:{default:a},d=n(8);function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.result,n=e.loading,a=e.aborted,r=e.colors,c=void 0;return c=n?o.createElement("div",{className:"text-center"},o.createElement(i.Spin,{size:"large"})):a?o.createElement("div",{className:"text-center"},o.createElement(s.FormattedMessage,{id:"queryTool.otql-result-renderer-aborted",defaultMessage:"Aborted..."})):t?o.createElement("div",null,o.createElement("pre",null,JSON.stringify(t.data,null,2))):o.createElement("div",{className:"text-center"},o.createElement(s.FormattedMessage,{id:"queryTool.otql-result-renderer-empty",defaultMessage:"Empty Result"})),o.createElement(l.Card,{title:o.createElement(s.FormattedMessage,{id:"queryTool.otql-result-renderer-card-title",defaultMessage:"Result"}),buttons:t?o.createElement(o.Fragment,null,o.createElement(i.Tag,{color:r["mcs-info"]},o.createElement(s.FormattedMessage,{id:"otql-result-renderer-card-subtitle-duration",defaultMessage:"Took {duration}ms",values:{duration:t.took}})),t.cache_hit&&o.createElement(i.Tag,{color:r["mcs-success"]},o.createElement(s.FormattedMessage,{id:"otql-result-renderer-card-subtitle-cache",defaultMessage:"From Cache"}))):void 0},c)}}]),t}(o.Component);t.default=(0,d.compose)(u.default)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(6),l=n(11),c=n(270),u=(a=c)&&a.__esModule?a:{default:a};var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateQuery=function(e){n.setState({query:e}),n.props.onQueryChange(e)},n.clearQuery=function(){return n.setState({query:""})},n.validateQuery=function(){var e=n.state.query;return e&&-1!==e.toLowerCase().indexOf("select")&&-1!==e.toLowerCase().indexOf("from")},n.buildEditorActions=function(){var e=n.props,t=e.onRunQuery,a=e.onAbortQuery,r=e.runningQuery,l=n.state.query,c=o.createElement(i.Button,{onClick:n.clearQuery},o.createElement(s.FormattedMessage,{id:"queryTool.otql.edit.clear.label",defaultMessage:"Clear Query"})),u=o.createElement(i.Button,{type:"primary",className:"m-l-10",onClick:a},o.createElement(s.FormattedMessage,{id:"queryTool.otql.edit.abort.label",defaultMessage:"Abort Query"})),d=o.createElement(i.Button,{type:"primary",className:"m-l-10",disabled:!l,onClick:function(){return t(l)}},o.createElement(s.FormattedMessage,{id:"queryTool.otql.edit.run.label",defaultMessage:"Run Query"}));return o.createElement("div",null,l&&c,r?u:d)},n.showModal=function(){n.setState({visible:!0})},n.handleOk=function(){n.setState({visible:!1})},n.state={query:"",visible:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.state.query,t=this.props.defaultValue;return o.createElement(l.Card,{title:o.createElement(s.FormattedMessage,{id:"queryTool.graphql.card.title",defaultMessage:"GraphQL Query"}),buttons:this.buildEditorActions()},o.createElement("div",null,o.createElement(u.default,{value:e,showPrintMargin:!1,height:"250px",enableBasicAutocompletion:!0,enableLiveAutocompletion:!1,defaultValue:t,onChange:this.updateQuery,mode:"otql",theme:"otql",width:"100%",setOptions:{showGutter:!0}})))}}]),t}(o.Component);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(6),s=p(n(1151)),l=n(138),c=n(11),u=p(n(2514)),d=p(n(69)),f=n(8);function p(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e){function t(){return m(this,t),g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.result,n=e.loading,a=e.aborted,d=e.colors,f=void 0;if(n)f=r.createElement("div",{className:"text-center"},r.createElement(o.Spin,{size:"large"}));else if(a)f=r.createElement("div",{className:"text-center"},r.createElement(i.FormattedMessage,{id:"queryTool.otql-result-renderer-aborted",defaultMessage:"Aborted..."}));else if(t&&(0,l.isCountResult)(t.rows)){var p=t.rows[0].count;f=r.createElement("div",{className:"text-center",style:{fontSize:"5em"}},r.createElement(s.default,{start:0,end:p,separator:",",decimal:".",duration:.5}))}else if(t&&(0,l.isAggregateResult)(t.rows)){var m=t.rows[0].aggregations;f=r.createElement("div",null,r.createElement(u.default,{rootAggregations:m}))}else f=t?r.createElement("div",null,r.createElement("pre",null,JSON.stringify(t.rows,null,2))):r.createElement("div",{className:"text-center"},r.createElement(i.FormattedMessage,{id:"queryTool.otql-result-renderer-empty",defaultMessage:"Empty Result"}));return r.createElement(c.Card,{title:r.createElement(i.FormattedMessage,{id:"queryTool.otql-result-renderer-card-title",defaultMessage:"Result"}),buttons:t?r.createElement(r.Fragment,null,r.createElement(o.Tag,{color:d["mcs-info"]},r.createElement(i.FormattedMessage,{id:"otql-result-renderer-card-subtitle-duration",defaultMessage:"Took {duration}ms",values:{duration:t.took}})),t.cache_hit&&r.createElement(o.Tag,{color:d["mcs-success"]},r.createElement(i.FormattedMessage,{id:"otql-result-renderer-card-subtitle-cache",defaultMessage:"From Cache"}))):void 0},f)}}]),t}(r.Component);t.default=(0,f.compose)(d.default)(y)},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(41),i=n(10),s=n(11),l=n(6);function c(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getDefaultView=function(e){return e.buckets.length>0?"0":"metrics"},n.getMetrics=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 0===e.length?null:r.createElement(i.Table,{columns:[{title:"Name",dataIndex:"name"},{title:"Value",dataIndex:"value"}],dataSource:e,pagination:{size:"small",showSizeChanger:!0,hideOnSinglePage:!0}})},n.getBuckets=function(e){if(0===e.buckets.length)return r.createElement(l.FormattedMessage,{id:"queryTool.otql-result-renderer-aggrations-no-result",defaultMessage:"No Result"});var t=function(e){return!(!e.aggregations||!(e.aggregations.buckets.find((function(e){return e.buckets.length>0}))||e.aggregations.metrics.length>0))};return r.createElement(i.Table,{columns:[{title:"Key",dataIndex:"key",sorter:function(e,t){return e.key.length-t.key.length}},{title:"Count",dataIndex:"count",sorter:function(e,t){return e.count-t.count}},{render:function(e,n){return t(n)?r.createElement("div",{className:"float-right"},r.createElement(s.McsIcon,{type:"chevron-right"})):null}}],onRow:function(a){return{onClick:function(){return function(a){if(a.aggregations&&t(a)){var r=a.aggregations;n.setState((function(t){return{aggregationsPath:[].concat(c(t.aggregationsPath),[{aggregationBucket:e,bucket:a}]),selectedView:n.getDefaultView(r)}}))}}(a)}}},rowClassName:function(e){return t(e)?"mcs-table-cursor":""},dataSource:e.buckets,pagination:{size:"small",showSizeChanger:!0,hideOnSinglePage:!0}})},n.findAggregations=function(e,t){if(0===t.length)return e;var a,r=(a=t,Array.isArray(a)?a:Array.from(a)),o=r[0],i=r.slice(1),s=e.buckets.find((function(e){return e.name===o.aggregationBucket.name}));if(s){var l=s.buckets.find((function(e){return e.key===o.bucket.key}));return l&&l.aggregations?n.findAggregations(l.aggregations,i):null}return null},n.getBreadcrumb=function(e){var t=n.state.aggregationsPath;if(0===t.length)return null;return r.createElement(i.Breadcrumb,{style:{marginBottom:14}},r.createElement(i.Breadcrumb.Item,null,r.createElement(s.Button,{onClick:function(){return n.setState({aggregationsPath:[],selectedView:n.getDefaultView(e)})}},r.createElement(o.HomeOutlined,null))),t.map((function(e,a){var o=a===t.length-1,l=e.aggregationBucket.fieldName+" @"+e.aggregationBucket.type+" { "+e.bucket.key+" }";return r.createElement(i.Breadcrumb.Item,{key:a},o?l:r.createElement(s.Button,{onClick:function(){n.setState({aggregationsPath:t.slice(0,a+1),selectedView:n.getDefaultView(e.bucket.aggregations)})}},l))})))},n.state={aggregationsPath:[],selectedView:n.getDefaultView(e.rootAggregations)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props.rootAggregations,n=this.state,a=n.aggregationsPath,o=n.selectedView,s=this.findAggregations(t,a),c=null;c="metrics"===o?this.getMetrics(s.metrics):this.getBuckets(s.buckets[parseInt(o,0)]);var u=s.buckets.length>0&&s.metrics.length>0||s.buckets.length>1;return r.createElement("div",null,this.getBreadcrumb(s),r.createElement(i.Row,{style:{marginBottom:14}},u&&r.createElement("div",null,r.createElement("div",{className:"m-r-10",style:{display:"inline-block"}},r.createElement(l.FormattedMessage,{id:"queryTool.otql-result-renderer-aggrations-viewing",defaultMessage:"Viewing :"})),r.createElement(i.Select,{value:o,onSelect:function(t){return e.setState({selectedView:t})},style:{width:150}},s.buckets.length>0&&r.createElement(i.Select.OptGroup,{label:"Buckets"},s.buckets.map((function(e,t){return r.createElement(i.Select.Option,{key:t.toString(),value:t.toString()},e.fieldName+" @"+e.type)}))),s.metrics.length>0&&r.createElement(i.Select.Option,{value:"metrics"},"Metrics")))),r.createElement(i.Row,null,c))}}]),t}(r.Component);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(6),s=n(11),l=n(51);var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateQuery=function(e){n.setState({query:e}),n.props.onQueryChange(e)},n.clearQuery=function(){return n.setState({query:""})},n.validateQuery=function(){var e=n.state.query;return e&&-1!==e.toLowerCase().indexOf("select")&&-1!==e.toLowerCase().indexOf("from")},n.buildEditorActions=function(){var e=n.props,t=e.onRunQuery,a=e.onAbortQuery,l=e.runningQuery,c=n.state.query,u=r.createElement(o.Button,{onClick:n.clearQuery},r.createElement(i.FormattedMessage,{id:"queryTool.otql.edit.clear.label",defaultMessage:"Clear Query"})),d=r.createElement(o.Button,{type:"primary",className:"m-l-10",onClick:a},r.createElement(i.FormattedMessage,{id:"queryTool.otql.edit.abort.label",defaultMessage:"Abort Query"})),f=r.createElement(o.Button,{type:"primary",className:"m-l-10",disabled:!c,onClick:function(){return t(c)}},r.createElement(i.FormattedMessage,{id:"queryTool.otql.edit.run.label",defaultMessage:"Run Query"})),p=r.createElement("a",{className:"m-l-10",onClick:n.showModal},r.createElement(s.McsIcon,{type:"gears"}));return r.createElement("div",null,c&&u,l?d:f,p)},n.showModal=function(){n.setState({visible:!0})},n.handleOk=function(){n.setState({visible:!1})},n.state={query:e.defaultValue||"",visible:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.state.query,t=this.props,n=t.datamartId,a=t.useCache,c=t.evaluateGraphQl,u=t.precision,d=t.handleChange,f=t.queryEditorClassName;return r.createElement(s.Card,{title:r.createElement(i.FormattedMessage,{id:"queryTool.otql.card.title",defaultMessage:"OTQL Query"}),buttons:this.buildEditorActions()},r.createElement(o.Modal,{title:"Query Settings",visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleOk,footer:[r.createElement(o.Button,{key:1,onClick:this.handleOk},"Ok")]},r.createElement("div",{style:{marginBottom:10}},r.createElement(i.FormattedMessage,{id:"queryTool.otql.modal.evaluate.graphql",defaultMessage:"Evaluate SELECT clause in GraphQL"}),": ",r.createElement(o.Switch,{checked:c,onChange:function(e){return d(e,a,u)}})),r.createElement("div",{style:{marginBottom:10}},r.createElement(i.FormattedMessage,{id:"queryTool.otql.modal.use.cache",defaultMessage:"Use Cache"}),": ",r.createElement(o.Switch,{checked:a,onChange:function(e){return d(c,e,u)}})),r.createElement("div",null,r.createElement(o.Select,{value:u,style:{width:"100%"},onChange:function(e){return d(c,a,e)}},r.createElement(o.Select.Option,{value:"FULL_PRECISION"},r.createElement(i.FormattedMessage,{id:"queryTool.otql.modal.full.precision",defaultMessage:"Full Precision"})),r.createElement(o.Select.Option,{value:"MEDIUM_PRECISION"},r.createElement(i.FormattedMessage,{id:"queryTool.otql.modal.medium.precision",defaultMessage:"Medium Precision"})),r.createElement(o.Select.Option,{value:"LOWER_PRECISION"},r.createElement(i.FormattedMessage,{id:"queryTool.otql.modal.low.precision",defaultMessage:"Low Precision"}))))),r.createElement(l.OtqlConsole,{onChange:this.updateQuery,datamartId:n,value:e,showPrintMargin:!1,height:"250px",enableBasicAutocompletion:!0,enableLiveAutocompletion:!1,className:f||""}))}}]),t}(r.Component);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReportCreationEditor=t.CreateReportPage=void 0;var a=o(n(2517)),r=o(n(1152));function o(e){return e&&e.__esModule?e:{default:e}}t.CreateReportPage=a.default,t.ReportCreationEditor=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(33),l=n(1152),c=(a=l)&&a.__esModule?a:{default:a};function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e){function t(){return u(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props.match.params.organisationId;return o.createElement(c.default,{organisationId:e})}}]),t}(o.Component);t.default=(0,i.compose)(s.withRouter)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(35),i=n(6),s=n(10),l=d(n(1154)),c=d(n(1153)),u=n(11);function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=o.Field,g=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fields,n=e.intl,a=e.leftOptionsProps,o=t.map((function(e,o,i){var s=function(){return t.remove(o)};return r.createElement("div",{key:o},r.createElement(m,{name:""+e,component:c.default,renderFieldAction:function(){return r.createElement("div",{onClick:s},r.createElement(u.McsIcon,{type:"close"}))},formItemProps:{colon:!1},leftFormSelectProps:{placeholder:n.formatMessage(l.default.reportSectionDetailedFilterLeftSelectPlaceholder)},leftOptionsProps:a}))}));return r.createElement("div",null,r.createElement(s.Row,null,r.createElement(s.Col,{span:24,offset:3},o)),r.createElement(s.Row,null,r.createElement(s.Col,{span:15,offset:4},r.createElement("div",{onClick:function(){return t.push({leftValue:"",rightValue:""})}},r.createElement(s.Col,{span:20,className:"report-AddFilterButton"},r.createElement("p",null,r.createElement(u.McsIcon,{type:"plus"}),n.formatMessage(l.default.AddFilterButtonText)))))))}}]),t}(r.Component);t.default=(0,i.injectIntl)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(81)),r=s(n(78)),o=s(n(142)),i=n(56);function s(e){return e&&e.__esModule?e:{default:e}}var l={filterToObject:function(e){return{name:e.leftValue,value:e.rightValue}},prepareRequest:function(e,t){var n=e.type,r=e.dimensions,o=e.metrics,i=new a.default(e.duration.startDate.toDate()),s=new a.default(e.duration.endDate.toDate()),c=e.additionalFilters,u=[];e.filter&&u.push(l.filterToObject(e.filter));var d=!0,f=!1,p=void 0;try{for(var m,g=(c||[])[Symbol.iterator]();!(d=(m=g.next()).done);d=!0){var y=m.value;u.push(l.filterToObject(y))}}catch(e){f=!0,p=e}finally{try{!d&&g.return&&g.return()}finally{if(f)throw p}}return t&&u.push({name:"limit",value:10}),{reportType:n,dimensions:r,metrics:o,durationStartDate:i,durationEndDate:s,filters:u}},askRequest:function(e,t){var n=t.reportType,a=t.dimensions,o=t.metrics,i=t.durationStartDate,s=t.durationEndDate,l=t.filters;switch(n){case"display_campaign_performance_report":return r.default.getDisplayCampaignPerformanceReport(e,i,s,a,o,l);case"email_delivery_report":return r.default.getEmailDeliveryReport(e,i,s,a,o,l);case"conversion_performance_report":return r.default.getConversionPerformanceReport(e,i,s,a,o,l);case"audience_segment_report":return r.default.getAudienceSegmentReport(e,i,s,a,o,l);case"conversion_attribution_performance":return r.default.getConversionAttributionPerformance(e,i,s,[],a,o,l);default:return Promise.reject(new Error("Unsupported report type"))}},exportReport:function(e,t){var n=l.prepareRequest(e,!1);return l.askRequest(t,n).then((function(e){var t={data:[e.data.report_view.columns_headers].concat(e.data.report_view.rows),name:"test"};return o.default.exportData([t],"test","xlsx"),"Done"}))},preview:function(e,t){var n=l.prepareRequest(e,!0);return l.askRequest(t,n).then((function(e){var t=e.data.report_view.columns_headers.map((function(e){return{intlMessage:{id:e,defaultMessage:e},key:e}})),n=0===e.data.report_view.total_items,a=(0,i.normalizeReportView)(e.data.report_view);return a.length>10&&(a=a.slice(0,10)),{noPreviewValues:n,dataSource:a,columns:t}}))}};t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeOptions=[{title:"Display Campaign Performance Report",value:"display_campaign_performance_report"},{title:"Email Delivery Report",value:"email_delivery_report"},{title:"Conversion Performance Report",value:"conversion_performance_report"},{title:"Audience Segment Report",value:"audience_segment_report"},{title:"Conversion Attribution Performance",value:"conversion_attribution_performance"}];var a=t.linkedSelectOptions=[{label:"Delivery ID",value:"delivery_id"},{label:"Channel",value:"channel"},{label:"Scenario ID",value:"scenario_id"},{label:"Campaign ID",value:"campaign_id"},{label:"Campaign Type",value:"campaign_type"},{label:"Sub campaign ID",value:"sub_campaign_id"},{label:"Ad group ID",value:"ad_group_id"},{label:"Message ID",value:"message_id"},{label:"Ad ID",value:"ad_id"},{label:"Creative ID",value:"creative_id"},{label:"Format",value:"format"},{label:"Media ID",value:"media_id"},{label:"Placement ID",value:"placement_id"},{label:"Display network ID",value:"display_network_id"},{label:"Publisher ID",value:"publisher_id"},{label:"Ad slot visibility",value:"ad_slot_visibility"},{label:"Context",value:"context"},{label:"User point ID",value:"user_point_id"},{label:"Vector ID",value:"vector_id"},{label:"Email hash",value:"email_hash"},{label:"Form factor",value:"form_factor"},{label:"OS",value:"os"},{label:"Browser",value:"browser"},{label:"Country",value:"country"},{label:"Admin1",value:"admin1"},{label:"Admin2",value:"admin2"},{label:"Targeted segments",value:"targeted_segments"},{label:"Exposed segments",value:"exposed_segments"}];t.availableDimensions=[{label:"Year",value:"year"},{label:"Month",value:"month"},{label:"Day of month",value:"day_of_month"},{label:"Hour",value:"hour"},{label:"Minute",value:"minute"},{label:"Second",value:"second"},{label:"Day",value:"day"}].concat(a),t.selectPropsMetrics={options:[{label:"Count all",value:"count_all"},{label:"Avg duration",value:"avg_duration"},{label:"Min duration",value:"min_duration"},{label:"Max duration",value:"max_duration"},{label:"Delivered",value:"delivered"},{label:"Impressions",value:"impressions"},{label:"Clicks",value:"clicks"},{label:"Impressions cost",value:"impressions_cost"},{label:"Inventory cost",value:"inventory_cost"},{label:"Targeting cost",value:"targeting_cost"},{label:"Technical cost",value:"technical_cost"},{label:"Click price",value:"click_price"},{label:"Engagement duration sec",value:"engagement_duration_sec"},{label:"Engagement price",value:"engagement_price"},{label:"Email sent",value:"email_sent"},{label:"Email unsubscribed",value:"email_unsubscribed"},{label:"Email hard bounced",value:"email_hard_bounced"},{label:"Email soft bounced",value:"email_soft_bounced"},{label:"Email complaints",value:"email_complaints"},{label:"Uniq impressions",value:"uniq_impressions"},{label:"Uniq clicks",value:"uniq_clicks"},{label:"Uniq email sent",value:"uniq_email_sent"},{label:"Uniq email unsubscribed",value:"uniq_email_unsubscribed"},{label:"Uniq email hard bounced",value:"uniq_email_hard_bounced"},{label:"Uniq email soft bounced",value:"uniq_email_soft_bounced"},{label:"Uniq email complaints",value:"uniq_email_complaints"},{label:"CPM",value:"cpm"},{label:"CPC",value:"cpc"},{label:"CTR",value:"ctr"},{label:"Losing bids",value:"losing_bids"},{label:"Winning bid price",value:"winning_bid_price"},{label:"Avg winning bid price",value:"avg_winning_bid_price"}]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(13),l=n(10),c=n(8),u=O(n(17)),d=O(n(2522)),f=n(11),p=O(n(2523)),m=O(n(335)),g=O(n(59)),y=O(n(261)),h=n(30),v=O(n(1155)),b=n(15),_=n(12),S=n(340),E=n(44);function O(e){return e&&e.__esModule?e:{default:e}}var w=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=l.Layout.Content,P=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchLoop=window.setInterval((function(){var e=n.props.match.params.exportId;!n.state.exportExecutions.items[0]||"PENDING"!==n.state.exportExecutions.items[0].status&&"RUNNING"!==n.state.exportExecutions.items[0].status||n.fetchExportExecution(e)}),5e3),n.fetchExportExecution=function(e){var t=n.props.location.search,a=(0,h.parseSearch)(t,h.PAGINATION_SEARCH_SETTINGS),r=n._exportService.getExport(e).then((function(e){return e.data})).then((function(e){return n.setState({exportObject:{item:e,isLoading:!1}})})).catch((function(e){return g.default.error(e)})),o=n._exportService.getExportExecutions(e,(0,E.getPaginatedApiParam)(a.currentPage,a.pageSize)).then((function(e){return n.setState({exportExecutions:{items:e.data,isLoading:!1,total:e.total?e.total:e.count}})})).catch((function(e){return g.default.error(e)}));return Promise.all([r,o])},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,h.updateSearch)(o,e,h.PAGINATION_SEARCH_SETTINGS)};a.push(i)},n.downloadFile=function(e){return function(t){var a=n.props.intl.formatMessage;"RUNNING"===e.status||"PENDING"===e.status?l.message.error(a(v.default.exportRunning)):"FAILED"===e.status?l.message.error(a(v.default.exportFailed)):"SUCCEEDED"===e.status&&(window.location=window.MCS_CONSTANTS.API_URL+"/v1/exports/"+n.props.match.params.exportId+"/executions/"+e.id+"/files/technical_name="+e.result.output_files[0]+"?access_token="+encodeURIComponent(y.default.getItem("access_token")))}},n.buildColumnDefinition=function(){var e=n.props.intl.formatMessage;return{dataColumnsDefinition:[{intlMessage:v.default.status,key:"status",isHideable:!1,render:function(e){return e}},{intlMessage:v.default.creationDate,key:"creation_date",isHideable:!1,render:function(e){return(0,u.default)(e).format("DD/MM/YYYY HH:mm:ss")}},{intlMessage:v.default.startDate,key:"start_date",isHideable:!1,render:function(t){return t?(0,u.default)(t).format("DD/MM/YYYY HH:mm:ss"):e(v.default.notStarted)}},{key:"action",render:function(t,a,r){return"SUCCEEDED"===a.status&&o.createElement(l.Button,{type:"primary",onClick:n.downloadFile(a)}," ",e(v.default.download))}}]}},n.state={exportObject:{item:void 0,isLoading:!0},exportExecutions:{items:[],isLoading:!0,total:0}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.exportId,n=e.location,a=n.search,r=n.pathname,o=e.history;(0,h.isSearchValid)(a,h.PAGINATION_SEARCH_SETTINGS)?this.fetchExportExecution(t):o.replace({pathname:r,search:(0,h.buildDefaultSearch)(a,h.PAGINATION_SEARCH_SETTINGS),state:{reloadDataSource:!0}})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.history,a=t.location,r=a.pathname,o=a.search,i=t.match.params,s=i.organisationId,l=i.exportId,c=e.location.search,u=e.match.params.organisationId;(0,h.compareSearches)(o,c)&&s===u||((0,h.isSearchValid)(o,h.PAGINATION_SEARCH_SETTINGS)?this.fetchExportExecution(l):n.replace({pathname:r,search:(0,h.buildDefaultSearch)(o,h.PAGINATION_SEARCH_SETTINGS),state:{reloadDataSource:s!=s}}))}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.fetchLoop)}},{key:"render",value:function(){var e=this,t=this.props,n=t.location.search,a=t.match.params.organisationId,r=t.intl.formatMessage,i=t.history,s=this.state,l=s.exportExecutions,c=s.exportObject,u=(0,h.parseSearch)(n,h.PAGINATION_SEARCH_SETTINGS),g={current:u.currentPage,pageSize:u.pageSize,onChange:function(t){return e.updateLocationSearch({currentPage:t})},onShowSizeChange:function(t,n){return e.updateLocationSearch({pageSize:n,currentPage:1})},total:l.total};return o.createElement("div",{className:"ant-layout"},o.createElement(p.default,{exportObject:c.item,archiveObject:function(){if(c.item){var t=c.item.id;return e._exportService.deleteExport(t).then((function(){i.push("/v2/o/"+a+"/datastudio/exports")}))}},isExportExecutionRunning:!(!l.items.length||"PENDING"!==l.items[0].status&&"RUNNING"!==l.items[0].status),onNewExecution:function(){return e.fetchExportExecution(e.props.match.params.exportId)}}),o.createElement("div",{className:"ant-layout"},o.createElement(M,{className:"mcs-content-container"},o.createElement(d.default,{object:c.item&&c.item}),c.item&&o.createElement(S.Labels,{labellableId:c.item.id,labellableType:"EXPORT",organisationId:a}),o.createElement(f.Card,{title:r(v.default.exportExecutionsTitle)},o.createElement("hr",null),o.createElement(m.default,{dataSource:l.items,columns:this.buildColumnDefinition().dataColumnsDefinition,pagination:g,loading:l.isLoading})))))}}]),t}(o.Component);w([(0,b.lazyInject)(_.TYPES.IExportService)],P.prototype,"_exportService",void 0),t.default=(0,c.compose)(i.injectIntl,s.withRouter)(P)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),r=n(11);t.default=function(e){var t=e.object;return a.createElement(r.ContentHeader,{title:t&&t.name||"",loading:!t||!t.name})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(41),s=n(10),l=n(13),c=n(107),u=n(6),d=n(8),f=E(n(309)),p=n(11),m=E(n(59)),g=n(1155),y=E(g),h=n(15),v=n(12),b=E(n(273)),_=E(n(182)),S=E(n(162));function E(e){return e&&e.__esModule?e:{default:e}}var O=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.editExport=function(){var e=n.props,t=e.location,a=e.history,r=e.match.params,o="/v2/o/"+r.organisationId+"/datastudio/exports/"+r.exportId+"/edit";a.push({pathname:o,state:{from:""+t.pathname+t.search}})},n.runExecution=function(){var e=n.props.intl.formatMessage;n.state.exportIsRunning?s.message.error(e(y.default.exportRunning)):n.props.exportObject&&n._exportService.createExecution(n.props.exportObject.id).then((function(e){return n.setState({exportIsRunning:!0})})).then((function(e){return n.props.onNewExecution()}))},n.buildMenu=function(){var e=n.props,t=e.archiveObject,a=e.intl.formatMessage;return o.createElement(s.Menu,{onClick:function(e){var r=n.props,l=r.match.params,c=l.organisationId,d=l.exportId,p=r.history;switch(e.key){case"ARCHIVED":return void s.Modal.confirm({title:a(f.default.archiveExportConfirm),content:a(f.default.archiveExportMessage),icon:o.createElement(i.ExclamationCircleOutlined,null),okText:a(f.default.confirm),cancelText:a(f.default.cancel),onOk:function(){return t()}});case"HISTORY":return n.props.openNextDrawer(b.default,{additionalProps:{resourceType:"QUERY_EXPORT",resourceId:d,handleClose:function(){return n.props.closeNextDrawer()},formatProperty:g.formatExportProperty,resourceLinkHelper:{QUERY_EXPORT:{direction:"CHILD",getType:function(){return o.createElement(u.FormattedMessage,_.default.exportResourceType)},getName:function(e){return n._exportService.getExport(e).then((function(t){return t.data.name||e}))},goToResource:function(e){p.push("/v2/o/"+c+"/datastudio/exports/"+e)}}}},size:"small"});default:return function(){m.default.error("onclick error")}}}},o.createElement(s.Menu.Item,{key:"HISTORY"},o.createElement(u.FormattedMessage,y.default.history)),o.createElement(s.Menu.Item,{key:"ARCHIVED"},o.createElement(u.FormattedMessage,y.default.archive)))},n.state={exportIsRunning:n.props.isExportExecutionRunning},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.isExportExecutionRunning;t!==e.isExportExecutionRunning&&this.setState({exportIsRunning:t})}},{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.exportObject,a=this.buildMenu(),r=[{name:"Exports",path:"/v2/o/"+t+"/datastudio/exports"},{name:n&&n.name?n.name:""}];return o.createElement(p.Actionbar,{paths:r},o.createElement(s.Button,{className:"mcs-primary",type:"primary",onClick:this.runExecution},this.state.exportIsRunning?o.createElement(i.LoadingOutlined,{spin:!0}):o.createElement(p.McsIcon,{type:"plus"}),o.createElement(u.FormattedMessage,y.default.newExecution)),o.createElement(s.Button,{onClick:this.editExport},o.createElement(p.McsIcon,{type:"pen"}),o.createElement(u.FormattedMessage,y.default.edit)),o.createElement(c.Dropdown,{overlay:a,trigger:["click"]},o.createElement(s.Button,null,o.createElement(i.EllipsisOutlined,null))))}}]),t}(o.Component);O([(0,h.lazyInject)(v.TYPES.IExportService)],w.prototype,"_exportService",void 0),t.default=(0,d.compose)(l.withRouter,u.injectIntl,S.default)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(13),l=n(10),c=n(8),u=P(n(17)),d=P(n(2525)),f=n(11),p=P(n(2526)),m=P(n(335)),g=P(n(59)),y=n(30),h=P(n(1157)),v=n(15),b=n(12),_=P(n(69)),S=n(44),E=P(n(23)),O=P(n(261)),w=n(1158),M=n(340);function P(e){return e&&e.__esModule?e:{default:e}}var T=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},I=l.Layout.Content,A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchLoop=window.setInterval((function(){var e=n.props,t=e.match.params,a=t.datamartId,r=t.importId,o=e.location.search,i=n.state.importExecutions;if(i.items[0]&&("PENDING"===i.items[0].status||"RUNNING"===i.items[0].status)){var s=(0,y.parseSearch)(o,y.PAGINATION_SEARCH_SETTINGS);n.fetchImportAndExecutions(a,r,s)}}),5e3),n.fetchImportAndExecutions=function(e,t,a){var r=n._importService.getImport(e,t).then((function(e){return e.data})).then((function(e){return n.setState({importObject:{item:e,isLoading:!1}})})).catch((function(e){return g.default.error(e)})),o=Object.assign({},(0,S.getPaginatedApiParam)(a.currentPage,a.pageSize)),i=n._importService.getImportExecutions(e,t,o).then((function(e){return n.setState({importExecutions:{items:e.data,isLoading:!1,total:e.total?e.total:e.count}})})).catch((function(e){return g.default.error(e)}));return Promise.all([r,i])},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,y.updateSearch)(o,e,y.PAGINATION_SEARCH_SETTINGS)};a.push(i)},n.renderStatuColumn=function(e){switch(e.status){case"SUCCEEDED":case"SUCCESS":return o.createElement("div",null,e.status," ",e.result&&e.result.total_failure>0?o.createElement("span",null,"- with errors"," ",o.createElement(l.Tooltip,{placement:"top",title:e.error&&e.error.message},o.createElement(f.McsIcon,{type:"question"}))):void 0);default:return o.createElement("div",null,e.status)}},n.onClickCancel=function(e){var t=n.props.match.params.datamartId,a=n.props.match.params.importId,r=n.state.importExecutions.items;return n._importService.cancelImportExecution(t,a,e.id).then((function(e){return e.data})).then((function(e){n.setState({importObject:n.state.importObject,importExecutions:{items:r.map((function(t){return t.id===e.id?e:t})),isLoading:!1,total:n.state.importExecutions.total}})})).catch((function(e){g.default.error(e)}))},n.download=function(e){try{window.open(window.MCS_CONSTANTS.API_URL+"/v1/data_file/data?uri="+encodeURIComponent(e)+"&access_token="+encodeURIComponent(O.default.getItem("access_token")))}catch(e){g.default.error(e)}},n.onDownloadErrors=function(e){e.result&&e.result.error_file_uri&&n.download(e.result.error_file_uri)},n.onDownloadInputs=function(e){e.result&&n.download(e.result.input_file_uri)},n.buildColumnDefinition=function(){var e=n.props,t=e.intl.formatMessage,a=e.colors;return{dataColumnsDefinition:[{intlMessage:h.default.id,key:"id",isHideable:!1,render:function(e){return e}},{intlMessage:h.default.status,key:"status",isHideable:!1,render:function(e,t){return n.renderStatuColumn(t)}},{intlMessage:h.default.progress,key:"progress",isHideable:!1,render:function(e,t){return o.createElement("div",null,o.createElement(l.Progress,{showInfo:!1,percent:"SUCCEEDED"===t.status||"SUCCESS"===t.status?100:100*(0,w.getExecutionInfo)(t,a).percent}))}},{intlMessage:h.default.startDate,key:"start_date",isHideable:!1,render:function(e){return e?(0,u.default)(e).format("DD/MM/YYYY HH:mm:ss"):t(h.default.notStarted)}},{intlMessage:h.default.endDate,key:"end_date",isHideable:!1,render:function(e,n){return n.start_date&&n.duration?(0,u.default)(n.start_date+n.duration).format("DD/MM/YYYY HH:mm:ss"):t(h.default.notEnded)}},{intlMessage:h.default.creationDate,key:"creation_date",isHideable:!1,render:function(e){return e?(0,u.default)(e).format("DD/MM/YYYY HH:mm:ss"):t(h.default.notCreated)}}]}},n.state={importObject:{item:void 0,isLoading:!0},importExecutions:{items:[],isLoading:!0,total:0}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params,n=t.datamartId,a=t.importId,r=e.location,o=r.search,i=r.pathname,s=e.history;if((0,y.isSearchValid)(o,y.PAGINATION_SEARCH_SETTINGS)){var l=(0,y.parseSearch)(o,y.PAGINATION_SEARCH_SETTINGS);this.fetchImportAndExecutions(n,a,l)}else s.replace({pathname:i,search:(0,y.buildDefaultSearch)(o,y.PAGINATION_SEARCH_SETTINGS),state:{reloadDataSource:!0}})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.history,a=t.location,r=a.pathname,o=a.search,i=t.match.params,s=i.organisationId,l=i.datamartId,c=i.importId,u=e.location.search,d=e.match.params.organisationId;if(!(0,y.compareSearches)(o,u)||s!==d)if((0,y.isSearchValid)(o,y.PAGINATION_SEARCH_SETTINGS)){var f=(0,y.parseSearch)(o,y.PAGINATION_SEARCH_SETTINGS);this.fetchImportAndExecutions(l,c,f)}else n.replace({pathname:r,search:(0,y.buildDefaultSearch)(o,y.PAGINATION_SEARCH_SETTINGS),state:{reloadDataSource:s!==d}})}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.fetchLoop)}},{key:"render",value:function(){var e=this,t=this.props,n=t.location.search,a=t.intl.formatMessage,r=t.match.params.organisationId,i=this.state,s=i.importExecutions,l=i.importObject,c=(0,y.parseSearch)(n,y.PAGINATION_SEARCH_SETTINGS),u={current:c.currentPage,pageSize:c.pageSize,onChange:function(t){return e.updateLocationSearch({currentPage:t})},onShowSizeChange:function(t,n){return e.updateLocationSearch({pageSize:n})},total:this.state.importExecutions.total},g=[{key:"action",actions:function(t){return[{intlMessage:h.default.uploadCancel,callback:e.onClickCancel,disabled:"PENDING"!==t.status},{intlMessage:h.default.downloadErrorFile,callback:e.onDownloadErrors,disabled:!(t.result&&t.result.total_failure>0&&t.result.error_file_uri)},{intlMessage:h.default.downloadInputFile,callback:e.onDownloadInputs,disabled:!(t.result&&t.result.input_file_uri)}]}}];return o.createElement("div",{className:"ant-layout"},o.createElement(p.default,{importObject:l.item,isImportExecutionRunning:!(!s.items.length||"PENDING"!==s.items[0].status&&"RUNNING"!==s.items[0].status),onNewExecution:function(){return e.fetchImportAndExecutions(e.props.match.params.datamartId,e.props.match.params.importId,c)}}),o.createElement("div",{className:"ant-layout"},o.createElement(I,{className:"mcs-content-container"},o.createElement(d.default,{object:l.item}),l.item&&o.createElement(M.Labels,{labellableId:l.item.id,labellableType:"IMPORT",organisationId:r}),o.createElement(f.Card,{title:a(h.default.importExecutionsTitle)},o.createElement("hr",null),o.createElement(m.default,{dataSource:s.items,columns:this.buildColumnDefinition().dataColumnsDefinition,actionsColumnsDefinition:g,pagination:u,loading:s.isLoading,className:"mcs-importExecution_table"})))))}}]),t}(o.Component);T([(0,v.lazyInject)(b.TYPES.IImportService)],A.prototype,"_importService",void 0),t.default=(0,c.compose)(i.injectIntl,s.withRouter,_.default,E.default)(A)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(11),i=n(1156);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=function(e){function t(){return s(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.object;return r.createElement(o.ContentHeader,{title:e&&e.name||"",subTitle:e&&(0,i.formatDocumentTypeText)(e.document_type)+" / "+(0,i.formatMimeTypeText)(e.mime_type)||"",loading:!(e&&e.name)})}}]),t}(r.Component);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(41),s=n(10),l=n(13),c=n(107),u=n(6),d=n(8),f=b(n(309)),p=n(11),m=b(n(59)),g=b(n(1157)),y=n(15),h=n(12),v=b(n(23));function b(e){return e&&e.__esModule?e:{default:e}}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=s.Upload.Dragger,E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.editImport=function(){var e=n.props,t=e.location,a=e.history,r=e.match.params,o="/v2/o/"+r.organisationId+"/datastudio/datamart/"+r.datamartId+"/imports/"+r.importId+"/edit";a.push({pathname:o,state:{from:""+t.pathname+t.search}})},n.checkIfFileOK=function(e){var t=n.props.intl.formatMessage;return!!(e.size/1024/1024<100)||(s.message.error(e.name+" "+t(g.default.uploadErrorTooBig),3),!1)},n.handleOpenClose=function(){n.setState({isModalOpen:!n.state.isModalOpen,importFile:[]})},n.onFileUpdate=function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(e){var n=e.target.result;return t(n)},a.readAsText(e,"UTF-8")}))},n.handleOnImportButton=function(){var e=n.props,t=e.match.params,a=t.organisationId,r=t.datamartId,o=t.importId,i=e.history,s=e.importObject,l=n.state.importFile;l&&s&&function(){n.setState({isLoading:!0});var e=new FormData,t=!0,c=!1,u=void 0;try{for(var d,f=function(){var t=d.value;n.onFileUpdate(t).then((function(l){var c=new Blob([l],{type:"TEXT_CSV"===s.mime_type?"text/csv":"application/x-ndjson"});e.append("file",c,t.name),"TEXT_CSV"===s.mime_type&&e.append("type","text/csv"),"APPLICATION_X_NDJSON"===s.mime_type&&e.append("type","application/x-ndjson"),n._importService.createImportExecution(r,o,e).then((function(e){n.setState({isLoading:!1,isModalOpen:!1,importFile:[]}),i.push("/v2/o/"+a+"/datastudio/datamart/"+r+"/imports/"+o)})).catch((function(e){n.setState({isLoading:!1,importFile:[]}),n.props.notifyError(e)}))})).catch((function(e){n.props.notifyError(e)}))},p=l[Symbol.iterator]();!(t=(d=p.next()).done);t=!0)f()}catch(e){c=!0,u=e}finally{try{!t&&p.return&&p.return()}finally{if(c)throw u}}}()},n.deleteImport=function(e,t){return n._importService.deleteImport(e,t)},n.renderModal=function(){var e=n.props.intl.formatMessage,t=n.state,a=t.isLoading,r=t.isModalOpen,i=t.importFile,l={name:"file",multiple:!0,action:"/",accept:".ndjson,.csv",beforeUpload:function(e,t){return!!n.checkIfFileOK(e)&&(n.setState({importFile:t}),!0)},fileList:i,onRemove:function(e){i&&n.setState({importFile:i.filter((function(t){return t.uid!==e.uid}))})}};return o.createElement(s.Modal,{title:e(g.default.uploadTitle),visible:r,onOk:n.handleOnImportButton,okText:e(g.default.uploadConfirm),onCancel:n.handleOpenClose,confirmLoading:a},o.createElement(s.Spin,{spinning:a},o.createElement(S,l,o.createElement("p",{className:"ant-upload-hint"},e(g.default.uploadMessage),o.createElement("br",null),e(g.default.uploadMessage2)))))},n.buildMenu=function(){var e=n.props,t=e.importObject,a=e.intl.formatMessage,r=e.match.params.organisationId,l=e.history;return o.createElement(s.Menu,{onClick:function(e){if(t)switch(e.key){case"DELETE":return c=t.datamart_id,u=t.id,void s.Modal.confirm({title:a(f.default.deleteImportConfirm),content:a(f.default.deleteImportMessage),icon:o.createElement(i.ExclamationCircleOutlined,null),okText:a(f.default.confirm),cancelText:a(f.default.cancel),onOk:function(){n.setState({isLoading:!0},(function(){n.deleteImport(c,u).then((function(e){n.setState({isLoading:!1}),l.push("/v2/o/"+r+"/datastudio/imports")})).catch((function(e){n.setState({isLoading:!1}),n.props.notifyError(e)}))}))}});default:return function(){m.default.error("onclick error")}}var c,u}},o.createElement(s.Menu.Item,{key:"DELETE"},o.createElement(u.FormattedMessage,g.default.delete)))},n.state={importIsRunning:n.props.isImportExecutionRunning,isModalOpen:!1,isLoading:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.isImportExecutionRunning;t!==e.isImportExecutionRunning&&this.setState({importIsRunning:t})}},{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.importObject,a=this.buildMenu(),r=[{name:"Imports",path:"/v2/o/"+t+"/datastudio/imports"},{name:n&&n.name?n.name:""}];return o.createElement(p.Actionbar,{paths:r},this.renderModal(),o.createElement(s.Button,{className:"mcs-primary mcs-importExecution_newExecution",type:"primary",onClick:this.handleOpenClose},this.state.importIsRunning?o.createElement(i.LoadingOutlined,{spin:!0}):o.createElement(p.McsIcon,{type:"plus"}),o.createElement(u.FormattedMessage,g.default.newExecution)),o.createElement(s.Button,{onClick:this.editImport},o.createElement(p.McsIcon,{type:"pen"}),o.createElement(u.FormattedMessage,g.default.edit)),o.createElement(c.Dropdown,{overlay:a,trigger:["click"]},o.createElement(s.Button,null,o.createElement(i.EllipsisOutlined,null))))}}]),t}(o.Component);_([(0,y.lazyInject)(h.TYPES.IImportService)],E.prototype,"_importService",void 0),t.default=(0,d.compose)(l.withRouter,u.injectIntl,v.default)(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(2528)),r=o(n(2529));function o(e){return e&&e.__esModule?e:{default:e}}t.default={actionBarComponent:a.default,contentComponent:r.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(6),l=n(8),c=n(10),u=n(33),d=n(11),f=n(1159),p=(a=f)&&a.__esModule?a:{default:a},m=n(65);function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=function(e){function t(){return g(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=[{name:(0,e.intl.formatMessage)(p.default.exports),path:"/v2/o/"+t+"/datastudio/exports"}];return o.createElement(d.Actionbar,{paths:n},o.createElement(u.Link,{to:"/v2/o/"+t+"/datastudio/exports/create"},o.createElement(c.Button,{className:"mcs-primary",type:"primary"},o.createElement(d.McsIcon,{type:"plus"})," ",o.createElement(s.FormattedMessage,p.default.newExport))))}}]),t}(o.Component);t.default=(0,l.compose)(s.injectIntl,i.withRouter,m.injectDatamart)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=n(25),c=n(13),u=n(33),d=n(10),f=n(6),p=n(44),m=n(30),g=n(1159),y=(a=g)&&a.__esModule?a:{default:a},h=n(68),v=n(15),b=n(12),_=n(2530),S=n(41);function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var w=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M={loading:!1,data:[],total:0},P=function(e){function t(){E(this,t);var e=O(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state=M,e.archiveExport=function(t){return e._exportService.deleteExport(t)},e.fetchExport=function(t,n){e.setState({loading:!0},(function(){var a=Object.assign({organisation_id:t},(0,p.getPaginatedApiParam)(n.currentPage,n.pageSize));n.keywords&&(a.keywords=n.keywords),n.label_id&&n.label_id.length&&(a.label_ids=n.label_id),e._exportService.getExports(a).then((function(t){e.setState({loading:!1,data:t.data,total:t.total||t.count})}))}))},e.onClickArchive=function(t){var n=e.props,a=n.location,r=a.search,o=a.pathname,s=a.state,l=n.history,c=n.match.params.organisationId,u=n.intl.formatMessage,f=e.state.data,p=(0,m.parseSearch)(r,m.PAGINATION_SEARCH_SETTINGS);d.Modal.confirm({icon:i.createElement(S.ExclamationCircleOutlined,null),title:u(y.default.exportsArchiveTitle),content:u(y.default.exportsArchiveMessage),okText:u(y.default.exportsArchiveOk),cancelText:u(y.default.exportsArchiveCancel),onOk:function(){e.archiveExport(t.id).then((function(){if(1===f.length&&1!==p.currentPage){var t=Object.assign(Object.assign({},p),{currentPage:p.currentPage-1});return l.replace({pathname:o,search:(0,m.updateSearch)(r,t),state:s}),Promise.resolve()}return e.fetchExport(c,{pageSize:p.pageSize,currentPage:p.currentPage,keywords:"",label_id:[]})}))},onCancel:function(){}})},e.onClickEdit=function(t){var n=e.props,a=n.history,r=n.match.params.organisationId;a.push("/"+r+"/datastudio/exports/"+t.id+"/edit")},e.updateLocationSearch=function(t){var n=e.props,a=n.history,r=n.location,o=r.search,i={pathname:r.pathname,search:(0,m.updateSearch)(o,t,_.EXPORT_SEARCH_SETTINGS)};a.push(i)},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.history,a=e.location,r=a.search,o=a.pathname;if((0,m.isSearchValid)(r,_.EXPORT_SEARCH_SETTINGS)){var i=(0,m.parseSearch)(r,_.EXPORT_SEARCH_SETTINGS);this.fetchExport(t,i)}else n.replace({pathname:o,search:(0,m.buildDefaultSearch)(r,_.EXPORT_SEARCH_SETTINGS)})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.location,a=n.pathname,r=n.search,o=t.match.params.organisationId,i=t.history,s=e.location.search,l=e.match.params.organisationId;if(!(0,m.compareSearches)(r,s)||o!==l)if((0,m.isSearchValid)(r,_.EXPORT_SEARCH_SETTINGS)){var c=(0,m.parseSearch)(r,_.EXPORT_SEARCH_SETTINGS);this.fetchExport(o,c)}else i.replace({pathname:a,search:(0,m.buildDefaultSearch)(r,_.EXPORT_SEARCH_SETTINGS)})}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.intl,r=t.location.search,o=t.labels,s=this.state,l=s.data,c=s.loading,p={actionsColumnsDefinition:[{key:"action",actions:function(){return[{intlMessage:y.default.archive,callback:e.onClickArchive}]}}],dataColumnsDefinition:[{intlMessage:y.default.name,key:"name",isHideable:!1,render:function(e,t){return i.createElement(u.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+n+"/datastudio/exports/"+t.id},e)}},{intlMessage:y.default.type,key:"type",isHideable:!1,render:function(e,t){return i.createElement("span",null,e)}}]},g=(0,m.parseSearch)(r,_.EXPORT_SEARCH_SETTINGS),v={placeholder:a.formatMessage(y.default.searchTitle),onSearch:function(t){return e.updateLocationSearch({keywords:t,currentPage:1,pageSize:g.pageSize})},defaultValue:g.keywords},b={current:g.currentPage,pageSize:g.pageSize,total:this.state.total,onChange:function(t,n){return e.updateLocationSearch({currentPage:t,pageSize:n})},onShowSizeChange:function(t,n){return e.updateLocationSearch({currentPage:t,pageSize:n})}},S={labels:o,selectedLabels:o.filter((function(e){return g.label_id.some((function(t){return t===e.id}))})),onChange:function(t){var n=t.map((function(e){return e.id}));e.updateLocationSearch({label_id:n,currentPage:1})},buttonMessage:y.default.filterByLabel};return i.createElement(d.Row,{className:"mcs-table-container"},i.createElement("div",null,i.createElement("div",{className:"mcs-card-header mcs-card-title"},i.createElement("span",{className:"mcs-card-title"},i.createElement(f.FormattedMessage,y.default.exports))),i.createElement("hr",{className:"mcs-separator"}),i.createElement(h.TableViewFilters,{columns:p.dataColumnsDefinition,actionsColumnsDefinition:p.actionsColumnsDefinition,searchOptions:v,dataSource:l,loading:c,pagination:b,labelsOptions:S})))}}]),t}(i.Component);w([(0,v.lazyInject)(b.TYPES.IExportService)],P.prototype,"_exportService",void 0);t.default=(0,s.compose)(c.withRouter,f.injectIntl,(0,l.connect)((function(e){return{labels:e.labels.labelsApi.data}})))(P)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EXPORT_SEARCH_SETTINGS=void 0;var a=n(30);function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.EXPORT_SEARCH_SETTINGS=[].concat(r(a.PAGINATION_SEARCH_SETTINGS),r(a.KEYWORD_SEARCH_SETTINGS),r(a.LABELS_SEARCH_SETTINGS))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(2532)),r=o(n(2533));function o(e){return e&&e.__esModule?e:{default:e}}t.default={actionBarComponent:a.default,contentComponent:r.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(6),l=n(8),c=n(10),u=n(33),d=n(11),f=n(1160),p=(a=f)&&a.__esModule?a:{default:a},m=n(65);function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=function(e){function t(){return g(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=[{name:(0,e.intl.formatMessage)(p.default.imports),path:"/v2/o/"+t+"/datastudio/imports"}];return o.createElement(d.Actionbar,{paths:n},o.createElement(u.Link,{to:"/v2/o/"+t+"/datastudio/imports/create"},o.createElement(c.Button,{className:"mcs-primary mcs-imports_creationButton",type:"primary"},o.createElement(d.McsIcon,{type:"plus"})," ",o.createElement(s.FormattedMessage,p.default.newImport))))}}]),t}(o.Component);t.default=(0,l.compose)(s.injectIntl,i.withRouter,m.injectDatamart)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(25),s=n(8),l=n(13),c=n(6),u=n(67),d=n(30),f=n(1161),p=n(1162),m=(a=p)&&a.__esModule?a:{default:a};var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={loading:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.history,n=e.location,a=n.search,r=n.pathname,o=e.match.params.organisationId,i=e.workspace;if((0,d.isSearchValid)(a,this.getSearchSetting())){var s=(0,d.parseSearch)(a,this.getSearchSetting()).datamartId,l=s||i(o).datamarts[0].id;this.setState({selectedDatamartId:l})}else t.push({pathname:r,search:(0,d.buildDefaultSearch)(a,this.getSearchSetting())})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.location,a=n.pathname,r=n.search,o=t.match.params.organisationId,i=t.history,s=t.workspace,l=e.location.search,c=e.match.params.organisationId;if(!(0,d.compareSearches)(r,l)||o!==c)if((0,d.isSearchValid)(r,this.getSearchSetting())){var u=(0,d.parseSearch)(r,this.getSearchSetting()).datamartId,f=u||s(o).datamarts[0].id;this.setState({selectedDatamartId:f})}else i.replace({pathname:a,search:(0,d.buildDefaultSearch)(r,this.getSearchSetting())})}},{key:"getSearchSetting",value:function(){return[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(f.IMPORTS_SEARCH_SETTINGS))}},{key:"render",value:function(){var e=this.state.selectedDatamartId;return e?o.createElement(m.default,{datamartId:e,noFilterDatamart:!1}):null}}]),t}(o.Component);t.default=(0,s.compose)(l.withRouter,c.injectIntl,(0,i.connect)((function(e){return{workspace:(0,u.getWorkspace)(e)}})))(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(6),c=n(10),u=n(2535),d=b(n(2536)),f=n(65),p=n(61),m=n(124),g=n(51),y=b(n(200)),h=n(15),v=n(12);function b(e){return e&&e.__esModule?e:{default:e}}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=(0,l.defineMessages)({newExports:{id:"exports.edit.newExport",defaultMessage:"New Export"},exports:{id:"exports.edit.title",defaultMessage:"Exports"},editExports:{id:"exports.edit.actionbar.editExprot",defaultMessage:"Edit {name}"},updateSuccess:{id:"exports.edit.successMessage",defaultMessage:"Exports successfully saved"},updateError:{id:"exports.edit.list.errorMessage",defaultMessage:"Exports update failed"},savingInProgress:{id:"exports.edit.savingInProgress",defaultMessage:"Saving in progress"}}),E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.loadInitialValues=function(e){n._exportService.getExport(e).then((function(e){return e.data})).then((function(e){return Promise.all([n._queryService.getQuery(e.datamart_id,e.query_id),n._datamartService.getDatamart(e.datamart_id)]).then((function(t){n.setState({export:{export:e,query:t[0].data},selectedDatamart:t[1].data,shouldDisplayDatamartSelection:!1,loading:!1})}))}))},n.close=function(){var e=n.props,t=e.history,a=e.match.params,r=a.organisationId,o=a.exportId,i=o?"/v2/o/"+r+"/datastudio/exports/"+o:"/v2/o/"+r+"/datastudio/exports";return t.push(i)},n.save=function(e){var t=n.props,a=t.history,r=t.match.params,o=r.exportId,i=r.organisationId,s=t.intl,l=n.state.selectedDatamart;n.setState({loading:!0});var u=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)return d(),a.push("/v2/o/"+i+"/datastudio/exports/"+e);n.setState({loading:!1}),d(),t?c.message.success(s.formatMessage(S.updateSuccess)):c.message.error(s.formatMessage(S.updateError))},d=c.message.loading(s.formatMessage(S.savingInProgress),0);(function(){if(o){return n._queryService.updateQuery(l.id,n.state.export.query.id,e.query).then((function(e){return e.data})).then((function(t){return n._exportService.updateExport(o,e.export)}))}return n._queryService.createQuery(l.id,Object.assign(Object.assign({},e.query),{datamart_id:l.id,query_language:"OTQL"})).then((function(e){return e.data})).then((function(t){return n._exportService.createExport(i,Object.assign(Object.assign({},e.export),{query_id:t.id}))}))})().then((function(e){u(e.data.id,!0)})).catch((function(e){u(),(0,m.notifyError)(e)}))},n.onDatamartSelect=function(e){n.setState({selectedDatamart:e,export:{export:Object.assign(Object.assign({},n.state.export.export),{output_format:"JSON"}),query:null},shouldDisplayDatamartSelection:!1})},n.state={export:u.INITIAL_EXPORTS_FORM_DATA,loading:!0,selectedDatamart:void 0,shouldDisplayDatamartSelection:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params.exportId;e?this.loadInitialValues(e):this.setState({loading:!1})}},{key:"componentDidUpdate",value:function(e){var t=this.props.match.params.exportId;t!==e.match.params.exportId&&(this.setState({loading:!0}),this.loadInitialValues(t))}},{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.match.params,a=n.organisationId,r=n.exportId,i=this.state,s=i.loading,l=i.selectedDatamart,c=r?t(S.editExports,{name:this.state.export.export.name?this.state.export.export.name:t(S.exports)}):t(S.newExports),u=[{name:t(S.exports),path:"/v2/o/"+a+"/datastudio/exports"},{name:c}];return s?o.createElement(g.Loading,{isFullScreen:!0}):r||l?o.createElement(d.default,{initialValues:this.state.export,onSave:this.save,onClose:this.close,breadCrumbPaths:u,datamart:l}):o.createElement(y.default,{onSelect:this.onDatamartSelect,actionbarProps:{paths:u,formId:"EXPORT",onClose:this.close}})}}]),t}(o.Component);_([(0,h.lazyInject)(v.TYPES.IQueryService)],E.prototype,"_queryService",void 0),_([(0,h.lazyInject)(v.TYPES.IExportService)],E.prototype,"_exportService",void 0),_([(0,h.lazyInject)(v.TYPES.IDatamartService)],E.prototype,"_datamartService",void 0),t.default=(0,i.compose)(s.withRouter,l.injectIntl,p.injectDrawer,f.injectDatamart)(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INITIAL_EXPORTS_FORM_DATA={export:{name:"",output_format:"CSV",type:"QUERY"},query:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(8),s=n(35),l=n(6),c=g(n(60)),u=g(n(101)),d=g(n(2537)),f=g(n(812)),p=n(65),m=n(24);function g(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=o.Layout.Content,b=(0,l.defineMessages)({sectionTitleGeneral:{id:"exports.form.general",defaultMessage:"General Information"},sectionTitleQuery:{id:"exports.form.query",defaultMessage:"Query"},sectionSubTitleQuery:{id:"exports.form.query.subtitle",defaultMessage:"Create the query of objects your want to export from your Datamart"},saveExport:{id:"save.export",defaultMessage:"Save"},editExport:{id:"exports.form.edit.title",defaultMessage:"Edit {name}"},noMoreSupported:{id:"exports.form.legacyComponent.noMoreSupported",defaultMessage:"The query language related to this datamart is no more supported. Please select another datamart or create a new resource based on another datamart."}}),_=s.Field,S=function(e){function t(){y(this,t);var e=h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.generateUserQueryTemplate=function(e){return r.createElement("div",null,r.createElement(m.FormSection,{title:b.sectionTitleQuery,subtitle:b.sectionSubTitleQuery}),e)},e.buildQueryComponent=function(){var t=e.props,n=t.datamart,a=t.intl;return"v201506"===n.storage_model_version?e.props.initialValues.query?r.createElement(o.Alert,{message:a.formatMessage(b.noMoreSupported),type:"warning"}):null:e.generateUserQueryTemplate(r.createElement(_,{name:"query.query_text",component:f.default,datamartId:n.id,formItemProps:{label:a.formatMessage(b.saveExport),required:!0},helpToolTipProps:{title:a.formatMessage(b.saveExport)}}))},e.buildFormSections=function(){var t=[],n={id:"general",title:b.sectionTitleGeneral,component:r.createElement(d.default,null)},a={id:"query",title:b.sectionTitleQuery,component:e.buildQueryComponent()};return t.push(n),t.push(a),t},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.onSave,a={formId:"exportForm",paths:this.props.breadCrumbPaths,message:b.saveExport,onClose:this.props.onClose},i=this.buildFormSections(),l={items:i.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:"exportForm"},d=i.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==i.length-1&&r.createElement("hr",null))}));return r.createElement(o.Layout,{className:"edit-layout"},r.createElement(c.default,a),r.createElement(o.Layout,{className:"ant-layout-has-sider"},r.createElement(u.default,l),r.createElement(s.Form,{className:"edit-layout ant-layout",onSubmit:t(n)},r.createElement(v,{id:"exportForm",className:"mcs-content-container mcs-form-container"},r.createElement("div",{className:"placement-list-form"},d)))))}}]),t}(r.Component);t.default=(0,i.compose)(l.injectIntl,p.injectDatamart,(0,s.reduxForm)({form:"exportForm",enableReinitialize:!0}))(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=u(n(49)),l=u(n(63)),c=n(24);function u(e){return e&&e.__esModule?e:{default:e}}var d=(0,i.defineMessages)({sectionTitleGeneral:{id:"exports.edit.generalInfoSection.title",defaultMessage:"General Information"},sectionSubTitleGeneral:{id:"exports.edit.generalInfoSection.subtitle",defaultMessage:"Give your Export a name"},labelExportName:{id:"exports.edit.generalInfoSection.label.name",defaultMessage:"Export Name"},tootltipExportName:{id:"exports.edit.generalInfoSection.tooltip.name",defaultMessage:"Give your Export a Name so you can find it back in the different screens."}}),f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage;return r.createElement("div",null,r.createElement(c.FormSection,{title:d.sectionTitleGeneral,subtitle:d.sectionSubTitleGeneral}),r.createElement("div",null,r.createElement(c.FormInputField,{name:"export.name",component:c.FormInput,validate:[t],formItemProps:{label:n(d.labelExportName),required:!0},inputProps:{placeholder:n(d.labelExportName)},helpToolTipProps:{title:n(d.tootltipExportName)}})))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,s.default,l.default)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(6),c=n(10),u=n(2539),d=h(n(1163)),f=n(61),p=n(51),m=h(n(200)),g=n(15),y=n(12);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=(0,l.defineMessages)({newImports:{id:"imports.edit.newImport",defaultMessage:"New Import"},imports:{id:"imports.edit.title",defaultMessage:"Imports"},editImports:{id:"imports.edit.action.editImport",defaultMessage:"Edit {name}"},updateSuccess:{id:"imports.edit.save.successMessage",defaultMessage:"Import successfully saved"},updateError:{id:"imports.edit.list.errorMessage",defaultMessage:"Import update failed"},savingInProgress:{id:"imports.edit.savingInProgress",defaultMessage:"Saving in progress"}}),_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.loadInitialValues=function(e,t){n._importService.getImport(e,t).then((function(e){return e.data})).then((function(e){n.setState({importData:e})}))},n.close=function(){var e=n.props,t=e.history,a=e.location,r=e.match.params.organisationId,o=a.state&&a.state.from?a.state.from:"/v2/o/"+r+"/datastudio/imports";return t.push(o)},n.save=function(e){var t=n.props,a=t.history,r=t.match.params,o=r.importId,i=r.organisationId,s=t.intl,l=n.state,u=l.importData,d=l.selectedDatamart;n.setState({loading:!0});var f=c.message.loading(s.formatMessage(b.savingInProgress),0);o&&u.datamart_id?n._importService.updateImport(u.datamart_id,o,e).then((function(){p(o,u.datamart_id)})).catch((function(e){p(void 0,void 0,e.error)})):d&&n._importService.createImport(d.id,e).then((function(e){p(e.data.id,d.id)})).catch((function(e){p(void 0,void 0,e.error)}));var p=function(e,t,r){if(e)return f(),c.message.success(s.formatMessage(b.updateSuccess)),a.push("/v2/o/"+i+"/datastudio/datamart/"+t+"/imports/"+e);f(),n.setState({loading:!1}),r?c.message.error(s.formatMessage(b.updateError)+": "+r):c.message.error(s.formatMessage(b.updateError))}},n.onDatamartSelect=function(e){n.setState({selectedDatamart:e,importData:Object.assign({},n.state.importData),shouldDisplayDatamartSelection:!1})},n.state={importData:u.INITIAL_IMPORTS_FORM_DATA,loading:!0,selectedDatamart:void 0,shouldDisplayDatamartSelection:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params,t=e.datamartId,n=e.importId;n&&this.loadInitialValues(t,n),this.setState({loading:!1})}},{key:"componentDidUpdate",value:function(e){var t=this.props.match.params,n=t.datamartId,a=t.importId,r=e.match.params,o=r.importId,i=r.datamartId;a===o&&n===i||(this.setState({loading:!0}),this.loadInitialValues(n,a))}},{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.match.params,a=n.organisationId,r=n.importId,i=this.state,s=i.loading,l=i.selectedDatamart,c=r?t(b.editImports,{name:this.state.importData.name?this.state.importData.name:t(b.imports)}):t(b.newImports),u=[{name:t(b.imports),path:"/v2/o/"+a+"/datastudio/imports"},{name:c}];return s?o.createElement(p.Loading,{isFullScreen:!0}):r||l?o.createElement(d.default,{initialValues:this.state.importData,onSave:this.save,onClose:this.close,breadCrumbPaths:u}):o.createElement(m.default,{onSelect:this.onDatamartSelect,actionbarProps:{paths:u,formId:"IMPORT",onClose:this.close}})}}]),t}(o.Component);v([(0,g.lazyInject)(y.TYPES.IImportService)],_.prototype,"_importService",void 0),t.default=(0,i.compose)(s.withRouter,l.injectIntl,f.injectDrawer)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INITIAL_IMPORTS_FORM_DATA={name:"",encoding:"",mime_type:"APPLICATION_X_NDJSON",document_type:"USER_ACTIVITY"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=n(35),l=n(25),c=p(n(49)),u=p(n(63)),d=n(24),f=n(1163);function p(e){return e&&e.__esModule?e:{default:e}}var m=(0,i.defineMessages)({sectionTitleGeneral:{id:"edit.import.form.general.title",defaultMessage:"General Information"},sectionSubTitleGeneral:{id:"edit.import.form.general.subtitle",defaultMessage:"Give your Import a name"},labelImportName:{id:"edit.import.general.infos.label.name",defaultMessage:"Import Name"},tootltipImportName:{id:"edit.import.general.infos.tooltip.name",defaultMessage:"Give your Import a Name so you can find it back in the different screens."},labelImportEnconding:{id:"edit.import.general.infos.label.encoding",defaultMessage:"Encoding"},tootltipImportEncoding:{id:"edit.import.general.infos.tooltip.encoding",defaultMessage:"Choose the encoding."},labelImportMimeType:{id:"edit.import.general.infos.label.mimeType",defaultMessage:"Mime-Type"},tootltipImportMimeType:{id:"edit.import.general.infos.tooltip.mimeType",defaultMessage:"Choose the mime-type."},labelImportDocumentType:{id:"edit.import.general.infos.label.documentType",defaultMessage:"Document Type"},tootltipImportDocumentType:{id:"edit.import.general.infos.tooltip.documentType",defaultMessage:"Choose the document type."},labelImportPriority:{id:"edit.import.general.infos.label.priority",defaultMessage:"Priority"},tootltipImportPriority:{id:"edit.import.general.infos.tooltip.priority",defaultMessage:"Choose the document import priority."}}),g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage,a=e.formValues;return r.createElement("div",null,r.createElement(d.FormSection,{title:m.sectionTitleGeneral,subtitle:m.sectionSubTitleGeneral}),r.createElement("div",null,r.createElement(d.FormInputField,{name:"name",component:d.FormInput,validate:[t],formItemProps:{label:n(m.labelImportName),required:!0},inputProps:{placeholder:n(m.labelImportName)},helpToolTipProps:{title:n(m.tootltipImportName)}}),r.createElement(d.DefaultSelectField,{name:"document_type",component:d.DefaultSelect,validate:[t],options:"TEXT_CSV"===a.mime_type?[{title:"User Segment",value:"USER_SEGMENT"}]:[{title:"User Segment",value:"USER_SEGMENT"},{title:"User Activity",value:"USER_ACTIVITY"},{title:"User Profile",value:"USER_PROFILE"},{title:"User Identifiers Association",value:"USER_IDENTIFIERS_ASSOCIATION_DECLARATIONS"},{title:"User Identifiers Dissociation",value:"USER_IDENTIFIERS_DISSOCIATION_DECLARATIONS"},{title:"User Identifiers Deletion",value:"USER_IDENTIFIERS_DELETION"}],formItemProps:{label:n(m.labelImportDocumentType),colon:!1,required:!0},helpToolTipProps:{title:n(m.tootltipImportDocumentType)},selectProps:{className:"mcs-imports_selectField_"+m.tootltipImportDocumentType.id}}),r.createElement(d.DefaultSelectField,{name:"mime_type",component:d.DefaultSelect,validate:[t],options:"USER_SEGMENT"===a.document_type?[{title:"New Line Delimited JSON",value:"APPLICATION_X_NDJSON"},{title:"CSV",value:"TEXT_CSV"}]:[{title:"New Line Delimited JSON",value:"APPLICATION_X_NDJSON"}],formItemProps:{label:n(m.labelImportMimeType),colon:!1,required:!0},helpToolTipProps:{title:n(m.tootltipImportMimeType)}}),r.createElement(d.DefaultSelectField,{name:"encoding",component:d.DefaultSelect,validate:[t],options:[{title:"utf-8",value:"utf-8"}],formItemProps:{label:n(m.labelImportEnconding),colon:!1,required:!0},helpToolTipProps:{title:n(m.tootltipImportEncoding)}}),r.createElement(d.DefaultSelectField,{name:"priority",component:d.DefaultSelect,validate:[t],options:[{title:"LOW",value:"LOW"},{title:"MEDIUM",value:"MEDIUM"},{title:"HIGH",value:"HIGH"}],formItemProps:{label:n(m.labelImportPriority),colon:!1,required:!0},helpToolTipProps:{title:n(m.tootltipImportPriority)},selectProps:{className:"mcs-imports_selectField_"+m.tootltipImportPriority.id}})))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,c.default,u.default,(0,l.connect)((function(e){return{formValues:(0,s.getFormValues)(f.FORM_ID)(e)}})))(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(11),i=n(30),s=n(10),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),c=n(6),u=n(13),d=n(8),f=n(337),p=S(n(2542)),m=n(15),g=n(12),y=n(1132),h=S(n(142)),v=S(n(23)),b=n(1164),_=S(n(81));function S(e){return e&&e.__esModule?e:{default:e}}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=s.Layout.Content,w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleRunExport=function(){n.setState({exportIsRunning:!0});var e=n.props,t=e.selectedDatamartId,a=e.location.search,r=e.intl.formatMessage,o=e.match.params.organisationId,s=(0,i.parseSearch)(a,f.FUNNEL_SEARCH_SETTING),l=s.filter.length>0?JSON.parse(s.filter):{};l.forEach((function(e){return e.group_by_dimension="channel_id"}));var c=(0,b.extractDatesFromProps)(a);n._userActivitiesFunnelService.getUserActivitiesFunnel(t,l,c).then((function(e){n.setState({exportIsRunning:!1}),h.default.exportFunnel(e.data,t,o,r)})).catch((function(e){n.props.notifyError(e),n.setState({exportIsRunning:!1})}))},n.handleExecuteQueryButtonClick=function(){var e=n.state.executeQueryFunction;e&&e()},n.handleFunnelWrapperCallback=function(e,t,a){var r=n.state.exportIsRunning;n.setState({exportIsRunning:r,isLoading:a,executeQueryFunction:e,cancelQueryFunction:t})},n.handleCancelButtonClick=function(){var e=n.state.cancelQueryFunction;e&&(e(),n.setState({isLoading:!1}))},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,s={pathname:r.pathname,search:(0,i.updateSearch)(o,e,f.FUNNEL_SEARCH_SETTING)};a.push(s)},n.handleDateRangePickerChangeFunction=function(e){n.updateLocationSearch({from:e.from,to:e.to}),n.setState({dateRange:{from:e.from,to:e.to}})},n.state={exportIsRunning:!1,isLoading:!1,dateRange:{from:new _.default("now-7d"),to:new _.default("now")}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.selectedDatamartId,n=e.location.search,a=this.state,r=a.exportIsRunning,u=a.isLoading,d=a.dateRange,m=(0,i.parseSearch)(n,f.FUNNEL_SEARCH_SETTING);return l.createElement("div",{className:"ant-layout"},l.createElement(o.Actionbar,{paths:[{key:"Funnel Analytics",name:"Funnel Analytics"}]},l.createElement(o.McsDateRangePicker,{values:d,onChange:this.handleDateRangePickerChangeFunction}),m.filter.length>0&&l.createElement(s.Button,{className:"mcs-funnelQueryBuilder_exportBtn",onClick:this.handleRunExport,loading:r},!r&&l.createElement(o.McsIcon,{type:"download"}),l.createElement(c.FormattedMessage,{id:"funnel.actionbar.exportButton",defaultMessage:"Export"})),u&&l.createElement(s.Button,{className:"mcs-funnelQueryBuilder_cancelBtn",type:"default",onClick:this.handleCancelButtonClick},"Cancel"),l.createElement(s.Button,{className:"mcs-primary mcs-funnelQueryBuilder_executeQueryBtn",type:"primary",onClick:this.handleExecuteQueryButtonClick,loading:u},!u&&l.createElement(o.McsIcon,{type:"play"}),"Execute Query")),l.createElement(O,{className:"mcs-content-container"},l.createElement(p.default,{datamartId:t,parentCallback:this.handleFunnelWrapperCallback})))}}]),t}(l.Component);E([(0,m.lazyInject)(g.TYPES.IUserActivitiesFunnelService)],w.prototype,"_userActivitiesFunnelService",void 0),t.default=(0,d.compose)(y.withDatamartSelector,u.withRouter,c.injectIntl,v.default)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=d(n(2543)),s=d(n(2546)),l=n(13),c=n(30),u=n(337);function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.funnelCallbackFunction=function(e){n.setState({isLoading:e});var t=n.state.executeQueryFunction;t&&n.props.parentCallback(t,n.cancelQueryFunction,e)},n.storeAndLiftFunctions=function(e){var t=n.state.isLoading;n.props.parentCallback(e,n.cancelQueryFunction,t),n.setState({executeQueryFunction:e})},n.funnelQueryBuilderCallbackFunction=function(e){n.setState({launchExecutionAskedTime:e})},n.cancelQueryFunction=function(){return n.setState({cancelQueryAskedTime:(new Date).getTime(),isLoading:!1})},n.state={isLoading:!1,launchExecutionAskedTime:0,cancelQueryAskedTime:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.location,a=n.search,r=n.pathname,o=t.history;e.location.search!==a&&((0,c.isSearchValid)(a,u.FUNNEL_SEARCH_SETTING)||o.replace({pathname:r,search:(0,c.buildDefaultSearch)(a,u.FUNNEL_SEARCH_SETTING)}))}},{key:"render",value:function(){var e=this.props.datamartId,t=this.props.location.search,n=(0,c.parseSearch)(t,u.FUNNEL_SEARCH_SETTING),a=n.filter.length>0?JSON.parse(n.filter):{},o=this.state,l=o.launchExecutionAskedTime,d=o.cancelQueryAskedTime;return r.createElement("div",null,r.createElement(s.default,{datamartId:e,parentCallback:this.funnelQueryBuilderCallbackFunction,liftFunctionsCallback:this.storeAndLiftFunctions}),r.createElement(i.default,{datamartId:e,title:"Funnel demo",filter:a,parentCallback:this.funnelCallbackFunction,launchExecutionAskedTime:l,cancelQueryAskedTime:d}))}}]),t}(r.Component);t.default=(0,o.compose)(l.withRouter)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(10),l=n(41),c=O(n(17)),u=n(12),d=n(15),f=O(n(23)),p=n(8),m=n(54),g=n(11),y=n(6),h=n(30),v=n(337),b=n(1164),_=O(n(323)),S=O(n(2544)),E=O(n(47));function O(e){return e&&e.__esModule?e:{default:e}}var w=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=s.Select.Option,P=function(e,t){return 100*e/t},T=function(e){return JSON.parse(JSON.stringify(e))},I=function(e,t){return e*t/100},A=[["#00a1df","#e8f7fc"],["#fd7c12","#ffe7d4"],["#00ab67","#d1f0e4"],["#7057d1","#d5ccff"],["#eb5c5d","#ffcccc"]],C=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._debounce=m.debounce,n._cuid=E.default,n.updateLocationSearch=function(e){var t=n.props.history,a=t.location,r=a.search,o={pathname:a.pathname,search:(0,h.updateSearch)(r,e,v.FUNNEL_SEARCH_SETTING)};t.push(o)},n.fetchDimensions=function(e){return n.setState({isLoading:!0}),n._usersAnalyticsService.getDimensions(e,!0).then((function(e){n.setState({isLoading:!1,dimensionsList:{dimensions:e.data.dimensions}})})).catch((function(e){n.props.notifyError(e),n.setState({isLoading:!1})}))},n.fetchData=function(e,t,a,r,o){var i=n.props,s=i.parentCallback,l=i.notifyError;return n.setState({isLoading:!r,splitByView:!!r},(function(){s(n.state.isLoading)})),n._userActivitiesFunnelService.getUserActivitiesFunnel(e,t,a,5).then((function(e){var t;n.state.promiseCanceled||(e.data.global.steps.push(T(e.data.global.steps[e.data.global.steps.length-1])),null===(t=e.data.grouped_by)||void 0===t||t.map((function(e){return e.funnel.steps.push(T(e.funnel.steps[e.funnel.steps.length-1]))})),n.setState({isLoading:!1,funnelData:e.data},(function(){setTimeout((function(){n.drawSteps();var t=e.data.global.steps.map((function(e){return e.count}));t.unshift(e.data.global.total),t.pop(),n.computeStepDelta(t),e.data.grouped_by&&o&&n.computeDimensionMetrics(o)})),s(n.state.isLoading)})))})).catch((function(e){if(l(e),r&&o){var t=n.state.funnelData;t.global.steps[o].isLoading=!1,n.setState({funnelData:t})}n.setState({isLoading:!1},(function(){s(!1)}))}))},n.drawSteps=function(){var e=n.state.funnelData;e.global.steps.forEach((function(t,a){var r=0===a?e.global.total:e.global.steps[a-1].count;n.drawCanvas(e.global.total-r,e.global.total-t.count,a,e.global.steps.length)}))},n.drawCanvas=function(e,t,a,r){var o=document.getElementById("container"),i=document.getElementById("canvas_"+(a+1)),s=o&&o.offsetWidth/r;i.width=s||0;var l=i.getContext("2d");n.drawChart(l,e,t,i.width,A[0])},n.drawChart=function(e,t,a,r,o){var i=n.state.funnelData,s=P(t,i.global.total),l=P(a,i.global.total),c=I(s,370),u=I(l,370);e.beginPath(),e.lineWidth=2,e.moveTo(0,c),e.lineTo(r,u),e.strokeStyle=o[0],e.stroke(),e.beginPath(),e.moveTo(0,c),e.lineTo(r,u),e.lineTo(r,1e3),e.lineTo(0,1e3),e.closePath();var d=e.createLinearGradient(0,0,0,350);d.addColorStop(0,"#1ad2f263"),d.addColorStop(1,"#0ba6e126"),e.fillStyle=d,e.fillStyle=d,e.fill()},n.formatPercentageValue=function(e){if(e>=.01)return e.toFixed(2);if(e>=1e-4)return e.toFixed(4);if(0===e)return e.toString();return e.toExponential(2)},n.computeStepDelta=function(e){var t=e.map((function(t,a){var r=void 0;if(a<e.length-1){var o=e[a+1],i=o>0&&t>0?o/t*100:0;return r=100-i,{passThroughPercentage:n.formatPercentageValue(i),dropOff:n.formatPercentageValue(r)}}return{dropOff:n.formatPercentageValue(t>0&&e[0]>0?t/e[0]*100:0)}}));n.setState({stepsDelta:t})},n.computeDimensionMetrics=function(e){var t=n.state.funnelData,a=[];t.global.steps.forEach((function(e,n){var r;a.push([]),null===(r=t.grouped_by)||void 0===r||r.forEach((function(t,r){null!==t.dimension_value&&a[n].push({userPoints:{value:t.funnel.steps[n].count,pourcentage:P(t.funnel.steps[n].count,e.count),color:A[r][0]},conversions:t.funnel.steps[n].conversion||0===t.funnel.steps[n].conversion?{value:t.funnel.steps[n].conversion,pourcentage:P(t.funnel.steps[n].conversion,e.conversion),color:A[r][0]}:void 0,amounts:t.funnel.steps[n].amount||0===t.funnel.steps[n].amount?{value:t.funnel.steps[n].amount,pourcentage:P(t.funnel.steps[n].amount,e.amount),color:A[r][0]}:void 0})}))})),t.global.steps[e].splitedView=!0,t.global.steps[e].isLoading=!1,n.setState({funnelData:t,dimensionMetrics:a,splitByView:!0})},n.handleSplitByDimension=function(e,t){var a=n.state.funnelData,r=n.props,o=r.datamartId,i=r.location.search;a.global.steps[e].isLoading=!0,a.global.steps.forEach((function(e){return e.splitedView=!1}));var s=(0,b.extractDatesFromProps)(i),l=(0,h.parseSearch)(i,v.FUNNEL_SEARCH_SETTING),c=l.filter.length>0?JSON.parse(l.filter):{};c[e-1].group_by_dimension=t.toLocaleLowerCase(),n.fetchData(o,c,s,!0,e),n.setState({funnelData:a})},n.closeSplitByHover=function(e){var t=n.state.funnelData;t.global.steps[e].splitedView=!1,n.setState({funnelData:t,splitByView:!1})},n.isLastStep=function(e){return n.state.funnelData.global.steps.length===e},n.isFirstStep=function(e){return 0===e},n.getLabelValueForDimension=function(e){var t=n.state.dimensionsList.dimensions.find((function(t){return t.value===e}));return"CHANNEL_ID"===e&&o.createElement(M,{className:"mcs-funnelSplitBy_option",key:n._cuid(),value:(null==t?void 0:t.value)||""},null==t?void 0:t.label)},n.getStepHover=function(e,t,a){var r,i=n.state.funnelData,s={userPoints:i.global.steps[e-1].count,conversions:i.global.steps[e-1].conversion,amounts:i.global.steps[e-1].amount},l=[];return null===(r=i.grouped_by)||void 0===r||r.forEach((function(e,t){null!==e.dimension_value&&l.push({name:e.dimension_name,id:e.dimension_value,colors:A[t]})})),o.createElement(S.default,{key:n._cuid(),globalMetrics:s,idByDimension:l,dimensionMetrics:t,stepNumber:e,hasTransactionConfirmed:n.hasTransactionConfirmed(a)})},n.hasTransactionConfirmed=function(e){return e.filter_clause&&!!e.filter_clause.filters.find((function(e){return e.expressions.includes("$transaction_confirmed")}))},n.getConversionDescription=function(e,t,a){return n.hasTransactionConfirmed(e)?o.createElement("p",{className:"mcs-funnel_stepInfo_desc"},t&&o.createElement("span",null,"Users bought ",o.createElement("span",{className:"mcs-funnel_stepInfo_metric"},t)," units"),a&&o.createElement("span",null,o.createElement("br",null)," for a total of ",o.createElement("span",{className:"mcs-funnel_stepInfo_metric"},a))):o.createElement("p",{className:"mcs-funnel_stepInfo_desc"},t&&o.createElement("span",null,o.createElement("span",{className:"mcs-funnel_stepInfo_metric"},t)," units were linked to this step"),a&&o.createElement("span",null,o.createElement("br",null)," for a total of ",o.createElement("span",{className:"mcs-funnel_stepInfo_metric"},a)))},n.displaySplitByDropdown=function(e){return e.filter_clause.filters.find((function(e){return"CHANNEL_ID"===e.dimension_name}))},n.state={isLoading:!1,funnelData:{global:{total:0,steps:[]},grouped_by:[]},stepsDelta:[],dimensionMetrics:[],lastExecutedQueryAskedTime:0,promiseCanceled:!1,splitByView:!1,dimensionsList:{dimensions:[]}},n.fetchData=n._debounce(n.fetchData.bind(n),800),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.datamartId,n=e.filter,a=e.history.location.search,r=(0,b.extractDatesFromProps)(a);n.length>0&&this.fetchData(t,n,r),this.fetchDimensions(t),window.addEventListener("resize",this.drawSteps.bind(this))}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.datamartId,a=t.location.search,r=t.launchExecutionAskedTime,o=t.cancelQueryAskedTime,i=this.state.lastExecutedQueryAskedTime,s=(0,b.extractDatesFromProps)(a),l=(0,h.parseSearch)(a,v.FUNNEL_SEARCH_SETTING),c=l.filter.length>0?JSON.parse(l.filter):{};(e.location.search!==a||i!==r)&&c.length>0&&(this.setState({lastExecutedQueryAskedTime:r,promiseCanceled:!1}),this.fetchData(n,c,s)),e.cancelQueryAskedTime!==o&&this.setState({isLoading:!1,funnelData:{global:{total:0,steps:[]},grouped_by:[]},stepsDelta:[],promiseCanceled:!0,splitByView:!1})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.drawSteps.bind(this))}},{key:"getDurationMessage",value:function(e,t){return this.isFirstStep(e)?o.createElement("span",null):o.createElement("span",null," in ",o.createElement("span",{className:"mcs-funnel_metric"},c.default.duration(t,"second").format("d [day] h [hour] m [minute]")))}},{key:"render",value:function(){var e=this,t=this.state,n=t.funnelData,a=t.stepsDelta,r=t.dimensionMetrics,i=t.isLoading,c=this.props.filter,u=this.props.intl;if(i)return o.createElement(g.LoadingChart,null);var d=n.global.steps,f=n.global.total,p=function(){return document.getElementById("mcs-funnel_splitBy")};return o.createElement(s.Card,{className:"mcs-funnel",bordered:!1},o.createElement("div",{id:"container"},0===d.length||0===f?o.createElement("div",{className:"mcs-funnel_empty"},o.createElement(g.EmptyChart,{title:u.formatMessage(v.funnelMessages.noData),icon:"warning"})):o.createElement("div",{className:"mcs-funnel_steps"},d.map((function(t,n){var i=n>0&&d[n-1].hasOwnProperty("conversion")?(0,_.default)(d[n-1].conversion).format("0,0"):void 0,u=n>0&&d[n-1].hasOwnProperty("amount")?(0,_.default)(d[n-1].amount).format("0,0")+"€":void 0;return o.createElement("div",{key:n.toString(),style:{flex:1,position:"relative"}},o.createElement("div",{className:"mcs-funnel_chart"},o.createElement("div",{className:"mcs-funnel_stepInfo"},o.createElement("p",{className:"mcs-funnel_stepInfo_desc"},o.createElement("span",{className:"mcs-funnel_stepInfo_metric"},(0,_.default)(0===n?f:d[n-1].count).format("0,0")," "),n>0?"user points at step "+n:"total user points"),n>0&&c[n-1]?e.getConversionDescription(c[n-1],i,u):void 0,o.createElement("div",{className:"mcs-funnel_splitBy",id:"mcs-funnel_splitBy"},n>0&&d[n-1]&&d[n-1].count>0&&c[n-1]&&e.displaySplitByDropdown(c[n-1])?o.createElement(s.Select,{key:e._cuid(),disabled:d[n].isLoading,loading:d[n].isLoading,className:"mcs-funnel_splitBy_select",value:c[n-1].group_by_dimension,placeholder:"Split by",onChange:e.handleSplitByDimension.bind(e,n),getPopupContainer:p},(0,m.uniqBy)(c[n-1].filter_clause.filters,"dimension_name").map((function(t){return e.getLabelValueForDimension(t.dimension_name)}))):void 0)),n>0&&d[n].splitedView?o.createElement(s.Button,{shape:"circle",icon:o.createElement(l.CloseOutlined,null),className:"mcs-funnel_disableStepHover",onClick:e.closeSplitByHover.bind(e,n)}):void 0,n>0&&c[n-1]&&d[n].splitedView?e.getStepHover(n,r[n-1],c[n-1]):void 0,a[n]&&a[n].passThroughPercentage&&d[n+1]&&!d[n+1].splitedView?o.createElement("div",{className:"mcs-funnel_percentageOfSucceeded"},o.createElement("div",{className:"mcs-funnel_arrow mcs_funnel_arrowStep"}),o.createElement("p",{className:"mcs-funnel_deltaInfo"},o.createElement("span",{className:"mcs-funnel_metric"},a[n].passThroughPercentage+"%")," have succeeded ",e.getDurationMessage(n,d[n+1].interaction_duration))):void 0,o.createElement("canvas",{id:"canvas_"+(n+1),className:"mcs-funnel_canvas",height:"370"}),o.createElement("div",{className:"mcs-funnel_conversionInfo"},o.createElement("div",{className:e.isLastStep(n+1)?"mcs-funnel_arrow mcs-funnel_arrow--success":"mcs-funnel_arrow  mcs-funnel_arrow--failed"}),o.createElement("div",{className:"mcs-funnel_deltaInfo"},o.createElement("b",null,a[n]&&a[n].dropOff+"%"),o.createElement("br",null),o.createElement("p",null,e.isLastStep(n+1)?"Conversions":"Dropoffs")))))})))))}}]),t}(o.Component);w([(0,d.lazyInject)(u.TYPES.IUsersAnalyticsService)],C.prototype,"_usersAnalyticsService",void 0),w([(0,d.lazyInject)(u.TYPES.IUserActivitiesFunnelService)],C.prototype,"_userActivitiesFunnelService",void 0),t.default=(0,p.compose)(f.default,y.injectIntl,i.withRouter)(C)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=c(n(323)),i=c(n(47)),s=c(n(2545)),l=n(10);function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._cuid=i.default,n.getConversionDescription=function(e,t){return n.props.hasTransactionConfirmed?r.createElement("p",{className:"mcs-funnel_stepInfo_desc"},e&&r.createElement("span",null,"Users bought ",r.createElement("span",{className:"mcs-funnel_stepInfo_metric"},(0,o.default)(e).format("0,0"))," units"),t&&r.createElement("span",null,r.createElement("br",null)," for a total of ",r.createElement("span",{className:"mcs-funnel_stepInfo_metric"},(0,o.default)(t).format("0,0"),"€"))):r.createElement("p",{className:"mcs-funnel_stepInfo_desc"},e&&r.createElement("span",null,r.createElement("span",{className:"mcs-funnel_stepInfo_metric"},(0,o.default)(e).format("0,0"))," units were linked to this step"),t&&r.createElement("span",null,r.createElement("br",null)," for a total of ",r.createElement("span",{className:"mcs-funnel_stepInfo_metric"},(0,o.default)(t).format("0,0"),"€")))},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.dimensionMetrics,a=t.globalMetrics,i=t.idByDimension,c=t.stepNumber;return n?r.createElement("div",{className:"mcs-funnelStepHover"},r.createElement("p",{className:"mcs-funnelStepHover_desc"},r.createElement("span",{className:"mcs-funnelStepHover_metric"},(0,o.default)(a.userPoints).format("0,0"))," user points at step ",c),r.createElement("div",{className:"mcs-funnelStepHover_metrics"},n&&n.map((function(t){return r.createElement(s.default,{key:e._cuid(),value:t.userPoints.value,pourcentage:t.userPoints.pourcentage,color:t.userPoints.color})}))),r.createElement("div",{className:"mcs-funnelStepHover_desc mcs-funnelStepHover_desc--secondary"},this.getConversionDescription(a.conversions,a.amounts)),r.createElement("div",{className:"mcs-funnelStepHover_metrics"},n&&n.map((function(t){return t.amounts&&r.createElement(s.default,{key:e._cuid(),value:t.amounts.value,pourcentage:t.amounts.pourcentage,color:t.amounts.color,unit:"€"})}))),r.createElement("div",{className:"mcs-funnelStepHover_metrics"},n&&n.map((function(t){return t.conversions&&r.createElement(s.default,{key:e._cuid(),value:t.conversions.value,pourcentage:t.conversions.pourcentage,color:t.conversions.color})}))),r.createElement("div",{className:"mcs-funnelStepHover_totalsByDimension"},i.map((function(t){return r.createElement(l.Tag,{key:e._cuid(),className:"mcs-funnelStepHover_totalsByDimension_tags",color:t.colors[1],style:{color:t.colors[0]}},t.id)})))):r.createElement("div",null)}}]),t}(r.Component);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(10),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(323),l=(a=s)&&a.__esModule?a:{default:a};function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=function(e){function t(){return c(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=e.pourcentage,a=e.color,r=e.unit;return i.createElement("div",{className:"mcs-funnelQueryBuilder_metric"},i.createElement("div",null,(0,l.default)(t).format("0,0"),r),i.createElement(o.Progress,{showInfo:!1,percent:n,strokeColor:a}))}}]),t}(i.Component);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=S(n(95)),l=n(41),c=S(n(47)),u=n(12),d=n(15),f=n(8),p=S(n(23)),m=n(337),g=n(13),y=n(30),h=n(11),v=S(n(81)),b=n(6),_=S(n(2547));function S(e){return e&&e.__esModule?e:{default:e}}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=i.Select.Option,w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._cuid=c.default,n.setInitialParams=function(){var e=n.props,t=e.location,a=t.search,r=t.pathname,o=e.history,i=n.state.dateRange,s=(0,y.parseSearch)(a,m.FUNNEL_SEARCH_SETTING);try{var l=JSON.parse(s.filter).map((function(e){return e.filter_clause.filters.forEach((function(e){return e.id=n._cuid()})),Object.assign(Object.assign({},e),{id:n._cuid()})}));n.setState({steps:l})}catch(e){n.setState({steps:[{id:n._cuid(),name:"Step 1",filter_clause:{operator:"OR",filters:[{dimension_name:"DATE_TIME",not:!1,operator:"EXACT",expressions:[],case_sensitive:!1}]}}]})}var c={from:i.from,to:i.to},u={pathname:r,search:(0,y.updateSearch)(a,c)};(0,y.isSearchValid)(a,m.FUNNEL_SEARCH_SETTING)||o.replace(u)},n.fetchDimensions=function(e){return n.setState({isLoading:!0}),n._usersAnalyticsService.getDimensions(e,!0).then((function(e){n.setState({isLoading:!1,dimensionsList:{dimensions:e.data.dimensions}})})).catch((function(e){n.props.notifyError(e),n.setState({isLoading:!1})}))},n.addStep=function(){var e=n.state.steps.slice();e.push({id:n._cuid(),name:"",max_days_after_previous_step:0,filter_clause:{operator:"AND",filters:[{dimension_name:"DATE_TIME",not:!1,operator:"EXACT",expressions:[],case_sensitive:!1}]}}),e.forEach((function(e,t){e.name="Step "+(t+1)})),n.setState({steps:e})},n.addDimensionToStep=function(e){var t=n.state.steps.slice();t.forEach((function(t){t.id===e&&(t.filter_clause.operator="AND",t.filter_clause.filters.push({id:n._cuid(),dimension_name:"DATE_TIME",not:!1,operator:"EXACT",expressions:[],case_sensitive:!1}))})),n.setState({steps:t})},n.checkExpressionsNotEmpty=function(){var e=!0;return n.state.steps.forEach((function(t){t.filter_clause.filters.forEach((function(t){0===t.expressions.length?e=!1:t.expressions.forEach((function(t){t&&0!==t.length&&t.trim()||(e=!1)}))}))})),e},n.checkDimensionsNotEmpty=function(){var e=!0;return n.state.steps.forEach((function(t){t.filter_clause.filters.forEach((function(t){t.dimension_name&&0!==t.dimension_name.length||(e=!1)}))})),e},n.handleExecuteQueryButtonClick=function(){n.checkExpressionsNotEmpty()&&n.checkDimensionsNotEmpty()?n.updateFilterQueryStringParams():n.props.notifyWarning({message:s.default.errorFormMessage.defaultMessage,description:""})},n.removeDimensionFromStep=function(e,t){var a=n.state.steps.slice();a.forEach((function(n){if(n.id===e){var a=n.filter_clause.filters.filter((function(e){return e.id!==t}));n.filter_clause.filters=a}})),n.setState({steps:a})},n.removeStep=function(e){var t=n.state.steps.filter((function(t){return t.id!==e}));t.forEach((function(e,t){e.name="Step "+(t+1)})),n.setState({steps:t})},n.getDimensionNameSelect=function(){return n.state.dimensionsList.dimensions.map((function(e){return o.createElement(O,{key:n._cuid(),value:e.value},e.label)}))},n.sortStep=function(e,t){var a=n.state.steps,r=a[e];"up"===t&&e>0&&(a[e]=a[e-1],a[e].name="Step "+(e+1),a[e-1]=r,a[e-1].name="Step "+e,n.setState({steps:a})),"down"===t&&e+1<a.length&&(a[e]=a[e+1],a[e].name="Step "+(e+1),a[e+1]=r,a[e+1].name="Step "+(e+2),n.setState({steps:a}))},n.state={steps:[{id:n._cuid(),name:"Step 1",max_days_after_previous_step:0,filter_clause:{operator:"OR",filters:[{dimension_name:"DATE_TIME",not:!1,operator:"EXACT",expressions:[],case_sensitive:!1}]}}],dimensionsList:{dimensions:[]},isLoading:!1,dateRange:{from:new v.default("now-7d"),to:new v.default("now")}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.datamartId;this.setInitialParams(),this.fetchDimensions(e),this.props.liftFunctionsCallback(this.handleExecuteQueryButtonClick)}},{key:"handleNotSwitcherChange",value:function(e,t,n){var a=this.state.steps;a.forEach((function(a){a.id===t&&a.filter_clause.filters.forEach((function(t,a){e===a&&(t.not=!n)}))})),this.setState({steps:a})}},{key:"handleDimensionNameChange",value:function(e,t,n){var a=this.state.steps;a.forEach((function(a){a.id===t&&a.filter_clause.filters.forEach((function(t,a){e===a&&(t.dimension_name=n,t.expressions=[])}))})),this.setState({steps:a})}},{key:"handleFilterOperatorChange",value:function(e,t){var n=this.state.steps;n.forEach((function(n){n.id===e&&(n.filter_clause.operator=t)})),this.setState({steps:n})}},{key:"handleDimensionExpressionForSelectorChange",value:function(e,t,n){var a=this.state.steps;a.forEach((function(a){a.id===t&&a.filter_clause.filters.forEach((function(t,a){e===a&&(t.expressions=n.map((function(e){return e.trim()})),t.expressions.length>1?t.operator="IN_LIST":t.operator="EXACT")}))})),this.setState({steps:a})}},{key:"handleMaximumDaysAfterStepChange",value:function(e,t){var n=this.state.steps;n.forEach((function(n){n.id===e&&(n.max_days_after_previous_step=parseInt(t.target.value,10))})),this.setState({steps:n})}},{key:"showFilterSymbol",value:function(e,t){var n=this.state.steps,a="equals";return n.forEach((function(n){n.id===t&&n.filter_clause.filters.forEach((function(t,n){e===n&&("EXACT"===t.operator?a="equals":"IN_LIST"===t.operator&&(a="in"))}))})),a}},{key:"updateFilterQueryStringParams",value:function(){var e=this.state.steps,t=this.props.history,n=t.location,a=n.search,r=n.pathname,o=JSON.parse(JSON.stringify(e));o.forEach((function(e){e.id=void 0,0===e.max_days_after_previous_step&&(e.max_days_after_previous_step=void 0),e.filter_clause.filters.forEach((function(e){e.id=void 0}))}));var i=o.filter((function(e){return e.filter_clause.filters.length>0})),s={filter:[JSON.stringify(i)]},l={pathname:r,search:(0,y.updateSearch)(a,s,m.FUNNEL_SEARCH_SETTING)};t.push(l)}},{key:"popupContainer",value:function(){return document.getElementById("mcs-funnelQueryBuilder_step_dimensions")}},{key:"render",value:function(){var e=this,t=this.state,n=t.steps,a=t.dateRange,r=a.from,s=a.to,c=this.props.datamartId;return o.createElement("div",{className:"mcs-funnelQueryBuilder"},o.createElement("div",{className:"mcs-funnelQueryBuilder_steps"},o.createElement("div",{className:"mcs-funnelQueryBuilder_step_timelineStart"},r&&o.createElement("p",{className:"mcs-funnelQueryBuilder_timeline_date"},r.toMoment().format("DD/MM/YYYY 00:00")),o.createElement(l.CalendarOutlined,{className:"mcs-funnelQueryBuilder_timeline_icon"})),n.map((function(t,a){return o.createElement(i.Card,{key:t.id,className:"mcs-funnelQueryBuilder_step",bordered:!1},o.createElement("div",{className:"mcs-funnelQueryBuilder_step_body"},n.length>1&&o.createElement("div",{className:"mcs-funnelQueryBuilder_step_reorderBtn"},a>0&&o.createElement(l.ArrowUpOutlined,{className:"mcs-funnelQueryBuilder_sortBtn mcs-funnelQueryBuilder_sortBtn--up",onClick:e.sortStep.bind(e,a,"up")}),a+1<n.length&&o.createElement(l.ArrowDownOutlined,{className:"mcs-funnelQueryBuilder_sortBtn",onClick:e.sortStep.bind(e,a,"down")})),o.createElement("div",{className:"mcs-funnelQueryBuilder_step_content"},o.createElement("div",{className:"mcs-funnelQueryBuilder_stepHeader"},o.createElement("div",{className:"mcs-funnelQueryBuilder_stepName_title"},t.name),o.createElement(i.Button,{shape:"circle",icon:o.createElement(l.CloseOutlined,null),className:"mcs-funnelQueryBuilder_removeStepBtn",onClick:e.removeStep.bind(e,t.id)})),a>0&&o.createElement("div",{className:"mcs-funnelQueryBuilder_maximumDaysAfterStep"},o.createElement(i.Input,{type:"number",className:"mcs-funnelQueryBuilder_maximumDaysAfterStep_input",min:"0",value:t.max_days_after_previous_step,onChange:e.handleMaximumDaysAfterStepChange.bind(e,t.id)}),o.createElement("p",{className:"mcs-funnelQueryBuilder_maximumDaysAfterStep_desc"},t.max_days_after_previous_step&&t.max_days_after_previous_step>1?"days":"day"," maximum after previous step")),t.filter_clause.filters.map((function(n,a){return o.createElement("div",{key:n.id},a>0&&o.createElement(i.Select,{showArrow:!1,defaultValue:"AND",className:"mcs-funnelQueryBuilder_select mcs-funnelQueryBuilder_select--booleanOperators",onChange:e.handleFilterOperatorChange.bind(e,t.id),value:t.filter_clause.operator},m.booleanOperator.map((function(t){return o.createElement(O,{key:e._cuid(),value:t},t)}))),o.createElement("div",{className:"mcs-funnelQueryBuilder_step_dimensions",id:"mcs-funnelQueryBuilder_step_dimensions"},o.createElement(i.Select,{value:n.dimension_name,showSearch:!0,showArrow:!1,placeholder:"Dimension name",getPopupContainer:e.popupContainer,className:"mcs-funnelQueryBuilder_select mcs-funnelQueryBuilder_select--dimensions",onChange:e.handleDimensionNameChange.bind(e,a,t.id)},e.getDimensionNameSelect()),o.createElement("div",{className:"mcs-funnelQueryBuilder_switch"},o.createElement(i.Switch,{defaultChecked:!n.not,unCheckedChildren:"NOT",className:"mcs-funnelQueryBuilder_switch_btn",onChange:e.handleNotSwitcherChange.bind(e,a,t.id)}),n.not&&o.createElement(h.McsIcon,{type:"info",className:"mcs-funnelQueryBuilder_notInfo_notSwitcherIcon",title:"This will filter only activities that have the selected criteria filled with another value than the one(s) selected"})),o.createElement("div",{className:"mcs-funnelQueryBuilder_step_dimensionFilter_operator"},o.createElement("span",{className:"mcs-funnelQueryBuilder_step_dimensionFilter_operator_text"},e.showFilterSymbol(a,t.id))),o.createElement(_.default,{initialValue:n.expressions,datamartId:c,dimensionName:n.dimension_name,dimensionIndex:a,from:r,to:s,stepId:t.id,handleDimensionExpressionForSelectorChange:e.handleDimensionExpressionForSelectorChange.bind(e,a,t.id)}),o.createElement(i.Button,{shape:"circle",icon:o.createElement(l.CloseOutlined,null),className:"mcs-funnelQueryBuilder_removeFilterBtn",onClick:e.removeDimensionFromStep.bind(e,t.id,n.id)})))})),o.createElement(i.Button,{className:"mcs-funnelQueryBuilder_addDimensionBtn",onClick:e.addDimensionToStep.bind(e,t.id)},o.createElement(b.FormattedMessage,{id:"audience.funnel.querybuilder.newFilter",defaultMessage:"Add a filter"})))),o.createElement("div",{className:"mcs-funnelQueryBuilder_step_bullet"},o.createElement("div",{className:"mcs-funnelQueryBuilder_step_bullet_icon"})))})),o.createElement("div",{className:"mcs-funnelQueryBuilder_addStepBlock"},o.createElement("div",{className:"mcs-funnelQueryBuilder_step_timelineEnd"},o.createElement(l.FlagOutlined,{className:"mcs-funnelQueryBuilder_timeline_icon"}),s&&o.createElement("p",{className:"mcs-funnelQueryBuilder_timeline_date"},s.toMoment().format("DD/MM/YYYY 23:59"))),o.createElement(i.Button,{className:"mcs-funnelQueryBuilder_addStepBtn",onClick:this.addStep},o.createElement(b.FormattedMessage,{id:"audience.funnel.querybuilder.newStep",defaultMessage:"Add a step"})))))}}]),t}(o.Component);E([(0,d.lazyInject)(u.TYPES.IUsersAnalyticsService)],w.prototype,"_usersAnalyticsService",void 0),t.default=(0,f.compose)(p.default,g.withRouter)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(10),i=v(n(47)),s=v(n(0)),l=n(13),c=n(8),u=n(2548),d=n(2549),f=n(2550),p=n(2551),m=n(2552),g=n(2553),y=v(n(1122)),h=n(337);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._cuid=i.default,n.state={value:e.initialValue,allOptionsSelected:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"_compose",value:function(e,t){return function(n){return t(e(n))}}},{key:"_map",value:function(e){return function(t){return t.map((function(t){return e(t)}))}}},{key:"getInputField",value:function(e,t,n){var r=this,i=this.props,l=i.datamartId,c=i.match.params.organisationId,v=i.handleDimensionExpressionForSelectorChange,b=this.state,_=b.value,S=b.allOptionsSelected?"Deselect all":"Select all",E=o.Select.Option,O="mcs-funnel_expression_select_anchor",w={value:_,anchorId:O,datamartId:l,organisationId:c,className:"mcs-funnelQueryBuilder_dimensionValue",onchange:this._compose(this._map((function(e){return e.key})),v),showId:!0,multiselect:!0,displaySelectAll:!0},M={from:t,to:n},P={showSearch:!0,showArrow:!1,placeholder:"Dimension value",className:"mcs-funnelQueryBuilder_dimensionValue",filterOption:function(e,t){var n,a=null===(n=t.prop.value)||void 0===n?void 0:n.toString().toLowerCase().indexOf(e.toLowerCase());return void 0!==a&&a>-1},value:_};switch(e){case"HAS_CONVERSION":case"HAS_BOUNCED":return s.default.createElement(o.Select,a({},P,{mode:"tags",onChange:function(e){r.setState({value:e}),v(e)}}),s.default.createElement(E,{key:this._cuid(),value:"0"},"false"),s.default.createElement(E,{key:this._cuid(),value:"1"},"true"));case"EVENT_TYPE":case"DEVICE_OS_FAMILY":case"DEVICE_FORM_FACTOR":case"DEVICE_BROWSER_FAMILY":var T=h.enumValuesByName[e];return s.default.createElement(o.Select,a({},P,{mode:"tags",onChange:function(e){var t=e.includes("Select all");t&&(e=T.map((function(e){return e.toString()}))),e.includes("Deselect all")&&(e=[]),r.setState({value:e,allOptionsSelected:t}),v(e)}}),s.default.createElement(E,{key:this._cuid(),value:S},S),T.map((function(e){return s.default.createElement(E,{key:r._cuid(),value:e.toString()},e.toString())})));case"SEGMENT_ID":return s.default.createElement("div",{id:O},s.default.createElement(y.default,w));case"ORIGIN_SUB_CAMPAIGN_ID":return s.default.createElement("div",{id:O},s.default.createElement(u.AdGroupByKeywordSelector,w));case"ORIGIN_CAMPAIGN_ID":return s.default.createElement("div",{id:O},s.default.createElement(d.CampaignByKeywordSelector,w));case"GOAL_ID":return s.default.createElement("div",{id:O},s.default.createElement(g.GoalByKeywordSelector,w));case"CHANNEL_ID":return s.default.createElement("div",{id:O},s.default.createElement(f.ChannelByKeywordSelector,w));case"ORIGIN_CREATIVE_ID":return s.default.createElement("div",{id:O},s.default.createElement(p.CreativeByKeywordSelector,w));case"PRODUCT_ID":return s.default.createElement("div",{id:O},s.default.createElement(m.ProductIdByNameSelector,a({filter:M},w)));case"CATEGORY1":return s.default.createElement("div",{id:O},s.default.createElement(m.Category1ByNameSelector,a({filter:M},w)));case"CATEGORY2":return s.default.createElement("div",{id:O},s.default.createElement(m.Category2ByNameSelector,a({filter:M},w)));case"CATEGORY3":return s.default.createElement("div",{id:O},s.default.createElement(m.Category3ByNameSelector,a({filter:M},w)));case"CATEGORY4":return s.default.createElement("div",{id:O},s.default.createElement(m.Category4ByNameSelector,a({filter:M},w)));case"BRAND":return s.default.createElement("div",{id:O},s.default.createElement(m.BrandByNameSelector,a({filter:M},w)));case"DEVICE_BRAND":return s.default.createElement("div",{id:O},s.default.createElement(m.DeviceBrandByNameSelector,a({filter:M},w)));case"TYPE":return s.default.createElement("div",{id:O},s.default.createElement(m.TypeByNameSelector,a({filter:M},w)));case"DEVICE_CARRIER":return s.default.createElement("div",{id:O},s.default.createElement(m.DeviceCarrierByNameSelector,a({filter:M},w)));case"DEVICE_MODEL":return s.default.createElement("div",{id:O},s.default.createElement(m.DeviceModelByNameSelector,a({filter:M},w)));default:return s.default.createElement(o.Select,a({placeholder:"Dimension value",mode:"tags",tokenSeparators:[",","\t"],showSearch:!0,labelInValue:!0,autoFocus:!0,className:"mcs-funnelQueryBuilder_dimensionValue",onChange:this._compose(this._map((function(e){return e.key})),v)},_))}}},{key:"componentDidUpdate",value:function(e){var t=this.props.dimensionName;e.dimensionName!==t&&this.setState({value:[],allOptionsSelected:!1})}},{key:"render",value:function(){var e=this.props,t=e.from,n=e.to,a=e.dimensionName;return this.getInputField(a,t,n)}}]),t}(s.default.Component);t.default=(0,c.compose)(l.withRouter)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdGroupByKeywordSelector=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(349),i=n(312),s=n(15),l=n(12);var c=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"getForKeyword",value:function(e){return this.campaignService.findAdGroups(e.organisation_id,e).then((function(e){return e.data.sort((function(e,t){return e.name.localeCompare(t.name)}))}))}}]),e}();c([(0,s.lazyInject)(l.TYPES.IDisplayCampaignService)],u.prototype,"campaignService",void 0);var d=(0,i.ResourceByKeywordSelector)((0,o.displayNameAdapted)(),new u,"Search ad group by name");t.AdGroupByKeywordSelector=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CampaignByKeywordSelector=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(349),i=n(312),s=n(15),l=n(12);var c=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"getForKeyword",value:function(e){return this.campaignService.getDisplayCampaigns(e.organisation_id,"DISPLAY",e).then((function(e){return e.data.sort((function(e,t){return e.name.localeCompare(t.name)}))}))}}]),e}();c([(0,s.lazyInject)(l.TYPES.IDisplayCampaignService)],u.prototype,"campaignService",void 0);var d=(0,i.ResourceByKeywordSelector)((0,o.displayNameAdapted)(),new u,"Search campaign by name");t.CampaignByKeywordSelector=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelByKeywordSelector=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(349),i=n(312),s=n(15),l=n(12);var c=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"getForKeyword",value:function(e){var t=Object.assign(Object.assign({},e),{organisation_id:void 0,datamart_id:void 0});return this.channelService.getChannels(e.organisation_id,e.datamart_id,t).then((function(e){return e.data.sort((function(e,t){return e.name.localeCompare(t.name)}))}))}}]),e}();c([(0,s.lazyInject)(l.TYPES.IChannelService)],u.prototype,"channelService",void 0);var d=(0,i.ResourceByKeywordSelector)((0,o.displayNameAdapted)(),new u,"Search channel by name");t.ChannelByKeywordSelector=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreativeByKeywordSelector=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(349),i=n(312),s=n(15),l=n(12);var c=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"getForKeyword",value:function(e){var t=Object.assign({},e);return this.creativeService.getCreatives(e.organisation_id,t).then((function(e){return e.data.sort((function(e,t){return e.name.localeCompare(t.name)}))}))}}]),e}();c([(0,s.lazyInject)(l.TYPES.ICreativeService)],u.prototype,"creativeService",void 0);var d=(0,i.ResourceByKeywordSelector)((0,o.displayNameAdapted)(),new u,"Search creative by name");t.CreativeByKeywordSelector=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeviceModelByNameSelector=t.DeviceCarrierByNameSelector=t.TypeByNameSelector=t.DeviceBrandByNameSelector=t.ProductIdByNameSelector=t.BrandByNameSelector=t.Category4ByNameSelector=t.Category3ByNameSelector=t.Category2ByNameSelector=t.Category1ByNameSelector=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(15),i=n(12),s=n(312),l=n(349);var c=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dimensionName=t}return a(e,[{key:"getForKeyword",value:function(e){var t={operator:"OR",filters:[{dimension_name:this.dimensionName,operator:"LIKE",expressions:[e.keywords],case_sensitive:!1}]};return this._datamartUsersAnalyticsService.getAnalytics(e.datamart_id,[],e.from,e.to,[this.dimensionName],t).then((function(e){return e.data.report_view.rows.map((function(e){return{id:e[0].toString(),name:e[0].toString()}})).sort((function(e,t){return e.name.localeCompare(t.name)}))}))}}]),e}();c([(0,o.lazyInject)(i.TYPES.IDatamartUsersAnalyticsService)],u.prototype,"_datamartUsersAnalyticsService",void 0);var d=function(e){return(0,s.ResourceByKeywordSelector)((0,l.displayNameAdapted)(),new u(e),"Search "+e+" by keyword")},f=d("CATEGORY1"),p=d("CATEGORY2"),m=d("CATEGORY3"),g=d("CATEGORY4"),y=d("BRAND"),h=d("PRODUCT_ID"),v=d("DEVICE_BRAND"),b=d("TYPE"),_=d("DEVICE_CARRIER"),S=d("DEVICE_MODEL");t.Category1ByNameSelector=f,t.Category2ByNameSelector=p,t.Category3ByNameSelector=m,t.Category4ByNameSelector=g,t.BrandByNameSelector=y,t.ProductIdByNameSelector=h,t.DeviceBrandByNameSelector=v,t.TypeByNameSelector=b,t.DeviceCarrierByNameSelector=_,t.DeviceModelByNameSelector=S},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoalByKeywordSelector=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(349),i=n(312),s=n(15),l=n(12);var c=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"getForKeyword",value:function(e){var t=Object.assign({},e);return this.goalService.getGoals(e.organisation_id,t).then((function(e){return e.data.sort((function(e,t){return e.name.localeCompare(t.name)}))}))}}]),e}();c([(0,s.lazyInject)(l.TYPES.IGoalService)],u.prototype,"goalService",void 0);var d=(0,i.ResourceByKeywordSelector)((0,o.displayNameAdapted)(),new u,"Search goal by name");t.GoalByKeywordSelector=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=u(n(2555)),s=u(n(2557)),l=n(13),c=n(8);function u(e){return e&&e.__esModule?e:{default:e}}var d=o.Layout.Content,f=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.match.params.organisationId;return r.createElement("div",{className:"ant-layout"},r.createElement(s.default,{organisationId:e}),r.createElement("div",{className:"ant-layout"},r.createElement(d,{className:"mcs-content-container"},r.createElement(i.default,{organisationId:e}))))}}]),t}(r.Component);t.default=(0,c.compose)(l.withRouter)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=h(n(1167)),s=n(6),l=n(68),c=h(n(23)),u=n(847),d=n(8),f=h(n(2556)),p=n(54),m=n(44),g=n(12),y=n(15);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=[{id:"1",name:"Audience Segment",type:"AUDIENCE_DATA.AUDIENCE_SEGMENT"},{id:"2",name:"User Data Type",type:"AUDIENCE_DATA.USER_DATA_TYPE"},{id:"3",name:"Adex Inventory",type:"DISPLAY_CAMPAIGN.ADEX_INVENTORY"},{id:"4",name:"Real Time Bidding",type:"DISPLAY_CAMPAIGN.REAL_TIME_BIDDING"},{id:"5",name:"Visibility",type:"DISPLAY_CAMPAIGN.VISIBILITY"},{id:"6",name:"Inventory Access",type:"DISPLAY_CAMPAIGN.INVENTORY_ACCESS"},{id:"7",name:"Ad Exchance Hub Inventory",type:"DISPLAY_CAMPAIGN.AD_EXCHANGE_HUB_INVENTORY"},{id:"8",name:"Display Network Inventory",type:"DISPLAY_CAMPAIGN.DISPLAY_NETWORK_INVENTORY"}],_=[{intlMessage:i.default.providerLabel,key:"serviceProvider.id",isVisibleByDefault:!0,isHideable:!1,render:function(e){return o.createElement("span",{className:"mcs-offerCatalogTable_providerLogo"},o.createElement(f.default,{organisationId:e}))}},{intlMessage:i.default.typeLabel,key:"serviceItem.type",isVisibleByDefault:!0,isHideable:!1,render:function(e){return e.split("_").map((function(e){return""+e.charAt(0).toUpperCase()+e.slice(1)})).join(" ")}},{intlMessage:i.default.nameLabel,key:"serviceItem.name",isVisibleByDefault:!0,isHideable:!1,render:function(e){return e}},{intlMessage:i.default.priceLabel,key:"serviceCondition",isVisibleByDefault:!0,isHideable:!1,render:function(e,t){return function(e){if((0,u.isProvidedServiceItemConditionResource)(e))return i.default.freeLabel.defaultMessage;if((0,u.isLinearServiceItemConditionsResource)(e)){var t=e;if(0===t.percent_value)return Math.floor(1e3*t.fixed_value).toString()+" "+i.default.cpmLabel.defaultMessage}return i.default.quoteLabel.defaultMessage}(t.serviceCondition)}}],S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateLabels=function(e){n.setState({selectedLabels:e})},n.state={loading:!0,labels:b,selectedLabels:[],dataSource:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"fetchServiceItemData",value:function(){var e=this,t=this.props.organisationId,n=this.state.selectedLabels,a=0===n.length?void 0:{service_types:n.map((function(e){return e.type}))};this.setState({loading:!0}),this.cancelableCombinedIdPromise=(0,m.makeCancelable)(this._catalogService.findAvailableCombinedServiceItemsIds(t,Object.assign({},a))),this.cancelableCombinedIdPromise.promise.then((function(n){if(void 0===n.data||0===n.data.length)e.setState({loading:!1,dataSource:[]});else{var a=["provider_id","service_offer_id","service_item_conditions_id","service_item_id"].map((function(e){return(0,p.uniq)((0,p.map)(n.data,e))}));e.cancelableServiceItemIds=(0,m.makeCancelable)(Promise.all([e._catalogService.findAvailableServiceProvidersMultiId(t,a[0]),e._catalogService.findAvailableServiceOffersMultiId(t,a[1]),e._catalogService.findAvailableServiceConditionsMultiId(t,a[2]),e._catalogService.findAvailableServiceItemsMultiId(t,a[3])])),e.cancelableServiceItemIds.promise.then((function(t){var a=n.data.map((function(e){var n=t[0].data.find((function(t){return t.id===e.provider_id.toString()})),a=t[1].data.find((function(t){return t.id===e.service_offer_id.toString()})),r=t[2].data.find((function(t){return t.id===e.service_item_conditions_id.toString()})),o=t[3].data.find((function(t){return t.id===e.service_item_id.toString()}));if(void 0===n||void 0===a||void 0===r||void 0===o)throw new Error("Error while fetching data");return{serviceProvider:n,serviceOffer:a,serviceCondition:r,serviceItem:o}}));e.setState({loading:!1,dataSource:a})})).catch((function(t){e.setState({loading:!1}),e.props.notifyError(t)}))}})).catch((function(){e.setState({loading:!1})}))}},{key:"componentDidMount",value:function(){this.fetchServiceItemData()}},{key:"componentDidUpdate",value:function(e,t){this.state.selectedLabels!==t.selectedLabels&&this.fetchServiceItemData()}},{key:"componentWillUnmount",value:function(){this.cancelableCombinedIdPromise&&this.cancelableCombinedIdPromise.cancel(),this.cancelableServiceItemIds&&this.cancelableServiceItemIds.cancel()}},{key:"render",value:function(){var e=this,t=this.state,n=t.dataSource,a=t.loading,r=t.labels,s=t.selectedLabels,c={labels:r,selectedLabels:r.filter((function(e){return!!s.find((function(t){return t.id===e.id}))})),onChange:function(t){e.updateLabels(t)},buttonMessage:i.default.filterLabel};return o.createElement("div",{className:"mcs-table-container mcs-offerCatalogTable"},o.createElement(l.TableViewFilters,{columns:_,dataSource:n,loading:a,labelsOptions:c}))}}]),t}(o.Component);v([(0,y.lazyInject)(g.TYPES.ICatalogService)],S.prototype,"_catalogService",void 0),t.default=(0,d.compose)(s.injectIntl,c.default)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(15),l=n(12),c=n(1168),u=(a=c)&&a.__esModule?a:{default:a};var d=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={logoUrl:null,isLoading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.organisationId;this._organisationService.getLogo(t).catch((function(){return e._organisationService.getStandardLogo()})).then((function(t){return e.setState({isLoading:!1,logoUrl:URL.createObjectURL(t)})}))}},{key:"render",value:function(){return i.createElement(u.default,{organisationId:this.props.organisationId,logoUrl:this.state.logoUrl,isLoading:this.state.isLoading})}}]),t}(i.Component);t.default=f,d([(0,s.lazyInject)(l.TYPES.IOrganisationService)],f.prototype,"_organisationService",void 0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(11),l=n(6),c=n(1167),u=(a=c)&&a.__esModule?a:{default:a};var d=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.organisationId,n=[{name:e.intl.formatMessage(u.default.offerCatalogTitle),path:"/v2/o/"+t+"/marketplace/offercatalog"}];return o.createElement(s.Actionbar,{paths:n})}}]),t}(o.Component);t.default=(0,i.compose)(l.injectIntl)(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(1169),s=n(6),l=n(13),c=n(8),u=n(33),d=n(25),f=n(67),p=n(204),m=n(73);function g(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v="/v2/o/:organisationId(\\d+)",b=function(e){function t(){y(this,t);var e=h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state={current:"settings"},e.initMenu=function(t,n){var a=i.settingsDefinitions.filter((function(e){return"multi"===e.type&&e.subMenuItems&&e.subMenuItems.length>0})).find((function(e){return"multi"===e.type&&e.subMenuItems.reduce((function(e,n){return!!(0,l.matchPath)(t,{path:""+v+n.path,exact:!1,strict:!1})||e}),!1)}));a&&e.setState({current:a.iconType})},e.handleClick=function(t){e.setState({current:t.key})},e.getAvailableItems=function(){var t=e.props.hasFeature;return i.settingsDefinitions.reduce((function(e,n){if(function(e){return"simple"===e.type?t(e.requiredFeature,e.requireDatamart):e.subMenuItems.reduce((function(e,n){return t(n.requiredFeature,n.requireDatamart)?t(n.requiredFeature,n.requireDatamart):e}),!1)}(n)){if("multi"===n.type){var a=(n.subMenuItems||[]).filter((function(e){return t(e.requiredFeature,e.requireDatamart)}));return[].concat(g(e),[Object.assign(Object.assign({},n),{subMenuItems:a})])}return[].concat(g(e),[Object.assign({},n)])}return e}),[])},e.generateMenuItems=function(){var t="/v2/o/"+e.props.match.params.organisationId;return e.getAvailableItems().map((function(e){return r.createElement(o.Menu.Item,{key:e.iconType},r.createElement(u.Link,{to:""+t+("multi"===e.type&&e.subMenuItems&&e.subMenuItems.length?e.subMenuItems[0].path:"simple"===e.type&&e.path),className:"mcs-settingsMainMenu_"+e.translation.id},r.createElement(s.FormattedMessage,e.translation)))}))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.location.pathname;this.initMenu(n,t)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.match.params.organisationId,a=t.location.pathname,r=e.match.params.organisationId;e.location.pathname===a&&r===n||this.initMenu(a,n)}},{key:"render",value:function(){return r.createElement(o.Menu,{onClick:this.handleClick,selectedKeys:[this.state.current],mode:"horizontal",style:{padding:"0 40px"}},this.generateMenuItems())}}]),t}(r.Component);t.default=(0,c.compose)(l.withRouter,m.injectFeatures,(0,d.connect)((function(e){return{organisationHasDatamarts:(0,f.hasDatamarts)(e),orgFeatures:(0,p.getOrgFeatures)(e)}}),{}))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DatamartsListPage=void 0;var a,r=n(2560),o=(a=r)&&a.__esModule?a:{default:a};t.DatamartsListPage=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(6),c=n(10),u=b(n(126)),d=n(30),f=n(44),p=b(n(2561)),m=b(n(220)),g=b(n(23)),y=n(33),h=n(12),v=n(15);function b(e){return e&&e.__esModule?e:{default:e}}function _(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var O=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},w=c.Layout.Content,M={loading:!1,data:[],total:0},P=function(e){function t(){S(this,t);var e=E(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state=M,e.archiveUser=function(e){return Promise.resolve()},e.fetchDatamarts=function(t,n){e.setState({loading:!0},(function(){var a=Object.assign({allow_administrator:!0,archived:n.archived},(0,f.getPaginatedApiParam)(n.currentPage,n.pageSize));e._datamartService.getDatamarts(t,a).then((function(t){e.setState({loading:!1,data:t.data,total:t.total||t.count})})).catch((function(t){e.setState({loading:!1}),e.props.notifyError(t)}))}))},e.onClickEdit=function(t){var n=e.props,a=n.history,r=n.match.params.organisationId;a.push("/v2/o/"+r+"/settings/datamart/datamarts/"+t.id+"/edit")},e.onClickSUR=function(t){var n=e.props,a=n.history,r=n.match.params.organisationId;a.push("/v2/o/"+r+"/settings/datamart/datamarts/"+t.id+"/service_usage_report")},e.onClickSources=function(t){var n=e.props,a=n.history,r=n.match.params.organisationId;a.push("/v2/o/"+r+"/settings/datamart/datamarts/"+t.id+"/sources")},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props.match.params.organisationId,n=[{key:"action",actions:function(t){var n=[];return n.push({intlMessage:p.default.editDatamart,callback:e.onClickEdit}),"1186"===t.id&&n.push({callback:e.onClickSUR,intlMessage:p.default.serviceUsageReport}),"CROSS_DATAMART"===t.type&&n.push({callback:e.onClickSources,intlMessage:p.default.viewDatamartSources}),n}}],a=[{intlMessage:p.default.datamartId,key:"id",isHideable:!1},{intlMessage:p.default.datamartName,key:"name",isVisibleByDefault:!0,isHideable:!1,render:function(e,n){return o.createElement(y.Link,{to:"/v2/o/"+t+"/settings/datamart/datamarts/"+n.id},e)}},{intlMessage:p.default.datamartToken,key:"token",isVisibleByDefault:!0,isHideable:!1},{intlMessage:p.default.datamartType,key:"type",isVisibleByDefault:!0,isHideable:!1,render:function(e){return"DATAMART"===e?o.createElement(l.FormattedMessage,p.default.typeStandard):o.createElement(l.FormattedMessage,p.default.typeXDatamart)}}],r={iconType:"settings",message:this.props.intl.formatMessage(p.default.emptyDatamarts)},i=o.createElement("div",null,o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(l.FormattedMessage,m.default.datamarts))),o.createElement("hr",{className:"mcs-separator"}));return o.createElement("div",{className:"ant-layout"},o.createElement(w,{className:"mcs-content-container"},o.createElement(u.default,{fetchList:this.fetchDatamarts,dataSource:this.state.data,loading:this.state.loading,total:this.state.total,columns:a,actionsColumnsDefinition:n,pageSettings:[].concat(_(d.PAGINATION_SEARCH_SETTINGS),_(d.ARCHIVED_SEARCH_SETTINGS)),emptyTable:r,additionnalComponent:i})))}}]),t}(o.Component);O([(0,v.lazyInject)(h.TYPES.IDatamartService)],P.prototype,"_datamartService",void 0),t.default=(0,i.compose)(s.withRouter,l.injectIntl,g.default)(P)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(0,n(6).defineMessages)({searchPlaceholder:{id:"datamart.search.placeholder",defaultMessage:"Search Datamarts"},datamartId:{id:"settings.datamart.id",defaultMessage:"Id"},datamartToken:{id:"settings.datamart.token",defaultMessage:"Token"},datamartName:{id:"settings.datamart.name",defaultMessage:"Name"},datamartCreationDate:{id:"settings.datamart.creation_date",defaultMessage:"Creation Date"},editDatamart:{id:"settings.datamart.list.action.edit",defaultMessage:"Edit"},emptyDatamarts:{id:"settings.datamart.empty",defaultMessage:"There are no datamarts set up."},datamartType:{id:"settings.datamart.type",defaultMessage:"Type"},typeStandard:{id:"settings.datamart.type.standard",defaultMessage:"Standard Datamart"},typeXDatamart:{id:"settings.datamart.type.xdatamart",defaultMessage:"Cross-Datamart"},serviceUsageReport:{id:"settings.datamart.service_usage_report",defaultMessage:"View Service Usage Report"},noData:{id:"settings.datamart.no.data.service_usage_report",defaultMessage:"There is no service usage report for this datamart."},viewDatamartSources:{id:"settings.datamart.datamartSources",defaultMessage:"View Sources"}});t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LabelsTable=t.LabelsListPage=void 0;var a=o(n(2563)),r=o(n(1172));function o(e){return e&&e.__esModule?e:{default:e}}t.LabelsListPage=a.default,t.LabelsTable=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=b(n(0)),i=n(25),s=n(8),l=n(10),c=n(6),u=b(n(589)),d=v(n(220)),f=v(n(1171)),p=v(n(1172)),m=v(n(23)),g=n(13),y=n(15),h=n(12);function v(e){return e&&e.__esModule?e:{default:e}}function b(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=l.Layout.Content,E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleEditLabels=function(e){n.setState({modalVisible:!0,selectedLabelId:e.id,inputValue:e.name,edition:!0})},n.handleArchiveLabels=function(e,t){var a=n.props,r=a.match.params.organisationId,o=a.intl;l.Modal.confirm({title:o.formatMessage(f.default.archiveModalTitle),onOk:function(){n._labelService.deleteLabel(e.id).then((function(){t.props.fetchLabels(r,{limit:1e3})})).catch((function(e){t.setState({isCreatingLabels:!1}),t.props.notifyError(e)}))},onCancel:function(){}})},n.buildNewActionElement=function(){return o.createElement(l.Button,{key:"new",type:"primary",htmlType:"submit",onClick:function(){n.setState({modalVisible:!0,inputValue:"",selectedLabelId:""})}},o.createElement(c.FormattedMessage,f.default.newLabel))},n.handleOk=function(){var e=n.props,t=e.fetchLabels,a=e.notifyError,r=e.match.params.organisationId,o=n.state,i=o.selectedLabelId,s=o.inputValue,l=""!==i?n._labelService.updateLabel(i,s,r):n._labelService.createLabel(s,r);n.setState({isCreatingLabels:!0},(function(){return l.then((function(){n.setState({modalVisible:!1,isCreatingLabels:!1,selectedLabelId:"",inputValue:"",edition:!1}),t(r,{limit:1e3})})).catch((function(e){a(e),n.setState({isCreatingLabels:!1})}))}))},n.handleCancel=function(){n.setState({modalVisible:!1,selectedLabelId:"",inputValue:"",isCreatingLabels:!1,edition:!1})},n.handleFilterChange=function(e){n.setState({filter:e})},n.buildModalFooter=function(){var e=n.state,t=e.hasError,a=e.isCreatingLabels;return o.createElement("div",null,o.createElement(l.Button,{onClick:n.handleCancel},o.createElement(c.FormattedMessage,f.default.cancelLabel)),o.createElement(l.Button,{type:"primary",onClick:n.handleOk,loading:a,disabled:t},o.createElement(c.FormattedMessage,f.default.saveLabel)))},n.state={totalLabels:0,isFetchingLabels:!0,isCreatingLabels:!1,modalVisible:!1,hasLabels:!1,filter:{currentPage:1,pageSize:10},inputValue:"",selectedLabelId:"",hasError:!1,edition:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.totalLabels,a=t.hasLabels,r=t.filter,i=t.hasError,s=t.edition,u=this.props,m=u.isFetching,g=u.labels,y=[this.buildNewActionElement()];return o.createElement("div",{className:"ant-layout"},o.createElement(S,{className:"mcs-content-container"},o.createElement(l.Row,{className:"mcs-table-container"},o.createElement("div",null,o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(c.FormattedMessage,d.default.labels)),o.createElement("span",{className:"mcs-card-button"},y)),o.createElement("hr",{className:"mcs-separator"}),o.createElement(p.default,{dataSource:g,totalLabels:n,isFetchingLabels:m,noLabelYet:a,filter:r,onFilterChange:this.handleFilterChange,onLabelArchive:function(t){e.handleArchiveLabels(t,e)},onLabelEdit:this.handleEditLabels}),o.createElement(l.Modal,{title:s?o.createElement(c.FormattedMessage,f.default.editLabelTitle):o.createElement(c.FormattedMessage,f.default.addNewLabelTitle),visible:this.state.modalVisible,footer:this.buildModalFooter(),onCancel:this.handleCancel},i?o.createElement(l.Alert,{message:o.createElement(c.FormattedMessage,f.default.labelAlreadyExists),type:"error",style:{marginBottom:16}}):null,o.createElement(l.Input,{defaultValue:this.state.inputValue,onChange:function(t){return e.setState({inputValue:t.target.value,hasError:!!g.find((function(e){return e.name===t.target.value}))})},placeholder:"Name"}))))))}}]),t}(o.Component);_([(0,y.lazyInject)(h.TYPES.ILabelService)],E.prototype,"_labelService",void 0),t.default=(0,s.compose)(c.injectIntl,g.withRouter,m.default,(0,i.connect)((function(e){return{labels:e.labels.labelsApi.data,isFetching:e.labels.labelsApi.isFetching}}),{fetchLabels:u.fetchAllLabels.request}))(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(6),c=n(10),u=v(n(126)),d=n(30),f=n(44),p=n(2565),m=n(15),g=n(12),y=n(33),h=v(n(23));function v(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=c.Layout.Content,O={loading:!1,data:[],total:0},w=function(e){function t(){b(this,t);var e=_(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state=O,e.archiveUser=function(e){return Promise.resolve()},e.fetchUsers=function(t,n){e.setState({loading:!0},(function(){var a=Object.assign({},(0,f.getPaginatedApiParam)(n.currentPage,n.pageSize));e._organisationService.getOrganisation(t).then((function(t){return e._communityService.getCommunityUsers(t.data.community_id,a)})).then((function(t){e.setState({loading:!1,data:t.data,total:t.total||t.count})}))}))},e.onClickEdit=function(t){var n=e.props,a=n.history,r=n.match.params.organisationId;a.push("/v2/o/"+r+"/settings/organisation/users/"+t.id+"/edit")},e.redirect=function(){var t=e.props,n=t.match.params.organisationId,a=t.location,r=a.search,o=a.pathname,i=t.history,s=e.state.data,l=(0,d.parseSearch)(r,d.PAGINATION_SEARCH_SETTINGS);if(1===s.length&&1!==l.currentPage){var c=Object.assign(Object.assign({},l),{currentPage:l.currentPage-1}),u={pathname:o,search:(0,d.updateSearch)(r,c,d.PAGINATION_SEARCH_SETTINGS)};i.push(u)}else e.fetchUsers(n,l)},e.onClickDelete=function(t){var n=e.props.notifyError;e._usersService.deleteUser(t.id,t.organisation_id).then(e.redirect).catch((function(e){n(e)}))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props.match.params.organisationId,n=[{key:"action",actions:function(){return[{intlMessage:p.messages.editUser,callback:e.onClickEdit},{intlMessage:p.messages.deleteUser,callback:e.onClickDelete}]}}],a=[{intlMessage:p.messages.usersFirstName,key:"first_name",isHideable:!1,render:function(e,n){return o.createElement(y.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+t+"/settings/organisation/users/"+n.id+"/edit"},e," ",n.last_name)}},{intlMessage:p.messages.usersLastName,key:"last_name",isHideable:!1},{intlMessage:p.messages.usersEmail,key:"email",isHideable:!1}],r={iconType:"settings",message:this.props.intl.formatMessage(p.messages.emptyUsers)},i=o.createElement(c.Button,{key:"create",type:"primary",onClick:function(){return e.props.history.push("/v2/o/"+t+"/settings/organisation/users/create")}},o.createElement(l.FormattedMessage,p.messages.newUser)),s=o.createElement("div",null,o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(l.FormattedMessage,p.messages.users)),o.createElement("span",{className:"mcs-card-button"},i)),o.createElement("hr",{className:"mcs-separator"}));return o.createElement("div",{className:"ant-layout"},o.createElement(E,{className:"mcs-content-container"},o.createElement(u.default,{fetchList:this.fetchUsers,dataSource:this.state.data,loading:this.state.loading,total:this.state.total,columns:a,actionsColumnsDefinition:n,pageSettings:d.PAGINATION_SEARCH_SETTINGS,emptyTable:r,additionnalComponent:s})))}}]),t}(o.Component);S([(0,m.lazyInject)(g.TYPES.IOrganisationService)],w.prototype,"_organisationService",void 0),S([(0,m.lazyInject)(g.TYPES.ICommunityService)],w.prototype,"_communityService",void 0),S([(0,m.lazyInject)(g.TYPES.IUsersService)],w.prototype,"_usersService",void 0),t.default=(0,i.compose)(s.withRouter,l.injectIntl,h.default)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=n(6);t.messages=(0,a.defineMessages)({users:{id:"settings.organisation.users.list.title",defaultMessage:"Users"},usersFirstName:{id:"settings.organisation.users.list.first.name",defaultMessage:"First Name"},usersLastName:{id:"settings.organisation.users.list.last.name",defaultMessage:"Last Name"},usersEmail:{id:"settings.organisation.users.list.email",defaultMessage:"Email"},newUser:{id:"settings.organisation.users.list.new",defaultMessage:"New User"},editUser:{id:"settings.organisation.users.list.edit",defaultMessage:"Edit User"},deleteUser:{id:"settings.organisation.users.list.delete",defaultMessage:"Delete User"},archiveUser:{id:"settings.organisation.users.list.archive",defaultMessage:"Archive User"},emptyUsers:{id:"settings.organisation.users.list.empty",defaultMessage:"There is no User created yet!"},usersCreationDate:{id:"settings.organisation.users.list.creationDate",defaultMessage:"Creation Date"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(6),c=n(10),u=h(n(126)),d=n(30),f=n(44),p=n(2567),m=n(15),g=n(12),y=h(n(23));function h(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=c.Layout.Content,E={loading:!1,data:[],total:0,communityId:"0",communityOrgs:[]},O=function(e){function t(){v(this,t);var e=b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state=E,e.fetchUsers=function(t,n){e.setState({loading:!0},(function(){var a=Object.assign({},(0,f.getPaginatedApiParam)(n.currentPage,n.pageSize));e._organisationService.getOrganisation(t).then((function(t){e.setState({communityId:t.data.community_id}),e._usersService.getUsersWithUserRole(t.data.community_id,a).then((function(t){e.setState({loading:!1,data:t.data,total:t.total||t.count}),e._organisationService.getOrganisations(e.state.communityId).then((function(t){return e.setState({communityOrgs:t.data})}))}))}))}))},e.onClickEdit=function(t){var n=e.props,a=n.history,r=n.match.params.organisationId;a.push({pathname:"/v2/o/"+r+"/settings/organisation/user_roles/"+t.role.id+"/user/"+t.id+"/edit",state:{userOrganisationId:t.organisation_id}})},e.redirect=function(){var t=e.props,n=t.match.params.organisationId,a=t.location,r=a.search,o=a.pathname,i=t.history,s=e.state.data,l=(0,d.parseSearch)(r,d.PAGINATION_SEARCH_SETTINGS);if(1===s.length&&1!==l.currentPage){var c=Object.assign(Object.assign({},l),{currentPage:l.currentPage-1}),u={pathname:o,search:(0,d.updateSearch)(r,c,d.PAGINATION_SEARCH_SETTINGS)};i.push(u)}else e.fetchUsers(n,l)},e.onClickDelete=function(t){var n=e.props.notifyError;t.role.id&&e._userRolesService.deleteUserRole(t.id,t.role.id).then(e.redirect).catch((function(e){n(e)}))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=[{key:"action",actions:function(){return[{intlMessage:p.messages.editUserRole,callback:e.onClickEdit},{intlMessage:p.messages.deleteUserRole,callback:e.onClickDelete}]}}],n=[{intlMessage:p.messages.usersFirstName,key:"first_name",isHideable:!1},{intlMessage:p.messages.usersLastName,key:"last_name",isHideable:!1},{intlMessage:p.messages.usersEmail,key:"email",isHideable:!1},{intlMessage:p.messages.roleOrg,key:"role",isHideable:!1,render:function(t,n){var a=e.state.communityOrgs.find((function(e){return e.id===n.role.organisation_id}));return a?a.name:n.role.organisation_id}},{intlMessage:p.messages.roleTitle,key:"role",isHideable:!1,render:function(e,t){return t.role.role.charAt(0)+t.role.role.slice(1).toLowerCase().replace("_"," ")}}],a={iconType:"settings",message:this.props.intl.formatMessage(p.messages.emptyUsers)},r=o.createElement("div",null,o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(l.FormattedMessage,p.messages.userRoles))),o.createElement("hr",{className:"mcs-separator"}));return o.createElement("div",{className:"ant-layout"},o.createElement(S,{className:"mcs-content-container"},o.createElement(u.default,{fetchList:this.fetchUsers,dataSource:this.state.data,loading:this.state.loading,total:this.state.total,columns:n,actionsColumnsDefinition:t,pageSettings:d.PAGINATION_SEARCH_SETTINGS,emptyTable:a,additionnalComponent:r})))}}]),t}(o.Component);_([(0,m.lazyInject)(g.TYPES.IUsersService)],O.prototype,"_usersService",void 0),_([(0,m.lazyInject)(g.TYPES.IOrganisationService)],O.prototype,"_organisationService",void 0),_([(0,m.lazyInject)(g.TYPES.IUserRolesService)],O.prototype,"_userRolesService",void 0),t.default=(0,i.compose)(s.withRouter,l.injectIntl,y.default)(O)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a=n(6);t.messages=(0,a.defineMessages)({userRoles:{id:"settings.organisation.users.roles.list.title",defaultMessage:"User Roles"},usersFirstName:{id:"settings.organisation.users.roles.list.first.name",defaultMessage:"First Name"},usersLastName:{id:"settings.organisation.users.roles.list.last.name",defaultMessage:"Last Name"},usersEmail:{id:"settings.organisation.users.roles.list.email",defaultMessage:"Email"},roleOrg:{id:"settings.organisation.users.roles.list.role.organisation",defaultMessage:"Organisation"},roleTitle:{id:"settings.organisation.users.roles.list.role.title",defaultMessage:"Role"},newUser:{id:"settings.organisation.users.roles.list.new",defaultMessage:"New User"},editUserRole:{id:"settings.organisation.users.roles.list.edit",defaultMessage:"Edit role"},deleteUserRole:{id:"settings.organisation.users.roles.list.delete",defaultMessage:"Delete role"},emptyUsers:{id:"settings.organisation.users.roles.list.empty",defaultMessage:"There is no User created yet!"},usersCreationDate:{id:"settings.organisation.users.roles.list.creationDate",defaultMessage:"Creation Date"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(77),l=n(6),c=n(24),u=n(2569),d=(a=u)&&a.__esModule?a:{default:a},f=n(25),p=n(8),m=n(35);function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=i.Layout.Content,v=(0,l.defineMessages)({OrganisationProfile:{id:"settings.organisation.profile",defaultMessage:"Organisation Profile"},OrganisationName:{id:"settings.organisation.name",defaultMessage:"Organisation Name"},OrganisationLogo:{id:"settings.organisation.logo",defaultMessage:"Organisation Logo"}}),b=function(e){function t(){return g(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props.intl,t={labelCol:{span:4},wrapperCol:{span:10,offset:1}};return o.createElement("div",{className:"ant-layout"},o.createElement(h,{className:"mcs-content-container"},o.createElement(s.Form,{className:"edit-top"},o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(l.FormattedMessage,{id:"settings.organisation.organisationAccount.organisationProfile",defaultMessage:"Organisation Profile"}))),o.createElement("hr",{className:"mcs-separator"}),o.createElement(m.Field,{name:"organisation_name",component:c.FormInput,validate:[],props:{formItemProps:Object.assign({label:e.formatMessage(v.OrganisationName)},t),inputProps:{placeholder:e.formatMessage(v.OrganisationName),disabled:!0}}}),o.createElement(m.Field,{name:"organisation_id",component:d.default,validate:[],props:{formItemProps:Object.assign({label:e.formatMessage(v.OrganisationLogo)},t)}}))))}}]),t}(o.Component);t.default=(0,p.compose)(l.injectIntl,(0,f.connect)((function(e){return{initialValues:e.session.workspace}})),(0,m.reduxForm)({form:"organisationProfileEdit"}))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(1173),s=n(24);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=function(e){function t(){return l(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.meta,n=e.formItemProps,r=e.inputProps,l=e.helpToolTipProps,c=e.input,u="success";return t.touched&&t.invalid&&(u="error"),t.touched&&t.warning&&(u="warning"),o.createElement(s.FormFieldWrapper,a({helpToolTipProps:l,validateStatus:u},n),o.createElement(i.EditableLogo,a({id:"editable_logo",mode:"inline"},c,r)))}}]),t}(o.Component);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(25),i=n(33),s=n(8),l=n(322);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=function(e){function t(){return c(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params.organisationId;this.props.getLogoRequest({organisationId:e})}},{key:"componentDidUpdate",value:function(e){var t=this.props.match.params.organisationId;t!==e.match.params.organisationId&&this.props.getLogoRequest({organisationId:t})}},{key:"render",value:function(){var e=this.props,t=e.mode,n=e.logoUrl,a=e.match.params.organisationId;return r.createElement("div",{className:"mcs-logo-placeholder"},"inline"===t&&r.createElement("div",{className:"mcs-logo"},r.createElement(i.Link,{to:"/v2/o/"+a+"/campaigns/display",id:"logo"},r.createElement("img",{alt:"logo",src:n}))))}}]),t}(r.Component);d.defaultProps={logoUrl:""};var f={getLogoRequest:l.getLogo.request};t.default=(0,s.compose)(i.withRouter,(0,o.connect)((function(e){return{logoUrl:e.session.logoUrl}}),f))(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(25),l=n(33),c=n(6),u=n(8),d=n(41),f=n(10),p=n(322),m=n(23),g=(a=m)&&a.__esModule?a:{default:a};function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=f.Upload.Dragger,b=(0,c.defineMessages)({error:{id:"logo.error.upload",defaultMessage:"The logo file should be a PNG with a maximum size of 200kb. Please make sure the file you have selected meets those criterias."}}),_=function(e){function t(){return y(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params.organisationId;this.props.getLogoRequest({organisationId:e})}},{key:"buildDragLabel",value:function(){return i.createElement("div",{className:"mcs-logo-dragger"},i.createElement("p",{className:"ant-upload-drag-icon"},i.createElement(d.InboxOutlined,null)),i.createElement("p",{className:"ant-upload-text"},i.createElement(c.FormattedMessage,{id:"components.logo.draggerMessage",defaultMessage:"Click or drag an image in this area to upload"})),i.createElement("p",{className:"ant-upload-hint"}))}},{key:"buildLogoImageWithUpload",value:function(e){return i.createElement("div",{className:"mcs-logo-dragger"},i.createElement("img",{alt:"logo",src:e}),i.createElement("span",{id:"logoDropzone",className:"mcs-dropzone-overlay"},i.createElement("label",{htmlFor:"logoDropzone",className:"mcs-dropzone-overlay-label"},i.createElement(c.FormattedMessage,{id:"components.logo.uploadImageMessage",defaultMessage:"Upload image"}))))}},{key:"handleUpload",value:function(e,t){var n=this.props,a=n.putLogoRequest,r=n.notifyError,o=n.intl,i=t.file;"image/png"!==i.type||i.size/1024>200?r({status:"error",error:o.formatMessage(b.error),error_id:""}):a({organisationId:e,file:i})}},{key:"wrapInDraggerComponent",value:function(e){var t=this,n=this.props.match.params.organisationId;return i.createElement(v,r({},this.props,{showUploadList:!1,customRequest:function(e){return t.handleUpload(n,e)}}),e)}},{key:"render",value:function(){var e=this.props,t=e.mode,n=e.isUploadingLogo,a=e.logoUrl,r=a?this.buildLogoImageWithUpload(a):this.buildDragLabel(),o=this.wrapInDraggerComponent(r);return i.createElement("div",{className:"mcs-logo-placeholder"},"inline"===t&&i.createElement("div",{className:"mcs-logo"},o,n&&i.createElement("div",null,i.createElement(c.FormattedMessage,{id:"components.logo.loading",defaultMessage:"Logo is loading"}))))}}]),t}(i.Component);_.defaultProps={logoUrl:""};var S={getLogoRequest:p.getLogo.request,putLogoRequest:p.putLogo.request};t.default=(0,u.compose)((0,s.connect)((function(e){return{isUploadingLogo:e.session.isUploadingLogo,logoUrl:e.session.logoUrl}}),S),l.withRouter,g.default,c.injectIntl)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileSettingsPage=void 0;var a,r=n(2573),o=(a=r)&&a.__esModule?a:{default:a};t.ProfileSettingsPage=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=S(n(0)),s=n(25),l=n(8),c=n(35),u=n(41),d=n(77),f=n(10),p=n(6),m=S(n(322)),g=n(24),y=n(13),h=n(23),v=(a=h)&&a.__esModule?a:{default:a},b=n(15),_=n(12);function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var E=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=f.Layout.Content,w=(0,p.defineMessages)({sucessMessage:{id:"profile.notification.update.success.message",defaultMessage:"Your profile has been successfully updated"},sucessTitle:{id:"profile.notification.update.success.title",defaultMessage:"Success!"}}),M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateUserProfile=function(e){var t=n.props,a=t.match.params.organisationId,r=t.refreshConnectedUser,o=t.notifyError,i=t.notifySuccess,s=t.intl;n.setState({loading:!0}),n._settingsService.putProfile(a,e).then((function(e){r(),i({uid:Math.random(),message:s.formatMessage(w.sucessTitle),description:s.formatMessage(w.sucessMessage)}),n.setState({loading:!1})})).catch((function(e){n.setState({loading:!1}),o(e)}))},n.state={loading:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"buildSaveActionElement",value:function(){var e=this.props,t=e.dirty,n=e.valid;return i.createElement(f.Button,{key:"SAVE",type:"primary",htmlType:"submit",disabled:!(t&&n)},i.createElement(p.FormattedMessage,{id:"settings.profile.edit.save",defaultMessage:"Save"})," ",this.state.loading?i.createElement(u.LoadingOutlined,null):null)}},{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.intl.formatMessage,a=[this.buildSaveActionElement()],r=(0,p.defineMessages)({firstnameInputLabel:{id:"FirstName",defaultMessage:"First Name"},firstnameInputPlaceholder:{id:"FirstNamePlaceHolder",defaultMessage:"First name"},lastnameInputLabel:{id:"LastName",defaultMessage:"Last Name"},lastnameInputPlaceholder:{id:"LastNamePlaceHolder",defaultMessage:"Last name"},emailInputLabel:{id:"Email",defaultMessage:"Email"},emailInputPlaceholder:{id:"EmailPlaceHolder",defaultMessage:"Email"}}),o=(0,p.defineMessages)({invalidEmail:{id:"account.invalid_email",defaultMessage:"Invalid email address"},requiredField:{id:"account.required_field",defaultMessage:"Required"}}),s=function(e){return e?void 0:n(o.requiredField)},l={labelCol:{span:3},wrapperCol:{span:10,offset:1}},u=[{fieldName:"first_name",label:r.firstnameInputLabel,placeholder:r.firstnameInputPlaceholder,invalidCallback:s,disabled:this.state.loading},{fieldName:"last_name",label:r.lastnameInputLabel,placeholder:r.lastnameInputPlaceholder,invalidCallback:s,disabled:this.state.loading},{fieldName:"email",label:r.emailInputLabel,placeholder:r.emailInputPlaceholder,invalidCallback:function(e){return e&&!/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e)?n(o.invalidEmail):void 0},disabled:!0}];return i.createElement("div",{className:"ant-layout"},i.createElement(O,{className:"mcs-content-container"},i.createElement(d.Form,{onSubmit:t(this.updateUserProfile),className:"edit-top"},i.createElement("div",{className:"mcs-card-header mcs-card-title"},i.createElement("span",{className:"mcs-card-title"},i.createElement(p.FormattedMessage,{id:"settings.profile.edit.userProfile",defaultMessage:"User Profile"})),i.createElement("span",{className:"mcs-card-button"},a)),i.createElement("hr",{className:"mcs-separator"}),u.map((function(e){return i.createElement(c.Field,{key:e.fieldName,name:e.fieldName,component:g.FormInput,validate:[e.invalidCallback],props:{formItemProps:Object.assign({label:n(e.label),required:!0},l),inputProps:{placeholder:n(e.placeholder),disabled:!!e.disabled}}})})))))}}]),t}(i.Component);E([(0,b.lazyInject)(_.TYPES.ISettingsService)],M.prototype,"_settingsService",void 0);var P={refreshConnectedUser:m.getConnectedUser.request};t.default=(0,l.compose)(p.injectIntl,v.default,y.withRouter,(0,s.connect)((function(e){return{initialValues:e.session.connectedUser}}),P),(0,c.reduxForm)({form:"userAccountEdit"}))(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=M(n(0)),i=n(8),s=n(25),l=n(13),c=n(10),u=n(6),d=M(n(204)),f=n(2575),p=w(n(848)),m=n(2576),g=w(m),y=w(n(23)),h=n(65),v=n(159),b=w(n(200)),_=n(67),S=n(15),E=n(12),O=n(11);function w(e){return e&&e.__esModule?e:{default:e}}function M(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function P(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var T=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},I=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onSubmitFail=function(){var e=n.props.intl;c.message.error(e.formatMessage(p.default.errorFormMessage))},n.getDatamartId=function(){var e=n.props,t=e.match.params.mobileApplicationId,a=e.datamart,r=n.state,o=r.mobileApplicationData,i=r.selectedDatamartId;return t?o.mobileapplication.datamart_id?o.mobileapplication.datamart_id:a.id:i},n.shouldWarnProcessings=function(e){var t=e.initialProcessingSelectionResources,n=e.processingActivities,a=t.map((function(e){return e.processing_id})),r=n.map((function(e){return e.model.id}));return void 0!==e.mobileapplication.id&&!(a.length===r.length&&a.every((function(e){return r.includes(e)})))},n.checkProcessingsAndSave=function(e){var t=n.props.intl.formatMessage,a=n.shouldWarnProcessings(e),r=function(){n.save(e)};a?c.Modal.confirm({content:t(p.default.processingsWarningModalContent),okText:t(p.default.processingsWarningModalOk),cancelText:t(p.default.processingsWarningModalCancel),onOk:function(){return r()},onCancel:function(){}}):r()},n.save=function(e){var t=n.props,a=t.match.params.organisationId,r=t.notifyError,o=t.history,i=t.intl,s=n.getDatamartId(),l=c.message.loading(i.formatMessage(p.default.savingInProgress),0);n.setState({loading:!0});var u=function(e){return e.length&&e[0].model&&e[0].model.visit_analyzer_model_id?e[0].model.visit_analyzer_model_id:null},d=function(t){return[].concat(P(function(t){var r=n.state.mobileApplicationData.eventRulesFields.map((function(e){return e.model.id})),o=[],i=e.eventRulesFields.map((function(e){if(!e.model.id)return n._channelService.createEventRules(s,t.id,Object.assign(Object.assign({},e.model),{datamart_id:s,site_id:t.id}));if(r.includes(e.model.id)){o.push(e.model.id);var i=Object.assign(Object.assign({},e.model),{datamart_id:s,site_id:t.id});return"USER_IDENTIFIER_INSERTION"!==i.type||"USER_ACCOUNT"!==i.identifier_creation||i.compartment_id||(i.compartment_id=null),n._channelService.updateEventRules(s,t.id,a,e.model.id,i)}return Promise.resolve()})),l=r.map((function(e){return e&&!o.includes(e)?n._channelService.deleteEventRules(s,t.id,a,e):Promise.resolve()}));return[].concat(P(i),P(l))}(t)),P((r=t,o=e.initialProcessingSelectionResources,i=e.processingActivities,l=o.map((function(e){return e.processing_id})),c=i.map((function(e){return e.model.id})),u=c.filter((function(e){return!l.includes(e)})),d=l.filter((function(e){return!c.includes(e)})),f=u.map((function(e){var t=i.find((function(t){return t.model.id===e}));if(t){var a=t.model,o={processing_id:a.id,processing_name:a.name};return n._channelService.createProcessingSelectionForChannel(r.id,o)}return Promise.resolve({})})),p=d.map((function(e){var t=o.find((function(t){return t.processing_id===e}));if(t){var a=t.id;return n._channelService.deleteChannelProcessingSelection(r.id,a)}return Promise.resolve({})})),[].concat(P(f),P(p)))));var r,o,i,l,c,u,d,f,p};(function(){if(e.mobileapplication.id){var t=Object.assign(Object.assign({},e.mobileapplication),{visit_analyzer_model_id:u(e.visitAnalyzerFields),type:"MOBILE_APPLICATION"});return n._channelService.updateMobileApplication(s,e.mobileapplication.id,t).then((function(e){Promise.all(d(e.data))}))}return n._channelService.createChannel(n.props.match.params.organisationId,s,Object.assign(Object.assign({},e.mobileapplication),{visit_analyzer_model_id:u(e.visitAnalyzerFields),type:"MOBILE_APPLICATION"})).then((function(e){Promise.all(d(e.data))}))})().then((function(){l();var e="/v2/o/"+a+"/settings/channels";o.push(e)})).catch((function(e){l(),r(e),n.setState({loading:!1})}))},n.onClose=function(){var e=n.props,t=e.history,a=e.location,r="/v2/o/"+e.match.params.organisationId+"/settings/datamart/channels";return a.state&&a.state.from?t.push(a.state.from):t.push(r)},n.onDatamartSelect=function(e){n.setState({selectedDatamartId:e.id})},n.state={loading:!0,mobileApplicationData:f.INITIAL_MOBILE_APP_FORM_DATA,selectedDatamartId:e.match.params.datamartId},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match.params,a=n.mobileApplicationId,r=n.organisationId,o=t.location,i=t.datamart,s=t.notifyError,l=o.state&&o.state.mobileApplicationId,c=a||l;if(c){var u=this._channelService.getChannel(this.state.selectedDatamartId,c),d=this._channelService.getEventRules(this.state.selectedDatamartId,c,r),f=this._channelService.getProcessingSelectionsByChannel(c).then((function(t){var n=t.data;return Promise.all(n.map((function(t){return e._organisationService.getProcessing(t.processing_id).then((function(e){var n=e.data;return{processingSelectionResource:t,processingResource:n}}))})))}));Promise.all([u,d,f]).then((function(e){return{mobileapplication:e[0].data,initialProcessingSelectionResources:e[2].map((function(e){return e.processingSelectionResource})),processingActivities:e[2].map((function(e){return(0,v.createFieldArrayModel)(e.processingResource)})),visitAnalyzerFields:e[0].data.visit_analyzer_model_id?[(0,v.createFieldArrayModel)({visit_analyzer_model_id:e[0].data.visit_analyzer_model_id})]:[],eventRulesFields:e[1].data.map((function(e){return(0,v.createFieldArrayModel)(e)}))}})).then((function(t){return e.setState({loading:!1,mobileApplicationData:t,selectedDatamartId:t.mobileapplication.datamart_id?t.mobileapplication.datamart_id:i.id})})).catch((function(e){s(e)}))}else this.setState({loading:!1})}},{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.intl.formatMessage,a=this.state,r=a.loading,i=a.mobileApplicationData;if(r)return o.createElement(O.Loading,{isFullScreen:!0});var s=i.mobileapplication&&i.mobileapplication.name?n(p.default.editMobileApplicationTitle,{name:i.mobileapplication.name}):n(p.default.createMobileApplicationTitle),l=[{name:n(p.default.breadcrumbTitle1),path:"/v2/o/"+t+"/settings/datamart/channels"},{name:s}],c={formId:m.FORM_ID,paths:l,onClose:this.onClose},u=this.getDatamartId(),d=i.mobileapplication.id?i.initialProcessingSelectionResources:void 0;return u?o.createElement(g.default,{initialValues:i,onSubmit:this.checkProcessingsAndSave,close:this.onClose,breadCrumbPaths:l,onSubmitFail:this.onSubmitFail,datamartId:u,initialProcessingSelectionsForWarning:d}):o.createElement(b.default,{onSelect:this.onDatamartSelect,actionbarProps:c})}}]),t}(o.Component);T([(0,S.lazyInject)(E.TYPES.IChannelService)],I.prototype,"_channelService",void 0),T([(0,S.lazyInject)(E.TYPES.IOrganisationService)],I.prototype,"_organisationService",void 0);t.default=(0,i.compose)(l.withRouter,u.injectIntl,h.injectDatamart,(0,s.connect)((function(e){return{workspace:(0,_.getWorkspace)(e),hasFeature:d.hasFeature(e)}})),y.default)(I)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INITIAL_MOBILE_APP_FORM_DATA={mobileapplication:{type:"MOBILE_APPLICATION"},visitAnalyzerFields:[],eventRulesFields:[],initialProcessingSelectionResources:[],processingActivities:[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(35),s=n(8),l=n(10),c=n(13),u=n(6),d=b(n(60)),f=b(n(101)),p=b(n(848)),m=b(n(2577)),g=b(n(1174)),y=b(n(849)),h=b(n(420)),v=n(73);function b(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var E=l.Layout.Content,O=i.FieldArray,w=i.FieldArray,M=t.FORM_ID="mobileApplicationForm",P=i.FieldArray,T=function(e){function t(){return _(this,t),S(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.breadCrumbPaths,r=e.close,s=e.change,c=e.hasFeature,u=e.initialProcessingSelectionsForWarning,v={formChange:s,rerenderOnEveryChange:!0},b={formId:M,paths:n,message:p.default.saveMobileApp,onClose:r},_=[];_.push({id:"general",title:p.default.sectionGeneralTitle,component:o.createElement(m.default,null)});var S=Object.assign(Object.assign({},v),{initialProcessingSelectionsForWarning:u});c("datamart-user_choices")&&_.push({id:"processingActivities",title:p.default.sectionProcessingActivitiesTitle,component:o.createElement(O,a({name:"processingActivities",component:h.default,processingsAssociatedType:"CHANNEL"},S))}),_.push({id:"eventRules",title:p.default.sectionEventRulesTitle,component:o.createElement(P,a({name:"eventRulesFields",component:y.default,datamartId:this.props.datamartId},v))}),_.push({id:"visitAnalyzer",title:p.default.sectionVisitAnalyzerTitle,component:o.createElement(w,a({name:"visitAnalyzerFields",component:g.default},v))});var T={items:_.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:M},I=_.map((function(e,t){return o.createElement("div",{key:e.id},o.createElement("div",{key:e.id,id:e.id},e.component),t!==_.length-1&&o.createElement("hr",null))}));return o.createElement(l.Layout,{className:"edit-layout"},o.createElement(d.default,b),o.createElement(l.Layout,{className:"ant-layout-has-sider"},o.createElement(f.default,T),o.createElement(i.Form,{className:"edit-layout ant-layout",onSubmit:t},o.createElement("button",{type:"submit",style:{display:"none"}}),o.createElement(E,{id:M,className:"mcs-content-container mcs-form-container"},I))))}}]),t}(o.Component);t.default=(0,s.compose)(u.injectIntl,v.injectFeatures,c.withRouter,(0,i.reduxForm)({form:M,enableReinitialize:!0}))(T)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=d(n(848)),l=n(24),c=d(n(49)),u=d(n(63));function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage;return r.createElement("div",null,r.createElement(l.FormSection,{subtitle:s.default.sectionGeneralSubTitle,title:s.default.sectionGeneralTitle}),r.createElement(l.FormInputField,{name:"mobileapplication.name",component:l.FormInput,validate:[t],formItemProps:{label:n(s.default.contentSectionGeneralNameLabel),required:!0},inputProps:{placeholder:n(s.default.contentSectionGeneralNamePlaceholder)},helpToolTipProps:{title:n(s.default.contentSectionGeneralNameTooltip)}}),r.createElement(l.FormAlertInputField,{name:"mobileapplication.token",component:l.FormAlertInput,validate:[t],formItemProps:{label:n(s.default.contentSectionGeneralTokenLabel),required:!0},inputProps:{placeholder:n(s.default.contentSectionGeneralTokenPlaceholder)},helpToolTipProps:{title:n(s.default.contentSectionGeneralTokenTooltip)},iconType:"warning",type:"warning",message:n(s.default.warningOnTokenEdition)}))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,c.default,u.default)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(6),l=n(8),c=n(13),u=n(272),d=(a=u)&&a.__esModule?a:{default:a},f=n(44),p=n(15),m=n(12);function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},h=d.default,v=(0,s.defineMessages)({visitAnalyzerSelectorTitle:{id:"visit-analyzer-selector-title",defaultMessage:"Add a Visit Analyzer"},visitAnalyzerSelectorColumnName:{id:"visit-analyzer-selector-column-name",defaultMessage:"Name"},visitAnalyzerSelectorColumnType:{id:"visit-analyzer-selector-column-type",defaultMessage:"Type"},visitAnalyzerSelectorColumnProvider:{id:"visit-analyzer-selector-column-provider",defaultMessage:"Provider"}}),b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.saveVisitAnalyzers=function(e,t){n.props.save(t)},n.fetchVisitAnalyzers=function(e){var t=n.props.match.params.organisationId,a=Object.assign({},(0,f.getPaginatedApiParam)(e.currentPage,e.pageSize));return e.keywords&&(a.name=e.keywords),n._visitAnalyzerService.getVisitAnalyzers(t,a).then((function(e){return n.setState((function(){return{metadataByBidOptmizerId:e.data.reduce((function(e,t){return Object.assign(Object.assign({},e),g({},t.id,{fetching:!0}))}),{})}})),Promise.all(e.data.map((function(e){return n._visitAnalyzerService.getInstanceProperties(e.id).then((function(t){var a=t.data.find((function(e){return"name"===e.technical_name})),r=t.data.find((function(e){return"provider"===e.technical_name}));a&&r&&n.setState((function(t){return{metadataByBidOptmizerId:Object.assign(Object.assign({},t.metadataByBidOptmizerId),g({},e.id,{type:a.value.value,provider:r.value.value,fetching:!1}))}}))}))}))),e}))},n.state={metadataByBidOptmizerId:{}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.selectedVisitAnalyzerIds,a=t.close,r=t.intl.formatMessage,o=this.state.metadataByBidOptmizerId,s=[{intlMessage:v.visitAnalyzerSelectorColumnName,key:"name",render:function(e,t){return i.createElement("span",null,t.name)}},{intlMessage:v.visitAnalyzerSelectorColumnType,key:"type",render:function(e,t){return o[t.id].fetching?i.createElement("i",{className:"mcs-table-cell-loading"}):i.createElement("span",null,o[t.id].type)}},{intlMessage:v.visitAnalyzerSelectorColumnProvider,key:"provider",render:function(e,t){return o[t.id].fetching?i.createElement("i",{className:"mcs-table-cell-loading"}):i.createElement("span",null,o[t.id].provider)}}];return i.createElement(h,{actionBarTitle:r(v.visitAnalyzerSelectorTitle),displayFiltering:!0,selectedIds:n,fetchDataList:this.fetchVisitAnalyzers,fetchData:function(t){return e._visitAnalyzerService.getInstanceById(t)},singleSelection:!0,columnsDefinitions:s,save:this.saveVisitAnalyzers,close:a})}}]),t}(i.Component);y([(0,p.lazyInject)(m.TYPES.IVisitAnalyzerService)],b.prototype,"_visitAnalyzerService",void 0),t.default=(0,l.compose)(c.withRouter,s.injectIntl)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=d(n(423)),l=n(24),c=d(n(49)),u=d(n(63));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage;return r.createElement("div",null,r.createElement(l.FormSelectField,{name:"model.auto_match_type",component:l.DefaultSelect,validate:[t],formItemProps:{label:n(s.default.contentAutoMatchType),required:!0},options:[{title:"PRODUCT",value:"PRODUCT"},{title:"PRODUCT_AND_CATEGORY",value:"PRODUCT_AND_CATEGORY"},{title:"CATEGORY",value:"CATEGORY"}],helpToolTipProps:{title:n(s.default.contentAutoMatchTooltip)}}))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,c.default,u.default)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(6),l=n(25),c=n(35),u=h(n(423)),d=n(24),f=h(n(49)),p=h(n(63)),m=n(1175),g=n(12),y=n(15);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={compartments:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.datamartId;this._datamartService.getUserAccountCompartmentDatamartSelectionResources(t).then((function(t){e.setState({compartments:t.data})}))}},{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage,a=e.formValues,r=this.state.compartments.map((function(e){return{title:e.compartment_id,value:e.compartment_id}}));return o.createElement("div",null,o.createElement(d.FormSelectField,{name:"model.identifier_creation",component:d.DefaultSelect,validate:[t],formItemProps:{label:n(u.default.contentAutoMatchType),required:!0},options:[{title:"USER_ACCOUNT",value:"USER_ACCOUNT"},{title:"EMAIL_HASH",value:"EMAIL_HASH"}],helpToolTipProps:{title:n(u.default.contentAutoMatchTooltip)}}),"USER_IDENTIFIER_INSERTION"===a.model.type&&"USER_ACCOUNT"===a.model.identifier_creation&&o.createElement(d.FormSelectField,{name:"model.compartment_id",component:d.DefaultSelect,formItemProps:{label:n(u.default.userIdInsertRuleCompartmentSelectLabel),required:!0},options:r,helpToolTipProps:{title:n(u.default.userIdInsertRuleCompartmentSelectTooltip)},autoSetDefaultValue:!1,defaultValueTitle:n(u.default.userIdInsertRuleCompartmentSelectDefault)}),o.createElement(d.FormInputField,{name:"model.property_source",component:d.FormInput,validate:[t],formItemProps:{label:n(u.default.contentUserIdentifierLabel),required:!0},inputProps:{placeholder:n(u.default.contentUserIdentifierPlaceholder)},helpToolTipProps:{title:n(u.default.contentUserIdentifierTooltip)}}),o.createElement(d.FormSelectField,{name:"model.hash_function",component:d.DefaultSelect,validate:[t],formItemProps:{label:n(u.default.userIdInsertRuleHashFunctionSelectLabel),required:!0},options:[{title:"NO_HASH",value:"NO_HASH"},{title:"SHA_256",value:"SHA_256"},{title:"MD5",value:"MD5"},{title:"MD2",value:"MD2"},{title:"SHA_1",value:"SHA_1"},{title:"SHA_384",value:"SHA_384"},{title:"SHA_512",value:"SHA_512"}],helpToolTipProps:{title:n(u.default.userIdInsertRuleHashFunctionSelectTooltop)}}))}}]),t}(o.Component);v([(0,y.lazyInject)(g.TYPES.IDatamartService)],b.prototype,"_datamartService",void 0);t.default=(0,i.compose)(s.injectIntl,f.default,p.default,(0,l.connect)((function(e){return{formValues:(0,c.getFormValues)(m.FORM_ID)(e)}})))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=f(n(423)),l=n(24),c=f(n(49)),u=f(n(63)),d=f(n(2582));function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=n(35).FieldArray,y=function(e){function t(){return p(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage;return r.createElement("div",null,r.createElement(l.FormInputField,{name:"model.pattern",component:l.FormInput,validate:[t],formItemProps:{label:n(s.default.contentUriMatchPatternLabel),required:!0},inputProps:{placeholder:n(s.default.contentUriMatchPatternPlaceholder)},helpToolTipProps:{title:n(s.default.contentUriMatchPatternTooltip)}}),r.createElement(l.FormInputField,{name:"model.event_template.$event_name",component:l.FormInput,validate:[t],formItemProps:{label:n(s.default.contentUriMatchEventNameLabel),required:!0},inputProps:{placeholder:n(s.default.contentUriMatchEventNamePlaceholder)},helpToolTipProps:{title:n(s.default.contentUriMatchEventNameTooltip)}}),r.createElement(g,{name:"model.event_template.$properties",component:d.default,formItemProps:{label:n(s.default.contentUriMatchPropertyLabel),colon:!1},leftFormInput:{placeholder:n(s.default.contentUriMatchPropertyNamePlaceholder)},rightFormInput:{placeholder:n(s.default.contentUriMatchPropertyValuePlaceholder)}}))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,c.default,u.default)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(35),s=n(6),l=n(10),c=f(n(423)),u=f(n(1176)),d=n(11);function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=i.Field,y=function(e){function t(){return p(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.fields,r=t.intl,i=n.length?(n||[]).map((function(t,r,i){var s=function(){return n.remove(r)};return o.createElement("div",{key:r},o.createElement(g,a({},e.props,{name:""+t,component:u.default,renderFieldAction:function(){return o.createElement("div",{onClick:s},o.createElement(d.McsIcon,{type:"close"}))}})))})):null;return o.createElement("div",null,o.createElement(l.Row,null,o.createElement(l.Col,{span:24,offset:this.props.formItemProps.label?0:3},i)),o.createElement(l.Row,null,o.createElement(l.Col,{span:15,offset:4},o.createElement("div",{onClick:function(){return n.push({leftValue:"",rightValue:""})}},o.createElement(l.Col,{span:20,className:"add-field-button"},o.createElement("p",null,o.createElement(d.McsIcon,{type:"plus"}),r.formatMessage(c.default.AddFilterButtonText)))))))}}]),t}(o.Component);t.default=(0,s.injectIntl)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=d(n(423)),l=n(24),c=d(n(49)),u=d(n(63));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage;return r.createElement("div",null,r.createElement(l.FormInputField,{name:"model.property_name",component:l.FormInput,validate:[t],formItemProps:{label:n(s.default.contentProperty2OriginPropertyNameLabel),required:!0},inputProps:{placeholder:n(s.default.contentProperty2OriginPropertyNamePlaceholder)},helpToolTipProps:{title:n(s.default.contentProperty2OriginPropertyNameTooltip)}}),r.createElement(l.FormSelectField,{name:"model.property_source",component:l.DefaultSelect,validate:[t],formItemProps:{label:n(s.default.contentProperty2OriginPropertySourceLabel),required:!0},options:[{title:"URL",value:"URL"},{title:"EVENT_PROPERTY",value:"EVENT_PROPERTY"},{title:"REFERRER",value:"REFERRER"}],helpToolTipProps:{title:n(s.default.contentProperty2OriginPropertySourceTooltip)}}),r.createElement(l.FormInputField,{name:"model.destination",component:l.FormInput,validate:[t],formItemProps:{label:n(s.default.contentProperty2OriginDestinationLabel),required:!0},inputProps:{placeholder:n(s.default.contentProperty2OriginDestinationPlaceholder)},helpToolTipProps:{title:n(s.default.contentProperty2OriginDestinationTooltip)}}))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,c.default,u.default)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=P(n(0)),i=n(8),s=n(25),l=n(13),c=n(10),u=n(6),d=P(n(204)),f=n(2585),p=M(n(634)),m=n(2586),g=M(m),y=M(n(23)),h=n(65),v=n(159),b=M(n(200)),_=n(67),S=n(15),E=n(12),O=M(n(139)),w=n(11);function M(e){return e&&e.__esModule?e:{default:e}}function P(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function T(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var I=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onSubmitFail=function(){var e=n.props.intl;c.message.error(e.formatMessage(p.default.errorFormMessage))},n.getDatamartId=function(){var e=n.props,t=e.match.params.siteId,a=e.datamart,r=n.state,o=r.siteData,i=r.selectedDatamartId;return t?o.site.datamart_id?o.site.datamart_id:a.id:i},n.shouldWarnProcessings=function(e){var t=e.initialProcessingSelectionResources,n=e.processingActivities,a=t.map((function(e){return e.processing_id})),r=n.map((function(e){return e.model.id}));return void 0!==e.site.id&&!(a.length===r.length&&a.every((function(e){return r.includes(e)})))},n.checkProcessingsAndSave=function(e){var t=n.props.intl.formatMessage,a=n.shouldWarnProcessings(e),r=function(){n.save(e)};a?c.Modal.confirm({content:t(p.default.processingsWarningModalContent),okText:t(p.default.processingsWarningModalOk),cancelText:t(p.default.processingsWarningModalCancel),onOk:function(){return r()},onCancel:function(){}}):r()},n.save=function(e){var t=n.props,a=t.match.params.organisationId,r=t.notifyError,o=t.history,i=t.intl,s=n.getDatamartId(),l=c.message.loading(i.formatMessage(p.default.savingInProgress),0);n.setState({loading:!0});var u=function(e){return e.length&&e[0].model&&e[0].model.visit_analyzer_model_id?e[0].model.visit_analyzer_model_id:null},d=function(t){return[].concat(T(function(t){var r=n.state.siteData.eventRulesFields.map((function(e){return e.model.id})),o=[],i=e.eventRulesFields.map((function(e){if(!e.model.id)return n._channelService.createEventRules(s,t.id,Object.assign(Object.assign({},e.model),{datamart_id:s,site_id:t.id}));if(r.includes(e.model.id)){o.push(e.model.id);var i=Object.assign(Object.assign({},e.model),{datamart_id:s,site_id:t.id});return"USER_IDENTIFIER_INSERTION"!==i.type||"USER_ACCOUNT"!==i.identifier_creation||i.compartment_id||(i.compartment_id=null),n._channelService.updateEventRules(s,t.id,a,e.model.id,i)}return Promise.resolve()})),l=r.map((function(e){return e&&!o.includes(e)?n._channelService.deleteEventRules(s,t.id,a,e):Promise.resolve()}));return[].concat(T(i),T(l))}(t)),T(function(t){var r=n.state.siteData.aliases.map((function(e){return e.model.id})),o=[],i=e.aliases.map((function(e){return e.model.id?r.includes(e.model.id)?(o.push(e.model.id),n._channelService.updateAliases(s,t.id,a,e.model.id,Object.assign(Object.assign({},e.model),{site_id:t.id,organisation_id:a}))):Promise.resolve():n._channelService.createAliases(s,t.id,{organisation_id:a,site_id:t.id,name:e.model.name})})),l=r.map((function(e){return e&&!o.includes(e)?n._channelService.deleteAliases(s,t.id,a,e):Promise.resolve()}));return[].concat(T(i),T(l))}(t)),T(function(t){var a=e.initialProcessingSelectionResources,r=e.processingActivities,o=a.map((function(e){return e.processing_id})),i=r.map((function(e){return e.model.id})),s=i.filter((function(e){return!o.includes(e)})),l=o.filter((function(e){return!i.includes(e)})),c=s.map((function(e){var a=r.find((function(t){return t.model.id===e}));if(a){var o=a.model,i={processing_id:o.id,processing_name:o.name};return n._channelService.createProcessingSelectionForChannel(t.id,i)}return Promise.resolve({})})),u=l.map((function(e){var r=a.find((function(t){return t.processing_id===e}));if(r){var o=r.id;return n._channelService.deleteChannelProcessingSelection(t.id,o)}return Promise.resolve({})}));return[].concat(T(c),T(u))}(t)))};(function(){if(e.site.id){var t=Object.assign(Object.assign({},e.site),{visit_analyzer_model_id:u(e.visitAnalyzerFields)});return n._channelService.updateSite(s,e.site.id,t).then((function(e){return Promise.all(d(e.data))}))}return n._channelService.createChannel(n.props.match.params.organisationId,s,Object.assign(Object.assign({},e.site),{visit_analyzer_model_id:u(e.visitAnalyzerFields),type:"SITE"})).then((function(e){return Promise.all(d(e.data))}))})().then((function(){l();var e="/v2/o/"+a+"/settings/datamart/channels";o.push(e)})).catch((function(e){l(),r(e),n.setState({loading:!1})}))},n.onClose=function(){var e=n.props,t=e.history,a=e.location,r="/v2/o/"+e.match.params.organisationId+"/settings/datamart/channels";return a.state&&a.state.from?t.push(a.state.from):t.push(r)},n.onDatamartSelect=function(e){n.setState({selectedDatamartId:e.id})},n.state={loading:!0,siteData:f.INITIAL_SITE_FORM_DATA,selectedDatamartId:O.default.parse(e.location.search).selectedDatamartId||e.match.params.datamartId},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match.params,a=n.siteId,r=n.organisationId,o=t.location,i=t.datamart,s=t.notifyError,l=o.state&&o.state.siteId,c=a||l;if(c){var u=this._channelService.getChannel(this.state.selectedDatamartId,c),d=this._channelService.getEventRules(this.state.selectedDatamartId,c,r),f=this._channelService.getAliases(this.state.selectedDatamartId,c,r),p=this._channelService.getProcessingSelectionsByChannel(c).then((function(t){var n=t.data;return Promise.all(n.map((function(t){return e._organisationService.getProcessing(t.processing_id).then((function(e){var n=e.data;return{processingSelectionResource:t,processingResource:n}}))})))}));Promise.all([u,d,f,p]).then((function(e){return{site:e[0].data,initialProcessingSelectionResources:e[3].map((function(e){return e.processingSelectionResource})),processingActivities:e[3].map((function(e){return(0,v.createFieldArrayModel)(e.processingResource)})),visitAnalyzerFields:e[0].data.visit_analyzer_model_id?[(0,v.createFieldArrayModel)({visit_analyzer_model_id:e[0].data.visit_analyzer_model_id})]:[],eventRulesFields:e[1].data.map((function(e){return(0,v.createFieldArrayModel)(e)})),aliases:e[2].data.map((function(e){return(0,v.createFieldArrayModel)(e)}))}})).then((function(t){return e.setState({loading:!1,siteData:t,selectedDatamartId:t.site.datamart_id?t.site.datamart_id:i.id})})).catch((function(e){s(e)}))}else this.setState({loading:!1})}},{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.intl.formatMessage,a=this.state,r=a.loading,i=a.siteData;if(r)return o.createElement(w.Loading,{isFullScreen:!0});var s=i.site&&i.site.name?n(p.default.editSiteTitle,{name:i.site.name}):n(p.default.createSiteTitle),l=[{name:n(p.default.breadcrumbTitle1),path:"/v2/o/"+t+"/settings/datamart/channels"},{name:s}],c={formId:m.FORM_ID,paths:l,onClose:this.onClose},u=this.getDatamartId(),d=i.site.id?i.initialProcessingSelectionResources:void 0;return u?o.createElement(g.default,{initialValues:i,onSubmit:this.checkProcessingsAndSave,close:this.onClose,breadCrumbPaths:l,onSubmitFail:this.onSubmitFail,datamartId:u,initialProcessingSelectionsForWarning:d}):o.createElement(b.default,{onSelect:this.onDatamartSelect,actionbarProps:c})}}]),t}(o.Component);I([(0,S.lazyInject)(E.TYPES.IChannelService)],A.prototype,"_channelService",void 0),I([(0,S.lazyInject)(E.TYPES.IOrganisationService)],A.prototype,"_organisationService",void 0);t.default=(0,i.compose)(l.withRouter,u.injectIntl,h.injectDatamart,(0,s.connect)((function(e){return{workspace:(0,_.getWorkspace)(e),hasFeature:d.hasFeature(e)}})),y.default)(A)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INITIAL_SITE_FORM_DATA={site:{type:"SITE"},visitAnalyzerFields:[],eventRulesFields:[],aliases:[],initialProcessingSelectionResources:[],processingActivities:[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(35),s=n(8),l=n(10),c=n(13),u=n(6),d=_(n(60)),f=_(n(101)),p=_(n(634)),m=_(n(2587)),g=_(n(1174)),y=_(n(849)),h=_(n(2588)),v=_(n(420)),b=n(73);function _(e){return e&&e.__esModule?e:{default:e}}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var O=i.FieldArray,w=l.Layout.Content,M=i.FieldArray,P=i.FieldArray,T=i.FieldArray,I=t.FORM_ID="siteForm",A=function(e){function t(){return S(this,t),E(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.breadCrumbPaths,r=e.close,s=e.change,c=e.hasFeature,u=e.initialProcessingSelectionsForWarning,b={formChange:s,rerenderOnEveryChange:!0},_={formId:I,paths:n,message:p.default.saveSite,onClose:r},S=[];S.push({id:"general",title:p.default.sectionGeneralTitle,component:o.createElement(m.default,null)});var E=Object.assign(Object.assign({},b),{initialProcessingSelectionsForWarning:u});c("datamart-user_choices")&&S.push({id:"processingActivities",title:p.default.sectionProcessingActivitiesTitle,component:o.createElement(M,a({name:"processingActivities",component:v.default,processingsAssociatedType:"CHANNEL"},E))}),S.push({id:"aliases",title:p.default.sectionAliasesTitle,component:o.createElement(O,a({name:"aliases",component:h.default},b))}),S.push({id:"eventRules",title:p.default.sectionEventRulesTitle,component:o.createElement(T,a({name:"eventRulesFields",component:y.default,datamartId:this.props.datamartId},b))}),S.push({id:"visitAnalyzer",title:p.default.sectionVisitAnalyzer,component:o.createElement(P,a({name:"visitAnalyzerFields",component:g.default},b))});var A={items:S.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:I},C=S.map((function(e,t){return o.createElement("div",{key:e.id},o.createElement("div",{key:e.id,id:e.id},e.component),t!==S.length-1&&o.createElement("hr",null))}));return o.createElement(l.Layout,{className:"edit-layout"},o.createElement(d.default,_),o.createElement(l.Layout,{className:"ant-layout-has-sider"},o.createElement(f.default,A),o.createElement(i.Form,{className:"edit-layout ant-layout",onSubmit:t},o.createElement("button",{type:"submit",style:{display:"none"}}),o.createElement(w,{id:I,className:"mcs-content-container mcs-form-container"},C))))}}]),t}(o.Component);t.default=(0,s.compose)(u.injectIntl,b.injectFeatures,c.withRouter,(0,i.reduxForm)({form:I,enableReinitialize:!0}))(A)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=f(n(634)),l=n(24),c=f(n(49)),u=f(n(63)),d=f(n(997));function f(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators,n=t.isRequired,a=t.isValidDomain,o=e.intl.formatMessage;return r.createElement("div",null,r.createElement(l.FormSection,{subtitle:s.default.sectionGeneralSubTitle,title:s.default.sectionGeneralTitle}),r.createElement(l.FormInputField,{name:"site.name",component:l.FormInput,validate:[n],formItemProps:{label:o(s.default.contentSectionGeneralNameLabel),required:!0},inputProps:{placeholder:o(s.default.contentSectionGeneralNamePlaceholder)},helpToolTipProps:{title:o(s.default.contentSectionGeneralNameTooltip)}}),r.createElement(l.FormAlertInputField,{name:"site.token",component:d.default,validate:[n],formItemProps:{label:o(s.default.contentSectionGeneralTokenLabel),required:!0},inputProps:{placeholder:o(s.default.contentSectionGeneralTokenPlaceholder)},helpToolTipProps:{title:o(s.default.contentSectionGeneralTokenTooltip)},iconType:"warning",type:"warning",message:o(s.default.warningOnTokenEdition)}),r.createElement(l.FormInputField,{name:"site.domain",component:l.FormInput,validate:[n,a],formItemProps:{label:o(s.default.contentSectionGeneralDomainLabel),required:!0},inputProps:{placeholder:o(s.default.contentSectionGeneralDomainPlaceholder)},helpToolTipProps:{title:o(s.default.contentSectionGeneralDomainTooltip)}}))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,c.default,u.default)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(8),l=f(n(47)),c=f(n(634)),u=f(n(2589)),d=n(24);function f(e){return e&&e.__esModule?e:{default:e}}function p(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e){function t(){m(this,t);var e=g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.markAsDeleted=function(t){var n=e.props.fields.getAll(),a=n.findIndex((function(e){return e.model.name===t}));if(a>-1){var r=[].concat(p(n));r.splice(a,1),e.props.formChange(e.props.fields.name,r)}},e.addItem=function(t){var n=e.props.fields.getAll();n.find((function(e){return e.model.name===t}))&&e.props.formChange(e.props.fields.name,n);var a=[].concat(p(n));a.push({key:(0,l.default)(),model:{name:t}}),e.props.formChange(e.props.fields.name,a)},e.getStringValues=function(){return e.props.fields.getAll().map((function(e){return e.model.name}))},e.formatStringValues=function(t){var n=e.props.fields.getAll();return t.map((function(e){var t=n.find((function(t){return t.model.name===e}));return t||{key:(0,l.default)(),model:{name:e}}}))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.intl,n=e.fieldValidators.isValidDomain;return o.createElement("div",null,o.createElement(d.FormSection,{subtitle:c.default.sectionAliasesSubTitle,title:c.default.sectionAliasesTitle}),o.createElement("div",{className:"audience-catalog"},o.createElement(u.default,a({},this.props,{values:this.getStringValues(),handleClickOnRemove:this.markAsDeleted,handleClickOnItem:this.addItem,validate:[n],formItemProps:{label:t.formatMessage(c.default.contentSectionAliasesNameLabel)},inputProps:{placeholder:t.formatMessage(c.default.contentSectionAliasesNamePlaceholder)},helpToolTipProps:{title:t.formatMessage(c.default.contentSectionGAliasesNameTooltip)}}))))}}]),t}(o.Component);t.default=(0,s.compose)(i.injectIntl,d.withValidators)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(11),l=n(10),c=n(84),u=(a=c)&&a.__esModule?a:{default:a};var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onPressEnter=function(e){var t=n.props.validate;if(e){var a=[];if(t)if(Array.isArray(t)){a=t.map((function(t){return t(e)})).filter((function(e){return!!e}))}else{var r=t(e);r&&a.push(r)}if(0===a.length)return n.setState({value:"",errors:[]}),n.props.handleClickOnItem(e);n.setState({errors:a})}},n.renderFields=function(){return n.props.values.map((function(e){return i.createElement("div",{key:e,className:"audience-service-item"},e,i.createElement(s.Button,{className:"remove-button",onClick:function(t){n.props.handleClickOnRemove(e)}},i.createElement(s.McsIcon,{type:"close"})))}))},n.onChange=function(e){n.setState({value:e.target.value})},n.state={errors:[],value:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"formatErrors",value:function(e){return e.join("\n")}},{key:"render",value:function(){return i.createElement(u.default,r({helpToolTipProps:this.props.helpToolTipProps,small:this.props.small},this.props.formItemProps),i.createElement("div",{className:"selected-audience-services-container"},this.renderFields()),i.createElement(l.Input.Search,r({},this.props.inputProps,{onSearch:this.onPressEnter,onChange:this.onChange,enterButton:"Add",value:this.state.value})),this.state.errors.length>0?i.createElement("div",{className:"mics-error-text"},this.formatErrors(this.state.errors)):null)}}]),t}(i.Component);d.defaultProps={formItemProps:{},inputProps:{},helpToolTipProps:{}},t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=E(n(0)),i=n(8),s=n(25),l=n(13),c=n(10),u=n(6),d=E(n(204)),f=n(2591),p=S(n(850)),m=S(n(2592)),g=S(n(23)),y=n(65),h=n(159),v=n(12),b=n(15),_=n(11);function S(e){return e&&e.__esModule?e:{default:e}}function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function O(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var w=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getDatamartId=function(){var e=n.props,t=e.match.params.datamartId,a=e.location;return a.state&&a.state.datamartId||t},n.onSubmitFail=function(){var e=n.props.intl;c.message.error(e.formatMessage(p.default.errorFormMessage))},n.save=function(e){var t=n.props,a=t.match.params.organisationId,r=t.notifyError,o=t.history,i=t.intl,s=c.message.loading(i.formatMessage(p.default.savingInProgress),0);n.setState({loading:!0});var l=function(t){var r=n.state.datamartFormData.eventRulesFields.map((function(e){return e.model.id})),o=[],i=e.eventRulesFields.map((function(e){if(!e.model.id)return n._datamartService.createEventRules(t.id,{organisation_id:a,properties:Object.assign(Object.assign({},e.model),{datamart_id:t.id,site_id:t.id})});if(r.includes(e.model.id)){o.push(e.model.id);var i=Object.assign(Object.assign({},e.model),{datamart_id:t.id,site_id:t.id});return"USER_IDENTIFIER_INSERTION"!==i.type||"USER_ACCOUNT"!==i.identifier_creation||i.compartment_id||(i.compartment_id=null),n._datamartService.updateEventRules(t.id,e.model.id,i)}return Promise.resolve()})),s=r.map((function(e){return e&&!o.includes(e)?n._datamartService.deleteEventRules(t.id,e):Promise.resolve()}));return[].concat(O(i),O(s))};(function(){if(e.datamart.id){var t=Object.assign({},e.datamart);return n._datamartService.updateDatamart(e.datamart.id,t).then((function(e){return Promise.all(l(e.data))}))}return n._datamartService.createDatamart(n.props.match.params.organisationId,e.datamart).then((function(e){return Promise.all(l(e.data))}))})().then((function(){s();var e="/v2/o/"+a+"/settings/datamart/datamarts";o.push(e)})).catch((function(e){s(),r(e),n.setState({loading:!1})}))},n.onClose=function(){var e=n.props,t=e.history,a=e.location,r="/v2/o/"+e.match.params.organisationId+"/settings/datamart/datamarts";return a.state&&a.state.from?t.push(a.state.from):t.push(r)},n.state={loading:!0,datamartFormData:f.INITIAL_DATAMART_FORM_DATA},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.organisationId,n=this.getDatamartId();if(n){var a=this._datamartService.getDatamart(n),r=this._datamartService.getEventRules(n,t);Promise.all([a,r]).then((function(e){return{datamart:e[0].data,eventRulesFields:e[1].data.map((function(e){return(0,h.createFieldArrayModel)(e)}))}})).then((function(t){return e.setState({loading:!1,datamartFormData:t})}))}else this.setState({loading:!1})}},{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.intl.formatMessage,a=this.state,r=a.loading,i=a.datamartFormData;if(r)return o.createElement(_.Loading,{isFullScreen:!0});var s=i.datamart&&i.datamart.name?n(p.default.editDatamartTitle,{name:i.datamart.name}):n(p.default.createDatamartTitle),l=[{name:n(p.default.breadcrumbTitle1),path:"/v2/o/"+t+"/settings/datamart/datamarts"},{name:s}],c=this.getDatamartId(),u="CROSS_DATAMART"===i.datamart.type;return o.createElement(m.default,{initialValues:i,onSubmit:this.save,close:this.onClose,breadCrumbPaths:l,onSubmitFail:this.onSubmitFail,datamartId:c,isCrossDatamart:u})}}]),t}(o.Component);w([(0,b.lazyInject)(v.TYPES.IDatamartService)],M.prototype,"_datamartService",void 0),t.default=(0,i.compose)(l.withRouter,u.injectIntl,y.injectDatamart,(0,s.connect)((function(e){return{hasFeature:d.hasFeature(e)}})),g.default)(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INITIAL_DATAMART_FORM_DATA={datamart:{},eventRulesFields:[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(35),s=n(8),l=n(10),c=n(13),u=n(6),d=y(n(60)),f=y(n(101)),p=y(n(850)),m=y(n(2593)),g=y(n(849));function y(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=l.Layout.Content,_=i.FieldArray,S=t.FORM_ID="datamartForm",E=function(e){function t(){h(this,t);var e=v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.generateSections=function(t){var n=[{id:"general",title:p.default.sectionGeneralTitle,component:o.createElement(m.default,{isCrossDatamart:t})}],r={formChange:e.props.change,rerenderOnEveryChange:!0};return t||n.push({id:"eventRules",title:p.default.sectionEventRulesTitle,component:o.createElement(_,a({name:"eventRulesFields",component:g.default,datamartId:e.props.datamartId},r))}),n},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.breadCrumbPaths,a=e.close,r=e.isCrossDatamart,s={formId:S,paths:n,message:p.default.saveDatamart,onClose:a},c=this.generateSections(r),u={items:c.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:S},m=c.map((function(e,t){return o.createElement("div",{key:e.id},o.createElement("div",{key:e.id,id:e.id},e.component),t!==c.length-1&&o.createElement("hr",null))}));return o.createElement(l.Layout,{className:"edit-layout"},o.createElement(d.default,s),o.createElement(l.Layout,{className:"ant-layout-has-sider"},o.createElement(f.default,u),o.createElement(i.Form,{className:"edit-layout ant-layout",onSubmit:t},o.createElement(b,{id:S,className:"mcs-content-container mcs-form-container"},m))))}}]),t}(o.Component);t.default=(0,s.compose)(u.injectIntl,c.withRouter,(0,i.reduxForm)({form:S,enableReinitialize:!0}))(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=d(n(850)),l=n(24),c=d(n(49)),u=d(n(63));function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage,a=e.isCrossDatamart;return r.createElement("div",null,r.createElement(l.FormSection,{subtitle:s.default.sectionGeneralSubTitle,title:s.default.sectionGeneralTitle}),r.createElement(l.FormInputField,{name:"datamart.name",component:l.FormInput,validate:[t],formItemProps:{label:n(s.default.contentSectionNameLabel),required:!0},inputProps:{placeholder:n(s.default.contentSectionGeneralTokenPlaceholder)},helpToolTipProps:{title:n(s.default.contentSectionNameTooltip)}}),!a&&r.createElement(l.FormAlertInputField,{name:"datamart.token",component:l.FormAlertInput,validate:[t],formItemProps:{label:n(s.default.contentSectionGeneralTokenLabel),required:!0},inputProps:{placeholder:n(s.default.contentSectionGeneralTokenPlaceholder)},helpToolTipProps:{title:n(s.default.contentSectionGeneralTokenTooltip)},iconType:"warning",type:"warning",message:n(s.default.warningOnTokenEdition)}))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,c.default,u.default)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttributionModelContent=void 0;var a,r=n(2595),o=(a=r)&&a.__esModule?a:{default:a};t.AttributionModelContent=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(33),c=n(6),u=n(10),d=v(n(126)),f=n(30),p=n(44),m=v(n(2596)),g=n(15),y=n(12),h=n(41);function v(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=u.Layout.Content,O={loading:!1,data:[],total:0},w=function(e){function t(){b(this,t);var e=_(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state=O,e.archiveAttributionModel=function(t){return e._attributionModelService.deleteAttributionModel(t)},e.fetchAttributionModel=function(t,n){e.setState({loading:!0},(function(){var a=Object.assign({},(0,p.getPaginatedApiParam)(n.currentPage,n.pageSize));e._attributionModelService.getAttributionModels(t,a).then((function(t){var n=t.data.map((function(t){return e._pluginService.getEngineProperties(t.attribution_processor_id)}));Promise.all(n).then((function(n){var a=t.data.map((function(e,t){return Object.assign(Object.assign({},e),{properties:n[t]})}));e.setState({loading:!1,data:a,total:t.total||t.count})}))}))}))},e.onClickArchive=function(t){var n=e.props,a=n.location,r=a.pathname,i=a.state,s=a.search,l=n.history,c=n.match.params.organisationId,d=n.intl.formatMessage,p=e.state.data,g=(0,f.parseSearch)(s,f.PAGINATION_SEARCH_SETTINGS);u.Modal.confirm({icon:o.createElement(h.ExclamationCircleOutlined,null),title:d(m.default.attributionModelArchiveTitle),content:d(m.default.attributionModelArchiveTitle),okText:d(m.default.attributionModelArchiveOk),cancelText:d(m.default.attributionModelArchiveCancel),onOk:function(){e.archiveAttributionModel(t.id).then((function(){if(1===p.length&&1!==g.currentPage){var t=Object.assign(Object.assign({},g),{currentPage:g.currentPage-1});return l.replace({pathname:r,search:(0,f.updateSearch)(s,t),state:i}),Promise.resolve()}return e.fetchAttributionModel(c,g)}))},onCancel:function(){}})},e.onClickEdit=function(t){var n=e.props,a=n.history,r=n.match.params.organisationId;a.push("/v2/o/"+r+"/settings/campaigns/attribution_models/"+t.id+"/edit")},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.history,r=[{key:"action",actions:function(){return[{intlMessage:m.default.edit,callback:e.onClickEdit},{intlMessage:m.default.archive,callback:e.onClickArchive}]}}],i=[{intlMessage:m.default.name,key:"name",isHideable:!1,render:function(e,t){return o.createElement(l.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+n+"/settings/campaigns/attribution_models/"+t.id+"/edit"},e)}},{intlMessage:m.default.engine,key:"id",isHideable:!1,render:function(e,t){var n=t&&t.properties&&t.properties.find((function(e){return"name"===e.technical_name})),a=n&&n.value&&n.value.value?n.value.value:null;return o.createElement("span",null,a)}},{intlMessage:m.default.miner,key:"",isHideable:!1,render:function(e,t){var n=t&&t.properties&&t.properties.find((function(e){return"provider"===e.technical_name})),a=n&&n.value&&n.value.value?n.value.value:null;return o.createElement("span",null,a)}}],s={iconType:"settings",message:this.props.intl.formatMessage(m.default.empty)},p=[o.createElement(u.Button,{key:"create",type:"primary",onClick:function(){return a.push("/v2/o/"+n+"/settings/campaigns/attribution_models/create")}},o.createElement(c.FormattedMessage,m.default.newAttributionModel))],g=o.createElement("div",null,o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(c.FormattedMessage,m.default.attributionmodel)),o.createElement("span",{className:"mcs-card-button"},p)),o.createElement("hr",{className:"mcs-separator"}));return o.createElement("div",{className:"ant-layout"},o.createElement(E,{className:"mcs-content-container"},o.createElement(d.default,{fetchList:this.fetchAttributionModel,dataSource:this.state.data,loading:this.state.loading,total:this.state.total,columns:i,actionsColumnsDefinition:r,pageSettings:f.PAGINATION_SEARCH_SETTINGS,emptyTable:s,additionnalComponent:g})))}}]),t}(o.Component);S([(0,g.lazyInject)(y.TYPES.IPluginService)],w.prototype,"_pluginService",void 0),S([(0,g.lazyInject)(y.TYPES.IAttributionModelService)],w.prototype,"_attributionModelService",void 0),t.default=(0,i.compose)(s.withRouter,c.injectIntl)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({attributionmodel:{id:"settings.attributionmodel.breadcrumb.title",defaultMessage:"Attribution Models"},newAttributionModel:{id:"settings.attributionmodel.actionbar.button.new",defaultMessage:"New Attribution Model"},attributionModelArchiveTitle:{id:"settings.attributionmodel.modal.archive.title",defaultMessage:"Are you sure you want to archive this Attribution Model?"},attributionModelArchiveMessage:{id:"settings.attributionmodel.modal.archive.message",defaultMessage:"By archiving this Attribution Model it will stop campaigns using it. Are you sure?"},attributionModelArchiveOk:{id:"settings.attributionmodel.modal.archive.ok",defaultMessage:"Archive Now"},attributionModelArchiveCancel:{id:"settings.attributionmodel.modal.archive.cancel",defaultMessage:"Cancel"},name:{id:"settings.attributionmodel.list.column.name",defaultMessage:"Name"},engine:{id:"settings.attributionmodel.list.column.engine",defaultMessage:"Attribution Model Engine"},miner:{id:"settings.attributionmodel.list.column.miner",defaultMessage:"Data Miner"},empty:{id:"settings.attributionmodel.list.empty",defaultMessage:"There is no Attribution Models created yet! Click on New to get started"},edit:{id:"settings.attributionmodel.list.actionColumn.edit",defaultMessage:"Edit"},archive:{id:"settings.attributionmodel.list.actionColumn.archive",defaultMessage:"Archive"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=n(6),c=n(13),u=n(347),d=(a=u)&&a.__esModule?a:{default:a},f=n(24),p=n(15),m=n(12);function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},v=d.default,b=(0,l.defineMessages)({listTitle:{id:"settings.attributionmodel.edit.list.title",defaultMessage:"Attribution Models"},listSubTitle:{id:"settings.attributionmodel.edit.list.subtitle",defaultMessage:"New Attribution Model"},attributionModelNewBreadcrumb:{id:"settings.attributionmodel.create.breadcrumb.newtitle",defaultMessage:"New Attribution Model"},attributionModelEditBreadcrumb:{id:"settings.attributionmodel.create.breadcrumb.edittitle",defaultMessage:"Edit {name}"},attributionModelModeLabel:{id:"settings.attributionmodel.mode.label",defaultMessage:"Mode"},attributionModelModeStrict:{id:"settings.attributionmodel.mode.strict",defaultMessage:"Strict"},attributionModelModeDiscovery:{id:"settings.attributionmodel.mode.discovery",defaultMessage:"Dicovery"},attributionModelModeTooltip:{id:"settings.attributionmodel.mode.tooltip",defaultMessage:"'Strict' mode allows you to attribute only the campaigns that are linked to your goal, whereas 'discovery' helps your attribute the latest matching campaigns. By default disovery will be applied"}}),_=function(e){function t(){g(this,t);var e=y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.redirect=function(){var t=e.props,n=t.history,a="/v2/o/"+t.match.params.organisationId+"/settings/campaigns/attribution_models";n.push(a)},e.saveOrCreatePluginInstance=function(t,n){var a=e.props,r=a.match.params.organisationId;a.history.push("/v2/o/"+r+"/settings/campaigns/attribution_models")},e.createPluginInstance=function(e,t,n){return{version_id:n.version_id,version_value:n.version_value,attribution_processor_id:t.id,mode:n.mode,artifact_id:t.artifact_id,group_id:t.group_id,organisation_id:e,name:n.name}},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.match.params,a=n.attributionModelId,r=n.organisationId;return i.createElement(v,{pluginType:"ATTRIBUTION_PROCESSOR",listTitle:b.listTitle,listSubTitle:b.listSubTitle,breadcrumbPaths:function(e){return[{name:t(b.listTitle),path:"/v2/o/"+r+"/settings/campaigns/attribution_models"},{name:e?t(b.attributionModelEditBreadcrumb,{name:e.name}):t(b.attributionModelNewBreadcrumb)}]},pluginInstanceService:this._attributionModelService,pluginInstanceId:a,createPluginInstance:this.createPluginInstance,onSaveOrCreatePluginInstance:this.saveOrCreatePluginInstance,onClose:this.redirect,renderSpecificFields:function(e,n){return i.createElement(f.FormSelectField,{name:n+".mode",component:f.DefaultSelect,formItemProps:{label:t(b.attributionModelModeLabel)},helpToolTipProps:{title:t(b.attributionModelModeTooltip)},options:[{title:t(b.attributionModelModeStrict),value:"STRICT"},{title:t(b.attributionModelModeDiscovery),value:"DISCOVERY"}],disabled:e})}})}}]),t}(i.Component);h([(0,p.lazyInject)(m.TYPES.IAttributionModelService)],_.prototype,"_attributionModelService",void 0),t.default=(0,s.compose)(c.withRouter,l.injectIntl)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmailRouterContent=void 0;var a,r=n(2599),o=(a=r)&&a.__esModule?a:{default:a};t.EmailRouterContent=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(33),c=n(10),u=n(6),d=v(n(126)),f=n(44),p=n(30),m=v(n(2600)),g=n(15),y=n(12),h=n(41);function v(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=c.Layout.Content,O={loading:!1,data:[],total:0},w=function(e){function t(){b(this,t);var e=_(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state=O,e.archiveEmailRouter=function(t){return e._emailRouterService.deleteEmailRouter(t)},e.fetchEmailRouter=function(t,n){e.setState({loading:!0},(function(){var a=Object.assign({},(0,f.getPaginatedApiParam)(n.currentPage,n.pageSize));e._emailRouterService.getEmailRouters(t,a).then((function(t){e.setState({loading:!1,data:t.data,total:t.total||t.count})}))}))},e.onClickArchive=function(t){var n=e.props,a=n.location,r=a.search,i=a.pathname,s=a.state,l=n.history,u=n.match.params.organisationId,d=n.intl.formatMessage,f=e.state.data,g=(0,p.parseSearch)(r,p.PAGINATION_SEARCH_SETTINGS);c.Modal.confirm({icon:o.createElement(h.ExclamationCircleOutlined,null),title:d(m.default.emailRouterArchiveTitle),content:d(m.default.emailRouterArchiveMessage),okText:d(m.default.emailRouterArchiveOk),cancelText:d(m.default.emailRouterArchiveCancel),onOk:function(){e.archiveEmailRouter(t.id).then((function(){if(1===f.length&&1!==g.currentPage){var t=Object.assign(Object.assign({},g),{currentPage:g.currentPage-1});return l.replace({pathname:i,search:(0,p.updateSearch)(r,t),state:s}),Promise.resolve()}return e.fetchEmailRouter(u,g)}))},onCancel:function(){}})},e.onClickEdit=function(t){var n=e.props,a=n.history,r=n.match.params.organisationId;a.push("/v2/o/"+r+"/settings/campaigns/email_routers/"+t.id+"/edit")},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.history,r=[{key:"action",actions:function(){return[{intlMessage:m.default.edit,callback:e.onClickEdit},{intlMessage:m.default.archive,callback:e.onClickArchive}]}}],i=[{intlMessage:m.default.name,key:"name",isHideable:!1,render:function(e,t){return o.createElement(l.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+n+"/settings/campaigns/email_routers/"+t.id+"/edit"},e)}}],s={iconType:"settings",message:this.props.intl.formatMessage(m.default.empty)},f=[o.createElement(c.Button,{key:"create",type:"primary",onClick:function(){return a.push("/v2/o/"+n+"/settings/campaigns/email_routers/create")}},o.createElement(u.FormattedMessage,m.default.newEmailRouter))],g=o.createElement("div",null,o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(u.FormattedMessage,m.default.emailrouter)),o.createElement("span",{className:"mcs-card-button"},f)),o.createElement("hr",{className:"mcs-separator"}));return o.createElement("div",{className:"ant-layout"},o.createElement(E,{className:"mcs-content-container"},o.createElement(d.default,{fetchList:this.fetchEmailRouter,dataSource:this.state.data,loading:this.state.loading,total:this.state.total,columns:i,actionsColumnsDefinition:r,pageSettings:p.PAGINATION_SEARCH_SETTINGS,emptyTable:s,additionnalComponent:g})))}}]),t}(o.Component);S([(0,g.lazyInject)(y.TYPES.IEmailRouterService)],w.prototype,"_emailRouterService",void 0),t.default=(0,i.compose)(s.withRouter,u.injectIntl)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({emailrouter:{id:"settings.emailrouter.breadcrumb.title",defaultMessage:"Email Routers"},newEmailRouter:{id:"settings.emailrouter.actionbar.button.new",defaultMessage:"New Email Router"},emailRouterArchiveTitle:{id:"settings.emailrouter.modal.archive.title",defaultMessage:"Are you sure you want to archive this Email Router?"},emailRouterArchiveMessage:{id:"settings.emailrouter.modal.archive.message",defaultMessage:"By archiving this Email Router it will stop campaigns using it. Are you sure?"},emailRouterArchiveOk:{id:"settings.emailrouter.modal.archive.ok",defaultMessage:"Archive Now"},emailRouterArchiveCancel:{id:"settings.emailrouter.modal.archive.cancel",defaultMessage:"Cancel"},name:{id:"settings.emailrouter.list.column.name",defaultMessage:"Name"},engine:{id:"settings.emailrouter.list.column.engine",defaultMessage:"Email Router Engine"},miner:{id:"settings.emailrouter.list.column.miner",defaultMessage:"Data Miner"},empty:{id:"settings.emailrouter.list.empty",defaultMessage:"There is no Email Routers created yet! Click on New to get started"},edit:{id:"settings.emailrouter.list.actionColumn.edit",defaultMessage:"Edit"},archive:{id:"settings.emailrouter.list.actionColumn.archive",defaultMessage:"Archive"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateEditEmailRouter=void 0;var a,r=n(2602),o=(a=r)&&a.__esModule?a:{default:a};t.CreateEditEmailRouter=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(6),l=n(13),c=p(n(2603)),u=p(n(347)),d=n(15),f=n(12);function p(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},h=u.default,v=function(e){function t(){m(this,t);var e=g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.redirect=function(){var t=e.props,n=t.history,a="/v2/o/"+t.match.params.organisationId+"/settings/campaigns/email_routers";n.push(a)},e.onSaveOrCreatePluginInstance=function(t,n){var a=e.props,r=a.match.params.organisationId;a.history.push("/v2/o/"+r+"/settings/campaigns/email_routers")},e.createPluginInstance=function(e,t,n){return{version_id:n.version_id,version_value:n.version_value,artifact_id:t.artifact_id,group_id:t.group_id,organisation_id:e,name:n.name}},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.match.params,a=n.emailRouterId,r=n.organisationId;return o.createElement(h,{pluginType:"EMAIL_ROUTER",listTitle:c.default.listTitle,listSubTitle:c.default.listSubTitle,breadcrumbPaths:function(e){return[{name:t(c.default.listTitle),path:"/v2/o/"+r+"/settings/campaigns/email_routers"},{name:e?t(c.default.emailRouterEditBreadcrumb,{name:e.name}):t(c.default.emailRouterNewBreadcrumb)}]},pluginInstanceService:this._emailRouterService,pluginInstanceId:a,createPluginInstance:this.createPluginInstance,onSaveOrCreatePluginInstance:this.onSaveOrCreatePluginInstance,onClose:this.redirect})}}]),t}(o.Component);y([(0,d.lazyInject)(f.TYPES.IEmailRouterService)],v.prototype,"_emailRouterService",void 0),t.default=(0,i.compose)(s.injectIntl,l.withRouter)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({listTitle:{id:"emailrouter.edit.list.title",defaultMessage:"Email Routers"},listSubTitle:{id:"emailrouter.edit.list.subtitle",defaultMessage:"New Email Router"},emailRouterNewBreadcrumb:{id:"emailrouter.create.breadcrumb.newtitle",defaultMessage:"New Email Router"},emailRouterEditBreadcrumb:{id:"emailrouter.create.breadcrumb.edititle",defaultMessage:"Edit {name}"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommenderContent=void 0;var a,r=n(2605),o=(a=r)&&a.__esModule?a:{default:a};t.RecommenderContent=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(33),c=n(6),u=n(10),d=v(n(126)),f=n(30),p=n(44),m=v(n(2606)),g=n(15),y=n(12),h=n(41);function v(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=u.Layout.Content,O={loading:!1,data:[],total:0},w=function(e){function t(){b(this,t);var e=_(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state=O,e.archiveRecommender=function(t){return e._recommenderService.deleteRecommender(t)},e.fetchRecommender=function(t,n){e.setState({loading:!0},(function(){var a=Object.assign({},(0,p.getPaginatedApiParam)(n.currentPage,n.pageSize));e._recommenderService.getRecommenders(t,a).then((function(t){var n=t.data.map((function(t){return new Promise((function(n,a){e._pluginService.getEngineVersion(t.version_id).then((function(t){return e._pluginService.getEngineProperties(t.id)})).then((function(e){return n(e)}))}))}));Promise.all(n).then((function(n){var a=t.data.map((function(e,t){return Object.assign(Object.assign({},e),{properties:n[t]})}));e.setState({loading:!1,data:a,total:t.total||t.count})}))}))}))},e.onClickArchive=function(t){var n=e.props,a=n.location,r=a.search,i=a.pathname,s=a.state,l=n.history,c=n.match.params.organisationId,d=n.intl.formatMessage,p=e.state.data,g=(0,f.parseSearch)(r,f.PAGINATION_SEARCH_SETTINGS);u.Modal.confirm({icon:o.createElement(h.ExclamationCircleOutlined,null),title:d(m.default.recommenderArchiveTitle),content:d(m.default.recommenderArchiveMessage),okText:d(m.default.recommenderArchiveOk),cancelText:d(m.default.recommenderArchiveCancel),onOk:function(){e.archiveRecommender(t.id).then((function(){if(1===p.length&&1!==g.currentPage){var t=Object.assign(Object.assign({},g),{currentPage:g.currentPage-1});return l.replace({pathname:i,search:(0,f.updateSearch)(r,t),state:s}),Promise.resolve()}return e.fetchRecommender(c,g)}))},onCancel:function(){}})},e.onClickEdit=function(t){var n=e.props,a=n.history,r=n.match.params.organisationId;a.push("/v2/o/"+r+"/settings/campaigns/recommenders/"+t.id+"/edit")},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.history,r=[{key:"action",actions:function(){return[{intlMessage:m.default.edit,callback:e.onClickEdit},{intlMessage:m.default.archive,callback:e.onClickArchive}]}}],i=[{intlMessage:m.default.processor,key:"name",isHideable:!1,render:function(e,t){return o.createElement(l.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+n+"/settings/campaigns/recommenders/"+t.id+"/edit"},e)}},{intlMessage:m.default.provider,key:"id",isHideable:!1,render:function(e,t){var n=t&&t.properties&&t.properties.find((function(e){return"name"===e.technical_name})),a=n&&n.value&&n.value.value?n.value.value:null;return o.createElement("span",null,a)}},{intlMessage:m.default.name,key:"version_id",isHideable:!1,render:function(e,t){var n=t&&t.properties&&t.properties.find((function(e){return"provider"===e.technical_name})),a=n&&n.value&&n.value.value?n.value.value:null;return o.createElement("span",null,a)}}],s={iconType:"settings",message:this.props.intl.formatMessage(m.default.empty)},p=[o.createElement(u.Button,{key:"create",type:"primary",onClick:function(){return a.push("/v2/o/"+n+"/settings/campaigns/recommenders/create")}},o.createElement(c.FormattedMessage,m.default.newRecommender))],g=o.createElement("div",null,o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(c.FormattedMessage,m.default.recommender)),o.createElement("span",{className:"mcs-card-button"},p)),o.createElement("hr",{className:"mcs-separator"}));return o.createElement("div",{className:"ant-layout"},o.createElement(E,{className:"mcs-content-container"},o.createElement(d.default,{fetchList:this.fetchRecommender,dataSource:this.state.data,loading:this.state.loading,total:this.state.total,columns:i,actionsColumnsDefinition:r,pageSettings:f.PAGINATION_SEARCH_SETTINGS,emptyTable:s,additionnalComponent:g})))}}]),t}(o.Component);S([(0,g.lazyInject)(y.TYPES.IPluginService)],w.prototype,"_pluginService",void 0),S([(0,g.lazyInject)(y.TYPES.IRecommenderService)],w.prototype,"_recommenderService",void 0),t.default=(0,i.compose)(s.withRouter,c.injectIntl)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({recommender:{id:"settings.recommender.breadcrumb.title",defaultMessage:"Recommenders"},newRecommender:{id:"settings.recommender.actionbar.button.new",defaultMessage:"New Recommender"},recommenderArchiveTitle:{id:"settings.recommender.modal.archive.title",defaultMessage:"Are you sure you want to archive this Recommender?"},recommenderArchiveMessage:{id:"settings.recommender.modal.archive.message",defaultMessage:"By archiving this Recommender it will stop campaigns using it. Are you sure?"},recommenderArchiveOk:{id:"settings.recommender.modal.archive.ok",defaultMessage:"Archive Now"},recommenderArchiveCancel:{id:"settings.recommender.modal.archive.cancel",defaultMessage:"Cancel"},name:{id:"settings.recommender.list.column.name",defaultMessage:"Name"},processor:{id:"settings.recommender.list.column.processor",defaultMessage:"Recommender Processor"},provider:{id:"settings.recommender.list.column.provider",defaultMessage:"Provider"},empty:{id:"settings.recommender.list.empty",defaultMessage:"There is no Recommender List created yet! Click on New to get started"},edit:{id:"settings.recommender.list.actionColumn.edit",defaultMessage:"Edit"},archive:{id:"settings.recommender.list.actionColumn.archive",defaultMessage:"Archive"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateEditRecommender=void 0;var a,r=n(2608),o=(a=r)&&a.__esModule?a:{default:a};t.CreateEditRecommender=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(6),l=n(13),c=p(n(2609)),u=p(n(347)),d=n(15),f=n(12);function p(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},h=u.default,v=function(e){function t(){m(this,t);var e=g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.redirect=function(){var t=e.props,n=t.history,a="/v2/o/"+t.match.params.organisationId+"/settings/campaigns/recommenders";n.push(a)},e.onSaveOrCreatePluginInstance=function(t,n){var a=e.props,r=a.match.params.organisationId;a.history.push("/v2/o/"+r+"/settings/campaigns/recommenders")},e.createPluginInstance=function(e,t,n){return{version_id:n.version_id,version_value:n.version_value,artifact_id:t.artifact_id,group_id:t.group_id,organisation_id:e,recommenders_plugin_id:t.id,name:n.name}},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.match.params,a=n.recommenderId,r=n.organisationId;return o.createElement(h,{pluginType:"RECOMMENDER",listTitle:c.default.listTitle,listSubTitle:c.default.listSubTitle,breadcrumbPaths:function(e){return[{name:t(c.default.listTitle),path:"/v2/o/"+r+"/settings/campaigns/recommenders"},{name:e?t(c.default.recommenderEditBreadcrumb,{name:e.name}):t(c.default.recommenderNewBreadcrumb)}]},pluginInstanceService:this._recommenderService,pluginInstanceId:a,createPluginInstance:this.createPluginInstance,onSaveOrCreatePluginInstance:this.onSaveOrCreatePluginInstance,onClose:this.redirect})}}]),t}(o.Component);y([(0,d.lazyInject)(f.TYPES.IRecommenderService)],v.prototype,"_recommenderService",void 0),t.default=(0,i.compose)(s.injectIntl,l.withRouter)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({listTitle:{id:"recommenders.edit.list.title",defaultMessage:"Recommenders"},listSubTitle:{id:"recommenders.edit.list.subtitle",defaultMessage:"New Recommender"},recommenderNewBreadcrumb:{id:"recommenders.create.breadcrumb.newtitle",defaultMessage:"New Recommender"},recommenderEditBreadcrumb:{id:"recommenders.create.breadcrumb.edititle",defaultMessage:"Edit {name}"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VisitAnalyzerContent=void 0;var a,r=n(2611),o=(a=r)&&a.__esModule?a:{default:a};t.VisitAnalyzerContent=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(0),i=b(o),s=n(8),l=n(13),c=n(33),u=n(6),d=n(10),f=b(n(126)),p=n(30),m=n(44),g=b(n(2612)),y=n(15),h=n(12),v=n(41);function b(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=d.Layout.Content,w={loading:!1,data:[],total:0},M=function(e){function t(){_(this,t);var e=S(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state=w,e.archiveVisitAnalyzer=function(t){return e._visitAnalyzerService.deleteVisitAnalyzerProperty(t)},e.fetchVisitAnalyzer=function(t,n){e.setState({loading:!0},(function(){var a=Object.assign({},(0,m.getPaginatedApiParam)(n.currentPage,n.pageSize));e._visitAnalyzerService.getVisitAnalyzers(t,a).then((function(t){var n=t.data.map((function(t){return new Promise((function(n,a){e._pluginService.getEngineVersion(t.version_id).then((function(t){return e._pluginService.getEngineProperties(t.id)})).then((function(e){return n(e)}))}))}));Promise.all(n).then((function(n){var a=t.data.map((function(e,t){return Object.assign(Object.assign({},e),{properties:n[t]})}));e.setState({loading:!1,data:a,total:t.total||t.count})}))}))}))},e.onClickArchive=function(t){var n=e.props,a=n.location,r=a.search,o=a.state,s=a.pathname,l=n.history,c=n.match.params.organisationId,u=n.intl.formatMessage,f=e.state.data,m=(0,p.parseSearch)(r,p.PAGINATION_SEARCH_SETTINGS);d.Modal.confirm({icon:i.default.createElement(v.ExclamationCircleOutlined,null),title:u(g.default.visitAnalyzerArchiveTitle),content:u(g.default.visitAnalyzerArchiveMessage),okText:u(g.default.visitAnalyzerArchiveOk),cancelText:u(g.default.visitAnalyzerArchiveCancel),onOk:function(){e.archiveVisitAnalyzer(t.id).then((function(){if(1===f.length&&1!==m.currentPage){var t=Object.assign(Object.assign({},m),{currentPage:m.currentPage-1});return l.replace({pathname:s,search:(0,p.updateSearch)(r,t),state:o}),Promise.resolve()}return e.fetchVisitAnalyzer(c,m)}))},onCancel:function(){}})},e.onClickEdit=function(t){var n=e.props,a=n.history,r=n.match.params.organisationId;a.push("/v2/o/"+r+"/settings/datamart/visit_analyzers/"+t.id+"/edit")},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.history,r=[{key:"action",actions:function(){return[{intlMessage:g.default.edit,callback:e.onClickEdit},{intlMessage:g.default.archive,callback:e.onClickArchive}]}}],o=[{intlMessage:g.default.name,key:"name",isHideable:!1,render:function(e,t){return i.default.createElement(c.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+n+"/settings/datamart/visit_analyzers/"+t.id+"/edit"},e)}},{intlMessage:g.default.processor,key:"version_id",isHideable:!1,render:function(e,t){var n=t&&t.properties&&t.properties.find((function(e){return"name"===e.technical_name})),a=n&&n.value&&n.value.value?n.value.value:null;return i.default.createElement("span",null,a)}},{intlMessage:g.default.provider,key:"id",isHideable:!1,render:function(e,t){var n=t&&t.properties&&t.properties.find((function(e){return"provider"===e.technical_name})),a=n&&n.value&&n.value.value?n.value.value:null;return i.default.createElement("span",null,a)}}],s={iconType:"settings",message:this.props.intl.formatMessage(g.default.empty)},l=[i.default.createElement(d.Button,{key:"create",type:"primary",onClick:function(){return a.push("/v2/o/"+n+"/settings/datamart/visit_analyzers/create")}},i.default.createElement(u.FormattedMessage,g.default.newVisitAnalyzer))],m=i.default.createElement("div",null,i.default.createElement("div",{className:"mcs-card-header mcs-card-title"},i.default.createElement("span",{className:"mcs-card-title"},i.default.createElement(u.FormattedMessage,g.default.visitAnalyzer)),i.default.createElement("span",{className:"mcs-card-button"},l)),i.default.createElement("hr",{className:"mcs-separator"}));return i.default.createElement("div",{className:"ant-layout"},i.default.createElement(O,{className:"mcs-content-container"},i.default.createElement(f.default,{fetchList:this.fetchVisitAnalyzer,dataSource:this.state.data,loading:this.state.loading,total:this.state.total,columns:o,actionsColumnsDefinition:r,pageSettings:p.PAGINATION_SEARCH_SETTINGS,emptyTable:s,additionnalComponent:m})))}}]),t}(o.Component);E([(0,y.lazyInject)(h.TYPES.IPluginService)],M.prototype,"_pluginService",void 0),E([(0,y.lazyInject)(h.TYPES.IVisitAnalyzerService)],M.prototype,"_visitAnalyzerService",void 0),t.default=(0,s.compose)(l.withRouter,u.injectIntl)(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({visitAnalyzer:{id:"settings.visitAnalyzer.breadcrumb.title",defaultMessage:"Visit Analyzers"},newVisitAnalyzer:{id:"settings.visitAnalyzer.actionbar.button.new",defaultMessage:"New Visit Analyzer"},visitAnalyzerArchiveTitle:{id:"settings.visitAnalyzer.modal.archive.title",defaultMessage:"Are you sure you want to archive this Visit Analyzer?"},visitAnalyzerArchiveMessage:{id:"settings.visitAnalyzer.modal.archive.message",defaultMessage:"By archiving this Visit Analyzer it will stop campaigns using it. Are you sure?"},visitAnalyzerArchiveOk:{id:"settings.visitAnalyzer.modal.archive.ok",defaultMessage:"Archive Now"},visitAnalyzerArchiveCancel:{id:"settings.visitAnalyzer.modal.archive.cancel",defaultMessage:"Cancel"},name:{id:"settings.visitAnalyzer.list.column.name",defaultMessage:"Name"},processor:{id:"settings.visitAnalyzer.list.column.processor",defaultMessage:"Visit Analyser Processor"},provider:{id:"settings.visitAnalyzer.list.column.provider",defaultMessage:"Provider"},empty:{id:"settings.visitAnalyzer.list.empty",defaultMessage:"There is no Visit Analyzer List created yet! Click on New to get started"},edit:{id:"settings.visitAnalyzer.list.actionColumn.edit",defaultMessage:"Edit"},archive:{id:"settings.visitAnalyzer.list.actionColumn.archive",defaultMessage:"Archive"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateEditVisitAnalyzer=void 0;var a,r=n(2614),o=(a=r)&&a.__esModule?a:{default:a};t.CreateEditVisitAnalyzer=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(6),l=n(13),c=p(n(347)),u=p(n(2615)),d=n(15),f=n(12);function p(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},h=c.default,v=function(e){function t(){m(this,t);var e=g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.redirect=function(){var t=e.props,n=t.history,a="/v2/o/"+t.match.params.organisationId+"/settings/datamart/visit_analyzers";n.push(a)},e.onSaveOrCreatePluginInstance=function(t,n){var a=e.props,r=a.match.params.organisationId;a.history.push("/v2/o/"+r+"/settings/datamart/visit_analyzers")},e.createPluginInstance=function(e,t,n){return{version_id:n.version_id,version_value:n.version_value,visit_analyzer_plugin_id:t.id,artifact_id:t.artifact_id,group_id:t.group_id,organisation_id:e,name:n.name}},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.match.params,a=n.visitAnalyzerId,r=n.organisationId;return o.createElement(h,{pluginType:"ACTIVITY_ANALYZER",listTitle:u.default.listTitle,listSubTitle:u.default.listSubTitle,breadcrumbPaths:function(e){return[{name:t(u.default.listTitle),path:"/v2/o/"+r+"/settings/datamart/visit_analyzers"},{name:e?t(u.default.visitAnalyzerEditBreadcrumb,{name:e.name}):t(u.default.visitAnalyzerBreadcrumb)}]},pluginInstanceService:this._visitAnalyzerService,pluginInstanceId:a,createPluginInstance:this.createPluginInstance,onSaveOrCreatePluginInstance:this.onSaveOrCreatePluginInstance,onClose:this.redirect})}}]),t}(o.Component);y([(0,d.lazyInject)(f.TYPES.IVisitAnalyzerService)],v.prototype,"_visitAnalyzerService",void 0),t.default=(0,i.compose)(l.withRouter,s.injectIntl)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({listTitle:{id:"visitanalyzer.edit.list.title",defaultMessage:"Visit Analyzers"},listSubTitle:{id:"visitanalyzer.edit.list.subtitle",defaultMessage:"New Visit Analyzer"},visitAnalyzerBreadcrumb:{id:"visitanalyzer.create.breadcrumb.newtitle",defaultMessage:"New Visit Analyzer"},visitAnalyzerEditBreadcrumb:{id:"visitanalyzer.create.breadcrumb.editTitle",defaultMessage:"Edit {name}"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(13),l=n(6),c=n(8),u=n(10),d=n(51),f=n(2617),p=(a=f)&&a.__esModule?a:{default:a},m=n(124),g=n(15),y=n(12);var h=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},v=(0,l.defineMessages)({newUser:{id:"settings.organisation.users.edit.newUser",defaultMessage:"New User"},users:{id:"settings.organisation.users.edit.users",defaultMessage:"Users"},user:{id:"settings.organisation.users.edit.user",defaultMessage:"User"},editUser:{id:"settings.organisation.users.edit.edit",defaultMessage:"Edit {name}"},savingInProgress:{id:"settings.organisation.users.edit.savingInProgress",defaultMessage:"Saving in progress"},updateSuccess:{id:"settings.organisation.users.edit.UserSuccessfullySaved",defaultMessage:"User successfully saved"},updateError:{id:"settings.organisation.users.edit.userUpdateFailed",defaultMessage:"User update failed"},emailAlreadyExists:{id:"settings.organisation.users.edit.emailAlreadyExists",defaultMessage:"Email already exists"}});function b(e){return"EMAIL_ALREADY_EXISTS"===e.error_code?v.emailAlreadyExists:v.updateError}var _={first_name:"",email:""},S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.close=function(){var e=n.props,t=e.history,a="/v2/o/"+e.match.params.organisationId+"/settings/organisation/users";return t.push(a)},n.save=function(e){var t=n.props,a=t.match.params,r=a.organisationId,o=a.userId,i=t.intl;n.setState({loading:!0});var s=u.message.loading(i.formatMessage(v.savingInProgress),0),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;n.setState({loading:!1}),s(),n.close(),null===e?u.message.success(i.formatMessage(v.updateSuccess)):u.message.error(i.formatMessage(b(e)))};(o?n._usersService.updateUser(o,r,e):n._usersService.createUser(r,e)).then((function(){l(null)})).catch((function(e){l(e),(0,m.notifyError)(e)}))},n.state={loading:!1,userData:_},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params,n=t.organisationId,a=t.userId;a&&this._usersService.getUser(a,n).then((function(e){return e.data})).then((function(t){e.setState({userData:t})}))}},{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.match.params,a=n.organisationId,r=n.userId,o=this.state,s=o.userData,l=o.loading,c=r?t(v.editUser,{name:s.first_name?s.first_name:t(v.user)}):t(v.newUser),u=[{name:t(v.users),path:"/v2/o/"+a+"/settings/organisation/users"},{name:c}];return l?i.createElement(d.Loading,{isFullScreen:!0}):i.createElement(p.default,{initialValues:s,onSave:this.save,onClose:this.close,breadCrumbPaths:u})}}]),t}(i.Component);h([(0,g.lazyInject)(y.TYPES.IUsersService)],S.prototype,"_usersService",void 0),t.default=(0,c.compose)(s.withRouter,l.injectIntl)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(8),s=n(35),l=n(13),c=n(6),u=m(n(60)),d=m(n(101)),f=m(n(2618)),p=m(n(1177));function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=o.Layout.Content,v=(0,c.defineMessages)({sectionTitleGeneral:{id:"settings.organisation.users.edit.generalInformationSection.title",defaultMessage:"General Information"},sectionTitleRole:{id:"settings.organisation.users.edit.roleInformationSection.title",defaultMessage:"Role Information"},saveUser:{id:"settings.organisation.users.edit.saveButton",defaultMessage:"Save User"}}),b=function(e){function t(){g(this,t);var e=y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFormSections=function(){var e=[],t={id:"general",title:v.sectionTitleGeneral,component:r.createElement(f.default,null)},n={id:"role",title:v.sectionTitleRole,component:r.createElement(p.default,null)};return e.push(t),e.push(n),e},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.onSave,a={formId:"userForm",paths:this.props.breadCrumbPaths,message:v.saveUser,onClose:this.props.onClose},i=this.buildFormSections(),l={items:i.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:"userForm"},c=i.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==i.length-1&&r.createElement("hr",null))}));return r.createElement(o.Layout,{className:"edit-layout"},r.createElement(u.default,a),r.createElement(o.Layout,{className:"ant-layout-has-sider"},r.createElement(d.default,l),r.createElement(s.Form,{className:"edit-layout ant-layout",onSubmit:t(n)},r.createElement("button",{type:"submit",style:{display:"none"}}),r.createElement(h,{id:"userForm",className:"mcs-content-container mcs-form-container"},r.createElement("div",{className:"placement-list-form"},c)))))}}]),t}(r.Component);t.default=(0,i.compose)(l.withRouter,c.injectIntl,(0,s.reduxForm)({form:"userForm",enableReinitialize:!0}))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=u(n(49)),l=u(n(63)),c=n(24);function u(e){return e&&e.__esModule?e:{default:e}}var d=(0,i.defineMessages)({sectionSubtitleGeneral:{id:"settings.organisation.users.edit.generalInfoSection.subtitle",defaultMessage:"Modify your User's data."},sectionTitleGeneral:{id:"settings.organisation.users.edit.generalInfoSection.title",defaultMessage:"General Information"},labelUserFirstName:{id:"settings.organisation.users.edit.generalInfoSection.label.firstname",defaultMessage:"First Name"},labelUserLastName:{id:"settings.organisation.users.edit.generalInfoSection.label.lastname",defaultMessage:"Last Name"},tootltipUserFirstName:{id:"settings.organisation.users.edit.generalInfoSection.tooltip.firstname",defaultMessage:"Give your User a first name."},tootltipUserLastName:{id:"settings.organisation.users.edit.generalInfoSection.tooltip.lastname",defaultMessage:"Give your User a last name."},labelUserEmail:{id:"settings.organisation.users.edit.generalInfoSection.label.email",defaultMessage:"Email"},tootltipUserEmail:{id:"settings.organisation.users.edit.generalInfoSection.tooltip.email",defaultMessage:"Give your User an email"},advancedFormSectionButtontext:{id:"settings.organisation.users.edit.generalInfoSection.advanced.button",defaultMessage:"Advanced"}}),f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage;return r.createElement("div",null,r.createElement(c.FormSection,{subtitle:d.sectionSubtitleGeneral,title:d.sectionTitleGeneral}),r.createElement("div",null,r.createElement(c.FormInputField,{name:"first_name",component:c.FormInput,validate:[t],formItemProps:{label:n(d.labelUserFirstName),required:!0},inputProps:{placeholder:n(d.labelUserFirstName)},helpToolTipProps:{title:n(d.tootltipUserFirstName)}}),r.createElement(c.FormInputField,{name:"last_name",component:c.FormInput,validate:[t],formItemProps:{label:n(d.labelUserLastName),required:!0},inputProps:{placeholder:n(d.labelUserLastName)},helpToolTipProps:{title:n(d.tootltipUserLastName)}}),r.createElement(c.FormInputField,{name:"email",component:c.FormInput,validate:[t],formItemProps:{label:n(d.labelUserEmail),required:!0},inputProps:{placeholder:n(d.labelUserEmail)},helpToolTipProps:{title:n(d.tootltipUserEmail)}})))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,s.default,l.default)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.roleOptions=[{title:"Reader",value:"READER"},{title:"Editor",value:"EDITOR"},{title:"Organisation administrator",value:"ORGANISATION_ADMIN"},{title:"Community administrator",value:"COMMUNITY_ADMIN"}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=E(n(17)),l=n(33),c=n(13),u=E(n(225)),d=n(271),f=n(788),p=n(6),m=n(10),g=E(n(126)),y=n(30),h=E(n(23)),v=n(25),b=n(15),_=n(12),S=n(11);function E(e){return e&&e.__esModule?e:{default:e}}var O=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},w=m.Layout.Content,M={loading:!1,data:[],total:0,isModalVisible:!1,saving:!1,name:""},P=(0,p.defineMessages)({apiTokenName:{id:"settings.profile.apitoken.list.name",defaultMessage:"Api Token name"},apiTokenValue:{id:"settings.profile.apitoken.list.value",defaultMessage:"Value"},apiTokenCreationDate:{id:"settings.profile.apitoken.list.creation.date",defaultMessage:"Creation date"},apiTokenExpirationDate:{id:"settings.profile.apitoken.list.expiration.date",defaultMessage:"Expiration date"},emptyApiTokenList:{id:"settings.profile.empty.apitoken.list",defaultMessage:"No Api Token"},apiTokens:{id:"settings.profile.apitoken.list.title",defaultMessage:"Api Tokens"},newApiToken:{id:"settings.profile.new.apitoken",defaultMessage:"New Api Token"},deleteApiToken:{id:"settings.profile.apitoken.list.delete.button",defaultMessage:"Revoke"},editApiToken:{id:"settings.profile.apitoken.list.edit.button",defaultMessage:"Edit"},deleteApiTokenModalTitle:{id:"settings.profile.apitoken.delete.modal.title",defaultMessage:"Are you sure to revoke this Api Token ?"},nextButtonApiTokenModal:{id:"settings.profile.apitoken.modal.next.buttin",defaultMessage:"Next"},deleteApiTokenModalContent:{id:"settings.profile.apitoken.delete.modal.content",defaultMessage:"If you revoke this Api Token, you will not be able to get it back and any application using this token will cease to work."},dangerZone:{id:"settings.profile.apitoken.dangerzone",defaultMessage:"DANGER ZONE!!"},deleteApiTokenModalOkText:{id:"settings.profile.apitoken.delete.modal.ok.text",defaultMessage:"Revoke Anyway"},createApiTokenModalTitle:{id:"settings.profile.apitoken.create.modal.title",defaultMessage:"Do you want to create a new Api Token ?"},createApiTokenModalContent:{id:"settings.profile.apitoken.create.modal.content",defaultMessage:"Give your Api Token a name. Be aware that you can only see once an API token. Make sure to copy it right away as you will not be able to view it afterwards"},createApiTokenModalOkText:{id:"settings.profile.apitoken.create.modal.ok.text",defaultMessage:"Create"},apiTokenModalTitle:{id:"settings.profile.apitoken.modal.title",defaultMessage:"Your Api Token"},apiTokenModalContent:{id:"settings.profile.apitoken.modal.content",defaultMessage:"MAKE SURE TO COPY THIS TOKEN!! You will not be able to get it back afterwards, click on the token to copy it to your clipboard."},ApiTokenModalCancelText:{id:"settings.profile.apitoken.delete.modal.cancel.text",defaultMessage:"Cancel"},apiTokenSuccessfullyDeleted:{id:"settings.profile.apitoken.successfully.deleted",defaultMessage:"Api Token successfully revoked."},apiTokenSuccessfullySaved:{id:"settings.profile.apitoken.successfully.saved",defaultMessage:"Api Token successfully saved. Give it a name."},snippetCodeCopied:{id:"settings.profile.apitoken.code.copied",defaultMessage:"Code snippet copied"}}),T=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchApiTokens=function(e,t){var a=n.props.connectedUser;n.setState({loading:!0},(function(){n._apiTokenService.getApiTokens(a.id,e).then((function(e){n.setState({loading:!1,data:e.data,total:e.total||e.count})})).catch((function(e){n.setState({loading:!1}),n.props.notifyError(e)}))}))},n.onClickEdit=function(e){var t=n.props,a=t.history,r=t.match.params.organisationId;a.push("/v2/o/"+r+"/settings/account/api_tokens/"+e.id+"/edit")},n.onDelete=function(e){var t=n.props,a=t.intl,r=t.connectedUser,i=t.match.params.organisationId,s=t.notifyError;m.Modal.confirm({title:a.formatMessage(P.deleteApiTokenModalTitle),content:o.createElement("div",null,o.createElement(m.Alert,{message:a.formatMessage(P.dangerZone),type:"error"}),o.createElement("br",null),o.createElement("p",null,a.formatMessage(P.deleteApiTokenModalContent))),okText:a.formatMessage(P.deleteApiTokenModalOkText),cancelText:a.formatMessage(P.ApiTokenModalCancelText),onOk:function(){n.setState({loading:!0}),n._apiTokenService.deleteApiToken(e.id,r.id,i).then((function(){m.message.success(a.formatMessage(P.apiTokenSuccessfullyDeleted));n.fetchApiTokens(i,{currentPage:1,pageSize:10})})).catch((function(e){s(e)}))},onCancel:function(){}})},n.handleModal=function(){n.setState({isModalVisible:!n.state.isModalVisible,name:""})},n.state=M,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.intl,r=this.state,i=r.isModalVisible,c=r.loading,h=r.saving,v=r.name,b=[{key:"action",actions:function(){return[{intlMessage:P.editApiToken,callback:e.onClickEdit},{intlMessage:P.deleteApiToken,callback:e.onDelete}]}}],_=[{intlMessage:P.apiTokenName,key:"name",isVisibleByDefault:!0,isHideable:!1,render:function(e,t){return o.createElement(l.Link,{to:"/v2/o/"+n+"/settings/account/api_tokens/"+t.id+"/edit"},e)}},{intlMessage:P.apiTokenValue,key:"value",isVisibleByDefault:!0,isHideable:!1,render:function(e){return o.createElement("div",null,e.substring(0,25)+"...")}},{intlMessage:P.apiTokenCreationDate,key:"creation_date",isVisibleByDefault:!0,isHideable:!1,render:function(e,t){return(0,s.default)(parseInt(e,10)).format("DD/MM/YYYY")}},{intlMessage:P.apiTokenExpirationDate,key:"expiration_date",isVisibleByDefault:!0,isHideable:!1,render:function(e,t){var n=Date.now(),a=t.expiration_date-n<2592e6?t.expiration_date-n<0?"expirated":"warning":"ok";return o.createElement("span",null,(0,s.default)(parseInt(e,10)).format("DD/MM/YYYY"),o.createElement(S.McsIcon,{type:"status",className:"apitoken-status-"+a}))}}],E={iconType:"settings",message:a.formatMessage(P.emptyApiTokenList)},O=o.createElement(m.Button,{key:"create",type:"primary",onClick:this.handleModal},o.createElement(p.FormattedMessage,P.newApiToken)),M=o.createElement("div",null,o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(p.FormattedMessage,P.apiTokens)),o.createElement("span",{className:"mcs-card-button"},O)),o.createElement("hr",{className:"mcs-separator"}));return o.createElement("div",{className:"ant-layout"},o.createElement(w,{className:"mcs-content-container"},o.createElement(g.default,{fetchList:this.fetchApiTokens,dataSource:this.state.data,loading:c,total:this.state.total,columns:_,actionsColumnsDefinition:b,pageSettings:y.PAGINATION_SEARCH_SETTINGS,emptyTable:E,additionnalComponent:M})),o.createElement(m.Modal,{title:a.formatMessage(P.createApiTokenModalTitle),visible:i,onOk:function(){var t=e.props,a=t.connectedUser,r=t.notifyError;e.setState({saving:!0}),e._apiTokenService.createApiToken(a.id,n,{name:e.state.name}).then((function(e){return e.data})).then((function(t){e.setState({saving:!1}),e.handleModal(),function(t){var a=e.props.intl.formatMessage;m.Modal.warning({title:a(P.apiTokenModalTitle),width:"600px",content:o.createElement("div",null,o.createElement(m.Alert,{message:a(P.apiTokenModalContent),type:"warning"}),o.createElement("br",null),o.createElement(f.CopyToClipboard,{text:t.value,onCopy:function(e){m.message.info(a(P.snippetCodeCopied))}},o.createElement("div",{style:{cursor:"pointer"}},o.createElement(u.default,{language:"json",style:d.docco},t.value)))),okText:a(P.nextButtonApiTokenModal),onOk:function(){m.message.success(a(P.apiTokenSuccessfullySaved),5);e.fetchApiTokens(n,{currentPage:1,pageSize:10})}})}(t)})).catch((function(t){e.setState({saving:!1}),e.handleModal(),r(t)}))},confirmLoading:h,onCancel:this.handleModal,cancelText:a.formatMessage(P.ApiTokenModalCancelText),okText:a.formatMessage(P.createApiTokenModalOkText)},o.createElement("p",null,a.formatMessage(P.createApiTokenModalContent)),o.createElement("br",null),o.createElement(m.Input,{onChange:function(t){return e.setState({name:t.target.value})},value:v,placeholder:a.formatMessage(P.apiTokenName)})))}}]),t}(o.Component);O([(0,b.lazyInject)(_.TYPES.IApiTokenService)],T.prototype,"_apiTokenService",void 0);t.default=(0,i.compose)(c.withRouter,p.injectIntl,h.default,(0,v.connect)((function(e){return{connectedUser:e.session.connectedUser}}),void 0))(T)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(13),l=n(6),c=n(8),u=n(10),d=n(25),f=n(51),p=n(124),m=n(2622),g=(a=m)&&a.__esModule?a:{default:a},y=n(15),h=n(12);var v=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=(0,l.defineMessages)({newApiToken:{id:"new.ApiToken",defaultMessage:"New Api Token"},apiTokens:{id:"edit.ApiToken.ApiToken",defaultMessage:"Api Tokens"},apiToken:{id:"edit.apiToken.apiToken",defaultMessage:"Api Token"},editApiToken:{id:"edit.ApiToken",defaultMessage:"Edit {name}"},savingInProgress:{id:"form.ApiToken.saving.in.progress",defaultMessage:"Saving in progress"},updateSuccess:{id:"edit.ApiToken.success.message",defaultMessage:"Api Token successfully saved"},updateError:{id:"edit.ApiToken.error.message",defaultMessage:"Api Token update failed"}}),_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.close=function(){var e=n.props,t=e.history,a="/v2/o/"+e.match.params.organisationId+"/settings/account/api_tokens";return t.push(a)},n.save=function(e){var t=n.props,a=t.match.params,r=a.organisationId,o=a.apiTokenId,i=t.intl,s=t.connectedUser;n.setState({loading:!0});var l=u.message.loading(i.formatMessage(b.savingInProgress),0),c=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.setState({loading:!1}),l(),n.close(),e?u.message.success(i.formatMessage(b.updateSuccess)):u.message.error(i.formatMessage(b.updateError))};(o?n._apiTokenService.updateApiToken(o,s.id,r,e):n._apiTokenService.createApiToken(s.id,r,e)).then((function(){c(!0)})).catch((function(e){c(),(0,p.notifyError)(e)}))},n.state={loading:!1,apiTokenData:{}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match.params,a=n.organisationId,r=n.apiTokenId,o=t.connectedUser;r&&this._apiTokenService.getApiToken(r,o.id,a).then((function(e){return e.data})).then((function(t){e.setState({apiTokenData:t})}))}},{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.match.params,a=n.organisationId,r=n.apiTokenId,o=this.state,s=o.apiTokenData,l=o.loading,c=r?t(b.editApiToken,{name:s.name}):t(b.apiToken),u=[{name:t(b.apiTokens),path:"/v2/o/"+a+"/settings/account/api_tokens"},{name:c}];return l?i.createElement(f.Loading,{isFullScreen:!0}):i.createElement(g.default,{initialValues:s,onSave:this.save,onClose:this.close,breadCrumbPaths:u})}}]),t}(i.Component);v([(0,y.lazyInject)(h.TYPES.IApiTokenService)],_.prototype,"_apiTokenService",void 0);t.default=(0,c.compose)(s.withRouter,l.injectIntl,(0,d.connect)((function(e){return{connectedUser:e.session.connectedUser}}),void 0))(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(8),s=n(35),l=n(13),c=n(6),u=p(n(60)),d=p(n(101)),f=p(n(2623));function p(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=o.Layout.Content,h=(0,c.defineMessages)({sectionTitleGeneral:{id:"settings.profile.apiToken.edit.generalInfoSection.title",defaultMessage:"General Information"},saveApiToken:{id:"settings.profile.apiToken.edit.saveButton",defaultMessage:"Save Api Token"}}),v=function(e){function t(){m(this,t);var e=g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFormSections=function(){var e=[],t={id:"general",title:h.sectionTitleGeneral,component:r.createElement(f.default,null)};return e.push(t),e},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.onSave,a={formId:"userForm",paths:this.props.breadCrumbPaths,message:h.saveApiToken,onClose:this.props.onClose},i=this.buildFormSections(),l={items:i.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:"userForm"},c=i.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==i.length-1&&r.createElement("hr",null))}));return r.createElement(o.Layout,{className:"edit-layout"},r.createElement(u.default,a),r.createElement(o.Layout,{className:"ant-layout-has-sider"},r.createElement(d.default,l),r.createElement(s.Form,{className:"edit-layout ant-layout",onSubmit:t(n)},r.createElement("button",{type:"submit",style:{display:"none"}}),r.createElement(y,{id:"userForm",className:"mcs-content-container mcs-form-container"},r.createElement("div",{className:"placement-list-form"},c)))))}}]),t}(r.Component);t.default=(0,i.compose)(l.withRouter,c.injectIntl,(0,s.reduxForm)({form:"userForm",enableReinitialize:!0}))(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=u(n(49)),l=u(n(63)),c=n(24);function u(e){return e&&e.__esModule?e:{default:e}}var d=(0,i.defineMessages)({sectionSubtitleGeneral:{id:"settings.profile.apiToken.edit.general.subtitle",defaultMessage:"Modify your Api Token's data."},sectionTitleGeneral:{id:"settings.profile.apiToken.edit.general.title",defaultMessage:"General Information"},labelApiTokenName:{id:"settings.profile.apiToken.edit.general.label.name",defaultMessage:"Name"},tootltipApiTokenName:{id:"settings.profile.apiToken.edit.general.tooltip.name",defaultMessage:"Give your Api Token a first name."},advancedFormSectionButtontext:{id:"settings.profile.apiToken.edit.general.advanced.button",defaultMessage:"Advanced"}}),f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage;return r.createElement("div",null,r.createElement(c.FormSection,{subtitle:d.sectionSubtitleGeneral,title:d.sectionTitleGeneral}),r.createElement("div",null,r.createElement(c.FormInputField,{name:"name",component:c.FormInput,validate:[t],formItemProps:{label:n(d.labelApiTokenName),required:!0},inputProps:{placeholder:n(d.labelApiTokenName)},helpToolTipProps:{title:n(d.tootltipApiTokenName)}})))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,s.default,l.default)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(8),l=n(10),c=n(6),u=S(n(220)),d=S(n(23)),f=n(44),p=n(30),m=n(13),g=n(33),y=S(n(126)),h=S(n(838)),v=n(12),b=n(15),_=n(11);function S(e){return e&&e.__esModule?e:{default:e}}var E=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=l.Layout.Content,w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchOffers=function(e,t){n.setState({loading:!0});var a=Object.assign({organisation_id:e},(0,f.getPaginatedApiParam)(t.currentPage,t.pageSize));n._catalogService.getMyOffers(a).then((function(e){n.setState({loading:!1,data:e.data,total:e.total||e.count})})).catch((function(e){n.setState({loading:!1}),n.props.notifyError(e)}))},n.state={loading:!1,data:[],total:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.state,t=e.loading,n=e.data,r=e.total,o=this.props.match.params.organisationId,s=[{intlMessage:u.default.name,key:"name",isHideable:!1,render:function(e,t){return i.createElement(g.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+o+"/settings/services/my_offers/"+t.id+"/service_item_conditions"},e)}},{intlMessage:u.default.creditedAccount,key:"credited_account_name",isHideable:!1,render:function(e,t){return i.createElement("span",null,e)}},{intlMessage:u.default.providerName,key:"provider_name",isHideable:!1,render:function(e,t){return i.createElement("span",null,e)}}],d={iconType:"settings",message:this.props.intl.formatMessage(u.default.empty)};return i.createElement("div",{className:"ant-layout"},i.createElement(O,{className:"mcs-content-container"},i.createElement(l.Row,{className:"mcs-table-container"},i.createElement(l.Breadcrumb,{className:"mcs-breadcrumb",separator:i.createElement(_.McsIcon,{type:"chevron-right"})},i.createElement(l.Breadcrumb.Item,null,i.createElement("span",{style:{lineHeight:"40px"}},i.createElement(c.FormattedMessage,u.default.myServiceOffersTitle)),i.createElement(g.Link,{to:"/v2/o/"+o+"/settings/services/my_offers/create"},i.createElement(h.default,a({},{htmlType:"submit",onClick:function(){return null},type:"primary"},{className:"mcs-primary",style:{float:"right"}}),i.createElement(_.McsIcon,{type:"plus"}),i.createElement(c.FormattedMessage,u.default.myServiceOffersAddNew)))))),i.createElement(y.default,{fetchList:this.fetchOffers,dataSource:n,loading:t,total:r,columns:s,pageSettings:p.PAGINATION_SEARCH_SETTINGS,emptyTable:d})))}}]),t}(i.Component);E([(0,b.lazyInject)(v.TYPES.ICatalogService)],w.prototype,"_catalogService",void 0),t.default=(0,s.compose)(m.withRouter,c.injectIntl,d.default)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(1178),s=(a=i)&&a.__esModule?a:{default:a};function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=function(e){function t(){return l(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){return o.createElement(s.default,{offerOwnership:"subscribed_offer"})}}]),t}(o.Component);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=n(10),l=n(851),c=n(847);var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onChange=function(e){var t=n.props.serviceItemCondition,a=n.props.intl;if(t&&(0,c.isLinearServiceItemConditionsResource)(t)){var r=e.target.value&&/^[0-9]+(\.[0-9]{1,2})?$/i.test(e.target.value);n.setState({price:r?a.formatMessage(l.messages.serviceItemPrice)+" "+(parseFloat(e.target.value)*t.percent_value+t.fixed_value).toFixed(2)+" €":a.formatMessage(l.messages.invalidImpressionCost)})}},n.state={price:e.intl.formatMessage(l.messages.serviceItemPricePlaceholder)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl,n=e.serviceItem,a=!0===e.hasPriceChart?[r.createElement("div",{className:"service-price"},this.state.price),r.createElement("div",null,r.createElement("div",{className:"service-text"},t.formatMessage(l.messages.serviceItemPriceSimulatorText)),r.createElement(s.Input,{addonBefore:t.formatMessage(l.messages.serviceItemPriceSimulatorInputPlaceholder),onChange:this.onChange}))]:[void 0,void 0];return r.createElement("div",null,a[0],r.createElement("div",{className:"service-text"},n&&n.description?n.description:t.formatMessage(l.messages.serviceItemNoDescription)),a[1])}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl)(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(1178),s=(a=i)&&a.__esModule?a:{default:a};function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=function(e){function t(){return l(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){return o.createElement(s.default,{offerOwnership:"my_offer"})}}]),t}(o.Component);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(13),l=n(8),c=n(10),u=n(109),d=n(220),f=(a=d)&&a.__esModule?a:{default:a},p=n(24),m=n(11),g=n(852);function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=c.Layout.Content,b=function(e){function t(){return y(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.onSelect,n=e.breadCrumbPaths,a=e.intl.formatMessage,r=function(e){return function(){t(e)}},s={formId:"typePickerForm",onClose:this.props.close,paths:n};return o.createElement(c.Layout,null,o.createElement("div",{className:"edit-layout ant-layout"},o.createElement(u.FormLayoutActionbar,s),o.createElement(c.Layout,null,o.createElement(v,{className:"mcs-content-container mcs-form-container text-center"},o.createElement(p.FormTitle,{title:f.default.offerTypePickerTitle,subtitle:f.default.offerTypePickerSubTitle}),o.createElement(c.Row,{className:"mcs-selector_container"},o.createElement(c.Row,{className:"menu"},o.createElement("div",{className:"presentation"},o.createElement(m.MenuPresentational,{title:a(f.default.automaticOfferType),type:"automation",select:r(g.OfferType.Automatic)}),o.createElement("div",{className:"separator"},o.createElement(i.FormattedMessage,f.default.offerTypeOr)),o.createElement(m.MenuPresentational,{title:a(f.default.manualOfferType),type:"pen",select:r(g.OfferType.Manual)}))))))))}}]),t}(o.Component);t.default=(0,l.compose)(s.withRouter,i.injectIntl)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(6),l=n(8),c=n(852),u=n(10),d=n(109),f=n(35),p=h(n(220)),m=n(24),g=h(n(49)),y=h(n(2630));function h(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var _=u.Layout.Content,S=f.FieldArray,E=t.FORM_ID="offerForm",O=function(e){function t(){return v(this,t),b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.breadCrumbPaths,r=e.offerType,i=e.goToOfferTypeSelection,s=e.close,l=e.change,g=e.fieldValidators.isRequired,h=e.intl.formatMessage,v=e.match.params.offerId,b={formId:E,paths:n,message:p.default.saveOffer,onClose:s},O={formChange:l,rerenderOnEveryChange:!0},w=[];if(w.push({id:"general",title:p.default.generalInformation,component:o.createElement("div",null,o.createElement(m.FormSection,{subtitle:p.default.sectionNewOfferSubtitle,title:p.default.sectionNewOfferTitle}),o.createElement("div",null,o.createElement(m.FormInputField,{name:"offer.name",component:m.FormInput,validate:[g],formItemProps:{label:h(p.default.sectionNewOfferNameLabel),required:!0},inputProps:{disabled:void 0!==v,placeholder:h(p.default.sectionNewOfferNamePlaceholder)}})))}),r===c.OfferType.Automatic){w.push({id:"automaticOn",title:p.default.automaticOn,component:o.createElement("div",null,o.createElement(m.FormSection,{subtitle:p.default.sectionServiceTypeSubtitle,title:p.default.sectionServiceTypeTitle}),o.createElement("div",null,o.createElement(m.FormSelectField,{name:"offer.automatic_on",component:m.DefaultSelect,validate:[g],formItemProps:{label:h(p.default.sectionNewOfferAutomaticOnLabel)},disabled:void 0!==v,options:[{value:"AUDIENCE_SEGMENT",title:"AUDIENCE_SEGMENT"},{value:"DEAL_LIST",title:"DEAL_LIST"}]})))})}else w.push({id:"serviceItems",title:p.default.serviceItemsSection,component:o.createElement(S,a({name:"serviceConditionFields",component:y.default},O))});var M={items:w.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:E};i&&M.items.unshift({sectionId:"type",title:p.default.offerFormTypeSelection,onClick:i,type:"validated"});var P=w.map((function(e,t){return o.createElement("div",{key:e.id},o.createElement("div",{key:e.id,id:e.id},e.component),t!==w.length-1&&o.createElement("hr",null))}));return o.createElement(u.Layout,{className:"edit-layout"},o.createElement(d.FormLayoutActionbar,b),o.createElement(u.Layout,{className:"ant-layout-has-sider"},o.createElement(d.ScrollspySider,M),o.createElement(f.Form,{className:"edit-layout ant-layout",onSubmit:t},o.createElement(_,{id:E,className:"mcs-content-container mcs-form-container"},P))))}}]),t}(o.Component);t.default=(0,l.compose)(s.injectIntl,g.default,i.withRouter,(0,f.reduxForm)({form:E,enableReinitialize:!0}))(O)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=y(n(47)),s=y(n(162)),l=n(6),c=n(8),u=n(183),d=n(24),f=y(n(1179)),p=y(n(2631)),m=n(12),g=n(15);function y(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=function(e){function t(){h(this,t);var e=v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.updateServiceConditions=function(t){var n=e.props,a=n.fields,r=n.formChange,o=t.map((function(e){return e.id})),s=a.getAll().map((function(e){return e.model.service_item_id})),l=a.getAll().filter((function(e){return o.includes(e.model.service_item_id)})),c=t.filter((function(e){return!s.includes(e.id)})).map((function(e){return{key:(0,i.default)(),model:{id:"-1",service_item_id:e.id},meta:{name:e.name,type:e.type||""}}}));r(a.name,l.concat(c)),e.props.closeNextDrawer()},e.openServiceItemsSelector=function(){var t={additionalProps:{selectedServiceItemIds:e.props.fields.getAll().map((function(e){return e.model.service_item_id})),close:e.props.closeNextDrawer,save:e.updateServiceConditions}};e.props.openNextDrawer(p.default,t)},e.getServiceItemsRecords=function(){var t=e.props,n=t.fields,a=t.intl.formatMessage,r=function(e){return e.meta.name},i=function(t){return e._serviceOfferPageService.transformServiceType(t.meta.type,a)};return n.getAll().map((function(e,t){return o.createElement(u.RecordElement,{key:t,recordIconType:"gears",record:e,title:r,additionalData:i,onRemove:function(){return n.remove(t)}})}))},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.intl.formatMessage;return o.createElement("div",null,o.createElement(d.FormSection,{button:{message:e(f.default.serviceItemsBreadcrumbTitle),onClick:this.openServiceItemsSelector},subtitle:f.default.serviceItemsSectionSubtitle,title:f.default.serviceItemsSectionTitle}),o.createElement(u.RelatedRecords,{emptyOption:{iconType:"gears",message:e(f.default.contentSectionServiceItemsEmptyTitle)}},this.getServiceItemsRecords()))}}]),t}(o.Component);b([(0,g.lazyInject)(m.TYPES.IServiceOfferPageService)],_.prototype,"_serviceOfferPageService",void 0),t.default=(0,c.compose)(l.injectIntl,s.default)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=m(n(272)),s=n(6),l=n(13),c=m(n(1179)),u=n(8),d=n(44),f=n(12),p=n(15);function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},v=i.default,b=function(e){function t(){g(this,t);var e=y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.saveServiceItems=function(t,n){e.props.save(n)},e.fetchServiceItems=function(t){var n=e.props.match.params.organisationId,a=Object.assign({},(0,d.getPaginatedApiParam)(t.currentPage,t.pageSize));return t.keywords&&(a.keywords=t.keywords),t.type&&0!==t.type.length&&(a.type=t.type),e._catalogService.getServiceItems(n,a)},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.selectedServiceItemIds,a=t.close,r=t.intl.formatMessage,i=[{title:c.default.serviceItemSelectorColumnName,key:"name",render:function(e,t){return o.createElement("span",null,t.name)}},{title:c.default.serviceItemSelectorColumnType,key:"type",render:function(t,n){return o.createElement("span",null,e._serviceOfferPageService.transformServiceType(n.type,r))}}];return o.createElement(v,{actionBarTitle:r(c.default.serviceItemSelectorTitle),displayFiltering:!0,displayTypeFilter:!0,searchPlaceholder:r(c.default.serviceItemSelectorSearchPlaceholder),selectedIds:n,fetchDataList:this.fetchServiceItems,fetchData:function(t){return e._catalogService.findServiceItem(t)},columnsDefinitions:i,save:this.saveServiceItems,close:a})}}]),t}(o.Component);h([(0,p.lazyInject)(f.TYPES.ICatalogService)],b.prototype,"_catalogService",void 0),h([(0,p.lazyInject)(f.TYPES.IServiceOfferPageService)],b.prototype,"_serviceOfferPageService",void 0),t.default=(0,u.compose)(l.withRouter,s.injectIntl)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(30),c=n(13),u=n(8),d=n(6),f=n(23),p=(a=f)&&a.__esModule?a:{default:a},m=n(68),g=n(33),y=n(12),h=n(15),v=n(11);var b=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=s.Layout.Content,S=t.messages=(0,d.defineMessages)({datamarts:{id:"settings.datamart.sources.datamarts",defaultMessage:"Datamarts"},title:{id:"settings.datamart.sources.title",defaultMessage:"Sources"},id:{id:"settings.datamart.sources.table.column.id",defaultMessage:"Id"},name:{id:"settings.datamart.sources.table.column.name",defaultMessage:"Datamart Name"},noData:{id:"settings.datamart.sources.empty.table",defaultMessage:"No Datamart Sources"}}),E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleFilterChange=function(e){var t=n.props.match.params.datamartId;n.setState({filters:e}),n.fetchList(t,e)},n.fetchList=function(e,t){var a=n.props.notifyError;return n.setState({loading:!0}),n._datamartService.getSources(e).then((function(e){return n.setState({loading:!1,dataSource:e.data,total:e.total||e.count})})).catch((function(e){a(e),n.setState({loading:!1})}))},n.fetchDatamart=function(e){return n._datamartService.getDatamart(e).then((function(e){return n.setState({datamart:e.data})}))},n.state={loading:!0,total:0,dataSource:[],filters:{currentPage:0,pageSize:10}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.datamartId,n=e.location.search,a=(0,l.parseSearch)(n,l.PAGINATION_SEARCH_SETTINGS);this.fetchList(t,a),this.fetchDatamart(t)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.match.params.datamartId,a=t.location.search,r=e.match.params.datamartId,o=e.location.search;if(n!==r||(0,l.compareSearches)(a,o)){var i=(0,l.parseSearch)(a,l.PAGINATION_SEARCH_SETTINGS);this.fetchList(n,i),n!==r&&this.fetchDatamart(n)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.intl,r=this.state,o=r.dataSource,l=r.loading,c=r.filters,u=r.total,f=r.datamart,p=[{intlMessage:S.id,key:"id",isHideable:!1},{intlMessage:S.name,key:"name",isHideable:!1}],y={current:c.currentPage,pageSize:c.pageSize,total:u,onChange:function(t,n){return e.handleFilterChange({currentPage:t,pageSize:n})},onShowSizeChange:function(t,n){return e.handleFilterChange({pageSize:n,currentPage:1})}};return i.createElement("div",{className:"ant-layout"},i.createElement(_,{className:"mcs-content-container"},i.createElement(s.Row,{className:"mcs-table-container"},i.createElement(s.Breadcrumb,{className:"mcs-breadcrumb",separator:i.createElement(v.McsIcon,{type:"chevron-right"})},i.createElement(s.Breadcrumb.Item,null,i.createElement(g.Link,{to:"/v2/o/"+n+"/settings/datamart/datamarts"},i.createElement(d.FormattedMessage,S.datamarts))),i.createElement(s.Breadcrumb.Item,null,f?f.name?f.name:"...":i.createElement("i",{className:"mcs-table-cell-loading"})))),i.createElement(s.Row,{className:"mcs-table-container"},i.createElement("div",{className:"mcs-card-header mcs-card-title"},i.createElement("span",{className:"mcs-card-title"},i.createElement(d.FormattedMessage,S.title))),i.createElement("hr",{className:"mcs-separator"}),0===u&&!1===l?i.createElement(v.EmptyTableView,{iconType:"settings",message:a.formatMessage(S.noData),className:"mcs-table-view-empty mcs-empty-card"}):i.createElement(m.TableView,{dataSource:o,loading:l,columns:p,pagination:y}))))}}]),t}(i.Component);b([(0,h.lazyInject)(y.TYPES.IDatamartService)],E.prototype,"_datamartService",void 0),t.default=(0,u.compose)(c.withRouter,d.injectIntl,p.default)(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(6),l=n(13),c=M(n(23)),u=M(n(2634)),d=M(n(2636)),f=n(10),p=n(124),m=n(11),g=M(n(2637)),y=M(n(2641)),h=M(n(2643)),v=n(73),b=n(12),_=n(15),S=M(n(631)),E=n(632),O=M(n(2644)),w=M(n(2648));function M(e){return e&&e.__esModule?e:{default:e}}var P=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},T=f.Layout.Content,I=(0,s.defineMessages)({datamartConfiguration:{id:"settings.datamart.configuration",defaultMessage:"Configuration"},datamartActivity:{id:"settings.datamart.activity",defaultMessage:"Activity"},datamartReplications:{id:"settings.datamart.replications",defaultMessage:"Replications"},tableViewConfiguration:{id:"settings.datamart.tableview.configuration",defaultMessage:"Table View Configuration"},objectViewConfiguration:{id:"settings.datamart.objectview.configuration",defaultMessage:"Object View Configuration"},statistics:{id:"settings.datamart.statistics",defaultMessage:"Statistics"},audienceBuilder:{id:"settings.datamart.audienceBuilder",defaultMessage:"Audience Builder"}}),A=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchDatamart=function(e){n._datamartService.getDatamart(e).then((function(e){return n.setState({datamart:e.data,isLoading:!1})})).catch((function(e){n.setState({isLoading:!1}),(0,p.notifyError)(e)}))},n.state={isLoading:!0,datamartAnalyticsConfig:E.sessionInTimeJsonConfig},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params.datamartId;this.fetchDatamart(e)}},{key:"componentDidUpdate",value:function(e){var t=this.props.match.params.datamartId;t!==e.match.params.datamartId&&this.fetchDatamart(t)}},{key:"render",value:function(){var e=this.props,t=e.intl,n=e.match.params,a=n.datamartId,r=n.organisationId,i=e.location,s=e.hasFeature,l=this.state,c=l.datamart,f=l.isLoading,p=[{title:t.formatMessage(I.datamartConfiguration),display:o.createElement(g.default,{datamartId:a}),key:"configuration"},{title:t.formatMessage(I.datamartActivity),display:o.createElement(h.default,{datamartId:a}),key:"activity"}];return s("datamartSettings-datamart_replication")&&p.push({title:t.formatMessage(I.datamartReplications),display:o.createElement(O.default,null),key:"replications"}),s("datamart-object_tree_schema")&&c&&"v201506"!==c.storage_model_version&&p.push({title:t.formatMessage(I.objectViewConfiguration),display:o.createElement(y.default,{datamartId:a}),key:"object_view_configuration"}),s("audience-dashboards-datamart_users_analytics")&&c&&p.push({title:t.formatMessage(I.statistics),display:o.createElement(T,{className:"mcs-content-container"},o.createElement(S.default,{datamartId:c.id,organisationId:r,config:E.sessionInTimeJsonConfig})),key:"statistics"}),s("audience-segment_builder_v2")&&p.push({title:t.formatMessage(I.audienceBuilder),display:o.createElement(w.default,null),key:"audience_builder"}),o.createElement("div",{className:"ant-layout"},o.createElement(u.default,null),o.createElement("div",{className:"ant-layout"},o.createElement("div",{className:"ant-layout-content"},o.createElement("div",{className:"mcs-content-channel"},o.createElement("div",{className:"mcs-datamart-title"},o.createElement(d.default,{datamart:c,isLoading:f}))),o.createElement("div",null,o.createElement(m.McsTabs,{items:p,tabBarStyle:{margin:"0 40px"},defaultActiveKey:i&&i.state&&i.state.activeTab||"configuration"})))))}}]),t}(o.Component);P([(0,_.lazyInject)(b.TYPES.IDatamartService)],A.prototype,"_datamartService",void 0),t.default=(0,i.compose)(l.withRouter,s.injectIntl,c.default,v.injectFeatures)(A)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(6),c=n(11),u=n(10),d=n(2635),f=(a=d)&&a.__esModule?a:{default:a};function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=function(e){function t(){p(this,t);var e=m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.onEditClick=function(){var t=e.props,n=t.match.params,a=n.organisationId,r=n.datamartId,o=t.history,i=t.location,s=i.pathname,l=i.search,c="/v2/o/"+a+"/settings/datamart/datamarts/"+r+"/edit";o.push({pathname:c,state:{from:""+s+l}})},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=[{name:(0,e.intl.formatMessage)(f.default.datamart),path:"/v2/o/"+t+"/settings/datamart/datamarts"}];return o.createElement(c.Actionbar,{paths:n},o.createElement(u.Button,{onClick:this.onEditClick,type:"primary",className:"mcs-primary"},o.createElement(c.McsIcon,{type:"pen"}),o.createElement(l.FormattedMessage,f.default.edit)))}}]),t}(o.Component);t.default=(0,i.compose)(s.withRouter,l.injectIntl)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({datamart:{id:"settings.datamart",defaultMessage:"Datamarts"},mobileApplications:{id:"settings.datamart.mobile_applications",defaultMessage:"Mobile Applications"},edit:{id:"settings.datamart.edit",defaultMessage:"Edit"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(8),s=n(13),l=n(11);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=function(e){function t(){return c(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.datamart,n=e.isLoading;return r.createElement(l.ContentHeader,{title:t&&r.createElement("span",null,t.name),loading:n})}}]),t}(r.Component);t.default=(0,i.compose)(s.withRouter,o.injectIntl)(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=c(n(2638)),s=n(73),l=c(n(1181));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onCompartmentsFilterChange=function(e){var t={currentPage:e.currentPage,pageSize:e.pageSize};n.setState({compartmentsFilter:t})},n.state={compartmentsFilter:{currentPage:1,pageSize:10}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.datamartId,t=this.state.compartmentsFilter;return r.createElement("div",null,r.createElement("div",null,r.createElement("div",null,r.createElement(l.default,{fixedDatamartOpt:e}))),r.createElement("div",null,r.createElement("div",null,r.createElement(i.default,{datamartId:e,filter:t,onFilterChange:this.onCompartmentsFilterChange}))))}}]),t}(r.Component);t.default=(0,o.compose)(s.injectFeatures)(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(6),c=n(68),u=y(n(1180)),d=n(44),f=n(10),p=y(n(23)),m=n(12),g=n(15);function y(e){return e&&e.__esModule?e:{default:e}}var h=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},v=f.Layout.Content,b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchCompartments=function(e,t){n.setState({loading:!0},(function(){var a=Object.assign({},(0,d.getPaginatedApiParam)(t.currentPage,t.pageSize));n._datamartService.getUserAccountCompartmentDatamartSelectionResources(e,a).then((function(e){n.setState({loading:!1,data:e.data,total:e.total||e.count})})).catch((function(e){n.setState({loading:!1}),n.props.notifyError(e)}))}))},n.state={loading:!1,data:[],total:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.datamartId,n=e.filter;this.fetchCompartments(t,n)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.datamartId,a=t.filter,r=e.datamartId;a===e.filter&&n===r||this.fetchCompartments(n,a)}},{key:"render",value:function(){var e=this.props,t=e.filter,n=e.onFilterChange,a=this.state,r=a.data,i=a.loading,s=[{intlMessage:u.default.compartment_id,key:"compartment_id",isHideable:!1,render:function(e,t){return o.createElement("span",null,e)}},{intlMessage:u.default.default,key:"default",isHideable:!1,render:function(e,t){return o.createElement("span",null,t.default?"yes":"no")}},{intlMessage:u.default.name,key:"name",isHideable:!1,render:function(e,t){return o.createElement("span",null,e)}},{intlMessage:u.default.token,key:"token",isHideable:!1,render:function(e,t){return o.createElement("span",null,e)}}],d={current:t.currentPage,pageSize:t.pageSize,total:this.state.total,onChange:function(e,t){return n({currentPage:e,pageSize:t})},onShowSizeChange:function(e,t){return n({currentPage:1,pageSize:t})}};return o.createElement("div",{className:"ant-layout"},o.createElement(v,{className:"mcs-content-container"},o.createElement(f.Row,{className:"mcs-table-container"},o.createElement("div",null,o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(l.FormattedMessage,u.default.compartments))),o.createElement("hr",{className:"mcs-separator"}),o.createElement(c.TableViewFilters,{columns:s,dataSource:r,loading:i,pagination:d})))))}}]),t}(o.Component);h([(0,g.lazyInject)(m.TYPES.IDatamartService)],b.prototype,"_datamartService",void 0),t.default=(0,i.compose)(s.withRouter,l.injectIntl,p.default)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TYPE_SEARCH_SETTINGS=[{paramName:"types",defaultValue:void 0,deserialize:function(e){return e.types?e.types.split(","):[]},serialize:function(e){return e.join(",")},isValid:function(){return!0}}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(13),s=n(8),l=g(n(1182)),c=n(11),u=g(n(17)),d=n(68),f=n(67),p=n(25),m=n(56);function g(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=function(e){function t(){return y(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.isFetchingChannels,n=e.dataSource,a=e.totalChannels,o=e.noChannelYet,i=e.onFilterChange,s=e.onDeleteChannel,f=e.onEditChannel,p=e.filter,g=e.intl.formatMessage,y=e.match.params.organisationId,h=e.filtersOptions,v=(0,e.workspace)(y).datamarts,b={current:p.currentPage,pageSize:p.pageSize,total:a,onChange:function(e,t){return i({currentPage:e,pageSize:t})},onShowSizeChange:function(e,t){return i({pageSize:t,currentPage:1})}},_=[{intlMessage:l.default.channelName,key:"name",isHideable:!1,render:function(e,t){return r.createElement(c.Button,{onClick:function(){f(t)}},e)}},{intlMessage:l.default.channelType,key:"type",isVisibleByDefault:!0,isHideable:!0},{intlMessage:l.default.channelToken,key:"token",isVisibleByDefault:!0,isHideable:!0},{intlMessage:l.default.lastSevenDaysActivities,key:"activities",isVisibleByDefault:!0,isHideable:!0,render:function(e,t){return(0,m.formatMetric)(t.sessions,"0,0")}},{intlMessage:l.default.lastSevenDaysUsers,key:"users",isVisibleByDefault:!0,isHideable:!0,render:function(e,t){return(0,m.formatMetric)(t.users,"0,0")}},{intlMessage:l.default.channelDatamartName,key:"datamart_name",isVisibleByDefault:!0,isHideable:!0,render:function(e,t){var n=v.find((function(e){return e.id===t.datamart_id}));return n?n.name:""}},{intlMessage:l.default.channelCreationDate,key:"creation_ts",isVisibleByDefault:!0,isHideable:!0,render:function(e){return(0,u.default)(e).format("DD/MM/YYYY")}}],S={placeholder:g(l.default.searchPlaceholder),onSearch:function(e){return i({keywords:e,currentPage:1})},defaultValue:p.keywords},E=[{key:"action",actions:function(){return[{intlMessage:l.default.editChannel,callback:f},{intlMessage:l.default.deleteChannel,callback:s}]}}];return o?r.createElement(c.EmptyTableView,{iconType:"settings",message:g(l.default.emptyChannels),className:"mcs-table-view-empty mcs-empty-card"}):r.createElement(d.TableViewFilters,{columns:_,actionsColumnsDefinition:E,dataSource:n,loading:t,searchOptions:S,pagination:b,filtersOptions:h})}}]),t}(r.Component);t.default=(0,s.compose)(o.injectIntl,i.withRouter,(0,p.connect)((function(e){return{workspace:(0,f.getWorkspace)(e)}})))(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=y(n(17)),l=n(51),c=n(8),u=y(n(23)),d=y(n(270));n(2642);var f=n(6),p=n(15),m=n(12),g=n(11);function y(e){return e&&e.__esModule?e:{default:e}}var h=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},v=(0,f.defineMessages)({validationSuccess:{id:"datamart.schemaEditor.objectTree.validation.success",defaultMessage:"Your schema is valid. Please press publish to turn it live."},validationError:{id:"datamart.schemaEditor.objectTree.validation.error",defaultMessage:"Either your schema has errors, or is not compliant with the previous one. Please check with your support in order to assess it."},validationButton:{id:"datamart.schemaEditor.objectTree.validation.button",defaultMessage:"Validate your Schema."},saveButton:{id:"datamart.schemaEditor.objectTree.save.button",defaultMessage:"Save your Changes."},publicationButton:{id:"datamart.schemaEditor.objectTree.publication.button",defaultMessage:"Publish your Schema."},history:{id:"datamart.schemaEditor.objectTree.history",defaultMessage:"History"},schema:{id:"datamart.schemaEditor.objectTree.schema",defaultMessage:"Schema"},createVersion:{id:"datamart.schemaEditor.objectTree.version.create",defaultMessage:"Create a new version"},hasDecorators:{id:"datamart.schemaEditor.objectTree.decorators.exist",defaultMessage:"This schema has decorators"},hasNotDecorators:{id:"datamart.schemaEditor.objectTree.decorators.dontExist",defaultMessage:"This schema doesn't have any decorators"},uploadDecorators:{id:"datamart.schemaEditor.objectTree.decorators.upload",defaultMessage:"Upload new Decorators"},downloadTemplate:{id:"datamart.schemaEditor.objectTree.decorators.downloadTemplate",defaultMessage:"Download Template"},downloadDecorators:{id:"datamart.schemaEditor.objectTree.decorators.download",defaultMessage:"Download Decorators"}}),b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchSchemas=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n.setState({loadingList:!0}),n._runtimeSchemaService.getRuntimeSchemas(e).then((function(a){n.setState({loadingList:!1,schemas:a.data});var r=a.data.find((function(e){return"LIVE"===e.status}));return t&&r?(n.setState({selectedSchema:r}),n.fetchSchemaDetail(e,r.id)):n.fetchSchemaDetail(e,a.data[0].id)})).catch((function(e){n.setState({loadingList:!1}),n.props.notifyError(e)}))},n.fetchSchemaDetail=function(e,t){return n.setState({loadingSingle:!0}),n._runtimeSchemaService.getRuntimeSchemaText(e,t).then((function(a){return n.setState({selectedSchemaText:a}),n._runtimeSchemaService.getSchemaDecorator(e,t).then((function(e){n.setState({loadingSingle:!1,schemaDecorator:e.data})}))})).catch((function(e){n.setState({loadingSingle:!1}),n.props.notifyError(e)}))},n.selectSchema=function(e){return n.setState({selectedSchema:e}),n.fetchSchemaDetail(e.datamart_id,e.id)},n.createNewSchemaVersion=function(e){return function(){return n.setState({loadingList:!0,loadingSingle:!0}),n._runtimeSchemaService.cloneRuntimeSchema(e.datamart_id,e.id).then((function(e){return Promise.all([n.fetchSchemaDetail(e.data.datamart_id,e.data.id),n.fetchSchemas(e.data.datamart_id,!1)])})).catch((function(e){n.props.notifyError(e),n.setState({loadingList:!1,loadingSingle:!1})}))}},n.validateSchema=function(){var e=n.state.selectedSchema;return e?(n.setState({loadingSingle:!0}),n._runtimeSchemaService.validateRuntimeSchema(e.datamart_id,e.id).then((function(e){return n.setState({schemaValidation:e.data,loadingSingle:!1})})).catch((function(){return n.setState({loadingSingle:!1})}))):Promise.resolve()},n.saveSchema=function(){var e=n.state,t=e.selectedSchema,a=e.changedSchemaValue;return t&&a?(n.setState({loadingSingle:!0,schemaValidation:void 0}),n._runtimeSchemaService.updateRuntimeSchema(t.datamart_id,t.id,a).then((function(e){return n.setState({selectedSchemaText:a,changedSchemaValue:void 0,changedSchemaId:void 0,loadingSingle:!1})})).catch((function(e){n.props.notifyError(e),n.setState({loadingSingle:!1})}))):Promise.resolve()},n.publishSchema=function(){var e=n.state,t=e.selectedSchema,a=e.schemaValidation;return t&&a?(n.setState({loadingSingle:!0,loadingList:!0,schemaValidation:void 0}),n._runtimeSchemaService.publishRuntimeSchema(t.datamart_id,t.id).then((function(e){return n.fetchSchemas(e.data.datamart_id,!0)})).catch((function(){return n.setState({loadingSingle:!1,loadingList:!1})}))):Promise.resolve()},n.downloadDecoratorsTemplate=function(){n.downloadCSVFile([["UserPoint","profiles","false","Profile","Uploaded CRM Profiles","en-US"]])},n.downloadDecorators=function(){var e=n.state.schemaDecorator;if(e){var t=e.map((function(e){return[e.object_name,e.field_name,e.hidden.toString(),e.label,e.help_text||"",e.locale||""]}));n.downloadCSVFile(t)}},n.downloadCSVFile=function(e){var t=[];t.push(["OBJECT_NAME","FIELD_NAME","HIDDEN","LABEL","HELP_TEXT","LOCALE"]),e.forEach((function(e){t.push([e[0],e[1],e[2],e[3],e[4],e[5]])}));var n="data:text/csv;charset=utf-8,";t.forEach((function(e){var t=e.join(",");n+=t+"\r\n"}));var a=encodeURI(n),r=document.createElement("a");r.setAttribute("href",a),r.setAttribute("download","my_data.csv"),document.body.appendChild(r),r.click()},n.onFileUpdate=function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(e){var n=e.target.result;return t(n)},a.readAsText(e,"UTF-8")}))},n.uploadDecorator=function(e){var t=n.props.datamartId,a=n.state.selectedSchema;return a&&t?(n.setState({uploadingDecorator:!0}),n.onFileUpdate(e).then((function(e){return n._runtimeSchemaService.createSchemaDecorator(a.datamart_id,a.id,e).then((function(){return n._runtimeSchemaService.getSchemaDecorator(a.datamart_id,a.id)})).then((function(e){n.setState({uploadingDecorator:!1,schemaDecorator:e.data})})).catch((function(e){n.props.notifyError(e),n.setState({uploadingDecorator:!1})}))})).catch((function(e){n.props.notifyError(e)}))):Promise.resolve()},n.onSchemaChange=function(e){var t;n.setState({changedSchemaValue:e,changedSchemaId:null===(t=n.state.selectedSchema)||void 0===t?void 0:t.id})},n.onClickOnSelect=function(e){return function(){return n.selectSchema(e)}},n.state={loadingList:!0,loadingSingle:!0,schemas:[],uploadingDecorator:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.datamartId;this.fetchSchemas(e,!0)}},{key:"componentDidUpdate",value:function(e){var t=this.props.datamartId;t!==this.props.datamartId&&this.fetchSchemas(t,!0)}},{key:"render",value:function(){var e=this,t=this.state,n=t.loadingSingle,a=t.schemas,r=t.loadingList,c=t.selectedSchema,u=t.selectedSchemaText,p=t.schemaValidation,m=t.changedSchemaValue,y=t.changedSchemaId,h=void 0,b={name:"file",multiple:!1,action:"/",accept:".csv",showUploadList:!1,beforeUpload:function(t,n){return e.uploadDecorator(t),!1}},_=!!p,S=p&&(p.schema_errors.length||p.tree_index_operations.find((function(e){return"FORCE_NO_BUILD"!==e.init_strategy})));return m&&c&&"DRAFT"===c.status&&(h=o.createElement(i.Button,{size:"small",type:"primary",onClick:this.saveSchema},o.createElement(f.FormattedMessage,v.saveButton))),void 0===m&&c&&"DRAFT"===c.status&&!_&&(h=o.createElement(i.Button,{size:"small",type:"primary",onClick:this.validateSchema},o.createElement(f.FormattedMessage,v.validationButton))),!m&&c&&"DRAFT"===c.status&&_&&!S&&(h=o.createElement(i.Button,{size:"small",type:"primary",onClick:this.publishSchema},o.createElement(f.FormattedMessage,v.publicationButton))),c&&"LIVE"===c.status&&a&&!a.find((function(e){return"DRAFT"===e.status}))&&(h=o.createElement(i.Button,{size:"small",type:"primary",onClick:this.createNewSchemaVersion(c)},o.createElement(f.FormattedMessage,v.createVersion))),o.createElement("div",{className:"schema-editor"},o.createElement(i.Row,{className:"title-line"},o.createElement(i.Col,{className:"title",span:6},o.createElement(f.FormattedMessage,v.history)),o.createElement(i.Col,{className:"title",span:18},o.createElement("span",{style:{float:"right"}},h),o.createElement(f.FormattedMessage,v.schema))),o.createElement(i.Row,{className:"content-line"},o.createElement(i.Col,{span:6,className:"content"},r?o.createElement(i.Spin,null):a.sort((function(e,t){return t.creation_date-e.creation_date})).map((function(t){return o.createElement("div",{key:t.id,className:c&&c.id===t.id?"list-item selected":"list-item",onClick:e.onClickOnSelect(t)},o.createElement("span",{className:"title"},t.status),o.createElement("span",{className:"date"},(0,s.default)(t.creation_date).fromNow()))}))),o.createElement(i.Col,{span:18,className:"content"},n?o.createElement(l.Loading,{isFullScreen:!1}):o.createElement("div",null,_&&(null==c?void 0:c.id)===(null==p?void 0:p.schema_id)&&o.createElement(i.Alert,{style:{marginBottom:10},message:S?o.createElement(f.FormattedMessage,v.validationError):o.createElement(f.FormattedMessage,v.validationSuccess),type:S?"error":"success"}),o.createElement(d.default,{width:"100%",mode:"graphqlschema",theme:"github",setOptions:{showGutter:!0},onChange:this.onSchemaChange,readOnly:"DRAFT"!==(null==c?void 0:c.status),value:void 0!==m&&y===(null==c?void 0:c.id)?m:u}),o.createElement(i.Row,{className:"decorators"},o.createElement(i.Col,{span:12,className:"text"},this.state.schemaDecorator&&this.state.schemaDecorator.length>0?o.createElement("div",{className:"success"},o.createElement(g.McsIcon,{type:"check-rounded"})," ",o.createElement(f.FormattedMessage,v.hasDecorators)):o.createElement("div",null,o.createElement(f.FormattedMessage,v.hasNotDecorators))),o.createElement(i.Col,{span:12,className:"buttons"},o.createElement(i.Upload,b,o.createElement(i.Button,{type:"primary",className:"spacing",size:"small"},o.createElement(f.FormattedMessage,v.uploadDecorators))),o.createElement(i.Button,{size:"small",className:"spacing",onClick:this.downloadDecoratorsTemplate},o.createElement(f.FormattedMessage,v.downloadTemplate)),this.state.schemaDecorator&&this.state.schemaDecorator.length>0&&o.createElement(i.Button,{size:"small",onClick:this.downloadDecorators},o.createElement(f.FormattedMessage,v.downloadDecorators))))))))}}]),t}(o.Component);h([(0,p.lazyInject)(m.TYPES.IRuntimeSchemaService)],b.prototype,"_runtimeSchemaService",void 0),t.default=(0,c.compose)(u.default)(b)},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(1162),l=(a=s)&&a.__esModule?a:{default:a};var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props.datamartId;return o.createElement("div",null,o.createElement(i.Row,{className:"ant-layout"},o.createElement(i.Col,{className:"mcs-content-container ant-layout-content"},o.createElement(l.default,{datamartId:e,noFilterDatamart:!0}))))}}]),t}(o.Component);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(41),s=n(10),l=n(8),c=n(13),u=_(n(23)),d=n(6),f=n(15),p=n(12),m=n(44),g=n(30),y=n(1183),h=_(y),v=_(n(206)),b=_(n(2646));function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchLoop=window.setInterval((function(){var e=n.props,t=e.match.params.datamartId,a=e.location.search;if(n.state.jobExecutions.find((function(e){return"RUNNING"===e.status}))){var r=(0,g.parseSearch)(a,y.DATAMART_REPLICATION_SEARCH_SETTINGS);n.fetchReplicationsAndJobs(t,r)}}),5e3),n.fetchReplicationsAndJobs=function(e,t){n.fetchDatamartReplications(e,t),n.fetchJobExecutions(e,t)},n.fetchDatamartReplications=function(e,t){var a;return n.setState({isLoadingReplications:!0}),n._datamartReplicationService.getDatamartReplications(e,(a={},t.currentPage&&t.pageSize&&(a=Object.assign({},(0,m.getPaginatedApiParam)(t.currentPage,t.pageSize))),t.keywords?Object.assign(Object.assign({},a),{keywords:t.keywords}):a)).then((function(e){n.setState({isLoadingReplications:!1,noReplication:e&&0===e.total&&!t.keywords,replications:e.data,totalReplications:e.total?e.total:e.count})})).catch((function(e){n.setState({isLoadingReplications:!1}),n.props.notifyError(e)}))},n.fetchJobExecutions=function(e,t){n.setState({isLoadingJobExecutions:!0},(function(){return n._datamartReplicationService.getJobExecutions(e).then((function(e){n.setState({jobExecutions:e.data,isLoadingJobExecutions:!1,totalJobExecutions:e.total||e.count,noJobExecution:e&&0===e.total&&!t.keywords})})).catch((function(e){n.props.notifyError(e),n.setState({isLoadingJobExecutions:!1,jobExecutions:[],totalJobExecutions:0})}))}))},n.onDeleteDatamartReplication=function(e){var t=n.props,a=t.match.params.datamartId,r=t.location.search,l=t.notifyError,c=t.intl.formatMessage,u=(0,g.parseSearch)(r,y.DATAMART_REPLICATION_SEARCH_SETTINGS);s.Modal.confirm({icon:o.createElement(i.ExclamationCircleOutlined,null),title:c(v.default.deleteDatamartReplicationModalTitle),content:c(v.default.deleteDatamartReplicationModalContent),okText:c(v.default.deleteDatamartReplication),cancelText:c(v.default.deleteDatamartReplicationModalCancel),onOk:function(){n._datamartReplicationService.deleteDatamartReplication(a,e.id).then((function(){return n.fetchDatamartReplications(a,u)})).catch((function(e){l(e)}))}})},n.onUpdateDatamartReplication=function(e,t){var a=n.props,r=a.match.params.datamartId,o=a.notifyError,i=a.location.search;n._datamartReplicationService.updateDatamartReplication(r,e.id,Object.assign(Object.assign({},e),{status:t?"ACTIVE":"PAUSED"})).then((function(){var e=(0,g.parseSearch)(i,y.DATAMART_REPLICATION_SEARCH_SETTINGS);return n.fetchDatamartReplications(r,e)})).catch((function(e){o(e)}))},n.handleReplicationFilterChange=function(e){var t=n.props.match.params.datamartId;n.fetchDatamartReplications(t,e)},n.handleJobExecutionsFilterChange=function(e){var t=n.props.match.params.datamartId;n.fetchJobExecutions(t,e)},n.isLastExecutionRunning=function(){return!!n.state.jobExecutions.find((function(e){return"RUNNING"===e.status}))},n.createJobExecution=function(e){var t=n.props.notifyError;return n._datamartReplicationService.createJobExecution(e).then((function(e){return e.data})).catch((function(e){t(e)}))},n.state={replications:[],isLoadingReplications:!1,totalReplications:0,noReplication:!0,jobExecutions:[],isLoadingJobExecutions:!1,totalJobExecutions:0,noJobExecution:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.datamartId,n=e.location.search,a=(0,g.parseSearch)(n,y.DATAMART_REPLICATION_SEARCH_SETTINGS);this.fetchReplicationsAndJobs(t,a)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.match.params,a=n.datamartId,r=n.organisationId,o=t.location.search,i=e.match.params,s=i.organisationId,l=i.datamartId,c=e.location.search;if(s!==r||!(0,g.compareSearches)(o,c)||l!==a){var u=(0,g.parseSearch)(o,y.DATAMART_REPLICATION_SEARCH_SETTINGS);this.fetchReplicationsAndJobs(a,u)}}},{key:"render",value:function(){var e=this.state,t=e.replications,n=e.totalReplications,a=e.isLoadingReplications,r=e.noReplication,i=e.jobExecutions,s=e.totalJobExecutions,l=e.isLoadingJobExecutions,c=e.noJobExecution;return o.createElement("div",null,o.createElement("div",null,o.createElement("div",null,o.createElement(h.default,{replications:t,totalReplications:n,isLoadingReplications:a,noReplication:r,onFilterChange:this.handleReplicationFilterChange,deleteReplication:this.onDeleteDatamartReplication,updateReplication:this.onUpdateDatamartReplication,lastExecutionIsRunning:this.isLastExecutionRunning()}))),o.createElement("div",null,o.createElement("div",null,o.createElement(b.default,{jobExecutions:i,totalJobExecutions:s,isLoadingJobExecutions:l,noJobExecution:c,onFilterChange:this.handleJobExecutionsFilterChange,replications:t,fetchReplicationsAndJobs:this.fetchReplicationsAndJobs,createJobExecution:this.createJobExecution}))))}}]),t}(o.Component);S([(0,f.lazyInject)(p.TYPES.IDatamartReplicationService)],E.prototype,"_datamartReplicationService",void 0),t.default=(0,l.compose)(d.injectIntl,c.withRouter,u.default)(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=y(n(225)),s=n(271),l=n(68),c=y(n(206)),u=n(33),d=n(8),f=n(30),p=n(1183),m=n(10),g=n(11);function y(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=function(e){function t(){h(this,t);var e=v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.handleModal=function(t){var n=e.props.intl;m.Modal.info({title:n.formatMessage(c.default.replicationProperties),okText:"Ok",width:"650px",content:r.createElement(i.default,{language:"json",style:s.docco},JSON.stringify(t,void 0,4))})},e.onEditDatamartReplication=function(t){var n=e.props,a=n.match.params.organisationId;n.history.push({pathname:"/v2/o/"+a+"/settings/datamart/"+t.datamart_id+"/datamart_replication/"+t.id+"/edit",state:{from:""+location.pathname+location.search}})},e.onDeleteDatamartReplication=function(t){(0,e.props.deleteReplication)(t)},e.updateReplicationStatus=function(t,n){(0,e.props.updateReplication)(t,n)},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.intl.formatMessage,a=t.total,o=t.onFilterChange,i=t.noItem,s=t.isLoading,d=t.dataSource,y=t.match.params,h=y.organisationId,v=y.datamartId,b=t.location.search,_=t.lastExecutionIsRunning,S=(0,f.parseSearch)(b,p.DATAMART_REPLICATION_SEARCH_SETTINGS),E={current:S.currentPage||1,pageSize:S.pageSize||10,total:a,onChange:function(e,t){return o({currentPage:e,pageSize:t})},onShowSizeChange:function(e,t){return o({pageSize:t,currentPage:1})}},O=[{title:"ID",key:"id",isVisibleByDefault:!0,isHideable:!0,render:function(e){return e}},{intlMessage:c.default.datamartReplicationStatus,key:"status",isHideable:!1,render:function(t,a){return r.createElement(m.Tooltip,{placement:"top",title:_?n(c.default.jobIsRunning):a.status},r.createElement(m.Switch,{className:"mcs-table-switch",checked:"ACTIVE"===t,disabled:"ERROR"===t||_,onChange:function(n){return"ERROR"!==t&&e.updateReplicationStatus(a,n)},checkedChildren:r.createElement(g.McsIcon,{style:{verticalAlign:"middle"},type:"play"}),unCheckedChildren:r.createElement(g.McsIcon,{style:{verticalAlign:"middle"},type:"pause"})}),"ERROR"===t&&r.createElement(g.McsIcon,{className:"font-error status-error",type:"close"}))}},{intlMessage:c.default.datamartReplicationName,key:"name",isHideable:!1,render:function(e,t){return r.createElement(u.Link,{className:"mcs-datamartSettings_datamartReplicationTableItem",to:{pathname:"/v2/o/"+h+"/settings/datamart/"+t.datamart_id+"/datamart_replication/"+t.id+"/edit",state:{datamartId:v}}},e)}},{intlMessage:c.default.datamartReplicationType,key:"type",isVisibleByDefault:!0,isHideable:!0,render:function(e){return e}}],w=[{key:"action",actions:function(){return[{intlMessage:c.default.editDatamartReplication,callback:e.onEditDatamartReplication},{intlMessage:c.default.deleteDatamartReplication,callback:e.onDeleteDatamartReplication},{intlMessage:c.default.seeReplicationProperties,callback:e.handleModal}]}}],M={placeholder:n(c.default.searchPlaceholder),onSearch:function(e){return o({keywords:e})},defaultValue:S.keywords};return i&&!s?r.createElement(g.EmptyTableView,{iconType:"settings",message:n(c.default.emptyDatamartReplicationList),className:"mcs-table-view-empty mcs-empty-card"}):r.createElement(l.TableViewFilters,{columns:O,actionsColumnsDefinition:w,searchOptions:M,dataSource:d,loading:s,pagination:E})}}]),t}(r.Component);t.default=(0,d.compose)(o.injectIntl,u.withRouter)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DATAMART_REPLICATION_SEARCH_SETTINGS=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(33),s=n(41),l=n(10),c=n(6),u=g(n(206)),d=n(30),f=g(n(2647)),p=n(61),m=g(n(23));function g(e){return e&&e.__esModule?e:{default:e}}function y(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var h=l.Layout.Content,v=t.DATAMART_REPLICATION_SEARCH_SETTINGS=[].concat(y(d.KEYWORD_SEARCH_SETTINGS),y(d.PAGINATION_SEARCH_SETTINGS)),b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.buildNewActionElement=function(){var e,t=n.props,a=t.jobExecutions,o=t.intl.formatMessage,i=a.find((function(e){return"SUCCEEDED"===e.status&&e.creation_date>Date.now()-6048e5})),f=r.createElement(l.Button,{key:u.default.newDatamartReplication.id,type:"primary",onClick:function(){var e=n.props,t=e.replications,a=e.match.params.datamartId,i=e.location.search,c=t.filter((function(e){return"ACTIVE"===e.status}));if(c.length>=1){var f=(0,d.parseSearch)(i,v);l.Modal.confirm({icon:r.createElement(s.ExclamationCircleOutlined,null),title:o(u.default.executionModalTitle),content:r.createElement(r.Fragment,null,c.map((function(e){return r.createElement("div",{key:e.id}," - ",e.name)})),r.createElement("br",null),o(u.default.executionModalContent)),okText:o(u.default.newExecution),cancelText:o(u.default.cancelAction),onOk:function(){n.props.createJobExecution(a).then((function(){n.props.fetchReplicationsAndJobs(a,f)}))}})}else l.Modal.confirm({icon:r.createElement(s.ExclamationCircleOutlined,null),title:o(u.default.noExecutionModalTitle),content:o(u.default.noExecutionModalContent)})},disabled:!!i,className:"mcs-replicationNewExecution_button"},r.createElement(c.FormattedMessage,u.default.newExecution));return i?(e=f,r.createElement(l.Tooltip,{placement:"top",title:o(u.default.noExecutionPossible)},e)):f},n.state={jobExecutions:[],totalJobExecutions:0,isLoadingJobExecutions:!0,noItem:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.isLoadingJobExecutions,n=e.totalJobExecutions,a=e.jobExecutions,o=e.noJobExecution,i=e.onFilterChange;return r.createElement("div",{className:"ant-layout"},r.createElement(h,{className:"mcs-content-container"},r.createElement(l.Row,{className:"mcs-table-container"},r.createElement("div",null,r.createElement("div",{className:"mcs-card-header mcs-card-title"},r.createElement("span",{className:"mcs-card-title"},r.createElement(c.FormattedMessage,u.default.initialSynchronization)),r.createElement("span",{className:"mcs-card-button"},this.buildNewActionElement())),r.createElement("hr",{className:"mcs-separator"}),r.createElement(f.default,{dataSource:a,total:n,isLoading:t,noItem:o,onFilterChange:i})))))}}]),t}(r.Component);t.default=(0,o.compose)(c.injectIntl,i.withRouter,p.injectDrawer,m.default)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(13),i=n(6),s=h(n(17)),l=h(n(23)),c=n(8),u=n(10),d=n(206),f=n(68),p=n(1158),m=h(n(69)),g=n(30),y=n(11);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderStatuColumn=function(e){switch(e.status){case"SUCCEEDED":case"SUCCESS":return r.createElement("div",null,e.status," ",e.result&&e.result.total_failure&&e.result.total_failure>0&&r.createElement("span",null,"- with errors"," ",e.error&&e.error.message&&r.createElement(u.Tooltip,{placement:"top",title:e.error&&e.error.message},r.createElement(y.McsIcon,{type:"question"}))));default:return r.createElement("div",null,e.status)}},n.buildColumnDefinition=function(){var e=n.props,t=e.intl.formatMessage,a=e.colors;return[{intlMessage:d.messages.executionId,key:"id",isHideable:!1,render:function(e){return e}},{intlMessage:d.messages.executionStatus,key:"status",isHideable:!1,render:function(e,t){return n.renderStatuColumn(t)}},{intlMessage:d.messages.executionProgress,key:"progress",isHideable:!1,render:function(e,t){return r.createElement("div",null,r.createElement(u.Progress,{showInfo:!1,percent:100*(0,p.getExecutionInfo)(t,a).percent}))}},{intlMessage:d.messages.executionStartDate,key:"start_date",isHideable:!1,render:function(e){return e?(0,s.default)(e).format("DD/MM/YYYY HH:mm:ss"):t(d.messages.executionNotStarted)}},{intlMessage:d.messages.executionEndDate,key:"end_date",isHideable:!1,render:function(e,n){return n.start_date&&n.duration?(0,s.default)(n.start_date+n.duration).format("DD/MM/YYYY HH:mm:ss"):t(d.messages.executionNotEnded)}},{intlMessage:d.messages.executionCreationDate,key:"creation_date",isHideable:!1,render:function(e){return e?(0,s.default)(e).format("DD/MM/YYYY HH:mm:ss"):t(d.messages.executionNotCreated)}}]},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,g.updateSearch)(o,e,g.PAGINATION_SEARCH_SETTINGS)};a.push(i)},n.state={isLoadingJobExecutions:!1,jobExecutions:[],totalJobExecutions:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.location.search,a=t.total,o=t.isLoading,i=t.dataSource,s=t.noItem,l=t.intl,c=(0,g.parseSearch)(n,g.PAGINATION_SEARCH_SETTINGS),u={current:c.currentPage||1,pageSize:c.pageSize||10,onChange:function(t){return e.updateLocationSearch({currentPage:t})},onShowSizeChange:function(t,n){return e.updateLocationSearch({pageSize:n})},total:a};return s&&!o?r.createElement(y.EmptyTableView,{iconType:"settings",message:l.formatMessage(d.messages.emptyInitialSynchronizationList),className:"mcs-table-view-empty mcs-empty-card"}):r.createElement(f.TableViewFilters,{dataSource:i,columns:this.buildColumnDefinition(),pagination:u,loading:o})}}]),t}(r.Component);t.default=(0,c.compose)(o.withRouter,i.injectIntl,m.default,l.default)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=u(n(2649)),i=u(n(2651)),s=n(73),l=u(n(2653)),c=n(8);function u(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.hasFeature;return r.createElement("div",null,r.createElement(o.default,null),e("new-audienceFeatureSelector")?r.createElement(i.default,null):r.createElement(l.default,null))}}]),t}(r.Component);t.default=(0,c.compose)(s.injectFeatures)(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AUDIENCE_BUILDER_SEARCH_SETTINGS=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(33),l=n(10),c=n(6),u=n(133),d=v(n(2650)),f=n(61),p=v(n(23)),m=n(30),g=n(12),y=n(15),h=n(44);function v(e){return e&&e.__esModule?e:{default:e}}function b(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=l.Layout.Content,E=t.AUDIENCE_BUILDER_SEARCH_SETTINGS=[].concat(b(m.KEYWORD_SEARCH_SETTINGS),b(m.PAGINATION_SEARCH_SETTINGS)),O=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchAudienceBuilders=function(e,t){var a,r=n.props.notifyError;n._audienceBuilderService.getAudienceBuilders(e,(a={},t.currentPage&&t.pageSize&&(a=Object.assign({},(0,h.getPaginatedApiParam)(t.currentPage,t.pageSize))),t.keywords?Object.assign(Object.assign({},a),{keywords:t.keywords}):a)).then((function(e){n.setState({isLoading:!1,audienceBuilders:e.data,noAudienceBuilder:e&&0===e.total,totalAudienceBuilder:e.total?e.total:e.count})})).catch((function(e){r(e),n.setState({isLoading:!1})}))},n.deleteAudienceBuilder=function(e){var t=n.props,a=t.match.params.datamartId,r=t.location,o=r.search,i=r.pathname,s=r.state,c=t.history,d=t.intl.formatMessage,f=t.notifyError,p=n.state.audienceBuilders,g=(0,m.parseSearch)(o,E);l.Modal.confirm({icon:"exclamation-circle",title:d(u.messages.audienceBuilderDeleteListModalTitle),okText:d(u.messages.audienceBuilderDeleteListModalOk),cancelText:d(u.messages.audienceBuilderDeleteListModalCancel),onOk:function(){n._audienceBuilderService.deleteAudienceBuilder(e.datamart_id,e.id).then((function(){if(1===p.length&&1!==g.currentPage){var e=Object.assign(Object.assign({},g),{currentPage:g.currentPage-1});n.fetchAudienceBuilders(a,g),c.replace({pathname:i,search:(0,m.updateSearch)(o,e),state:s})}else n.fetchAudienceBuilders(a,g)})).catch((function(e){f(e)}))},onCancel:function(){}})},n.buildNewActionElement=function(){return o.createElement(l.Button,{type:"primary",className:"mcs-audienceBuilder_creation_button",onClick:function(){var e=n.props,t=e.history,a=e.match.params,r=a.datamartId,o=a.organisationId;t.push({pathname:"/v2/o/"+o+"/settings/datamart/"+r+"/audience_builder/create",state:{datamartId:r}})}},o.createElement(c.FormattedMessage,u.messages.audienceBuilderNew))},n.onFilterChange=function(e){var t=n.props.match.params.datamartId;n.fetchAudienceBuilders(t,e)},n.state={isLoading:!0,noAudienceBuilder:!0,totalAudienceBuilder:0,audienceBuilders:[],filter:{pageSize:10,currentPage:1,keywords:""}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.datamartId,n=e.location.search,a=(0,m.parseSearch)(n,E);this.fetchAudienceBuilders(t,a)}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.audienceBuilders,a=e.noAudienceBuilder,r=e.totalAudienceBuilder,i=e.filter;return o.createElement("div",{className:"ant-layout"},o.createElement(S,{className:"mcs-content-container"},o.createElement(l.Row,{className:"mcs-table-container"},o.createElement("div",null,o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(c.FormattedMessage,u.messages.audienceBuilders)),o.createElement("span",{className:"mcs-card-button"},this.buildNewActionElement())),o.createElement("hr",{className:"mcs-separator"}),o.createElement(d.default,{dataSource:n,total:r,isLoading:t,noItem:a,onFilterChange:this.onFilterChange,filter:i,deleteAudienceBuilder:this.deleteAudienceBuilder})))))}}]),t}(o.Component);_([(0,y.lazyInject)(g.TYPES.IAudienceBuilderService)],O.prototype,"_audienceBuilderService",void 0),t.default=(0,i.compose)(c.injectIntl,s.withRouter,f.injectDrawer,p.default)(O)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(68),l=n(133),c=n(33),u=n(8),d=n(11),f=n(23),p=(a=f)&&a.__esModule?a:{default:a};function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e){function t(){m(this,t);var e=g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.onEditAudienceBuilder=function(t){var n=e.props,a=n.match.params,r=a.organisationId,o=a.datamartId;n.history.push({pathname:"/v2/o/"+r+"/settings/datamart/"+o+"/audience_builder/"+t.id+"/edit",state:{from:""+location.pathname+location.search}})},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.intl.formatMessage,a=t.total,r=t.onFilterChange,i=t.noItem,u=t.isLoading,f=t.dataSource,p=t.match.params,m=p.organisationId,g=p.datamartId,y=t.filter,h=t.deleteAudienceBuilder,v={current:y.currentPage,pageSize:y.pageSize,total:a,onChange:function(e,t){return r({currentPage:e,pageSize:t})},onShowSizeChange:function(e,t){return r({pageSize:t,currentPage:1})}},b=[{title:"ID",key:"id",isVisibleByDefault:!0,isHideable:!0,render:function(e){return e}},{intlMessage:l.messages.audienceBuilderName,key:"name",isHideable:!1,render:function(e,t){return o.createElement(c.Link,{to:{pathname:"/v2/o/"+m+"/settings/datamart/"+g+"/audience_builder/"+t.id+"/edit",state:{datamartId:g}}},e)}}],_=[{key:"action",actions:function(){return[{intlMessage:l.messages.audienceBuilderEdit,callback:e.onEditAudienceBuilder},{intlMessage:l.messages.audienceBuilderDelete,callback:h}]}}];return i&&!u?o.createElement(d.EmptyTableView,{iconType:"settings",message:n(l.messages.audienceBuilderEmptyList),className:"mcs-table-view-empty mcs-empty-card"}):o.createElement(s.TableView,{columns:b,actionsColumnsDefinition:_,dataSource:f,loading:u,pagination:v})}}]),t}(o.Component);t.default=(0,u.compose)(i.injectIntl,c.withRouter,p.default)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AUDIENCE_FEATURE_SEARCH_SETTINGS=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(33),l=n(10),c=n(6),u=n(133),d=n(30),f=b(n(1184)),p=n(61),m=b(n(23)),g=n(12),y=n(15),h=n(11),v=b(n(2652));function b(e){return e&&e.__esModule?e:{default:e}}function _(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=l.Layout.Content,O=t.AUDIENCE_FEATURE_SEARCH_SETTINGS=[].concat(_(d.KEYWORD_SEARCH_SETTINGS),_(d.PAGINATION_SEARCH_SETTINGS)),w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchFoldersAndFeatures=function(e,t){var a=n.props.intl;n.setState({isLoading:!0}),n.fetchFolders(e).then((function(e){n.fetchAudienceFeatures().then((function(t){var r={id:null,name:a.formatMessage(u.messages.audienceFeatures),parent_id:"root",children:function n(a){return a.map((function(a){return{id:a.id,name:a.name,parent_id:a.parent_id,audience_features:t.filter((function(e){return a.audience_feature_ids.includes(e.id)})),children:n(e.filter((function(e){return null!==e.id&&a.children_ids.includes(e.id)})))}}))}(e.filter((function(e){return null===e.parent_id}))),audience_features:[]};n.setState({audienceFeaturesByFolder:r,selectedFolder:r,isLoading:!1})})).catch((function(e){n.props.notifyError(e),n.setState({isLoading:!1})}))}))},n.fetchFolders=function(e){return n._audienceFeatureService.getAudienceFeatureFolders(e).then((function(e){return e.data})).catch((function(e){return n.props.notifyError(e),[]}))},n.fetchAudienceFeatures=function(e){var t=n.props.match.params.datamartId,a={};return(null==e?void 0:e.keywords)&&(a.keywords=[e.keywords]),a.fake_dataset=!0,n._audienceFeatureService.getAudienceFeatures(t,a).then((function(e){return e.data}))},n.deleteAudienceFeature=function(e){var t=n.props,a=t.location,r=a.search,o=a.pathname,i=a.state,s=t.history,c=t.intl.formatMessage,f=t.notifyError,p=n.state.selectedFolder,m=(0,d.parseSearch)(r,O);l.Modal.confirm({icon:"exclamation-circle",title:c(u.messages.audienceFeatureDeleteListModalTitle),okText:c(u.messages.audienceFeatureDeleteListModalOk),cancelText:c(u.messages.audienceFeatureDeleteListModalCancel),onOk:function(){n._audienceFeatureService.deleteAudienceFeature(e.datamart_id,e.id).then((function(){if(p&&1===p.audience_features.length&&1!==m.currentPage){var e=Object.assign(Object.assign({},m),{currentPage:m.currentPage-1});n.fetchAudienceFeatures(m),s.replace({pathname:o,search:(0,d.updateSearch)(r,e),state:i})}else n.fetchAudienceFeatures(m)})).catch((function(e){f(e)}))},onCancel:function(){}})},n.renameFolder=function(e,t){var a=n.props.match.params.datamartId;return n._audienceFeatureService.updateAudienceFeatureFolder(a,e,{name:t}).catch((function(e){n.props.notifyError(e)}))},n.createFolder=function(){var e=n.props.match.params.datamartId,t=n.state,a=t.inputValue,r=t.selectedFolder;return n._audienceFeatureService.createAudienceFeatureFolder(e,{name:a,datamart_id:e,parent_id:null==r?void 0:r.id}).catch((function(e){n.props.notifyError(e)}))},n.deleteFolder=function(e){var t=n.props.match.params.datamartId;return n._audienceFeatureService.deleteAudienceFeatureFolder(t,e).catch((function(e){n.props.notifyError(e)}))},n.getFolder=function(e){var t=n.state.audienceFeaturesByFolder,a=void 0;return t&&function n(r){null===e?a=t:r.children.forEach((function(t){t.id===e?a=t:n(t)}))}(t),a},n.onSelectFolder=function(e){return function(){n.setState({selectedFolder:n.getFolder(e)})}},n.getBreadCrumb=function(){var e=n.state,t=e.selectedFolder,a=e.audienceFeaturesByFolder;return o.createElement(l.Breadcrumb,{className:"mcs-audienceFeatureSettings_breadCrumb"},function(){if(t&&a){var e=[];return function t(r){var o=n.getFolder(r.parent_id);null===r.id?e.unshift(a):(e.unshift(r),o&&t(o))}(t),e.map((function(e){return o.createElement(l.Breadcrumb.Item,{key:e.id?e.id:"root_key"},o.createElement(h.Button,{onClick:n.onSelectFolder(e.id)},e.name))}))}}())},n.renderFolderTable=function(){var e=n.state.selectedFolder;return o.createElement("div",null,n.getBreadCrumb(),o.createElement(l.Row,{className:"mcs-audienceFeatureSettings_folderTable",gutter:16},!!e&&e.children.map((function(e){return o.createElement(v.default,{key:e.id?e.id:"root_key",folder:e,onSelectFolder:n.onSelectFolder,renameFolder:n.renameFolder,deleteFolder:n.deleteFolder})}))))},n.onFilterChange=function(e){n.fetchAudienceFeatures(e)},n.handleInputChange=function(e){n.setState({inputValue:e.target.value})},n.buildActionButtons=function(){var e=n.props,t=e.history,a=e.intl,r=e.match.params,i=r.datamartId,s=r.organisationId,d=n.state,f=d.displayFolderInput,p=d.inputValue;return f?o.createElement("div",{className:"mcs-audienceFeatureSettings-folderForm"},o.createElement(l.Input,{value:p,onChange:n.handleInputChange,className:"mcs-audienceFeatureSettings-folderInput",placeholder:a.formatMessage(u.messages.audienceFeaturePlaceholderFolderInput)}),o.createElement(l.Button,{type:"primary",onClick:function(){n.createFolder()}},o.createElement(c.FormattedMessage,u.messages.audienceFeatureAddButton)),o.createElement(l.Button,{onClick:function(){n.setState({displayFolderInput:!1})}},o.createElement(c.FormattedMessage,u.messages.audienceFeatureCancelButton))):o.createElement("div",null,o.createElement(l.Button,{type:"primary",onClick:function(){t.push({pathname:"/v2/o/"+s+"/settings/datamart/"+i+"/audience_feature/create",state:{datamartId:i}})},className:"mcs-audienceFeature_creation_button"},o.createElement(c.FormattedMessage,u.messages.audienceFeatureNew)),o.createElement(l.Button,{className:"mcs-audienceFeatureSettings-addFolderButton",onClick:function(){n.setState({displayFolderInput:!0})}},o.createElement(c.FormattedMessage,u.messages.audienceFeatureAddFolder)))},n.state={isLoading:!0,filter:{pageSize:10,currentPage:1,keywords:""},displayFolderInput:!1,inputValue:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.datamartId,n=e.location.search,a=(0,d.parseSearch)(n,O);this.fetchFoldersAndFeatures(t,a)}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.filter,a=e.selectedFolder;return o.createElement("div",{className:"ant-layout"},o.createElement(E,{className:"mcs-content-container"},o.createElement(l.Row,{className:"mcs-audienceFeatureSettings-table"},o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(c.FormattedMessage,u.messages.audienceFeatures)),o.createElement("div",{className:"mcs-card-button"},this.buildActionButtons())),!!a&&o.createElement(f.default,{dataSource:a.audience_features,total:a&&"root"===a.parent_id&&a.children.length>0?a.children.length:0,isLoading:t,noItem:!1,onFilterChange:this.onFilterChange,filter:n,deleteAudienceFeature:this.deleteAudienceFeature,relatedTable:this.renderFolderTable()}))))}}]),t}(o.Component);S([(0,y.lazyInject)(g.TYPES.IAudienceFeatureService)],w.prototype,"_audienceFeatureService",void 0),t.default=(0,i.compose)(c.injectIntl,s.withRouter,p.injectDrawer,m.default)(w)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(8),s=n(6),l=n(11),c=n(133),u=n(41);var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleCard=function(){n.setState({editionMode:!n.state.editionMode})},n.handleInputChange=function(e){n.setState({inputValue:e.target.value})},n.getMenu=function(e){var t=n.props,a=t.intl,i=t.deleteFolder;if(null!==e){return r.createElement(o.Menu,null,r.createElement(o.Menu.Item,{key:"0"},r.createElement("div",{onClick:function(){n.setState({editionMode:!0})}},a.formatMessage(c.messages.audienceFeatureRename))),r.createElement(o.Menu.Item,{key:"1"},r.createElement("div",{onClick:function(){i(e)}},a.formatMessage(c.messages.audienceFeatureDelete))))}return r.createElement("div",null)},n.renameFolder=function(e){return function(){var t=n.props.renameFolder,a=n.state.inputValue;if(null!==e)return t(e,a)}},n.cancelEdition=function(){n.setState({editionMode:!1})},n.state={editionMode:!1,inputValue:e.folder.name},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.folder,n=e.onSelectFolder,a=e.intl,i=this.state,d=i.editionMode,f=i.inputValue;return r.createElement("div",{onClick:n(t.id)},r.createElement(o.Row,{key:t.id?t.id:"root_key",className:"mcs-audienceFeatureSettings_folder"},r.createElement(o.Col,{span:2},r.createElement(u.FolderOutlined,{className:"menu-icon"})),r.createElement(o.Col,{span:21},d?r.createElement("div",{className:"mcs-audienceFeatureSettings-folderForm"},r.createElement(o.Input,{value:f,onChange:this.handleInputChange,className:"mcs-audienceFeatureSettings-folderInput",placeholder:a.formatMessage(c.messages.audienceFeaturePlaceholderFolderInput)}),r.createElement(o.Button,{type:"primary",onClick:this.renameFolder(t.id)},r.createElement(s.FormattedMessage,c.messages.audienceFeatureRename)),r.createElement(o.Button,{onClick:this.cancelEdition},r.createElement(s.FormattedMessage,c.messages.audienceFeatureCancelButton))):t.name),r.createElement(o.Col,{span:1},r.createElement(o.Dropdown,{overlay:this.getMenu(t.id),trigger:["click"]},r.createElement(l.McsIcon,{type:"chevron"})))))}}]),t}(r.Component);t.default=(0,i.compose)(s.injectIntl)(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AUDIENCE_BUILDER_SEARCH_SETTINGS=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(33),l=n(10),c=n(6),u=n(133),d=n(30),f=v(n(1184)),p=n(61),m=v(n(23)),g=n(12),y=n(15),h=n(44);function v(e){return e&&e.__esModule?e:{default:e}}function b(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=l.Layout.Content,E=t.AUDIENCE_BUILDER_SEARCH_SETTINGS=[].concat(b(d.KEYWORD_SEARCH_SETTINGS),b(d.PAGINATION_SEARCH_SETTINGS)),O=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchAudienceFeatures=function(e,t){var a,r=n.props.notifyError;n.setState({filter:t}),n._audienceFeatureService.getAudienceFeatures(e,(a={},t.currentPage&&t.pageSize&&(a=Object.assign({},(0,h.getPaginatedApiParam)(t.currentPage,t.pageSize))),t.keywords?Object.assign(Object.assign({},a),{keywords:t.keywords}):a)).then((function(e){n.setState({isLoading:!1,audienceFeatures:e.data,noAudienceFeature:e&&0===e.total&&!t.keywords,totalAudienceFeature:e.total?e.total:e.count})})).catch((function(e){r(e),n.setState({isLoading:!1})}))},n.deleteAudienceFeature=function(e){var t=n.props,a=t.match.params.datamartId,r=t.location,o=r.search,i=r.pathname,s=r.state,c=t.history,f=t.intl.formatMessage,p=t.notifyError,m=n.state.audienceFeatures,g=(0,d.parseSearch)(o,E);l.Modal.confirm({icon:"exclamation-circle",title:f(u.messages.audienceFeatureDeleteListModalTitle),okText:f(u.messages.audienceFeatureDeleteListModalOk),cancelText:f(u.messages.audienceFeatureDeleteListModalCancel),onOk:function(){n._audienceFeatureService.deleteAudienceFeature(e.datamart_id,e.id).then((function(){if(1===m.length&&1!==g.currentPage){var e=Object.assign(Object.assign({},g),{currentPage:g.currentPage-1});n.fetchAudienceFeatures(a,g),c.replace({pathname:i,search:(0,d.updateSearch)(o,e),state:s})}else n.fetchAudienceFeatures(a,g)})).catch((function(e){p(e)}))},onCancel:function(){}})},n.onFilterChange=function(e){var t=n.props.match.params.datamartId;n.fetchAudienceFeatures(t,e)},n.buildNewActionElement=function(){return o.createElement(l.Button,{type:"primary",onClick:function(){var e=n.props,t=e.history,a=e.match.params,r=a.datamartId,o=a.organisationId;t.push({pathname:"/v2/o/"+o+"/settings/datamart/"+r+"/audience_feature/create",state:{datamartId:r}})},className:"mcs-audienceFeature_creation_button"},o.createElement(c.FormattedMessage,u.messages.audienceFeatureNew))},n.state={isLoading:!0,noAudienceFeature:!0,totalAudienceFeature:0,audienceFeatures:[],filter:{pageSize:10,currentPage:1,keywords:""}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.datamartId,n=e.location.search,a=(0,d.parseSearch)(n,E);this.fetchAudienceFeatures(t,a)}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.audienceFeatures,a=e.noAudienceFeature,r=e.totalAudienceFeature,i=e.filter;return o.createElement("div",{className:"ant-layout"},o.createElement(S,{className:"mcs-content-container"},o.createElement(l.Row,{className:"mcs-table-container"},o.createElement("div",null,o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(c.FormattedMessage,u.messages.audienceFeatures)),o.createElement("span",{className:"mcs-card-button"},this.buildNewActionElement())),o.createElement("hr",{className:"mcs-separator"}),o.createElement(f.default,{dataSource:n,total:r,isLoading:t,noItem:a,onFilterChange:this.onFilterChange,filter:i,deleteAudienceFeature:this.deleteAudienceFeature})))))}}]),t}(o.Component);_([(0,y.lazyInject)(g.TYPES.IAudienceFeatureService)],O.prototype,"_audienceFeatureService",void 0),t.default=(0,i.compose)(c.injectIntl,s.withRouter,p.injectDrawer,m.default)(O)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(77),c=n(13),u=n(6),d=n(87),f=n(15),p=n(12),m=S(n(126)),g=n(44),y=S(n(635)),h=n(30),v=S(n(17)),b=n(33),_=n(24);function S(e){return e&&e.__esModule?e:{default:e}}var E=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=s.Layout.Content,w={modalLoading:!1,isModalOpen:!1,mlAlgorithmVariables:[],newMlAlgorithmVariables:{}},M={loading:!1,data:[],total:0,mlAlgorithmForkModalData:w},P=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchMlAlgorithms=function(e,t){var a=n.props.intl;n.setState({loading:!0},(function(){var r=Object.assign({},(0,g.getPaginatedApiParam)(t.currentPage,t.pageSize));n._mlAlgorithmService.getMlAlgorithms(e,r).then((function(e){n.setState({loading:!1,data:e.data,total:e.total||e.count})})).catch((function(e){s.message.error(a.formatMessage(y.default.loadingError))}))}))},n.handleEditMlAlgorithm=function(e){var t=n.props,a=t.match.params.organisationId,r=t.location;t.history.push({pathname:"/v2/o/"+a+"/settings/datamart/ml_algorithms/"+e.id+"/edit",state:{from:""+r.pathname+r.search}})},n.handleArchiveMlAlgorithm=function(e){var t=n.props,a=t.match.params.organisationId,r=t.location.search,o=t.intl;e.archived=!0,n._mlAlgorithmService.updateMlAlgorithm(e.id,e).then((function(e){return e.data})).then((function(e){var t=(0,h.parseSearch)(r,h.PAGINATION_SEARCH_SETTINGS);n.fetchMlAlgorithms(a,t),s.message.success(o.formatMessage(y.default.updateSuccess))})).catch((function(e){s.message.error(o.formatMessage(y.default.updateError))}))},n.forkMlAlgorithm=function(e){n.setState({mlAlgorithmForkModalData:Object.assign(Object.assign({},n.state.mlAlgorithmForkModalData),{mlAlgorithm:e,modalLoading:!0,isModalOpen:!0})});var t=n.props.match.params.organisationId;Promise.all([n._mlAlgorithmModelService.getMlAlgorithmModels(t,e.id,{status:"LIVE"}),n._mlAlgorithmVariableService.getMlAlgorithmVariables(t,e.id)]).then((function(e){var t=e[0],a=e[1];1===t.total&&n.setState({mlAlgorithmForkModalData:Object.assign(Object.assign({},n.state.mlAlgorithmForkModalData),{mlAlgorithmModel:t.data[0]})}),n.setState({mlAlgorithmForkModalData:Object.assign(Object.assign({},n.state.mlAlgorithmForkModalData),{modalLoading:!1,mlAlgorithmVariables:a.data,newMlAlgorithmVariables:a.data.reduce((function(e,t){return e[t.key]=t.value,e}),{})})})})).catch((function(e){n.props.notifyError(e),n.setState({mlAlgorithmForkModalData:Object.assign(Object.assign({},n.state.mlAlgorithmForkModalData),{modalLoading:!1,isModalOpen:!1})})}))},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,h.updateSearch)(o,e,h.PAGINATION_SEARCH_SETTINGS)};a.push(i)},n.buildColumnDefinition=function(){var e=n.props.intl.formatMessage;return{dataColumnsDefinition:[{intlMessage:y.default.id,key:"id",isHideable:!1,render:function(e){return e}},{intlMessage:y.default.name,key:"name",isHideable:!1,render:function(e,t){return i.createElement(b.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+t.organisation_id+"/settings/datamart/ml_algorithms/"+t.id+"/models"},t.name)}},{intlMessage:y.default.description,key:"description",isHideable:!1,render:function(e,t){return i.createElement(b.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+t.organisation_id+"/settings/datamart/ml_algorithms/"+t.id+"/models"},e)}},{intlMessage:y.default.lastUpdatedDate,key:"last updated date",isHideable:!1,render:function(t,n){return n.last_updated_date?(0,v.default)(n.last_updated_date).format("DD/MM/YYYY HH:mm:ss"):e(y.default.lastUpdatedDate)}},{intlMessage:y.default.archived,key:"archived",isHideable:!1,render:function(t,n){return n.archived?e(y.default.isArchived):e(y.default.notArchived)}}]}},n.renderModal=function(){var e=n.props,t=e.intl,r=e.history,o=function(e){if(e)return s.message.success(t.formatMessage(y.default.forkSuccess)),r.push("/v2/o/"+p+"/settings/datamart/ml_algorithms");n.setState({loading:!1,mlAlgorithmForkModalData:Object.assign(Object.assign({},n.state.mlAlgorithmForkModalData),{isModalOpen:!1,modalLoading:!1})}),s.message.error(t.formatMessage(y.default.forkError))},c=n.state.mlAlgorithmForkModalData,u=c.isModalOpen,d=c.mlAlgorithmVariables,f=c.modalLoading,p=n.props.match.params.organisationId,m=d.map((function(e,t){return i.createElement(_.FormFieldWrapper,{key:t,label:e.key,small:!0},i.createElement(s.Input,{key:t,defaultValue:e.value,onChange:function(t){var a=n.state.mlAlgorithmForkModalData.newMlAlgorithmVariables;a[e.key]=t.target.value,n.setState({mlAlgorithmForkModalData:Object.assign(Object.assign({},n.state.mlAlgorithmForkModalData),{newMlAlgorithmVariables:a})})},placeholder:e.key}))}));return i.createElement(s.Modal,{title:t.formatMessage(y.default.forkMlAlgorithmModalTitle),visible:u,confirmLoading:f,onCancel:function(){n.setState({mlAlgorithmForkModalData:w})},onOk:function(){var e=n.state.mlAlgorithmForkModalData,t=e.newMlAlgorithmVariables,r=e.mlAlgorithm,i=e.mlAlgorithmModel;n._mlAlgorithmService.createMlAlgorithm({archived:!1,name:r.name+" (Copy)",description:r.description,organisation_id:p}).then((function(e){return e.data})).then((function(e){return Promise.all(Object.entries(t).map((function(t,r){var o=a(t,2),i=o[0],s=o[1];n._mlAlgorithmVariableService.createMlAlgorithmVariable(e.id,{key:i,value:s})}))),e.id})).then((function(e){return n._mlAlgorithmModelService.createMlAlgorithmModel(e,Object.assign({id:void 0},i))})).then((function(e){n.setState({mlAlgorithmForkModalData:w}),o(e.data.id)})).catch((function(e){return o()}))}},i.createElement(s.Spin,{spinning:f},i.createElement("div",null,t.formatMessage(y.default.forkMlAlgorithmModalSubtitle)),i.createElement("br",null),i.createElement(l.Form,{layout:"vertical"},m)))},n.state=M,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.history,r={iconType:"settings",message:this.props.intl.formatMessage(y.default.empty)},o=[{key:"action",actions:function(t){return[{intlMessage:y.default.editMlAlgorithmRaw,callback:e.handleEditMlAlgorithm,disabled:t.archived},{intlMessage:y.default.archive,callback:e.handleArchiveMlAlgorithm,disabled:t.archived},{intlMessage:y.default.fork,callback:e.forkMlAlgorithm,disabled:t.archived}]}}],l=[i.createElement(s.Button,{key:"create",type:"primary",onClick:function(){a.push("/v2/o/"+n+"/settings/datamart/ml_algorithms/create")}},i.createElement(u.FormattedMessage,y.default.newMlAlgorithm))],c=i.createElement("div",null,i.createElement("div",{className:"mcs-card-header mcs-card-title"},i.createElement("span",{className:"mcs-card-title"},i.createElement(u.FormattedMessage,y.default.mlAlgorithms)),i.createElement("span",{className:"mcs-card-button"},l)),i.createElement("hr",{className:"mcs-separator"}));return i.createElement("div",{className:"ant-layout"},i.createElement(O,{className:"mcs-content-container"},this.renderModal(),i.createElement(m.default,{fetchList:this.fetchMlAlgorithms,dataSource:this.state.data,loading:this.state.loading,total:this.state.total,columns:this.buildColumnDefinition().dataColumnsDefinition,actionsColumnsDefinition:o,pageSettings:h.PAGINATION_SEARCH_SETTINGS,emptyTable:r,additionnalComponent:c})))}}]),t}(i.Component);E([(0,f.lazyInject)(p.TYPES.IMlAlgorithmService)],P.prototype,"_mlAlgorithmService",void 0),E([(0,f.lazyInject)(p.TYPES.IMlAlgorithmModelService)],P.prototype,"_mlAlgorithmModelService",void 0),E([(0,f.lazyInject)(p.TYPES.IMlAlgorithmVariableService)],P.prototype,"_mlAlgorithmVariableService",void 0),t.default=(0,d.compose)(c.withRouter,u.injectIntl)(P)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(6),l=n(8),c=n(15),u=n(12),d=n(10),f=y(n(635)),p=n(2656),m=n(51),g=y(n(1185));function y(e){return e&&e.__esModule?e:{default:e}}var h=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.variablesToKeyValues=function(e){return e.map((function(e){return{leftValue:e.key,rightValue:e.value}}))},n.save=function(e){var t=function(e){if(e)return y(),d.message.success(l.formatMessage(f.default.updateSuccess)),r.push("/v2/o/"+s+"/settings/datamart/ml_algorithms");y(),n.setState({loading:!1}),d.message.error(l.formatMessage(f.default.updateError))},a=n.props,r=a.history,o=a.match.params,i=o.mlAlgorithmId,s=o.organisationId,l=a.intl,c=n.state.mlAlgorithmFormData,u={},p=[],m=[];c.mlAlgorithmVariables.forEach((function(e){e.key&&e.id&&(u[e.key]=e.id,p.push(e.id),m.push(e.key))}));var g=e.mlAlgorithmVariablesKeyValues.filter((function(e){return""!==e.leftValue})).map((function(t){return{key:t.leftValue,value:t.rightValue,ml_algorithm_id:e.mlAlgorithm.id||void 0,id:m.includes(t.leftValue)?u[t.leftValue]:void 0}}));n.setState({loading:!0});var y=d.message.loading(l.formatMessage(f.default.savingInProgress),0),h=Object.assign(Object.assign({},e.mlAlgorithm),{organisation_id:s});i?n._mlAlgorithmService.updateMlAlgorithm(i,h).then((function(e){return e.data})).then((function(e){return Promise.all(g.map((function(e){return e.id?n._mlAlgorithmVariableService.updateMlAlgorithmVariable(i,e.id,e):n._mlAlgorithmVariableService.createMlAlgorithmVariable(i,e)})))})).then((function(e){return e.map((function(e){return e.data.id}))})).then((function(e){return p.filter((function(t){return!e.includes(t)}))})).then((function(e){Promise.all(e.map((function(e){return n._mlAlgorithmVariableService.deleteMlAlgorithmVariable(i,e)})))})).then((function(){return t(i)})).catch((function(e){t()})):n._mlAlgorithmService.createMlAlgorithm(h).then((function(e){return e.data})).then((function(e){return e.id})).then((function(e){return Promise.all(g.map((function(t){return n._mlAlgorithmVariableService.createMlAlgorithmVariable(e,t)}))),e})).then((function(e){return t(e)})).catch((function(e){t()}))},n.close=function(){var e=n.props,t=e.history,a=e.location,r=e.match.params.organisationId,o=a.state&&a.state.from?a.state.from:"/v2/o/"+r+"/settings/datamart/ml_algorithms";return t.push(o)},n.state={loading:!1,mlAlgorithmFormData:p.INITIAL_ML_ALGORITHM_FORM_DATA},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params,t=e.organisationId,n=e.mlAlgorithmId;n&&this.loadInitialValues(t,n)}},{key:"componentDidUpdate",value:function(e){var t=this.props.match.params,n=t.organisationId,a=t.mlAlgorithmId,r=e.match.params,o=r.organisationId;a===r.mlAlgorithmId&&n===o||(this.setState({loading:!0}),this.loadInitialValues(n,a))}},{key:"loadInitialValues",value:function(e,t){var n=this,a=this.props.intl;t?this._mlAlgorithmService.getMlAlgorithm(t).then((function(e){return e.data})).then((function(e){n.setState({loading:!0,mlAlgorithmFormData:{mlAlgorithm:e,mlAlgorithmVariables:[],mlAlgorithmVariablesKeyValues:[]}})})).then((function(){return n._mlAlgorithmVariableService.getMlAlgorithmVariables(e,t)})).then((function(e){return e.data})).then((function(e){var t={mlAlgorithm:n.state.mlAlgorithmFormData.mlAlgorithm,mlAlgorithmVariables:e,mlAlgorithmVariablesKeyValues:n.variablesToKeyValues(e)};n.setState({mlAlgorithmFormData:t,loading:!1})})).catch((function(e){d.message.error(a.formatMessage(f.default.loadingError))})):this.setState({loading:!1})}},{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.match.params,a=n.organisationId,r=n.mlAlgorithmId,i=this.state,s=i.loading,l=i.mlAlgorithmFormData,c=r?t(f.default.editMlAlgorithm,{name:l.mlAlgorithm.name?l.mlAlgorithm.name:t(f.default.mlAlgorithms)}):t(f.default.newMlAlgorithm),u=[{name:t(f.default.mlAlgorithms),path:"/v2/o/"+a+"/settings/datamart/ml_algorithms"},{name:c}];return s?o.createElement(m.Loading,{isFullScreen:!0}):o.createElement(g.default,{initialValues:this.state.mlAlgorithmFormData,onSave:this.save,onClose:this.close,breadCrumbPaths:u})}}]),t}(o.Component);h([(0,c.lazyInject)(u.TYPES.IMlAlgorithmService)],v.prototype,"_mlAlgorithmService",void 0),h([(0,c.lazyInject)(u.TYPES.IMlAlgorithmVariableService)],v.prototype,"_mlAlgorithmVariableService",void 0),t.default=(0,l.compose)(i.withRouter,s.injectIntl)(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INITIAL_ML_ALGORITHM_FORM_DATA={mlAlgorithm:{name:"",description:""},mlAlgorithmVariables:[],mlAlgorithmVariablesKeyValues:[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=n(35),s=g(n(49)),l=g(n(63)),c=g(n(635)),u=n(24),d=n(8),f=n(25),p=n(1185),m=g(n(2658));function g(e){return e&&e.__esModule?e:{default:e}}var y=i.FieldArray,h=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators,n=t.isRequired,a=t.isCharLengthLessThan,o=e.intl.formatMessage;return r.createElement("div",null,r.createElement(u.FormSection,{title:c.default.sectionTitleGeneral,subtitle:c.default.sectionSubTitleGeneral}),r.createElement("div",null,r.createElement(u.FormInputField,{name:"mlAlgorithm.name",component:u.FormInput,validate:[n],formItemProps:{label:o(c.default.labelMlAlgorithmName),required:!0},inputProps:{placeholder:o(c.default.labelMlAlgorithmName)},helpToolTipProps:{title:o(c.default.tooltipMlAlgorithmName)}}),r.createElement(u.FormTextAreaField,{name:"mlAlgorithm.description",component:u.FormTextArea,validate:[a(255),n],formItemProps:{label:o(c.default.description)},inputProps:{placeholder:o(c.default.labelMlAlgorithmDescription)},helpToolTipProps:{title:o(c.default.labelMlAlgorithmDescription)}}),r.createElement(y,{name:"mlAlgorithmVariablesKeyValues",component:m.default,formItemProps:{label:o(c.default.mlVariableLabel),colon:!1},leftFormInput:{placeholder:o(c.default.mlVariableKeyPlaceholder)},rightFormInput:{placeholder:o(c.default.mlVariableValuePlaceholder)}})))}}]),t}(r.Component);t.default=(0,d.compose)(o.injectIntl,s.default,l.default,(0,f.connect)((function(e){return{formValues:(0,i.getFormValues)(p.FORM_ID)(e)}})))(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(35),l=n(6),c=n(10),u=n(1176),d=(a=u)&&a.__esModule?a:{default:a},f=n(11);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=(0,l.defineMessages)({AddFilterButtonText:{id:"settings.form.eventRules.uriMatch.eventName.addProperty",defaultMessage:"Add Property"}}),y=s.Field,h=function(e){function t(){return p(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.fields,a=t.intl,o=n.length?(n||[]).map((function(t,a,o){var s=function(){return n.remove(a)};return i.createElement("div",{key:a},i.createElement(y,r({},e.props,{name:""+t,component:d.default,renderFieldAction:function(){return i.createElement("div",{onClick:s},i.createElement(f.McsIcon,{type:"close"}))}})))})):null;return i.createElement("div",null,i.createElement(c.Row,null,i.createElement(c.Col,{span:24,offset:this.props.formItemProps.label?0:3},o)),i.createElement(c.Row,null,i.createElement(c.Col,{span:15,offset:4},i.createElement("div",{onClick:function(){return n.push({leftValue:"",rightValue:""})}},i.createElement(c.Col,{span:20,className:"add-field-button"},i.createElement("p",null,i.createElement(f.McsIcon,{type:"plus"}),a.formatMessage(g.AddFilterButtonText)))))))}}]),t}(i.Component);t.default=(0,l.injectIntl)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(13),l=n(6),c=n(8),u=n(12),d=n(15),f=n(30),p=S(n(126)),m=n(44),g=S(n(1186)),y=S(n(17)),h=S(n(49)),v=S(n(261)),b=S(n(59)),_=S(n(2660));function S(e){return e&&e.__esModule?e:{default:e}}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=i.Layout.Content,w=i.Upload.Dragger,M={loading:!1,data:[],total:0,isModalOpen:!1,isPreviewModalOpened:!1,previewModalHtml:"",newModelName:""},P=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fetchMlAlgorithmModels=function(e,t){var a=n.props.match.params.mlAlgorithmId;n.fetchMlAlgorithmModelsWithMlAlgorithmId(e,a,t)},n.fetchMlAlgorithmModelsWithMlAlgorithmId=function(e,t,a){var r=n.props.intl;n.setState({loading:!0},(function(){var o=Object.assign({},(0,m.getPaginatedApiParam)(a.currentPage,a.pageSize));n._mlAlgorithmModelService.getMlAlgorithmModels(e,t,o).then((function(e){n.setState({loading:!1,data:e.data,total:e.total||e.count})})).catch((function(e){i.message.error(r.formatMessage(g.default.modelsLoadingError))}))}))},n.buildColumnDefinition=function(){var e=n.props.intl.formatMessage;return{dataColumnsDefinition:[{intlMessage:g.default.id,key:"id",isHideable:!1,render:function(e){return e}},{intlMessage:g.default.name,key:"name",isHideable:!1,render:function(e,t){return t.name}},{intlMessage:g.default.status,key:"status",isHideable:!1,render:function(e,t){return t.status}},{intlMessage:g.default.lastUpdatedDate,key:"last updated date",isHideable:!1,render:function(t,n){return n.last_updated_date?(0,y.default)(n.last_updated_date).format("DD/MM/YYYY HH:mm:ss"):e(g.default.lastUpdatedDate)}}]}},n.onFileUpdate=function(e,t){return new Promise((function(n,a){var r=new FileReader;r.onload=function(e){var t=e.target.result;return n(t)},t?r.readAsArrayBuffer(e):r.readAsText(e,"UTF-8")}))},n.formatFormData=function(e,t){var a=new FormData;return n.onFileUpdate(e,t).then((function(t){var n=new Blob([t],{});return a.append("file",n,e.name),a})).catch((function(e){return n.props.notifyError(e),a}))},n.handleOnUploadButton=function(){var e=n.props,t=e.match.params,a=t.organisationId,r=t.mlAlgorithmId,o=e.location.search,s=e.intl,l=n.state,c=l.modelFile,u=l.resultFile,d=l.notebookFile,p=l.newModelName;""===p&&i.message.error(s.formatMessage(g.default.modelNameIsRequired)),c&&u&&d&&""!==p&&(n.setState({loading:!0}),Promise.all([n.formatFormData(c[0],!0),n.formatFormData(u[0],!1),n.formatFormData(d[0],!1)]).then((function(e){var t=e[0],l=e[1],c=e[2],u={name:n.state.newModelName,status:"PAUSED",organisation_id:a};n._mlAlgorithmModelService.createMlAlgorithmModel(r,u).then((function(e){return e.data})).then((function(e){return n._mlAlgorithmModelService.uploadNotebook(r,e.id,c)})).then((function(e){return e.data})).then((function(e){return n._mlAlgorithmModelService.uploadBinary(r,e.id,t)})).then((function(e){return e.data})).then((function(e){return n._mlAlgorithmModelService.uploadResult(r,e.id,l)})).then((function(e){var t=(0,f.parseSearch)(o,f.PAGINATION_SEARCH_SETTINGS);n.fetchMlAlgorithmModels(a,t),n.setState({loading:!1,isModalOpen:!1,resultFile:[],modelFile:[],notebookFile:[]})})).catch((function(e){n.setState({loading:!1});var t=s.formatMessage(g.default.modelCreationError);e.error&&(t+=": "+e.error),i.message.error(t)}))})).catch((function(e){n.setState({loading:!1}),n.props.notifyError(e)})))},n.download=function(e){try{window.open(window.MCS_CONSTANTS.API_URL+"/v1/data_file/data?uri="+encodeURIComponent(e)+"&access_token="+encodeURIComponent(v.default.getItem("access_token")))}catch(e){b.default.error(e)}},n.downloadBinary=function(e){e.binary_uri&&n.download(e.binary_uri)},n.downloadResult=function(e){e.html_notebook_result_uri&&n.download(e.html_notebook_result_uri)},n.downloadNotebook=function(e){e.notebook_uri&&n.download(e.notebook_uri)},n.previewResult=function(e){e.html_notebook_result_uri&&n._dataFileService.getDatafileData(e.html_notebook_result_uri).then((function(e){return new Response(e).text()})).then((function(e){n.setState({previewModalHtml:e,isPreviewModalOpened:!0})}))},n.onClosePreviewModal=function(){n.setState({previewModalHtml:"",isPreviewModalOpened:!n.state.isPreviewModalOpened})},n.togglePause=function(e){var t=n.props,a=t.match.params,r=a.organisationId,o=a.mlAlgorithmId,s=t.location.search,l=t.intl;"PAUSED"===e.status?e.status="LIVE":e.status="PAUSED",n._mlAlgorithmModelService.updateMlAlgorithmModel(o,e.id,e).then((function(e){return e.data})).then((function(e){var t=(0,f.parseSearch)(s,f.PAGINATION_SEARCH_SETTINGS);n.fetchMlAlgorithmModels(r,t),i.message.success(l.formatMessage(g.default.updateSuccess))})).catch((function(e){i.message.error(l.formatMessage(g.default.updateError))}))},n.handleOpenClose=function(){n.setState({isModalOpen:!n.state.isModalOpen})},n.renderModal=function(){var e=n.props.intl.formatMessage,t=n.state,a=t.loading,r=t.isModalOpen,s=t.resultFile,l=t.modelFile,c=t.notebookFile,u={name:"file",multiple:!1,action:"/",accept:"",beforeUpload:function(e,t){return n.setState({modelFile:t}),!1},fileList:l,onRemove:function(e){l&&n.setState({modelFile:[]})}},d={name:"file",multiple:!1,action:"/",accept:".ipynb",beforeUpload:function(e,t){return n.setState({notebookFile:t}),!1},fileList:c,onRemove:function(e){c&&n.setState({notebookFile:[]})}},f={name:"file",multiple:!1,action:"/",accept:".html",beforeUpload:function(e,t){return n.setState({resultFile:t}),!1},fileList:s,onRemove:function(e){l&&n.setState({resultFile:[]})}};return o.createElement(i.Modal,{title:e(g.default.uploadTitle),visible:r,onOk:n.handleOnUploadButton,okButtonProps:{disabled:a},okText:e(g.default.uploadConfirm),onCancel:n.handleOpenClose,confirmLoading:a},o.createElement(i.Spin,{spinning:a},o.createElement(i.Input,{defaultValue:n.state.newModelName,onChange:function(e){return n.setState({newModelName:e.target.value})},placeholder:"Name",required:!0}),o.createElement("br",null),o.createElement("br",null),o.createElement(w,d,o.createElement("p",{className:"ant-upload-hint"},e(g.default.uploadMessageNotebook))),o.createElement("br",null),o.createElement(w,u,o.createElement("p",{className:"ant-upload-hint"},e(g.default.uploadMessageModel))),o.createElement("br",null),o.createElement(w,f,o.createElement("p",{className:"ant-upload-hint"},e(g.default.uploadMessageResult)))))},n.state=M,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t={iconType:"settings",message:this.props.intl.formatMessage(g.default.empty)},n=[{key:"action",actions:function(t){return[{intlMessage:g.default.downloadBinary,callback:e.downloadBinary,disabled:!t.binary_uri},{intlMessage:g.default.downloadResult,callback:e.downloadResult,disabled:!t.html_notebook_result_uri},{intlMessage:g.default.downloadNotebook,callback:e.downloadNotebook,disabled:!t.notebook_uri},{intlMessage:g.default.previewResult,callback:e.previewResult,disabled:!t.notebook_uri},{intlMessage:"PAUSED"===t.status?g.default.statusLive:g.default.statusPaused,callback:e.togglePause,disabled:!1}]}}],a=[o.createElement(i.Button,{key:"create",type:"primary",onClick:function(){e.setState({isModalOpen:!0})}},o.createElement(l.FormattedMessage,g.default.newMlAlgorithmModel))],r=o.createElement("div",null,o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(l.FormattedMessage,g.default.mlAlgorithmModels)),o.createElement("span",{className:"mcs-card-button"},a)),o.createElement("hr",{className:"mcs-separator"})),s=this.state,c=s.isPreviewModalOpened,u=s.previewModalHtml;return o.createElement("div",{className:"ant-layout"},o.createElement(O,{className:"mcs-content-container"},this.renderModal(),o.createElement(_.default,{opened:c,html:u,onClose:this.onClosePreviewModal}),o.createElement(p.default,{fetchList:this.fetchMlAlgorithmModels,dataSource:this.state.data,loading:this.state.loading,total:this.state.total,columns:this.buildColumnDefinition().dataColumnsDefinition,actionsColumnsDefinition:n,pageSettings:f.PAGINATION_SEARCH_SETTINGS,emptyTable:t,additionnalComponent:r})))}}]),t}(o.Component);E([(0,d.lazyInject)(u.TYPES.IMlAlgorithmModelService)],P.prototype,"_mlAlgorithmModelService",void 0),E([(0,d.lazyInject)(u.TYPES.IDataFileService)],P.prototype,"_dataFileService",void 0),t.default=(0,c.compose)(s.withRouter,l.injectIntl,h.default)(P)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(6),s=c(n(1186)),l=c(n(1102));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.html,n=e.onClose,a=e.opened,i=e.intl;return r.createElement(o.Modal,{title:i.formatMessage(s.default.previewModalTitle),visible:a,onCancel:n,width:1280,footer:r.createElement(o.Button,{key:1,onClick:function(){return n()}},"Ok")},r.createElement(l.default,{content:t}))}}]),t}(r.Component);t.default=(0,i.injectIntl)(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MlFunctionsContent=void 0;var a,r=n(2662),o=(a=r)&&a.__esModule?a:{default:a};t.MlFunctionsContent=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(0),i=S(o),s=n(8),l=n(13),c=n(33),u=n(6),d=n(10),f=S(n(126)),p=n(30),m=S(n(2663)),g=n(44),y=S(n(23)),h=n(15),v=n(12),b=n(11),_=n(41);function S(e){return e&&e.__esModule?e:{default:e}}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=d.Layout.Content,w={loading:!1,data:[],total:0},M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.archiveMlFunction=function(e){return Promise.resolve()},n.fetchMlFunctions=function(e,t){n.setState({loading:!0},(function(){var a=Object.assign({},(0,g.getPaginatedApiParam)(t.currentPage,t.pageSize));n._mlFunctionService.listMlFunctions(e,a).then((function(e){var t=e.data.map((function(e){return new Promise((function(t,a){n._pluginService.getEngineVersion(e.version_id).then((function(e){return n._pluginService.getEngineProperties(e.id)})).then((function(e){return t(e)}))}))}));Promise.all(t).then((function(t){var a=e.data.map((function(e,n){return Object.assign(Object.assign({},e),{properties:t[n]})}));n.setState({loading:!1,data:a,total:e.total||e.count})}))})).catch((function(e){n.props.notifyError(e),n.setState({loading:!1})}))}))},n.onClickArchive=function(e){var t=n.props,a=t.location,r=a.search,o=a.state,s=a.pathname,l=t.history,c=t.match.params.organisationId,u=t.intl.formatMessage,f=n.state.data,g=(0,p.parseSearch)(r,p.PAGINATION_SEARCH_SETTINGS);d.Modal.confirm({icon:i.default.createElement(_.ExclamationCircleOutlined,null),title:u(m.default.mlFunctionArchiveTitle),content:u(m.default.mlFunctionArchiveMessage),okText:u(m.default.mlFunctionArchiveOk),cancelText:u(m.default.mlFunctionArchiveCancel),onOk:function(){n.archiveMlFunction(e.id).then((function(){if(1===f.length&&1!==g.currentPage){var e=Object.assign(Object.assign({},g),{currentPage:g.currentPage-1});return l.replace({pathname:s,search:(0,p.updateSearch)(r,e),state:o}),Promise.resolve()}return n.fetchMlFunctions(c,g)}))},onCancel:function(){}})},n.onClickEdit=function(e){var t=n.props,a=t.history,r=t.match.params.organisationId;a.push("/v2/o/"+r+"/settings/datamart/ml_functions/"+e.id+"/edit")},n.state=w,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.history,r=[{key:"action",actions:function(){return[{intlMessage:m.default.edit,callback:e.onClickEdit},{intlMessage:m.default.archive,callback:e.onClickArchive}]}}],o=[{intlMessage:m.default.name,key:"status",isHideable:!1,render:function(e,t){return i.default.createElement("span",{className:"mcs-campaigns-status-"+e.toLowerCase()},i.default.createElement(b.McsIcon,{type:"status"}))}},{intlMessage:m.default.name,key:"name",isHideable:!1,render:function(e,t){return i.default.createElement(c.Link,{className:"mcs-campaigns-link",to:"/v2/o/"+n+"/settings/datamart/ml_functions/"+t.id+"/edit"},e)}}],s={iconType:"settings",message:this.props.intl.formatMessage(m.default.empty)},l=[i.default.createElement(d.Button,{key:"create",type:"primary",onClick:function(){return a.push("/v2/o/"+n+"/settings/datamart/ml_functions/create")}},i.default.createElement(u.FormattedMessage,m.default.newMlFunction))],g=i.default.createElement("div",null,i.default.createElement("div",{className:"mcs-card-header mcs-card-title"},i.default.createElement("span",{className:"mcs-card-title"},i.default.createElement(u.FormattedMessage,m.default.mlFunction)),i.default.createElement("span",{className:"mcs-card-button"},l)),i.default.createElement("hr",{className:"mcs-separator"}));return i.default.createElement("div",{className:"ant-layout"},i.default.createElement(O,{className:"mcs-content-container"},i.default.createElement(f.default,{fetchList:this.fetchMlFunctions,dataSource:this.state.data,loading:this.state.loading,total:this.state.total,columns:o,actionsColumnsDefinition:r,pageSettings:p.PAGINATION_SEARCH_SETTINGS,emptyTable:s,additionnalComponent:g})))}}]),t}(o.Component);E([(0,h.lazyInject)(v.TYPES.IMlFunctionService)],M.prototype,"_mlFunctionService",void 0),E([(0,h.lazyInject)(v.TYPES.IPluginService)],M.prototype,"_pluginService",void 0),t.default=(0,s.compose)(l.withRouter,u.injectIntl,y.default)(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({mlFunction:{id:"settings.mlFunction.breadcrumb.title",defaultMessage:"Ml Function"},newMlFunction:{id:"settings.mlFunction.actionbar.button.new",defaultMessage:"New Ml Function"},empty:{id:"settings.mlFunction.list.empty",defaultMessage:"There is no Ml Function List created yet! Click on New to get started"},edit:{id:"settings.mlFunction.list.actionColumn.edit",defaultMessage:"Edit"},archive:{id:"settings.mlFunction.list.actionColumn.archive",defaultMessage:"Archive"},mlFunctionArchiveTitle:{id:"settings.mlFunction.modal.archive.title",defaultMessage:"Are you sure you want to archive this Ml Function?"},mlFunctionArchiveMessage:{id:"settings.mlFunction.modal.archive.message",defaultMessage:"By archiving this Ml Function it will stop any computation associated. Are you sure?"},mlFunctionArchiveOk:{id:"settings.mlFunction.modal.archive.ok",defaultMessage:"Archive Now"},mlFunctionArchiveCancel:{id:"settings.mlFunction.modal.archive.cancel",defaultMessage:"Cancel"},name:{id:"settings.mlFunction.list.column.name",defaultMessage:"Name"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(6),l=n(13),c=h(n(347)),u=n(65),d=h(n(1187)),f=h(n(2665)),p=h(n(23)),m=n(51),g=n(12),y=n(15);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=c.default,_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isObjectTypeAllowed=function(e){return["UserPoint"].includes(e)},n.fetchObjectTypes=function(e){return n.setState({loading:!0}),n._runtimeSchemaService.getRuntimeSchemas(e).then((function(t){var a=t.data.find((function(e){return"LIVE"===e.status}));return a?n._runtimeSchemaService.getObjectTypeInfoResources(e,a.id):[]})).then((function(e){return n.setState({objects:e.map((function(e){return e.name})).filter(n.isObjectTypeAllowed),loading:!1})})).catch((function(e){n.setState({loading:!1}),n.props.notifyError(e)}))},n.redirect=function(){var e=n.props,t=e.history,a="/v2/o/"+e.match.params.organisationId+"/settings/datamart/ml_functions";t.push(a)},n.renderSpecificFields=function(e,t){var a=n.state.objects;return o.createElement(f.default,{disabled:e,fieldNamePrefix:t,objects:a})},n.onSaveOrCreatePluginInstance=function(e,t){var a=n.props,r=a.match.params.organisationId;a.history.push("/v2/o/"+r+"/settings/datamart/ml_functions")},n.createPluginInstance=function(e,t,a){var r=n.state.datamartId?n.state.datamartId:a.datamart_id;return{version_id:a.version_id,version_value:a.version_value,artifact_id:t.artifact_id,group_id:t.group_id,organisation_id:e,name:a.name,datamart_id:r,field_name:a.field_name,field_type_name:a.field_type_name,hosting_object_type_name:a.hosting_object_type_name,query:a.query,expiration_period:"P1D",status:"INITIAL"}},n.onDatamartSelect=function(e){n.setState({datamartId:e.id})},n.state={objects:[],loading:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.state.datamartId;e&&this.fetchObjectTypes(e)}},{key:"componentDidUpdate",value:function(e,t){var n=this.state.datamartId;n&&n!==t.datamartId&&this.fetchObjectTypes(n)}},{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.match.params.mlFunctionId,a=this.state,r=a.loading,i=a.datamartId;return r?o.createElement(m.Loading,{isFullScreen:!1}):i||n?o.createElement(b,{pluginType:"ML_FUNCTION",listTitle:d.default.listTitle,listSubTitle:d.default.listSubTitle,breadcrumbPaths:function(e){return[{name:e?t(d.default.editBreadcrumb,{name:e.name}):t(d.default.createBreadcrumb)}]},pluginInstanceService:this._mlFunctionService,pluginInstanceId:n,createPluginInstance:this.createPluginInstance,onSaveOrCreatePluginInstance:this.onSaveOrCreatePluginInstance,onClose:this.redirect,renderSpecificFields:this.renderSpecificFields}):o.createElement(u.DatamartSelector,{onSelect:this.onDatamartSelect,actionbarProps:{paths:[{name:t(d.default.createBreadcrumb)}]}})}}]),t}(o.Component);v([(0,y.lazyInject)(g.TYPES.IMlFunctionService)],_.prototype,"_mlFunctionService",void 0),v([(0,y.lazyInject)(g.TYPES.IRuntimeSchemaService)],_.prototype,"_runtimeSchemaService",void 0),t.default=(0,i.compose)(l.withRouter,p.default,s.injectIntl)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(24),i=n(8),s=u(n(49)),l=n(6),c=u(n(1187));function u(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=function(e){function t(){return d(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage,a=e.disabled,i=e.fieldNamePrefix;return r.createElement("div",null,r.createElement(o.FormSelectField,{name:i+".hosting_object_type_name",component:o.DefaultSelect,validate:[t],options:this.props.objects.map((function(e){return{title:e,value:e}})),formItemProps:{label:n(c.default.labelHostingObjectType),required:!0},helpToolTipProps:{title:n(c.default.tootltipHostingObjectType)}}),r.createElement(o.FormInputField,{name:i+".field_type_name",component:o.FormInput,validate:[t],formItemProps:{label:n(c.default.labelFieldTypeName),required:!0},inputProps:{placeholder:n(c.default.labelFieldTypeName),disabled:a},helpToolTipProps:{title:n(c.default.tootltipFieldTypeName)}}),r.createElement(o.FormInputField,{name:i+".field_name",component:o.FormInput,validate:[t],formItemProps:{label:n(c.default.labelFieldName),required:!0},inputProps:{placeholder:n(c.default.labelFieldName),disabled:a},helpToolTipProps:{title:n(c.default.tootltipFieldName)}}),r.createElement(o.FormInputField,{name:i+".query",component:o.FormInput,validate:[t],formItemProps:{label:n(c.default.labelQuery),required:!0},inputProps:{placeholder:n(c.default.labelQuery),disabled:a},helpToolTipProps:{title:n(c.default.tootltipQuery)}}))}}]),t}(r.Component);t.default=(0,i.compose)(s.default,l.injectIntl)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=b(n(126)),l=b(n(350)),c=n(6),u=b(n(220)),d=n(30),f=n(44),p=n(12),m=n(13),g=n(15),y=n(8),h=n(65),v=b(n(23));function b(e){return e&&e.__esModule?e:{default:e}}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=i.Layout.Content,E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.authorizeEditActions=function(){var e=n.props.workspace.role;return!("EDITOR"===e||"READER"===e)},n.fetchCommunityId=function(e){return n._organisationService.getOrganisation(e).then((function(e){var t=e.data.community_id;return n.setState({communityId:t}),t}))},n.fetchProcessings=function(e,t){var a=n.props.notifyError,r=n.state.communityId;n.setState({loading:!0},(function(){(r?Promise.resolve(r):n.fetchCommunityId(e)).then((function(e){var a=Object.assign({},(0,f.getPaginatedApiParam)(t.currentPage,t.pageSize));return n._organisationService.getProcessings(e,a).then((function(e){return n.setState({loading:!1,data:e.data,total:e.total||e.count}),e}))})).catch((function(e){n.setState({loading:!1,data:[],total:0}),a(e)}))}))},n.hasRightToPerformActionsOnProcessing=function(){var e=n.props.workspace;return e.community_id===e.organisation_id||(n.setState({isVisibleCommunityModal:!0}),!1)},n.editProcessing=function(e){var t=n.props,a=t.history,r=t.match.params.organisationId;n.hasRightToPerformActionsOnProcessing()&&a.push("/v2/o/"+r+"/settings/organisation/processings/"+e.id+"/edit")},n.archiveProcessing=function(e){var t=n.props,a=t.match.params.organisationId,r=t.history,o=t.notifyError;n.hasRightToPerformActionsOnProcessing()&&n._organisationService.archiveProcessing(e.community_id,e.id).then((function(){r.push("/v2/o/"+a+"/settings/organisation/processings")})).catch((function(e){o(e)}))},n.deleteProcessing=function(e){n.hasRightToPerformActionsOnProcessing()&&n.setState({isVisibleDeleteModal:!0,processingIdToBeDeleted:e.id})},n.deleteProcessingConfirmed=function(){var e=n.props,t=e.match.params.organisationId,a=e.history,r=e.notifyError,o=n.state.processingIdToBeDeleted;o&&n._organisationService.deleteProcessing(t,o).then((function(){n.closeDeleteModal(),a.push("/v2/o/"+t+"/settings/organisation/processings")})).catch((function(e){n.closeDeleteModal(),r(e)}))},n.closeCommunityModal=function(){n.setState({isVisibleCommunityModal:!1})},n.closeDeleteModal=function(){n.setState({isVisibleDeleteModal:!1},(function(){n.setState({processingIdToBeDeleted:void 0})}))},n.onClickCommunityModal=function(){var e=n.props,t=e.history,a=e.workspace.community_id;n.setState({isVisibleCommunityModal:!1}),t.push("/v2/o/"+a+"/settings/organisation/processings")},n.state={loading:!0,data:[],total:0,isVisibleCommunityModal:!1,isVisibleDeleteModal:!1,processingIdToBeDeleted:void 0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.history,r=t.intl.formatMessage,f=this.state,p=f.isVisibleCommunityModal,m=f.isVisibleDeleteModal,g=f.processingIdToBeDeleted,y=this.authorizeEditActions(),h=[{intlMessage:l.default.id,key:"id",isHideable:!1},{intlMessage:l.default.name,key:"name",isHideable:!1},{intlMessage:l.default.purpose,key:"purpose",isHideable:!1},{intlMessage:l.default.legalBasis,key:"legal_basis",isHideable:!1},{intlMessage:l.default.technicalName,key:"technical_name",isHideable:!1},{intlMessage:l.default.token,key:"token",isHideable:!1}],v={iconType:"settings",message:r(l.default.emptyProcessings)},b=y?[{key:"action",actions:function(){return[{intlMessage:l.default.editProcessing,callback:e.editProcessing},{intlMessage:l.default.archiveProcessing,callback:e.archiveProcessing},{intlMessage:l.default.deleteProcessing,callback:e.deleteProcessing}]}}]:void 0,_=y?o.createElement("span",{className:"mcs-card-button"},o.createElement(i.Button,{key:"create",type:"primary",onClick:function(){e.hasRightToPerformActionsOnProcessing()&&a.push("/v2/o/"+n+"/settings/organisation/processings/create")}},o.createElement(c.FormattedMessage,l.default.newProcessing))):void 0,E=o.createElement("div",null,o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(c.FormattedMessage,u.default.processingActivities)),_),o.createElement("hr",{className:"mcs-separator"}));return o.createElement("div",{className:"ant-layout"},o.createElement(S,{className:"mcs-content-container"},o.createElement(s.default,{fetchList:this.fetchProcessings,dataSource:this.state.data,loading:this.state.loading,total:this.state.total,columns:h,actionsColumnsDefinition:b,pageSettings:d.PAGINATION_SEARCH_SETTINGS,emptyTable:v,additionnalComponent:E})),o.createElement(i.Modal,{visible:p,onOk:this.onClickCommunityModal,onCancel:this.closeCommunityModal},p&&r(l.default.communityModalMessage)),o.createElement(i.Modal,{visible:m,onOk:this.deleteProcessingConfirmed,onCancel:this.closeDeleteModal},r(l.default.deleteModalMessage)," ",g+"."))}}]),t}(o.Component);_([(0,g.lazyInject)(p.TYPES.IOrganisationService)],E.prototype,"_organisationService",void 0),t.default=(0,y.compose)(m.withRouter,h.injectWorkspace,c.injectIntl,v.default)(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(51),c=n(10),u=n(109),d=b(n(350)),f=n(2668),p=b(f),m=b(n(2671)),g=n(6),y=n(15),h=n(12),v=b(n(23));function b(e){return e&&e.__esModule?e:{default:e}}var _=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onClose=function(){var e=n.props,t=e.history,a=e.location,r="/v2/o/"+e.match.params.organisationId+"/settings/organisation/processings";return a.state&&a.state.from?t.push(a.state.from):t.push(r)},n.onLegalBasisSelect=function(e){n.setState({showLegalBasisSelector:!1,processingFormData:{legal_basis:e}})},n.save=function(e){var t=n.props,a=t.match.params,r=a.processingId,o=a.organisationId,i=t.notifyError;r?n.setState({loading:!0},(function(){n._organisationService.updateProcessing(r,e).then((function(e){n.setState({loading:!1}),n.onClose()})).catch((function(e){n.setState({loading:!1}),i(e)}))})):n.setState({loading:!0},(function(){n._organisationService.getOrganisation(o).then((function(t){var a=t.data.community_id;n._organisationService.createProcessing(a,e).then((function(e){n.setState({loading:!1}),n.onClose()})).catch((function(e){n.setState({loading:!1}),i(e)}))}))}))},n.close=function(){var e=n.props,t=e.history,a="/v2/o/"+e.match.params.organisationId+"/settings/organisation/processings";return t.push(a)},n.state={loading:!1,processingFormData:{},showLegalBasisSelector:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match.params.processingId,a=t.notifyError;n&&this.setState({loading:!0},(function(){e._organisationService.getProcessing(n).then((function(t){var n=t.data;e.setState({loading:!1,processingFormData:n,showLegalBasisSelector:!1})})).catch((function(t){e.setState({loading:!1,processingFormData:{},showLegalBasisSelector:!1}),a(t)}))}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.intl.formatMessage,a=t.match.params,r=a.organisationId,i=a.processingId,s=this.state,g=s.processingFormData,y=s.loading,h=s.showLegalBasisSelector;if(y)return o.createElement(l.Loading,{isFullScreen:!0});var v=g.id?n(d.default.editProcessing):n(d.default.newProcessing),b=[{name:n(d.default.processingActivities),path:"/v2/o/"+r+"/settings/organisation/processings"},{name:v}],_={formId:f.FORM_ID,paths:b,onClose:this.onClose},S=void 0===i?function(){e.setState({showLegalBasisSelector:!0})}:void 0;return h?o.createElement(c.Layout,{className:"edit-layout"},o.createElement(u.FormLayoutActionbar,_),o.createElement(m.default,{onSelect:this.onLegalBasisSelect})):o.createElement(p.default,{initialValues:g,onSubmit:this.save,close:this.close,breadCrumbPaths:b,goToLegalBasisSelector:S})}}]),t}(o.Component);_([(0,y.lazyInject)(h.TYPES.IOrganisationService)],S.prototype,"_organisationService",void 0),t.default=(0,i.compose)(s.withRouter,g.injectIntl,v.default)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(109),i=n(10),s=n(77),l=g(n(350)),c=n(35),u=n(6),d=n(13),f=n(8),p=g(n(2669)),m=g(n(2670));function g(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=i.Layout.Content,b=t.FORM_ID="processingForm",_=function(e){function t(){return y(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.breadCrumbPaths,a=e.close,c=e.goToLegalBasisSelector,u={formId:b,paths:n,message:l.default.saveProcessing,onClose:a},d=[];d.push({id:"legalBasis",title:l.default.legalBasisSectionTitle,component:r.createElement(p.default,null)}),d.push({id:"general",title:l.default.generalSectionTitle,component:r.createElement(m.default,null)});var f={items:d.map((function(e){return{sectionId:e.id,title:e.title,onClick:"legalBasis"===e.id?c:void 0}})),scrollId:b},g=d.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==d.length-1&&r.createElement("hr",null))}));return r.createElement(i.Layout,{className:"edit-layout"},r.createElement(o.FormLayoutActionbar,u),r.createElement(i.Layout,{className:"ant-layout-has-sider"},r.createElement(o.ScrollspySider,f),r.createElement(s.Form,{className:"edit-layout ant-layout",onSubmit:t},r.createElement("button",{type:"submit",style:{display:"none"}}),r.createElement(v,{id:b,className:"mcs-content-container mcs-form-container"},g))))}}]),t}(r.Component);t.default=(0,f.compose)(u.injectIntl,d.withRouter,(0,c.reduxForm)({form:b,enableReinitialize:!0}))(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=u(n(350)),s=n(24),l=u(n(49)),c=n(8);function u(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=function(e){function t(){return d(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage;return r.createElement("div",null,r.createElement(s.FormSection,{subtitle:i.default.legalBasisSectionSubTitle,title:i.default.legalBasisSectionTitle}),r.createElement(s.FormInputField,{name:"legal_basis",component:s.FormInput,validate:[t],formItemProps:{label:n(i.default.legalBasisSectionLegalBasisLabel),required:!0},inputProps:{placeholder:"CONSENT",disabled:!0},helpToolTipProps:{title:n(i.default.legalBasisSectionLegalBasisTooltip)}}))}}]),t}(r.Component);t.default=(0,c.compose)(o.injectIntl,l.default)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=f(n(49)),s=n(8),l=n(24),c=f(n(350)),u=n(11),d=n(13);function f(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){n.setState({displayAdvancedSection:!n.state.displayAdvancedSection})},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.processingId,n=e.fieldValidators.isRequired,a=e.intl.formatMessage,o=this.state.displayAdvancedSection,i=t?r.createElement(l.FormAlertInputField,{name:"token",component:l.FormAlertInput,formItemProps:{label:a(c.default.generalSectionTokenLabel),required:!0},inputProps:{placeholder:a(c.default.generalSectionTokenPlaceholder),disabled:!0},helpToolTipProps:{title:a(c.default.generalSectionTokenTooltip)},iconType:"warning",type:"warning",message:a(c.default.warningOnTokenEdition)}):void 0;return r.createElement("div",null,r.createElement(l.FormSection,{title:c.default.generalSectionTitle,subtitle:c.default.generalSectionSubTitle}),r.createElement(l.FormInputField,{name:"name",component:l.FormInput,validate:[n],formItemProps:{label:a(c.default.generalSectionNameLabel),required:!0},inputProps:{placeholder:a(c.default.generalSectionNamePlaceholder)},helpToolTipProps:{title:a(c.default.generalSectionNameTooltip)}}),r.createElement(l.FormTextAreaField,{name:"purpose",component:l.FormTextArea,validate:[n],formItemProps:{label:a(c.default.generalSectionPurposeLabel),required:!0},inputProps:{placeholder:a(c.default.generalSectionPurposePlaceholder)},helpToolTipProps:{title:a(c.default.generalSectionPurposeTooltip)}}),r.createElement("div",null,r.createElement(u.Button,{className:"optional-section-title  clickable-on-hover",onClick:this.toggleAdvancedSection},r.createElement(u.McsIcon,{type:"settings"}),r.createElement("span",{className:"step-title"},a(c.default.generalSectionAdvancedPartTitle)),r.createElement(u.McsIcon,{type:"chevron"})),r.createElement("div",{className:o?"optional-section-content":"hide-section"},r.createElement(l.FormInputField,{name:"technical_name",component:l.FormInput,formItemProps:{label:a(c.default.generalSectionTechnicalNameLabel)},inputProps:{placeholder:a(c.default.generalSectionTechnicalNamePlaceholder)},helpToolTipProps:{title:a(c.default.generalSectionTechnicalNameTooltip)}}),i)))}}]),t}(r.Component);t.default=(0,s.compose)(d.withRouter,o.injectIntl,i.default)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(8),l=n(67),c=n(25),u=n(10),d=n(24),f=n(350),p=(a=f)&&a.__esModule?a:{default:a},m=n(6),g=n(11);function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=u.Layout.Content,b=function(e){function t(){y(this,t);var e=h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.onSelect=function(t){return function(){e.props.onSelect(t)}},e.uppercaseFirstLetter=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props.intl.formatMessage,n=[{value:"CONSENT",subtitle:p.default.consentSubTitle},{value:"CONTRACTUAL_PERFORMANCE",subtitle:p.default.contractualPerformanceSubTitle},{value:"LEGAL_OBLIGATION",subtitle:p.default.legalObligationSubTitle},{value:"PUBLIC_INTEREST_OR_EXERCISE_OF_OFFICIAL_AUTHORITY",subtitle:p.default.publicInterestSubTitle},{value:"LEGITIMATE_INTEREST",subtitle:p.default.legitimateInterestSubTitle}];return o.createElement(u.Layout,null,o.createElement("div",{className:"edit-layout ant-layout"},o.createElement(u.Layout,null,o.createElement(v,{className:"mcs-content-container mcs-form-container text-center"},o.createElement(d.FormTitle,{title:p.default.legalBasisTitle,subtitle:p.default.legalBasisSubTitle}),o.createElement(u.Row,{className:"mcs-selector_container"},o.createElement(u.Row,{className:"menu"},n.map((function(n){var a=n.value,r=n.subtitle,i=e.uppercaseFirstLetter(a.toLowerCase().replace(/_/gi," "));return o.createElement(g.MenuList,{title:i,subtitles:[t(r)],key:a,select:e.onSelect(a)})}))))))))}}]),t}(o.Component);t.default=(0,s.compose)(i.withRouter,m.injectIntl,(0,c.connect)((function(e){return{workspace:(0,l.getWorkspace)(e)}}),void 0))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(8),l=O(n(220)),c=n(41),u=n(10),d=n(6),f=O(n(2673)),p=n(67),m=n(25),g=n(30),y=O(n(2674)),h=n(65),v=n(44),b=O(n(23)),_=O(n(139)),S=n(15),E=n(12);function O(e){return e&&e.__esModule?e:{default:e}}function w(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var M=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},P=u.Layout.Content,T=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleFilterChange=function(e){var t=n.props,a=t.location.search,r=t.datamart;n.setState({filter:e});var o=(0,g.parseSearch)(a,n.getSearchSetting());n.fetchCompartments(o.datamartId?o.datamartId:r.id,e)},n.fetchCompartments=function(e,t){var a=n.props.notifyError,r=Object.assign({},(0,v.getPaginatedApiParam)(t.currentPage,t.pageSize));return n._datamartService.getUserAccountCompartmentDatamartSelectionResources(e,r).then((function(e){n.setState({isFetchingCompartments:!1,compartments:e.data,totalCompartments:e.total||e.count,noCompartmentYet:0===e.total||0===e.count})})).catch((function(e){n.setState({isFetchingCompartments:!1}),a(e)}))},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,g.updateSearch)(o,e,n.getSearchSetting())};a.push(i)},n.onClick=function(){var e=n.props,t=e.history,a=e.match.params.organisationId;t.push("/v2/o/"+a+"/settings/datamart/compartments/create")},n.state={compartments:[],totalCompartments:0,isFetchingCompartments:!0,noCompartmentYet:!1,filter:{currentPage:1,pageSize:10,keywords:""}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.location.search,n=e.datamart,a=this.state.filter,r=(0,g.parseSearch)(t,this.getSearchSetting()),o=r.datamartId?r.datamartId:n.id;this.setState({isFetchingCompartments:!0}),this.fetchCompartments(o,a)}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,a=n.location.search,r=n.match.params.organisationId,o=n.datamart,i=e.location.search,s=e.match.params.organisationId,l=this.state.filter;if(s!==r||!(0,g.compareSearches)(a,i)){var c=_.default.parse(a).datamartId||o.id;this.setState({isFetchingCompartments:!0},(function(){t.fetchCompartments(c,l)}))}}},{key:"getSearchSetting",value:function(){return[].concat(w(g.KEYWORD_SEARCH_SETTINGS),w(g.DATAMART_SEARCH_SETTINGS))}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.location.search,r=t.workspace,i=this.state,s=i.isFetchingCompartments,p=i.totalCompartments,m=i.compartments,h=i.noCompartmentYet,v=i.filter,b=r(n).datamarts.map((function(e){return{key:e.id,value:e.name||e.token}})),_=[];if(b.length>1){var S=(0,g.parseSearch)(a,this.getSearchSetting()),E={displayElement:o.createElement("div",null,o.createElement(d.FormattedMessage,y.default.datamartFilter),o.createElement(c.DownOutlined,null)),selectedItems:S.datamartId?[b.find((function(e){return e.key===S.datamartId}))]:[b[0]],items:b,singleSelectOnly:!0,getKey:function(e){return e&&e.key?e.key:""},display:function(e){return e.value},handleItemClick:function(t){e.updateLocationSearch({datamartId:t&&t.key?t.key:void 0,currentPage:1})}};_.push(E)}var O=o.createElement(u.Button,{key:y.default.newCompartment.id,type:"primary",onClick:this.onClick},o.createElement(d.FormattedMessage,y.default.newCompartment));return o.createElement("div",{className:"ant-layout"},o.createElement(P,{className:"mcs-content-container"},o.createElement(u.Row,{className:"mcs-table-container"},o.createElement("div",null,o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(d.FormattedMessage,l.default.compartments)),o.createElement("span",{className:"mcs-card-button"},O)),o.createElement("hr",{className:"mcs-separator"}),o.createElement(f.default,{isFetchingCompartments:s,dataSource:m,totalCompartments:p,noCompartmentYet:h,onFilterChange:this.handleFilterChange,filter:v,filtersOptions:_})))))}}]),t}(o.Component);M([(0,S.lazyInject)(E.TYPES.IDatamartService)],T.prototype,"_datamartService",void 0);t.default=(0,s.compose)(d.injectIntl,h.injectDatamart,i.withRouter,b.default,(0,m.connect)((function(e){return{workspace:(0,p.getWorkspace)(e)}})))(T)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(6),l=n(8),c=n(68),u=n(1180),d=(a=u)&&a.__esModule?a:{default:a};function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){f(this,t);var e=p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.editCompartment=function(t){var n=e.props,a=n.match.params.organisationId,r=n.history,o="/v2/o/"+a+"/settings/datamart/"+t.datamart_id+"/compartments/"+t.id+"/edit";r.push({pathname:o})},e.voidFunction=function(e){},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.isFetchingCompartments,a=t.dataSource,r=t.totalCompartments,i=t.onFilterChange,s=t.filter,l=t.filtersOptions,u={current:s.currentPage,pageSize:s.pageSize,total:r,onChange:function(e,t){i({currentPage:e,pageSize:t})},onShowSizeChange:function(e,t){i({pageSize:t,currentPage:1})}},f=[{intlMessage:d.default.compartment_id,key:"compartment_id",isHideable:!1,render:function(e,t){return o.createElement("span",null,e," ",t.default&&" (Default)")}},{intlMessage:d.default.name,key:"name",isHideable:!1,render:function(e,t){return o.createElement("span",null,e)}},{intlMessage:d.default.token,key:"token",isHideable:!1,render:function(e,t){return o.createElement("span",null,e)}}],p=[{key:"action",actions:function(){return[{intlMessage:d.default.editCompartment,callback:e.editCompartment},{intlMessage:d.default.archiveCompartment,disabled:!0,callback:e.voidFunction},{intlMessage:d.default.deleteCompartment,disabled:!0,callback:e.voidFunction}]}}];return o.createElement(c.TableViewFilters,{columns:f,dataSource:a,loading:n,pagination:u,filtersOptions:l,actionsColumnsDefinition:p})}}]),t}(o.Component);t.default=(0,l.compose)(s.injectIntl,i.withRouter)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({datamartFilter:{id:"settings.datamart.compartments.list.datamartFilter",defaultMessage:"Datamart"},newCompartment:{id:"settings.datamart.compartments.new",defaultMessage:"New Compartment"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(10),l=n(6),c=n(13),u=E(n(139)),d=E(n(23)),f=E(n(200)),p=E(n(853)),m=n(2676),g=E(m),y=n(2678),h=n(65),v=n(51),b=n(15),_=n(12),S=n(159);function E(e){return e&&e.__esModule?e:{default:e}}function O(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var w=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.shouldWarnProcessings=function(e){var t=e.initialProcessingSelectionResources,n=e.processingActivities,a=t.map((function(e){return e.processing_id})),r=n.map((function(e){return e.model.id}));return void 0!==e.compartment.id&&!(a.length===r.length&&a.every((function(e){return r.includes(e)})))},n.checkProcessingsAndSave=function(e){var t=n.props.intl.formatMessage,a=n.shouldWarnProcessings(e),r=function(){n.save(e)};a?s.Modal.confirm({content:t(p.default.processingsWarningModalContent),okText:t(p.default.processingsWarningModalOk),cancelText:t(p.default.processingsWarningModalCancel),onOk:function(){return r()},onCancel:function(){}}):r()},n.save=function(e){var t=n.props,a=t.match.params.organisationId,r=t.notifyError,o=t.intl,i=s.message.loading(o.formatMessage(p.default.savingInProgress),0);return(e.compartment.id?n.updateCompartment(e):n.createCompartment(a,e)).then((function(t){return Promise.all((a=t.data,r=e.initialProcessingSelectionResources,o=e.processingActivities,i=r.map((function(e){return e.processing_id})),s=o.map((function(e){return e.model.id})),l=s.filter((function(e){return!i.includes(e)})),c=i.filter((function(e){return!s.includes(e)})),u=l.map((function(e){var t=o.find((function(t){return t.model.id===e}));if(t){var r=t.model,i={processing_id:r.id,processing_name:r.name};return n._datamartService.createProcessingSelectionForCompartment(a.datamart_id,a.id,i)}return Promise.resolve({})})),d=c.map((function(e){var t=r.find((function(t){return t.processing_id===e}));if(t){var o=t.id;return n._datamartService.deleteCompartmentProcessingSelection(a.datamart_id,a.id,o)}return Promise.resolve({})})),[].concat(O(u),O(d))));var a,r,o,i,s,l,c,u,d})).then((function(){i(),n.setState({loading:!1}),n.onClose()})).catch((function(e){i(),r(e),n.setState({loading:!1}),n.onClose()}))},n.updateCompartment=function(e){var t={token:e.compartment.token,name:e.compartment.name};return n._datamartService.updateUserAccountCompartment(e.compartment.compartment_id,t).then((function(t){var a={default:e.compartment.default};return n._datamartService.updateUserAccountCompartmentDatamartSelectionResource(e.compartment.datamart_id,e.compartment.id,a)}))},n.createCompartment=function(e,t){var a={organisation_id:e,token:t.compartment.token,name:t.compartment.name};return n._datamartService.createUserAccountCompartment(a).then((function(e){var a=e.data,r={datamart_id:t.compartment.datamart_id,compartment_id:a.id,default:t.compartment.default};return n._datamartService.createUserAccountCompartmentDatamartSelectionResource(t.compartment.datamart_id,r)}))},n.onClose=function(){var e=n.props,t=e.history,a=e.location,r="/v2/o/"+e.match.params.organisationId+"/settings/datamart/compartments";return a.state&&a.state.from?t.push(a.state.from):t.push(r)},n.onSelectDatamart=function(e){n.setState({selectedDatamartId:e.id,compartmentFormData:Object.assign(Object.assign({},y.INITIAL_COMPARTMENT_FORM_DATA),{compartment:{datamart_id:e.id}})})},n.goToDatamartSelector=function(){n.props.match.params.compartmentId||n.setState({selectedDatamartId:void 0})},n.getDatamartId=function(){var e=n.props.match.params.compartmentId,t=n.state,a=t.compartmentFormData,r=t.selectedDatamartId;return e?a.compartment.datamart_id:r},n.state={loading:!0,compartmentFormData:y.INITIAL_COMPARTMENT_FORM_DATA,selectedDatamartId:u.default.parse(e.location.search).selectedDatamartId||e.match.params.datamartId},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match.params,a=n.compartmentId,r=n.datamartId,o=t.location,i=t.notifyError,s=o.state&&o.state.compartmentId,l=a||s;if(l){var c=this._datamartService.getUserAccountCompartmentDatamartSelectionResource(r,l),u=this._datamartService.getProcessingSelectionsByCompartment(r,l).then((function(t){var n=t.data;return Promise.all(n.map((function(t){return e._organisationService.getProcessing(t.processing_id).then((function(e){var n=e.data;return{processingSelectionResource:t,processingResource:n}}))})))}));Promise.all([c,u]).then((function(e){return{compartment:e[0].data,initialProcessingSelectionResources:e[1].map((function(e){return e.processingSelectionResource})),processingActivities:e[1].map((function(e){return(0,S.createFieldArrayModel)(e.processingResource)}))}})).then((function(t){e.setState({loading:!1,compartmentFormData:t,selectedDatamartId:t.compartment.datamart_id?t.compartment.datamart_id:r})})).catch((function(t){e.setState({loading:!1}),i(t),e.onClose()}))}else this.setState({loading:!1})}},{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.intl.formatMessage,a=this.state,r=a.loading,i=a.compartmentFormData;if(r)return o.createElement(v.Loading,{isFullScreen:!0});var s=[{name:n(p.default.breadcrumbTitle),path:"/v2/o/"+t+"/settings/datamart/compartments"}],l={formId:m.FORM_ID,paths:s,onClose:this.onClose},c=this.getDatamartId(),u=i.compartment.id?i.initialProcessingSelectionResources:void 0;return c?o.createElement(g.default,{initialValues:i,onSubmit:this.checkProcessingsAndSave,close:this.onClose,breadCrumbPaths:s,datamartId:c,goToDatamartSelector:this.goToDatamartSelector,initialProcessingSelectionsForWarning:u}):o.createElement(f.default,{onSelect:this.onSelectDatamart,actionbarProps:l})}}]),t}(o.Component);w([(0,b.lazyInject)(_.TYPES.IDatamartService)],M.prototype,"_datamartService",void 0),w([(0,b.lazyInject)(_.TYPES.IOrganisationService)],M.prototype,"_organisationService",void 0),t.default=(0,i.compose)(c.withRouter,l.injectIntl,d.default,h.injectDatamart)(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(35),s=n(6),l=n(13),c=n(8),u=n(10),d=n(109),f=y(n(853)),p=y(n(2677)),m=n(73),g=y(n(420));function y(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=t.FORM_ID="compartmentForm",_=u.Layout.Content,S=i.FieldArray,E=function(e){function t(){return h(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.breadCrumbPaths,r=e.close,s=e.change,l=e.hasFeature,c=e.goToDatamartSelector,m=e.initialProcessingSelectionsForWarning,y={formChange:s,rerenderOnEveryChange:!0},h={formId:b,paths:n,message:f.default.saveCompartment,onClose:r},v=[];v.push({id:"general",title:f.default.sectionGeneralTitle,component:o.createElement(p.default,null)}),l("datamart-user_choices")&&v.push({id:"processingActivities",title:f.default.sectionProcessingActivitiesTitle,component:o.createElement(S,a({name:"processingActivities",component:g.default,initialProcessingSelectionsForWarning:m,processingsAssociatedType:"COMPARTMENT"},y))});var E={items:[{sectionId:"datamart",title:f.default.sectionDatamartTitle,onClick:c}].concat(v.map((function(e){return{sectionId:e.id,title:e.title,onClick:void 0}}))),scrollId:b},O=v.map((function(e,t){return o.createElement("div",{key:e.id},o.createElement("div",{key:e.id,id:e.id},e.component),t!==v.length-1&&o.createElement("hr",null))}));return o.createElement(u.Layout,{className:"edit-layout"},o.createElement(d.FormLayoutActionbar,h),o.createElement(u.Layout,{className:"ant-layout-has-sider"},o.createElement(d.ScrollspySider,E),o.createElement(i.Form,{className:"edit-layout ant-layout",onSubmit:t},o.createElement("button",{type:"submit",style:{display:"none"}}),o.createElement(_,{id:b,className:"mcs-content-container mcs-form-container"},O))))}}]),t}(o.Component);t.default=(0,c.compose)(s.injectIntl,m.injectFeatures,l.withRouter,(0,i.reduxForm)({form:b,enableReinitialize:!0}))(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(11),l=f(n(49)),c=n(8),u=f(n(853)),d=n(24);function f(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAdvancedSection=function(){var e=n.state.displayAdvancedSection;n.setState({displayAdvancedSection:!e})},n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage,r=this.state.displayAdvancedSection;return o.createElement("div",null,o.createElement(d.FormSection,{subtitle:u.default.sectionGeneralSubTitle,title:u.default.sectionGeneralTitle}),o.createElement(d.FormInputField,{name:"compartment.name",component:d.FormInput,validate:[t],formItemProps:{label:n(u.default.sectionGeneralNameLabel),required:!0},inputProps:{placeholder:n(u.default.sectionGeneralNamePlaceholder)},helpToolTipProps:{title:n(u.default.sectionGeneralNameTooltip)}}),o.createElement(d.FormAlertInputField,{name:"compartment.token",component:d.FormAlertInput,validate:[t],formItemProps:{label:n(u.default.sectionGeneralTokenLabel),required:!0},inputProps:{placeholder:n(u.default.sectionGeneralTokenPlaceholder)},helpToolTipProps:{title:n(u.default.sectionGeneralTokenTooltip)},iconType:"warning",type:"warning",message:n(u.default.warningOnTokenEdition)}),o.createElement("div",null,o.createElement(s.Button,{className:"optional-section-title",onClick:this.toggleAdvancedSection},o.createElement(s.McsIcon,{type:"settings"}),o.createElement("span",{className:"step-title"},n(u.default.sectionGeneralAdvancedTitle)),o.createElement(s.McsIcon,{type:"chevron"})),o.createElement("div",{className:r?"optional-section-content":"hide-section"},o.createElement(d.FormFieldWrapper,a({label:n(u.default.sectionGeneralDefaultLabel)},{helpToolTipProps:{title:n(u.default.sectionGeneralDefaultTooltip)}}),o.createElement(d.FormSwitchField,{name:"compartment.default",component:d.FormSwitch})))))}}]),t}(o.Component);t.default=(0,c.compose)(i.injectIntl,l.default)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INITIAL_COMPARTMENT_FORM_DATA={compartment:{},initialProcessingSelectionResources:[],processingActivities:[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(25),l=n(13),c=n(6),u=n(2680),d=n(206),f=M(n(23)),p=n(67),m=n(10),g=n(109),y=n(15),h=n(12),v=M(n(2681)),b=M(n(2682)),_=n(24),S=M(n(200)),E=n(54),O=n(11),w=n(73);function M(e){return e&&e.__esModule?e:{default:e}}var P=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},T=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},I=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.save=function(e){var t=n.props,a=t.notifyError,r=t.history,o=t.intl,i=t.location.state,s=t.match.params.datamartReplicationId,l=e.credentials_uri,c=e.type,u=T(e,["credentials_uri","type"]);if((0,E.isEmpty)(l)&&!s)switch(c){case"AZURE_EVENT_HUBS":return void a(new Error("A Connection String must be defined"),{intlDescription:d.messages.datamartReplicationEventHubsConnectionStringUriError});default:return void a(new Error("Credentials must be defined"),{intlDescription:d.messages.datamartReplicationPubSubCredentialsUriError})}var f=n.state.selectedType;n.setState({isLoading:!0});var p=m.message.loading(o.formatMessage(d.messages.savingInProgress),0),g=e.datamart_id||i&&i.datamartId;if(g){var y=Object.assign(Object.assign({},u),{datamart_id:g,type:f});(s?n._datamartReplicationService.updateDatamartReplication(g,s,y):n._datamartReplicationService.createDatamartReplication(g,y)).then((function(t){e.credentials_uri&&n._datamartReplicationService.uploadDatamartReplicationCredentials(g,t.data.id,e.credentials_uri).catch((function(e){e&&a(e),n.setState({isLoading:!1})}))})).then((function(){p(),r.push({pathname:n.getPreviousUrl(),state:{activeTab:"replications"}})})).catch((function(e){a(e),p(),n.setState({isLoading:!1})}))}},n.getPreviousUrl=function(){var e=n.props,t=e.match.params,a=t.organisationId,r=t.datamartId,o=e.location.state;return o&&o.datamartId?"/v2/o/"+a+"/settings/datamart/datamarts/"+o.datamartId:r?"/v2/o/"+a+"/settings/datamart/datamarts/"+r:"/v2/o/"+a+"/settings/datamart/datamarts"},n.onClose=function(){return n.props.history.push({pathname:n.getPreviousUrl(),state:{activeTab:"replications"}})},n.onSelectType=function(e){n.setState({selectedType:e})},n.renderReplicationCards=function(){for(var e=[],t=n.props.hasFeature,a=n.state.replicationTypes.filter((function(e){return"AZURE_EVENT_HUBS"!==e||t("datamartSettings-event_hubs_replication")})).map((function(e){return o.createElement(m.Col,{key:e,span:4},o.createElement(v.default,{type:e,onClick:n.onSelectType}))}));a.length>0;)e.push(a.splice(0,6));return e.map((function(e,t){return o.createElement(m.Row,{key:t,style:{marginTop:30,marginBottom:40},gutter:40},e)}))},n.onDatamartSelect=function(e){n.setState({datamartId:e.id})},n.state={isLoading:!1,datamartReplicationData:u.INITIAL_DATAMART_REPLICATION_FORM_DATA,replicationTypes:["GOOGLE_PUBSUB","AZURE_EVENT_HUBS"]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match.params,a=n.datamartId,r=n.datamartReplicationId,o=t.notifyError,i=t.location.state;r?(this.setState({isLoading:!0}),this._datamartReplicationService.getDatamartReplication(a,r).then((function(t){e.setState({datamartReplicationData:t.data,isLoading:!1,selectedType:t.data.type,datamartId:t.data.datamart_id})})).catch((function(t){o(t),e.setState({isLoading:!1})}))):i&&i.datamartId&&this.setState({datamartId:i.datamartId})}},{key:"render",value:function(){var e=this.props,t=e.match.params.datamartReplicationId,n=e.intl.formatMessage,a=this.state,r=a.isLoading,i=a.datamartReplicationData,s=a.selectedType,l=a.datamartId;if(r)return o.createElement(O.Loading,{isFullScreen:!0});var c=t&&i.name?i.name:n(d.messages.newDatamartReplication),u=[{name:n(d.messages.datamartReplications),path:this.getPreviousUrl(),state:{activeTab:"replications"}},{name:c}],f={formId:"datamartReplicationForm",paths:u,onClose:this.onClose};return l?s?o.createElement(b.default,{initialValues:i,onSubmit:this.save,close:this.onClose,breadCrumbPaths:u,type:s}):o.createElement(m.Layout,{className:"edit-layout"},o.createElement(g.FormLayoutActionbar,f),o.createElement(m.Layout,{className:"mcs-content-container ant-layout-content mcs-form-container"},o.createElement(_.FormTitle,{title:d.messages.datamartReplicationTypeSelectionTitle,subtitle:d.messages.datamartReplicationTypeSelectionSubtitle}),this.renderReplicationCards())):o.createElement(S.default,{onSelect:this.onDatamartSelect,isMainlayout:!0,actionbarProps:{paths:[{name:n(d.messages.datamartReplications),path:this.getPreviousUrl()}]}})}}]),t}(o.Component);P([(0,y.lazyInject)(h.TYPES.IDatamartReplicationService)],I.prototype,"_datamartReplicationService",void 0);t.default=(0,i.compose)(l.withRouter,c.injectIntl,w.injectFeatures,(0,s.connect)((function(e){return{workspace:(0,p.getWorkspace)(e)}})),f.default)(I)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INITIAL_DATAMART_REPLICATION_FORM_DATA={status:"PAUSED"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(13),s=n(6),l=n(11);var c=(0,s.defineMessages)({GOOGLE_PUBSUB:{id:"settings.datamart.datamartReplication.create.replicationType.googlePubSub",defaultMessage:"Google Pub/Sub"},AZURE_EVENT_HUBS:{id:"settings.datamart.datamartReplication.create.replicationType.azureEventHubs",defaultMessage:"Microsoft Azure Event Hubs"},selectButton:{id:"settings.datamart.datamartReplication.create.replicationType.selectButton",defaultMessage:"Select"},selectButtonTooltip:{id:"settings.datamart.datamartReplication.create.replicationType.selectButton.tooltip",defaultMessage:"Click here to select this replication type."}}),u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.showTooltip=function(){n.setState({isTooltipVisible:!0})},n.hideTooltip=function(){n.setState({isTooltipVisible:!1})},n.renderImage=function(e){switch(e){case"GOOGLE_PUBSUB":return r.createElement("img",{alt:"logo-google-pubsub",className:"replication-logo",src:"https://assets.mediarithmics.com/1/public/assets/1580747629223-sdjBhPFh/google-pubsub-logo.svg"});case"AZURE_EVENT_HUBS":return r.createElement("img",{alt:"logo-microsoft-azure-event-hubs",className:"replication-logo",src:"https://assets.mediarithmics.io/1/public/assets/1608210980698-rLbvZaLF/azure-event-hub.png"});default:return r.createElement("div",{className:"placeholder"})}},n.state={isTooltipVisible:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.type,a=t.intl.formatMessage,o=function(){e.props.onClick(n)};return r.createElement("div",{key:n,className:"replication-card",onClick:o},r.createElement(l.Card,{className:"replication-card hoverable",type:"flex"},r.createElement("div",{className:"image-placeholder"},this.renderImage(n)),r.createElement("div",{className:"replication-title"},a(c[n])),r.createElement("div",{className:"select-button"},r.createElement(l.Button,{className:"button",onClick:o,onMouseEnter:this.showTooltip,onMouseLeave:this.hideTooltip},a(c.selectButton)))))}}]),t}(r.Component);t.default=(0,o.compose)(i.withRouter,s.injectIntl)(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ID=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(35),i=n(8),s=n(10),l=n(6),c=g(n(60)),u=g(n(101)),d=g(n(206)),f=g(n(2683)),p=g(n(2684)),m=g(n(2685));function g(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=s.Layout.Content,b=t.FORM_ID="datamartReplicationForm",_=function(e){function t(){return y(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.breadCrumbPaths,a=e.close,i=e.type,l={formId:b,paths:n,message:d.default.saveDatamartReplication,onClose:a},g=[];g.push({id:"general",title:d.default.sectionGeneralTitle,component:r.createElement(f.default,null)}),"GOOGLE_PUBSUB"===i&&g.push({id:"custom",title:d.default.sectionCustomTitle,component:r.createElement(p.default,null)}),"AZURE_EVENT_HUBS"===i&&g.push({id:"custom",title:d.default.sectionCustomTitle,component:r.createElement(m.default,null)});var y={items:g.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:b},h=g.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==g.length-1&&r.createElement("hr",null))}));return r.createElement(s.Layout,{className:"edit-layout"},r.createElement(c.default,l),r.createElement(s.Layout,{className:"ant-layout-has-sider"},r.createElement(u.default,y),r.createElement(o.Form,{className:"edit-layout ant-layout",onSubmit:t},r.createElement("button",{type:"submit",style:{display:"none"}}),r.createElement(v,{id:b,className:"mcs-content-container mcs-form-container"},h))))}}]),t}(r.Component);t.default=(0,i.compose)(l.injectIntl,(0,o.reduxForm)({form:b,enableReinitialize:!0}))(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=d(n(206)),l=n(24),c=d(n(49)),u=d(n(63));function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage;return r.createElement("div",null,r.createElement(l.FormSection,{subtitle:s.default.sectionGeneralSubTitle,title:s.default.sectionGeneralTitle}),r.createElement(l.FormInputField,{name:"name",component:l.FormInput,validate:[t],formItemProps:{label:n(s.default.datamartReplicationNameLabel),required:!0},inputProps:{placeholder:n(s.default.datamartReplicationNamePlaceHolder)},helpToolTipProps:{title:n(s.default.datamartReplicationNameTooltip)}}))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,c.default,u.default)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=p(n(206)),l=n(24),c=p(n(49)),u=p(n(63)),d=n(833),f=n(13);function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.match.params.datamartReplicationId,a=e.intl.formatMessage;return r.createElement("div",null,r.createElement(l.FormSection,{subtitle:s.default.sectionCustomSubtitle,title:s.default.sectionCustomTitle}),r.createElement(d.FormDataFileField,{name:"credentials_uri",component:d.FormDataFile,validate:[t],disabled:!!n,formItemProps:{label:a(s.default.datamartReplicationPubSubCredentialsUriLabel),required:!0},helpToolTipProps:{title:a(s.default.datamartReplicationPubSubCredentialsUriTooltip)},buttonText:a(s.default.datamartReplicationPubSubCredentialsUriPlaceHolder),accept:"*"}),r.createElement(l.FormInputField,{name:"project_id",component:l.FormInput,validate:[t],formItemProps:{label:a(s.default.datamartReplicationPubSubProjectIdLabel),required:!0},inputProps:{placeholder:a(s.default.datamartReplicationPubSubProjectIdPlaceholder),disabled:!!n},helpToolTipProps:{title:a(s.default.datamartReplicationPubSubProjectIdTooltip)}}),r.createElement(l.FormInputField,{name:"topic_id",component:l.FormInput,validate:[t],formItemProps:{label:a(s.default.datamartReplicationPubSubTopicIdLabel),required:!0},inputProps:{placeholder:a(s.default.datamartReplicationPubSubTopicIdPlaceHolder),disabled:!!n},helpToolTipProps:{title:a(s.default.datamartReplicationPubSubTopicIdTooltip)}}))}}]),t}(r.Component);t.default=(0,o.compose)(f.withRouter,i.injectIntl,c.default,u.default)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=p(n(206)),l=n(24),c=p(n(49)),u=p(n(63)),d=n(833),f=n(13);function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.match.params.datamartReplicationId,a=e.intl.formatMessage;return r.createElement("div",null,r.createElement(l.FormSection,{subtitle:s.default.sectionCustomSubtitle,title:s.default.sectionCustomTitle}),r.createElement(d.FormDataFileField,{name:"credentials_uri",component:d.FormDataFile,validate:[t],disabled:!!n,formItemProps:{label:a(s.default.datamartReplicationEventHubsConnectionStringUriLabel),required:!0},helpToolTipProps:{title:a(s.default.datamartReplicationEventHubsConnectionStringUriTooltip)},buttonText:a(s.default.datamartReplicationEventHubsConnectionStringUriPlaceHolder),accept:"*"}),r.createElement(l.FormInputField,{name:"event_hub_name",component:l.FormInput,validate:[t],formItemProps:{label:a(s.default.datamartReplicationEventHubNameLabel),required:!0},inputProps:{placeholder:a(s.default.datamartReplicationEventHubNamePlaceholder),disabled:!!n},helpToolTipProps:{title:a(s.default.datamartReplicationEventHubNameTooltip)}}))}}]),t}(r.Component);t.default=(0,o.compose)(f.withRouter,i.injectIntl,c.default,u.default)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudiencePartitionsPage=t.AudiencePartitionsActionbar=t.AudiencePartitionsTable=void 0;var a=i(n(2687)),r=i(n(1188)),o=i(n(1189));function i(e){return e&&e.__esModule?e:{default:e}}t.AudiencePartitionsTable=r.default,t.AudiencePartitionsActionbar=o.default,t.AudiencePartitionsPage=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(25),l=n(8),c=n(13),u=n(6),d=n(51),f=E(n(23)),p=E(n(1188)),m=E(n(1189)),g=n(30),y=n(2688),h=n(44),v=n(15),b=n(12),_=n(67),S=n(11);function E(e){return e&&e.__esModule?e:{default:e}}var O=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},w=i.Layout.Content,M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.editPartition=function(e){var t=n.props,a=t.match.params.organisationId,r=t.history,o=t.location,i="/v2/o/"+a+"/settings/datamart/audience/partitions/"+e.id+"/edit";r.push({pathname:i,state:{from:""+o.pathname+o.search}})},n.updateLocationSearch=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i={pathname:r.pathname,search:(0,g.updateSearch)(o,e,y.PARTITIONS_SEARCH_SETTINGS)};a.push(i)},n.checkIfHasPartitions=function(e){return n._audiencePartitionsService.getPartitions(e,(0,h.getPaginatedApiParam)(1,1)).then((function(e){n.setState({hasAudiencePartitions:0!==e.count})}))},n.fetchPartitions=function(e,t,a){n.setState({fetchingPartitions:!0,initialFetching:a});var r={};t.currentPage&&t.pageSize&&(r=Object.assign(Object.assign({},r),(0,h.getPaginatedApiParam)(t.currentPage,t.pageSize))),t.keywords&&(r=Object.assign(Object.assign({},r),{keywords:t.keywords})),t.type&&t.type.length&&(r=Object.assign(Object.assign({},r),{type:t.type})),t.datamartId&&(r=Object.assign(Object.assign({},r),{datamart_id:t.datamartId})),r=Object.assign(Object.assign({},r),{archived:!1});var o=void 0;a?o=n._audiencePartitionsService.getPartitions(e,(0,h.getPaginatedApiParam)(1,1)).then((function(t){return 0!==t.total&&0!==t.count||n.setState({hasAudiencePartitions:!1}),n.setState({hasAudiencePartitions:!0}),n._audiencePartitionsService.getPartitions(e,r)})):(n.setState({hasAudiencePartitions:!0}),o=n._audiencePartitionsService.getPartitions(e,r)),o.then((function(e){n.setState({fetchingPartitions:!1,initialFetching:!1,audiencePartitions:e})})).catch((function(e){n.setState({fetchingPartitions:!1,initialFetching:!1,audiencePartitions:Object.assign(Object.assign({},e),{data:[]})}),n.props.notifyError(e)}))},n.state={audiencePartitions:void 0,fetchingPartitions:!1,initialFetching:!0,hasAudiencePartitions:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params,n=e.location,a=n.search,r=n.pathname,o=e.history;if((0,g.isSearchValid)(a,y.PARTITIONS_SEARCH_SETTINGS)){var i=(0,g.parseSearch)(a,y.PARTITIONS_SEARCH_SETTINGS);this.fetchPartitions(t.organisationId,i,!0)}else o.replace({pathname:r,search:(0,g.buildDefaultSearch)(a,y.PARTITIONS_SEARCH_SETTINGS),state:{reloadDataSource:!0}})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.match.params,a=t.location,r=a.search,o=a.pathname,i=t.history,s=e.match.params,l=e.location.search;if(!(0,g.compareSearches)(r,l)||n.organisationId!==s.organisationId)if((0,g.isSearchValid)(r,y.PARTITIONS_SEARCH_SETTINGS)){var c=(0,g.parseSearch)(r,y.PARTITIONS_SEARCH_SETTINGS);this.fetchPartitions(n.organisationId,c,n.organisationId!==s.organisationId)}else i.replace({pathname:o,search:(0,g.buildDefaultSearch)(r,y.PARTITIONS_SEARCH_SETTINGS),state:{reloadDataSource:!0}})}},{key:"render",value:function(){var e=this.props,t=e.match.params,n=e.location.search,a=e.workspace,r=e.intl,s=this.state,l=s.hasAudiencePartitions,c=s.initialFetching,u=s.fetchingPartitions,f=s.audiencePartitions,h=(0,g.parseSearch)(n,y.PARTITIONS_SEARCH_SETTINGS),v=o.createElement(w,{className:"mcs-content-container"},!c&&!l&&o.createElement(S.EmptyTableView,{iconType:"users",message:r.formatMessage(P.noPartitionYet)}),!c&&l&&o.createElement(p.default,{organisationId:t.organisationId,filter:h,audiencePartitions:f,fetchingPartitions:u,onChange:this.updateLocationSearch,onArchive:function(){},onEdit:this.editPartition,datamarts:a(t.organisationId).datamarts}));return o.createElement(i.Layout,null,o.createElement(m.default,null),c&&o.createElement(d.Loading,{isFullScreen:!0}),!c&&v)}}]),t}(o.Component);O([(0,v.lazyInject)(b.TYPES.IAudiencePartitionsService)],M.prototype,"_audiencePartitionsService",void 0);t.default=(0,l.compose)(c.withRouter,u.injectIntl,f.default,(0,s.connect)((function(e){return{workspace:(0,_.getWorkspace)(e)}})))(M);var P=(0,u.defineMessages)({noPartitionYet:{id:"audience.partitions.empty.get-started",defaultMessage:"There is no Partitions created yet! Click on New to get started"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PARTITIONS_SEARCH_SETTINGS=void 0;var a=n(30);function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.PARTITIONS_SEARCH_SETTINGS=[].concat(r(a.PAGINATION_SEARCH_SETTINGS),r(a.KEYWORD_SEARCH_SETTINGS),r(a.DATAMART_SEARCH_SETTINGS),[{paramName:"type",defaultValue:[],deserialize:function(e){return e.type?e.type.split(","):[]},serialize:function(e){return e.join(",")},isValid:function(e){return!e.type||e.type.split(",").length>0}}])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(10),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(6),l=n(13),c=n(8),u=n(11),d=S(n(335)),f=S(n(78)),p=S(n(81)),m=n(56),g=n(83),y=n(65),h=S(n(23)),v=S(n(2690)),b=n(12),_=n(15);function S(e){return e&&e.__esModule?e:{default:e}}var E=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},O=o.Layout.Content,w=(0,s.defineMessages)({partNumber:{id:"partition.dashboard.partNumber",defaultMessage:"Partition number"},users:{id:"partition.dashboard.users",defaultMessage:"Users"},percentage:{id:"partition.dashboard.percentage",defaultMessage:"Percentage"},overview:{id:"partition.dashboard.overview",defaultMessage:"Overview"},partitionPublished:{id:"partition.dashboard.partitionPublished",defaultMessage:"Partition Published"},publishModalTitle:{id:"partition.dashboard.publish.modal.title",defaultMessage:"Are you sure you want to publish this partition ?"},publishModalMessage:{id:"partition.dashboard.publish.modal.message",defaultMessage:"Once published it will assign every new UserPoint to a partition. This action cannot be undone."},publishModalCancel:{id:"partition.dashboard.publish.modal.cancel.button",defaultMessage:"Cancel"},publishModalOk:{id:"partition.dashboard.publish.modal.ok.button",defaultMessage:"Ok"},datamartNotFoundError:{id:"partition.dashboard.err",defaultMessage:"The datamart related to this partition is no longer a datamart of this organisation."}}),M=d.default,P=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.loadData=function(e){var t=n.props,a=t.workspace,r=t.match.params.organisationId,o=t.intl;n.setState({isLoading:!0,isLoadingStats:!0}),n._audiencePartitionsService.getPartition(e).then((function(t){var i=a.datamarts.find((function(e){return e.id===t.data.datamart_id})),s=[n._audienceSegmentService.getSegments(r,{audience_partition_id:e,type:["USER_PARTITION"],max_results:500}),f.default.getAudienceSegmentReport(r,new p.default("now"),new p.default("now"),["audience_segment_id"],["user_points"])],l=i?s.concat(n.fetchTotalUsers(i)):[Promise.reject(o.formatMessage(w.datamartNotFoundError))];return Promise.all(l).then((function(e){var a=(0,m.normalizeReportView)(e[1].data.report_view);n.setState({isLoading:!1,audiencePartition:t.data,userPartitionSegments:e[0].data,isLoadingStats:!1,totalUserPoint:e[2]?e[2]:0,statBySegmentId:(0,g.normalizeArrayOfObject)(a,"audience_segment_id")})})).catch((function(e){return Promise.reject(e)}))})).catch((function(e){n.props.notifyError(e,{description:e}),n.setState({isLoading:!1,isLoadingStats:!1})}))},n.fetchTotalUsers=function(e){switch(e.storage_model_version){case"v201709":return n._queryService.runOTQLQuery(e.id,"select @count {} from UserPoint").then((function(e){return e.data?e.data.rows[0].count:0}));case"v201506":return n._queryService.runSelectorQLQuery(e.id).then((function(e){return e.data.total}));default:return Promise.resolve(0)}},n.publishPartition=function(){var e=n.props,t=e.match.params.partitionId,a=e.intl,r=n.state.audiencePartition;n.setState({isLoading:!0});var i=Object.assign(Object.assign({},r),{status:"PUBLISHED"});n._audiencePartitionsService.publishPartition(t,i).then((function(e){n.loadData(t),o.message.success(a.formatMessage(w.partitionPublished))}))},n.buildColumnDefinition=function(){var e=n.state,t=e.isLoadingStats,a=e.statBySegmentId,r=e.totalUserPoint;return[{intlMessage:w.partNumber,key:"part_number",isHideable:!1,render:function(e,t){return t.part_number}},{intlMessage:w.users,key:"users",isHideable:!1,render:function(e,n){if(t)return i.createElement("i",{className:"mcs-table-cell-loading"});var r=a[n.id];return r?r.user_points:"-"}},{intlMessage:w.percentage,key:"percentage",isHideable:!1,render:function(e,n){if(t)return i.createElement("i",{className:"mcs-table-cell-loading"});var o=a[n.id];if(o&&r){var s=o.user_points/r*100;return isNaN(s)?"-":s.toFixed(2)+" %"}return"-"}}]},n.displayHidePublishModal=function(){var e=n.props.intl;o.Modal.confirm({title:e.formatMessage(w.publishModalTitle),content:e.formatMessage(w.publishModalMessage),onOk:n.publishPartition,cancelText:e.formatMessage(w.publishModalCancel)})},n.state={audiencePartition:void 0,userPartitionSegments:[],isLoading:!1,isLoadingStats:!1,totalUserPoint:0,statBySegmentId:{}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params.partitionId;this.loadData(e)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.history,a=t.match.params,r=a.partitionId,o=a.organisationId,i=e.match.params.partitionId,s=this.state.audiencePartition;s&&s.organisation_id&&s.organisation_id!==o&&n.push("/v2/o/"+o+"/settings/datamart/audience/partitions"),i!==r&&this.loadData(r)}},{key:"render",value:function(){var e=this.props.intl,t=this.state,n=t.isLoading,a=t.audiencePartition,r=t.userPartitionSegments,o=a?a.name:"";return i.createElement("div",{className:"ant-layout"},i.createElement(v.default,{partition:this.state.audiencePartition,publishPartition:this.displayHidePublishModal}),i.createElement("div",{className:"ant-layout"},i.createElement(O,{className:"mcs-content-container"},i.createElement(u.ContentHeader,{title:o,loading:n}),i.createElement(u.Card,{title:e.formatMessage(w.overview)},i.createElement("hr",null),i.createElement(M,{dataSource:r,columns:this.buildColumnDefinition(),loading:n})))))}}]),t}(i.Component);E([(0,_.lazyInject)(b.TYPES.IAudiencePartitionsService)],P.prototype,"_audiencePartitionsService",void 0),E([(0,_.lazyInject)(b.TYPES.IAudienceSegmentService)],P.prototype,"_audienceSegmentService",void 0),E([(0,_.lazyInject)(b.TYPES.IQueryService)],P.prototype,"_queryService",void 0),t.default=(0,c.compose)(l.withRouter,s.injectIntl,y.injectWorkspace,h.default)(P)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(33),s=n(8),l=n(11),c=n(6),u=n(13);function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=(0,c.defineMessages)({edit:{id:"audience.partitions.dashboard.actionbar.edit",defaultMessage:"Edit Partition"},publish:{id:"audience.partitions.dashboard.actionbar.publish",defaultMessage:"Publish"},partitions:{id:"audience.partitions.dashboard.actionbar.breadcrumb",defaultMessage:"Partitions"},partitionOverview:{id:"audience.partitions.dashboard.actionbar.breadcrumb.default",defaultMessage:"Partion Overview"}}),m=function(e){function t(){return d(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.intl,a=e.partition,s=e.publishPartition,u=a&&a.name?a.name:n.formatMessage(p.partitionOverview),d=[{name:n.formatMessage(p.partitions),path:"/v2/o/"+t+"/settings/datamart/audience/partitions"},{name:u}];return r.createElement(l.Actionbar,{paths:d},a&&"PUBLISHED"!==a.status&&r.createElement(o.Button,{className:"mcs-primary",type:"primary",onClick:s},r.createElement(l.McsIcon,{type:"bolt"})," ",r.createElement(c.FormattedMessage,p.publish)),r.createElement(i.Link,{to:a?"/v2/o/"+t+"/settings/datamart/audience/partitions/"+a.id+"/edit":""},r.createElement(o.Button,{className:"mcs-primary"},r.createElement(l.McsIcon,{type:"pen"})," ",r.createElement(c.FormattedMessage,p.edit))))}}]),t}(r.Component);t.default=(0,s.compose)(c.injectIntl,u.withRouter)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(10),l=v(n(2692)),c=n(6),u=n(13),d=n(51),f=n(2694),p=n(65),m=v(n(23)),g=v(n(200)),y=n(12),h=n(15);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=(0,c.defineMessages)({editPartition:{id:"edit.partition.form.button.save",defaultMessage:"Edit Partition"},partition:{id:"edit.partition.form.default.name.partition",defaultMessage:"partition"},newPartition:{id:"edit.partition.form.button.new.partition.",defaultMessage:"New Partition"},partitions:{id:"edit.partition.form.breadcrumb.partitions",defaultMessage:"Partitions"},partitionSaved:{id:"edit.partition.form.save.success",defaultMessage:"Partition successfully saved."}}),S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.save=function(e){var t=n.props,a=t.match.params,r=a.partitionId,o=a.organisationId,i=t.history,l=t.location,c=t.intl,u=t.workspace,d=n.state.selectedDatamart;if(n.setState({isLoading:!0}),e.type="AUDIENCE_PARTITION",r)n._audiencePartitionsService.savePartition(r,e).then((function(){n.redirect(),s.message.success(c.formatMessage(_.partitionSaved)),n.setState({isLoading:!1})})).catch((function(e){n.props.notifyError(e),n.setState({isLoading:!1})}));else{var f=d?d.id:u.datamarts[0].id;n._audiencePartitionsService.createPartition(o,f,e).then((function(e){var t="/v2/o/"+o+"/settings/datamart/audience/partitions/"+e.data.id;l.pathname?i.push({pathname:t,state:{from:""+l.pathname}}):i.push(t),s.message.success(c.formatMessage(_.partitionSaved)),n.setState({isLoading:!1})})).catch((function(e){n.props.notifyError(e),n.setState({isLoading:!1})}))}},n.redirect=function(){var e=n.props,t=e.history,a=e.match.params,r=a.organisationId,o=a.partitionId,i=e.location,s="/v2/o/"+r+"/settings/datamart/audience/partitions"+(o?"/"+o:"");return i.state&&i.state.from?t.push(i.state.from):t.push(s)},n.onDatamartSelect=function(e){n.setState({selectedDatamart:e})},n.state={isLoading:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.partitionId;t?this._audiencePartitionsService.getPartition(t).then((function(e){return e.data})).then((function(t){e.setState({partitionFormData:t,isLoading:!1})})):this.setState({partitionFormData:f.INITIAL_AUDIENCE_PARTITION_FORM_DATA,isLoading:!1})}},{key:"render",value:function(){var e=this.props,t=e.intl,n=e.match.params,a=n.partitionId,r=n.organisationId,i=e.workspace,s=this.state,c=s.partitionFormData,u=s.isLoading,f=s.selectedDatamart;if(u)return o.createElement(d.Loading,{isFullScreen:!0});var p=[{name:t.formatMessage(_.partitions),path:"/v2/o/"+r+"/settings/datamart/audience/partitions"}],m={onClose:this.redirect,formId:"audienceSegmentForm",paths:p};return a||1===i.datamarts.length||f?o.createElement(l.default,{initialValues:c,onSubmit:this.save,close:this.redirect,breadCrumbPaths:p}):o.createElement(g.default,{onSelect:this.onDatamartSelect,actionbarProps:m})}}]),t}(o.Component);b([(0,h.lazyInject)(y.TYPES.IAudiencePartitionsService)],S.prototype,"_audiencePartitionsService",void 0),t.default=(0,i.compose)(c.injectIntl,u.withRouter,p.injectWorkspace,m.default)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(35),s=n(6),l=n(8),c=f(n(60)),u=f(n(101)),d=f(n(2693));function f(e){return e&&e.__esModule?e:{default:e}}function p(e){if(null==e)throw new TypeError("Cannot destructure undefined")}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=o.Layout.Content,h="partitionForm",v=(0,s.defineMessages)({savePartition:{id:"edit.partition.form.save.button",defaultMessage:"Save"},sectionTitleGeneral:{id:"edit.partition.form.sectionTitleGeneral",defaultMessage:"General Information"}}),b=function(e){function t(){m(this,t);var e=g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.buildFormSections=function(){p(e.props);var t=[],n={id:"general",title:v.sectionTitleGeneral,component:r.createElement(d.default,{initialValues:e.props.initialValues})};return t.push(n),t},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.breadCrumbPaths,n=e.handleSubmit,a=e.close,s={formId:h,paths:t,message:v.savePartition,onClose:a},l=this.buildFormSections(),d={items:l.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:h},f=l.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==l.length-1&&r.createElement("hr",null))}));return r.createElement(o.Layout,{className:"edit-layout"},r.createElement(c.default,s),r.createElement(o.Layout,{className:"ant-layout-has-sider"},r.createElement(u.default,d),r.createElement(i.Form,{className:"edit-layout ant-layout",onSubmit:n},r.createElement(y,{id:h,className:"mcs-content-container mcs-form-container"},r.createElement("div",{className:"ad-group-form"},f)))))}}]),t}(r.Component);t.default=(0,l.compose)((0,i.reduxForm)({form:h,enableReinitialize:!0}))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=p(n(139)),l=p(n(49)),c=p(n(63)),u=n(24),d=p(n(333)),f=n(13);function p(e){return e&&e.__esModule?e:{default:e}}var m=(0,i.defineMessages)({sectionSubtitleGeneral:{id:"edit.partition.form.general.subtitle",defaultMessage:"Configure your partition, give it a name and select your model."},sectionTitleGeneral:{id:"edit.partition.form.general.title",defaultMessage:"General Information"},labelPartitionName:{id:"edit.partition.general.infos.label.name",defaultMessage:"Partition Name"},labelPartitionType:{id:"edit.partition.general.infos.label.type",defaultMessage:"Type"},labelPartCount:{id:"edit.partition.general.infos.label.partCount",defaultMessage:"Part Count"},labelClusteringModel:{id:"edit.partition.general.infos.label.clusteringModel",defaultMessage:"Clustering Model"},tootltipPartitionName:{id:"edit.partition.general.infos.tooltip.name",defaultMessage:"The partition's name will help you identify it on the different screens."},tootltipPartitionType:{id:"edit.partition.general.infos.tooltip.type",defaultMessage:"The random type will assign randomly at the userpoint creation a userpoint to a partition. The clustering mode let's you define the clustering model."},tootltipPartitionPartCount:{id:"edit.partition.general.infos.tooltip.partCount",defaultMessage:"The number of partition part you wish to create."},tootltipPartitionClusteringModel:{id:"edit.partition.general.infos.tooltip.clustering.model",defaultMessage:"A link to your model."}}),g=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators,n=t.isRequired,a=t.isValidInteger,o=e.intl.formatMessage,i=e.location.search,l=s.default.parse(i),c=this.props.initialValues&&"PUBLISHED"===this.props.initialValues.status;return r.createElement("div",null,r.createElement(u.FormSection,{subtitle:m.sectionSubtitleGeneral,title:m.sectionTitleGeneral}),r.createElement(u.FormInputField,{name:"name",component:u.FormInput,validate:[n],formItemProps:{label:o(m.labelPartitionName),required:!0},inputProps:{placeholder:o(m.labelPartitionName),disabled:c},helpToolTipProps:{title:o(m.tootltipPartitionName)}}),r.createElement(u.FormSelectField,{name:"audience_partition_type",component:d.default,validate:[n],formItemProps:{label:o(m.labelPartitionType),required:!0},helpToolTipProps:{title:o(m.tootltipPartitionType)},options:[{title:l.type,value:l.type}],disabled:!0}),r.createElement(u.FormInputField,{name:"part_count",component:u.FormInput,validate:[n,a],formItemProps:{label:o(m.labelPartCount),required:!0},inputProps:{placeholder:o(m.labelPartCount),disabled:c},helpToolTipProps:{title:o(m.tootltipPartitionPartCount)}}),"CLUSTERING"===l.type&&r.createElement(u.FormInputField,{name:"clustering_model_data_file_uri",component:u.FormInput,validate:[n],formItemProps:{label:o(m.labelClusteringModel),required:!0},inputProps:{placeholder:o(m.labelClusteringModel),disabled:c},helpToolTipProps:{title:o(m.tootltipPartitionClusteringModel)}}))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,l.default,c.default,f.withRouter)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INITIAL_AUDIENCE_PARTITION_FORM_DATA={name:"",clustering_model_data_file_uri:""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(6),l=n(8),c=n(11),u=_(n(2696)),d=_(n(2698)),f=n(30),p=n(2699),m=n(25),g=_(n(23)),y=n(44),h=n(15),v=n(12),b=n(67);function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.refreshCleaningRule=function(){var e=n.state.filter;n.fetchCleaningRules(e)},n.getCleaningRulesFilterFromSearch=function(e){var t=n.props,a=t.workspace,r=t.match.params.organisationId,o=(0,f.parseSearch)(e,n.getSearchSettings());return{currentPage:o.currentPage?o.currentPage:1,pageSize:o.pageSize?o.pageSize:10,type:o.type?o.type:n.getCleaningRuleTypeItems()[0].cleaningRuleType,datamartId:o.datamartId?o.datamartId:a(r).datamarts[0].id}},n.onFilterChange=function(e){var t=n.props,a=t.history,r=t.location,o=r.search,i=r.pathname,s=n.state.filter,l=Object.assign(Object.assign({},s),e),c={pathname:i,search:(0,f.updateSearch)(o,l,n.getSearchSettings())};a.push(c)},n.getCleaningRuleTypeItems=function(){var e=n.props.intl;return[{title:e.formatMessage(d.default.EventBasedCleaningRulesTabTitle),cleaningRuleType:"USER_EVENT_CLEANING_RULE"},{title:e.formatMessage(d.default.ProfileBasedCleaningRulesTabTitle),cleaningRuleType:"USER_PROFILE_CLEANING_RULE"}]},n.fetchCleaningRules=function(e){var t=n.props.notifyError;n.setState({isFetchingCleaningRules:!0,filter:e},(function(){var a=Object.assign(Object.assign({},(0,y.getPaginatedApiParam)(e.currentPage,e.pageSize)),{type:e.type});n._datamartService.getCleaningRules(e.datamartId,a).then((function(a){var r=a.data.map((function(t){return"USER_EVENT_CLEANING_RULE"===e.type?n._datamartService.getContentFilter(e.datamartId,t.id).then((function(e){var n=e.data;return Object.assign(Object.assign({},t),n)})).catch((function(e){return Promise.resolve(t)})):Promise.resolve(t)}));Promise.all(r).then((function(e){n.setState({isFetchingCleaningRules:!1,cleaningRules:e,totalCleaningRules:a.total||a.count})})).catch((function(e){t(e),n.setState({isFetchingCleaningRules:!1})}))}))}))},n.onChangeCleaningRuleType=function(e){n.onFilterChange({type:e})};var a=n.props.location.search;return n.state={filter:n.getCleaningRulesFilterFromSearch(a),cleaningRules:[],totalCleaningRules:0,isFetchingCleaningRules:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){this.refreshCleaningRule()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.location,a=n.pathname,r=n.search,o=t.match.params.organisationId,i=t.history,s=e.location.search,l=e.match.params.organisationId;if(!(0,f.compareSearches)(r,s)||o!==l)if((0,f.isSearchValid)(r,p.CLEANING_RULES_SEARCH_SETTINGS)){var c=this.getCleaningRulesFilterFromSearch(r);this.fetchCleaningRules(c)}else i.replace({pathname:a,search:(0,f.buildDefaultSearch)(r,p.CLEANING_RULES_SEARCH_SETTINGS)})}},{key:"getSearchSettings",value:function(){return[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(p.CLEANING_RULES_SEARCH_SETTINGS))}},{key:"render",value:function(){var e=this,t=this.state,n=t.filter,a=t.cleaningRules,r=t.totalCleaningRules,i=t.isFetchingCleaningRules,s=n.type,l=this.getCleaningRuleTypeItems().map((function(t){return{title:t.title,display:o.createElement(u.default,{filter:n,cleaningRules:a,total:r,isFetchingCleaningRules:i,onFilterChange:e.onFilterChange,onCleaningRuleUpdate:e.refreshCleaningRule}),key:t.cleaningRuleType}}));return o.createElement("div",{className:"ant-layout"},o.createElement("div",{className:"ant-layout-content"},o.createElement(c.McsTabs,{items:l,activeKey:s,onChange:this.onChangeCleaningRuleType})))}}]),t}(o.Component);S([(0,h.lazyInject)(v.TYPES.IDatamartService)],E.prototype,"_datamartService",void 0);t.default=(0,l.compose)(i.withRouter,s.injectIntl,g.default,(0,m.connect)((function(e){return{workspace:(0,b.getWorkspace)(e)}})))(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=n(13),l=n(6),c=n(11),u=n(68),d=O(n(2697)),f=n(1190),p=n(41),m=n(10);n(1191);var g=O(n(23)),y=n(25),h=n(67),v=n(15),b=n(12),_=n(33),S=O(n(17)),E=n(51);function O(e){return e&&e.__esModule?e:{default:e}}var w=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=m.Layout.Content,P=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.getDatamartItemsFromOrganisationId=function(e){return(0,n.props.workspace)(e).datamarts.map((function(e){return{key:e.id,value:e.name||e.token}}))},n.onEditCleaningRule=function(e){var t=n.props,a=t.match.params.organisationId,r=t.location,o=t.history,i="USER_EVENT_CLEANING_RULE"===t.filter.type?"user_event":"user_profile";o.push({pathname:"/v2/o/"+a+"/settings/datamart/"+e.datamart_id+"/cleaning_rules/"+i+"/"+e.id+"/edit",state:{from:""+r.pathname+r.search}})},n.onDeleteCleaningRule=function(e){var t=n.props,a=t.intl.formatMessage,r=t.notifyError,i=t.onCleaningRuleUpdate;m.Modal.confirm({icon:o.createElement(p.ExclamationCircleOutlined,null),title:a(d.default.deleteCleaningRuleModalTitle),okText:a(d.default.deleteCleaningRuleModalOk),cancelText:a(d.default.deleteCleaningRuleModalCancel),onOk:function(){n._datamartService.deleteCleaningRule(e.datamart_id,e.id).then((function(){i()})).catch((function(e){r(e)}))},onCancel:function(){}})},n.buildNewActionElement=function(e){var t="/v2/o/"+e+"/settings/datamart/cleaning_rules/"+("USER_EVENT_CLEANING_RULE"===n.props.filter.type?"user_event":"user_profile")+"/create";return o.createElement(_.Link,{key:d.default.newCleaningRule.id,to:t},o.createElement(m.Button,{key:d.default.newCleaningRule.id,type:"primary"},o.createElement(l.FormattedMessage,d.default.newCleaningRule)))},n.renderModal=function(e){var t=n.props,a=t.intl.formatMessage,r=t.onCleaningRuleUpdate,i=t.notifyError,s=n.getUpdateStatusModalText(e.status);m.Modal.confirm({icon:o.createElement(p.ExclamationCircleOutlined,null),title:a(d.default.updateStatusModalTitle),content:s,okText:a(d.default.updateStatusModalConfirm),cancelText:a(d.default.updateCleaningRuleModalCancel),onOk:function(){n.setState({isLoading:!0}),e.status=(0,f.getNextCleaningRuleStatus)(e.status),n._datamartService.updateCleaningRule(e.datamart_id,e.id,e).then((function(){n.setState({isLoading:!1}),r()})).catch((function(e){n.setState({isLoading:!1}),i(e)}))}})},n.getStatusColor=function(e){switch(e){case"LIVE":return"mcs-cleaning-rules-status-live";case"DRAFT":return"mcs-cleaning-rules-status-draft";case"ARCHIVED":return"mcs-cleaning-rules-status-archived"}},n.getButtonText=function(e){var t=n.props.intl;switch(e){case"DRAFT":return t.formatMessage(d.default.updateStatusToLiveButton);case"LIVE":return t.formatMessage(d.default.updateStatusToArchivedButton);default:return""}},n.getUpdateStatusModalText=function(e){var t=n.props.intl;switch(e){case"DRAFT":return t.formatMessage(d.default.updateStatusToLiveModalText);case"LIVE":return t.formatMessage(d.default.updateStatusToArchivedText);default:return""}},n.getUpdateStatusButton=function(e){if("ARCHIVED"!==e.status){var t=n.getButtonText(e.status);return o.createElement(c.Button,{className:"update-cleaning-rule-status",onClick:function(){return n.renderModal(e)}},t)}};var a=n.props.match.params.organisationId;return n.state={datamartItems:n.getDatamartItemsFromOrganisationId(a),isLoading:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.match.params.organisationId;t!==e.match.params.organisationId&&this.setState({datamartItems:this.getDatamartItemsFromOrganisationId(t)})}},{key:"render",value:function(){var e=this,t=this.props,n=t.match.params.organisationId,a=t.filter,r=t.onFilterChange,i=t.cleaningRules,s=t.isFetchingCleaningRules,f=t.total,g=t.intl,y=this.state,h=y.datamartItems,v=y.isLoading,b=[],_=o.createElement("span",{className:"mcs-card-button"},this.buildNewActionElement(n));if(h.length>1){var O={displayElement:o.createElement("div",null,o.createElement(l.FormattedMessage,d.default.datamartFilter),o.createElement(p.DownOutlined,null)),selectedItems:a.datamartId?[h.find((function(e){return e.key===a.datamartId}))]:[h[0]],items:h,singleSelectOnly:!0,getKey:function(e){return e&&e.key?e.key:""},display:function(e){return e.value},handleItemClick:function(e){r({datamartId:e.key,currentPage:1})}};b.push(O)}var w=[{intlMessage:d.default.channelFilter,key:"channel_filter",isHideable:!1,render:function(e,t){return o.createElement("span",null,t.channel_filter?t.channel_filter:g.formatMessage(d.default.all))}},{intlMessage:d.default.activityTypeFilter,key:"activity_type_filter",isHideable:!1,render:function(e,t){return o.createElement("span",null,t.activity_type_filter?t.activity_type_filter:g.formatMessage(d.default.all))}},{intlMessage:d.default.contentFilterValue,key:"filter",isHideable:!1,render:function(e,t){return o.createElement("span",null,t.filter?t.filter:g.formatMessage(d.default.noFilter))}}],P=[{intlMessage:d.default.compartmentFilter,key:"compartment_filter",isHideable:!1,render:function(e,t){return o.createElement("span",null,t.compartment_filter?t.compartment_filter:g.formatMessage(d.default.all))}}],T=[{intlMessage:d.default.status,key:"status",isHideable:!1,render:function(t,n){var a=e.getUpdateStatusButton(n);return o.createElement("span",null,o.createElement(c.McsIcon,{type:"status",className:e.getStatusColor(n.status)}),o.createElement("span",null,n.status),void 0!==a?a:"")}},{intlMessage:d.default.action,key:"action",isHideable:!1,render:function(e,t){return o.createElement("span",null,t.action)}},{intlMessage:d.default.lifeDuration,key:"life_duration",isHideable:!1,render:function(e,t){if(t.life_duration){var n=S.default.duration(t.life_duration),a=[{number:n.years(),unit:"year"},{number:n.months(),unit:"month"},{number:n.days(),unit:"day"}].reduce((function(e,t){return 0!==t.number?""+(void 0!==e?e+", ":"")+(t.number+" "+t.unit)+(1===t.number?"":"s"):e}),void 0);return o.createElement("span",null,a)}return o.createElement("span",null,"No duration")}}].concat("USER_EVENT_CLEANING_RULE"===a.type?w:P),I=[{key:"action",actions:function(t){return[{intlMessage:d.default.editCleaningRule,disabled:"DRAFT"!==t.status,callback:e.onEditCleaningRule},{intlMessage:d.default.deleteCleaningRule,disabled:"DRAFT"!==t.status,callback:e.onDeleteCleaningRule}]}}],A={current:a.currentPage,pageSize:a.pageSize,total:f,onChange:function(e,t){return r({currentPage:e,pageSize:t})},onShowSizeChange:function(e,t){return r({currentPage:1,pageSize:t})}};return v?o.createElement(E.Loading,{isFullScreen:!0}):o.createElement("div",{className:"ant-layout"},o.createElement(M,{className:"mcs-content-container"},o.createElement(m.Row,{className:"mcs-table-container"},o.createElement("div",null,o.createElement("div",{className:"mcs-card-header mcs-card-title"},o.createElement("span",{className:"mcs-card-title"},o.createElement(l.FormattedMessage,d.default.cleaningRules)),_),o.createElement("hr",{className:"mcs-separator"}),o.createElement(u.TableViewFilters,{columns:T,actionsColumnsDefinition:I,dataSource:i,loading:s,pagination:A,filtersOptions:b})))))}}]),t}(o.Component);w([(0,v.lazyInject)(b.TYPES.IDatamartService)],P.prototype,"_datamartService",void 0);t.default=(0,i.compose)(s.withRouter,l.injectIntl,g.default,(0,y.connect)((function(e){return{workspace:(0,h.getWorkspace)(e)}})))(P)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({status:{id:"settings.cleaningRules.table.column.status",defaultMessage:"Status"},action:{id:"settings.cleaningRules.table.column.action",defaultMessage:"Action"},lifeDuration:{id:"settings.cleaningRules.table.column.life_duration",defaultMessage:"Life duration"},channelFilter:{id:"settings.cleaningRules.table.column.channel_filter",defaultMessage:"Channel Filter"},compartmentFilter:{id:"settings.cleaningRules.table.column.compartment_filter",defaultMessage:"Compartment Filter"},activityTypeFilter:{id:"settings.cleaningRules.table.column.activity_type_filter",defaultMessage:"Activity type filter"},contentFilterValue:{id:"settings.cleaningRules.table.column.content_filter.filter",defaultMessage:"Event name filter"},updateStatus:{id:"settings.cleaningRules.table.column.update_status",defaultMessage:"Update status"},all:{id:"settings.cleaningRules.table.value.all",defaultMessage:"All"},datamartFilter:{id:"settings.cleaningRules.table.datamartFilter",defaultMessage:"Datamart"},noFilter:{id:"settings.cleaningRules.table.value.noFilter",defaultMessage:"No filter"},cleaningRules:{id:"settings.cleaningRules",defaultMessage:"Cleaning rules"},editCleaningRule:{id:"settings.cleaningRules.table.column.action.edit",defaultMessage:"View"},deleteCleaningRule:{id:"settings.cleaningRules.table.column.action.delete",defaultMessage:"Delete"},deleteCleaningRuleModalTitle:{id:"settings.cleaningRules.delete.modal.title",defaultMessage:"You are about to delete a cleaning rule. Do you want to proceed anyway?"},deleteCleaningRuleModalOk:{id:"settings.cleaningRules.delete.modal.ok",defaultMessage:"Delete now"},deleteCleaningRuleModalCancel:{id:"settings.cleaningRules.delete.modal.cancel",defaultMessage:"Cancel"},newCleaningRule:{id:"settings.cleaningRules.list.new",defaultMessage:"New Cleaning Rule"},updateStatusModalTitle:{id:"settings.cleaningRules.table.column.updateStatus.modal.title",defaultMessage:"Update cleaning rule status"},updateStatusModalConfirm:{id:"settings.cleaningRules.table.column.updateStatus.modal.confirm",defaultMessage:"Confirm"},updateStatusToLiveButton:{id:"settings.cleaningRules.table.column.updateStatus.draftToLiveButton",defaultMessage:"Activate the rule"},updateStatusToArchivedButton:{id:"settings.cleaningRules.table.column.updateStatus.liveToArchivedButton",defaultMessage:"Archive the rule"},updateStatusToLiveModalText:{id:"settings.cleaningRule.updateStatus.modal.draftToLiveText",defaultMessage:"You are about to activate the cleaning rule. This means that this rule will be applied to all new incoming activities."},updateStatusToArchivedText:{id:"settings.cleaningRules.updateStatus.modal.liveToArchivedText",defaultMessage:"You are about to archive the cleaning rule. This means that this rule will not be applied anymore to all new incoming activites."},updateCleaningRuleModalCancel:{id:"settings.cleaningRules.updateStatus.modal.cancel",defaultMessage:"Cancel"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({cleaningRules:{id:"settings.cleaningRules.title",defaultMessage:"Cleaning Rules"},EventBasedCleaningRulesTabTitle:{id:"settings.cleaningRules.tabs.eventBased.title",defaultMessage:"Event Based Cleaning Rules"},ProfileBasedCleaningRulesTabTitle:{id:"settings.cleaningRules.tabs.profileBased.title",defaultMessage:"Profile Based Cleaning Rules"}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CLEANING_RULES_SEARCH_SETTINGS=t.CLEANING_RULES_TYPE_AND_DATAMART_SEARCH_SETTINGS=void 0;var a=n(30);var r=t.CLEANING_RULES_TYPE_AND_DATAMART_SEARCH_SETTINGS=[{paramName:"type",defaultValue:void 0,deserialize:function(e){if(e.type)return e.type},serialize:function(e){return e},isValid:function(){return!0}},{paramName:"datamartId",defaultValue:"",deserialize:function(e){return e.datamartId},serialize:function(e){return e},isValid:function(){return!0}}];t.CLEANING_RULES_SEARCH_SETTINGS=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(a.PAGINATION_SEARCH_SETTINGS),r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=O(n(23)),l=n(13),c=n(65),u=n(67),d=n(87),f=n(25),p=n(51),m=O(n(424)),g=n(854),y=n(1190),h=n(15),v=n(12),b=n(10),_=O(n(17)),S=n(1192),E=O(S);function O(e){return e&&e.__esModule?e:{default:e}}var w=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.fetchCleaningRuleData=function(e,t,a){var r=n.props.notifyError;n.setState({loading:!0},(function(){var o=n.fetchRuleWithFilterOpt(e,t,a),i=n.fetchOptions(e,a);Promise.all([o,i]).then(n.saveFetchedDataInState(a)).catch((function(e){r(e),n.setState({loading:!1})}))}))},n.fetchRuleWithFilterOpt=function(e,t,a){var r=n._datamartService.getCleaningRule(e,t,a).then((function(e){return e.data})),o="USER_EVENT_CLEANING_RULE"===a?n._datamartService.getContentFilter(e,t).then((function(e){return e.data})).catch((function(e){return Promise.resolve(void 0)})):Promise.resolve(void 0);return Promise.all([r,o]).then((function(e){var t=e[0],n=e[1];if(t){if((0,y.isUserEventCleaningRuleResource)(t)){var a={rule:t,filter:n||void 0};return Promise.resolve(a)}return Promise.resolve(t)}return Promise.reject(void 0)}))},n.fetchOptions=function(e,t){var a=n.props,r=a.match.params.organisationId,o=a.intl.formatMessage,i=a.notifyError;return("USER_EVENT_CLEANING_RULE"===t?n._channelService.getChannels(r,e,{datamart_id:e,with_source_datamarts:!1}):n._datamartService.getUserAccountCompartmentDatamartSelectionResources(e)).then((function(e){return e.data})).then((function(e){return[{value:"",title:o(m.default.noFilter),key:"NO_FILTER"}].concat(e.map((function(e,t){var n=function(e){return void 0!==e.compartment_id}(e)?e.compartment_id:e.id;return{value:n,title:n+" - "+e.name,key:e.type?e.type+"-"+t:""+t}})))})).catch((function(e){return i(e),[]}))},n.getPeriodNumberAndUnit=function(e){return{periodNumber:_.default.duration(e).asDays(),periodUnit:"D"}},n.saveFetchedDataInState=function(e){return function(t){var a=function(e){return void 0!==e.rule},r=t[0],o=t[1],i=a(r)?r.rule:r,s=i.life_duration?n.getPeriodNumberAndUnit(i.life_duration):{periodNumber:1,periodUnit:"D"},l=Object.assign({selectedValue:i.action},s);if((0,y.isUserEventCleaningRuleResource)(i)&&"USER_EVENT_CLEANING_RULE"===e){var c=a(r)?r.filter:void 0,u=c&&"EVENT_NAME_FILTER"===c.content_type?c.filter:void 0;n.setState({cleaningRuleFormData:Object.assign(Object.assign({},g.INITIAL_USER_EVENT_CLEANING_RULE_FORM_DATA),{userEventCleaningRule:i,userEventContentFilter:c,eventNameFilter:u,channelFilter:i.channel_filter,activityTypeFilter:i.activity_type_filter,actionAndPeriod:l}),loading:!1,channelOptions:o})}(0,y.isUserProfileCleaningRuleResource)(i)&&"USER_PROFILE_CLEANING_RULE"===e&&n.setState({cleaningRuleFormData:Object.assign(Object.assign({},g.INITIAL_USER_PROFILE_CLEANING_RULE_FORM_DATA),{userProfileCleaningRule:i,actionAndPeriod:l}),loading:!1,compartmentOptions:o})}},n.onClose=function(){var e=n.props,t=e.history,a=e.location,r=e.match.params.organisationId,o=n.state,i=o.selectedDatamartId,s="/v2/o/"+r+"/settings/datamart/cleaning_rules?type="+o.cleaningRuleType+(i?"&datamartId="+i:"");return a.state&&a.state.from?t.push(a.state.from):t.push(s)},n.onDatamartSelect=function(e){var t=n.props.notifyError,a=n.state.cleaningRuleType,r="USER_EVENT_CLEANING_RULE"===a?g.INITIAL_USER_EVENT_CLEANING_RULE_FORM_DATA:g.INITIAL_USER_PROFILE_CLEANING_RULE_FORM_DATA;n.setState({loading:!0},(function(){n.fetchOptions(e.id,a).then((function(t){n.setState({loading:!1,selectedDatamartId:e.id,cleaningRuleFormData:r,channelOptions:"USER_EVENT_CLEANING_RULE"===a?t:void 0,compartmentOptions:"USER_PROFILE_CLEANING_RULE"===a?t:void 0})})).catch((function(o){t(o),n.setState({loading:!1,selectedDatamartId:e.id,cleaningRuleFormData:r,channelOptions:"USER_EVENT_CLEANING_RULE"===a?[]:void 0,compartmentOptions:"USER_PROFILE_CLEANING_RULE"===a?[]:void 0})}))}))},n.onSubmitFail=function(){var e=n.props.intl.formatMessage;b.message.error(e(m.default.errorFormMessage))},n.getDatamartId=function(){var e=n.props.match.params.cleaningRuleId,t=n.state,a=t.cleaningRuleFormData,r=t.selectedDatamartId;return(0,g.isUserEventCleaningRuleFormData)(a)?e&&a.userEventCleaningRule?a.userEventCleaningRule.datamart_id:r:e&&a.userProfileCleaningRule?a.userProfileCleaningRule.datamart_id:r},n.goToDatamartSelector=function(){n.props.match.params.cleaningRuleId||n.setState({selectedDatamartId:void 0})},n.checkCleaningRuleAndSave=function(e){var t=n.state.cleaningRuleType;(0,g.isUserEventCleaningRuleFormData)(e)?"USER_EVENT_CLEANING_RULE"===t&&n.checkUserEventCleaningRuleAndSave(e):"USER_PROFILE_CLEANING_RULE"===t&&n.checkUserProfileCleaningRuleAndSave(e)},n.checkUserProfileCleaningRuleAndSave=function(e){var t=n.props,a=t.match.params.cleaningRuleId,r=t.notifyError,o=n.state.selectedDatamartId;if(n.setState({loading:!0}),a&&e.userProfileCleaningRule){var i=e.userProfileCleaningRule.datamart_id,s=void 0!==e.userProfileCleaningRule.compartment_filter?""!==e.userProfileCleaningRule.compartment_filter?e.userProfileCleaningRule.compartment_filter:null:void 0,l=Object.assign(Object.assign({},e.userProfileCleaningRule),{compartment_filter:s,action:e.actionAndPeriod.selectedValue,life_duration:"P"+e.actionAndPeriod.periodNumber+e.actionAndPeriod.periodUnit});n._datamartService.updateCleaningRule(i,a,l).then((function(e){n.setState({loading:!1}),n.onClose()})).catch((function(e){n.setState({loading:!1}),r(e),n.onClose()}))}if(!a&&o){var c=e.userProfileCleaningRule&&""!==e.userProfileCleaningRule.compartment_filter?e.userProfileCleaningRule.compartment_filter:void 0,u={type:"USER_PROFILE_CLEANING_RULE",datamart_id:o,action:e.actionAndPeriod.selectedValue,status:"DRAFT",archived:!1,compartment_filter:c,life_duration:"P"+e.actionAndPeriod.periodNumber+e.actionAndPeriod.periodUnit};n._datamartService.createCleaningRule(o,u).then((function(e){n.setState({loading:!1}),n.onClose()})).catch((function(e){n.setState({loading:!1}),r(e),n.onClose()}))}},n.getContentFilterPromise=function(e,t,a,r){return a?r&&""!==r?n._datamartService.updateContentFilter(e,t,{content_type:"EVENT_NAME_FILTER",filter:r}):n._datamartService.deleteContentFilter(e,t):r&&""!==r?n._datamartService.createContentFilter(e,t,{content_type:"EVENT_NAME_FILTER",filter:r}):Promise.resolve(void 0)},n.checkUserEventCleaningRuleAndSave=function(e){var t=n.props,a=t.match.params.cleaningRuleId,r=t.notifyError,o=n.state.selectedDatamartId;if(n.setState({loading:!0}),a&&e.userEventCleaningRule){var i=e.userEventCleaningRule.datamart_id,s=void 0!==e.channelFilter?""!==e.channelFilter?e.channelFilter:null:void 0,l=void 0!==e.activityTypeFilter?""!==e.activityTypeFilter?e.activityTypeFilter:null:void 0,c=Object.assign(Object.assign({},e.userEventCleaningRule),{action:e.actionAndPeriod.selectedValue,channel_filter:s,activity_type_filter:l,life_duration:"P"+e.actionAndPeriod.periodNumber+e.actionAndPeriod.periodUnit});n._datamartService.updateCleaningRule(i,a,c).then((function(t){var r=e.userEventContentFilter,o=e.eventNameFilter;n.getContentFilterPromise(i,a,r,o).then((function(e){n.setState({loading:!1}),n.onClose()}))})).catch((function(e){n.setState({loading:!1}),r(e),n.onClose()}))}if(!a&&o){var u=void 0!==e.activityTypeFilter&&""!==e.activityTypeFilter?e.activityTypeFilter:void 0,d=void 0!==e.channelFilter&&""!==e.channelFilter?e.channelFilter:void 0,f={type:"USER_EVENT_CLEANING_RULE",datamart_id:o,action:e.actionAndPeriod.selectedValue,status:"DRAFT",archived:!1,channel_filter:d,activity_type_filter:u,life_duration:"P"+e.actionAndPeriod.periodNumber+e.actionAndPeriod.periodUnit};n._datamartService.createCleaningRule(o,f).then((function(t){var a=t.data.id,r=e.eventNameFilter;return(r&&""!==r?n._datamartService.createContentFilter(o,a,{content_type:"EVENT_NAME_FILTER",filter:r}):Promise.resolve(void 0)).then((function(e){n.onClose(),n.setState({loading:!1})}))})).catch((function(e){n.setState({loading:!1}),r(e),n.onClose()}))}};var a=e.location.pathname.includes("user_event")?"USER_EVENT_CLEANING_RULE":"USER_PROFILE_CLEANING_RULE",r="USER_EVENT_CLEANING_RULE"===a?g.INITIAL_USER_EVENT_CLEANING_RULE_FORM_DATA:g.INITIAL_USER_PROFILE_CLEANING_RULE_FORM_DATA;return n.state={loading:!0,cleaningRuleFormData:r,selectedDatamartId:e.match.params.datamartId,cleaningRuleType:a},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params,t=e.datamartId,n=e.cleaningRuleId,a=this.state.cleaningRuleType;t&&n?this.fetchCleaningRuleData(t,n,a):this.setState({loading:!1})}},{key:"componentDidUpdate",value:function(e){var t=this.props.match.params,n=t.datamartId,a=t.cleaningRuleId,r=e.match.params,o=r.datamartId,i=r.cleaningRuleId;if((n!==o||a!==i)&&n&&a){var s=this.state.cleaningRuleType;this.fetchCleaningRuleData(n,a,s)}}},{key:"render",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.intl.formatMessage,a=this.state,r=a.loading,i=a.cleaningRuleFormData,s=a.channelOptions,l=a.compartmentOptions,u=a.cleaningRuleType;if(r)return o.createElement(p.Loading,{isFullScreen:!0});var d="USER_EVENT_CLEANING_RULE"===u?[{name:n(m.default.userEventBreadcrumbTitle),path:"/v2/o/"+t+"/settings/datamart/cleaning_rules"}]:[{name:n(m.default.userProfileBreadcrumbTitle),path:"/v2/o/"+t+"/settings/datamart/cleaning_rules?type=USER_PROFILE_CLEANING_RULE"}],f={formId:S.FORM_ID,paths:d,onClose:this.onClose},g="USER_EVENT_CLEANING_RULE"===u?s:l,y=this.getDatamartId();return y?o.createElement(E.default,{initialValues:i,onSubmit:this.checkCleaningRuleAndSave,close:this.onClose,breadCrumbPaths:d,onSubmitFail:this.onSubmitFail,goToDatamartSelector:this.goToDatamartSelector,datamartId:y,options:g||[],cleaningRuleType:u}):o.createElement(c.DatamartSelector,{onSelect:this.onDatamartSelect,actionbarProps:f})}}]),t}(o.Component);w([(0,h.lazyInject)(v.TYPES.IDatamartService)],M.prototype,"_datamartService",void 0),w([(0,h.lazyInject)(v.TYPES.IChannelService)],M.prototype,"_channelService",void 0);t.default=(0,d.compose)(l.withRouter,i.injectIntl,c.injectDatamart,s.default,(0,f.connect)((function(e){return{workspace:(0,u.getWorkspace)(e)}})))(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(6),i=m(n(49)),s=n(8),l=m(n(424)),c=n(24),u=n(35),d=m(n(17)),f=n(854),p=m(n(2702));function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=function(e){function t(){g(this,t);var e=y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.checkLifeDuration=function(){return function(t){var n=e.props.intl.formatMessage,a=d.default.duration(f.USER_EVENT_CLEANING_RULE_MIN_LIFE_DURATION).asDays(),r=d.default.duration(f.USER_EVENT_CLEANING_RULE_MAX_LIFE_DURATION).asDays(),o=d.default.duration("P"+t.periodNumber+t.periodUnit).asDays();return o<a||o>r?n(l.default.invalidLifeDuration):void 0}},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage,a=e.cleaningRuleType,o=u.Field;return r.createElement("div",null,r.createElement(c.FormSection,{subtitle:"USER_EVENT_CLEANING_RULE"===a?l.default.sectionActionUserEventSubTitle:l.default.sectionActionUserProfileSubTitle,title:l.default.sectionActionTitle}),r.createElement(o,{name:"actionAndPeriod",component:p.default,validate:[t,this.checkLifeDuration()],formItemProps:{label:n(l.default.sectionActionLabel),required:!0},selectProps:{disabled:"USER_PROFILE_CLEANING_RULE"===a},optionsAndSeparators:[{label:"KEEP",value:"KEEP",separator:"for"},{label:"DELETE",value:"DELETE",separator:"after"}],helpToolTipProps:{title:n("USER_EVENT_CLEANING_RULE"===a?l.default.sectionActionUserEventHelper:l.default.sectionActionUserProfileHelper)}}))}}]),t}(r.Component);t.default=(0,s.compose)(o.injectIntl,i.default)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=d(n(84)),l=d(n(1124)),c=n(10),u=d(n(424));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){f(this,t);var e=p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.updateSelect=function(t){var n=e.props.input;n.onChange(Object.assign(Object.assign({},n.value),{selectedValue:t}))},e.updatePeriodNumber=function(t){var n=e.props.input;n.onChange(Object.assign(Object.assign({},n.value),{periodNumber:t}))},e.createOptions=function(){return e.props.optionsAndSeparators.map((function(e){return o.createElement(l.default.Option,{key:e.value,value:e.value},e.label)}))},e.createSeparator=function(){var t=e.props,n=t.optionsAndSeparators,a=t.input,r=n.find((function(e){return e.value===a.value.selectedValue})),o=n[0].separator;return r?r.separator:o},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.input,n=e.helpToolTipProps,r=e.small,i=e.formItemProps,d=e.selectProps,f=e.meta,p=e.intl,m="success";f.touched&&f.invalid&&(m="error"),f.touched&&f.warning&&(m="warning");var g=this.createOptions(),y=this.createSeparator();return o.createElement(s.default,a({help:f.touched&&(f.warning||f.error),validateStatus:m,helpToolTipProps:n,small:r},i),o.createElement(c.Row,null,o.createElement(c.Col,{span:6},o.createElement(l.default,a({value:t.value.selectedValue,onChange:this.updateSelect},d),g)),o.createElement(c.Col,{span:3,className:"text-center"},y),o.createElement(c.Col,{span:5},o.createElement(c.InputNumber,{value:t.value.periodNumber,onChange:this.updatePeriodNumber})),o.createElement(c.Col,{span:3},p.formatMessage(u.default.cleaningRuleLifeDurationDays))))}}]),t}(o.Component);t.default=(0,i.injectIntl)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(8),l=n(424),c=(a=l)&&a.__esModule?a:{default:a},u=n(24),d=n(35),f=n(25),p=n(1192),m=n(854);var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onActivityTypeFilterChange=function(e){var t=n.props.formChange,a=n.props.options;t("channelFilter",null),"SITE_VISIT"===e?n.setState({options:a.filter((function(e){var t;return(null===(t=e.key)||void 0===t?void 0:t.includes("SITE"))||"NO_FILTER"===e.key}))}):"APP_VISIT"===e?n.setState({options:a.filter((function(e){var t;return(null===(t=e.key)||void 0===t?void 0:t.includes("APP"))||"NO_FILTER"===e.key}))}):n.setState({options:a})},n.state={options:e.options},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.cleaningRuleType,a=e.formValues,r=this.state.options,i=(0,m.isUserEventCleaningRuleFormData)(a)&&!("TOUCH"===a.activityTypeFilter||"DISPLAY_AD"===a.activityTypeFilter||"EMAIL"===a.activityTypeFilter);return"USER_EVENT_CLEANING_RULE"===n?o.createElement("div",null,o.createElement(u.FormSection,{subtitle:c.default.sectionScopeUserEventSubTitle,title:c.default.sectionScopeTitle}),o.createElement(u.FormSelectField,{name:"activityTypeFilter",component:u.DefaultSelect,formItemProps:{label:t(c.default.sectionScopeActivityTypeLabel),required:!1},selectProps:{onSelect:this.onActivityTypeFilterChange},options:[{value:"",title:t(c.default.sectionScopeActivityTypeAllTypes)},{value:"SITE_VISIT",title:"SITE_VISIT"},{value:"APP_VISIT",title:"APP_VISIT"},{value:"TOUCH",title:"TOUCH"},{value:"DISPLAY_AD",title:"DISPLAY_AD"},{value:"EMAIL",title:"EMAIL"}],helpToolTipProps:{title:t(c.default.sectionScopeActivityTypeHelper)}}),i&&o.createElement(u.FormSelectField,{name:"channelFilter",component:u.DefaultSelect,formItemProps:{label:t(c.default.sectionScopeChannelLabel),required:!1},options:r,helpToolTipProps:{title:t(c.default.sectionScopeChannelHelper)}}),o.createElement(u.FormInputField,{name:"eventNameFilter",component:u.FormInput,formItemProps:{label:t(c.default.sectionScopeEventNameLabel),required:!1},helpToolTipProps:{title:t(c.default.sectionScopeEventNameHelper)}})):o.createElement("div",null,o.createElement(u.FormSection,{subtitle:c.default.sectionScopeUserProfileSubTitle,title:c.default.sectionScopeTitle}),o.createElement(u.FormSelectField,{name:"userProfileCleaningRule.compartment_filter",component:u.DefaultSelect,formItemProps:{label:t(c.default.sectionScopeCompartmentLabel),required:!1},options:r,helpToolTipProps:{title:t(c.default.sectionScopeCompartmentHelper)}}))}}]),t}(o.Component);t.default=(0,s.compose)(i.injectIntl,(0,f.connect)((function(e){return{formValues:(0,d.getFormValues)(p.FORM_ID)(e)}})))(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(13),l=n(6),c=n(8),u=n(51),d=n(15),f=n(12),p=n(2705),m=(a=p)&&a.__esModule?a:{default:a},g=n(124),y=n(10);var h=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},v=(0,l.defineMessages)({newUserRole:{id:"settings.organisation.usersRoles.edit.newUserRole",defaultMessage:"New User Role"},userRoles:{id:"settings.organisation.usersRoles.edit.userRoles",defaultMessage:"User Roles"},userRole:{id:"settings.organisation.usersRoles.edit.userRole",defaultMessage:"User Role"},editUserRole:{id:"settings.organisation.usersRoles.edit.editRole",defaultMessage:"Edit role"},savingInProgress:{id:"settings.organisation.usersRoles.edit.savingInProgress",defaultMessage:"Saving in progress"},updateSuccess:{id:"settings.organisation.usersRoles.edit.userRoleSuccessfullySaved",defaultMessage:"User role successfully saved"},updateError:{id:"settings.organisation.usersRoles.edit.userRoleUpdateFailed",defaultMessage:"User role update failed"}}),b={user_name:"",email:"",organisation_name:""},_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.close=function(){var e=n.props,t=e.history,a="/v2/o/"+e.match.params.organisationId+"/settings/organisation/user_roles";return t.push(a)},n.save=function(e){var t=n.props.match.params.userId;n.setState({loading:!0});var a={organisation_id:e.organisation_id,role:e.role};e.id&&n._userRolesService.deleteUserRole(t,e.id).then((function(e){return n._userRolesService.createUserRole(t,a)})).then((function(){n.redirectAndNotify(!0)})).catch((function(e){n.redirectAndNotify(),(0,g.notifyError)(e)}))},n.state={loading:!1,userRoleData:b},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e,t=this,n=this.props,a=n.match.params,r=a.userId,o=a.roleId,i=a.organisationId,s=n.location,l=n.history,c=null===(e=s.state)||void 0===e?void 0:e.userOrganisationId;if(!r||!o||!c)return l.replace("/v2/o/"+i+"/settings/organisation/user_roles");this.setState({loading:!0}),this._userRolesService.getUserRoles(r).then((function(e){return e.data.find((function(e){return e.id===o}))})).then((function(e){e?t._usersService.getUser(r,c).then((function(n){var a=Object.assign(Object.assign({},e),{user_id:n.data.id,user_name:n.data.first_name+" "+n.data.last_name,email:n.data.email,organisation_name:""});t.setState({userRoleData:a}),t._organisationService.getOrganisation(c).then((function(e){return t.setState({userRoleData:Object.assign(Object.assign({},t.state.userRoleData),{organisation_name:e.data.name}),loading:!1})}))})).catch((function(e){t.redirectAndNotify(!1),(0,g.notifyError)(e)})):((0,g.notifyError)("UserRole not found"),t.setState({loading:!1}))})).catch((function(e){t.redirectAndNotify(!1),(0,g.notifyError)(e)}))}},{key:"redirectAndNotify",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.props.intl;this.setState({loading:!1}),this.close(),e?y.message.success(t.formatMessage(v.updateSuccess)):y.message.error(t.formatMessage(v.updateError))}},{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.match.params.organisationId,a=this.state,r=a.userRoleData,o=a.loading,s=[{name:t(v.userRoles),path:"/v2/o/"+n+"/settings/organisation/user_roles"},{name:t(v.editUserRole)}];return o?i.createElement(u.Loading,{isFullScreen:!0}):i.createElement(m.default,{initialValues:r,onSave:this.save,onClose:this.close,breadCrumbPaths:s})}}]),t}(i.Component);h([(0,d.lazyInject)(f.TYPES.IUsersService)],_.prototype,"_usersService",void 0),h([(0,d.lazyInject)(f.TYPES.IUserRolesService)],_.prototype,"_userRolesService",void 0),h([(0,d.lazyInject)(f.TYPES.IOrganisationService)],_.prototype,"_organisationService",void 0),t.default=(0,c.compose)(s.withRouter,l.injectIntl)(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(8),s=n(35),l=n(13),c=n(6),u=m(n(60)),d=m(n(101)),f=m(n(2706)),p=m(n(1177));function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h="userRoleForm",v=o.Layout.Content,b=(0,c.defineMessages)({sectionTitleUserInfo:{id:"settings.organisation.users.role.edit.userInformationSection.title",defaultMessage:"User Information"},sectionTitleRoleInfo:{id:"settings.organisation.users.role.edit.roleInformationSection.title",defaultMessage:"Role Information"},saveUserRole:{id:"settings.organisation.users.role.edit.saveButton",defaultMessage:"Save User Role"}}),_=function(e){function t(){return g(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.onSave,a={formId:h,paths:this.props.breadCrumbPaths,message:b.saveUserRole,onClose:this.props.onClose},i=[{id:"userInfo",title:b.sectionTitleUserInfo,component:r.createElement(f.default,null)},{id:"roleInfo",title:b.sectionTitleRoleInfo,component:r.createElement(p.default,null)}],l={items:i.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:h},c=i.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==i.length-1&&r.createElement("hr",null))}));return r.createElement(o.Layout,{className:"edit-layout"},r.createElement(u.default,a),r.createElement(o.Layout,{className:"ant-layout-has-sider"},r.createElement(d.default,l),r.createElement(s.Form,{className:"edit-layout ant-layout",onSubmit:t(n)},r.createElement("button",{type:"submit",style:{display:"none"}}),r.createElement(v,{id:h,className:"mcs-content-container mcs-form-container"},r.createElement("div",{className:"placement-list-form"},c)))))}}]),t}(r.Component);t.default=(0,i.compose)(l.withRouter,c.injectIntl,(0,s.reduxForm)({form:h,enableReinitialize:!0}))(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=u(n(49)),l=u(n(63)),c=n(24);function u(e){return e&&e.__esModule?e:{default:e}}var d=(0,i.defineMessages)({sectionTitleGeneral:{id:"settings.organisation.users.edit.userInfoSection.title",defaultMessage:"User Information"},labelUserName:{id:"settings.organisation.users.edit.userInfoSection.label.name",defaultMessage:"Name"},labelUserEmail:{id:"settings.organisation.users.edit.userInfoSection.label.email",defaultMessage:"Email"},labelOrganisation:{id:"settings.organisation.users.edit.userInfoSection.label.organisation",defaultMessage:"Organisation"}}),f=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.intl.formatMessage;return r.createElement("div",null,r.createElement(c.FormSection,{title:d.sectionTitleGeneral}),r.createElement("div",null,r.createElement(c.FormInputField,{name:"user_name",component:c.FormInput,formItemProps:{label:e(d.labelUserName)},inputProps:{placeholder:e(d.labelUserName),disabled:!0}}),r.createElement(c.FormInputField,{name:"email",component:c.FormInput,formItemProps:{label:e(d.labelUserEmail)},inputProps:{placeholder:e(d.labelUserEmail),disabled:!0}}),r.createElement(c.FormSelectField,{name:"organisation_name",component:c.DefaultSelect,disabled:!0,formItemProps:{label:e(d.labelOrganisation)}})))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,s.default,l.default)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=h(n(2708)),l=n(13),c=n(15),u=n(12),d=h(n(23)),f=n(6),p=n(133),m=n(127),g=n(10),y=n(51);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.save=function(e){var t=n.props,a=t.match.params,r=a.organisationId,o=a.audienceFeatureId,i=a.datamartId,s=t.notifyError,l=t.history,c=t.intl,u=g.message.loading(c.formatMessage(p.messages.audienceFeatureSavingInProgress),0);n.setState({isLoading:!0});var d=Object.assign(Object.assign({},e),{addressable_object:"UserPoint"}),f=e.object_tree_expression;f&&(f.includes("where")?f=f.split("where")[1]:f.includes("WHERE")&&(f=f.split("WHERE")[1]),d.object_tree_expression=f.toLowerCase()),(o?n._audienceFeatureService.updateAudienceFeature(i,o,d):n._audienceFeatureService.createAudienceFeature(i,d)).then((function(){u(),l.push({pathname:"/v2/o/"+r+"/settings/datamart/datamarts/"+i,state:{activeTab:"audience_builder"}})})).catch((function(e){u(),s(e),n.setState({isLoading:!1})}))},n.onClose=function(){var e=n.props,t=e.history,a=e.match.params,r=a.organisationId,o=a.datamartId;return t.push({pathname:"/v2/o/"+r+"/settings/datamart/datamarts/"+o,state:{activeTab:"audience_builder"}})},n.state={isLoading:!1,audienceFeature:{}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match.params,a=n.datamartId,r=n.audienceFeatureId,o=t.notifyError;r&&(this.setState({isLoading:!0}),this._audienceFeatureService.getAudienceFeature(a,r).then((function(t){e.setState({audienceFeature:t.data,isLoading:!1})})).catch((function(t){o(t),e.setState({isLoading:!1})}))),this._runtimeSchemaService.getRuntimeSchemas(a).then((function(t){var n=t.data.find((function(e){return"LIVE"===e.status}));return n?e._runtimeSchemaService.getObjectTypeInfoResources(a,n.id).then((function(t){return e.setState({schema:(0,m.computeFinalSchemaItem)(t,"UserPoint",!1,!1,!1)}),t})):[]}))}},{key:"render",value:function(){var e=this.state,t=e.audienceFeature,n=e.schema,a=e.isLoading,r=this.props,i=r.intl.formatMessage,l=r.match.params,c=l.organisationId,u=l.datamartId,d=l.audienceFeatureId&&t.name?t.name:i(p.messages.audienceFeatureNew),f=[{name:i(p.messages.audienceFeatures),path:"/v2/o/"+c+"/settings/datamart/datamarts/"+u,state:{activeTab:"audience_builder"}},{name:d}];return a?o.createElement(y.Loading,{isFullScreen:!0}):o.createElement(s.default,{initialValues:t,onSubmit:this.save,close:this.onClose,breadCrumbPaths:f,schema:n})}}]),t}(o.Component);v([(0,c.lazyInject)(u.TYPES.IAudienceFeatureService)],b.prototype,"_audienceFeatureService",void 0),v([(0,c.lazyInject)(u.TYPES.IRuntimeSchemaService)],b.prototype,"_runtimeSchemaService",void 0),t.default=(0,i.compose)(l.withRouter,f.injectIntl,d.default)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(109),s=n(855),l=n(35),c=y(n(2709)),u=n(6),d=n(133),f=n(8),p=y(n(2710)),m=y(n(2711)),g=n(25);function y(e){return e&&e.__esModule?e:{default:e}}var h=o.Layout.Content,v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.breadCrumbPaths,a=e.close,u=e.change,f=e.schema,g=e.formValues,y={formId:s.AUDIENCE_FEATURE_FORM_ID,paths:n,message:d.messages.audienceFeatureSave,onClose:a},v=[];v.push({id:"general",title:d.messages.audienceFeatureSectionGeneralTitle,component:r.createElement(c.default,null)}),v.push({id:"query",title:d.messages.audienceFeatureAssociatedQuery,component:r.createElement(m.default,{formChange:u,associatedQuery:null==g?void 0:g.object_tree_expression})});var b=v.map((function(e,t){return r.createElement("div",{key:e.id},r.createElement("div",{key:e.id,id:e.id},e.component),t!==v.length-1&&r.createElement("hr",null))}));return r.createElement(o.Layout,{className:"edit-layout"},r.createElement(i.FormLayoutActionbar,y),r.createElement(o.Layout,{className:"ant-layout-has-sider"},r.createElement(l.Form,{className:"edit-layout ant-layout",onSubmit:t},r.createElement("button",{type:"submit",style:{display:"none"}}),r.createElement(h,{id:s.AUDIENCE_FEATURE_FORM_ID,className:"mcs-content-container mcs-form-container"},r.createElement(o.Row,null,r.createElement(o.Col,{className:"mcs-audienceFeature_formColumn",span:12},b),r.createElement(o.Col,{className:"mcs-audienceFeature_formColumn",span:12},r.createElement(p.default,{schema:f,formValues:g})))))))}}]),t}(r.Component);t.default=(0,f.compose)(u.injectIntl,(0,l.reduxForm)({form:s.AUDIENCE_FEATURE_FORM_ID,enableReinitialize:!0}),(0,g.connect)((function(e){return{formValues:(0,l.getFormValues)(s.AUDIENCE_FEATURE_FORM_ID)(e)}})))(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=n(133),l=n(24),c=d(n(49)),u=d(n(63));function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage;return r.createElement("div",null,r.createElement(l.FormSection,{title:s.messages.audienceFeatureSectionGeneralTitle}),r.createElement(l.FormInputField,{name:"name",component:l.FormInput,validate:[t],formItemProps:{label:n(s.messages.audienceFeatureNameLabel),required:!0},inputProps:{placeholder:n(s.messages.audienceFeatureNamePlaceholder)},helpToolTipProps:{title:n(s.messages.audienceFeatureNameTooltip)}}),r.createElement(l.FormInputField,{name:"description",component:l.FormInput,formItemProps:{label:n(s.messages.audienceFeatureDescriptionLabel),required:!1},inputProps:{placeholder:n(s.messages.audienceFeatureDescriptionPlaceholder)},helpToolTipProps:{title:n(s.messages.audienceFeatureDescriptionTooltip)}}))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,c.default,u.default)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=m(n(54)),i=n(8),s=n(6),l=n(133),c=n(24),u=n(127),d=n(11),f=m(n(1084)),p=n(13);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.extractVariables=function(e,t){var n=function(e){switch(e){case"ID":case"ID!":case"Number":case"Number!":return"Int";case"Bool":case"Bool!":return"Boolean";case"Timestamp":case"Timestamp!":case"Date":case"Date!":return"Date";case"String":case"String!":return"String";case"Enum":case"Enum!":case"List":case"List!":return"Enum";case"OperatingSystemFamily":return"OperatingSystemFamily";case"FormFactor":return"FormFactor";case"HashFunction":return"HashFunction";case"BrowserFamily":return"BrowserFamily";case"UserAgentType":return"UserAgentType";case"ActivitySource":return"ActivitySource";case"UserActivityType":return"UserActivityType";default:return null}},a=[];!function e(t){t.forEach((function(t){(0,u.isSchemaItem)(t)?e(t.fields):a.push({parameter_name:t.name,field_name:t.name,type:n(t.field_type),path:[]})}))}(t.fields);var r=e.split(/[<>]=?|==|=| in | IN /);return r.splice(r.length-1),r.map((function(e){return e.trim().split(" ").pop()})).map((function(e){var t;return{parameter_name:e+" parameter",field_name:e,type:n((null===(t=a.find((function(t){return t.field_name===e})))||void 0===t?void 0:t.type)||null),path:[]}}))},n.state={variables:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidUpdate",value:function(e){var t=e.formValues,n=e.schema,a=this.props,r=a.formValues,i=a.schema,s=null==r?void 0:r.object_tree_expression;s===(null==t?void 0:t.object_tree_expression)&&o.default.isEqual(i,n)||!s||!i||this.setState({variables:this.extractVariables(s,i)})}},{key:"render",value:function(){var e=this.props,t=e.intl.formatMessage,n=e.match.params.datamartId,a=e.formValues,o=this.state.variables;return r.createElement("div",{className:"mcs-audienceFeature-preview"},r.createElement(c.FormSection,{title:l.messages.audienceFeaturePreview}),r.createElement(d.Card,{className:"mcs-audienceFeature_card",title:t(l.messages.audienceFeatures)},r.createElement("div",{className:"mcs-audienceFeature_cardContainer"},r.createElement("div",{className:"mcs-audienceFeature_name"},null==a?void 0:a.name),r.createElement("i",{className:"mcs-audienceFeature_description"},null==a?void 0:a.description),o.map((function(e,t){return r.createElement(f.default,{key:t,disabled:!0,datamartId:n,variable:e,objectTypes:[],formPath:""})})))))}}]),t}(r.Component);t.default=(0,i.compose)(s.injectIntl,p.withRouter)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(10),i=n(6),s=n(8),l=n(11),c=n(61),u=y(n(1150)),d=n(13),f=n(24),p=n(133),m=y(n(270)),g=y(n(1014));function y(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=function(e){function t(){h(this,t);var e=v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.aceEditor=null,e.openEditor=function(){var t=e.props,n=t.intl,a=t.associatedQuery;e.props.openNextDrawer(u.default,{additionalProps:{datamartId:e.props.match.params.datamartId,renderActionBar:function(t,a){return function(e,t,a){return r.createElement(l.Actionbar,{edition:!0,paths:[{name:n.formatMessage({id:"settings.datamart.audienceFeature.edit.query",defaultMessage:"Edit with OTQL"})}]},r.createElement(o.Button,{disabled:!a,className:"mcs-primary mcs-audienceFeature_update_query",type:"primary",onClick:e},r.createElement(i.FormattedMessage,{id:"settings.datamart.audienceFeature.edit.update",defaultMessage:"Update"})),r.createElement(l.McsIcon,{type:"close",className:"close-icon",style:{cursor:"pointer"},onClick:t}))}((function(){e.props.formChange("object_tree_expression",t),e.props.closeNextDrawer()}),(function(){return e.props.closeNextDrawer()}),t)},query:"SELECT @count{} FROM UserPoint where "+a,queryEditorClassName:"mcs-audienceFeature_edit_form_query_builder"}})},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){if(this.aceEditor&&this.aceEditor.editor){var e=new g.default;this.aceEditor.editor.getSession().setMode(e)}}},{key:"render",value:function(){var e=this,t=this.props.associatedQuery;return r.createElement(r.Fragment,null,r.createElement(f.FormSection,{subtitle:p.messages.audienceFeatureSectionGeneralSubTitle,title:p.messages.audienceFeatureAssociatedQuery}),r.createElement(o.Button,{onClick:this.openEditor,className:"m-b-20 float-right mcs-audienceFeature_edit_query_button"},this.props.intl.formatMessage({id:"jsonql.button.query.edit",defaultMessage:"Edit Query"})),r.createElement(m.default,{mode:"otql",theme:"otql",width:"100%",height:"100px",readOnly:!0,ref:function(t){return e.aceEditor=t},value:"SELECT @count{} FROM UserPoint where "+t,setOptions:{showGutter:!0}}))}}]),t}(r.Component);t.default=(0,s.compose)(i.injectIntl,c.injectDrawer,d.withRouter)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(8),s=h(n(2713)),l=n(13),c=n(15),u=n(12),d=h(n(23)),f=n(6),p=n(133),m=n(855),g=n(10),y=n(51);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.save=function(e){var t=n.props,a=t.match.params,r=a.organisationId,o=a.audienceBuilderId,i=a.datamartId,s=t.notifyError,l=t.history,c=t.intl,u=g.message.loading(c.formatMessage(p.messages.audienceBuilderSavingInProgress),0);n.setState({isLoading:!0});var d=Object.assign({},e.audienceBuilder),f=e.audienceFeatureDemographics;f&&(d.demographics_features_ids=f.map((function(e){return e.model.id}))),(o?n._audienceBuilderService.updateAudienceBuilder(i,o,d):n._audienceBuilderService.createAudienceBuilder(i,d)).then((function(){u(),l.push({pathname:"/v2/o/"+r+"/settings/datamart/datamarts/"+i,state:{activeTab:"audience_builder"}})})).catch((function(e){u(),s(e),n.setState({isLoading:!1})}))},n.onClose=function(){var e=n.props,t=e.history,a=e.match.params,r=a.organisationId,o=a.datamartId;return t.push({pathname:"/v2/o/"+r+"/settings/datamart/datamarts/"+o,state:{activeTab:"audience_builder"}})},n.state={isLoading:!1,builderFormData:m.INITIAL_AUDIENCE_BUILDER_FORM_DATA},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match.params,a=n.datamartId,r=n.audienceBuilderId,o=t.notifyError;r&&(this.setState({isLoading:!0}),this._audienceBuilderService.loadAudienceBuilder(a,r).then((function(t){e.setState({builderFormData:t,isLoading:!1})})).catch((function(t){o(t),e.setState({isLoading:!1})})))}},{key:"render",value:function(){var e=this.state,t=e.builderFormData,n=e.isLoading,a=this.props,r=a.intl.formatMessage,i=a.match.params,l=i.organisationId,c=i.datamartId,u=i.audienceBuilderId,d=t.audienceBuilder.name,f=u&&d?d:r(p.messages.audienceBuilderNew),m=[{name:r(p.messages.audienceBuilders),path:"/v2/o/"+l+"/settings/datamart/datamarts/"+c,state:{activeTab:"audience_builder"}},{name:f}];return n?o.createElement(y.Loading,{isFullScreen:!0}):o.createElement(s.default,{initialValues:t,onSubmit:this.save,close:this.onClose,breadCrumbPaths:m})}}]),t}(o.Component);v([(0,c.lazyInject)(u.TYPES.IAudienceBuilderService)],b.prototype,"_audienceBuilderService",void 0),t.default=(0,i.compose)(l.withRouter,f.injectIntl,d.default)(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(13),s=n(10),l=n(109),c=n(855),u=n(35),d=y(n(2714)),f=n(6),p=n(133),m=n(8),g=y(n(2715));function y(e){return e&&e.__esModule?e:{default:e}}var h=s.Layout.Content,v=u.FieldArray,b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.breadCrumbPaths,r=e.change,i=e.close,f={formChange:r,rerenderOnEveryChange:!0},m={formId:c.AUDIENCE_BUILDER_FORM_ID,paths:n,message:p.messages.audienceBuilderSave,onClose:i},y=[];y.push({id:"general",title:p.messages.audienceBuilderSectionGeneralTitle,component:o.createElement(d.default,null)}),y.push({id:"demographics",title:p.messages.audienceBuilderSectionDemographicsTitle,component:o.createElement(v,a({name:"audienceFeatureDemographics",component:g.default},f))});var b=y.map((function(e,t){return o.createElement("div",{key:e.id},o.createElement("div",{key:e.id,id:e.id},e.component),t!==y.length-1&&o.createElement("hr",null))})),_={items:y.map((function(e){return{sectionId:e.id,title:e.title}})),scrollId:c.AUDIENCE_BUILDER_FORM_ID};return o.createElement(s.Layout,{className:"edit-layout"},o.createElement(l.FormLayoutActionbar,m),o.createElement(s.Layout,{className:"ant-layout-has-sider"},o.createElement(l.ScrollspySider,_),o.createElement(u.Form,{className:"edit-layout ant-layout",onSubmit:t},o.createElement("button",{type:"submit",style:{display:"none"}}),o.createElement(h,{id:c.AUDIENCE_BUILDER_FORM_ID,className:"mcs-content-container mcs-form-container"},o.createElement("div",{className:"mcs-audienceBuilder_formColumn"},b)))))}}]),t}(o.Component);t.default=(0,m.compose)(f.injectIntl,i.withRouter,(0,u.reduxForm)({form:c.AUDIENCE_BUILDER_FORM_ID,enableReinitialize:!0}))(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(6),s=n(133),l=n(24),c=d(n(49)),u=d(n(63));function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={displayAdvancedSection:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.fieldValidators.isRequired,n=e.intl.formatMessage;return r.createElement("div",null,r.createElement(l.FormSection,{title:s.messages.audienceBuilderSectionGeneralTitle}),r.createElement(l.FormInputField,{name:"audienceBuilder.name",component:l.FormInput,validate:[t],formItemProps:{label:n(s.messages.audienceBuilderNameLabel),required:!0},inputProps:{placeholder:n(s.messages.audienceBuilderNamePlaceholder)},helpToolTipProps:{title:n(s.messages.audienceBuilderNameTooltip)}}))}}]),t}(r.Component);t.default=(0,o.compose)(i.injectIntl,c.default,u.default)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(133),s=n(6),l=n(13),c=g(n(47)),u=n(24),d=g(n(162)),f=n(183),p=g(n(1085)),m=n(41);function g(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getDemographicsRecords=function(){var e=n.props.fields,t=function(e){return e.model.name};return e.getAll().map((function(n,a){return r.createElement(f.RecordElement,{key:n.key,record:n,title:t,onRemove:function(){return e.remove(a)}})}))},n.addAudienceFeature=function(e){var t=n.props,a=t.fields,r=t.formChange,o=t.closeNextDrawer,i=[];i.push.apply(i,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(a.getAll())),i.push({key:(0,c.default)(),model:e[0]}),r(a.name,i),o()},n.openDemographicsSelector=function(){var e=n.props,t=e.openNextDrawer,a=e.match.params.datamartId,r=e.fields,o={datamartId:a,close:n.props.closeNextDrawer,save:n.addAudienceFeature,demographicIds:r.map((function(e,t){return r.get(t).model.id}))};t(p.default,{additionalProps:o})},n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props.intl.formatMessage;return r.createElement("div",null,r.createElement(u.FormSection,{button:{message:e(i.messages.audienceBuilderSectionDemographicsAddButton),onClick:this.openDemographicsSelector},title:i.messages.audienceBuilderSectionDemographicsTitle,subtitle:i.messages.audienceBuilderSectionDemographicsSubtitle}),r.createElement(f.RelatedRecords,{emptyOption:{genericIconProps:r.createElement(m.InfoCircleFilled,{className:"mcs-audienceBuilderSettings-records"}),message:e(i.messages.audienceBuilderSectionDemographicsSubtitle)}},this.getDemographicsRecords()))}}]),t}(r.Component);t.default=(0,o.compose)(l.withRouter,s.injectIntl,d.default)(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(33),i=n(10),s=n(6),l=n(1169),c=n(8),u=n(73),d=n(11);function f(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var p="/v2/o/:organisationId(\\d+)",m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.checkInitialState=function(e){var t=l.settingsDefinitions.filter((function(e){return"multi"===e.type&&e.subMenuItems&&e.subMenuItems.length>0})).find((function(t){return"multi"===t.type&&t.subMenuItems.reduce((function(t,n){return!!(0,o.matchPath)(e,{path:""+p+n.path,exact:!1,strict:!1})||t}),!1)}));t&&n.setState({inlineOpenKeys:[t.iconType]})},n.onOpenChange=function(e){var t=n.state;if("inline"===n.props.mode){var a=e.find((function(e){return!(t.inlineOpenKeys.indexOf(e)>-1)})),r=[];a&&(r=[a]),n.setState({inlineOpenKeys:r})}else n.setState({vecticalOpenKeys:e})},n.onClick=function(e){l.settingsDefinitions.find((function(t){return t.iconType===e.key}))&&n.setState({inlineOpenKeys:[]})},n.getAllKeysWithPath=function(){return n.getAvailableItems().reduce((function(e,t){var n=void 0;return"multi"===t.type?(n=t.subMenuItems.reduce((function(e,n){return[].concat(f(e),[{key:n.path,path:n.path,mainKey:t.iconType}])}),[]),[].concat(f(e),f(n))):[].concat(f(e),[{key:t.iconType,path:t.path,mainKey:t.iconType}])}),[])},n.state={inlineOpenKeys:[],vecticalOpenKeys:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this.props.location.pathname;this.checkInitialState(e)}},{key:"getAvailableItems",value:function(){var e=this.props.hasFeature;return l.settingsDefinitions.reduce((function(t,n){if("multi"===n.type&&function(t){return t.subMenuItems.reduce((function(t,n){return e(n.requiredFeature,n.requireDatamart)?e(n.requiredFeature,n.requireDatamart):t}),!1)}(n)){var a=(n.subMenuItems||[]).filter((function(t){return e(t.requiredFeature,t.requireDatamart)}));return[].concat(f(t),[Object.assign(Object.assign({},n),{subMenuItems:a})])}return t}),[])}},{key:"buildItems",value:function(){var e=this.props,t=e.match.params.organisationId,n=e.location.pathname,a=e.hasFeature,c="/v2/o/"+t,u=l.settingsDefinitions.filter((function(e){return"multi"===e.type&&e.subMenuItems&&e.subMenuItems.length>0})).find((function(e){return"multi"===e.type&&e.subMenuItems.reduce((function(e,t){return!!(0,o.matchPath)(n,{path:""+p+t.path,exact:!1,strict:!1})||e}),!1)}));return u&&"multi"===u.type&&u.subMenuItems&&u.subMenuItems.map((function(e){return a(e.requiredFeature,e.requireDatamart)?r.createElement(i.Menu.Item,{key:e.path},r.createElement(o.Link,{to:""+c+e.path,className:"mcs-settingsSideMenu_"+e.translation.id},r.createElement(d.McsIcon,{type:e.iconType}),r.createElement("span",{className:"nav-text"},r.createElement(s.FormattedMessage,e.translation)))):null}))}},{key:"render",value:function(){var e,t=this,n=this.props,a=n.mode,s=n.location.pathname;return r.createElement(i.Menu,{mode:a,selectedKeys:(e=t.getAllKeysWithPath().find((function(e){return!!(0,o.matchPath)(s,{path:""+p+e.path})})),e?[e.key]:[]),openKeys:"inline"===a?t.state.inlineOpenKeys:t.state.vecticalOpenKeys,onOpenChange:this.onOpenChange,onClick:this.onClick},this.buildItems())}}]),t}(r.Component);t.default=(0,c.compose)(o.withRouter,u.injectFeatures)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=h(n(0)),o=n(6),i=n(33),s=n(41),l=n(10),c=n(25),u=n(790),d=n(614),f=n(750),p=n(1006),m=h(n(1193)),g=n(11),y=n(8);function h(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var v=l.Layout.Sider,b=(0,o.defineMessages)({switchOrg:{id:"navigator.layout.settingLayout.sideMenu.switchOrg.label",defaultMessage:"Switch Org."},collapse:{id:"navigator.layout.settingLayout.sideMenu.collapse",defaultMessage:"Collapse"},backToApp:{id:"navigator.layout.settingLayout.sideMenu.backToApp",defaultMessage:"Back To Your App"}}),_=l.Layout,S=d.Col,E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onCollapse=function(e){(0,n.props.openCloseMenu)({collapsed:e,mode:e?"vertical":"inline"});var t=new Event("redraw");window.dispatchEvent(t)},n.onMenuItemClick=function(){!0===n.props.collapsed&&n.onCollapse(!1)},n.renderTrigger=function(){var e=function(){n.onCollapse(!n.props.collapsed)},t=function(e){return function(){switch(e){case"left":return n.setState({left:20,right:4});case"right":return n.setState({left:4,right:20});default:return n.setState({left:12,right:12})}}};return n.props.showOrgSelector?r.createElement(d.Row,null,r.createElement(S,{span:n.state.left,className:"left",onMouseEnter:t("left"),onMouseLeave:t()},r.createElement(g.Button,{onClick:function(){n.setState((function(e){return Object.assign(Object.assign({},e),{isOpen:!e.isOpen})}))},style:{width:"100%"}},r.createElement("span",null,r.createElement(s.BarsOutlined,null)," ",r.createElement("span",{className:n.state.left>12&&!n.props.collapsed?"visible":"hidden"},r.createElement(o.FormattedMessage,b.switchOrg))))),r.createElement(S,{span:n.state.right,className:"right",onMouseEnter:t("right"),onMouseLeave:t()},r.createElement(g.Button,{onClick:e,style:{width:"100%"}},n.props.collapsed?r.createElement(s.RightOutlined,null):r.createElement("span",null,r.createElement(s.LeftOutlined,null)," ",r.createElement("span",{className:n.state.right>12?"visible":"hidden"},r.createElement(o.FormattedMessage,b.collapse)))))):r.createElement(d.Row,null,r.createElement(d.Col,{span:24,className:"all"},r.createElement(g.Button,{onClick:e,style:{width:"100%"},onMouseEnter:t("right"),onMouseLeave:t()},n.props.collapsed?r.createElement(s.RightOutlined,null):r.createElement("span",null,r.createElement(s.LeftOutlined,null)," ",r.createElement("span",{className:n.state.right>12?"visible":"hidden"},r.createElement(o.FormattedMessage,b.collapse))))))},n.renderSettingsTrigger=function(){return r.createElement(d.Row,null,r.createElement(d.Col,{span:24,className:"all"},r.createElement(g.Button,{onClick:function(){n.setState((function(e){return Object.assign(Object.assign({},e),{isOpen:!e.isOpen})}))},style:{width:"100%"}},r.createElement("span",null,r.createElement(s.BarsOutlined,null)," ",r.createElement("span",null,r.createElement(o.FormattedMessage,b.switchOrg))))))},n.state={isOpen:!1,left:12,right:12},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.contentComponent,a=t.organisationSelector,o=t.collapsed,i=t.mode,s=t.orgSelectorSize,c=r.createElement(p.NavigatorMenu,{mode:"vertical",onMenuItemClick:this.onMenuItemClick,className:"mcs-settings-main-menu"});return r.createElement("div",{id:"mcs-full-page",className:"mcs-fullscreen"},r.createElement(u.push,{pageWrapId:"mcs-main-layout",outerContainerId:"mcs-full-page",isOpen:this.state.isOpen,onStateChange:function(t){return e.setState({isOpen:t.isOpen})},width:s},r.createElement(a,{size:s,onItemClick:function(){return e.setState({isOpen:!1})}})),r.createElement(_,{id:"mcs-main-layout",className:"mcs-fullscreen"},r.createElement(f.NavigatorHeader,{isSetting:!0,menu:c}),r.createElement(l.Layout,null,r.createElement(p.NavigatorSettingsMainMenu,null),r.createElement(l.Layout,null,r.createElement(v,{collapsible:!0,collapsed:!1,trigger:this.renderSettingsTrigger()},r.createElement(p.NavigatorSettingsSideMenu,{mode:i,collapsed:o,onMenuItemClick:this.onMenuItemClick})),r.createElement(l.Layout,null,r.createElement(n,null))))))}}]),t}(r.Component);E.defaultProps={actionBarComponent:null,collapsed:!1,mode:"inline"};var O={openCloseMenu:m.openCloseMenu};t.default=(0,y.compose)(i.withRouter,(0,c.connect)((function(e){return{collapsed:e.menu.collapsed,mode:e.menu.mode}}),O))(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticatedRoute=void 0;var a,r=n(2719),o=(a=r)&&a.__esModule?a:{default:a};t.AuthenticatedRoute=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=S(n(0)),s=n(8),l=n(25),c=n(33),u=n(6),d=_(n(59)),f=n(322),p=n(589),m=S(n(67)),g=_(n(856)),y=_(n(1074)),h=n(15),v=n(12),b=n(11);function _(e){return e&&e.__esModule?e:{default:e}}function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var w=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=function(e){function t(){E(this,t);var e=O(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.checkIfHasFeatures=function(){var t=e.props,n=t.requiredFeatures,a=t.requireDatamart,r=t.hasFeature,o=t.computedMatch.params.organisationId,i=t.hasDatamarts;return n&&"string"==typeof n?r(n)&&!(!i(o)&&a):n&&Array.isArray(n)?n.reduce((function(e,t){return r(t)&&!(!i(o)&&a)}),!1):!n&&!(!i(o)&&a)},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.computedMatch.params.organisationId,n=e.getWorkspaceRequest,a=e.getLabels;(0,e.hasWorkspaceLoaded)(t)||n(t),a(t)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.computedMatch.params.organisationId,a=t.getWorkspaceRequest;e.computedMatch.params.organisationId!==n&&a(n)}},{key:"render",value:function(){var e=this,t=this.props,n=t.accessGrantedToOrganisation,r=t.computedMatch.params.organisationId,o=t.connectedUserLoaded,s=t.intl.formatMessage,l=t.render,u=t.errorRender,f=this._authService.isAuthenticated()&&o;return i.createElement(c.Route,a({},this.props,{render:function(t){return f?n(r)?(d.default.trace("Access granted to "+t.match.url),e.checkIfHasFeatures()?l(t):u(t)):i.createElement(b.Error,{message:s(g.default.notFound)}):(e._authService.canAuthenticate()&&window.location.reload(),d.default.error("Access denied to "+t.match.url+", redirect to login"),i.createElement(c.Redirect,{to:{pathname:"/login",state:{from:t.location}}}))}}))}}]),t}(i.Component);M.defaultProps={requiredFeatures:void 0,requireDatamart:!1},w([(0,h.lazyInject)(v.TYPES.IAuthService)],M.prototype,"_authService",void 0);var P={getWorkspaceRequest:f.getWorkspace.request,getLabels:p.fetchAllLabels.request};t.default=(0,s.compose)(u.injectIntl,y.default,(0,l.connect)((function(e){return{accessGrantedToOrganisation:m.hasAccessToOrganisation(e),hasWorkspaceLoaded:m.hasWorkspace(e),connectedUserLoaded:e.session.connectedUserLoaded,hasDatamarts:m.hasDatamarts(e)}}),P))(M)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ForgotPassword=void 0;var a,r=n(2721),o=(a=r)&&a.__esModule?a:{default:a};t.ForgotPassword=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=n(0),o=f(r),i=n(8),s=n(6),l=n(10),c=f(n(2722)),u=n(12),d=n(1194);function f(e){return e&&e.__esModule?e:{default:e}}var p=l.Form.Item;t.default=(0,i.compose)(s.injectIntl)((function(e){var t=l.Form.useForm(),n=a(t,1)[0],i=(0,r.useState)(!1),f=a(i,2),m=f[0],g=f[1],y=(0,r.useState)(!1),h=a(y,2),v=h[0],b=h[1],_=(0,r.useState)(!1),S=a(_,2),E=S[0],O=S[1],w=(0,d.useInjection)(u.TYPES.IAuthService),M=!(0!==n.getFieldError("email").length)&&m?o.default.createElement(l.Alert,{type:"error",className:"login-error-message",style:{marginBottom:24},message:o.default.createElement(s.FormattedMessage,c.default.authenticationError)}):null;return o.default.createElement("div",{className:"mcs-reset-password-container"},o.default.createElement("div",{className:"image-wrapper"},o.default.createElement("img",{alt:"mics-logo",className:"reset-password-logo",src:"/react/src/assets/images/logo.png"})),o.default.createElement("div",{className:"reset-password-title"},o.default.createElement(s.FormattedMessage,c.default.resetPasswordTitle)),o.default.createElement("div",{className:"reset-password-container-frame"},!E&&o.default.createElement(l.Form,{onFinish:function(e){n.validateFields().then((function(e){b(!0),w.sendPassword(e.email).then((function(){O(!0),b(!1)})).catch((function(){g(!0),b(!1)}))}))},form:n,className:"reset-password-form"},M,o.default.createElement("div",{className:"reset-passwork-msg"},o.default.createElement(s.FormattedMessage,c.default.resetPasswordDescription)),o.default.createElement("div",{className:"password-text"},o.default.createElement(s.FormattedMessage,c.default.emailText)),o.default.createElement(p,{name:"email",rules:[{required:!0,message:c.default.resetPasswordEmailRequired.defaultMessage}]},o.default.createElement(l.Input,{className:"reset-password-input"})),o.default.createElement(l.Row,null,o.default.createElement(l.Col,{span:12,className:"reset-password-back-to-login"},o.default.createElement(l.Button,{type:"link",href:"#/login",className:"reset-password-button",loading:v},o.default.createElement(s.FormattedMessage,c.default.resetPasswordBack))),o.default.createElement(l.Col,{span:12},o.default.createElement(l.Button,{type:"primary",htmlType:"submit",className:"mcs-primary reset-password-button",loading:v},o.default.createElement(s.FormattedMessage,c.default.resetPasswordSubmit))))),E&&o.default.createElement("div",null,o.default.createElement("div",null,o.default.createElement("p",{className:"reset-password-messages"},o.default.createElement(s.FormattedMessage,c.default.resetPasswordPasswordSent)),o.default.createElement("p",{className:"reset-password-messages"},o.default.createElement(s.FormattedMessage,c.default.resetPasswordEmailSpan))),o.default.createElement(l.Button,{type:"primary",htmlType:"button",className:"mcs-primary reset-password-button",href:"/"},o.default.createElement(s.FormattedMessage,c.default.resetPasswordReturnToLogin)))))}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6);t.default=(0,a.defineMessages)({resetPasswordTitle:{id:"authentication.forgotPasswordForm.passwordTitle",defaultMessage:"Forgot your password ?"},authenticationError:{id:"authentication.forgotPasswordForm.authentication-error",defaultMessage:"Authentication error"},emailText:{id:"authentication.forgotPasswordForm.email",defaultMessage:"EMAIL"},resetPasswordDescription:{id:"authentication.forgotPasswordForm.resetPassword",defaultMessage:"Having trouble logging in? Just type your email address bellow and we will sent you an email with a link to reset your password."},resetPasswordEmailRequired:{id:"authentication.forgotPasswordForm.emaiRequired",defaultMessage:"Please input your email!"},resetPasswordSubmit:{id:"authentication.forgotPasswordForm.resetPasswordSubmit",defaultMessage:"Continue"},resetPasswordBack:{id:"authentication.forgotPasswordForm.backToLoginLink",defaultMessage:"Cancel"},resetPasswordReturnToLogin:{id:"authentication.forgotPasswordMailSent.returnToLogind",defaultMessage:"Return to Login"},resetPasswordPasswordSent:{id:"authentication.forgotPasswordMailSent.passsordSent",defaultMessage:"We've sent you an email with a link to finish reseting your password."},resetPasswordEmailSpan:{id:"authentication.forgotPasswordMailSent.emailSpan",defaultMessage:"Can't find the email ? Try checking your spam folder."}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Login=void 0;var a,r=n(2724),o=(a=r)&&a.__esModule?a:{default:a};t.Login=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=n(25),o=n(0),i=m(o),s=n(8),l=n(33),c=n(6),u=n(10),d=m(n(59)),f=n(738),p=m(n(261));function m(e){return e&&e.__esModule?e:{default:e}}var g=u.Form.Item,y=(0,c.defineMessages)({logInError:{id:"authentication.login.login.error",defaultMessage:"There was an error with the information you entered, please check your username / password."},expiredPassword:{id:"authentication.login.expired.password",defaultMessage:"Your password has expired. Please create a new one by clicking on Forgot password."},forgotPassword:{id:"authentication.login.forgot.password",defaultMessage:"Forgot password"},passwordText:{id:"authentication.login.password",defaultMessage:"PASSWORD"},emailText:{id:"authentication.login.email",defaultMessage:"EMAIL"},logInText:{id:"authentication.login.login.text",defaultMessage:"Log in"},rememberMe:{id:"authentication.login.remember.me",defaultMessage:"Remember me"},emailRequired:{id:"authentication.login.email.required",defaultMessage:"Please input your email!"},passwordRequired:{id:"authentication.login.password.required",defaultMessage:"Please input your password!"}}),h={logInRequest:f.logIn.request};t.default=(0,s.compose)(c.injectIntl,l.withRouter,(0,r.connect)((function(e){return{hasError:e.login.hasError,error:e.login.error,connectedUser:e.session.connectedUser}}),h))((function(e){var t=(0,o.useState)(!1),n=a(t,2),r=n[0],s=n[1],f=u.Form.useForm(),m=a(f,1)[0];(0,o.useEffect)((function(){var e=!1;window.addEventListener("storage",(function(t){t.storageArea&&t.storageArea.isLogged&&"true"===t.storageArea.isLogged&&!e&&(h(t),e=!0)}))}),[]);var h=function(t){var n=e.location.state&&e.location.state.from||{pathname:"/"},a=e.match,r=function(){d.default.debug("Redirect from "+a.url+" to "+n),e.history.push("/")};m.validateFields().then((function(t){s(!0),e.logInRequest({email:t.email,password:t.password,remember:t.remember},{redirect:r})}))},v=e.hasError,b=e.error,_=e.intl,S=e.connectedUser,E=S&&S.id,O=v?b&&"EXPIRED_PASSWORD_ERROR"===b.error_code?i.default.createElement(u.Alert,{type:"error",className:"login-error-message",message:i.default.createElement(c.FormattedMessage,y.expiredPassword)}):i.default.createElement(u.Alert,{type:"error",className:"login-error-message",message:i.default.createElement(c.FormattedMessage,y.logInError)}):null;return i.default.createElement("div",{className:"mcs-login-container"},i.default.createElement("div",{className:"mcs-login-container-left"},i.default.createElement("div",{className:"image-wrapper"},i.default.createElement("img",{alt:"mics-logo",className:"login-logo",src:"/react/src/assets/images/logo.png"})),i.default.createElement("div",{className:"login-frame"},i.default.createElement(u.Form,{onFinish:h,form:m},O,i.default.createElement("div",{className:"login-password-text"},i.default.createElement(c.FormattedMessage,y.emailText)),i.default.createElement(g,{name:"email",rules:[{required:!0,message:_.formatMessage(y.emailRequired)}]},i.default.createElement(u.Input,{className:"login-input"})),i.default.createElement("div",{className:"login-password-text"},i.default.createElement(c.FormattedMessage,y.passwordText)),i.default.createElement(g,{name:"password",rules:[{required:!0,message:_.formatMessage(y.passwordRequired)}]},i.default.createElement(u.Input,{type:"password",className:"login-input",autoComplete:"off"})),i.default.createElement(g,null,i.default.createElement(u.Button,{type:"primary",htmlType:"submit",className:"mcs-primary login-form-button",loading:r&&!E&&!v},i.default.createElement(c.FormattedMessage,y.logInText))),i.default.createElement(u.Divider,null),i.default.createElement(g,{initialValue:"true"===p.default.getItem("remember_me")},i.default.createElement(u.Switch,{size:"small"}),i.default.createElement("div",{className:"login-text-remember-me"},i.default.createElement(c.FormattedMessage,y.rememberMe)),i.default.createElement(l.Link,{className:"login-form-forgot",to:"/v2/forgot_password"},i.default.createElement(c.FormattedMessage,y.forgotPassword)))))),i.default.createElement("div",{className:"mcs-login-container-right"}))}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SetPassword=void 0;var a,r=n(2726),o=(a=r)&&a.__esModule?a:{default:a};t.SetPassword=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(10),l=n(77),c=n(1195),u=(a=c)&&a.__esModule?a:{default:a},d=n(6),f=n(8),p=n(33),m=n(30),g=n(49),y=n(15),h=n(12);var v=function(e,t,n,a){var r,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},b=(0,d.defineMessages)({setPassword:{id:"authentication.setPassword.reset",defaultMessage:"Reset Your Password"},revertologin:{id:"authentication.setPassword.goBackTologin",defaultMessage:"Go Back To Login"},passwordFormTitle:{id:"authentication.setPassword.formTitle",defaultMessage:"PASSWORD"},standardSetPasswordError:{id:"authentication.setPassword.errorMessage",defaultMessage:"Please make sure that the two passwords match and that your password is at least 8 characters long."}}),_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSubmit=function(e){var t=n.props,a=t.location.search,r=t.history,o=(0,m.parseSearch)(a,m.SET_PASSWORD_SEARCH_SETTINGS);e.preventDefault(),n.setState({isError:!1}),n.props.form.validateFields((function(e,t){e||(n.checkPasswordValidity(t.password1,t.password2)?n._authService.resetPassword(o.email,o.token,t.password1).then((function(){r.push("/login")})).catch((function(e){n.setState({isError:!0,errorMessage:e.error})})):n.setState({isError:!0,errorMessage:""}))}))},n.checkPasswordValidity=function(e,t){return e===t&&!(e.length<8)},n.state={isRequesting:!1,isError:!1,errorMessage:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.form.getFieldDecorator,n=e.intl,a=this.state.isError?i.createElement(s.Alert,{type:"error",style:{marginBottom:24},message:""===this.state.errorMessage?i.createElement(d.FormattedMessage,b.standardSetPasswordError):this.state.errorMessage,className:"login-error-message"}):null;return i.createElement("div",{className:"mcs-reset-password-container"},i.createElement("div",{className:"image-wrapper"},i.createElement("img",{alt:"mics-logo",className:"reset-password-logo",src:"/react/src/assets/images/logo.png"})),i.createElement("div",{className:"reset-password-title"},i.createElement(d.FormattedMessage,b.setPassword)),i.createElement("div",{className:"reset-password-container-frame"},i.createElement(l.Form,{onSubmit:this.handleSubmit,className:"login-form"},a,i.createElement("div",{className:"password-text"},i.createElement(d.FormattedMessage,b.passwordFormTitle)),i.createElement(u.default,null,t("password1",{rules:[{required:!0,message:n.formatMessage(g.defaultErrorMessages.required)}]})(i.createElement(s.Input,{type:"password",className:"reset-password-input",autoComplete:"off"}))),i.createElement("div",{className:"password-text"},i.createElement(d.FormattedMessage,b.passwordFormTitle)),i.createElement(u.default,null,t("password2",{rules:[{required:!0,message:n.formatMessage(g.defaultErrorMessages.required)}]})(i.createElement(s.Input,{type:"password",className:"reset-password-input",autoComplete:"off"}))),i.createElement(s.Row,{align:"middle",justify:"center"},i.createElement(s.Col,{span:12,className:"reset-password-back-to-login"},i.createElement(p.Link,{to:"/login"},i.createElement(d.FormattedMessage,b.revertologin))),i.createElement(s.Col,{span:12},i.createElement(s.Button,{type:"primary",htmlType:"submit",className:"mcs-primary reset-password-button"},i.createElement(d.FormattedMessage,b.setPassword)))))))}}]),t}(i.Component);v([(0,y.lazyInject)(h.TYPES.IAuthService)],_.prototype,"_authService",void 0),t.default=(0,f.compose)(p.withRouter,d.injectIntl)(_)},,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1096),r=n(1007),o=n(1115),i=n(1136),s=n(1146),l=n(1170),c=n(1149),u=n(1166),d=n(2741),f=n(116),p=n(10);function m(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(0,f.createBrowserHistory)().listen((function(){p.Modal.destroyAll()}));var g=[].concat(m(r.campaignRoutes),m(a.automationRoutes),m(o.audienceRoutes),m(i.creativeRoutes),m(s.libraryRoutes),m(l.settingsRoutes),m(c.datastudioRoutes),m(u.marketplaceRoutes),m(d.featureFlagRoutes));t.default=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.featureFlagRoutes=t.featureFlagDefinition=void 0;var a,r=n(185),o=n(2742),i=(a=o)&&a.__esModule?a:{default:a};var s=t.featureFlagDefinition={featureFlagEdit:{path:"/ui-feature-flag",layout:"edit",editComponent:i.default,requiredFeature:"features.ui_feature_flag",requireDatamart:!1}};t.featureFlagRoutes=(0,r.generateRoutesFromDefinition)(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(8),i=n(13),s=n(6);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=(0,s.defineMessages)({deprecated:{id:"features.add",defaultMessage:"WARNING: This page has been deprecated. Please ask directly to your support contact in order to get access (or be removed) to an alpha/beta feature."}}),d=function(e){function t(){return l(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.intl,n=e.history,a=e.match.params.organisationId,o=t.formatMessage(u.deprecated);return setTimeout((function(){n.push("/v2/o/"+a+"/audience/segments"),location.reload()}),5e3),r.createElement("div",{className:"mcs-centered-container page-error"},r.createElement("p",null,o))}}]),t}(r.Component);t.default=(0,o.compose)(i.withRouter,s.injectIntl)(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isAppInitialized=function(e){return e.app.initialized}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setColorsStore=void 0;var a=n(247),r=n(104),o=(0,a.createAction)(r.STORE_THEME_COLOR);t.setColorsStore=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=E(n(0)),i=n(8),s=n(6),l=n(13),c=n(10),u=n(25),d=S(n(59)),f=S(n(54)),p=S(n(1197)),m=S(n(1198)),g=E(n(67)),y=S(n(1168)),h=n(11),v=S(n(2750)),b=n(15),_=n(12);function S(e){return e&&e.__esModule?e:{default:e}}function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},M=c.Card.Meta,P=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.showOrgs=function(){return n.props.workspaces.length<49||""!==n.state.search},n.getCachedOrgLogoMap=function(){return n.props.workspaces.filter((function(e){return!!n._organisationService.getLogoCache(e.organisation_id)})).reduce((function(e,t){return Object.assign(Object.assign({},e),O({},t.organisation_id,{logoUrl:URL.createObjectURL(n._organisationService.getLogoCache(t.organisation_id))}))}),{})},n.fetchNotInCacheOrgLogoMap=function(){var e=n.getFilteredWorkspaces().filter((function(e){return!n._organisationService.getLogoCache(e.organisation_id)}));n.setState((function(t){return{orgLogoMap:Object.assign(Object.assign({},t.orgLogoMap),e.reduce((function(e,t){return Object.assign(Object.assign({},e),O({},t.organisation_id,{isLoading:!0}))}),{}))}}),(function(){n.fetchLogosDebounced(e)}))},n.getFilteredWorkspaces=function(){var e=n.props.workspaces;return""===n.state.search?e:e.filter((function(e){return e.organisation_name.toLocaleLowerCase().includes(n.state.search.toLowerCase())}))},n.fetchLogos=function(e){var t=e.map((function(e){return function(){return n._organisationService.getLogo(e.organisation_id).then((function(t){n.setState((function(n){return{orgLogoMap:Object.assign(Object.assign({},n.orgLogoMap),O({},e.organisation_id,{isLoading:!1,logoUrl:URL.createObjectURL(t)}))}}))}))}}));(0,m.default)(t,{concurrency:4})},n.changeWorkspace=function(e){var t=e.key,a=n.props,r=a.history,o=a.match,i=o.path,s=o.params,l=a.onItemClick,c=p.default.compile(i)(Object.assign(Object.assign({},s),{organisationId:t}));d.default.debug("Change workspace, redirect to "+c),r.push(c),l()},n.onSearch=function(e){n.setState({search:e})},n.onChange=function(e){var t=e.target.value.trim();n.setState((function(){return{search:t}}),(function(){return n.fetchNotInCacheOrgLogoMap()}))},n.onCardClick=function(e){return function(){return n.changeWorkspace({key:e})}},n.state={search:"",orgLogoMap:n.getCachedOrgLogoMap()},n.fetchLogosDebounced=f.default.debounce(n.fetchLogos,500),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){this.showOrgs()&&this.fetchNotInCacheOrgLogoMap()}},{key:"render",value:function(){var e=this,t=this.showOrgs(),n=this.getFilteredWorkspaces(),a=1;return 800===this.props.size?a=4:400===this.props.size&&(a=2),o.createElement("div",{className:"mcs-org-selector"},o.createElement(c.Row,{gutter:20,style:{marginRight:20,marginLeft:20}},o.createElement(c.Col,{span:24},o.createElement(v.default,{placeholder:"Search Organisation",onSearch:this.onSearch,className:"search-input",onChange:this.onChange,autoFocus:!0}))),o.createElement(c.Row,{gutter:20,style:{marginRight:20,marginLeft:20}},t?n&&n.length?n.map((function(t){return o.createElement(c.Col,{span:24/a,key:t.organisation_id},o.createElement(h.Button,{onClick:e.onCardClick(t.organisation_id),style:{height:134,marginBottom:20,width:"100%"}},o.createElement(c.Card,{hoverable:!0,className:"mcs-org-card",cover:o.createElement(y.default,{organisationId:t.organisation_id,isLoading:!!e.state.orgLogoMap[t.organisation_id]&&e.state.orgLogoMap[t.organisation_id].isLoading,logoUrl:e.state.orgLogoMap[t.organisation_id]?e.state.orgLogoMap[t.organisation_id].logoUrl:null}),style:{height:"100%"}},o.createElement(M,{className:"mcs-card-body",description:t.organisation_name}))))})):o.createElement("div",{className:"mcs-no-results"},o.createElement(s.FormattedMessage,{id:"orgSelector.noResult",defaultMessage:"No Results"})):o.createElement(c.Col,{span:24},o.createElement(s.FormattedMessage,{id:"orgSelector.tooManyOrgs",defaultMessage:"You have access to too many organisations, please use the search to narrow your selection down"}))))}}]),t}(o.Component);w([(0,b.lazyInject)(_.TYPES.IOrganisationService)],P.prototype,"_organisationService",void 0);t.default=(0,i.compose)(l.withRouter,s.injectIntl,(0,u.connect)((function(e){return{workspaces:e.session.connectedUser.workspaces,workspace:g.getWorkspace(e),hasDatamarts:g.hasDatamarts(e)}}),void 0))(P)},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(54),l=(a=s)&&a.__esModule?a:{default:a},c=n(61),u=n(8),d=n(25);var f=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},p={large:.85,medium:.6,small:.4},m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getDimensions=function(e){return Math.round(window.innerWidth*p[e])},n.getForegroundContentSize=function(e){var t=e.length>0&&e[e.length-1];return t&&t.size?t.size:"large"},n.canProgramaticallyCloseDrawer=function(){var e=n.props.drawableContents,t=l.default.last(e);return!t||!t.isModal},n.handleOnKeyDown=function(e){"Escape"===e.key&&n.canProgramaticallyCloseDrawer()&&n.props.closeNextDrawer()},n.updateDimensions=function(e){var t=e.length?e:n.props.drawableContents,a=n.getForegroundContentSize(t);n.setState({drawerMaxWidth:n.getDimensions(a),viewportWidth:Math.round(window.innerWidth)})},n.handleClickOnBackground=function(){n.canProgramaticallyCloseDrawer()&&n.props.closeNextDrawer()},n.state={drawerMaxWidth:n.getDimensions("large"),viewportWidth:Math.round(window.innerWidth)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.updateDimensions.bind(this))}},{key:"componentDidUpdate",value:function(e){var t=e.drawableContents,n=this.props.drawableContents;t.length!==n.length&&this.updateDimensions(n),this.drawerDiv&&this.drawerDiv.focus()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateDimensions.bind(this))}},{key:"getDrawerStyle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"large";return{transform:"translate("+e+"px, 0px)",maxWidth:Math.round(window.innerWidth*p[t])+"px"}}},{key:"generateDrawer",value:function(e){return e.map((function(e,t){return i.cloneElement(e,{key:t})}))}},{key:"render",value:function(){var e=this,t=this.props.drawableContents,n=this.state,a=n.drawerMaxWidth,o=n.viewportWidth,s=this.getForegroundContentSize(t),l={ready:this.getDrawerStyle(o),foreground:this.getDrawerStyle(o-a,s),background:this.getDrawerStyle(0)},c=[];return t.forEach((function(n,a){var o=n.component,s=n.additionalProps,u=(n.size,f(n,["component","additionalProps","size"]));if(o){var d=a===t.length-1;c.push(i.createElement("div",{className:"drawer-overlay",onClick:e.handleClickOnBackground})),c.push(i.createElement("div",{ref:function(t){e.drawerDiv=t},tabIndex:0,className:"drawer",style:d?l.foreground:l.background},i.createElement(o,r({},s,u))))}})),c.push(i.createElement("div",{className:"drawer-overlay"})),c.push(i.createElement("div",{className:"drawer",style:l.ready})),i.createElement("div",{onKeyDown:this.handleOnKeyDown,className:"drawer-container"},this.generateDrawer(c))}}]),t}(i.Component);t.default=(0,u.compose)((0,d.connect)((function(e){return{drawableContents:e.drawableContents}})),c.injectDrawer)(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(6),s=n(856),l=(a=s)&&a.__esModule?a:{default:a},c=n(8),u=n(11);function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=function(e){function t(){return d(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props.intl;return o.createElement("div",{style:{display:"flex",flex:1}},o.createElement(u.Error,{message:e.formatMessage(l.default.noAccess)}))}}]),t}(o.Component);t.default=(0,c.compose)(i.injectIntl)(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommunityChangePassword=void 0;var a,r=n(2755),o=(a=r)&&a.__esModule?a:{default:a};t.CommunityChangePassword=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=n(10),s=n(77),l=v(n(1195)),c=n(6),u=n(8),d=n(33),f=n(30),p=n(49),m=v(n(2756)),g=n(44),y=n(15),h=n(12);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,a){var o,i=arguments.length,s=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=(0,c.defineMessages)({changePassword:{id:"change.password.change.password",defaultMessage:"Change your password"},setPassword:{id:"change.password.set.password",defaultMessage:"Set your password"},revertTologin:{id:"change.password.revert.to.login",defaultMessage:"Go back to login"},passwordFormTitle:{id:"change.password.form.title",defaultMessage:"Password"},secondPasswordFormTitle:{id:"change.password.second.password.form.title",defaultMessage:"Confirm your password"},passwordRequirementError:{id:"change.password.requirement.error",defaultMessage:"Your passwords do not match the requirements"},standardChangePasswordError:{id:"change.password.password.error",defaultMessage:"Your password could not be set, please try again later."}}),S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.requestValidity=function(e){(0,g.takeLatest)(n._communityService.getCommunityPasswordValidity)(n.props.match.params.communityToken,e.target.value).then((function(e){n.setState({passVal:e.data})})).catch((function(){return n.setState({isError:!0,errorMessage:_.standardChangePasswordError.defaultMessage})}))},n.handleSubmit=function(e){var t=n.props,a=t.location.search,r=t.history,o=(0,f.parseSearch)(a,f.SET_PASSWORD_SEARCH_SETTINGS);e.preventDefault(),n.props.form.validateFields((function(e,t){e||n.state.fetchingPasswReqFailure||!n.passwordValidity(n.state.passVal,t.password1,t.password2)?n.setState({isError:!0,errorMessage:_.passwordRequirementError.defaultMessage}):n._authService.resetPassword(o.email,o.token,t.password1).then((function(){r.push("/login")})).catch((function(e){n.setState({isError:!0,errorMessage:e.error})}))}))},n.state={fetchingPasswReq:!0,fetchingPasswReqFailure:!1,isError:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;this._communityService.getCommunityPasswordRequirements(this.props.match.params.communityToken).then((function(t){e.setState({passReq:t.data,fetchingPasswReq:!1,fetchingPasswReqFailure:!1})})).catch((function(t){e.setState({isError:!0,fetchingPasswReqFailure:!0,errorMessage:_.standardChangePasswordError.defaultMessage,fetchingPasswReq:!1})}))}},{key:"passwordValidity",value:function(e,t,n){return e&&!Object.values(e).includes(!1)&&t&&n&&t===n}},{key:"render",value:function(){var e=this.props,t=e.form.getFieldDecorator,n=e.intl,a=this.state,r=a.isError,u=a.errorMessage,d=a.fetchingPasswReq,f=a.passReq,g=a.passVal,y=r&&u?o.createElement(i.Alert,{type:"error",className:"login-error-message",style:{marginBottom:15,paddingLeft:5},message:u}):null,h=this.props.location.pathname.includes("/change-password")?o.createElement(c.FormattedMessage,_.changePassword):o.createElement(c.FormattedMessage,_.setPassword),v=this.props.form.getFieldValue("password1"),b=this.props.form.getFieldValue("password2");return o.createElement("div",{className:"mcs-reset-password-container"},o.createElement("div",{className:"image-wrapper"},o.createElement("img",{alt:"mics-logo",className:"reset-password-logo",src:"/react/src/assets/images/logo.png"})),o.createElement("div",{className:"reset-password-title"},h),o.createElement("div",{className:"reset-password-container-frame"},d&&o.createElement(i.Spin,{size:"large"}),!d&&!f&&o.createElement("div",null,y,o.createElement(i.Row,{align:"middle",justify:"center"},o.createElement(i.Col,{span:24},o.createElement(i.Button,{type:"ghost",className:"reset-password-button",href:"/"},o.createElement(c.FormattedMessage,_.revertTologin))))),!d&&void 0!==f&&o.createElement(s.Form,{onSubmit:this.handleSubmit,className:"login-form"},y,o.createElement("div",{className:"reset-password-requirements"},o.createElement(m.default,{req:f,val:g,p1:v,p2:b})),o.createElement("div",{className:"password-text"},o.createElement(c.FormattedMessage,_.passwordFormTitle)),o.createElement(l.default,null,t("password1",{rules:[{required:!0,message:n.formatMessage(p.defaultErrorMessages.required)}]})(o.createElement(i.Input,{type:"password",className:"reset-password-input",onChange:this.requestValidity,autoComplete:"off"}))),o.createElement("div",{className:"password-text"},o.createElement(c.FormattedMessage,_.secondPasswordFormTitle)),o.createElement(l.default,null,t("password2",{rules:[{required:!0,message:n.formatMessage(p.defaultErrorMessages.required)}]})(o.createElement(i.Input,{type:"password",className:"reset-password-input",autoComplete:"off"}))),o.createElement(i.Row,{align:"middle",justify:"center"},o.createElement(i.Col,{span:12},o.createElement(i.Button,{type:"ghost",className:"reset-password-button",href:"/"},o.createElement(c.FormattedMessage,_.revertTologin))),o.createElement(i.Col,{span:12},o.createElement(i.Button,{type:"primary",htmlType:"submit",className:"mcs-primary reset-password-button",disabled:!this.passwordValidity(g,v,b)},h))))))}}]),t}(o.Component);b([(0,y.lazyInject)(h.TYPES.ICommunityService)],S.prototype,"_communityService",void 0),b([(0,y.lazyInject)(h.TYPES.IAuthService)],S.prototype,"_authService",void 0),t.default=(0,u.compose)(d.withRouter,c.injectIntl)(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(0),i=(a=o)&&a.__esModule?a:{default:a},s=n(6),l=n(11);var c=(0,s.defineMessages)({passwordMatch:{id:"check.passwords.match",defaultMessage:"Both passwords should match"},passwordMustContain:{id:"check.passwords.must.contain",defaultMessage:"Your password must match the following requirements :"},characters:{id:"check.passwords.characters",defaultMessage:"characters minimum"},digits:{id:"check.passwords.digits",defaultMessage:"digit(s) minimum"},specialCharacters:{id:"check.passwords.special.characters",defaultMessage:"special character(s) minimum"},easyPasswords:{id:"check.passwords.easy.passwords",defaultMessage:"Passwords cannot be too obvious"},lowerAndUpperCase:{id:"check.passwords.lower.upper",defaultMessage:"One lowercase and one uppercase character"}}),u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"checkOrWarning",value:function(e){return e?i.default.createElement(l.McsIcon,{type:"check",className:"check-logo"}):i.default.createElement(l.McsIcon,{type:"warning",className:"warning-logo"})}},{key:"render",value:function(){var e=this.props,t=e.req,n=e.val,a=e.p1,r=e.p2;return i.default.createElement("div",null,i.default.createElement("p",{className:"requirement-list"},c.passwordMustContain.defaultMessage),t.min_length>0?i.default.createElement("p",{className:"requirement-list"},n?this.checkOrWarning(n.is_long_enough):i.default.createElement(l.McsIcon,{type:"info",className:"icon"})," ",i.default.createElement("span",{className:"req-text"},t.min_length," ",c.characters.defaultMessage)):"",t.min_digit_count>0?i.default.createElement("p",{className:"requirement-list"},n?this.checkOrWarning(n.has_enough_digits):i.default.createElement(l.McsIcon,{type:"info",className:"icon"})," ",i.default.createElement("span",{className:"req-text"},t.min_digit_count," ",c.digits.defaultMessage)):"",t.min_special_chars_count>0?i.default.createElement("p",{className:"requirement-list"},n?this.checkOrWarning(n.has_enough_special_chars):i.default.createElement(l.McsIcon,{type:"info",className:"icon"})," ",i.default.createElement("span",{className:"req-text"},t.min_special_chars_count," ",c.specialCharacters.defaultMessage)):"",t.different_letter_case_needed?i.default.createElement("p",{className:"requirement-list"},n?this.checkOrWarning(n.has_upper_and_lower_cases):i.default.createElement(l.McsIcon,{type:"info",className:"icon"})," ",i.default.createElement("span",{className:"req-text"},c.lowerAndUpperCase.defaultMessage)):"",t.forbid_popular_passwords?i.default.createElement("p",{className:"requirement-list"},n?this.checkOrWarning(n.is_not_popular):i.default.createElement(l.McsIcon,{type:"info",className:"icon"})," ",i.default.createElement("span",{className:"req-text"},c.easyPasswords.defaultMessage)):"",i.default.createElement("p",{className:"requirement-list"},r?this.checkOrWarning(a===r):i.default.createElement(l.McsIcon,{type:"info",className:"icon"})," ",i.default.createElement("span",{className:"req-text"},c.passwordMatch.defaultMessage)))}}]),t}(i.default.Component);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Notifications=void 0;var a,r=n(2758),o=(a=r)&&a.__esModule?a:{default:a};t.Notifications=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=d(n(0)),o=n(25),i=n(8),s=n(10),l=n(6),c=d(n(124)),u=n(2759);function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=(0,l.defineMessages)({newVersionMessage:{id:"notification.newVersion.message",defaultMessage:"New Version available"},newVersionDescription:{id:"notification.newVersion.description",defaultMessage:"Please reload the page"},newVersionReloadBtn:{id:"notification.newVersion.button.reload",defaultMessage:"Reload"},errorMessage:{id:"notitication.error.default_message",defaultMessage:"Error"},errorDescription:{id:"notification.error.default_description",defaultMessage:"An error occured"},errorDescriptionWithErrorId:{id:"notification.error.default_description_with_errorid",defaultMessage:"Something went wrong, please contact your administrator with the following id:"},errorDescriptionCustomWithErrorId:{id:"notification.error.default_custom_description_with_errorid",defaultMessage:"Please contact your administrator with the following id:"},errorDescriptionReason:{id:"notification.error.possible_reason",defaultMessage:"Possible Reason:"}}),g=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.notifications,a=e.notifications;if(n.length>0){var r=n.map((function(e){return e.uid})),o=a.map((function(e){return e.uid}));o.filter((function(e){return r.indexOf(e)<0})).forEach((function(e){return s.notification.close(e)})),n.filter((function(e){return o.indexOf(e.uid)<0})).forEach((function(e){switch(e.level){case"info":s.notification.info(t.buildAntNotifConfig(e));break;case"success":s.notification.success(t.buildAntNotifConfig(e));break;case"warning":s.notification.warning(t.buildAntNotifConfig(e));break;case"error":s.notification.error(t.buildAntNotifConfig(e))}}))}else s.notification.destroy()}},{key:"buildAntNotifConfig",value:function(e){var t=this.props,n=t.intl.formatMessage,a=t.removeNotification,o=Object.assign(Object.assign({},e),{onClose:function(){a(e.uid),"function"==typeof e.onClose&&e.onClose()}});if((0,u.isValidFormattedMessageProps)(e.intlMessage)&&(o.message=n(e.intlMessage)),(0,u.isValidFormattedMessageProps)(e.intlDescription)&&(o.description=n(e.intlDescription)),e.error&&(o.message||(o.message=r.createElement("span",null,n(m.errorMessage))),e.error.error_id?o.description?o.description=e.error.error?r.createElement("div",null,o.description,r.createElement("p",null,r.createElement("span",null,n(m.errorDescriptionWithErrorId)," ",r.createElement("code",null,e.error.error_id)," ",n(m.errorDescriptionReason)," ",r.createElement("code",null,e.error.error)))):r.createElement("div",null,o.description,r.createElement("p",null,r.createElement("span",null,n(m.errorDescriptionWithErrorId)," ",r.createElement("code",null,e.error.error_id)))):o.description=e.error.error?r.createElement("span",null,n(m.errorDescriptionWithErrorId)," ",r.createElement("code",null,e.error.error_id)," ",n(m.errorDescriptionReason)," ",r.createElement("code",null,e.error.error)):r.createElement("div",null,r.createElement("p",null,r.createElement("span",null,n(m.errorDescriptionWithErrorId)," ",r.createElement("code",null,e.error.error_id)))):o.description||(o.description=r.createElement("span",null,n(m.errorDescription)))),e.newVersion){o.message=r.createElement("span",null,n(m.newVersionMessage)),o.description=r.createElement("span",null,n(m.newVersionDescription));o.btn=r.createElement(s.Button,{type:"primary",size:"small",onClick:function(){return window.location.reload()}},r.createElement("span",null,n(m.newVersionReloadBtn)))}return o}},{key:"render",value:function(){return null}}]),t}(r.Component);t.default=(0,i.compose)((0,o.connect)((function(e){return{notifications:e.notifications}}),{removeNotification:c.removeNotification}),l.injectIntl)(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isValidFormattedMessageProps=function(e){return e&&e.id&&e.defaultMessage}}]);